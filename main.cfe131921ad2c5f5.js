(self.webpackChunkReservaciones=self.webpackChunkReservaciones||[]).push([[179],{121:(Tr,Jt,pi)=>{"use strict";function Nt(n){return"function"==typeof n}function ze(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const Vi=ze(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,o)=>`${o+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function h(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class Ie{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const c of e)c.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Nt(i))try{i()}catch(c){t=c instanceof Vi?c.errors:[c]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const c of o)try{xt(c)}catch(f){t=t??[],f instanceof Vi?t=[...t,...f.errors]:t.push(f)}}if(t)throw new Vi(t)}}add(t){var e;if(t&&t!==this)if(this.closed)xt(t);else{if(t instanceof Ie){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&h(e,t)}remove(t){const{_finalizers:e}=this;e&&h(e,t),t instanceof Ie&&t._removeParent(this)}}Ie.EMPTY=(()=>{const n=new Ie;return n.closed=!0,n})();const Xt=Ie.EMPTY;function kt(n){return n instanceof Ie||n&&"closed"in n&&Nt(n.remove)&&Nt(n.add)&&Nt(n.unsubscribe)}function xt(n){Nt(n)?n():n.unsubscribe()}const He={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},yt={setTimeout(n,t,...e){const{delegate:i}=yt;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=yt;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Lt(n){yt.setTimeout(()=>{const{onUnhandledError:t}=He;if(!t)throw n;t(n)})}function un(){}const Yn=tn("C",void 0,void 0);function tn(n,t,e){return{kind:n,value:t,error:e}}let en=null;function it(n){if(He.useDeprecatedSynchronousErrorHandling){const t=!en;if(t&&(en={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=en;if(en=null,e)throw i}}else n()}class De extends Ie{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,kt(t)&&t.add(this)):this.destination=gn}static create(t,e,i){return new Ti(t,e,i)}next(t){this.isStopped?fr(function pt(n){return tn("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?fr(function Pt(n){return tn("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?fr(Yn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const ot=Function.prototype.bind;function gt(n,t){return ot.call(n,t)}class _n{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){Ui(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){Ui(i)}else Ui(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Ui(e)}}}class Ti extends De{constructor(t,e,i){let o;if(super(),Nt(t)||!t)o={next:t??void 0,error:e??void 0,complete:i??void 0};else{let c;this&&He.useDeprecatedNextContext?(c=Object.create(t),c.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&gt(t.next,c),error:t.error&&gt(t.error,c),complete:t.complete&&gt(t.complete,c)}):o=t}this.destination=new _n(o)}}function Ui(n){He.useDeprecatedSynchronousErrorHandling?function ae(n){He.useDeprecatedSynchronousErrorHandling&&en&&(en.errorThrown=!0,en.error=n)}(n):Lt(n)}function fr(n,t){const{onStoppedNotification:e}=He;e&&yt.setTimeout(()=>e(n,t))}const gn={closed:!0,next:un,error:function er(n){throw n},complete:un},mr="function"==typeof Symbol&&Symbol.observable||"@@observable";function wr(n){return n}function Ro(n){return 0===n.length?wr:1===n.length?n[0]:function(e){return n.reduce((i,o)=>o(i),e)}}let xn=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,o){const c=function Fs(n){return n&&n instanceof De||function _a(n){return n&&Nt(n.next)&&Nt(n.error)&&Nt(n.complete)}(n)&&kt(n)}(e)?e:new Ti(e,i,o);return it(()=>{const{operator:f,source:v}=this;c.add(f?f.call(c,v):v?this._subscribe(c):this._trySubscribe(c))}),c}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Zo(i))((o,c)=>{const f=new Ti({next:v=>{try{e(v)}catch(C){c(C),f.unsubscribe()}},error:c,complete:o});this.subscribe(f)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[mr](){return this}pipe(...e){return Ro(e)(this)}toPromise(e){return new(e=Zo(e))((i,o)=>{let c;this.subscribe(f=>c=f,f=>o(f),()=>i(c))})}}return n.create=t=>new n(t),n})();function Zo(n){var t;return null!==(t=n??He.Promise)&&void 0!==t?t:Promise}const Yo=ze(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let yn=(()=>{class n extends xn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Xo(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Yo}next(e){it(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){it(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){it(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:o,observers:c}=this;return i||o?Xt:(this.currentObservers=null,c.push(e),new Ie(()=>{this.currentObservers=null,h(c,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:o,isStopped:c}=this;i?e.error(o):c&&e.complete()}asObservable(){const e=new xn;return e.source=this,e}}return n.create=(t,e)=>new Xo(t,e),n})();class Xo extends yn{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:Xt}}function _s(n){return Nt(n?.lift)}function Xn(n){return t=>{if(_s(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Rn(n,t,e,i,o){return new ar(n,t,e,i,o)}class ar extends De{constructor(t,e,i,o,c,f){super(t),this.onFinalize=c,this.shouldUnsubscribe=f,this._next=e?function(v){try{e(v)}catch(C){t.error(C)}}:super._next,this._error=o?function(v){try{o(v)}catch(C){t.error(C)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(v){t.error(v)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function nn(n,t){return Xn((e,i)=>{let o=0;e.subscribe(Rn(i,c=>{i.next(n.call(t,c,o++))}))})}function bs(n){return this instanceof bs?(this.v=n,this):new bs(n)}function wc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function Os(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(c){e[c]=n[c]&&function(f){return new Promise(function(v,C){!function o(c,f,v,C){Promise.resolve(C).then(function(S){c({value:S,done:v})},f)}(v,C,(f=n[c](f)).done,f.value)})}}}const ba=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ec(n){return Nt(n?.then)}function al(n){return Nt(n[mr])}function Jo(n){return Symbol.asyncIterator&&Nt(n?.[Symbol.asyncIterator])}function bo(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Dc=function xa(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function wa(n){return Nt(n?.[Dc])}function te(n){return function va(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,i=e.apply(n,t||[]),c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(Q){i[Q]&&(o[Q]=function(oe){return new Promise(function(me,Ee){c.push([Q,oe,me,Ee])>1||v(Q,oe)})})}function v(Q,oe){try{!function C(Q){Q.value instanceof bs?Promise.resolve(Q.value.v).then(S,R):V(c[0][2],Q)}(i[Q](oe))}catch(me){V(c[0][3],me)}}function S(Q){v("next",Q)}function R(Q){v("throw",Q)}function V(Q,oe){Q(oe),c.shift(),c.length&&v(c[0][0],c[0][1])}}(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:o}=yield bs(e.read());if(o)return yield bs(void 0);yield yield bs(i)}}finally{e.releaseLock()}})}function j(n){return Nt(n?.getReader)}function H(n){if(n instanceof xn)return n;if(null!=n){if(al(n))return function ee(n){return new xn(t=>{const e=n[mr]();if(Nt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(ba(n))return function ue(n){return new xn(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(Ec(n))return function be(n){return new xn(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,Lt)})}(n);if(Jo(n))return Te(n);if(wa(n))return function Ae(n){return new xn(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(j(n))return function Ce(n){return Te(te(n))}(n)}throw bo(n)}function Te(n){return new xn(t=>{(function Re(n,t){var e,i,o,c;return function Oo(n,t,e,i){return new(e||(e=Promise))(function(c,f){function v(R){try{S(i.next(R))}catch(V){f(V)}}function C(R){try{S(i.throw(R))}catch(V){f(V)}}function S(R){R.done?c(R.value):function o(c){return c instanceof e?c:new e(function(f){f(c)})}(R.value).then(v,C)}S((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=wc(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(f){o={error:f}}finally{try{i&&!i.done&&(c=e.return)&&(yield c.call(e))}finally{if(o)throw o.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function tt(n,t,e,i=0,o=!1){const c=t.schedule(function(){e(),o?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(c),!o)return c}function Je(n,t,e=1/0){return Nt(t)?Je((i,o)=>nn((c,f)=>t(i,c,o,f))(H(n(i,o))),e):("number"==typeof t&&(e=t),Xn((i,o)=>function Tt(n,t,e,i,o,c,f,v){const C=[];let S=0,R=0,V=!1;const Q=()=>{V&&!C.length&&!S&&t.complete()},oe=Ee=>S<i?me(Ee):C.push(Ee),me=Ee=>{c&&t.next(Ee),S++;let $e=!1;H(e(Ee,R++)).subscribe(Rn(t,lt=>{o?.(lt),c?oe(lt):t.next(lt)},()=>{$e=!0},void 0,()=>{if($e)try{for(S--;C.length&&S<i;){const lt=C.shift();f?tt(t,f,()=>me(lt)):me(lt)}Q()}catch(lt){t.error(lt)}}))};return n.subscribe(Rn(t,oe,()=>{V=!0,Q()})),()=>{v?.()}}(i,o,n,e)))}function zt(n=1/0){return Je(wr,n)}const Ft=new xn(n=>n.complete());function Mn(n){return n&&Nt(n.schedule)}function Qn(n){return n[n.length-1]}function rn(n){return Nt(Qn(n))?n.pop():void 0}function ti(n){return Mn(Qn(n))?n.pop():void 0}function Js(n,t=0){return Xn((e,i)=>{e.subscribe(Rn(i,o=>tt(i,n,()=>i.next(o),t),()=>tt(i,n,()=>i.complete(),t),o=>tt(i,n,()=>i.error(o),t)))})}function Ns(n,t=0){return Xn((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function Ju(n,t){if(!n)throw new Error("Iterable cannot be null");return new xn(e=>{tt(e,t,()=>{const i=n[Symbol.asyncIterator]();tt(e,t,()=>{i.next().then(o=>{o.done?e.complete():e.next(o.value)})},0,!0)})})}function lr(n,t){return t?function Ll(n,t){if(null!=n){if(al(n))return function qe(n,t){return H(n).pipe(Ns(t),Js(t))}(n,t);if(ba(n))return function rr(n,t){return new xn(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(Ec(n))return function ea(n,t){return H(n).pipe(Ns(t),Js(t))}(n,t);if(Jo(n))return Ju(n,t);if(wa(n))return function Ca(n,t){return new xn(e=>{let i;return tt(e,t,()=>{i=n[Dc](),tt(e,t,()=>{let o,c;try{({value:o,done:c}=i.next())}catch(f){return void e.error(f)}c?e.complete():e.next(o)},0,!0)}),()=>Nt(i?.return)&&i.return()})}(n,t);if(j(n))return function Bs(n,t){return Ju(te(n),t)}(n,t)}throw bo(n)}(n,t):H(n)}function qr(...n){const t=ti(n),e=function Ei(n,t){return"number"==typeof Qn(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?H(i[0]):zt(e)(lr(i,t)):Ft}function In(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new Ti({next:()=>{i.unsubscribe(),n()}});return H(t(...e)).subscribe(i)}function Ht(n){for(let t in n)if(n[t]===Ht)return t;throw Error("Could not find renamed property on target object.")}function es(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function vi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(vi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function Tn(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const Nl=Ht({__forward_ref__:Ht});function ci(n){return n.__forward_ref__=ci,n.toString=function(){return vi(this())},n}function pn(n){return or(n)?n():n}function or(n){return"function"==typeof n&&n.hasOwnProperty(Nl)&&n.__forward_ref__===ci}function bi(n){return n&&!!n.\u0275providers}const Cr="https://g.co/ng/security#xss";class nt extends Error{constructor(t,e){super(zs(t,e)),this.code=t}}function zs(n,t){return`NG0${Math.abs(n)}${t?": "+t.trim():""}`}function Sn(n){return"string"==typeof n?n:null==n?"":String(n)}function Vs(n,t){throw new nt(-201,!1)}function Ar(n,t){null==n&&function oi(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function Mt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function qn(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ul(n){return Da(n,xs)||Da(n,$l)}function Da(n,t){return n.hasOwnProperty(t)?n[t]:null}function Tc(n){return n&&(n.hasOwnProperty(wo)||n.hasOwnProperty(Gd))?n[wo]:null}const xs=Ht({\u0275prov:Ht}),wo=Ht({\u0275inj:Ht}),$l=Ht({ngInjectableDef:Ht}),Gd=Ht({ngInjectorDef:Ht});var dn=(()=>((dn=dn||{})[dn.Default=0]="Default",dn[dn.Host=1]="Host",dn[dn.Self=2]="Self",dn[dn.SkipSelf=4]="SkipSelf",dn[dn.Optional=8]="Optional",dn))();let Hl;function Co(n){const t=Hl;return Hl=n,t}function Ac(n,t,e){const i=Ul(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&dn.Optional?null:void 0!==t?t:void Vs(vi(n))}const Oi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ws={},ni="__NG_DI_FLAG__",Sa="ngTempTokenPath",id="ngTokenPath",Ic=/\n/gm,ql="\u0275",cl="__source";let ta;function Lo(n){const t=ta;return ta=n,t}function xu(n,t=dn.Default){if(void 0===ta)throw new nt(-203,!1);return null===ta?Ac(n,void 0,t):ta.get(n,t&dn.Optional?null:void 0,t)}function We(n,t=dn.Default){return(function qd(){return Hl}()||xu)(pn(n),t)}function bn(n,t=dn.Default){return We(n,ul(t))}function ul(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function kc(n){const t=[];for(let e=0;e<n.length;e++){const i=pn(n[e]);if(Array.isArray(i)){if(0===i.length)throw new nt(900,!1);let o,c=dn.Default;for(let f=0;f<i.length;f++){const v=i[f],C=Pc(v);"number"==typeof C?-1===C?o=v.token:c|=C:o=v}t.push(We(o,c))}else t.push(We(i))}return t}function zn(n,t){return n[ni]=t,n.prototype[ni]=t,n}function Pc(n){return n[ni]}function ts(n){return{toString:n}.toString()}var ns=(()=>((ns=ns||{})[ns.OnPush=0]="OnPush",ns[ns.Default=1]="Default",ns))(),No=(()=>{return(n=No||(No={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",No;var n})();const Us={},xi=[],dl=Ht({\u0275cmp:Ht}),hl=Ht({\u0275dir:Ht}),pl=Ht({\u0275pipe:Ht}),Wl=Ht({\u0275mod:Ht}),is=Ht({\u0275fac:Ht}),Zl=Ht({__NG_ELEMENT_ID__:Ht});let lp=0;function mi(n){return ts(()=>{const t=Yl(n),e={...t,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ns.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||No.Emulated,id:"c"+lp++,styles:n.styles||xi,_:null,schemas:n.schemas||null,tView:null};rd(e);const i=n.dependencies;return e.directiveDefs=fl(i,!1),e.pipeDefs=fl(i,!0),e})}function Yd(n){return wi(n)||Dr(n)}function Rc(n){return null!==n}function ii(n){return ts(()=>({type:n.type,bootstrap:n.bootstrap||xi,declarations:n.declarations||xi,imports:n.imports||xi,exports:n.exports||xi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Fc(n,t){if(null==n)return Us;const e={};for(const i in n)if(n.hasOwnProperty(i)){let o=n[i],c=o;Array.isArray(o)&&(c=o[1],o=o[0]),e[o]=i,t&&(t[o]=c)}return e}function Vt(n){return ts(()=>{const t=Yl(n);return rd(t),t})}function Ir(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function wi(n){return n[dl]||null}function Dr(n){return n[hl]||null}function ao(n){return n[pl]||null}function Eo(n,t){const e=n[Wl]||null;if(!e&&!0===t)throw new Error(`Type ${vi(n)} does not have '\u0275mod' property.`);return e}function Yl(n){const t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||xi,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Fc(n.inputs,t),outputs:Fc(n.outputs)}}function rd(n){n.features?.forEach(t=>t(n))}function fl(n,t){if(!n)return null;const e=t?ao:Yd;return()=>("function"==typeof n?n():n).map(i=>e(i)).filter(Rc)}const Cs=0,jt=1,Un=2,Li=3,rs=4,$s=5,Or=6,Es=7,ur=8,Oc=9,Lc=10,jn=11,Nc=12,Bc=13,Cu=14,Do=15,kr=16,Xl=17,Aa=18,os=19,ss=20,ml=21,Ai=22,Ia=1,Hs=2,Zr=7,Cn=8,ra=9,lo=10;function Lr(n){return Array.isArray(n)&&"object"==typeof n[Ia]}function Bo(n){return Array.isArray(n)&&!0===n[Ia]}function Eu(n){return 0!=(4&n.flags)}function ka(n){return n.componentOffset>-1}function Pa(n){return 1==(1&n.flags)}function k(n){return!!n.template}function F(n){return 0!=(256&n[Un])}function Vc(n,t){return n.hasOwnProperty(is)?n[is]:null}class Mf{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function tr(){return Jd}function Jd(n){return n.type.prototype.ngOnChanges&&(n.setInput=Sf),eh}function eh(){const n=th(this),t=n?.current;if(t){const e=n.previous;if(e===Us)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function Sf(n,t,e,i){const o=this.declaredInputs[e],c=th(n)||function Tf(n,t){return n[Uc]=t}(n,{previous:Us,current:null}),f=c.current||(c.current={}),v=c.previous,C=v[o];f[o]=new Mf(C&&C.currentValue,t,v===Us),n[i]=t}tr.ngInherit=!0;const Uc="__ngSimpleChanges__";function th(n){return n[Uc]||null}const as=function(n,t,e){},nh="svg";function Pr(n){for(;Array.isArray(n);)n=n[Cs];return n}function cd(n,t){return Pr(t[n])}function ls(n,t){return Pr(t[n.index])}function hp(n,t){return n.data[t]}function gl(n,t){return n[t]}function ji(n,t){const e=t[n];return Lr(e)?e:e[Cs]}function ud(n){return 64==(64&n[Un])}function _l(n,t){return null==t?null:n[t]}function Ra(n){n[Aa]=0}function ih(n,t){n[$s]+=t;let e=n,i=n[Li];for(;null!==i&&(1===t&&1===e[$s]||-1===t&&0===e[$s]);)i[$s]+=t,e=i,i=i[Li]}const En={lFrame:I(null),bindingsEnabled:!0};function Su(){return En.bindingsEnabled}function ft(){return En.lFrame.lView}function ui(){return En.lFrame.tView}function uo(n){return En.lFrame.contextLView=n,n[ur]}function Kr(n){return En.lFrame.contextLView=null,n}function Nr(){let n=Tu();for(;null!==n&&64===n.type;)n=n.parent;return n}function Tu(){return En.lFrame.currentTNode}function zo(n,t){const e=En.lFrame;e.currentTNode=n,e.isParent=t}function Au(){return En.lFrame.isParent}function rh(){En.lFrame.isParent=!1}function Mo(){const n=En.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function $c(){return En.lFrame.bindingIndex++}function Oa(n){const t=En.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function sh(n,t){const e=En.lFrame;e.bindingIndex=e.bindingRootIndex=n,m(t)}function m(n){En.lFrame.currentDirectiveIndex=n}function l(n){const t=En.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}function d(){return En.lFrame.currentQueryIndex}function _(n){En.lFrame.currentQueryIndex=n}function b(n){const t=n[jt];return 2===t.type?t.declTNode:1===t.type?n[Or]:null}function w(n,t,e){if(e&dn.SkipSelf){let o=t,c=n;for(;!(o=o.parent,null!==o||e&dn.Host||(o=b(c),null===o||(c=c[Do],10&o.type))););if(null===o)return!1;t=o,n=c}const i=En.lFrame=T();return i.currentTNode=t,i.lView=n,!0}function M(n){const t=T(),e=n[jt];En.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function T(){const n=En.lFrame,t=null===n?null:n.child;return null===t?I(n):t}function I(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function N(){const n=En.lFrame;return En.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const L=N;function U(){const n=N();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function K(){return En.lFrame.selectedIndex}function J(n){En.lFrame.selectedIndex=n}function Y(){const n=En.lFrame;return hp(n.tView,n.selectedIndex)}function q(){En.lFrame.currentNamespace=nh}function re(){!function le(){En.lFrame.currentNamespace=null}()}function we(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const c=n.data[e].type.prototype,{ngAfterContentInit:f,ngAfterContentChecked:v,ngAfterViewInit:C,ngAfterViewChecked:S,ngOnDestroy:R}=c;f&&(n.contentHooks??(n.contentHooks=[])).push(-e,f),v&&((n.contentHooks??(n.contentHooks=[])).push(e,v),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(e,v)),C&&(n.viewHooks??(n.viewHooks=[])).push(-e,C),S&&((n.viewHooks??(n.viewHooks=[])).push(e,S),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(e,S)),null!=R&&(n.destroyHooks??(n.destroyHooks=[])).push(e,R)}}function Se(n,t,e){mt(n,t,3,e)}function Fe(n,t,e,i){(3&n[Un])===e&&mt(n,t,e,i)}function Le(n,t){let e=n[Un];(3&e)===t&&(e&=2047,e+=1,n[Un]=e)}function mt(n,t,e,i){const c=i??-1,f=t.length-1;let v=0;for(let C=void 0!==i?65535&n[Aa]:0;C<f;C++)if("number"==typeof t[C+1]){if(v=t[C],null!=i&&v>=i)break}else t[C]<0&&(n[Aa]+=65536),(v<c||-1==c)&&(ke(n,e,t,C),n[Aa]=(4294901760&n[Aa])+C+2),C++}function ke(n,t,e,i){const o=e[i]<0,c=e[i+1],v=n[o?-e[i]:e[i]];if(o){if(n[Un]>>11<n[Aa]>>16&&(3&n[Un])===t){n[Un]+=2048,as(4,v,c);try{c.call(v)}finally{as(5,v,c)}}}else{as(4,v,c);try{c.call(v)}finally{as(5,v,c)}}}const Ke=-1;class je{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Rt(n,t,e){let i=0;for(;i<e.length;){const o=e[i];if("number"==typeof o){if(0!==o)break;i++;const c=e[i++],f=e[i++],v=e[i++];n.setAttribute(t,f,v,c)}else{const c=o,f=e[++i];Wt(c)?n.setProperty(t,c,f):n.setAttribute(t,c,f),i++}}return i}function At(n){return 3===n||4===n||6===n}function Wt(n){return 64===n.charCodeAt(0)}function kn(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const o=t[i];"number"==typeof o?e=o:0===e||Kt(n,e,o,null,-1===e||2===e?t[++i]:null)}}return n}function Kt(n,t,e,i,o){let c=0,f=n.length;if(-1===t)f=-1;else for(;c<n.length;){const v=n[c++];if("number"==typeof v){if(v===t){f=-1;break}if(v>t){f=c-1;break}}}for(;c<n.length;){const v=n[c];if("number"==typeof v)break;if(v===e){if(null===i)return void(null!==o&&(n[c+1]=o));if(i===n[c+1])return void(n[c+2]=o)}c++,null!==i&&c++,null!==o&&c++}-1!==f&&(n.splice(f,0,t),c=f+1),n.splice(c++,0,e),null!==i&&n.splice(c++,0,i),null!==o&&n.splice(c++,0,o)}function gi(n){return n!==Ke}function di(n){return 32767&n}function Di(n,t){let e=function $i(n){return n>>16}(n),i=t;for(;e>0;)i=i[Do],e--;return i}let dr=!0;function ho(n){const t=dr;return dr=n,t}const Na=255,Yi=5;let Ni=0;const On={};function Br(n,t){const e=po(n,t);if(-1!==e)return e;const i=t[jt];i.firstCreatePass&&(n.injectorIndex=t.length,Bi(i.data,n),Bi(t,null),Bi(i.blueprint,null));const o=Qr(n,t),c=n.injectorIndex;if(gi(o)){const f=di(o),v=Di(o,t),C=v[jt].data;for(let S=0;S<8;S++)t[c+S]=v[f+S]|C[f+S]}return t[c+8]=o,c}function Bi(n,t){n.push(0,0,0,0,0,0,0,0,t)}function po(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Qr(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,o=t;for(;null!==o;){if(i=_g(o),null===i)return Ke;if(e++,o=o[Do],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return Ke}function Ba(n,t,e){!function hr(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Zl)&&(i=e[Zl]),null==i&&(i=e[Zl]=Ni++);const o=i&Na;t.data[n+(o>>Yi)]|=1<<o}(n,t,e)}function cs(n,t,e){if(e&dn.Optional||void 0!==n)return n;Vs()}function Ds(n,t,e,i){if(e&dn.Optional&&void 0===i&&(i=null),!(e&(dn.Self|dn.Host))){const o=n[Oc],c=Co(void 0);try{return o?o.get(t,i,e&dn.Optional):Ac(t,i,e&dn.Optional)}finally{Co(c)}}return cs(i,0,e)}function za(n,t,e,i=dn.Default,o){if(null!==n){if(1024&t[Un]){const f=function uv(n,t,e,i,o){let c=n,f=t;for(;null!==c&&null!==f&&1024&f[Un]&&!(256&f[Un]);){const v=yl(c,f,e,i|dn.Self,On);if(v!==On)return v;let C=c.parent;if(!C){const S=f[ml];if(S){const R=S.get(e,On,i);if(R!==On)return R}C=_g(f),f=f[Do]}c=C}return o}(n,t,e,i,On);if(f!==On)return f}const c=yl(n,t,e,i,On);if(c!==On)return c}return Ds(t,e,i,o)}function yl(n,t,e,i,o){const c=function fg(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Zl)?n[Zl]:void 0;return"number"==typeof t?t>=0?t&Na:cv:t}(e);if("function"==typeof c){if(!w(t,n,i))return i&dn.Host?cs(o,0,i):Ds(t,e,i,o);try{const f=c(i);if(null!=f||i&dn.Optional)return f;Vs()}finally{L()}}else if("number"==typeof c){let f=null,v=po(n,t),C=Ke,S=i&dn.Host?t[kr][Or]:null;for((-1===v||i&dn.SkipSelf)&&(C=-1===v?Qr(n,t):t[v+8],C!==Ke&&gg(i,!1)?(f=t[jt],v=di(C),t=Di(C,t)):v=-1);-1!==v;){const R=t[jt];if(mg(c,v,R.data)){const V=Ql(v,t,e,f,i,S);if(V!==On)return V}C=t[v+8],C!==Ke&&gg(i,t[jt].data[v+8]===S)&&mg(c,v,t)?(f=R,v=di(C),t=Di(C,t)):v=-1}}return o}function Ql(n,t,e,i,o,c){const f=t[jt],v=f.data[n+8],R=vl(v,f,e,null==i?ka(v)&&dr:i!=f&&0!=(3&v.type),o&dn.Host&&c===v);return null!==R?ku(t,f,R,v):On}function vl(n,t,e,i,o){const c=n.providerIndexes,f=t.data,v=1048575&c,C=n.directiveStart,R=c>>20,Q=o?v+R:n.directiveEnd;for(let oe=i?v:v+R;oe<Q;oe++){const me=f[oe];if(oe<C&&e===me||oe>=C&&me.type===e)return oe}if(o){const oe=f[C];if(oe&&k(oe)&&oe.type===e)return C}return null}function ku(n,t,e,i){let o=n[e];const c=t.data;if(function ct(n){return n instanceof je}(o)){const f=o;f.resolving&&function Mc(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new nt(-200,`Circular dependency in DI detected for ${n}${e}`)}(function fi(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Sn(n)}(c[e]));const v=ho(f.canSeeViewProviders);f.resolving=!0;const C=f.injectImpl?Co(f.injectImpl):null;w(n,i,dn.Default);try{o=n[e]=f.factory(void 0,c,n,i),t.firstCreatePass&&e>=i.directiveStart&&function ge(n,t,e){const{ngOnChanges:i,ngOnInit:o,ngDoCheck:c}=t.type.prototype;if(i){const f=Jd(t);(e.preOrderHooks??(e.preOrderHooks=[])).push(n,f),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(n,f)}o&&(e.preOrderHooks??(e.preOrderHooks=[])).push(0-n,o),c&&((e.preOrderHooks??(e.preOrderHooks=[])).push(n,c),(e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(n,c))}(e,c[e],t)}finally{null!==C&&Co(C),ho(v),f.resolving=!1,L()}}return o}function mg(n,t,e){return!!(e[t+(n>>Yi)]&1<<n)}function gg(n,t){return!(n&dn.Self||n&dn.Host&&t)}class md{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return za(this._tNode,this._lView,t,ul(i),e)}}function cv(){return new md(Nr(),ft())}function Jr(n){return ts(()=>{const t=n.prototype.constructor,e=t[is]||Ff(t),i=Object.prototype;let o=Object.getPrototypeOf(n.prototype).constructor;for(;o&&o!==i;){const c=o[is]||Ff(o);if(c&&c!==e)return c;o=Object.getPrototypeOf(o)}return c=>new c})}function Ff(n){return or(n)?()=>{const t=Ff(pn(n));return t&&t()}:Vc(n)}function _g(n){const t=n[jt],e=t.type;return 2===e?t.declTNode:1===e?n[Or]:null}function gd(n){return function Iu(n,t){if("class"===t)return n.classes;if("style"===t)return n.styles;const e=n.attrs;if(e){const i=e.length;let o=0;for(;o<i;){const c=e[o];if(At(c))break;if(0===c)o+=2;else if("number"==typeof c)for(o++;o<i&&"string"==typeof e[o];)o++;else{if(c===t)return e[o+1];o+=2}}}return null}(Nr(),n)}const lh="__parameters__";function Pu(n,t,e){return ts(()=>{const i=function gp(n){return function(...e){if(n){const i=n(...e);for(const o in i)this[o]=i[o]}}}(t);function o(...c){if(this instanceof o)return i.apply(this,c),this;const f=new o(...c);return v.annotation=f,v;function v(C,S,R){const V=C.hasOwnProperty(lh)?C[lh]:Object.defineProperty(C,lh,{value:[]})[lh];for(;V.length<=R;)V.push(null);return(V[R]=V[R]||[]).push(f),C}}return e&&(o.prototype=Object.create(e.prototype)),o.prototype.ngMetadataName=n,o.annotationCls=o,o})}class wt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Mt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Gs(n,t){n.forEach(e=>Array.isArray(e)?Gs(e,t):t(e))}function Gc(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function ec(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function yp(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function us(n,t,e){let i=ch(n,t);return i>=0?n[1|i]=e:(i=~i,function Wx(n,t,e,i){let o=n.length;if(o==t)n.push(e,i);else if(1===o)n.push(i,n[0]),n[0]=e;else{for(o--,n.push(n[o-1],n[o]);o>t;)n[o]=n[o-2],o--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function sa(n,t){const e=ch(n,t);if(e>=0)return n[1|e]}function ch(n,t){return function _r(n,t,e){let i=0,o=n.length>>e;for(;o!==i;){const c=i+(o-i>>1),f=n[c<<e];if(t===f)return c<<e;f>t?o=c:i=c+1}return~(o<<e)}(n,t,1)}const tc=zn(Pu("Inject",n=>({token:n})),-1),ds=zn(Pu("Optional"),8),bl=zn(Pu("SkipSelf"),4);var eo=(()=>((eo=eo||{})[eo.Important=1]="Important",eo[eo.DashCase=2]="DashCase",eo))();const mh=new Map;let xv=0;const Mp="__ngContext__";function Vr(n,t){Lr(t)?(n[Mp]=t[ss],function wg(n){mh.set(n[ss],n)}(t)):n[Mp]=t}let Tg;function Ag(n,t){return Tg(n,t)}function vh(n){const t=n[Li];return Bo(t)?t[Li]:t}function Ga(n){return Wa(n[Bc])}function qa(n){return Wa(n[rs])}function Wa(n){for(;null!==n&&!Bo(n);)n=n[rs];return n}function So(n,t,e,i,o){if(null!=i){let c,f=!1;Bo(i)?c=i:Lr(i)&&(f=!0,i=i[Cs]);const v=Pr(i);0===n&&null!==e?null==o?Bg(t,e,v):vd(t,e,v,o||null,!0):1===n&&null!==e?vd(t,e,v,o||null,!0):2===n?function Gg(n,t,e){const i=xh(n,t);i&&function zg(n,t,e,i){n.removeChild(t,e,i)}(n,i,t,e)}(t,v,f):3===n&&t.destroyNode(v),null!=c&&function iw(n,t,e,i,o){const c=e[Zr];c!==Pr(e)&&So(t,n,i,c,o);for(let v=lo;v<e.length;v++){const C=e[v];Ip(C[jt],C,n,t,i,c)}}(t,n,c,e,o)}}function jf(n,t,e){return n.createElement(t,e)}function Og(n,t){const e=n[ra],i=e.indexOf(t),o=t[Li];512&t[Un]&&(t[Un]&=-513,ih(o,-1)),e.splice(i,1)}function Lg(n,t){if(n.length<=lo)return;const e=lo+t,i=n[e];if(i){const o=i[Xl];null!==o&&o!==n&&Og(o,i),t>0&&(n[e-1][rs]=i[rs]);const c=ec(n,lo+t);!function bh(n,t){Ip(n,t,t[jn],2,null,null),t[Cs]=null,t[Or]=null}(i[jt],i);const f=c[os];null!==f&&f.detachView(c[jt]),i[Li]=null,i[rs]=null,i[Un]&=-65}return i}function rc(n,t){if(!(128&t[Un])){const e=t[jn];e.destroyNode&&Ip(n,t,e,3,null,null),function Rg(n){let t=n[Bc];if(!t)return Wc(n[jt],n);for(;t;){let e=null;if(Lr(t))e=t[Bc];else{const i=t[lo];i&&(e=i)}if(!e){for(;t&&!t[rs]&&t!==n;)Lr(t)&&Wc(t[jt],t),t=t[Li];null===t&&(t=n),Lr(t)&&Wc(t[jt],t),e=t&&t[rs]}t=e}}(t)}}function Wc(n,t){if(!(128&t[Un])){t[Un]&=-65,t[Un]|=128,function Hf(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const o=t[e[i]];if(!(o instanceof je)){const c=e[i+1];if(Array.isArray(c))for(let f=0;f<c.length;f+=2){const v=o[c[f]],C=c[f+1];as(4,v,C);try{C.call(v)}finally{as(5,v,C)}}else{as(4,o,c);try{c.call(o)}finally{as(5,o,c)}}}}}(n,t),function $f(n,t){const e=n.cleanup,i=t[Es];let o=-1;if(null!==e)for(let c=0;c<e.length-1;c+=2)if("string"==typeof e[c]){const f=e[c+3];f>=0?i[o=f]():i[o=-f].unsubscribe(),c+=2}else{const f=i[o=e[c+1]];e[c].call(f)}if(null!==i){for(let c=o+1;c<i.length;c++)(0,i[c])();t[Es]=null}}(n,t),1===t[jt].type&&t[jn].destroy();const e=t[Xl];if(null!==e&&Bo(t[Li])){e!==t[Li]&&Og(e,t);const i=t[os];null!==i&&i.detachView(n)}!function yd(n){mh.delete(n[ss])}(t)}}function Gf(n,t,e){return function Ng(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[Cs];{const{componentOffset:o}=i;if(o>-1){const{encapsulation:c}=n.data[i.directiveStart+o];if(c===No.None||c===No.Emulated)return null}return ls(i,e)}}(n,t.parent,e)}function vd(n,t,e,i,o){n.insertBefore(t,e,i,o)}function Bg(n,t,e){n.appendChild(t,e)}function Mv(n,t,e,i,o){null!==i?vd(n,t,e,i,o):Bg(n,t,e)}function xh(n,t){return n.parentNode(t)}function Vg(n,t,e){return Ug(n,t,e)}let jg,Za,Nu,oc,Ug=function Lu(n,t,e){return 40&n.type?ls(n,e):null};function xd(n,t,e,i){const o=Gf(n,i,t),c=t[jn],v=Vg(i.parent||t[Or],i,t);if(null!=o)if(Array.isArray(e))for(let C=0;C<e.length;C++)Mv(c,o,e[C],v,!1);else Mv(c,o,e,v,!1);void 0!==jg&&jg(c,i,t,e,o)}function Ap(n,t){if(null!==t){const e=t.type;if(3&e)return ls(t,n);if(4&e)return Hg(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return Ap(n,i);{const o=n[t.index];return Bo(o)?Hg(-1,o):Pr(o)}}if(32&e)return Ag(t,n)()||Pr(n[t.index]);{const i=$g(n,t);return null!==i?Array.isArray(i)?i[0]:Ap(vh(n[kr]),i):Ap(n,t.next)}}return null}function $g(n,t){return null!==t?n[kr][Or].projection[t.projection]:null}function Hg(n,t){const e=lo+n+1;if(e<t.length){const i=t[e],o=i[jt].firstChild;if(null!==o)return Ap(i,o)}return t[Zr]}function qf(n,t,e,i,o,c,f){for(;null!=e;){const v=i[e.index],C=e.type;if(f&&0===t&&(v&&Vr(Pr(v),i),e.flags|=2),32!=(32&e.flags))if(8&C)qf(n,t,e.child,i,o,c,!1),So(t,n,o,v,c);else if(32&C){const S=Ag(e,i);let R;for(;R=S();)So(t,n,o,R,c);So(t,n,o,v,c)}else 16&C?Av(n,t,i,e,o,c):So(t,n,o,v,c);e=f?e.projectionNext:e.next}}function Ip(n,t,e,i,o,c){qf(e,i,n.firstChild,t,o,c,!1)}function Av(n,t,e,i,o,c){const f=e[kr],C=f[Or].projection[i.projection];if(Array.isArray(C))for(let S=0;S<C.length;S++)So(t,n,o,C[S],c);else qf(n,t,C,f[Li],o,c,!0)}function qg(n,t,e){""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Wf(n,t,e){const{mergedAttrs:i,classes:o,styles:c}=e;null!==i&&Rt(n,t,i),null!==o&&qg(n,t,o),null!==c&&function kv(n,t,e){n.setAttribute(t,"style",e)}(n,t,c)}function wh(n){return function ps(){if(void 0===Za&&(Za=null,Oi.trustedTypes))try{Za=Oi.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Za}()?.createHTML(n)||n}function Fv(n){return function wd(){if(void 0===oc&&(oc=null,Oi.trustedTypes))try{oc=Oi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return oc}()?.createScriptURL(n)||n}class Cd{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Cr})`}}class sw extends Cd{getTypeName(){return"HTML"}}class aw extends Cd{getTypeName(){return"Style"}}class lw extends Cd{getTypeName(){return"Script"}}class Yg extends Cd{getTypeName(){return"URL"}}class cw extends Cd{getTypeName(){return"ResourceURL"}}function Ao(n){return n instanceof Cd?n.changingThisBreaksApplicationSecurity:n}function sc(n,t){const e=function Mr(n){return n instanceof Cd&&n.getTypeName()||null}(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${Cr})`)}return e===t}class Lv{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(wh(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch{return null}}}class Pp{constructor(t){this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(t){const e=this.inertDocument.createElement("template");return e.innerHTML=wh(t),e}}const Qg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Qf(n){return(n=String(n)).match(Qg)?n:"unsafe:"+n}function ac(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Zc(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const Nv=ac("area,br,col,hr,img,wbr"),Jf=ac("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Bv=ac("rp,rt"),e_=Zc(Nv,Zc(Jf,ac("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Zc(Bv,ac("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Zc(Bv,Jf)),t_=ac("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Uv=Zc(t_,ac("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ac("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),uw=ac("script,style,template");class em{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=this.checkClobberedElement(e,e.nextSibling);if(o){e=o;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!e_.hasOwnProperty(e))return this.sanitizedSomething=!0,!uw.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let o=0;o<i.length;o++){const c=i.item(o),f=c.name,v=f.toLowerCase();if(!Uv.hasOwnProperty(v)){this.sanitizedSomething=!0;continue}let C=c.value;t_[v]&&(C=Qf(C)),this.buf.push(" ",f,'="',Ed(C),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();e_.hasOwnProperty(e)&&!Nv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Ed(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const dw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,jv=/([^\#-~ |!])/g;function Ed(n){return n.replace(/&/g,"&amp;").replace(dw,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(jv,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let tm;function $v(n,t){let e=null;try{tm=tm||function Xg(n){const t=new Pp(n);return function Kg(){try{return!!(new window.DOMParser).parseFromString(wh(""),"text/html")}catch{return!1}}()?new Lv(t):t}(n);let i=t?String(t):"";e=tm.getInertBodyElement(i);let o=5,c=i;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,i=c,c=e.innerHTML,e=tm.getInertBodyElement(i)}while(i!==c);return wh((new em).sanitizeChildren(n_(e)||e))}finally{if(e){const i=n_(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function n_(n){return"content"in n&&function Hv(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var zi=(()=>((zi=zi||{})[zi.NONE=0]="NONE",zi[zi.HTML=1]="HTML",zi[zi.STYLE=2]="STYLE",zi[zi.SCRIPT=3]="SCRIPT",zi[zi.URL=4]="URL",zi[zi.RESOURCE_URL=5]="RESOURCE_URL",zi))();function i_(n){const t=Yc();return t?t.sanitize(zi.URL,n)||"":sc(n,"URL")?Ao(n):Qf(Sn(n))}function Rp(n){const t=Yc();if(t)return Fv(t.sanitize(zi.RESOURCE_URL,n)||"");if(sc(n,"ResourceURL"))return Fv(Ao(n));throw new nt(904,!1)}function Yc(){const n=ft();return n&&n[Nc]}const Fp=new wt("ENVIRONMENT_INITIALIZER"),Gv=new wt("INJECTOR",-1),r_=new wt("INJECTOR_DEF_TYPES");class o_{get(t,e=ws){if(e===ws){const i=new Error(`NullInjectorError: No provider for ${vi(t)}!`);throw i.name="NullInjectorError",i}return e}}function qv(...n){return{\u0275providers:s_(0,n),\u0275fromNgModule:!0}}function s_(n,...t){const e=[],i=new Set;let o;return Gs(t,c=>{const f=c;l_(f,e,[],i)&&(o||(o=[]),o.push(f))}),void 0!==o&&a_(o,e),e}function a_(n,t){for(let e=0;e<n.length;e++){const{providers:o}=n[e];om(o,c=>{t.push(c)})}}function l_(n,t,e,i){if(!(n=pn(n)))return!1;let o=null,c=Tc(n);const f=!c&&wi(n);if(c||f){if(f&&!f.standalone)return!1;o=n}else{const C=n.ngModule;if(c=Tc(C),!c)return!1;o=C}const v=i.has(o);if(f){if(v)return!1;if(i.add(o),f.dependencies){const C="function"==typeof f.dependencies?f.dependencies():f.dependencies;for(const S of C)l_(S,t,e,i)}}else{if(!c)return!1;{if(null!=c.imports&&!v){let S;i.add(o);try{Gs(c.imports,R=>{l_(R,t,e,i)&&(S||(S=[]),S.push(R))})}finally{}void 0!==S&&a_(S,t)}if(!v){const S=Vc(o)||(()=>new o);t.push({provide:o,useFactory:S,deps:xi},{provide:r_,useValue:o,multi:!0},{provide:Fp,useValue:()=>We(o),multi:!0})}const C=c.providers;null==C||v||om(C,R=>{t.push(R)})}}return o!==n&&void 0!==n.providers}function om(n,t){for(let e of n)bi(e)&&(e=e.\u0275providers),Array.isArray(e)?om(e,t):t(e)}const sm=Ht({provide:String,useValue:Ht});function am(n){return null!==n&&"object"==typeof n&&sm in n}function Ya(n){return"function"==typeof n}const lm=new wt("Set Injector scope."),Lp={},yw={};let c_;function cm(){return void 0===c_&&(c_=new o_),c_}class Xc{}class Wv extends Xc{get destroyed(){return this._destroyed}constructor(t,e,i,o){super(),this.parent=e,this.source=i,this.scopes=o,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,h_(t,f=>this.processProvider(f)),this.records.set(Gv,Dd(void 0,this)),o.has("environment")&&this.records.set(Xc,Dd(void 0,this));const c=this.records.get(lm);null!=c&&"string"==typeof c.value&&this.scopes.add(c.value),this.injectorDefTypes=new Set(this.get(r_.multi,xi,dn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();for(const t of this._onDestroyHooks)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(t){this._onDestroyHooks.push(t)}runInContext(t){this.assertNotDestroyed();const e=Lo(this),i=Co(void 0);try{return t()}finally{Lo(e),Co(i)}}get(t,e=ws,i=dn.Default){this.assertNotDestroyed(),i=ul(i);const o=Lo(this),c=Co(void 0);try{if(!(i&dn.SkipSelf)){let v=this.records.get(t);if(void 0===v){const C=function xw(n){return"function"==typeof n||"object"==typeof n&&n instanceof wt}(t)&&Ul(t);v=C&&this.injectableDefInScope(C)?Dd(u_(t),Lp):null,this.records.set(t,v)}if(null!=v)return this.hydrate(t,v)}return(i&dn.Self?cm():this.parent).get(t,e=i&dn.Optional&&e===ws?null:e)}catch(f){if("NullInjectorError"===f.name){if((f[Sa]=f[Sa]||[]).unshift(vi(t)),o)throw f;return function Zd(n,t,e,i){const o=n[Sa];throw t[cl]&&o.unshift(t[cl]),n.message=function wu(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==ql?n.slice(2):n;let o=vi(t);if(Array.isArray(t))o=t.map(vi).join(" -> ");else if("object"==typeof t){let c=[];for(let f in t)if(t.hasOwnProperty(f)){let v=t[f];c.push(f+":"+("string"==typeof v?JSON.stringify(v):vi(v)))}o=`{${c.join(", ")}}`}return`${e}${i?"("+i+")":""}[${o}]: ${n.replace(Ic,"\n  ")}`}("\n"+n.message,o,e,i),n[id]=o,n[Sa]=null,n}(f,t,"R3InjectorError",this.source)}throw f}finally{Co(c),Lo(o)}}resolveInjectorInitializers(){const t=Lo(this),e=Co(void 0);try{const i=this.get(Fp.multi,xi,dn.Self);for(const o of i)o()}finally{Lo(t),Co(e)}}toString(){const t=[],e=this.records;for(const i of e.keys())t.push(vi(i));return`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new nt(205,!1)}processProvider(t){let e=Ya(t=pn(t))?t:pn(t&&t.provide);const i=function vw(n){return am(n)?Dd(void 0,n.useValue):Dd(d_(n),Lp)}(t);if(Ya(t)||!0!==t.multi)this.records.get(e);else{let o=this.records.get(e);o||(o=Dd(void 0,Lp,!0),o.factory=()=>kc(o.multi),this.records.set(e,o)),e=t,o.multi.push(t)}this.records.set(e,i)}hydrate(t,e){return e.value===Lp&&(e.value=yw,e.value=e.factory()),"object"==typeof e.value&&e.value&&function bw(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=pn(t.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function u_(n){const t=Ul(n),e=null!==t?t.factory:Vc(n);if(null!==e)return e;if(n instanceof wt)throw new nt(204,!1);if(n instanceof Function)return function um(n){const t=n.length;if(t>0)throw yp(t,"?"),new nt(204,!1);const e=function Ma(n){return n&&(n[xs]||n[$l])||null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new nt(204,!1)}function d_(n,t,e){let i;if(Ya(n)){const o=pn(n);return Vc(o)||u_(o)}if(am(n))i=()=>pn(n.useValue);else if(function Eh(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...kc(n.deps||[]));else if(function Uo(n){return!(!n||!n.useExisting)}(n))i=()=>We(pn(n.useExisting));else{const o=pn(n&&(n.useClass||n.provide));if(!function Zv(n){return!!n.deps}(n))return Vc(o)||u_(o);i=()=>new o(...kc(n.deps))}return i}function Dd(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function h_(n,t){for(const e of n)Array.isArray(e)?h_(e,t):e&&bi(e)?h_(e.\u0275providers,t):t(e)}class ww{}class Yv{}class lc{resolveComponentFactory(t){throw function Xv(n){const t=Error(`No component factory found for ${vi(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Kc=(()=>{class n{}return n.NULL=new lc,n})();function dm(){return El(Nr(),ft())}function El(n,t){return new _i(ls(n,t))}let _i=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=dm,n})();function Cw(n){return n instanceof _i?n.nativeElement:n}class Qc{}let Jc=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Ew(){const n=ft(),e=ji(Nr().index,n);return(Lr(e)?e:n)[jn]}(),n})(),Np=(()=>{class n{}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:()=>null}),n})();class Bu{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Qv=new Bu("15.2.9"),Ri={},Bp="ngOriginalError";function hm(n){return n[Bp]}class fs{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t);this._console.error("ERROR",t),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&hm(t);for(;e&&hm(e);)e=hm(e);return e||null}}function eu(n){return n instanceof Function?n():n}function tb(n,t,e){let i=n.length;for(;;){const o=n.indexOf(t,e);if(-1===o)return o;if(0===o||n.charCodeAt(o-1)<=32){const c=t.length;if(o+c===i||n.charCodeAt(o+c)<=32)return o}e=o+1}}const nb="ng-template";function m_(n,t,e){let i=0,o=!0;for(;i<n.length;){let c=n[i++];if("string"==typeof c&&o){const f=n[i++];if(e&&"class"===c&&-1!==tb(f.toLowerCase(),t,0))return!0}else{if(1===c){for(;i<n.length&&"string"==typeof(c=n[i++]);)if(c.toLowerCase()===t)return!0;return!1}"number"==typeof c&&(o=!1)}}return!1}function pm(n){return 4===n.type&&n.value!==nb}function ib(n,t,e){return t===(4!==n.type||e?n.value:nb)}function ca(n,t,e){let i=4;const o=n.attrs||[],c=function Pw(n){for(let t=0;t<n.length;t++)if(At(n[t]))return t;return n.length}(o);let f=!1;for(let v=0;v<t.length;v++){const C=t[v];if("number"!=typeof C){if(!f)if(4&i){if(i=2|1&i,""!==C&&!ib(n,C,e)||""===C&&1===t.length){if(Ss(i))return!1;f=!0}}else{const S=8&i?C:t[++v];if(8&i&&null!==n.attrs){if(!m_(n.attrs,S,e)){if(Ss(i))return!1;f=!0}continue}const V=Sh(8&i?"class":C,o,pm(n),e);if(-1===V){if(Ss(i))return!1;f=!0;continue}if(""!==S){let Q;Q=V>c?"":o[V+1].toLowerCase();const oe=8&i?Q:null;if(oe&&-1!==tb(oe,S,0)||2&i&&S!==Q){if(Ss(i))return!1;f=!0}}}}else{if(!f&&!Ss(i)&&!Ss(C))return!1;if(f&&Ss(C))continue;f=!1,i=C|1&i}}return Ss(i)||f}function Ss(n){return 0==(1&n)}function Sh(n,t,e,i){if(null===t)return-1;let o=0;if(i||!e){let c=!1;for(;o<t.length;){const f=t[o];if(f===n)return o;if(3===f||6===f)c=!0;else{if(1===f||2===f){let v=t[++o];for(;"string"==typeof v;)v=t[++o];continue}if(4===f)break;if(0===f){o+=4;continue}}o+=c?1:2}return-1}return function rb(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function fm(n,t,e=!1){for(let i=0;i<t.length;i++)if(ca(n,t[i],e))return!0;return!1}function ob(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let o=0;o<n.length;o++)if(n[o]!==i[o])continue e;return!0}}return!1}function sb(n,t){return n?":not("+t.trim()+")":t}function ab(n){let t=n[0],e=1,i=2,o="",c=!1;for(;e<n.length;){let f=n[e];if("string"==typeof f)if(2&i){const v=n[++e];o+="["+f+(v.length>0?'="'+v+'"':"")+"]"}else 8&i?o+="."+f:4&i&&(o+=" "+f);else""!==o&&!Ss(f)&&(t+=sb(c,o),o=""),i=f,c=c||!Ss(i);e++}return""!==o&&(t+=sb(c,o)),t}const $n={};function Et(n){__(ui(),ft(),K()+n,!1)}function __(n,t,e,i){if(!i)if(3==(3&t[Un])){const c=n.preOrderCheckHooks;null!==c&&Se(t,c,e)}else{const c=n.preOrderHooks;null!==c&&Fe(t,c,0,e)}J(e)}function Th(n,t=null,e=null,i){const o=v_(n,t,e,i);return o.resolveInjectorInitializers(),o}function v_(n,t=null,e=null,i,o=new Set){const c=[e||xi,qv(n)];return i=i||("object"==typeof n?void 0:vi(n)),new Wv(c,t||cm(),i||null,o)}let Ts=(()=>{class n{static create(e,i){if(Array.isArray(e))return Th({name:""},i,e,"");{const o=e.name??"";return Th({name:o},e.parent,e.providers,o)}}}return n.THROW_IF_NOT_FOUND=ws,n.NULL=new o_,n.\u0275prov=Mt({token:n,providedIn:"any",factory:()=>We(Gv)}),n.__NG_ELEMENT_ID__=-1,n})();function ve(n,t=dn.Default){const e=ft();return null===e?We(n,t):za(Nr(),e,pn(n),t)}function nu(){throw new Error("invalid")}function jp(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const c=e[i+1];if(-1!==c){const f=n.data[c];_(e[i]),f.contentQueries(2,t[c],c)}}}function iu(n,t,e,i,o,c,f,v,C,S,R){const V=t.blueprint.slice();return V[Cs]=o,V[Un]=76|i,(null!==R||n&&1024&n[Un])&&(V[Un]|=1024),Ra(V),V[Li]=V[Do]=n,V[ur]=e,V[Lc]=f||n&&n[Lc],V[jn]=v||n&&n[jn],V[Nc]=C||n&&n[Nc]||null,V[Oc]=S||n&&n[Oc]||null,V[Or]=c,V[ss]=function tw(){return xv++}(),V[ml]=R,V[kr]=2==t.type?n[kr]:V,V}function ru(n,t,e,i,o){let c=n.data[t];if(null===c)c=function M_(n,t,e,i,o){const c=Tu(),f=Au(),C=n.data[t]=function Dm(n,t,e,i,o,c){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:c,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,f?c:c&&c.parent,e,t,i,o);return null===n.firstChild&&(n.firstChild=C),null!==c&&(f?null==c.child&&null!==C.parent&&(c.child=C):null===c.next&&(c.next=C,C.prev=c)),C}(n,t,e,i,o),function Rf(){return En.lFrame.inI18n}()&&(c.flags|=32);else if(64&c.type){c.type=e,c.value=i,c.attrs=o;const f=function Kl(){const n=En.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();c.injectorIndex=null===f?-1:f.injectorIndex}return zo(c,!0),c}function kh(n,t,e,i){if(0===e)return-1;const o=t.length;for(let c=0;c<e;c++)t.push(i),n.blueprint.push(i),n.data.push(null);return o}function xm(n,t,e){M(t);try{const i=n.viewQuery;null!==i&&Tm(1,i,e);const o=n.template;null!==o&&S_(n,t,o,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&jp(n,t),n.staticViewQueries&&Tm(2,n.viewQuery,e);const c=n.components;null!==c&&function Uw(n,t){for(let e=0;e<t.length;e++)Tb(n,t[e])}(t,c)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[Un]&=-5,U()}}function wm(n,t,e,i){const o=t[Un];if(128!=(128&o)){M(t);try{Ra(t),function oh(n){return En.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&S_(n,t,e,2,i);const f=3==(3&o);if(f){const S=n.preOrderCheckHooks;null!==S&&Se(t,S,null)}else{const S=n.preOrderHooks;null!==S&&Fe(t,S,0,null),Le(t,0)}if(function Sb(n){for(let t=Ga(n);null!==t;t=qa(t)){if(!t[Hs])continue;const e=t[ra];for(let i=0;i<e.length;i++){const o=e[i];512&o[Un]||ih(o[Li],1),o[Un]|=512}}}(t),function Mb(n){for(let t=Ga(n);null!==t;t=qa(t))for(let e=lo;e<t.length;e++){const i=t[e],o=i[jt];ud(i)&&wm(o,i,o.template,i[ur])}}(t),null!==n.contentQueries&&jp(n,t),f){const S=n.contentCheckHooks;null!==S&&Se(t,S)}else{const S=n.contentHooks;null!==S&&Fe(t,S,1),Le(t,1)}!function Up(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const o=e[i];if(o<0)J(~o);else{const c=o,f=e[++i],v=e[++i];sh(f,c),v(2,t[c])}}}finally{J(-1)}}(n,t);const v=n.components;null!==v&&function Vw(n,t){for(let e=0;e<t.length;e++)z_(n,t[e])}(t,v);const C=n.viewQuery;if(null!==C&&Tm(2,C,i),f){const S=n.viewCheckHooks;null!==S&&Se(t,S)}else{const S=n.viewHooks;null!==S&&Fe(t,S,2),Le(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[Un]&=-41,512&t[Un]&&(t[Un]&=-513,ih(t[Li],-1))}finally{U()}}}function S_(n,t,e,i,o){const c=K(),f=2&i;try{J(-1),f&&t.length>Ai&&__(n,t,Ai,!1),as(f?2:0,o),e(i,o)}finally{J(c),as(f?3:1,o)}}function T_(n,t,e){if(Eu(t)){const o=t.directiveEnd;for(let c=t.directiveStart;c<o;c++){const f=n.data[c];f.contentQueries&&f.contentQueries(1,e[c],c)}}}function Cm(n,t,e){Su()&&(function L_(n,t,e,i){const o=e.directiveStart,c=e.directiveEnd;ka(e)&&function dc(n,t,e){const i=ls(t,n),o=I_(e),c=n[Lc],f=Gp(n,iu(n,o,null,e.onPush?32:16,i,t,c,c.createRenderer(i,e),null,null,null));n[t.index]=f}(t,e,n.data[o+e.componentOffset]),n.firstCreatePass||Br(e,t),Vr(i,t);const f=e.initialInputs;for(let v=o;v<c;v++){const C=n.data[v],S=ku(t,n,v,e);Vr(S,t),null!==f&&ju(0,v-o,S,C,0,f),k(C)&&(ji(e.index,t)[ur]=ku(t,n,v,e))}}(n,t,e,ls(e,t)),64==(64&e.flags)&&Cb(n,t,e))}function A_(n,t,e=ls){const i=t.localNames;if(null!==i){let o=t.index+1;for(let c=0;c<i.length;c+=2){const f=i[c+1],v=-1===f?e(t,n):n[f];n[o++]=v}}}function I_(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=k_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function k_(n,t,e,i,o,c,f,v,C,S){const R=Ai+i,V=R+o,Q=function jw(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:$n);return e}(R,V),oe="function"==typeof S?S():S;return Q[jt]={type:n,blueprint:Q,template:e,queries:null,viewQuery:v,declTNode:t,data:Q.slice().fill(null,R),bindingStartIndex:R,expandoStartIndex:V,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof c?c():c,pipeRegistry:"function"==typeof f?f():f,firstChild:null,schemas:C,consts:oe,incompleteFirstPass:!1}}function $p(n,t,e,i){const o=U_(t);null===e?o.push(i):(o.push(e),n.firstCreatePass&&Ib(n).push(i,o.length-1))}function bb(n,t,e,i){for(let o in n)if(n.hasOwnProperty(o)){e=null===e?{}:e;const c=n[o];null===i?Mm(e,t,o,c):i.hasOwnProperty(o)&&Mm(e,t,i[o],c)}return e}function Mm(n,t,e,i){n.hasOwnProperty(e)?n[e].push(t,i):n[e]=[t,i]}function ua(n,t,e,i,o,c,f,v){const C=ls(t,e);let R,S=t.inputs;!v&&null!=S&&(R=S[i])?(j_(n,e,R,i,o),ka(t)&&function R_(n,t){const e=ji(t,n);16&e[Un]||(e[Un]|=32)}(e,t.index)):3&t.type&&(i=function Uu(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),o=null!=f?f(o,t.value||"",i):o,c.setProperty(C,i,o))}function O_(n,t,e,i){if(Su()){const o=null===i?null:{"":-1},c=function Gw(n,t){const e=n.directiveRegistry;let i=null,o=null;if(e)for(let c=0;c<e.length;c++){const f=e[c];if(fm(t,f.selectors,!1))if(i||(i=[]),k(f))if(null!==f.findHostDirectiveDefs){const v=[];o=o||new Map,f.findHostDirectiveDefs(f,v,o),i.unshift(...v,f),N_(n,t,v.length)}else i.unshift(f),N_(n,t,0);else o=o||new Map,f.findHostDirectiveDefs?.(f,i,o),i.push(f)}return null===i?null:[i,o]}(n,e);let f,v;null===c?f=v=null:[f,v]=c,null!==f&&wb(n,t,e,f,o,v),o&&function Eb(n,t,e){if(t){const i=n.localNames=[];for(let o=0;o<t.length;o+=2){const c=e[t[o+1]];if(null==c)throw new nt(-301,!1);i.push(t[o],c)}}}(e,i,o)}e.mergedAttrs=kn(e.mergedAttrs,e.attrs)}function wb(n,t,e,i,o,c){for(let S=0;S<i.length;S++)Ba(Br(e,t),n,i[S].type);!function Db(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}(e,n.data.length,i.length);for(let S=0;S<i.length;S++){const R=i[S];R.providersResolver&&R.providersResolver(R)}let f=!1,v=!1,C=kh(n,t,i.length,null);for(let S=0;S<i.length;S++){const R=i[S];e.mergedAttrs=kn(e.mergedAttrs,R.hostAttrs),Xa(n,e,t,C,R),qw(C,R,o),null!==R.contentQueries&&(e.flags|=4),(null!==R.hostBindings||null!==R.hostAttrs||0!==R.hostVars)&&(e.flags|=64);const V=R.type.prototype;!f&&(V.ngOnChanges||V.ngOnInit||V.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(e.index),f=!0),!v&&(V.ngOnChanges||V.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(e.index),v=!0),C++}!function P_(n,t,e){const o=t.directiveEnd,c=n.data,f=t.attrs,v=[];let C=null,S=null;for(let R=t.directiveStart;R<o;R++){const V=c[R],Q=e?e.get(V):null,me=Q?Q.outputs:null;C=bb(V.inputs,R,C,Q?Q.inputs:null),S=bb(V.outputs,R,S,me);const Ee=null===C||null===f||pm(t)?null:Sm(C,R,f);v.push(Ee)}null!==C&&(C.hasOwnProperty("class")&&(t.flags|=8),C.hasOwnProperty("style")&&(t.flags|=16)),t.initialInputs=v,t.inputs=C,t.outputs=S}(n,e,c)}function Cb(n,t,e){const i=e.directiveStart,o=e.directiveEnd,c=e.index,f=function fd(){return En.lFrame.currentDirectiveIndex}();try{J(c);for(let v=i;v<o;v++){const C=n.data[v],S=t[v];m(v),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Hp(C,S)}}finally{J(-1),m(f)}}function Hp(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function N_(n,t,e){t.componentOffset=e,(n.components??(n.components=[])).push(t.index)}function qw(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;k(t)&&(e[""]=n)}}function Xa(n,t,e,i,o){n.data[i]=o;const c=o.factory||(o.factory=Vc(o.type)),f=new je(c,k(o),ve);n.blueprint[i]=f,e[i]=f,function $w(n,t,e,i,o){const c=o.hostBindings;if(c){let f=n.hostBindingOpCodes;null===f&&(f=n.hostBindingOpCodes=[]);const v=~t.index;(function Hw(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(f)!=v&&f.push(v),f.push(e,i,c)}}(n,t,i,kh(n,e,o.hostVars,$n),o)}function $o(n,t,e,i,o,c){const f=ls(n,t);!function Ka(n,t,e,i,o,c,f){if(null==c)n.removeAttribute(t,o,e);else{const v=null==f?Sn(c):f(c,i||"",o);n.setAttribute(t,o,v,e)}}(t[jn],f,c,n.value,e,i,o)}function ju(n,t,e,i,o,c){const f=c[t];if(null!==f){const v=i.setInput;for(let C=0;C<f.length;){const S=f[C++],R=f[C++],V=f[C++];null!==v?i.setInput(e,V,S,R):e[R]=V}}}function Sm(n,t,e){let i=null,o=0;for(;o<e.length;){const c=e[o];if(0!==c)if(5!==c){if("number"==typeof c)break;if(n.hasOwnProperty(c)){null===i&&(i=[]);const f=n[c];for(let v=0;v<f.length;v+=2)if(f[v]===t){i.push(c,f[v+1],e[o+1]);break}}o+=2}else o+=2;else o+=4}return i}function B_(n,t,e,i){return[n,!0,!1,t,null,0,i,e,null,null]}function z_(n,t){const e=ji(t,n);if(ud(e)){const i=e[jt];48&e[Un]?wm(i,e,i.template,e[ur]):e[$s]>0&&V_(e)}}function V_(n){for(let i=Ga(n);null!==i;i=qa(i))for(let o=lo;o<i.length;o++){const c=i[o];if(ud(c))if(512&c[Un]){const f=c[jt];wm(f,c,f.template,c[ur])}else c[$s]>0&&V_(c)}const e=n[jt].components;if(null!==e)for(let i=0;i<e.length;i++){const o=ji(e[i],n);ud(o)&&o[$s]>0&&V_(o)}}function Tb(n,t){const e=ji(t,n),i=e[jt];(function Ab(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),xm(i,e,e[ur])}function Gp(n,t){return n[Bc]?n[Cu][rs]=t:n[Bc]=t,n[Cu]=t,t}function qp(n){for(;n;){n[Un]|=32;const t=vh(n);if(F(n)&&!t)return n;n=t}return null}function Wp(n,t,e,i=!0){const o=t[Lc];o.begin&&o.begin();try{wm(n,t,n.template,e)}catch(f){throw i&&Zp(t,f),f}finally{o.end&&o.end()}}function Tm(n,t,e){_(0),t(n,e)}function U_(n){return n[Es]||(n[Es]=[])}function Ib(n){return n.cleanup||(n.cleanup=[])}function kb(n,t,e){return(null===n||k(n))&&(e=function ld(n){for(;Array.isArray(n);){if("object"==typeof n[Ia])return n;n=n[Cs]}return null}(e[t.index])),e[jn]}function Zp(n,t){const e=n[Oc],i=e?e.get(fs,null):null;i&&i.handleError(t)}function j_(n,t,e,i,o){for(let c=0;c<e.length;){const f=e[c++],v=e[c++],C=t[f],S=n.data[f];null!==S.setInput?S.setInput(C,o,i,v):C[v]=o}}function Ph(n,t,e){let i=e?n.styles:null,o=e?n.classes:null,c=0;if(null!==t)for(let f=0;f<t.length;f++){const v=t[f];"number"==typeof v?c=v:1==c?o=Tn(o,v):2==c&&(i=Tn(i,v+": "+t[++f]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=o:n.classesWithoutHost=o}function Rh(n,t,e,i,o=!1){for(;null!==e;){const c=t[e.index];if(null!==c&&i.push(Pr(c)),Bo(c))for(let v=lo;v<c.length;v++){const C=c[v],S=C[jt].firstChild;null!==S&&Rh(C[jt],C,S,i)}const f=e.type;if(8&f)Rh(n,t,e.child,i);else if(32&f){const v=Ag(e,t);let C;for(;C=v();)i.push(C)}else if(16&f){const v=$g(t,e);if(Array.isArray(v))i.push(...v);else{const C=vh(t[kr]);Rh(C[jt],C,v,i,!0)}}e=o?e.projectionNext:e.next}return i}class Zs{get rootNodes(){const t=this._lView,e=t[jt];return Rh(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ur]}set context(t){this._lView[ur]=t}get destroyed(){return 128==(128&this._lView[Un])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[Li];if(Bo(t)){const e=t[Cn],i=e?e.indexOf(this):-1;i>-1&&(Lg(t,i),ec(e,i))}this._attachedToViewContainer=!1}rc(this._lView[jt],this._lView)}onDestroy(t){$p(this._lView[jt],this._lView,null,t)}markForCheck(){qp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Un]&=-65}reattach(){this._lView[Un]|=64}detectChanges(){Wp(this._lView[jt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new nt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Dv(n,t){Ip(n,t,t[jn],2,null,null)}(this._lView[jt],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new nt(902,!1);this._appRef=t}}class $_ extends Zs{constructor(t){super(t),this._view=t}detectChanges(){const t=this._view;Wp(t[jt],t,t[ur],!1)}checkNoChanges(){}get context(){return null}}class Am extends Kc{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=wi(t);return new Fh(e,this.ngModule)}}function Qa(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class Pb{constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=ul(i);const o=this.injector.get(t,Ri,i);return o!==Ri||e===Ri?o:this.parentInjector.get(t,e,i)}}class Fh extends Yv{get inputs(){return Qa(this.componentDef.inputs)}get outputs(){return Qa(this.componentDef.outputs)}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function lb(n){return n.map(ab).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}create(t,e,i,o){let c=(o=o||this.ngModule)instanceof Xc?o:o?.injector;c&&null!==this.componentDef.getStandaloneInjector&&(c=this.componentDef.getStandaloneInjector(c)||c);const f=c?new Pb(t,c):t,v=f.get(Qc,null);if(null===v)throw new nt(407,!1);const C=f.get(Np,null),S=v.createRenderer(null,this.componentDef),R=this.componentDef.selectors[0][0]||"div",V=i?function Em(n,t,e){return n.selectRootElement(t,e===No.ShadowDom)}(S,i,this.componentDef.encapsulation):jf(S,R,function Sd(n){const t=n.toLowerCase();return"svg"===t?nh:"math"===t?"math":null}(R)),Q=this.componentDef.onPush?288:272,oe=k_(0,null,null,1,0,null,null,null,null,null),me=iu(null,oe,null,Q,null,null,v,S,C,f,null);let Ee,$e;M(me);try{const lt=this.componentDef;let St,rt=null;lt.findHostDirectiveDefs?(St=[],rt=new Map,lt.findHostDirectiveDefs(lt,St,rt),St.push(lt)):St=[lt];const Yt=function Rb(n,t){const e=n[jt],i=Ai;return n[i]=t,ru(e,i,2,"#host",null)}(me,V),Ci=function Fb(n,t,e,i,o,c,f,v){const C=o[jt];!function Zw(n,t,e,i){for(const o of n)t.mergedAttrs=kn(t.mergedAttrs,o.hostAttrs);null!==t.mergedAttrs&&(Ph(t,t.mergedAttrs,!0),null!==e&&Wf(i,e,t))}(i,n,t,f);const S=c.createRenderer(t,e),R=iu(o,I_(e),null,e.onPush?32:16,o[n.index],n,c,S,v||null,null,null);return C.firstCreatePass&&N_(C,n,i.length-1),Gp(o,R),o[n.index]=R}(Yt,V,lt,St,me,v,S);$e=hp(oe,Ai),V&&function Lb(n,t,e,i){if(i)Rt(n,e,["ng-version",Qv.full]);else{const{attrs:o,classes:c}=function g_(n){const t=[],e=[];let i=1,o=2;for(;i<n.length;){let c=n[i];if("string"==typeof c)2===o?""!==c&&t.push(c,n[++i]):8===o&&e.push(c);else{if(!Ss(o))break;o=c}i++}return{attrs:t,classes:e}}(t.selectors[0]);o&&Rt(n,e,o),c&&c.length>0&&qg(n,e,c.join(" "))}}(S,lt,V,i),void 0!==e&&function Yw(n,t,e){const i=n.projection=[];for(let o=0;o<t.length;o++){const c=e[o];i.push(null!=c?Array.from(c):null)}}($e,this.ngContentSelectors,e),Ee=function Ob(n,t,e,i,o,c){const f=Nr(),v=o[jt],C=ls(f,o);wb(v,o,f,e,null,i);for(let R=0;R<e.length;R++)Vr(ku(o,v,f.directiveStart+R,f),o);Cb(v,o,f),C&&Vr(C,o);const S=ku(o,v,f.directiveStart+f.componentOffset,f);if(n[ur]=o[ur]=S,null!==c)for(const R of c)R(S,t);return T_(v,f,n),S}(Ci,lt,St,rt,me,[G_]),xm(oe,me,null)}finally{U()}return new Yp(this.componentType,Ee,El($e,me),me,$e)}}class Yp extends ww{constructor(t,e,i,o,c){super(),this.location=i,this._rootLView=o,this._tNode=c,this.instance=e,this.hostView=this.changeDetectorRef=new $_(o),this.componentType=t}setInput(t,e){const i=this._tNode.inputs;let o;if(null!==i&&(o=i[t])){const c=this._rootLView;j_(c[jt],c,o,t,e),qp(ji(this._tNode.index,c))}}get injector(){return new md(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}function G_(){const n=Nr();we(ft()[jt],n)}function Zn(n){let t=function q_(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let o;if(k(n))o=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new nt(903,!1);o=t.\u0275dir}if(o){if(e){i.push(o);const f=n;f.inputs=r(n.inputs),f.declaredInputs=r(n.declaredInputs),f.outputs=r(n.outputs);const v=o.hostBindings;v&&p(n,v);const C=o.viewQuery,S=o.contentQueries;if(C&&a(n,C),S&&u(n,S),es(n.inputs,o.inputs),es(n.declaredInputs,o.declaredInputs),es(n.outputs,o.outputs),k(o)&&o.data.animation){const R=n.data;R.animation=(R.animation||[]).concat(o.data.animation)}}const c=o.features;if(c)for(let f=0;f<c.length;f++){const v=c[f];v&&v.ngInherit&&v(n),v===Zn&&(e=!1)}}t=Object.getPrototypeOf(t)}!function s(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const o=n[i];o.hostVars=t+=o.hostVars,o.hostAttrs=kn(o.hostAttrs,e=kn(e,o.hostAttrs))}}(i)}function r(n){return n===Us?{}:n===xi?[]:n}function a(n,t){const e=n.viewQuery;n.viewQuery=e?(i,o)=>{t(i,o),e(i,o)}:t}function u(n,t){const e=n.contentQueries;n.contentQueries=e?(i,o,c)=>{t(i,o,c),e(i,o,c)}:t}function p(n,t){const e=n.hostBindings;n.hostBindings=e?(i,o)=>{t(i,o),e(i,o)}:t}function $(n){return!!he(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function he(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ce(n,t,e){return n[t]=e}function de(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function Ze(n,t,e,i){const o=ft();return de(o,$c(),t)&&(ui(),$o(Y(),o,n,t,e,i)),Ze}function Ye(n,t,e,i){return de(n,$c(),e)?t+Sn(e)+i:$n}function $t(n,t,e,i,o,c,f,v){const C=ft(),S=ui(),R=n+Ai,V=S.firstCreatePass?function Fi(n,t,e,i,o,c,f,v,C){const S=t.consts,R=ru(t,n,4,f||null,_l(S,v));O_(t,e,R,_l(S,C)),we(t,R);const V=R.tView=k_(2,R,i,o,c,t.directiveRegistry,t.pipeRegistry,null,t.schemas,S);return null!==t.queries&&(t.queries.template(t,R),V.queries=t.queries.embeddedTView(R)),R}(R,S,C,t,e,i,o,c,f):S.data[R];zo(V,!1);const Q=C[jn].createComment("");xd(S,C,Q,V),Vr(Q,C),Gp(C,C[R]=B_(Q,C,Q,V)),Pa(V)&&Cm(S,C,V),null!=f&&A_(C,V,v)}function Ii(n){return gl(function kf(){return En.lFrame.contextLView}(),Ai+n)}function ht(n,t,e){const i=ft();return de(i,$c(),t)&&ua(ui(),Y(),i,n,t,i[jn],e,!1),ht}function nr(n,t,e,i,o){const f=o?"class":"style";j_(n,e,t.inputs[f],f,i)}function pe(n,t,e,i){const o=ft(),c=ui(),f=Ai+n,v=o[jn],C=c.firstCreatePass?function fo(n,t,e,i,o,c){const f=t.consts,C=ru(t,n,2,i,_l(f,o));return O_(t,e,C,_l(f,c)),null!==C.attrs&&Ph(C,C.attrs,!1),null!==C.mergedAttrs&&Ph(C,C.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,C),C}(f,c,o,t,e,i):c.data[f],S=o[f]=jf(v,t,function ye(){return En.lFrame.currentNamespace}()),R=Pa(C);return zo(C,!0),Wf(v,S,C),32!=(32&C.flags)&&xd(c,o,S,C),0===function Ot(){return En.lFrame.elementDepthCount}()&&Vr(S,o),function If(){En.lFrame.elementDepthCount++}(),R&&(Cm(c,o,C),T_(c,C,o)),null!==i&&A_(o,C),pe}function xe(){let n=Nr();Au()?rh():(n=n.parent,zo(n,!1));const t=n;!function dd(){En.lFrame.elementDepthCount--}();const e=ui();return e.firstCreatePass&&(we(e,n),Eu(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function st(n){return 0!=(8&n.flags)}(t)&&nr(e,t,ft(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function ut(n){return 0!=(16&n.flags)}(t)&&nr(e,t,ft(),t.stylesWithoutHost,!1),xe}function It(n,t,e,i){return pe(n,t,e,i),xe(),It}function Xi(){return ft()}function Ur(n){return!!n&&"function"==typeof n.then}const jr=function no(n){return!!n&&"function"==typeof n.subscribe};function mn(n,t,e,i){const o=ft(),c=ui(),f=Nr();return Td(c,o,o[jn],f,n,t,i),mn}function $r(n,t){const e=Nr(),i=ft(),o=ui();return Td(o,i,kb(l(o.data),e,i),e,n,t),$r}function Td(n,t,e,i,o,c,f){const v=Pa(i),S=n.firstCreatePass&&Ib(n),R=t[ur],V=U_(t);let Q=!0;if(3&i.type||f){const Ee=ls(i,t),$e=f?f(Ee):Ee,lt=V.length,St=f?Yt=>f(Pr(Yt[i.index])):i.index;let rt=null;if(!f&&v&&(rt=function ou(n,t,e,i){const o=n.cleanup;if(null!=o)for(let c=0;c<o.length-1;c+=2){const f=o[c];if(f===e&&o[c+1]===i){const v=t[Es],C=o[c+2];return v.length>C?v[C]:null}"string"==typeof f&&(c+=2)}return null}(n,t,o,i.index)),null!==rt)(rt.__ngLastListenerFn__||rt).__ngNextListenerFn__=c,rt.__ngLastListenerFn__=c,Q=!1;else{c=Lh(i,t,R,c,!1);const Yt=e.listen($e,o,c);V.push(c,Yt),S&&S.push(o,St,lt,lt+1)}}else c=Lh(i,t,R,c,!1);const oe=i.outputs;let me;if(Q&&null!==oe&&(me=oe[o])){const Ee=me.length;if(Ee)for(let $e=0;$e<Ee;$e+=2){const Ci=t[me[$e]][me[$e+1]].subscribe(c),Qi=V.length;V.push(c,Ci),S&&S.push(o,i.index,Qi,-(Qi+1))}}}function Oh(n,t,e,i){try{return as(6,t,e),!1!==e(i)}catch(o){return Zp(n,o),!1}finally{as(7,t,e)}}function Lh(n,t,e,i,o){return function c(f){if(f===Function)return i;qp(n.componentOffset>-1?ji(n.index,t):t);let C=Oh(t,e,i,f),S=c.__ngNextListenerFn__;for(;S;)C=Oh(t,e,S,f)&&C,S=S.__ngNextListenerFn__;return o&&!1===C&&(f.preventDefault(),f.returnValue=!1),C}}function ri(n=1){return function W(n){return(En.lFrame.contextLView=function X(n,t){for(;n>0;)t=t[Do],n--;return t}(n,En.lFrame.contextLView))[ur]}(n)}function Nb(n,t){let e=null;const i=function mm(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(!(1&e))return t[e+1]}return null}(n);for(let o=0;o<t.length;o++){const c=t[o];if("*"!==c){if(null===i?fm(n,c,!0):ob(i,c))return o}else e=o}return e}function Dl(n){const t=ft()[kr][Or];if(!t.projection){const i=t.projection=yp(n?n.length:1,null),o=i.slice();let c=t.child;for(;null!==c;){const f=n?Nb(c,n):0;null!==f&&(o[f]?o[f].projectionNext=c:i[f]=c,o[f]=c),c=c.next}}}function yr(n,t=0,e){const i=ft(),o=ui(),c=ru(o,Ai+n,16,null,e||null);null===c.projection&&(c.projection=t),rh(),32!=(32&c.flags)&&function Tv(n,t,e){Av(t[jn],0,t,e,Gf(n,e,t),Vg(e.parent||t[Or],e,t))}(o,i,c)}function Nh(n,t,e){return Ja(n,"",t,"",e),Nh}function Ja(n,t,e,i,o){const c=ft(),f=Ye(c,t,e,i);return f!==$n&&ua(ui(),Y(),c,n,f,c[jn],o,!1),Ja}function Ho(n,t){return n<<17|t<<2}function el(n){return n>>17&32767}function au(n){return 2|n}function Xp(n){return(131068&n)>>2}function Xw(n,t){return-131069&n|t<<2}function Kw(n){return 1|n}function FD(n,t,e,i,o){const c=n[e+1],f=null===t;let v=i?el(c):Xp(c),C=!1;for(;0!==v&&(!1===C||f);){const R=n[v+1];vR(n[v],t)&&(C=!0,n[v+1]=i?Kw(R):au(R)),v=i?el(R):Xp(R)}C&&(n[e+1]=i?au(c):Kw(c))}function vR(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&ch(n,t)>=0}const Go={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function OD(n){return n.substring(Go.key,Go.keyEnd)}function LD(n,t){const e=Go.textEnd;return e===t?-1:(t=Go.keyEnd=function CR(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}(n,Go.key=t,e),Rm(n,t,e))}function Rm(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function Kp(n,t,e){return lu(n,t,e,!1),Kp}function vr(n,t){return lu(n,t,null,!0),vr}function Gu(n,t){for(let e=function xR(n){return function BD(n){Go.key=0,Go.keyEnd=0,Go.value=0,Go.valueEnd=0,Go.textEnd=n.length}(n),LD(n,Rm(n,0,Go.textEnd))}(t);e>=0;e=LD(t,e))us(n,OD(t),!0)}function lu(n,t,e,i){const o=ft(),c=ui(),f=Oa(2);c.firstUpdatePass&&jD(c,n,f,i),t!==$n&&de(o,f,t)&&HD(c,c.data[K()],o,o[jn],n,o[f+1]=function OR(n,t){return null==n||""===n||("string"==typeof t?n+=t:"object"==typeof n&&(n=vi(Ao(n)))),n}(t,e),i,f)}function UD(n,t){return t>=n.expandoStartIndex}function jD(n,t,e,i){const o=n.data;if(null===o[e+1]){const c=o[K()],f=UD(n,e);qD(c,i)&&null===t&&!f&&(t=!1),t=function TR(n,t,e,i){const o=l(n);let c=i?t.residualClasses:t.residualStyles;if(null===o)0===(i?t.classBindings:t.styleBindings)&&(e=Y_(e=Qw(null,n,t,e,i),t.attrs,i),c=null);else{const f=t.directiveStylingLast;if(-1===f||n[f]!==o)if(e=Qw(o,n,t,e,i),null===c){let C=function AR(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==Xp(i))return n[el(i)]}(n,t,i);void 0!==C&&Array.isArray(C)&&(C=Qw(null,n,t,C[1],i),C=Y_(C,t.attrs,i),function IR(n,t,e,i){n[el(e?t.classBindings:t.styleBindings)]=i}(n,t,i,C))}else c=function kR(n,t,e){let i;const o=t.directiveEnd;for(let c=1+t.directiveStylingLast;c<o;c++)i=Y_(i,n[c].hostAttrs,e);return Y_(i,t.attrs,e)}(n,t,i)}return void 0!==c&&(i?t.residualClasses=c:t.residualStyles=c),e}(o,c,t,i),function _R(n,t,e,i,o,c){let f=c?t.classBindings:t.styleBindings,v=el(f),C=Xp(f);n[i]=e;let R,S=!1;if(Array.isArray(e)?(R=e[1],(null===R||ch(e,R)>0)&&(S=!0)):R=e,o)if(0!==C){const Q=el(n[v+1]);n[i+1]=Ho(Q,v),0!==Q&&(n[Q+1]=Xw(n[Q+1],i)),n[v+1]=function zb(n,t){return 131071&n|t<<17}(n[v+1],i)}else n[i+1]=Ho(v,0),0!==v&&(n[v+1]=Xw(n[v+1],i)),v=i;else n[i+1]=Ho(C,0),0===v?v=i:n[C+1]=Xw(n[C+1],i),C=i;S&&(n[i+1]=au(n[i+1])),FD(n,R,i,!0),FD(n,R,i,!1),function yR(n,t,e,i,o){const c=o?n.residualClasses:n.residualStyles;null!=c&&"string"==typeof t&&ch(c,t)>=0&&(e[i+1]=Kw(e[i+1]))}(t,R,n,i,c),f=Ho(v,C),c?t.classBindings=f:t.styleBindings=f}(o,c,t,e,f,i)}}function Qw(n,t,e,i,o){let c=null;const f=e.directiveEnd;let v=e.directiveStylingLast;for(-1===v?v=e.directiveStart:v++;v<f&&(c=t[v],i=Y_(i,c.hostAttrs,o),c!==n);)v++;return null!==n&&(e.directiveStylingLast=v),i}function Y_(n,t,e){const i=e?1:2;let o=-1;if(null!==t)for(let c=0;c<t.length;c++){const f=t[c];"number"==typeof f?o=f:o===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),us(n,f,!!e||t[++c]))}return void 0===n?null:n}function HD(n,t,e,i,o,c,f,v){if(!(3&t.type))return;const C=n.data,S=C[v+1],R=function gR(n){return 1==(1&n)}(S)?GD(C,t,e,o,Xp(S),f):void 0;Vb(R)||(Vb(c)||function Z_(n){return 2==(2&n)}(S)&&(c=GD(C,null,e,o,v,f)),function Iv(n,t,e,i,o){if(t)o?n.addClass(e,i):n.removeClass(e,i);else{let c=-1===i.indexOf("-")?void 0:eo.DashCase;null==o?n.removeStyle(e,i,c):("string"==typeof o&&o.endsWith("!important")&&(o=o.slice(0,-10),c|=eo.Important),n.setStyle(e,i,o,c))}}(i,f,cd(K(),e),o,c))}function GD(n,t,e,i,o,c){const f=null===t;let v;for(;o>0;){const C=n[o],S=Array.isArray(C),R=S?C[1]:C,V=null===R;let Q=e[o+1];Q===$n&&(Q=V?xi:void 0);let oe=V?sa(Q,i):R===i?Q:void 0;if(S&&!Vb(oe)&&(oe=sa(C,i)),Vb(oe)&&(v=oe,f))return v;const me=n[o+1];o=f?el(me):Xp(me)}if(null!==t){let C=c?t.residualClasses:t.residualStyles;null!=C&&(v=sa(C,i))}return v}function Vb(n){return void 0!==n}function qD(n,t){return 0!=(n.flags&(t?8:16))}function Qe(n,t=""){const e=ft(),i=ui(),o=n+Ai,c=i.firstCreatePass?ru(i,o,1,t,null):i.data[o],f=e[o]=function to(n,t){return n.createText(t)}(e[jn],t);xd(i,e,f,c),zo(c,!1)}function ms(n){return uu("",n,""),ms}function uu(n,t,e){const i=ft(),o=Ye(i,n,t,e);return o!==$n&&function Ws(n,t,e){const i=cd(t,n);!function kg(n,t,e){n.setValue(t,e)}(n[jn],i,e)}(i,K(),o),uu}function tM(n,t,e){!function cu(n,t,e,i){const o=ui(),c=Oa(2);o.firstUpdatePass&&jD(o,null,c,i);const f=ft();if(e!==$n&&de(f,c,e)){const v=o.data[K()];if(qD(v,i)&&!UD(o,c)){let C=i?v.classesWithoutHost:v.stylesWithoutHost;null!==C&&(e=Tn(C,e||"")),nr(o,v,f,e,i)}else!function FR(n,t,e,i,o,c,f,v){o===$n&&(o=xi);let C=0,S=0,R=0<o.length?o[0]:null,V=0<c.length?c[0]:null;for(;null!==R||null!==V;){const Q=C<o.length?o[C+1]:void 0,oe=S<c.length?c[S+1]:void 0;let Ee,me=null;R===V?(C+=2,S+=2,Q!==oe&&(me=V,Ee=oe)):null===V||null!==R&&R<V?(C+=2,me=R):(S+=2,me=V,Ee=oe),null!==me&&HD(n,t,e,i,me,Ee,f,v),R=C<o.length?o[C]:null,V=S<c.length?c[S]:null}}(o,v,f,f[jn],f[c+1],f[c+1]=function PR(n,t,e){if(null==e||""===e)return xi;const i=[],o=Ao(e);if(Array.isArray(o))for(let c=0;c<o.length;c++)n(i,o[c],!0);else if("object"==typeof o)for(const c in o)o.hasOwnProperty(c)&&n(i,c,o[c]);else"string"==typeof o&&t(i,o);return i}(n,t,e),i,c)}}(us,Gu,Ye(ft(),n,t,e),!0)}function Fm(n,t,e){const i=ft();return de(i,$c(),t)&&ua(ui(),Y(),i,n,t,i[jn],e,!0),Fm}function Jw(n,t,e){const i=ft();if(de(i,$c(),t)){const c=ui(),f=Y();ua(c,f,i,n,t,kb(l(c.data),f,i),e,!0)}return Jw}const Lm="en-US";let pM=Lm;function n1(n,t,e,i,o){if(n=pn(n),Array.isArray(n))for(let c=0;c<n.length;c++)n1(n[c],t,e,i,o);else{const c=ui(),f=ft();let v=Ya(n)?n:pn(n.provide),C=d_(n);const S=Nr(),R=1048575&S.providerIndexes,V=S.directiveStart,Q=S.providerIndexes>>20;if(Ya(n)||!n.multi){const oe=new je(C,o,ve),me=o1(v,t,o?R:R+Q,V);-1===me?(Ba(Br(S,f),c,v),r1(c,n,t.length),t.push(v),S.directiveStart++,S.directiveEnd++,o&&(S.providerIndexes+=1048576),e.push(oe),f.push(oe)):(e[me]=oe,f[me]=oe)}else{const oe=o1(v,t,R+Q,V),me=o1(v,t,R,R+Q),$e=me>=0&&e[me];if(o&&!$e||!o&&!(oe>=0&&e[oe])){Ba(Br(S,f),c,v);const lt=function QF(n,t,e,i,o){const c=new je(n,e,ve);return c.multi=[],c.index=t,c.componentProviders=0,BM(c,o,i&&!e),c}(o?KF:XF,e.length,o,i,C);!o&&$e&&(e[me].providerFactory=lt),r1(c,n,t.length,0),t.push(v),S.directiveStart++,S.directiveEnd++,o&&(S.providerIndexes+=1048576),e.push(lt),f.push(lt)}else r1(c,n,oe>-1?oe:me,BM(e[o?me:oe],C,!o&&i));!o&&i&&$e&&e[me].componentProviders++}}}function r1(n,t,e,i){const o=Ya(t),c=function Op(n){return!!n.useClass}(t);if(o||c){const C=(c?pn(t.useClass):t).prototype.ngOnDestroy;if(C){const S=n.destroyHooks||(n.destroyHooks=[]);if(!o&&t.multi){const R=S.indexOf(e);-1===R?S.push(e,[i,C]):S[R+1].push(i,C)}else S.push(e,C)}}}function BM(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function o1(n,t,e,i){for(let o=e;o<i;o++)if(t[o]===n)return o;return-1}function XF(n,t,e,i){return s1(this.multi,[])}function KF(n,t,e,i){const o=this.multi;let c;if(this.providerFactory){const f=this.providerFactory.componentProviders,v=ku(e,e[jt],this.providerFactory.index,i);c=v.slice(0,f),s1(o,c);for(let C=f;C<v.length;C++)c.push(v[C])}else c=[],s1(o,c);return c}function s1(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function Ki(n,t=[]){return e=>{e.providersResolver=(i,o)=>function YF(n,t,e){const i=ui();if(i.firstCreatePass){const o=k(n);n1(e,i.data,i.blueprint,o,!0),n1(t,i.data,i.blueprint,o,!1)}}(i,o?o(n):n,t)}}class Nm{}class zM{}class VM extends Nm{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Am(this);const i=Eo(t);this._bootstrapComponents=eu(i.bootstrap),this._r3Injector=v_(t,e,[{provide:Nm,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver}],vi(t),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(t)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class a1 extends zM{constructor(t){super(),this.moduleType=t}create(t){return new VM(this.moduleType,t)}}class eO extends Nm{constructor(t,e,i){super(),this.componentFactoryResolver=new Am(this),this.instance=null;const o=new Wv([...t,{provide:Nm,useValue:this},{provide:Kc,useValue:this.componentFactoryResolver}],e||cm(),i,new Set(["environment"]));this.injector=o,o.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Gb(n,t,e=null){return new eO(n,t,e).injector}let tO=(()=>{class n{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e.id)){const i=s_(0,e.type),o=i.length>0?Gb([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e.id,o)}return this.cachedInjectors.get(e.id)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Mt({token:n,providedIn:"environment",factory:()=>new n(We(Xc))}),n})();function l1(n){n.getStandaloneInjector=t=>t.get(tO).getOrCreateStandaloneInjector(n)}function WM(n,t,e,i){return function ZM(n,t,e,i,o,c){const f=t+e;return de(n,f,o)?ce(n,f+1,c?i.call(c,o):i(o)):ty(n,f+1)}(ft(),Mo(),n,t,e,i)}function ty(n,t){const e=n[t];return e===$n?void 0:e}function YM(n,t,e,i,o,c,f){const v=t+e;return function Oe(n,t,e,i){const o=de(n,t,e);return de(n,t+1,i)||o}(n,v,o,c)?ce(n,v+2,f?i.call(f,o,c):i(o,c)):ty(n,v+2)}function eS(n,t,e,i){const o=n+Ai,c=ft(),f=gl(c,o);return function ny(n,t){return n[jt].data[t].pure}(c,o)?YM(c,Mo(),t,f.transform,e,i,f):f.transform(e,i)}function u1(n){return t=>{setTimeout(n,void 0,t)}}const on=class EO extends yn{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){let o=t,c=e||(()=>null),f=i;if(t&&"object"==typeof t){const C=t;o=C.next?.bind(C),c=C.error?.bind(C),f=C.complete?.bind(C)}this.__isAsync&&(c=u1(c),o&&(o=u1(o)),f&&(f=u1(f)));const v=super.subscribe({next:o,error:c,complete:f});return t instanceof Ie&&t.add(v),v}};function DO(){return this._results[Symbol.iterator]()}class iy{get changes(){return this._changes||(this._changes=new on)}constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=iy.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=DO)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const o=function Rr(n){return n.flat(Number.POSITIVE_INFINITY)}(t);(this._changesDetected=!function Hc(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let o=n[i],c=t[i];if(e&&(o=e(o),c=e(c)),c!==o)return!1}return!0}(i._results,o,e))&&(i._results=o,i.length=o.length,i.last=o[this.length-1],i.first=o[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let qu=(()=>{class n{}return n.__NG_ELEMENT_ID__=TO,n})();const MO=qu,SO=class extends MO{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t,e){const i=this._declarationTContainer.tView,o=iu(this._declarationLView,i,t,16,null,i.declTNode,null,null,null,null,e||null);o[Xl]=this._declarationLView[this._declarationTContainer.index];const f=this._declarationLView[os];return null!==f&&(o[os]=f.createEmbeddedView(i)),xm(i,o,t),new Zs(o)}};function TO(){return qb(Nr(),ft())}function qb(n,t){return 4&n.type?new SO(t,n,El(n,t)):null}let tl=(()=>{class n{}return n.__NG_ELEMENT_ID__=AO,n})();function AO(){return iS(Nr(),ft())}const IO=tl,tS=class extends IO{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return El(this._hostTNode,this._hostLView)}get injector(){return new md(this._hostTNode,this._hostLView)}get parentInjector(){const t=Qr(this._hostTNode,this._hostLView);if(gi(t)){const e=Di(t,this._hostLView),i=di(t);return new md(e[jt].data[i+8],e)}return new md(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=nS(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-lo}createEmbeddedView(t,e,i){let o,c;"number"==typeof i?o=i:null!=i&&(o=i.index,c=i.injector);const f=t.createEmbeddedView(e||{},c);return this.insert(f,o),f}createComponent(t,e,i,o,c){const f=t&&!function Jl(n){return"function"==typeof n}(t);let v;if(f)v=e;else{const V=e||{};v=V.index,i=V.injector,o=V.projectableNodes,c=V.environmentInjector||V.ngModuleRef}const C=f?t:new Fh(wi(t)),S=i||this.parentInjector;if(!c&&null==C.ngModule){const Q=(f?S:this.parentInjector).get(Xc,null);Q&&(c=Q)}const R=C.create(S,o,void 0,c);return this.insert(R.hostView,v),R}insert(t,e){const i=t._lView,o=i[jt];if(function pg(n){return Bo(n[Li])}(i)){const R=this.indexOf(t);if(-1!==R)this.detach(R);else{const V=i[Li],Q=new tS(V,V[Or],V[Li]);Q.detach(Q.indexOf(t))}}const c=this._adjustIndex(e),f=this._lContainer;!function nw(n,t,e,i){const o=lo+i,c=e.length;i>0&&(e[o-1][rs]=t),i<c-lo?(t[rs]=e[o],Gc(e,lo+i,t)):(e.push(t),t[rs]=null),t[Li]=e;const f=t[Xl];null!==f&&e!==f&&function Fg(n,t){const e=n[ra];t[kr]!==t[Li][Li][kr]&&(n[Hs]=!0),null===e?n[ra]=[t]:e.push(t)}(f,t);const v=t[os];null!==v&&v.insertView(n),t[Un]|=64}(o,i,f,c);const v=Hg(c,f),C=i[jn],S=xh(C,f[Zr]);return null!==S&&function Pg(n,t,e,i,o,c){i[Cs]=o,i[Or]=t,Ip(n,i,e,1,o,c)}(o,f[Or],C,i,S,v),t.attachToViewContainerRef(),Gc(d1(f),c,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=nS(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=Lg(this._lContainer,e);i&&(ec(d1(this._lContainer),e),rc(i[jt],i))}detach(t){const e=this._adjustIndex(t,-1),i=Lg(this._lContainer,e);return i&&null!=ec(d1(this._lContainer),e)?new Zs(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function nS(n){return n[Cn]}function d1(n){return n[Cn]||(n[Cn]=[])}function iS(n,t){let e;const i=t[n.index];if(Bo(i))e=i;else{let o;if(8&n.type)o=Pr(i);else{const c=t[jn];o=c.createComment("");const f=ls(n,t);vd(c,xh(c,f),o,function Sv(n,t){return n.nextSibling(t)}(c,f),!1)}t[n.index]=e=B_(i,t,o,n),Gp(t,e)}return new tS(e,n,t)}class h1{constructor(t){this.queryList=t,this.matches=null}clone(){return new h1(this.queryList)}setDirty(){this.queryList.setDirty()}}class p1{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,o=[];for(let c=0;c<i;c++){const f=e.getByIndex(c);o.push(this.queries[f.indexInDeclarationView].clone())}return new p1(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==lS(t,e).matches&&this.queries[e].setDirty()}}class rS{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class f1{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const o=null!==e?e.length:0,c=this.getByIndex(i).embeddedTView(t,o);c&&(c.indexInDeclarationView=i,null!==e?e.push(c):e=[c])}return null!==e?new f1(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class m1{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new m1(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let o=0;o<i.length;o++){const c=i[o];this.matchTNodeWithReadOption(t,e,kO(e,c)),this.matchTNodeWithReadOption(t,e,vl(e,t,c,!1,!1))}else i===qu?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,vl(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const o=this.metadata.read;if(null!==o)if(o===_i||o===tl||o===qu&&4&e.type)this.addMatch(e.index,-2);else{const c=vl(e,t,o,!1,!1);null!==c&&this.addMatch(e.index,c)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function kO(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function RO(n,t,e,i){return-1===e?function PO(n,t){return 11&n.type?El(n,t):4&n.type?qb(n,t):null}(t,n):-2===e?function FO(n,t,e){return e===_i?El(t,n):e===qu?qb(t,n):e===tl?iS(t,n):void 0}(n,t,i):ku(n,n[jt],e,t)}function oS(n,t,e,i){const o=t[os].queries[i];if(null===o.matches){const c=n.data,f=e.matches,v=[];for(let C=0;C<f.length;C+=2){const S=f[C];v.push(S<0?null:RO(t,c[S],f[C+1],e.metadata.read))}o.matches=v}return o.matches}function g1(n,t,e,i){const o=n.queries.getByIndex(e),c=o.matches;if(null!==c){const f=oS(n,t,o,e);for(let v=0;v<c.length;v+=2){const C=c[v];if(C>0)i.push(f[v/2]);else{const S=c[v+1],R=t[-C];for(let V=lo;V<R.length;V++){const Q=R[V];Q[Xl]===Q[Li]&&g1(Q[jt],Q,S,i)}if(null!==R[ra]){const V=R[ra];for(let Q=0;Q<V.length;Q++){const oe=V[Q];g1(oe[jt],oe,S,i)}}}}}return i}function Gi(n){const t=ft(),e=ui(),i=d();_(i+1);const o=lS(e,i);if(n.dirty&&function hg(n){return 4==(4&n[Un])}(t)===(2==(2&o.metadata.flags))){if(null===o.matches)n.reset([]);else{const c=o.crossesNgTemplate?g1(e,t,i,[]):oS(e,t,o,i);n.reset(c,Cw),n.notifyOnChanges()}return!0}return!1}function mo(n,t,e){const i=ui();i.firstCreatePass&&(aS(i,new rS(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),sS(i,ft(),t)}function Ml(n,t,e,i){const o=ui();if(o.firstCreatePass){const c=Nr();aS(o,new rS(t,e,i),c.index),function LO(n,t){const e=n.contentQueries||(n.contentQueries=[]);t!==(e.length?e[e.length-1]:-1)&&e.push(n.queries.length-1,t)}(o,n),2==(2&e)&&(o.staticContentQueries=!0)}sS(o,ft(),e)}function qi(){return function OO(n,t){return n[os].queries[t].queryList}(ft(),d())}function sS(n,t,e){const i=new iy(4==(4&e));$p(n,t,i,i.destroy),null===t[os]&&(t[os]=new p1),t[os].queries.push(new h1(i))}function aS(n,t,e){null===n.queries&&(n.queries=new f1),n.queries.track(new m1(t,e))}function lS(n,t){return n.queries.getByIndex(t)}function cS(n,t){return qb(n,t)}function Zb(...n){}const oy=new wt("Application Initializer");let Yb=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Zb,this.reject=Zb,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,o)=>{this.resolve=i,this.reject=o})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const c=this.appInits[o]();if(Ur(c))e.push(c);else if(jr(c)){const f=new Promise((v,C)=>{c.subscribe({complete:v,error:C})});e.push(f)}}Promise.all(e).then(()=>{i()}).catch(o=>{this.reject(o)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(We(oy,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sy=new wt("AppId",{providedIn:"root",factory:function SS(){return`${w1()}${w1()}${w1()}`}});function w1(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const TS=new wt("Platform Initializer"),ay=new wt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Bh=new wt("AnimationModuleType");let nL=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Wu=new wt("LocaleId",{providedIn:"root",factory:()=>bn(Wu,dn.Optional|dn.SkipSelf)||function iL(){return typeof $localize<"u"&&$localize.locale||Lm}()});class oL{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}let AS=(()=>{class n{compileModuleSync(e){return new a1(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){const i=this.compileModuleSync(e),c=eu(Eo(e).declarations).reduce((f,v)=>{const C=wi(v);return C&&f.push(new Fh(C)),f},[]);return new oL(i,c)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const lL=(()=>Promise.resolve(0))();function C1(n){typeof Zone>"u"?lL.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Pn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new on(!1),this.onMicrotaskEmpty=new on(!1),this.onStable=new on(!1),this.onError=new on(!1),typeof Zone>"u")throw new nt(908,!1);Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&e,o.shouldCoalesceRunChangeDetection=i,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function cL(){let n=Oi.requestAnimationFrame,t=Oi.cancelAnimationFrame;if(typeof Zone<"u"&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function hL(n){const t=()=>{!function dL(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Oi,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,D1(n),n.isCheckStableRunning=!0,E1(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),D1(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,o,c,f,v)=>{try{return PS(n),e.invokeTask(o,c,f,v)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===c.type||n.shouldCoalesceRunChangeDetection)&&t(),RS(n)}},onInvoke:(e,i,o,c,f,v,C)=>{try{return PS(n),e.invoke(o,c,f,v,C)}finally{n.shouldCoalesceRunChangeDetection&&t(),RS(n)}},onHasTask:(e,i,o,c)=>{e.hasTask(o,c),i===o&&("microTask"==c.change?(n._hasPendingMicrotasks=c.microTask,D1(n),E1(n)):"macroTask"==c.change&&(n.hasPendingMacrotasks=c.macroTask))},onHandleError:(e,i,o,c)=>(e.handleError(o,c),n.runOutsideAngular(()=>n.onError.emit(c)),!1)})}(o)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pn.isInAngularZone())throw new nt(909,!1)}static assertNotInAngularZone(){if(Pn.isInAngularZone())throw new nt(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,o){const c=this._inner,f=c.scheduleEventTask("NgZoneEvent: "+o,t,uL,Zb,Zb);try{return c.runTask(f,e,i)}finally{c.cancelTask(f)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const uL={};function E1(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function D1(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function PS(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function RS(n){n._nesting--,E1(n)}class pL{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new on,this.onMicrotaskEmpty=new on,this.onStable=new on,this.onError=new on}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,o){return t.apply(e,i)}}const FS=new wt(""),Xb=new wt("");let T1,M1=(()=>{class n{constructor(e,i,o){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,T1||(function fL(n){T1=n}(o),o.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pn.assertNotInAngularZone(),C1(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())C1(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,o){let c=-1;i&&i>0&&(c=setTimeout(()=>{this._callbacks=this._callbacks.filter(f=>f.timeoutId!==c),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:c,updateCb:o})}whenStable(e,i,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,o){return[]}}return n.\u0275fac=function(e){return new(e||n)(We(Pn),We(S1),We(Xb))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),S1=(()=>{class n{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return T1?.findTestabilityInTree(this,e,i)??null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const Ad=!1;let zh=null;const OS=new wt("AllowMultipleToken"),A1=new wt("PlatformDestroyListeners"),LS=new wt("appBootstrapListener");class NS{constructor(t,e){this.name=t,this.token=e}}function zS(n,t,e=[]){const i=`Platform: ${t}`,o=new wt(i);return(c=[])=>{let f=I1();if(!f||f.injector.get(OS,!1)){const v=[...e,...c,{provide:o,useValue:!0}];n?n(v):function _L(n){if(zh&&!zh.get(OS,!1))throw new nt(400,!1);zh=n;const t=n.get(US);(function BS(n){const t=n.get(TS,null);t&&t.forEach(e=>e())})(n)}(function VS(n=[],t){return Ts.create({name:t,providers:[{provide:lm,useValue:"platform"},{provide:A1,useValue:new Set([()=>zh=null])},...n]})}(v,i))}return function vL(n){const t=I1();if(!t)throw new nt(401,!1);return t}()}}function I1(){return zh?.get(US)??null}let US=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const o=function $S(n,t){let e;return e="noop"===n?new pL:("zone.js"===n?void 0:n)||new Pn(t),e}(i?.ngZone,function jS(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),c=[{provide:Pn,useValue:o}];return o.run(()=>{const f=Ts.create({providers:c,parent:this.injector,name:e.moduleType.name}),v=e.create(f),C=v.injector.get(fs,null);if(!C)throw new nt(402,!1);return o.runOutsideAngular(()=>{const S=o.onError.subscribe({next:R=>{C.handleError(R)}});v.onDestroy(()=>{Kb(this._modules,v),S.unsubscribe()})}),function HS(n,t,e){try{const i=e();return Ur(i)?i.catch(o=>{throw t.runOutsideAngular(()=>n.handleError(o)),o}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(C,o,()=>{const S=v.injector.get(Yb);return S.runInitializers(),S.donePromise.then(()=>(function fM(n){Ar(n,"Expected localeId to be defined"),"string"==typeof n&&(pM=n.toLowerCase().replace(/_/g,"-"))}(v.injector.get(Wu,Lm)||Lm),this._moduleDoBootstrap(v),v))})})}bootstrapModule(e,i=[]){const o=GS({},i);return function mL(n,t,e){const i=new a1(e);return Promise.resolve(i)}(0,0,e).then(c=>this.bootstrapModuleFactory(c,o))}_moduleDoBootstrap(e){const i=e.injector.get(Jp);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(o=>i.bootstrap(o));else{if(!e.instance.ngDoBootstrap)throw new nt(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new nt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(A1,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(We(Ts))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function GS(n,t){return Array.isArray(t)?t.reduce(GS,n):{...n,...t}}let Jp=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(e,i,o){this._zone=e,this._injector=i,this._exceptionHandler=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const c=new xn(v=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{v.next(this._stable),v.complete()})}),f=new xn(v=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{Pn.assertNotInAngularZone(),C1(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,v.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{Pn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{v.next(!1)}))});return()=>{C.unsubscribe(),S.unsubscribe()}});this.isStable=qr(c,f.pipe(function bt(n={}){const{connector:t=(()=>new yn),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:o=!0}=n;return c=>{let f,v,C,S=0,R=!1,V=!1;const Q=()=>{v?.unsubscribe(),v=void 0},oe=()=>{Q(),f=C=void 0,R=V=!1},me=()=>{const Ee=f;oe(),Ee?.unsubscribe()};return Xn((Ee,$e)=>{S++,!V&&!R&&Q();const lt=C=C??t();$e.add(()=>{S--,0===S&&!V&&!R&&(v=In(me,o))}),lt.subscribe($e),!f&&S>0&&(f=new Ti({next:St=>lt.next(St),error:St=>{V=!0,Q(),v=In(oe,e,St),lt.error(St)},complete:()=>{R=!0,Q(),v=In(oe,i),lt.complete()}}),H(Ee).subscribe(f))})(c)}}()))}bootstrap(e,i){const o=e instanceof Yv;if(!this._injector.get(Yb).done){!o&&function ia(n){const t=wi(n)||Dr(n)||ao(n);return null!==t&&t.standalone}(e);throw new nt(405,Ad)}let f;f=o?e:this._injector.get(Kc).resolveComponentFactory(e),this.componentTypes.push(f.componentType);const v=function gL(n){return n.isBoundToModule}(f)?void 0:this._injector.get(Nm),S=f.create(Ts.NULL,[],i||f.selector,v),R=S.location.nativeElement,V=S.injector.get(FS,null);return V?.registerApplication(R),S.onDestroy(()=>{this.detachView(S.hostView),Kb(this.components,S),V?.unregisterApplication(R)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new nt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Kb(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(LS,[]);i.push(...this._bootstrapListeners),i.forEach(o=>o(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Kb(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new nt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(e){return new(e||n)(We(Pn),We(Xc),We(fs))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Kb(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let pa=(()=>{class n{}return n.__NG_ELEMENT_ID__=wL,n})();function wL(n){return function CL(n,t,e){if(ka(n)&&!e){const i=ji(n.index,t);return new Zs(i,i)}return 47&n.type?new Zs(t[kr],t):null}(Nr(),ft(),16==(16&n))}class XS{constructor(){}supports(t){return $(t)}create(t){return new AL(t)}}const TL=(n,t)=>t;class AL{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||TL}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,o=0,c=null;for(;e||i;){const f=!i||e&&e.currentIndex<QS(i,o,c)?e:i,v=QS(f,o,c),C=f.currentIndex;if(f===i)o--,i=i._nextRemoved;else if(e=e._next,null==f.previousIndex)o++;else{c||(c=[]);const S=v-o,R=C-o;if(S!=R){for(let Q=0;Q<S;Q++){const oe=Q<c.length?c[Q]:c[Q]=0,me=oe+Q;R<=me&&me<S&&(c[Q]=oe+1)}c[f.previousIndex]=R-S}}v!==C&&t(f,v,C)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!$(t))throw new nt(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let o,c,f,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let v=0;v<this.length;v++)c=t[v],f=this._trackByFn(v,c),null!==e&&Object.is(e.trackById,f)?(i&&(e=this._verifyReinsertion(e,c,f,v)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,f,v),i=!0),e=e._next}else o=0,function ie(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Symbol.iterator]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,v=>{f=this._trackByFn(o,v),null!==e&&Object.is(e.trackById,f)?(i&&(e=this._verifyReinsertion(e,v,f,o)),Object.is(e.item,v)||this._addIdentityChange(e,v)):(e=this._mismatch(e,v,f,o),i=!0),e=e._next,o++}),this.length=o;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,o){let c;return null===t?c=this._itTail:(c=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,c,o)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,o))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,c,o)):t=this._addAfter(new IL(e,i),c,o),t}_verifyReinsertion(t,e,i,o){let c=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==c?t=this._reinsertAfter(c,t._prev,o):t.currentIndex!=o&&(t.currentIndex=o,this._addToMoves(t,o)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const o=t._prevRemoved,c=t._nextRemoved;return null===o?this._removalsHead=c:o._nextRemoved=c,null===c?this._removalsTail=o:c._prevRemoved=o,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const o=null===e?this._itHead:e._next;return t._next=o,t._prev=e,null===o?this._itTail=t:o._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new KS),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new KS),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class IL{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class kL{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class KS{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new kL,this.map.set(e,i)),i.add(t)}get(t,e){const o=this.map.get(t);return o?o.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function QS(n,t,e){const i=n.previousIndex;if(null===i)return i;let o=0;return e&&i<e.length&&(o=e[i]),i+t+o}class JS{constructor(){}supports(t){return t instanceof Map||he(t)}create(){return new PL}}class PL{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||he(t)))throw new nt(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,o)=>{if(e&&e.key===o)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const c=this._getOrCreateRecordForKey(o,i);e=this._insertBeforeOrAppend(e,c)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const o=this._records.get(t);this._maybeAddToChanges(o,e);const c=o._prev,f=o._next;return c&&(c._next=f),f&&(f._prev=c),o._next=null,o._prev=null,o}const i=new RL(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class RL{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function eT(){return new e0([new XS])}let e0=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const o=i.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||eT()),deps:[[n,new bl,new ds]]}}find(e){const i=this.factories.find(o=>o.supports(e));if(null!=i)return i;throw new nt(901,!1)}}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:eT}),n})();function tT(){return new ly([new JS])}let ly=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const o=i.factories.slice();e=e.concat(o)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||tT()),deps:[[n,new bl,new ds]]}}find(e){const i=this.factories.find(o=>o.supports(e));if(i)return i;throw new nt(901,!1)}}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:tT}),n})();const LL=zS(null,"core",[]);let NL=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(We(Jp))},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();function Vm(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let O1=null;function Id(){return O1}class VL{}const ai=new wt("DocumentToken");let L1=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return function UL(){return We(nT)}()},providedIn:"platform"}),n})();const jL=new wt("Location Initialized");let nT=(()=>{class n extends L1{constructor(e){super(),this._doc=e,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Id().getBaseHref(this._doc)}onPopState(e){const i=Id().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){const i=Id().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,o){iT()?this._history.pushState(e,i,o):this._location.hash=o}replaceState(e,i,o){iT()?this._history.replaceState(e,i,o):this._location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:function(){return function $L(){return new nT(We(ai))}()},providedIn:"platform"}),n})();function iT(){return!!window.history.pushState}function N1(n,t){if(0==n.length)return t;if(0==t.length)return n;let e=0;return n.endsWith("/")&&e++,t.startsWith("/")&&e++,2==e?n+t.substring(1):1==e?n+t:n+"/"+t}function rT(n){const t=n.match(/#|\?|$/),e=t&&t.index||n.length;return n.slice(0,e-("/"===n[e-1]?1:0))+n.slice(e)}function kd(n){return n&&"?"!==n[0]?"?"+n:n}let tf=(()=>{class n{historyGo(e){throw new Error("Not implemented")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return bn(sT)},providedIn:"root"}),n})();const oT=new wt("appBaseHref");let sT=(()=>{class n extends tf{constructor(e,i){super(),this._platformLocation=e,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??bn(ai).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return N1(this._baseHref,e)}path(e=!1){const i=this._platformLocation.pathname+kd(this._platformLocation.search),o=this._platformLocation.hash;return o&&e?`${i}${o}`:i}pushState(e,i,o,c){const f=this.prepareExternalUrl(o+kd(c));this._platformLocation.pushState(e,i,f)}replaceState(e,i,o,c){const f=this.prepareExternalUrl(o+kd(c));this._platformLocation.replaceState(e,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(We(L1),We(oT,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),HL=(()=>{class n extends tf{constructor(e,i){super(),this._platformLocation=e,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(e){const i=N1(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,o,c){let f=this.prepareExternalUrl(o+kd(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.pushState(e,i,f)}replaceState(e,i,o,c){let f=this.prepareExternalUrl(o+kd(c));0==f.length&&(f=this._platformLocation.pathname),this._platformLocation.replaceState(e,i,f)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}}return n.\u0275fac=function(e){return new(e||n)(We(L1),We(oT,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),t0=(()=>{class n{constructor(e){this._subject=new on,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=e;const i=this._locationStrategy.getBaseHref();this._basePath=function WL(n){if(new RegExp("^(https?:)?//").test(n)){const[,e]=n.split(/\/\/[^\/]+/);return e}return n}(rT(aT(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+kd(i))}normalize(e){return n.stripTrailingSlash(function qL(n,t){if(!n||!t.startsWith(n))return t;const e=t.substring(n.length);return""===e||["/",";","?","#"].includes(e[0])?e:t}(this._basePath,aT(e)))}prepareExternalUrl(e){return e&&"/"!==e[0]&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",o=null){this._locationStrategy.pushState(o,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+kd(i)),o)}replaceState(e,i="",o=null){this._locationStrategy.replaceState(o,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+kd(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(o=>o(e,i))}subscribe(e,i,o){return this._subject.subscribe({next:e,error:i,complete:o})}}return n.normalizeQueryParams=kd,n.joinWithSlash=N1,n.stripTrailingSlash=rT,n.\u0275fac=function(e){return new(e||n)(We(tf))},n.\u0275prov=Mt({token:n,factory:function(){return function GL(){return new t0(We(tf))}()},providedIn:"root"}),n})();function aT(n){return n.replace(/\/index.html$/,"")}const W1=/\s+/,gT=[];let dy=(()=>{class n{constructor(e,i,o,c){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=o,this._renderer=c,this.initialClasses=gT,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(W1):gT}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(W1):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,Boolean(e[i]));this._applyStateDiff()}_updateState(e,i){const o=this.stateMap.get(e);void 0!==o?(o.enabled!==i&&(o.changed=!0,o.enabled=i),o.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],o=e[1];o.changed?(this._toggleClass(i,o.enabled),o.changed=!1):o.touched||(o.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),o.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(W1).forEach(o=>{i?this._renderer.addClass(this._ngEl.nativeElement,o):this._renderer.removeClass(this._ngEl.nativeElement,o)})}}return n.\u0275fac=function(e){return new(e||n)(ve(e0),ve(ly),ve(_i),ve(Jc))},n.\u0275dir=Vt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class PN{constructor(t,e,i,o){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Um=(()=>{class n{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,o){this._viewContainer=e,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((o,c,f)=>{if(null==o.previousIndex)i.createEmbeddedView(this._template,new PN(o.item,this._ngForOf,-1,-1),null===f?void 0:f);else if(null==f)i.remove(null===c?void 0:c);else if(null!==c){const v=i.get(c);i.move(v,f),vT(v,o)}});for(let o=0,c=i.length;o<c;o++){const v=i.get(o).context;v.index=o,v.count=c,v.ngForOf=this._ngForOf}e.forEachIdentityChange(o=>{vT(i.get(o.currentIndex),o)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(ve(tl),ve(qu),ve(e0))},n.\u0275dir=Vt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function vT(n,t){n.context.$implicit=t.item}let hy=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new FN,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){bT("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){bT("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(ve(tl),ve(qu))},n.\u0275dir=Vt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class FN{constructor(){this.$implicit=null,this.ngIf=null}}function bT(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${vi(t)}'.`)}class Z1{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let nf=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),py=(()=>{class n{constructor(e,i,o){this.ngSwitch=o,o._addCase(),this._view=new Z1(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(ve(tl),ve(qu),ve(nf,9))},n.\u0275dir=Vt({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),xT=(()=>{class n{constructor(e,i,o){o._addDefault(new Z1(e,i))}}return n.\u0275fac=function(e){return new(e||n)(ve(tl),ve(qu),ve(nf,9))},n.\u0275dir=Vt({type:n,selectors:[["","ngSwitchDefault",""]],standalone:!0}),n})(),CT=(()=>{class n{constructor(e,i,o){this._ngEl=e,this._differs=i,this._renderer=o,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[o,c]=e.split("."),f=-1===o.indexOf("-")?void 0:eo.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,o,c?`${i}${c}`:i,f):this._renderer.removeStyle(this._ngEl.nativeElement,o,f)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(ly),ve(Jc))},n.\u0275dir=Vt({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})(),ET=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:o,ngTemplateOutletContext:c,ngTemplateOutletInjector:f}=this;this._viewRef=i.createEmbeddedView(o,c,f?{injector:f}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(ve(tl))},n.\u0275dir=Vt({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[tr]}),n})(),jm=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const MT="browser";function K1(n){return n===MT}let aB=(()=>{class n{}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:()=>new lB(We(ai),window)}),n})();class lB{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function cB(n,t){const e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let o=i.currentNode;for(;o;){const c=o.shadowRoot;if(c){const f=c.getElementById(t)||c.querySelector(`[name="${t}"]`);if(f)return f}o=i.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,o=e.top+this.window.pageYOffset,c=this.offset();this.window.scrollTo(i-c[0],o-c[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=ST(this.window.history)||ST(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function ST(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class NB extends VL{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class eC extends NB{static makeCurrent(){!function zL(n){O1||(O1=n)}(new eC)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function BB(){return my=my||document.querySelector("base"),my?my.getAttribute("href"):null}();return null==e?null:function zB(n){f0=f0||document.createElement("a"),f0.setAttribute("href",n);const t=f0.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){my=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function IN(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[o,c]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(o.trim()===t)return decodeURIComponent(c)}return null}(document.cookie,t)}}let f0,my=null;const PT=new wt("TRANSITION_ID"),UB=[{provide:oy,useFactory:function VB(n,t,e){return()=>{e.get(Yb).donePromise.then(()=>{const i=Id(),o=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let c=0;c<o.length;c++)i.remove(o[c])})}},deps:[PT,ai,Ts],multi:!0}];let $B=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const m0=new wt("EventManagerPlugins");let g0=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(o=>{o.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,o){return this._findPluginFor(i).addEventListener(e,i,o)}addGlobalEventListener(e,i,o){return this._findPluginFor(i).addGlobalEventListener(e,i,o)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const o=this._plugins;for(let c=0;c<o.length;c++){const f=o[c];if(f.supports(e))return this._eventNameToPlugin.set(e,f),f}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(We(m0),We(Pn))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class RT{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const o=Id().getGlobalEventTarget(this._doc,t);if(!o)throw new Error(`Unsupported event target ${o} for event ${e}`);return this.addEventListener(o,e,i)}}let FT=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(e){}onStyleAdded(e){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(e,i){const o=this.usageCount;let c=o.get(e)??0;return c+=i,c>0?o.set(e,c):o.delete(e),c}ngOnDestroy(){for(const e of this.getAllStyles())this.onStyleRemoved(e);this.usageCount.clear()}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),gy=(()=>{class n extends FT{constructor(e){super(),this.doc=e,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.forEach(c=>c.remove()),i.delete(e)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}addStyleToHost(e,i){const o=this.doc.createElement("style");o.textContent=i,e.appendChild(o);const c=this.styleRef.get(i);c?c.push(o):this.styleRef.set(i,[o])}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const tC={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},nC=/%COMP%/g,NT=new wt("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function BT(n,t){return t.flat(100).map(e=>e.replace(nC,n))}function zT(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let _0=(()=>{class n{constructor(e,i,o,c){this.eventManager=e,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestory=c,this.rendererByCompId=new Map,this.defaultRenderer=new iC(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;const o=this.getOrCreateRenderer(e,i);return o instanceof jT?o.applyToHost(e):o instanceof rC&&o.applyStyles(),o}getOrCreateRenderer(e,i){const o=this.rendererByCompId;let c=o.get(i.id);if(!c){const f=this.eventManager,v=this.sharedStylesHost,C=this.removeStylesOnCompDestory;switch(i.encapsulation){case No.Emulated:c=new jT(f,v,i,this.appId,C);break;case No.ShadowDom:return new XB(f,v,e,i);default:c=new rC(f,v,i,C)}c.onDestroy=()=>o.delete(i.id),o.set(i.id,c)}return c}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(We(g0),We(gy),We(sy),We(NT))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class iC{constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(tC[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){(UT(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(UT(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,o){if(o){e=o+":"+e;const c=tC[o];c?t.setAttributeNS(c,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const o=tC[i];o?t.removeAttributeNS(o,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,o){o&(eo.DashCase|eo.Important)?t.style.setProperty(e,i,o&eo.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&eo.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,zT(i)):this.eventManager.addEventListener(t,e,zT(i))}}function UT(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class XB extends iC{constructor(t,e,i,o){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const c=BT(o.id,o.styles);for(const f of c){const v=document.createElement("style");v.textContent=f,this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class rC extends iC{constructor(t,e,i,o,c=i.id){super(t),this.sharedStylesHost=e,this.removeStylesOnCompDestory=o,this.rendererUsageCount=0,this.styles=BT(c,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class jT extends rC{constructor(t,e,i,o,c){const f=o+"-"+i.id;super(t,e,i,c,f),this.contentAttr=function WB(n){return"_ngcontent-%COMP%".replace(nC,n)}(f),this.hostAttr=function ZB(n){return"_nghost-%COMP%".replace(nC,n)}(f)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}let KB=(()=>{class n extends RT{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,o){return e.addEventListener(i,o,!1),()=>this.removeEventListener(e,i,o)}removeEventListener(e,i,o){return e.removeEventListener(i,o)}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const $T=["alt","control","meta","shift"],QB={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},JB={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let ez=(()=>{class n extends RT{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,o){const c=n.parseEventName(i),f=n.eventCallback(c.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Id().onAndCancel(e,c.domEventName,f))}static parseEventName(e){const i=e.toLowerCase().split("."),o=i.shift();if(0===i.length||"keydown"!==o&&"keyup"!==o)return null;const c=n._normalizeKey(i.pop());let f="",v=i.indexOf("code");if(v>-1&&(i.splice(v,1),f="code."),$T.forEach(S=>{const R=i.indexOf(S);R>-1&&(i.splice(R,1),f+=S+".")}),f+=c,0!=i.length||0===c.length)return null;const C={};return C.domEventName=o,C.fullKey=f,C}static matchEventFullKeyCode(e,i){let o=QB[e.key]||e.key,c="";return i.indexOf("code.")>-1&&(o=e.code,c="code."),!(null==o||!o)&&(o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),$T.forEach(f=>{f!==o&&(0,JB[f])(e)&&(c+=f+".")}),c+=o,c===i)}static eventCallback(e,i,o){return c=>{n.matchEventFullKeyCode(c,e)&&o.runGuarded(()=>i(c))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const rz=zS(LL,"browser",[{provide:ay,useValue:MT},{provide:TS,useValue:function tz(){eC.makeCurrent()},multi:!0},{provide:ai,useFactory:function iz(){return function Zf(n){Nu=n}(document),document},deps:[]}]),qT=new wt(""),WT=[{provide:Xb,useClass:class jB{addToWindow(t){Oi.getAngularTestability=(i,o=!0)=>{const c=t.findTestabilityInTree(i,o);if(null==c)throw new Error("Could not find testability for element.");return c},Oi.getAllAngularTestabilities=()=>t.getAllTestabilities(),Oi.getAllAngularRootElements=()=>t.getAllRootElements(),Oi.frameworkStabilizers||(Oi.frameworkStabilizers=[]),Oi.frameworkStabilizers.push(i=>{const o=Oi.getAllAngularTestabilities();let c=o.length,f=!1;const v=function(C){f=f||C,c--,0==c&&i(f)};o.forEach(function(C){C.whenStable(v)})})}findTestabilityInTree(t,e,i){return null==e?null:t.getTestability(e)??(i?Id().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null)}},deps:[]},{provide:FS,useClass:M1,deps:[Pn,S1,Xb]},{provide:M1,useClass:M1,deps:[Pn,S1,Xb]}],ZT=[{provide:lm,useValue:"root"},{provide:fs,useFactory:function nz(){return new fs},deps:[]},{provide:m0,useClass:KB,multi:!0,deps:[ai,Pn,ay]},{provide:m0,useClass:ez,multi:!0,deps:[ai]},{provide:_0,useClass:_0,deps:[g0,gy,sy,NT]},{provide:Qc,useExisting:_0},{provide:FT,useExisting:gy},{provide:gy,useClass:gy,deps:[ai]},{provide:g0,useClass:g0,deps:[m0,Pn]},{provide:class uB{},useClass:$B,deps:[]},[]];let YT=(()=>{class n{constructor(e){}static withServerTransition(e){return{ngModule:n,providers:[{provide:sy,useValue:e.appId},{provide:PT,useExisting:sy},UB]}}}return n.\u0275fac=function(e){return new(e||n)(We(qT,12))},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[...ZT,...WT],imports:[jm,NL]}),n})(),XT=(()=>{class n{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:function(e){let i=null;return i=e?new e:function sz(){return new XT(We(ai))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let y0=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(e){let i=null;return i=e?new(e||n):We(JT),i},providedIn:"root"}),n})(),JT=(()=>{class n extends y0{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case zi.NONE:return i;case zi.HTML:return sc(i,"HTML")?Ao(i):$v(this._doc,String(i)).toString();case zi.STYLE:return sc(i,"Style")?Ao(i):i;case zi.SCRIPT:if(sc(i,"Script"))return Ao(i);throw new Error("unsafe value used in a script context");case zi.URL:return sc(i,"URL")?Ao(i):Qf(String(i));case zi.RESOURCE_URL:if(sc(i,"ResourceURL"))return Ao(i);throw new Error(`unsafe value used in a resource URL context (see ${Cr})`);default:throw new Error(`Unexpected SecurityContext ${e} (see ${Cr})`)}}bypassSecurityTrustHtml(e){return function Yf(n){return new sw(n)}(e)}bypassSecurityTrustStyle(e){return function Ov(n){return new aw(n)}(e)}bypassSecurityTrustScript(e){return function Xf(n){return new lw(n)}(e)}bypassSecurityTrustUrl(e){return function Kf(n){return new Yg(n)}(e)}bypassSecurityTrustResourceUrl(e){return function kp(n){return new cw(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:function(e){let i=null;return i=e?new e:function dz(n){return new JT(n.get(ai))}(We(Ts)),i},providedIn:"root"}),n})();var hz=pi(898),v0=pi.n(hz);const eA_mapbox_accessToken="pk.eyJ1IjoiY2RhbmllbGlyYSIsImEiOiJjbGhuMWJmcDYxaDN3M2twYmp0M2xtb25rIn0.tWzZ68XZxhcQTfilWWdf9g";function sn(...n){return lr(n,ti(n))}class fc extends yn{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}const b0=ze(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:pz}=Array,{getPrototypeOf:fz,prototype:mz,keys:gz}=Object;function tA(n){if(1===n.length){const t=n[0];if(pz(t))return{args:t,keys:null};if(function _z(n){return n&&"object"==typeof n&&fz(n)===mz}(t)){const e=gz(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:yz}=Array;function aC(n){return nn(t=>function vz(n,t){return yz(t)?n(...t):n(t)}(n,t))}function nA(n,t){return n.reduce((e,i,o)=>(e[i]=t[o],e),{})}function lC(...n){const t=ti(n),e=rn(n),{args:i,keys:o}=tA(n);if(0===i.length)return lr([],t);const c=new xn(function bz(n,t,e=wr){return i=>{iA(t,()=>{const{length:o}=n,c=new Array(o);let f=o,v=o;for(let C=0;C<o;C++)iA(t,()=>{const S=lr(n[C],t);let R=!1;S.subscribe(Rn(i,V=>{c[C]=V,R||(R=!0,v--),v||i.next(e(c.slice()))},()=>{--f||i.complete()}))},i)},i)}}(i,t,o?f=>nA(o,f):wr));return e?c.pipe(aC(e)):c}function iA(n,t,e){n?tt(e,n,t):t()}function $m(...n){return function xz(){return zt(1)}()(lr(n,ti(n)))}function _y(n){return new xn(t=>{H(n()).subscribe(t)})}function rf(n,t){const e=Nt(n)?n:()=>n,i=o=>o.error(e());return new xn(t?o=>t.schedule(i,0,o):i)}function cC(){return Xn((n,t)=>{let e=null;n._refCount++;const i=Rn(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const o=n._connection,c=e;e=null,o&&(!c||o===c)&&o.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}class uC extends xn{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,_s(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new Ie;const e=this.getSubject();t.add(this.source.subscribe(Rn(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=Ie.EMPTY)}return t}refCount(){return cC()(this)}}function Ys(n,t){return Xn((e,i)=>{let o=null,c=0,f=!1;const v=()=>f&&!o&&i.complete();e.subscribe(Rn(i,C=>{o?.unsubscribe();let S=0;const R=c++;H(n(C,R)).subscribe(o=Rn(i,V=>i.next(t?t(C,V,R,S++):V),()=>{o=null,v()}))},()=>{f=!0,v()}))})}function ro(n){return n<=0?()=>Ft:Xn((t,e)=>{let i=0;t.subscribe(Rn(e,o=>{++i<=n&&(e.next(o),n<=i&&e.complete())}))})}function Uh(...n){const t=ti(n);return Xn((e,i)=>{(t?$m(n,e,t):$m(n,e)).subscribe(i)})}function oo(n,t){return Xn((e,i)=>{let o=0;e.subscribe(Rn(i,c=>n.call(t,c,o++)&&i.next(c)))})}function x0(n){return Xn((t,e)=>{let i=!1;t.subscribe(Rn(e,o=>{i=!0,e.next(o)},()=>{i||e.next(n),e.complete()}))})}function rA(n=wz){return Xn((t,e)=>{let i=!1;t.subscribe(Rn(e,o=>{i=!0,e.next(o)},()=>i?e.complete():e.error(n())))})}function wz(){return new b0}function jh(n,t){const e=arguments.length>=2;return i=>i.pipe(n?oo((o,c)=>n(o,c,i)):wr,ro(1),e?x0(t):rA(()=>new b0))}function $h(n,t){return Nt(t)?Je(n,t,1):Je(n,1)}function yo(n,t,e){const i=Nt(n)||t||e?{next:n,error:t,complete:e}:n;return i?Xn((o,c)=>{var f;null===(f=i.subscribe)||void 0===f||f.call(i);let v=!0;o.subscribe(Rn(c,C=>{var S;null===(S=i.next)||void 0===S||S.call(i,C),c.next(C)},()=>{var C;v=!1,null===(C=i.complete)||void 0===C||C.call(i),c.complete()},C=>{var S;v=!1,null===(S=i.error)||void 0===S||S.call(i,C),c.error(C)},()=>{var C,S;v&&(null===(C=i.unsubscribe)||void 0===C||C.call(i)),null===(S=i.finalize)||void 0===S||S.call(i)}))}):wr}function Rd(n){return Xn((t,e)=>{let c,i=null,o=!1;i=t.subscribe(Rn(e,void 0,void 0,f=>{c=H(n(f,Rd(n)(t))),i?(i.unsubscribe(),i=null,c.subscribe(e)):o=!0})),o&&(i.unsubscribe(),i=null,c.subscribe(e))})}function oA(n,t){return Xn(function Cz(n,t,e,i,o){return(c,f)=>{let v=e,C=t,S=0;c.subscribe(Rn(f,R=>{const V=S++;C=v?n(C,R,V):(v=!0,R),i&&f.next(C)},o&&(()=>{v&&f.next(C),f.complete()})))}}(n,t,arguments.length>=2,!0))}function dC(n){return n<=0?()=>Ft:Xn((t,e)=>{let i=[];t.subscribe(Rn(e,o=>{i.push(o),n<i.length&&i.shift()},()=>{for(const o of i)e.next(o);e.complete()},void 0,()=>{i=null}))})}function sA(n,t){const e=arguments.length>=2;return i=>i.pipe(n?oo((o,c)=>n(o,c,i)):wr,dC(1),e?x0(t):rA(()=>new b0))}function aA(n,t=!1){return Xn((e,i)=>{let o=0;e.subscribe(Rn(i,c=>{const f=n(c,o++);(f||t)&&i.next(c),!f&&i.complete()}))})}function lA(n){return nn(()=>n)}function w0(n){return Xn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}const Jn="primary",yy=Symbol("RouteTitle");class Ez{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function Hm(n){return new Ez(n)}function Dz(n,t,e){const i=e.path.split("/");if(i.length>n.length||"full"===e.pathMatch&&(t.hasChildren()||i.length<n.length))return null;const o={};for(let c=0;c<i.length;c++){const f=i[c],v=n[c];if(f.startsWith(":"))o[f.substring(1)]=v;else if(f!==v.path)return null}return{consumed:n.slice(0,i.length),posParams:o}}function Zu(n,t){const e=n?Object.keys(n):void 0,i=t?Object.keys(t):void 0;if(!e||!i||e.length!=i.length)return!1;let o;for(let c=0;c<e.length;c++)if(o=e[c],!cA(n[o],t[o]))return!1;return!0}function cA(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;const e=[...n].sort(),i=[...t].sort();return e.every((o,c)=>i[c]===o)}return n===t}function uA(n){return Array.prototype.concat.apply([],n)}function dA(n){return n.length>0?n[n.length-1]:null}function Is(n,t){for(const e in n)n.hasOwnProperty(e)&&t(n[e],e)}function Hh(n){return jr(n)?n:Ur(n)?lr(Promise.resolve(n)):sn(n)}const C0=!1,Sz={exact:function fA(n,t,e){if(!sf(n.segments,t.segments)||!E0(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(const i in t.children)if(!n.children[i]||!fA(n.children[i],t.children[i],e))return!1;return!0},subset:mA},hA={exact:function Tz(n,t){return Zu(n,t)},subset:function Az(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>cA(n[e],t[e]))},ignored:()=>!0};function pA(n,t,e){return Sz[e.paths](n.root,t.root,e.matrixParams)&&hA[e.queryParams](n.queryParams,t.queryParams)&&!("exact"===e.fragment&&n.fragment!==t.fragment)}function mA(n,t,e){return gA(n,t,t.segments,e)}function gA(n,t,e,i){if(n.segments.length>e.length){const o=n.segments.slice(0,e.length);return!(!sf(o,e)||t.hasChildren()||!E0(o,e,i))}if(n.segments.length===e.length){if(!sf(n.segments,e)||!E0(n.segments,e,i))return!1;for(const o in t.children)if(!n.children[o]||!mA(n.children[o],t.children[o],i))return!1;return!0}{const o=e.slice(0,n.segments.length),c=e.slice(n.segments.length);return!!(sf(n.segments,o)&&E0(n.segments,o,i)&&n.children[Jn])&&gA(n.children[Jn],t,c,i)}}function E0(n,t,e){return t.every((i,o)=>hA[e](n[o].parameters,i.parameters))}class Gh{constructor(t=new yi([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Hm(this.queryParams)),this._queryParamMap}toString(){return Pz.serialize(this)}}class yi{constructor(t,e){this.segments=t,this.children=e,this.parent=null,Is(e,(i,o)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return D0(this)}}class vy{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=Hm(this.parameters)),this._parameterMap}toString(){return vA(this)}}function sf(n,t){return n.length===t.length&&n.every((e,i)=>e.path===t[i].path)}let by=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return new hC},providedIn:"root"}),n})();class hC{parse(t){const e=new Uz(t);return new Gh(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){const e=`/${xy(t.root,!0)}`,i=function Oz(n){const t=Object.keys(n).map(e=>{const i=n[e];return Array.isArray(i)?i.map(o=>`${M0(e)}=${M0(o)}`).join("&"):`${M0(e)}=${M0(i)}`}).filter(e=>!!e);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${e}${i}${"string"==typeof t.fragment?`#${function Rz(n){return encodeURI(n)}(t.fragment)}`:""}`}}const Pz=new hC;function D0(n){return n.segments.map(t=>vA(t)).join("/")}function xy(n,t){if(!n.hasChildren())return D0(n);if(t){const e=n.children[Jn]?xy(n.children[Jn],!1):"",i=[];return Is(n.children,(o,c)=>{c!==Jn&&i.push(`${c}:${xy(o,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}{const e=function kz(n,t){let e=[];return Is(n.children,(i,o)=>{o===Jn&&(e=e.concat(t(i,o)))}),Is(n.children,(i,o)=>{o!==Jn&&(e=e.concat(t(i,o)))}),e}(n,(i,o)=>o===Jn?[xy(n.children[Jn],!1)]:[`${o}:${xy(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Jn]?`${D0(n)}/${e[0]}`:`${D0(n)}/(${e.join("//")})`}}function _A(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function M0(n){return _A(n).replace(/%3B/gi,";")}function pC(n){return _A(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function S0(n){return decodeURIComponent(n)}function yA(n){return S0(n.replace(/\+/g,"%20"))}function vA(n){return`${pC(n.path)}${function Fz(n){return Object.keys(n).map(t=>`;${pC(t)}=${pC(n[t])}`).join("")}(n.parameters)}`}const Lz=/^[^\/()?;=#]+/;function T0(n){const t=n.match(Lz);return t?t[0]:""}const Nz=/^[^=?&#]+/,zz=/^[^&#]+/;class Uz{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new yi([],{}):new yi([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[Jn]=new yi(t,e)),i}parseSegment(){const t=T0(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new nt(4009,C0);return this.capture(t),new vy(S0(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=T0(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const o=T0(this.remaining);o&&(i=o,this.capture(i))}t[S0(e)]=S0(i)}parseQueryParam(t){const e=function Bz(n){const t=n.match(Nz);return t?t[0]:""}(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){const f=function Vz(n){const t=n.match(zz);return t?t[0]:""}(this.remaining);f&&(i=f,this.capture(i))}const o=yA(e),c=yA(i);if(t.hasOwnProperty(o)){let f=t[o];Array.isArray(f)||(f=[f],t[o]=f),f.push(c)}else t[o]=c}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=T0(this.remaining),o=this.remaining[i.length];if("/"!==o&&")"!==o&&";"!==o)throw new nt(4010,C0);let c;i.indexOf(":")>-1?(c=i.slice(0,i.indexOf(":")),this.capture(c),this.capture(":")):t&&(c=Jn);const f=this.parseChildren();e[c]=1===Object.keys(f).length?f[Jn]:new yi([],f),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new nt(4011,C0)}}function fC(n){return n.segments.length>0?new yi([],{[Jn]:n}):n}function A0(n){const t={};for(const i of Object.keys(n.children)){const c=A0(n.children[i]);(c.segments.length>0||c.hasChildren())&&(t[i]=c)}return function jz(n){if(1===n.numberOfChildren&&n.children[Jn]){const t=n.children[Jn];return new yi(n.segments.concat(t.segments),t.children)}return n}(new yi(n.segments,t))}function af(n){return n instanceof Gh}const mC=!1;function $z(n,t,e,i,o){if(0===e.length)return Gm(t.root,t.root,t.root,i,o);const c=function EA(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new CA(!0,0,n);let t=0,e=!1;const i=n.reduce((o,c,f)=>{if("object"==typeof c&&null!=c){if(c.outlets){const v={};return Is(c.outlets,(C,S)=>{v[S]="string"==typeof C?C.split("/"):C}),[...o,{outlets:v}]}if(c.segmentPath)return[...o,c.segmentPath]}return"string"!=typeof c?[...o,c]:0===f?(c.split("/").forEach((v,C)=>{0==C&&"."===v||(0==C&&""===v?e=!0:".."===v?t++:""!=v&&o.push(v))}),o):[...o,c]},[]);return new CA(e,t,i)}(e);return c.toRoot()?Gm(t.root,t.root,new yi([],{}),i,o):function f(C){const S=function Gz(n,t,e,i){if(n.isAbsolute)return new qm(t.root,!0,0);if(-1===i)return new qm(e,e===t.root,0);return function DA(n,t,e){let i=n,o=t,c=e;for(;c>o;){if(c-=o,i=i.parent,!i)throw new nt(4005,mC&&"Invalid number of '../'");o=i.segments.length}return new qm(i,!1,o-c)}(e,i+(wy(n.commands[0])?0:1),n.numberOfDoubleDots)}(c,t,n.snapshot?._urlSegment,C),R=S.processChildren?Wm(S.segmentGroup,S.index,c.commands):gC(S.segmentGroup,S.index,c.commands);return Gm(t.root,S.segmentGroup,R,i,o)}(n.snapshot?._lastPathIndex)}function wy(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function Cy(n){return"object"==typeof n&&null!=n&&n.outlets}function Gm(n,t,e,i,o){let f,c={};i&&Is(i,(C,S)=>{c[S]=Array.isArray(C)?C.map(R=>`${R}`):`${C}`}),f=n===t?e:wA(n,t,e);const v=fC(A0(f));return new Gh(v,c,o)}function wA(n,t,e){const i={};return Is(n.children,(o,c)=>{i[c]=o===t?e:wA(o,t,e)}),new yi(n.segments,i)}class CA{constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&wy(i[0]))throw new nt(4003,mC&&"Root segment cannot have matrix parameters");const o=i.find(Cy);if(o&&o!==dA(i))throw new nt(4004,mC&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class qm{constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}}function gC(n,t,e){if(n||(n=new yi([],{})),0===n.segments.length&&n.hasChildren())return Wm(n,t,e);const i=function Wz(n,t,e){let i=0,o=t;const c={match:!1,pathIndex:0,commandIndex:0};for(;o<n.segments.length;){if(i>=e.length)return c;const f=n.segments[o],v=e[i];if(Cy(v))break;const C=`${v}`,S=i<e.length-1?e[i+1]:null;if(o>0&&void 0===C)break;if(C&&S&&"object"==typeof S&&void 0===S.outlets){if(!SA(C,S,f))return c;i+=2}else{if(!SA(C,{},f))return c;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}(n,t,e),o=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const c=new yi(n.segments.slice(0,i.pathIndex),{});return c.children[Jn]=new yi(n.segments.slice(i.pathIndex),n.children),Wm(c,0,o)}return i.match&&0===o.length?new yi(n.segments,{}):i.match&&!n.hasChildren()?_C(n,t,e):i.match?Wm(n,0,o):_C(n,t,e)}function Wm(n,t,e){if(0===e.length)return new yi(n.segments,{});{const i=function qz(n){return Cy(n[0])?n[0].outlets:{[Jn]:n}}(e),o={};if(!i[Jn]&&n.children[Jn]&&1===n.numberOfChildren&&0===n.children[Jn].segments.length){const c=Wm(n.children[Jn],t,e);return new yi(n.segments,c.children)}return Is(i,(c,f)=>{"string"==typeof c&&(c=[c]),null!==c&&(o[f]=gC(n.children[f],t,c))}),Is(n.children,(c,f)=>{void 0===i[f]&&(o[f]=c)}),new yi(n.segments,o)}}function _C(n,t,e){const i=n.segments.slice(0,t);let o=0;for(;o<e.length;){const c=e[o];if(Cy(c)){const C=Zz(c.outlets);return new yi(i,C)}if(0===o&&wy(e[0])){i.push(new vy(n.segments[t].path,MA(e[0]))),o++;continue}const f=Cy(c)?c.outlets[Jn]:`${c}`,v=o<e.length-1?e[o+1]:null;f&&v&&wy(v)?(i.push(new vy(f,MA(v))),o+=2):(i.push(new vy(f,{})),o++)}return new yi(i,{})}function Zz(n){const t={};return Is(n,(e,i)=>{"string"==typeof e&&(e=[e]),null!==e&&(t[i]=_C(new yi([],{}),0,e))}),t}function MA(n){const t={};return Is(n,(e,i)=>t[i]=`${e}`),t}function SA(n,t,e){return n==e.path&&Zu(t,e.parameters)}const Ey="imperative";class Yu{constructor(t,e){this.id=t,this.url=e}}class yC extends Yu{constructor(t,e,i="imperative",o=null){super(t,e),this.type=0,this.navigationTrigger=i,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class lf extends Yu{constructor(t,e,i){super(t,e),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class I0 extends Yu{constructor(t,e,i,o){super(t,e),this.reason=i,this.code=o,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class k0 extends Yu{constructor(t,e,i,o){super(t,e),this.reason=i,this.code=o,this.type=16}}class vC extends Yu{constructor(t,e,i,o){super(t,e),this.error=i,this.target=o,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Yz extends Yu{constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xz extends Yu{constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Kz extends Yu{constructor(t,e,i,o,c){super(t,e),this.urlAfterRedirects=i,this.state=o,this.shouldActivate=c,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Qz extends Yu{constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Jz extends Yu{constructor(t,e,i,o){super(t,e),this.urlAfterRedirects=i,this.state=o,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class eV{constructor(t){this.route=t,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class tV{constructor(t){this.route=t,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class nV{constructor(t){this.snapshot=t,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iV{constructor(t){this.snapshot=t,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rV{constructor(t){this.snapshot=t,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class oV{constructor(t){this.snapshot=t,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class TA{constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let lV=(()=>{class n{createUrlTree(e,i,o,c,f,v){return $z(e||i.root,o,c,f,v)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),uV=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(t){return lV.\u0275fac(t)},providedIn:"root"}),n})();class AA{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=bC(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){const e=bC(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=xC(t,this._root);return e.length<2?[]:e[e.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return xC(t,this._root).map(e=>e.value)}}function bC(n,t){if(n===t.value)return t;for(const e of t.children){const i=bC(n,e);if(i)return i}return null}function xC(n,t){if(n===t.value)return[t];for(const e of t.children){const i=xC(n,e);if(i.length)return i.unshift(t),i}return[]}class Fd{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function Zm(n){const t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}class IA extends AA{constructor(t,e){super(t),this.snapshot=e,wC(this,t)}toString(){return this.snapshot.toString()}}function kA(n,t){const e=function dV(n,t){const f=new P0([],{},{},"",{},Jn,t,null,n.root,-1,{});return new RA("",new Fd(f,[]))}(n,t),i=new fc([new vy("",{})]),o=new fc({}),c=new fc({}),f=new fc({}),v=new fc(""),C=new cf(i,o,f,v,c,Jn,t,e.root);return C.snapshot=e.root,new IA(new Fd(C,[]),e)}class cf{constructor(t,e,i,o,c,f,v,C){this.url=t,this.params=e,this.queryParams=i,this.fragment=o,this.data=c,this.outlet=f,this.component=v,this.title=this.data?.pipe(nn(S=>S[yy]))??sn(void 0),this._futureSnapshot=C}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(nn(t=>Hm(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(nn(t=>Hm(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function PA(n,t="emptyOnly"){const e=n.pathFromRoot;let i=0;if("always"!==t)for(i=e.length-1;i>=1;){const o=e[i],c=e[i-1];if(o.routeConfig&&""===o.routeConfig.path)i--;else{if(c.component)break;i--}}return function hV(n){return n.reduce((t,e)=>({params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.resolve,...e.routeConfig?.data,...e._resolvedData}}),{params:{},data:{},resolve:{}})}(e.slice(i))}class P0{get title(){return this.data?.[yy]}constructor(t,e,i,o,c,f,v,C,S,R,V){this.url=t,this.params=e,this.queryParams=i,this.fragment=o,this.data=c,this.outlet=f,this.component=v,this.routeConfig=C,this._urlSegment=S,this._lastPathIndex=R,this._resolve=V}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Hm(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Hm(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class RA extends AA{constructor(t,e){super(e),this.url=t,wC(this,e)}toString(){return FA(this._root)}}function wC(n,t){t.value._routerState=n,t.children.forEach(e=>wC(n,e))}function FA(n){const t=n.children.length>0?` { ${n.children.map(FA).join(", ")} } `:"";return`${n.value}${t}`}function CC(n){if(n.snapshot){const t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,Zu(t.queryParams,e.queryParams)||n.queryParams.next(e.queryParams),t.fragment!==e.fragment&&n.fragment.next(e.fragment),Zu(t.params,e.params)||n.params.next(e.params),function Mz(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!Zu(n[e],t[e]))return!1;return!0}(t.url,e.url)||n.url.next(e.url),Zu(t.data,e.data)||n.data.next(e.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function EC(n,t){const e=Zu(n.params,t.params)&&function Iz(n,t){return sf(n,t)&&n.every((e,i)=>Zu(e.parameters,t[i].parameters))}(n.url,t.url);return e&&!(!n.parent!=!t.parent)&&(!n.parent||EC(n.parent,t.parent))}function Dy(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){const i=e.value;i._futureSnapshot=t.value;const o=function fV(n,t,e){return t.children.map(i=>{for(const o of e.children)if(n.shouldReuseRoute(i.value,o.value.snapshot))return Dy(n,i,o);return Dy(n,i)})}(n,t,e);return new Fd(i,o)}{if(n.shouldAttach(t.value)){const c=n.retrieve(t.value);if(null!==c){const f=c.route;return f.value._futureSnapshot=t.value,f.children=t.children.map(v=>Dy(n,v)),f}}const i=function mV(n){return new cf(new fc(n.url),new fc(n.params),new fc(n.queryParams),new fc(n.fragment),new fc(n.data),n.outlet,n.component,n)}(t.value),o=t.children.map(c=>Dy(n,c));return new Fd(i,o)}}const DC="ngNavigationCancelingError";function OA(n,t){const{redirectTo:e,navigationBehaviorOptions:i}=af(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=LA(!1,0,t);return o.url=e,o.navigationBehaviorOptions=i,o}function LA(n,t,e){const i=new Error("NavigationCancelingError: "+(n||""));return i[DC]=!0,i.cancellationCode=t,e&&(i.url=e),i}function NA(n){return BA(n)&&af(n.url)}function BA(n){return n&&n[DC]}class gV{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new My,this.attachRef=null}}let My=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const o=this.getOrCreateContext(e);o.outlet=i,this.contexts.set(e,o)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new gV,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const R0=!1;let F0=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Jn,this.activateEvents=new on,this.deactivateEvents=new on,this.attachEvents=new on,this.detachEvents=new on,this.parentContexts=bn(My),this.location=bn(tl),this.changeDetector=bn(pa),this.environmentInjector=bn(Xc)}ngOnChanges(e){if(e.name){const{firstChange:i,previousValue:o}=e.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new nt(4012,R0);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new nt(4012,R0);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new nt(4012,R0);this.location.detach();const e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){const e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new nt(4013,R0);this._activatedRoute=e;const o=this.location,f=e.snapshot.component,v=this.parentContexts.getOrCreateContext(this.name).children,C=new _V(e,v,o.injector);if(i&&function yV(n){return!!n.resolveComponentFactory}(i)){const S=i.resolveComponentFactory(f);this.activated=o.createComponent(S,o.length,C)}else this.activated=o.createComponent(f,{index:o.length,injector:C,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[tr]}),n})();class _V{constructor(t,e,i){this.route=t,this.childContexts=e,this.parent=i}get(t,e){return t===cf?this.route:t===My?this.childContexts:this.parent.get(t,e)}}let MC=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["ng-component"]],standalone:!0,features:[l1],decls:1,vars:0,template:function(e,i){1&e&&It(0,"router-outlet")},dependencies:[F0],encapsulation:2}),n})();function zA(n,t){return n.providers&&!n._injector&&(n._injector=Gb(n.providers,t,`Route: ${n.path}`)),n._injector??t}function TC(n){const t=n.children&&n.children.map(TC),e=t?{...n,children:t}:{...n};return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==Jn&&(e.component=MC),e}function mc(n){return n.outlet||Jn}function VA(n,t){const e=n.filter(i=>mc(i)===t);return e.push(...n.filter(i=>mc(i)!==t)),e}function Sy(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}class CV{constructor(t,e,i,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=o}activate(t){const e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),CC(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){const o=Zm(e);t.children.forEach(c=>{const f=c.value.outlet;this.deactivateRoutes(c,o[f],i),delete o[f]}),Is(o,(c,f)=>{this.deactivateRouteAndItsChildren(c,i)})}deactivateRoutes(t,e,i){const o=t.value,c=e?e.value:null;if(o===c)if(o.component){const f=i.getContext(o.outlet);f&&this.deactivateChildRoutes(t,e,f.children)}else this.deactivateChildRoutes(t,e,i);else c&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const i=e.getContext(t.value.outlet),o=i&&t.value.component?i.children:e,c=Zm(t);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],o);if(i&&i.outlet){const f=i.outlet.detach(),v=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:f,route:t,contexts:v})}}deactivateRouteAndOutlet(t,e){const i=e.getContext(t.value.outlet),o=i&&t.value.component?i.children:e,c=Zm(t);for(const f of Object.keys(c))this.deactivateRouteAndItsChildren(c[f],o);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(t,e,i){const o=Zm(e);t.children.forEach(c=>{this.activateRoutes(c,o[c.value.outlet],i),this.forwardEvent(new oV(c.value.snapshot))}),t.children.length&&this.forwardEvent(new iV(t.value.snapshot))}activateRoutes(t,e,i){const o=t.value,c=e?e.value:null;if(CC(o),o===c)if(o.component){const f=i.getOrCreateContext(o.outlet);this.activateChildRoutes(t,e,f.children)}else this.activateChildRoutes(t,e,i);else if(o.component){const f=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const v=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),f.children.onOutletReAttached(v.contexts),f.attachRef=v.componentRef,f.route=v.route.value,f.outlet&&f.outlet.attach(v.componentRef,v.route.value),CC(v.route.value),this.activateChildRoutes(t,null,f.children)}else{const v=Sy(o.snapshot),C=v?.get(Kc)??null;f.attachRef=null,f.route=o,f.resolver=C,f.injector=v,f.outlet&&f.outlet.activateWith(o,f.injector),this.activateChildRoutes(t,null,f.children)}}else this.activateChildRoutes(t,null,i)}}class UA{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class O0{constructor(t,e){this.component=t,this.route=e}}function EV(n,t,e){const i=n._root;return Ty(i,t?t._root:null,e,[i.value])}function Ym(n,t){const e=Symbol(),i=t.get(n,e);return i===e?"function"!=typeof n||function jl(n){return null!==Ul(n)}(n)?t.get(n):n:i}function Ty(n,t,e,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=Zm(t);return n.children.forEach(f=>{(function MV(n,t,e,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const c=n.value,f=t?t.value:null,v=e?e.getContext(n.value.outlet):null;if(f&&c.routeConfig===f.routeConfig){const C=function SV(n,t,e){if("function"==typeof e)return e(n,t);switch(e){case"pathParamsChange":return!sf(n.url,t.url);case"pathParamsOrQueryParamsChange":return!sf(n.url,t.url)||!Zu(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!EC(n,t)||!Zu(n.queryParams,t.queryParams);default:return!EC(n,t)}}(f,c,c.routeConfig.runGuardsAndResolvers);C?o.canActivateChecks.push(new UA(i)):(c.data=f.data,c._resolvedData=f._resolvedData),Ty(n,t,c.component?v?v.children:null:e,i,o),C&&v&&v.outlet&&v.outlet.isActivated&&o.canDeactivateChecks.push(new O0(v.outlet.component,f))}else f&&Ay(t,v,o),o.canActivateChecks.push(new UA(i)),Ty(n,null,c.component?v?v.children:null:e,i,o)})(f,c[f.value.outlet],e,i.concat([f.value]),o),delete c[f.value.outlet]}),Is(c,(f,v)=>Ay(f,e.getContext(v),o)),o}function Ay(n,t,e){const i=Zm(n),o=n.value;Is(i,(c,f)=>{Ay(c,o.component?t?t.children.getContext(f):null:t,e)}),e.canDeactivateChecks.push(new O0(o.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,o))}function Iy(n){return"function"==typeof n}function AC(n){return n instanceof b0||"EmptyError"===n?.name}const L0=Symbol("INITIAL_VALUE");function Xm(){return Ys(n=>lC(n.map(t=>t.pipe(ro(1),Uh(L0)))).pipe(nn(t=>{for(const e of t)if(!0!==e){if(e===L0)return L0;if(!1===e||e instanceof Gh)return e}return!0}),oo(t=>t!==L0),ro(1)))}function jA(n){return function vo(...n){return Ro(n)}(yo(t=>{if(af(t))throw OA(0,t)}),nn(t=>!0===t))}const IC={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $A(n,t,e,i,o){const c=kC(n,t,e);return c.matched?function HV(n,t,e,i){const o=t.canMatch;return o&&0!==o.length?sn(o.map(f=>{const v=Ym(f,n);return Hh(function RV(n){return n&&Iy(n.canMatch)}(v)?v.canMatch(t,e):n.runInContext(()=>v(t,e)))})).pipe(Xm(),jA()):sn(!0)}(i=zA(t,i),t,e).pipe(nn(f=>!0===f?c:{...IC})):sn(c)}function kC(n,t,e){if(""===t.path)return"full"===t.pathMatch&&(n.hasChildren()||e.length>0)?{...IC}:{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};const o=(t.matcher||Dz)(e,n,t);if(!o)return{...IC};const c={};Is(o.posParams,(v,C)=>{c[C]=v.path});const f=o.consumed.length>0?{...c,...o.consumed[o.consumed.length-1].parameters}:c;return{matched:!0,consumedSegments:o.consumed,remainingSegments:e.slice(o.consumed.length),parameters:f,positionalParamSegments:o.posParams??{}}}function N0(n,t,e,i){if(e.length>0&&function WV(n,t,e){return e.some(i=>B0(n,t,i)&&mc(i)!==Jn)}(n,e,i)){const c=new yi(t,function qV(n,t,e,i){const o={};o[Jn]=i,i._sourceSegment=n,i._segmentIndexShift=t.length;for(const c of e)if(""===c.path&&mc(c)!==Jn){const f=new yi([],{});f._sourceSegment=n,f._segmentIndexShift=t.length,o[mc(c)]=f}return o}(n,t,i,new yi(e,n.children)));return c._sourceSegment=n,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:[]}}if(0===e.length&&function ZV(n,t,e){return e.some(i=>B0(n,t,i))}(n,e,i)){const c=new yi(n.segments,function GV(n,t,e,i,o){const c={};for(const f of i)if(B0(n,e,f)&&!o[mc(f)]){const v=new yi([],{});v._sourceSegment=n,v._segmentIndexShift=t.length,c[mc(f)]=v}return{...o,...c}}(n,t,e,i,n.children));return c._sourceSegment=n,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:e}}const o=new yi(n.segments,n.children);return o._sourceSegment=n,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:e}}function B0(n,t,e){return(!(n.hasChildren()||t.length>0)||"full"!==e.pathMatch)&&""===e.path}function HA(n,t,e,i){return!!(mc(n)===i||i!==Jn&&B0(t,e,n))&&("**"===n.path||kC(t,n,e).matched)}function GA(n,t,e){return 0===t.length&&!n.children[e]}const z0=!1;class V0{constructor(t){this.segmentGroup=t||null}}class qA{constructor(t){this.urlTree=t}}function ky(n){return rf(new V0(n))}function WA(n){return rf(new qA(n))}class QV{constructor(t,e,i,o,c){this.injector=t,this.configLoader=e,this.urlSerializer=i,this.urlTree=o,this.config=c,this.allowRedirects=!0}apply(){const t=N0(this.urlTree.root,[],[],this.config).segmentGroup,e=new yi(t.segments,t.children);return this.expandSegmentGroup(this.injector,this.config,e,Jn).pipe(nn(c=>this.createUrlTree(A0(c),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Rd(c=>{if(c instanceof qA)return this.allowRedirects=!1,this.match(c.urlTree);throw c instanceof V0?this.noMatchError(c):c}))}match(t){return this.expandSegmentGroup(this.injector,this.config,t.root,Jn).pipe(nn(o=>this.createUrlTree(A0(o),t.queryParams,t.fragment))).pipe(Rd(o=>{throw o instanceof V0?this.noMatchError(o):o}))}noMatchError(t){return new nt(4002,z0)}createUrlTree(t,e,i){const o=fC(t);return new Gh(o,e,i)}expandSegmentGroup(t,e,i,o){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(t,e,i).pipe(nn(c=>new yi([],c))):this.expandSegment(t,i,e,i.segments,o,!0)}expandChildren(t,e,i){const o=[];for(const c of Object.keys(i.children))"primary"===c?o.unshift(c):o.push(c);return lr(o).pipe($h(c=>{const f=i.children[c],v=VA(e,c);return this.expandSegmentGroup(t,v,f,c).pipe(nn(C=>({segment:C,outlet:c})))}),oA((c,f)=>(c[f.outlet]=f.segment,c),{}),sA())}expandSegment(t,e,i,o,c,f){return lr(i).pipe($h(v=>this.expandSegmentAgainstRoute(t,e,i,v,o,c,f).pipe(Rd(S=>{if(S instanceof V0)return sn(null);throw S}))),jh(v=>!!v),Rd((v,C)=>{if(AC(v))return GA(e,o,c)?sn(new yi([],{})):ky(e);throw v}))}expandSegmentAgainstRoute(t,e,i,o,c,f,v){return HA(o,e,c,f)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(t,e,o,c,f):v&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,i,o,c,f):ky(e):ky(e)}expandSegmentAgainstRouteUsingRedirect(t,e,i,o,c,f){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,i,o,f):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,o,c,f)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,i,o){const c=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?WA(c):this.lineralizeSegments(i,c).pipe(Je(f=>{const v=new yi(f,{});return this.expandSegment(t,v,e,f,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,i,o,c,f){const{matched:v,consumedSegments:C,remainingSegments:S,positionalParamSegments:R}=kC(e,o,c);if(!v)return ky(e);const V=this.applyRedirectCommands(C,o.redirectTo,R);return o.redirectTo.startsWith("/")?WA(V):this.lineralizeSegments(o,V).pipe(Je(Q=>this.expandSegment(t,e,i,Q.concat(S),f,!1)))}matchSegmentAgainstRoute(t,e,i,o,c){return"**"===i.path?(t=zA(i,t),i.loadChildren?(i._loadedRoutes?sn({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(t,i)).pipe(nn(v=>(i._loadedRoutes=v.routes,i._loadedInjector=v.injector,new yi(o,{})))):sn(new yi(o,{}))):$A(e,i,o,t).pipe(Ys(({matched:f,consumedSegments:v,remainingSegments:C})=>f?this.getChildConfig(t=i._injector??t,i,o).pipe(Je(R=>{const V=R.injector??t,Q=R.routes,{segmentGroup:oe,slicedSegments:me}=N0(e,v,C,Q),Ee=new yi(oe.segments,oe.children);if(0===me.length&&Ee.hasChildren())return this.expandChildren(V,Q,Ee).pipe(nn(rt=>new yi(v,rt)));if(0===Q.length&&0===me.length)return sn(new yi(v,{}));const $e=mc(i)===c;return this.expandSegment(V,Ee,Q,me,$e?Jn:c,!0).pipe(nn(St=>new yi(v.concat(St.segments),St.children)))})):ky(e)))}getChildConfig(t,e,i){return e.children?sn({routes:e.children,injector:t}):e.loadChildren?void 0!==e._loadedRoutes?sn({routes:e._loadedRoutes,injector:e._loadedInjector}):function $V(n,t,e,i){const o=t.canLoad;return void 0===o||0===o.length?sn(!0):sn(o.map(f=>{const v=Ym(f,n);return Hh(function AV(n){return n&&Iy(n.canLoad)}(v)?v.canLoad(t,e):n.runInContext(()=>v(t,e)))})).pipe(Xm(),jA())}(t,e,i).pipe(Je(o=>o?this.configLoader.loadChildren(t,e).pipe(yo(c=>{e._loadedRoutes=c.routes,e._loadedInjector=c.injector})):function XV(n){return rf(LA(z0,3))}())):sn({routes:[],injector:t})}lineralizeSegments(t,e){let i=[],o=e.root;for(;;){if(i=i.concat(o.segments),0===o.numberOfChildren)return sn(i);if(o.numberOfChildren>1||!o.children[Jn])return t.redirectTo,rf(new nt(4e3,z0));o=o.children[Jn]}}applyRedirectCommands(t,e,i){return this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i)}applyRedirectCreateUrlTree(t,e,i,o){const c=this.createSegmentGroup(t,e.root,i,o);return new Gh(c,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const i={};return Is(t,(o,c)=>{if("string"==typeof o&&o.startsWith(":")){const v=o.substring(1);i[c]=e[v]}else i[c]=o}),i}createSegmentGroup(t,e,i,o){const c=this.createSegments(t,e.segments,i,o);let f={};return Is(e.children,(v,C)=>{f[C]=this.createSegmentGroup(t,v,i,o)}),new yi(c,f)}createSegments(t,e,i,o){return e.map(c=>c.path.startsWith(":")?this.findPosParam(t,c,o):this.findOrReturn(c,i))}findPosParam(t,e,i){const o=i[e.path.substring(1)];if(!o)throw new nt(4001,z0);return o}findOrReturn(t,e){let i=0;for(const o of e){if(o.path===t.path)return e.splice(i),o;i++}return t}}class e3{}class i3{constructor(t,e,i,o,c,f,v){this.injector=t,this.rootComponentType=e,this.config=i,this.urlTree=o,this.url=c,this.paramsInheritanceStrategy=f,this.urlSerializer=v}recognize(){const t=N0(this.urlTree.root,[],[],this.config.filter(e=>void 0===e.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,t,Jn).pipe(nn(e=>{if(null===e)return null;const i=new P0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Jn,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new Fd(i,e),c=new RA(this.url,o);return this.inheritParamsAndData(c._root),c}))}inheritParamsAndData(t){const e=t.value,i=PA(e,this.paramsInheritanceStrategy);e.params=Object.freeze(i.params),e.data=Object.freeze(i.data),t.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(t,e,i,o){return 0===i.segments.length&&i.hasChildren()?this.processChildren(t,e,i):this.processSegment(t,e,i,i.segments,o)}processChildren(t,e,i){return lr(Object.keys(i.children)).pipe($h(o=>{const c=i.children[o],f=VA(e,o);return this.processSegmentGroup(t,f,c,o)}),oA((o,c)=>o&&c?(o.push(...c),o):null),aA(o=>null!==o),x0(null),sA(),nn(o=>{if(null===o)return null;const c=YA(o);return function r3(n){n.sort((t,e)=>t.value.outlet===Jn?-1:e.value.outlet===Jn?1:t.value.outlet.localeCompare(e.value.outlet))}(c),c}))}processSegment(t,e,i,o,c){return lr(e).pipe($h(f=>this.processSegmentAgainstRoute(f._injector??t,f,i,o,c)),jh(f=>!!f),Rd(f=>{if(AC(f))return GA(i,o,c)?sn([]):sn(null);throw f}))}processSegmentAgainstRoute(t,e,i,o,c){if(e.redirectTo||!HA(e,i,o,c))return sn(null);let f;if("**"===e.path){const v=o.length>0?dA(o).parameters:{},C=KA(i)+o.length;f=sn({snapshot:new P0(o,v,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,QA(e),mc(e),e.component??e._loadedComponent??null,e,XA(i),C,JA(e)),consumedSegments:[],remainingSegments:[]})}else f=$A(i,e,o,t).pipe(nn(({matched:v,consumedSegments:C,remainingSegments:S,parameters:R})=>{if(!v)return null;const V=KA(i)+C.length;return{snapshot:new P0(C,R,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,QA(e),mc(e),e.component??e._loadedComponent??null,e,XA(i),V,JA(e)),consumedSegments:C,remainingSegments:S}}));return f.pipe(Ys(v=>{if(null===v)return sn(null);const{snapshot:C,consumedSegments:S,remainingSegments:R}=v;t=e._injector??t;const V=e._loadedInjector??t,Q=function o3(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(e),{segmentGroup:oe,slicedSegments:me}=N0(i,S,R,Q.filter($e=>void 0===$e.redirectTo));if(0===me.length&&oe.hasChildren())return this.processChildren(V,Q,oe).pipe(nn($e=>null===$e?null:[new Fd(C,$e)]));if(0===Q.length&&0===me.length)return sn([new Fd(C,[])]);const Ee=mc(e)===c;return this.processSegment(V,Q,oe,me,Ee?Jn:c).pipe(nn($e=>null===$e?null:[new Fd(C,$e)]))}))}}function s3(n){const t=n.value.routeConfig;return t&&""===t.path&&void 0===t.redirectTo}function YA(n){const t=[],e=new Set;for(const i of n){if(!s3(i)){t.push(i);continue}const o=t.find(c=>i.value.routeConfig===c.value.routeConfig);void 0!==o?(o.children.push(...i.children),e.add(o)):t.push(i)}for(const i of e){const o=YA(i.children);t.push(new Fd(i.value,o))}return t.filter(i=>!e.has(i))}function XA(n){let t=n;for(;t._sourceSegment;)t=t._sourceSegment;return t}function KA(n){let t=n,e=t._segmentIndexShift??0;for(;t._sourceSegment;)t=t._sourceSegment,e+=t._segmentIndexShift??0;return e-1}function QA(n){return n.data||{}}function JA(n){return n.resolve||{}}function eI(n){return"string"==typeof n.title||null===n.title}function PC(n){return Ys(t=>{const e=n(t);return e?lr(e).pipe(nn(()=>t)):sn(t)})}const Km=new wt("ROUTES");let RC=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=bn(AS)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return sn(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);const i=Hh(e.loadComponent()).pipe(nn(nI),yo(c=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=c}),w0(()=>{this.componentLoaders.delete(e)})),o=new uC(i,()=>new yn).pipe(cC());return this.componentLoaders.set(e,o),o}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return sn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const c=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(nn(v=>{this.onLoadEndListener&&this.onLoadEndListener(i);let C,S,R=!1;Array.isArray(v)?S=v:(C=v.create(e).injector,S=uA(C.get(Km,[],dn.Self|dn.Optional)));return{routes:S.map(TC),injector:C}}),w0(()=>{this.childrenLoaders.delete(i)})),f=new uC(c,()=>new yn).pipe(cC());return this.childrenLoaders.set(i,f),f}loadModuleFactoryOrRoutes(e){return Hh(e()).pipe(nn(nI),Je(i=>i instanceof zM||Array.isArray(i)?sn(i):lr(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function nI(n){return function f3(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let j0=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new yn,this.configLoader=bn(RC),this.environmentInjector=bn(Xc),this.urlSerializer=bn(by),this.rootContexts=bn(My),this.navigationId=0,this.afterPreactivation=()=>sn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=o=>this.events.next(new tV(o)),this.configLoader.onLoadStartListener=o=>this.events.next(new eV(o))}complete(){this.transitions?.complete()}handleNavigationRequest(e){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...e,id:i})}setupNavigations(e){return this.transitions=new fc({id:0,targetPageId:0,currentUrlTree:e.currentUrlTree,currentRawUrl:e.currentUrlTree,extractedUrl:e.urlHandlingStrategy.extract(e.currentUrlTree),urlAfterRedirects:e.urlHandlingStrategy.extract(e.currentUrlTree),rawUrl:e.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Ey,restoredState:null,currentSnapshot:e.routerState.snapshot,targetSnapshot:null,currentRouterState:e.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(oo(i=>0!==i.id),nn(i=>({...i,extractedUrl:e.urlHandlingStrategy.extract(i.rawUrl)})),Ys(i=>{let o=!1,c=!1;return sn(i).pipe(yo(f=>{this.currentNavigation={id:f.id,initialUrl:f.rawUrl,extractedUrl:f.extractedUrl,trigger:f.source,extras:f.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Ys(f=>{const v=e.browserUrlTree.toString(),C=!e.navigated||f.extractedUrl.toString()!==v||v!==e.currentUrlTree.toString();if(!C&&"reload"!==(f.extras.onSameUrlNavigation??e.onSameUrlNavigation)){const R="";return this.events.next(new k0(f.id,e.serializeUrl(i.rawUrl),R,0)),e.rawUrlTree=f.rawUrl,f.resolve(null),Ft}if(e.urlHandlingStrategy.shouldProcessUrl(f.rawUrl))return iI(f.source)&&(e.browserUrlTree=f.extractedUrl),sn(f).pipe(Ys(R=>{const V=this.transitions?.getValue();return this.events.next(new yC(R.id,this.urlSerializer.serialize(R.extractedUrl),R.source,R.restoredState)),V!==this.transitions?.getValue()?Ft:Promise.resolve(R)}),function JV(n,t,e,i){return Ys(o=>function KV(n,t,e,i,o){return new QV(n,t,e,i,o).apply()}(n,t,e,o.extractedUrl,i).pipe(nn(c=>({...o,urlAfterRedirects:c}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,e.config),yo(R=>{this.currentNavigation={...this.currentNavigation,finalUrl:R.urlAfterRedirects},i.urlAfterRedirects=R.urlAfterRedirects}),function l3(n,t,e,i,o){return Je(c=>function n3(n,t,e,i,o,c,f="emptyOnly"){return new i3(n,t,e,i,o,f,c).recognize().pipe(Ys(v=>null===v?function t3(n){return new xn(t=>t.error(n))}(new e3):sn(v)))}(n,t,e,c.urlAfterRedirects,i.serialize(c.urlAfterRedirects),i,o).pipe(nn(f=>({...c,targetSnapshot:f}))))}(this.environmentInjector,this.rootComponentType,e.config,this.urlSerializer,e.paramsInheritanceStrategy),yo(R=>{if(i.targetSnapshot=R.targetSnapshot,"eager"===e.urlUpdateStrategy){if(!R.extras.skipLocationChange){const Q=e.urlHandlingStrategy.merge(R.urlAfterRedirects,R.rawUrl);e.setBrowserUrl(Q,R)}e.browserUrlTree=R.urlAfterRedirects}const V=new Yz(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects),R.targetSnapshot);this.events.next(V)}));if(C&&e.urlHandlingStrategy.shouldProcessUrl(e.rawUrlTree)){const{id:R,extractedUrl:V,source:Q,restoredState:oe,extras:me}=f,Ee=new yC(R,this.urlSerializer.serialize(V),Q,oe);this.events.next(Ee);const $e=kA(V,this.rootComponentType).snapshot;return sn(i={...f,targetSnapshot:$e,urlAfterRedirects:V,extras:{...me,skipLocationChange:!1,replaceUrl:!1}})}{const R="";return this.events.next(new k0(f.id,e.serializeUrl(i.extractedUrl),R,1)),e.rawUrlTree=f.rawUrl,f.resolve(null),Ft}}),yo(f=>{const v=new Xz(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot);this.events.next(v)}),nn(f=>i={...f,guards:EV(f.targetSnapshot,f.currentSnapshot,this.rootContexts)}),function OV(n,t){return Je(e=>{const{targetSnapshot:i,currentSnapshot:o,guards:{canActivateChecks:c,canDeactivateChecks:f}}=e;return 0===f.length&&0===c.length?sn({...e,guardsResult:!0}):function LV(n,t,e,i){return lr(n).pipe(Je(o=>function jV(n,t,e,i,o){const c=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return c&&0!==c.length?sn(c.map(v=>{const C=Sy(t)??o,S=Ym(v,C);return Hh(function PV(n){return n&&Iy(n.canDeactivate)}(S)?S.canDeactivate(n,t,e,i):C.runInContext(()=>S(n,t,e,i))).pipe(jh())})).pipe(Xm()):sn(!0)}(o.component,o.route,e,t,i)),jh(o=>!0!==o,!0))}(f,i,o,n).pipe(Je(v=>v&&function TV(n){return"boolean"==typeof n}(v)?function NV(n,t,e,i){return lr(t).pipe($h(o=>$m(function zV(n,t){return null!==n&&t&&t(new nV(n)),sn(!0)}(o.route.parent,i),function BV(n,t){return null!==n&&t&&t(new rV(n)),sn(!0)}(o.route,i),function UV(n,t,e){const i=t[t.length-1],c=t.slice(0,t.length-1).reverse().map(f=>function DV(n){const t=n.routeConfig?n.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:n,guards:t}:null}(f)).filter(f=>null!==f).map(f=>_y(()=>sn(f.guards.map(C=>{const S=Sy(f.node)??e,R=Ym(C,S);return Hh(function kV(n){return n&&Iy(n.canActivateChild)}(R)?R.canActivateChild(i,n):S.runInContext(()=>R(i,n))).pipe(jh())})).pipe(Xm())));return sn(c).pipe(Xm())}(n,o.path,e),function VV(n,t,e){const i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||0===i.length)return sn(!0);const o=i.map(c=>_y(()=>{const f=Sy(t)??e,v=Ym(c,f);return Hh(function IV(n){return n&&Iy(n.canActivate)}(v)?v.canActivate(t,n):f.runInContext(()=>v(t,n))).pipe(jh())}));return sn(o).pipe(Xm())}(n,o.route,e))),jh(o=>!0!==o,!0))}(i,c,n,t):sn(v)),nn(v=>({...e,guardsResult:v})))})}(this.environmentInjector,f=>this.events.next(f)),yo(f=>{if(i.guardsResult=f.guardsResult,af(f.guardsResult))throw OA(0,f.guardsResult);const v=new Kz(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(f.urlAfterRedirects),f.targetSnapshot,!!f.guardsResult);this.events.next(v)}),oo(f=>!!f.guardsResult||(e.restoreHistory(f),this.cancelNavigationTransition(f,"",3),!1)),PC(f=>{if(f.guards.canActivateChecks.length)return sn(f).pipe(yo(v=>{const C=new Qz(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(C)}),Ys(v=>{let C=!1;return sn(v).pipe(function c3(n,t){return Je(e=>{const{targetSnapshot:i,guards:{canActivateChecks:o}}=e;if(!o.length)return sn(e);let c=0;return lr(o).pipe($h(f=>function u3(n,t,e,i){const o=n.routeConfig,c=n._resolve;return void 0!==o?.title&&!eI(o)&&(c[yy]=o.title),function d3(n,t,e,i){const o=function h3(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===o.length)return sn({});const c={};return lr(o).pipe(Je(f=>function p3(n,t,e,i){const o=Sy(t)??i,c=Ym(n,o);return Hh(c.resolve?c.resolve(t,e):o.runInContext(()=>c(t,e)))}(n[f],t,e,i).pipe(jh(),yo(v=>{c[f]=v}))),dC(1),lA(c),Rd(f=>AC(f)?Ft:rf(f)))}(c,n,t,i).pipe(nn(f=>(n._resolvedData=f,n.data=PA(n,e).resolve,o&&eI(o)&&(n.data[yy]=o.title),null)))}(f.route,i,n,t)),yo(()=>c++),dC(1),Je(f=>c===o.length?sn(e):Ft))})}(e.paramsInheritanceStrategy,this.environmentInjector),yo({next:()=>C=!0,complete:()=>{C||(e.restoreHistory(v),this.cancelNavigationTransition(v,"",2))}}))}),yo(v=>{const C=new Jz(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(C)}))}),PC(f=>{const v=C=>{const S=[];C.routeConfig?.loadComponent&&!C.routeConfig._loadedComponent&&S.push(this.configLoader.loadComponent(C.routeConfig).pipe(yo(R=>{C.component=R}),nn(()=>{})));for(const R of C.children)S.push(...v(R));return S};return lC(v(f.targetSnapshot.root)).pipe(x0(),ro(1))}),PC(()=>this.afterPreactivation()),nn(f=>{const v=function pV(n,t,e){const i=Dy(n,t._root,e?e._root:void 0);return new IA(i,t)}(e.routeReuseStrategy,f.targetSnapshot,f.currentRouterState);return i={...f,targetRouterState:v}}),yo(f=>{e.currentUrlTree=f.urlAfterRedirects,e.rawUrlTree=e.urlHandlingStrategy.merge(f.urlAfterRedirects,f.rawUrl),e.routerState=f.targetRouterState,"deferred"===e.urlUpdateStrategy&&(f.extras.skipLocationChange||e.setBrowserUrl(e.rawUrlTree,f),e.browserUrlTree=f.urlAfterRedirects)}),((n,t,e)=>nn(i=>(new CV(t,i.targetRouterState,i.currentRouterState,e).activate(n),i)))(this.rootContexts,e.routeReuseStrategy,f=>this.events.next(f)),ro(1),yo({next:f=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,e.navigated=!0,this.events.next(new lf(f.id,this.urlSerializer.serialize(f.extractedUrl),this.urlSerializer.serialize(e.currentUrlTree))),e.titleStrategy?.updateTitle(f.targetRouterState.snapshot),f.resolve(!0)},complete:()=>{o=!0}}),w0(()=>{o||c||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Rd(f=>{if(c=!0,BA(f)){NA(f)||(e.navigated=!0,e.restoreHistory(i,!0));const v=new I0(i.id,this.urlSerializer.serialize(i.extractedUrl),f.message,f.cancellationCode);if(this.events.next(v),NA(f)){const C=e.urlHandlingStrategy.merge(f.url,e.rawUrlTree),S={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===e.urlUpdateStrategy||iI(i.source)};e.scheduleNavigation(C,Ey,null,S,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{e.restoreHistory(i,!0);const v=new vC(i.id,this.urlSerializer.serialize(i.extractedUrl),f,i.targetSnapshot??void 0);this.events.next(v);try{i.resolve(e.errorHandler(f))}catch(C){i.reject(C)}}return Ft}))}))}cancelNavigationTransition(e,i,o){const c=new I0(e.id,this.urlSerializer.serialize(e.extractedUrl),i,o);this.events.next(c),e.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function iI(n){return n!==Ey}let rI=(()=>{class n{buildTitle(e){let i,o=e.root;for(;void 0!==o;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(c=>c.outlet===Jn);return i}getResolvedTitleForRoute(e){return e.data[yy]}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return bn(m3)},providedIn:"root"}),n})(),m3=(()=>{class n extends rI{constructor(e){super(),this.title=e}updateTitle(e){const i=this.buildTitle(e);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(e){return new(e||n)(We(XT))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),g3=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return bn(y3)},providedIn:"root"}),n})();class _3{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let y3=(()=>{class n extends _3{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Jr(n)))(i||n)}}(),n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $0=new wt("",{providedIn:"root",factory:()=>({})});let b3=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:function(){return bn(x3)},providedIn:"root"}),n})(),x3=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function w3(n){throw n}function C3(n,t,e){return t.parse("/")}const E3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},D3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Sl=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=bn(nL),this.isNgZoneEnabled=!1,this.options=bn($0,{optional:!0})||{},this.errorHandler=this.options.errorHandler||w3,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||C3,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=bn(b3),this.routeReuseStrategy=bn(g3),this.urlCreationStrategy=bn(uV),this.titleStrategy=bn(rI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=uA(bn(Km,{optional:!0})??[]),this.navigationTransitions=bn(j0),this.urlSerializer=bn(by),this.location=bn(t0),this.isNgZoneEnabled=bn(Pn)instanceof Pn&&Pn.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Gh,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=kA(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(e=>{this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId??0},e=>{this.console.warn(`Unhandled Navigation Error: ${e}`)})}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const e=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Ey,e)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(e=>{const i="popstate"===e.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(e.url,i,e.state)},0)}))}navigateToSyncWithBrowser(e,i,o){const c={replaceUrl:!0},f=o?.navigationId?o:null;if(o){const C={...o};delete C.navigationId,delete C.\u0275routerPageId,0!==Object.keys(C).length&&(c.state=C)}const v=this.parseUrl(e);this.scheduleNavigation(v,i,f,c)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(e){this.config=e.map(TC),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(e,i={}){const{relativeTo:o,queryParams:c,fragment:f,queryParamsHandling:v,preserveFragment:C}=i,S=C?this.currentUrlTree.fragment:f;let R=null;switch(v){case"merge":R={...this.currentUrlTree.queryParams,...c};break;case"preserve":R=this.currentUrlTree.queryParams;break;default:R=c||null}return null!==R&&(R=this.removeEmptyProps(R)),this.urlCreationStrategy.createUrlTree(o,this.routerState,this.currentUrlTree,e,R,S??null)}navigateByUrl(e,i={skipLocationChange:!1}){const o=af(e)?e:this.parseUrl(e),c=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(c,Ey,null,i)}navigate(e,i={skipLocationChange:!1}){return function M3(n){for(let t=0;t<n.length;t++){const e=n[t];if(null==e)throw new nt(4008,false)}}(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){let i;try{i=this.urlSerializer.parse(e)}catch(o){i=this.malformedUriErrorHandler(o,this.urlSerializer,e)}return i}isActive(e,i){let o;if(o=!0===i?{...E3}:!1===i?{...D3}:i,af(e))return pA(this.currentUrlTree,e,o);const c=this.parseUrl(e);return pA(this.currentUrlTree,c,o)}removeEmptyProps(e){return Object.keys(e).reduce((i,o)=>{const c=e[o];return null!=c&&(i[o]=c),i},{})}scheduleNavigation(e,i,o,c,f){if(this.disposed)return Promise.resolve(!1);let v,C,S,R;return f?(v=f.resolve,C=f.reject,S=f.promise):S=new Promise((V,Q)=>{v=V,C=Q}),R="computed"===this.canceledNavigationResolution?o&&o.\u0275routerPageId?o.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:R,source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:c,resolve:v,reject:C,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(V=>Promise.reject(V))}setBrowserUrl(e,i){const o=this.urlSerializer.serialize(e);if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){const f={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(o,"",f)}else{const c={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.go(o,"",c)}}restoreHistory(e,i=!1){if("computed"===this.canceledNavigationResolution){const c=this.currentPageId-(this.browserPageId??this.currentPageId);0!==c?this.location.historyGo(c):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===c&&(this.resetState(e),this.browserUrlTree=e.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=e.currentRouterState,this.currentUrlTree=e.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return"computed"===this.canceledNavigationResolution?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Py=(()=>{class n{constructor(e,i,o,c,f,v){this.router=e,this.route=i,this.tabIndexAttribute=o,this.renderer=c,this.el=f,this.locationStrategy=v,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new yn;const C=f.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===C||"area"===C,this.isAnchorElement?this.subscription=e.events.subscribe(S=>{S instanceof lf&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(e){this._preserveFragment=Vm(e)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(e){this._skipLocationChange=Vm(e)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(e){this._replaceUrl=Vm(e)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(e){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(e){null!=e?(this.commands=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(e,i,o,c,f){return!!(null===this.urlTree||this.isAnchorElement&&(0!==e||i||o||c||f||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const e=null===this.href?null:function Ch(n,t,e){return function mw(n,t){return"src"===t&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===t&&("base"===n||"link"===n)?Rp:i_}(t,e)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",e)}applyAttributeValue(e,i){const o=this.renderer,c=this.el.nativeElement;null!==i?o.setAttribute(c,e,i):o.removeAttribute(c,e)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(e){return new(e||n)(ve(Sl),ve(cf),gd("tabindex"),ve(Jc),ve(_i),ve(tf))},n.\u0275dir=Vt({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(e,i){1&e&&mn("click",function(c){return i.onClick(c.button,c.ctrlKey,c.shiftKey,c.altKey,c.metaKey)}),2&e&&Ze("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[tr]}),n})();class oI{}let A3=(()=>{class n{constructor(e,i,o,c,f){this.router=e,this.injector=o,this.preloadingStrategy=c,this.loader=f}setUpPreloading(){this.subscription=this.router.events.pipe(oo(e=>e instanceof lf),$h(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){const o=[];for(const c of i){c.providers&&!c._injector&&(c._injector=Gb(c.providers,e,`Route: ${c.path}`));const f=c._injector??e,v=c._loadedInjector??f;(c.loadChildren&&!c._loadedRoutes&&void 0===c.canLoad||c.loadComponent&&!c._loadedComponent)&&o.push(this.preloadConfig(f,c)),(c.children||c._loadedRoutes)&&o.push(this.processRoutes(v,c.children??c._loadedRoutes))}return lr(o).pipe(zt())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let o;o=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(e,i):sn(null);const c=o.pipe(Je(f=>null===f?sn(void 0):(i._loadedRoutes=f.routes,i._loadedInjector=f.injector,this.processRoutes(f.injector??e,f.routes))));return i.loadComponent&&!i._loadedComponent?lr([c,this.loader.loadComponent(i)]).pipe(zt()):c})}}return n.\u0275fac=function(e){return new(e||n)(We(Sl),We(AS),We(Xc),We(oI),We(RC))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const OC=new wt("");let sI=(()=>{class n{constructor(e,i,o,c,f={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=o,this.zone=c,this.options=f,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},f.scrollPositionRestoration=f.scrollPositionRestoration||"disabled",f.anchorScrolling=f.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof yC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof lf&&(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof TA&&(e.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(e.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new TA(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(e){nu()},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();var Tl=(()=>((Tl=Tl||{})[Tl.COMPLETE=0]="COMPLETE",Tl[Tl.FAILED=1]="FAILED",Tl[Tl.REDIRECTING=2]="REDIRECTING",Tl))();const Qm=!1;function qh(n,t){return{\u0275kind:n,\u0275providers:t}}const LC=new wt("",{providedIn:"root",factory:()=>!1});function lI(){const n=bn(Ts);return t=>{const e=n.get(Jp);if(t!==e.components[0])return;const i=n.get(Sl),o=n.get(cI);1===n.get(NC)&&i.initialNavigation(),n.get(uI,null,dn.Optional)?.setUpPreloading(),n.get(OC,null,dn.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}const cI=new wt(Qm?"bootstrap done indicator":"",{factory:()=>new yn}),NC=new wt(Qm?"initial navigation":"",{providedIn:"root",factory:()=>1});function F3(){let n=[];return n=Qm?[{provide:Fp,multi:!0,useFactory:()=>{const t=bn(Sl);return()=>t.events.subscribe(e=>{console.group?.(`Router Event: ${e.constructor.name}`),console.log(function sV(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(e)),console.log(e),console.groupEnd?.()})}}]:[],qh(1,n)}const uI=new wt(Qm?"router preloader":"");function O3(n){return qh(0,[{provide:uI,useExisting:A3},{provide:oI,useExisting:n}])}const Ry=!1,dI=new wt(Ry?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),L3=[t0,{provide:by,useClass:hC},Sl,My,{provide:cf,useFactory:function aI(n){return n.routerState.root},deps:[Sl]},RC,Ry?{provide:LC,useValue:!0}:[]];function N3(){return new NS("Router",Sl)}let hI=(()=>{class n{constructor(e){}static forRoot(e,i){return{ngModule:n,providers:[L3,Ry&&i?.enableTracing?F3().\u0275providers:[],{provide:Km,multi:!0,useValue:e},{provide:dI,useFactory:U3,deps:[[Sl,new ds,new bl]]},{provide:$0,useValue:i||{}},i?.useHash?{provide:tf,useClass:HL}:{provide:tf,useClass:sT},{provide:OC,useFactory:()=>{const n=bn(aB),t=bn(Pn),e=bn($0),i=bn(j0),o=bn(by);return e.scrollOffset&&n.setOffset(e.scrollOffset),new sI(o,i,n,t,e)}},i?.preloadingStrategy?O3(i.preloadingStrategy).\u0275providers:[],{provide:NS,multi:!0,useFactory:N3},i?.initialNavigation?j3(i):[],[{provide:pI,useFactory:lI},{provide:LS,multi:!0,useExisting:pI}]]}}static forChild(e){return{ngModule:n,providers:[{provide:Km,multi:!0,useValue:e}]}}}return n.\u0275fac=function(e){return new(e||n)(We(dI,8))},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[MC]}),n})();function U3(n){if(Ry&&n)throw new nt(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function j3(n){return["disabled"===n.initialNavigation?qh(3,[{provide:oy,multi:!0,useFactory:()=>{const t=bn(Sl);return()=>{t.setUpLocationChangeListener()}}},{provide:NC,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?qh(2,[{provide:NC,useValue:0},{provide:oy,multi:!0,deps:[Ts],useFactory:t=>{const e=t.get(jL,Promise.resolve());return()=>e.then(()=>new Promise(i=>{const o=t.get(Sl),c=t.get(cI);(function I3(n,t){n.events.pipe(oo(e=>e instanceof lf||e instanceof I0||e instanceof vC||e instanceof k0),nn(e=>e instanceof lf||e instanceof k0?Tl.COMPLETE:e instanceof I0&&(0===e.code||1===e.code)?Tl.REDIRECTING:Tl.FAILED),oo(e=>e!==Tl.REDIRECTING),ro(1)).subscribe(()=>{t()})})(o,()=>{i(!0)}),t.get(j0).afterPreactivation=()=>(i(!0),c.closed?sn(void 0):c),o.initialNavigation()}))}}]).\u0275providers:[]]}const pI=new wt(Ry?"Router Initializer":""),H3=function(n){return{"background-color":n}};let G3=(()=>{class n{constructor(){this.backgroundColor="#FFF5E4",this.prevBackgroundColor="",this.color="",this.searchTerm="",this.filteredItems=[],this.items=[{name:"item 1",description:"This is item 1"},{name:"item 2",description:"This is item 2"},{name:"item 3",description:"This is item 3"},{name:"item 4",description:"This is item 4"},{name:"item 5",description:"This is item 5"}]}changeColor(){"#FFF5E4"===this.backgroundColor?(this.prevBackgroundColor=this.backgroundColor,this.backgroundColor="#850E35"):this.backgroundColor=this.prevBackgroundColor,this.color="primary"===this.color?"accent":"primary"}onSubmit(){const e=this.searchTerm.toLowerCase();this.filteredItems=this.items.filter(i=>{const o=i.name.toLowerCase(),c=i.description.toLowerCase();return o.includes(e)||c.includes(e)})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-header"]],decls:23,vars:3,consts:[[3,"ngStyle"],[1,"header"],[1,"flex"],["routerLink","/",1,"logo"],["id","menu-btn",1,"fas","fa-bars"],[1,"navbar"],["routerLink","/"],["routerLink","about"],["routerLink","registro"],["routerLink","galeria"],["routerLink","reservaciones"],["routerLink","habitacion-list"],[1,"example-button-row"],["mat-raised-button","","type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,i){1&e&&(pe(0,"div",0)(1,"section",1)(2,"div",2)(3,"a",3),Qe(4,"Axolotl Palace"),xe(),It(5,"div",4),xe(),pe(6,"nav",5)(7,"a",6),Qe(8,"Axolotl"),xe(),pe(9,"a",7),Qe(10,"Sobre Nosotros"),xe(),pe(11,"a",8),Qe(12,"Reserva"),xe(),pe(13,"a",9),Qe(14,"Galeria"),xe(),pe(15,"a",10),Qe(16,"Reservaciones"),xe(),pe(17,"a",11),Qe(18,"Habitacion"),xe(),pe(19,"div",12)(20,"button",13),mn("click",function(){return i.changeColor()}),Qe(21,"Cambiar color"),xe()()()(),It(22,"router-outlet"),xe()),2&e&&ht("ngStyle",WM(1,H3,i.backgroundColor))},dependencies:[CT,F0,Py],styles:["button.active[_ngcontent-%COMP%] {\n   -shadowcsshost-no-combinator.active {\n  background-color: green;\n}\n }\n .example-label[_ngcontent-%COMP%] {\n  display: table-cell;\n  font-size: 14px;\n  margin-left: 8px;\n  min-width: 120px;\n}\n\n.example-button-row[_ngcontent-%COMP%] {\n  display: table-cell;\n  max-width: 600px;\n}\n\n.example-button-row[_ngcontent-%COMP%]   .mat-mdc-button-base[_ngcontent-%COMP%] {\n  margin: 8px 8px 8px 0;\n}\n\n.example-flex-container[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n}\n\n.example-button-container[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: center;\n  width: 120px;\n}\n.btn-primary[_ngcontent-%COMP%] {\n\t\t\tbackground-color: #850E35;\n\t\t\tborder-color: #850E35;\n\t\t\tfont-weight: bold;\n\t\t}\n\t\t\n\t\t.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus {\n\t\t\tbackground-color: #EE6983;\n\t\t\tborder-color: #EE6983;\n\t\t}"]}),n})(),q3=(()=>{class n{constructor(){this.title="Reservaciones",this.comments=[],this.isActive=!1}onNewCommentAdded(e){console.log("Nuevo comentario agregado:",e)}ngOnInit(){v0().accessToken=eA_mapbox_accessToken,new(v0().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-74.5,40],zoom:9})}changeBackgroundColor(){this.isActive=!this.isActive}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(e,i){1&e&&It(0,"app-header")},dependencies:[G3],encapsulation:2}),n})();let mI=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(ve(Jc),ve(_i))},n.\u0275dir=Vt({type:n}),n})(),uf=(()=>{class n extends mI{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Jr(n)))(i||n)}}(),n.\u0275dir=Vt({type:n,features:[Zn]}),n})();const fu=new wt("NgValueAccessor"),Z3={provide:fu,useExisting:ci(()=>Fy),multi:!0},X3=new wt("CompositionEventMode");let Fy=(()=>{class n extends mI{constructor(e,i,o){super(e,i),this._compositionMode=o,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Y3(){const n=Id()?Id().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(Jc),ve(_i),ve(X3,8))},n.\u0275dir=Vt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&mn("input",function(c){return i._handleInput(c.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(c){return i._compositionEnd(c.target.value)})},features:[Ki([Z3]),Zn]}),n})();const K3=!1;function Wh(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function _I(n){return null!=n&&"number"==typeof n.length}const ks=new wt("NgValidators"),Zh=new wt("NgAsyncValidators"),Q3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class BC{static min(t){return function yI(n){return t=>{if(Wh(t.value)||Wh(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(t)}static max(t){return function vI(n){return t=>{if(Wh(t.value)||Wh(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(t)}static required(t){return function bI(n){return Wh(n.value)?{required:!0}:null}(t)}static requiredTrue(t){return function xI(n){return!0===n.value?null:{required:!0}}(t)}static email(t){return function wI(n){return Wh(n.value)||Q3.test(n.value)?null:{email:!0}}(t)}static minLength(t){return function CI(n){return t=>Wh(t.value)||!_I(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static maxLength(t){return function EI(n){return t=>_I(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(t)}static pattern(t){return function DI(n){if(!n)return H0;let t,e;return"string"==typeof n?(e="","^"!==n.charAt(0)&&(e+="^"),e+=n,"$"!==n.charAt(n.length-1)&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(Wh(i.value))return null;const o=i.value;return t.test(o)?null:{pattern:{requiredPattern:e,actualValue:o}}}}(t)}static nullValidator(t){return null}static compose(t){return kI(t)}static composeAsync(t){return PI(t)}}function H0(n){return null}function MI(n){return null!=n}function SI(n){const t=Ur(n)?lr(n):n;if(K3&&!jr(t)){let e="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(e+=" Are you using a synchronous validator where an async validator is expected?"),new nt(-1101,e)}return t}function TI(n){let t={};return n.forEach(e=>{t=null!=e?{...t,...e}:t}),0===Object.keys(t).length?null:t}function AI(n,t){return t.map(e=>e(n))}function II(n){return n.map(t=>function J3(n){return!n.validate}(t)?t:e=>t.validate(e))}function kI(n){if(!n)return null;const t=n.filter(MI);return 0==t.length?null:function(e){return TI(AI(e,t))}}function zC(n){return null!=n?kI(II(n)):null}function PI(n){if(!n)return null;const t=n.filter(MI);return 0==t.length?null:function(e){return function fI(...n){const t=rn(n),{args:e,keys:i}=tA(n),o=new xn(c=>{const{length:f}=e;if(!f)return void c.complete();const v=new Array(f);let C=f,S=f;for(let R=0;R<f;R++){let V=!1;H(e[R]).subscribe(Rn(c,Q=>{V||(V=!0,S--),v[R]=Q},()=>C--,void 0,()=>{(!C||!V)&&(S||c.next(i?nA(i,v):v),c.complete())}))}});return t?o.pipe(aC(t)):o}(AI(e,t).map(SI)).pipe(nn(TI))}}function VC(n){return null!=n?PI(II(n)):null}function RI(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function FI(n){return n._rawValidators}function OI(n){return n._rawAsyncValidators}function UC(n){return n?Array.isArray(n)?n:[n]:[]}function G0(n,t){return Array.isArray(n)?n.includes(t):n===t}function LI(n,t){const e=UC(t);return UC(n).forEach(o=>{G0(e,o)||e.push(o)}),e}function NI(n,t){return UC(t).filter(e=>!G0(n,e))}class BI{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=zC(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=VC(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class fa extends BI{get formDirective(){return null}get path(){return null}}class Xu extends BI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class zI{constructor(t){this._cd=t}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let jC=(()=>{class n extends zI{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(Xu,2))},n.\u0275dir=Vt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&vr("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Zn]}),n})(),$C=(()=>{class n extends zI{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(fa,10))},n.\u0275dir=Vt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&vr("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Zn]}),n})();function VI(n,t){return n?`with name: '${t}'`:`at index: ${t}`}const qC=!1,Oy="VALID",W0="INVALID",Jm="PENDING",Ly="DISABLED";function WC(n){return(Z0(n)?n.validators:n)||null}function ZC(n,t){return(Z0(t)?t.asyncValidators:n)||null}function Z0(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class $I{constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Oy}get invalid(){return this.status===W0}get pending(){return this.status==Jm}get disabled(){return this.status===Ly}get enabled(){return this.status!==Ly}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(LI(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(LI(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(NI(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(NI(t,this._rawAsyncValidators))}hasValidator(t){return G0(this._rawValidators,t)}hasAsyncValidator(t){return G0(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Jm,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Ly,this.errors=null,this._forEachChild(i=>{i.disable({...t,onlySelf:!0})}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Oy,this._forEachChild(i=>{i.enable({...t,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors({...t,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Oy||this.status===Jm)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ly:Oy}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Jm,this._hasOwnPendingAsyncValidator=!0;const e=SI(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){let e=t;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,o)=>i&&i._find(o),this)}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new on,this.statusChanges=new on}_calculateStatus(){return this._allControlsDisabled()?Ly:this.errors?W0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Jm)?Jm:this._anyControlsHaveStatus(W0)?W0:Oy}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Z0(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=function a5(n){return Array.isArray(n)?zC(n):n||null}(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=function l5(n){return Array.isArray(n)?VC(n):n||null}(this._rawAsyncValidators)}}class YC extends $I{constructor(t,e,i){super(WC(e),ZC(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){(function jI(n,t,e){n._forEachChild((i,o)=>{if(void 0===e[o])throw new nt(1002,qC?function s5(n,t){return`Must supply a value for form control ${VI(n,t)}`}(t,o):"")})})(this,!0,t),Object.keys(t).forEach(i=>{(function UI(n,t,e){const i=n.controls;if(!(t?Object.keys(i):i).length)throw new nt(1e3,qC?function r5(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(t):"");if(!i[e])throw new nt(1001,qC?function o5(n,t){return`Cannot find form control ${VI(n,t)}`}(t,e):"")})(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{const o=this.controls[i];o&&o.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,o)=>{i.reset(t[o],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,o)=>((i.enabled||this.disabled)&&(e[o]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((o,c)=>{i=e(i,o,c)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}}const df=new wt("CallSetDisabledState",{providedIn:"root",factory:()=>Ny}),Ny="always";function By(n,t,e=Ny){XC(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||"always"===e)&&t.valueAccessor.setDisabledState?.(n.disabled),function d5(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&HI(n,t)})}(n,t),function p5(n,t){const e=(i,o)=>{t.valueAccessor.writeValue(i),o&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function h5(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&HI(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function u5(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function X0(n,t,e=!0){const i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),Q0(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function K0(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function XC(n,t){const e=FI(n);null!==t.validator?n.setValidators(RI(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=OI(n);null!==t.asyncValidator?n.setAsyncValidators(RI(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const o=()=>n.updateValueAndValidity();K0(t._rawValidators,o),K0(t._rawAsyncValidators,o)}function Q0(n,t){let e=!1;if(null!==n){if(null!==t.validator){const o=FI(n);if(Array.isArray(o)&&o.length>0){const c=o.filter(f=>f!==t.validator);c.length!==o.length&&(e=!0,n.setValidators(c))}}if(null!==t.asyncValidator){const o=OI(n);if(Array.isArray(o)&&o.length>0){const c=o.filter(f=>f!==t.asyncValidator);c.length!==o.length&&(e=!0,n.setAsyncValidators(c))}}}const i=()=>{};return K0(t._rawValidators,i),K0(t._rawAsyncValidators,i),e}function HI(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function GI(n,t){XC(n,t)}function qI(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const y5={provide:fa,useExisting:ci(()=>hf)},zy=(()=>Promise.resolve())();let hf=(()=>{class n extends fa{constructor(e,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._directives=new Set,this.ngSubmit=new on,this.form=new YC({},zC(e),VC(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){zy.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),By(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){zy.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){zy.then(()=>{const i=this._findContainer(e.path),o=new YC({});GI(o,e),i.registerControl(e.name,o),o.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){zy.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){zy.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,qI(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(ve(ks,10),ve(Zh,10),ve(df,8))},n.\u0275dir=Vt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&mn("submit",function(c){return i.onSubmit(c)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ki([y5]),Zn]}),n})();function WI(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}function ZI(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const YI=class extends $I{constructor(t=null,e,i){super(WC(e),ZC(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Z0(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=ZI(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){WI(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){WI(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){ZI(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}},x5={provide:Xu,useExisting:ci(()=>J0)},QI=(()=>Promise.resolve())();let J0=(()=>{class n extends Xu{constructor(e,i,o,c,f,v){super(),this._changeDetectorRef=f,this.callSetDisabledState=v,this.control=new YI,this._registered=!1,this.update=new on,this._parent=e,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=function JC(n,t){if(!t)return null;let e,i,o;return Array.isArray(t),t.forEach(c=>{c.constructor===Fy?e=c:function g5(n){return Object.getPrototypeOf(n.constructor)===uf}(c)?i=c:o=c}),o||i||e||null}(0,c)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function QC(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){By(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){QI.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,o=0!==i&&Vm(i);QI.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Y0(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(ve(fa,9),ve(ks,10),ve(Zh,10),ve(fu,10),ve(pa,8),ve(df,8))},n.\u0275dir=Vt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ki([x5]),Zn,tr]}),n})(),eE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),e2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const tE=new wt("NgModelWithFormControlWarning"),S5={provide:fa,useExisting:ci(()=>Vy)};let Vy=(()=>{class n extends fa{constructor(e,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new on,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Q0(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){const i=this.form.get(e.path);return By(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){X0(e.control||null,e,!1),function _5(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this.submitted=!0,qI(this.form,this.directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_updateDomValue(){this.directives.forEach(e=>{const i=e.control,o=this.form.get(e.path);i!==o&&(X0(i||null,e),(n=>n instanceof YI)(o)&&(By(o,e,this.callSetDisabledState),e.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){const i=this.form.get(e.path);GI(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){const i=this.form.get(e.path);i&&function f5(n,t){return Q0(n,t)}(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){XC(this.form,this),this._oldForm&&Q0(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(e){return new(e||n)(ve(ks,10),ve(Zh,10),ve(df,8))},n.\u0275dir=Vt({type:n,selectors:[["","formGroup",""]],hostBindings:function(e,i){1&e&&mn("submit",function(c){return i.onSubmit(c)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ki([S5]),Zn,tr]}),n})(),y2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[e2]}),n})(),q5=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:df,useValue:e.callSetDisabledState??Ny}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[y2]}),n})(),W5=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:tE,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:df,useValue:e.callSetDisabledState??Ny}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[y2]}),n})(),Z5=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-home"]],decls:81,vars:0,consts:[["id","home",1,"home"],[1,"swiper","home-slider"],[1,"swiper-wrapper"],[1,"box","swiper-slide"],["src","../assets/images/home-img-1.jpg","alt",""],[1,"flex"],["src","../assets/images/home-img-2.jpg","alt",""],["src","../assets/images/home-img-3.jpg","alt",""],["id","contact",1,"contact"],[1,"row"],["action","","method","post"],["type","text","name","name","required","","maxlength","50","placeholder","Ingresa tu nombre",1,"box"],["type","email","name","email","required","","maxlength","50","placeholder","ingresa tu email",1,"box"],["type","number","name","number","required","","maxlength","10","min","0","max","0000000000","placeholder","enter your number",1,"box"],["name","msg","required","","maxlength","1000","placeholder","escribenos","cols","30","rows","10",1,"box"],["type","submit","value","send message","name","send",1,"btn"],[1,"faq"],[1,"title"],[1,"box","active"],[1,"box"],[1,"footer"],[1,"box-container"],["href",""],[1,"fas","fa-phone"],["href","mailto:axolotl@paradise.com"],[1,"fas","fa-envelope"],["href","#"],[1,"fab","fa-facebook-f"],[1,"fab","fa-twitter"],[1,"fab","fa-instagram"],[1,"fab","fa-linkedin"]],template:function(e,i){1&e&&(pe(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),It(4,"img",4),pe(5,"div",5)(6,"h3"),Qe(7,"Habitaciones de lujo"),xe()()(),pe(8,"div",3),It(9,"img",6),pe(10,"div",5)(11,"h3"),Qe(12,"Entretenimiento"),xe()()(),pe(13,"div",3),It(14,"img",7),pe(15,"div",5)(16,"h3"),Qe(17,"Lujosas instalaciones"),xe()()()()()(),pe(18,"section",8)(19,"div",9)(20,"form",10)(21,"h3"),Qe(22,"Contactanos"),xe(),It(23,"input",11)(24,"input",12)(25,"input",13)(26,"textarea",14)(27,"input",15),xe(),pe(28,"div",16)(29,"h3",17),Qe(30,"Preguntas Frecuentes"),xe(),pe(31,"div",18)(32,"h3"),Qe(33,"Como cancelar?"),xe(),pe(34,"p"),Qe(35,"Lamentablemente las cancelaciones no pueden hacerce en linea, por lo que es necesario contactarnos por telefono."),xe()(),pe(36,"div",19)(37,"h3"),Qe(38,"Como ver disponibilidad?"),xe(),pe(39,"p"),Qe(40,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa ipsam neque quaerat mollitia ratione? Soluta!"),xe()(),pe(41,"div",19)(42,"h3"),Qe(43,"Cuales metodos de pago son aceptados?"),xe(),pe(44,"p"),Qe(45,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa ipsam neque quaerat mollitia ratione? Soluta!"),xe()(),pe(46,"div",19)(47,"h3"),Qe(48,"how to claim coupons codes?"),xe(),pe(49,"p"),Qe(50,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa ipsam neque quaerat mollitia ratione? Soluta!"),xe()(),pe(51,"div",19)(52,"h3"),Qe(53,"Cuales son los requisitos para una reservacion?"),xe(),pe(54,"p"),Qe(55,"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Ipsa ipsam neque quaerat mollitia ratione? Soluta!"),xe()()()()(),pe(56,"section",20)(57,"div",21)(58,"div",19)(59,"a",22),It(60,"i",23),Qe(61," +123-456-7890"),xe(),pe(62,"a",22),It(63,"i",23),Qe(64," +111-222-3333"),xe(),pe(65,"a",24),It(66,"i",25),Qe(67," Axolotl@paradise.com"),xe()(),pe(68,"div",19)(69,"a",26),Qe(70,"facebook "),It(71,"i",27),xe(),pe(72,"a",26),Qe(73,"twitter "),It(74,"i",28),xe(),pe(75,"a",26),Qe(76,"instagram "),It(77,"i",29),xe(),pe(78,"a",26),Qe(79,"linkedin "),It(80,"i",30),xe()()()())},dependencies:[eE,$C,hf],encapsulation:2}),n})(),Y5=(()=>{class n{ngOnInit(){v0().accessToken=eA_mapbox_accessToken,new(v0().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-74.5,40],zoom:9})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-about"]],decls:89,vars:0,consts:[[2,"margin","0","padding","0","font-family","Arial, sans-serif","background-color","#FFF5E4"],[1,"services"],[1,"box-container"],[1,"box"],["src","../../assets/images/icon-1.png","alt",""],["src","../../assets/images/icon-2.png","alt",""],["src","../../assets/images/icon-3.png","alt",""],["src","../../assets/images/icon-4.png","alt",""],["src","../../assets/images/icon-5.png","alt",""],["src","../../assets/images/icon-6.png","alt",""],[2,"text-align","center","color","#850E35"],[1,"container"],[1,"imagen-container"],["src","../../assets/images/Axolotl.jpeg","alt","Logo UAA",1,"imagen"],[1,"persona"],[1,"imagen",2,"background-image","url('../../assets/images/Carlos.jpeg')","height","300px"],[1,"info"],[1,"nombre"],[1,"apellido"],[1,"grado"],[1,"grupo"],[1,"carrera"],[1,"imagen",2,"background-image","url('../../assets/images/Daniel.jpeg')","height","300px"],[1,"imagen",2,"background-image","url('../../assets/images/Leo.jpeg')","height","300px"],["id","map",2,"width","400px","height","300px","margin","auto"]],template:function(e,i){1&e&&(pe(0,"body",0)(1,"section",1)(2,"div",2)(3,"div",3),It(4,"img",4),pe(5,"h3"),Qe(6,"Buffet y Barra libre"),xe(),pe(7,"p"),Qe(8,"Todas las noches son de barra libre y buffet"),xe()(),pe(9,"div",3),It(10,"img",5),pe(11,"h3"),Qe(12,"Experiencia privada"),xe(),pe(13,"p"),Qe(14,"Nuestro staff puede llevarte comida a donde lo solicites"),xe()(),pe(15,"div",3),It(16,"img",6),pe(17,"h3"),Qe(18,"Vista a la playa"),xe(),pe(19,"p"),Qe(20,"Nuestra posicion privilegiada porporciona las mejores vistas"),xe()(),pe(21,"div",3),It(22,"img",7),pe(23,"h3"),Qe(24,"Fiesta tematica"),xe(),pe(25,"p"),Qe(26,"Reserva para hacer tus eventos aun mas especiales "),xe()(),pe(27,"div",3),It(28,"img",8),pe(29,"h3"),Qe(30,"Alberca"),xe(),pe(31,"p"),Qe(32,"Actividades y alberca disponile las 24 hrs"),xe()(),pe(33,"div",3),It(34,"img",9),pe(35,"h3"),Qe(36,"Resort privado"),xe(),pe(37,"p"),Qe(38,"COontamos con zona exclusiva en la playa"),xe()()()(),pe(39,"h1",10),Qe(40,"En Axolotl Palace, nuestra prioridad eres t\xfa: Vive como la realeza"),xe(),pe(41,"div",11)(42,"div",12),It(43,"img",13),xe()(),pe(44,"h2",10),Qe(45,"PROYECTO UNIVERITARIO DE LA UAA"),xe(),pe(46,"div",11)(47,"div",14),It(48,"div",15),pe(49,"div",16)(50,"div",17),Qe(51,"Carlos Alberto"),xe(),pe(52,"div",18),Qe(53,"Zaragoza Cano"),xe(),pe(54,"div",19),Qe(55,"6to"),xe(),pe(56,"div",20),Qe(57,"C"),xe(),pe(58,"div",21),Qe(59,"Ingenier\xeda en Sistemas"),xe()()(),pe(60,"div",14),It(61,"div",22),pe(62,"div",16)(63,"div",17),Qe(64,"Carlos Daniel"),xe(),pe(65,"div",18),Qe(66,"De Lira Salas"),xe(),pe(67,"div",19),Qe(68,"6to"),xe(),pe(69,"div",20),Qe(70,"C"),xe(),pe(71,"div",21),Qe(72,"Ingenier\xeda en Sistemas"),xe()()(),pe(73,"div",14),It(74,"div",23),pe(75,"div",16)(76,"div",17),Qe(77,"Leonardo"),xe(),pe(78,"div",18),Qe(79,"Pedroza Gonzalez"),xe(),pe(80,"div",19),Qe(81,"6to"),xe(),pe(82,"div",20),Qe(83,"C"),xe(),pe(84,"div",21),Qe(85,"Ingenier\xeda en Sistemas"),xe()()()(),pe(86,"h2",10),Qe(87,"Nos ubicamos en:"),xe(),It(88,"div",24),xe())},styles:[".container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;padding:30px}.imagen-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.persona[_ngcontent-%COMP%]{flex-basis:calc(33.33% - 20px);margin:10px;border-radius:5px;background-size:cover;background-position:center;color:#000}.persona[_ngcontent-%COMP%]{background-color:#ffc4c4}.imagen[_ngcontent-%COMP%]{width:100%;height:200px;border-top-left-radius:5px;border-top-right-radius:5px;background-size:cover;background-position:center;align-content:center}.info[_ngcontent-%COMP%]{padding:10px;text-align:center}.nombre[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-top:10px;margin-bottom:5px}.apellido[_ngcontent-%COMP%]{font-size:16px;margin-top:5px;margin-bottom:5px}.grado[_ngcontent-%COMP%], .grupo[_ngcontent-%COMP%], .carrera[_ngcontent-%COMP%]{font-size:14px;margin-top:5px;margin-bottom:5px}"]}),n})();var X5=pi(226),v2=pi.n(X5);let lE,aE=(()=>{class n{constructor(){}guardarRegistro(e){let i=JSON.parse(localStorage.getItem("registros")||"[]");i.push(e),localStorage.setItem("registros",JSON.stringify(i))}obtenerRegistros(){return JSON.parse(localStorage.getItem("registros")||"[]")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();try{lE=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lE=!1}let eg,Wo=(()=>{class n{constructor(e){this._platformId=e,this.isBrowser=this._platformId?K1(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!lE)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(e){return new(e||n)(We(ay))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const b2=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function x2(){if(eg)return eg;if("object"!=typeof document||!document)return eg=new Set(b2),eg;let n=document.createElement("input");return eg=new Set(b2.filter(t=>(n.setAttribute("type",t),n.type===t))),eg}let Uy,ex,ff,cE;function jy(n){return function K5(){if(null==Uy&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Uy=!0}))}finally{Uy=Uy||!1}return Uy}()?n:!!n.capture}function w2(){if(null==ff){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return ff=!1,ff;if("scrollBehavior"in document.documentElement.style)ff=!0;else{const n=Element.prototype.scrollTo;ff=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return ff}function $y(){if("object"!=typeof document||!document)return 0;if(null==ex){const n=document.createElement("div"),t=n.style;n.dir="rtl",t.width="1px",t.overflow="auto",t.visibility="hidden",t.pointerEvents="none",t.position="absolute";const e=document.createElement("div"),i=e.style;i.width="2px",i.height="1px",n.appendChild(e),document.body.appendChild(n),ex=0,0===n.scrollLeft&&(n.scrollLeft=1,ex=0===n.scrollLeft?1:2),n.remove()}return ex}function C2(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const t=n.shadowRoot.activeElement;if(t===n)break;n=t}return n}function Yh(n){return n.composedPath?n.composedPath()[0]:n.target}function uE(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function mu(n,...t){return t.length?t.some(e=>n[e]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}class c4 extends Ie{constructor(t,e){super()}schedule(t,e=0){return this}}const ix={setInterval(n,t,...e){const{delegate:i}=ix;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=ix;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};class hE extends c4{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const o=this.id,c=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(c,o,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(c,this.id,e),this}requestAsyncId(t,e,i=0){return ix.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&ix.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let o,i=!1;try{this.work(t)}catch(c){i=!0,o=c||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,h(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}const D2={now:()=>(D2.delegate||Date).now(),delegate:void 0};class qy{constructor(t,e=qy.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}qy.now=D2.now;class pE extends qy{constructor(t,e=qy.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const rx=new pE(hE),u4=rx;function fE(n,t=rx){return Xn((e,i)=>{let o=null,c=null,f=null;const v=()=>{if(o){o.unsubscribe(),o=null;const S=c;c=null,i.next(S)}};function C(){const S=f+n,R=t.now();if(R<S)return o=this.schedule(void 0,S-R),void i.add(o);v()}e.subscribe(Rn(i,S=>{c=S,f=t.now(),o||(o=t.schedule(C,n),i.add(o))},()=>{v(),i.complete()},void 0,()=>{c=o=null}))})}function M2(n){return oo((t,e)=>n<=e)}function S2(n,t=wr){return n=n??d4,Xn((e,i)=>{let o,c=!0;e.subscribe(Rn(i,f=>{const v=t(f);(c||!n(o,v))&&(c=!1,o=v,i.next(f))}))})}function d4(n,t){return n===t}function il(n){return Xn((t,e)=>{H(n).subscribe(Rn(e,()=>e.complete(),un)),!e.closed&&t.subscribe(e)})}function xr(n){return null!=n&&"false"!=`${n}`}function mE(n,t=0){return function h4(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):t}function ox(n){return Array.isArray(n)?n:[n]}function Po(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Nd(n){return n instanceof _i?n.nativeElement:n}let T2=(()=>{class n{create(e){return typeof MutationObserver>"u"?null:new MutationObserver(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),f4=(()=>{class n{constructor(e){this._mutationObserverFactory=e,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((e,i)=>this._cleanupObserver(i))}observe(e){const i=Nd(e);return new xn(o=>{const f=this._observeElement(i).subscribe(o);return()=>{f.unsubscribe(),this._unobserveElement(i)}})}_observeElement(e){if(this._observedElements.has(e))this._observedElements.get(e).count++;else{const i=new yn,o=this._mutationObserverFactory.create(c=>i.next(c));o&&o.observe(e,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(e,{observer:o,stream:i,count:1})}return this._observedElements.get(e).stream}_unobserveElement(e){this._observedElements.has(e)&&(this._observedElements.get(e).count--,this._observedElements.get(e).count||this._cleanupObserver(e))}_cleanupObserver(e){if(this._observedElements.has(e)){const{observer:i,stream:o}=this._observedElements.get(e);i&&i.disconnect(),o.complete(),this._observedElements.delete(e)}}}return n.\u0275fac=function(e){return new(e||n)(We(T2))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),m4=(()=>{class n{get disabled(){return this._disabled}set disabled(e){this._disabled=xr(e),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(e){this._debounce=mE(e),this._subscribe()}constructor(e,i,o){this._contentObserver=e,this._elementRef=i,this._ngZone=o,this.event=new on,this._disabled=!1,this._currentSubscription=null}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const e=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?e.pipe(fE(this.debounce)):e).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(ve(f4),ve(_i),ve(Pn))},n.\u0275dir=Vt({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),A2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[T2]}),n})();const I2=new Set;let ig,g4=(()=>{class n{constructor(e){this._platform=e,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):y4}matchMedia(e){return(this._platform.WEBKIT||this._platform.BLINK)&&function _4(n){if(!I2.has(n))try{ig||(ig=document.createElement("style"),ig.setAttribute("type","text/css"),document.head.appendChild(ig)),ig.sheet&&(ig.sheet.insertRule(`@media ${n} {body{ }}`,0),I2.add(n))}catch(t){console.error(t)}}(e),this._matchMedia(e)}}return n.\u0275fac=function(e){return new(e||n)(We(Wo))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function y4(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let v4=(()=>{class n{constructor(e,i){this._mediaMatcher=e,this._zone=i,this._queries=new Map,this._destroySubject=new yn}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(e){return k2(ox(e)).some(o=>this._registerQuery(o).mql.matches)}observe(e){let c=lC(k2(ox(e)).map(f=>this._registerQuery(f).observable));return c=$m(c.pipe(ro(1)),c.pipe(M2(1),fE(0))),c.pipe(nn(f=>{const v={matches:!1,breakpoints:{}};return f.forEach(({matches:C,query:S})=>{v.matches=v.matches||C,v.breakpoints[S]=C}),v}))}_registerQuery(e){if(this._queries.has(e))return this._queries.get(e);const i=this._mediaMatcher.matchMedia(e),c={observable:new xn(f=>{const v=C=>this._zone.run(()=>f.next(C));return i.addListener(v),()=>{i.removeListener(v)}}).pipe(Uh(i),nn(({matches:f})=>({query:e,matches:f})),il(this._destroySubject)),mql:i};return this._queries.set(e,c),c}}return n.\u0275fac=function(e){return new(e||n)(We(g4),We(Pn))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function k2(n){return n.map(t=>t.split(",")).reduce((t,e)=>t.concat(e)).map(t=>t.trim())}class w4{constructor(t){this._items=t,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new yn,this._typeaheadSubscription=Ie.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._pageUpAndDown={enabled:!1,delta:10},this._skipPredicateFn=e=>e.disabled,this._pressedLetters=[],this.tabOut=new yn,this.change=new yn,t instanceof iy&&(this._itemChangesSubscription=t.changes.subscribe(e=>{if(this._activeItem){const o=e.toArray().indexOf(this._activeItem);o>-1&&o!==this._activeItemIndex&&(this._activeItemIndex=o)}}))}skipPredicate(t){return this._skipPredicateFn=t,this}withWrap(t=!0){return this._wrap=t,this}withVerticalOrientation(t=!0){return this._vertical=t,this}withHorizontalOrientation(t){return this._horizontal=t,this}withAllowedModifierKeys(t){return this._allowedModifierKeys=t,this}withTypeAhead(t=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(yo(e=>this._pressedLetters.push(e)),fE(t),oo(()=>this._pressedLetters.length>0),nn(()=>this._pressedLetters.join(""))).subscribe(e=>{const i=this._getItemsArray();for(let o=1;o<i.length+1;o++){const c=(this._activeItemIndex+o)%i.length,f=i[c];if(!this._skipPredicateFn(f)&&0===f.getLabel().toUpperCase().trim().indexOf(e)){this.setActiveItem(c);break}}this._pressedLetters=[]}),this}cancelTypeahead(){return this._pressedLetters=[],this}withHomeAndEnd(t=!0){return this._homeAndEnd=t,this}withPageUpDown(t=!0,e=10){return this._pageUpAndDown={enabled:t,delta:e},this}setActiveItem(t){const e=this._activeItem;this.updateActiveItem(t),this._activeItem!==e&&this.change.next(this._activeItemIndex)}onKeydown(t){const e=t.keyCode,o=["altKey","ctrlKey","metaKey","shiftKey"].every(c=>!t[c]||this._allowedModifierKeys.indexOf(c)>-1);switch(e){case 9:return void this.tabOut.next();case 40:if(this._vertical&&o){this.setNextItemActive();break}return;case 38:if(this._vertical&&o){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&o){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&o){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&o){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&o){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&o){const c=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(c>0?c:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&o){const c=this._activeItemIndex+this._pageUpAndDown.delta,f=this._getItemsArray().length;this._setActiveItemByIndex(c<f?c:f-1,-1);break}return;default:return void((o||mu(t,"shiftKey"))&&(t.key&&1===t.key.length?this._letterKeyStream.next(t.key.toLocaleUpperCase()):(e>=65&&e<=90||e>=48&&e<=57)&&this._letterKeyStream.next(String.fromCharCode(e))))}this._pressedLetters=[],t.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(t){const e=this._getItemsArray(),i="number"==typeof t?t:e.indexOf(t);this._activeItem=e[i]??null,this._activeItemIndex=i}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._letterKeyStream.complete(),this.tabOut.complete(),this.change.complete(),this._pressedLetters=[]}_setActiveItemByDelta(t){this._wrap?this._setActiveInWrapMode(t):this._setActiveInDefaultMode(t)}_setActiveInWrapMode(t){const e=this._getItemsArray();for(let i=1;i<=e.length;i++){const o=(this._activeItemIndex+t*i+e.length)%e.length;if(!this._skipPredicateFn(e[o]))return void this.setActiveItem(o)}}_setActiveInDefaultMode(t){this._setActiveItemByIndex(this._activeItemIndex+t,t)}_setActiveItemByIndex(t,e){const i=this._getItemsArray();if(i[t]){for(;this._skipPredicateFn(i[t]);)if(!i[t+=e])return;this.setActiveItem(t)}}_getItemsArray(){return this._items instanceof iy?this._items.toArray():this._items}}class C4 extends w4{setActiveItem(t){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(t),this.activeItem&&this.activeItem.setActiveStyles()}}let E4=(()=>{class n{constructor(e){this._platform=e}isDisabled(e){return e.hasAttribute("disabled")}isVisible(e){return function M4(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(e)&&"visible"===getComputedStyle(e).visibility}isTabbable(e){if(!this._platform.isBrowser)return!1;const i=function D4(n){try{return n.frameElement}catch{return null}}(function F4(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(e));if(i&&(-1===O2(i)||!this.isVisible(i)))return!1;let o=e.nodeName.toLowerCase(),c=O2(e);return e.hasAttribute("contenteditable")?-1!==c:!("iframe"===o||"object"===o||this._platform.WEBKIT&&this._platform.IOS&&!function P4(n){let t=n.nodeName.toLowerCase(),e="input"===t&&n.type;return"text"===e||"password"===e||"select"===t||"textarea"===t}(e))&&("audio"===o?!!e.hasAttribute("controls")&&-1!==c:"video"===o?-1!==c&&(null!==c||this._platform.FIREFOX||e.hasAttribute("controls")):e.tabIndex>=0)}isFocusable(e,i){return function R4(n){return!function T4(n){return function I4(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function S4(n){let t=n.nodeName.toLowerCase();return"input"===t||"select"===t||"button"===t||"textarea"===t}(n)||function A4(n){return function k4(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||F2(n))}(e)&&!this.isDisabled(e)&&(i?.ignoreVisibility||this.isVisible(e))}}return n.\u0275fac=function(e){return new(e||n)(We(Wo))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function F2(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let t=n.getAttribute("tabindex");return!(!t||isNaN(parseInt(t,10)))}function O2(n){if(!F2(n))return null;const t=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(t)?-1:t}class O4{get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}constructor(t,e,i,o,c=!1){this._element=t,this._checker=e,this._ngZone=i,this._document=o,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,c||this.attachAnchors()}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.remove()),e&&(e.removeEventListener("focus",this.endAnchorListener),e.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusInitialElement(t)))})}focusFirstTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusFirstTabbableElement(t)))})}focusLastTabbableElementWhenReady(t){return new Promise(e=>{this._executeOnStable(()=>e(this.focusLastTabbableElement(t)))})}_getRegionBoundary(t){const e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(t){const e=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(e){if(!this._checker.isFocusable(e)){const i=this._getFirstTabbableElement(e);return i?.focus(t),!!i}return e.focus(t),!0}return this.focusFirstTabbableElement(t)}focusFirstTabbableElement(t){const e=this._getRegionBoundary("start");return e&&e.focus(t),!!e}focusLastTabbableElement(t){const e=this._getRegionBoundary("end");return e&&e.focus(t),!!e}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=0;i<e.length;i++){const o=e[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[i]):null;if(o)return o}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;const e=t.children;for(let i=e.length-1;i>=0;i--){const o=e[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[i]):null;if(o)return o}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.pipe(ro(1)).subscribe(t)}}let L4=(()=>{class n{constructor(e,i,o){this._checker=e,this._ngZone=i,this._document=o}create(e,i=!1){return new O4(e,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(e){return new(e||n)(We(E4),We(Pn),We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),N4=(()=>{class n{get enabled(){return this.focusTrap.enabled}set enabled(e){this.focusTrap.enabled=xr(e)}get autoCapture(){return this._autoCapture}set autoCapture(e){this._autoCapture=xr(e)}constructor(e,i,o){this._elementRef=e,this._focusTrapFactory=i,this._previouslyFocusedElement=null,this.focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement,!0)}ngOnDestroy(){this.focusTrap.destroy(),this._previouslyFocusedElement&&(this._previouslyFocusedElement.focus(),this._previouslyFocusedElement=null)}ngAfterContentInit(){this.focusTrap.attachAnchors(),this.autoCapture&&this._captureFocus()}ngDoCheck(){this.focusTrap.hasAttached()||this.focusTrap.attachAnchors()}ngOnChanges(e){const i=e.autoCapture;i&&!i.firstChange&&this.autoCapture&&this.focusTrap.hasAttached()&&this._captureFocus()}_captureFocus(){this._previouslyFocusedElement=C2(),this.focusTrap.focusInitialElementWhenReady()}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(L4),ve(ai))},n.\u0275dir=Vt({type:n,selectors:[["","cdkTrapFocus",""]],inputs:{enabled:["cdkTrapFocus","enabled"],autoCapture:["cdkTrapFocusAutoCapture","autoCapture"]},exportAs:["cdkTrapFocus"],features:[tr]}),n})();function L2(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function N2(n){const t=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!t||-1!==t.identifier||null!=t.radiusX&&1!==t.radiusX||null!=t.radiusY&&1!==t.radiusY)}const B4=new wt("cdk-input-modality-detector-options"),z4={ignoreKeys:[18,17,224,91,16]},rg=jy({passive:!0,capture:!0});let V4=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(e,i,o,c){this._platform=e,this._mostRecentTarget=null,this._modality=new fc(null),this._lastTouchMs=0,this._onKeydown=f=>{this._options?.ignoreKeys?.some(v=>v===f.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Yh(f))},this._onMousedown=f=>{Date.now()-this._lastTouchMs<650||(this._modality.next(L2(f)?"keyboard":"mouse"),this._mostRecentTarget=Yh(f))},this._onTouchstart=f=>{N2(f)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Yh(f))},this._options={...z4,...c},this.modalityDetected=this._modality.pipe(M2(1)),this.modalityChanged=this.modalityDetected.pipe(S2()),e.isBrowser&&i.runOutsideAngular(()=>{o.addEventListener("keydown",this._onKeydown,rg),o.addEventListener("mousedown",this._onMousedown,rg),o.addEventListener("touchstart",this._onTouchstart,rg)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,rg),document.removeEventListener("mousedown",this._onMousedown,rg),document.removeEventListener("touchstart",this._onTouchstart,rg))}}return n.\u0275fac=function(e){return new(e||n)(We(Wo),We(Pn),We(ai),We(B4,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const U4=new wt("liveAnnouncerElement",{providedIn:"root",factory:function j4(){return null}}),$4=new wt("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let H4=0,G4=(()=>{class n{constructor(e,i,o,c){this._ngZone=i,this._defaultOptions=c,this._document=o,this._liveElement=e||this._createLiveElement()}announce(e,...i){const o=this._defaultOptions;let c,f;return 1===i.length&&"number"==typeof i[0]?f=i[0]:[c,f]=i,this.clear(),clearTimeout(this._previousTimeout),c||(c=o&&o.politeness?o.politeness:"polite"),null==f&&o&&(f=o.duration),this._liveElement.setAttribute("aria-live",c),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(v=>this._currentResolve=v)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=e,"number"==typeof f&&(this._previousTimeout=setTimeout(()=>this.clear(),f)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const e="cdk-live-announcer-element",i=this._document.getElementsByClassName(e),o=this._document.createElement("div");for(let c=0;c<i.length;c++)i[c].remove();return o.classList.add(e),o.classList.add("cdk-visually-hidden"),o.setAttribute("aria-atomic","true"),o.setAttribute("aria-live","polite"),o.id="cdk-live-announcer-"+H4++,this._document.body.appendChild(o),o}_exposeAnnouncerToModals(e){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let o=0;o<i.length;o++){const c=i[o],f=c.getAttribute("aria-owns");f?-1===f.indexOf(e)&&c.setAttribute("aria-owns",f+" "+e):c.setAttribute("aria-owns",e)}}}return n.\u0275fac=function(e){return new(e||n)(We(U4,8),We(Pn),We(ai),We($4,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const q4=new wt("cdk-focus-monitor-default-options"),sx=jy({passive:!0,capture:!0});let z2=(()=>{class n{constructor(e,i,o,c,f){this._ngZone=e,this._platform=i,this._inputModalityDetector=o,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new yn,this._rootNodeFocusAndBlurListener=v=>{for(let S=Yh(v);S;S=S.parentElement)"focus"===v.type?this._onFocus(v,S):this._onBlur(v,S)},this._document=c,this._detectionMode=f?.detectionMode||0}monitor(e,i=!1){const o=Nd(e);if(!this._platform.isBrowser||1!==o.nodeType)return sn(null);const c=function J5(n){if(function Q5(){if(null==cE){const n=typeof document<"u"?document.head:null;cE=!(!n||!n.createShadowRoot&&!n.attachShadow)}return cE}()){const t=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}(o)||this._getDocument(),f=this._elementInfo.get(o);if(f)return i&&(f.checkChildren=!0),f.subject;const v={checkChildren:i,subject:new yn,rootNode:c};return this._elementInfo.set(o,v),this._registerGlobalListeners(v),v.subject}stopMonitoring(e){const i=Nd(e),o=this._elementInfo.get(i);o&&(o.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(o))}focusVia(e,i,o){const c=Nd(e);c===this._getDocument().activeElement?this._getClosestElementsInfo(c).forEach(([v,C])=>this._originChanged(v,i,C)):(this._setOrigin(i),"function"==typeof c.focus&&c.focus(o))}ngOnDestroy(){this._elementInfo.forEach((e,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(e){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(e)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:e&&this._isLastInteractionFromInputLabel(e)?"mouse":"program"}_shouldBeAttributedToTouch(e){return 1===this._detectionMode||!!e?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(e,i){e.classList.toggle("cdk-focused",!!i),e.classList.toggle("cdk-touch-focused","touch"===i),e.classList.toggle("cdk-keyboard-focused","keyboard"===i),e.classList.toggle("cdk-mouse-focused","mouse"===i),e.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(e,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=e,this._originFromTouchInteraction="touch"===e&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(e,i){const o=this._elementInfo.get(i),c=Yh(e);!o||!o.checkChildren&&i!==c||this._originChanged(i,this._getFocusOrigin(c),o)}_onBlur(e,i){const o=this._elementInfo.get(i);!o||o.checkChildren&&e.relatedTarget instanceof Node&&i.contains(e.relatedTarget)||(this._setClasses(i),this._emitOrigin(o,null))}_emitOrigin(e,i){e.subject.observers.length&&this._ngZone.run(()=>e.subject.next(i))}_registerGlobalListeners(e){if(!this._platform.isBrowser)return;const i=e.rootNode,o=this._rootNodeFocusListenerCount.get(i)||0;o||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,sx),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,sx)}),this._rootNodeFocusListenerCount.set(i,o+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(il(this._stopInputModalityDetector)).subscribe(c=>{this._setOrigin(c,!0)}))}_removeGlobalListeners(e){const i=e.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const o=this._rootNodeFocusListenerCount.get(i);o>1?this._rootNodeFocusListenerCount.set(i,o-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,sx),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,sx),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(e,i,o){this._setClasses(e,i),this._emitOrigin(o,i),this._lastFocusOrigin=i}_getClosestElementsInfo(e){const i=[];return this._elementInfo.forEach((o,c)=>{(c===e||o.checkChildren&&c.contains(e))&&i.push([c,o])}),i}_isLastInteractionFromInputLabel(e){const{_mostRecentTarget:i,mostRecentModality:o}=this._inputModalityDetector;if("mouse"!==o||!i||i===e||"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||e.disabled)return!1;const c=e.labels;if(c)for(let f=0;f<c.length;f++)if(c[f].contains(i))return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(We(Pn),We(Wo),We(V4),We(ai,8),We(q4,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),W4=(()=>{class n{constructor(e,i){this._elementRef=e,this._focusMonitor=i,this._focusOrigin=null,this.cdkFocusChange=new on}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){const e=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(e,1===e.nodeType&&e.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(i=>{this._focusOrigin=i,this.cdkFocusChange.emit(i)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(z2))},n.\u0275dir=Vt({type:n,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]}),n})();const V2="cdk-high-contrast-black-on-white",U2="cdk-high-contrast-white-on-black",gE="cdk-high-contrast-active";let j2=(()=>{class n{constructor(e,i){this._platform=e,this._document=i,this._breakpointSubscription=bn(v4).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const e=this._document.createElement("div");e.style.backgroundColor="rgb(1,2,3)",e.style.position="absolute",this._document.body.appendChild(e);const i=this._document.defaultView||window,o=i&&i.getComputedStyle?i.getComputedStyle(e):null,c=(o&&o.backgroundColor||"").replace(/ /g,"");switch(e.remove(),c){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const e=this._document.body.classList;e.remove(gE,V2,U2),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?e.add(gE,V2):2===i&&e.add(gE,U2)}}}return n.\u0275fac=function(e){return new(e||n)(We(Wo),We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Z4=(()=>{class n{constructor(e){e._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(e){return new(e||n)(We(j2))},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[A2]}),n})();const Y4=["addListener","removeListener"],X4=["addEventListener","removeEventListener"],K4=["on","off"];function og(n,t,e,i){if(Nt(e)&&(i=e,e=void 0),i)return og(n,t,e).pipe(aC(i));const[o,c]=function eU(n){return Nt(n.addEventListener)&&Nt(n.removeEventListener)}(n)?X4.map(f=>v=>n[f](t,v,e)):function Q4(n){return Nt(n.addListener)&&Nt(n.removeListener)}(n)?Y4.map($2(n,t)):function J4(n){return Nt(n.on)&&Nt(n.off)}(n)?K4.map($2(n,t)):[];if(!o&&ba(n))return Je(f=>og(f,t,e))(H(n));if(!o)throw new TypeError("Invalid event target");return new xn(f=>{const v=(...C)=>f.next(1<C.length?C:C[0]);return o(v),()=>c(v)})}function $2(n,t){return e=>i=>n[e](t,i)}const Wy={schedule(n){let t=requestAnimationFrame,e=cancelAnimationFrame;const{delegate:i}=Wy;i&&(t=i.requestAnimationFrame,e=i.cancelAnimationFrame);const o=t(c=>{e=void 0,n(c)});return new Ie(()=>e?.(o))},requestAnimationFrame(...n){const{delegate:t}=Wy;return(t?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:t}=Wy;return(t?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},iU=new class nU extends pE{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let o;t=t||i.shift();do{if(o=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,o){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw o}}}(class tU extends hE{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=Wy.requestAnimationFrame(()=>t.flush(void 0))))}recycleAsyncId(t,e,i=0){var o;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:c}=t;null!=e&&(null===(o=c[c.length-1])||void 0===o?void 0:o.id)!==e&&(Wy.cancelAnimationFrame(e),t._scheduled=void 0)}});let _E,rU=1;const ax={};function H2(n){return n in ax&&(delete ax[n],!0)}const oU={setImmediate(n){const t=rU++;return ax[t]=!0,_E||(_E=Promise.resolve()),_E.then(()=>H2(t)&&n()),t},clearImmediate(n){H2(n)}},{setImmediate:sU,clearImmediate:aU}=oU,lx={setImmediate(...n){const{delegate:t}=lx;return(t?.setImmediate||sU)(...n)},clearImmediate(n){const{delegate:t}=lx;return(t?.clearImmediate||aU)(n)},delegate:void 0},uU=new class cU extends pE{flush(t){this._active=!0;const e=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let o;t=t||i.shift();do{if(o=t.execute(t.state,t.delay))break}while((t=i[0])&&t.id===e&&i.shift());if(this._active=!1,o){for(;(t=i[0])&&t.id===e&&i.shift();)t.unsubscribe();throw o}}}(class lU extends hE{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,i=0){return null!==i&&i>0?super.requestAsyncId(t,e,i):(t.actions.push(this),t._scheduled||(t._scheduled=lx.setImmediate(t.flush.bind(t,void 0))))}recycleAsyncId(t,e,i=0){var o;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(t,e,i);const{actions:c}=t;null!=e&&(null===(o=c[c.length-1])||void 0===o?void 0:o.id)!==e&&(lx.clearImmediate(e),t._scheduled===e&&(t._scheduled=void 0))}});function G2(n=0,t,e=u4){let i=-1;return null!=t&&(Mn(t)?e=t:i=t),new xn(o=>{let c=function hU(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;c<0&&(c=0);let f=0;return e.schedule(function(){o.closed||(o.next(f++),0<=i?this.schedule(void 0,i):o.complete())},c)})}function yE(n,t=rx){return function dU(n){return Xn((t,e)=>{let i=!1,o=null,c=null,f=!1;const v=()=>{if(c?.unsubscribe(),c=null,i){i=!1;const S=o;o=null,e.next(S)}f&&e.complete()},C=()=>{c=null,f&&e.complete()};t.subscribe(Rn(e,S=>{i=!0,o=S,c||H(n(S)).subscribe(c=Rn(e,v,C))},()=>{f=!0,(!i||!c||c.closed)&&e.complete()}))})}(()=>G2(n,t))}const pU=new wt("cdk-dir-doc",{providedIn:"root",factory:function fU(){return bn(ai)}}),mU=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let gu=(()=>{class n{constructor(e){this.value="ltr",this.change=new on,e&&(this.value=function gU(n){const t=n?.toLowerCase()||"";return"auto"===t&&typeof navigator<"u"&&navigator?.language?mU.test(navigator.language)?"rtl":"ltr":"rtl"===t?"rtl":"ltr"}((e.body?e.body.dir:null)||(e.documentElement?e.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(e){return new(e||n)(We(pU,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zy=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const _U=["contentWrapper"],yU=["*"],vU=new wt("VIRTUAL_SCROLL_STRATEGY");let cx=(()=>{class n{constructor(e,i,o){this._ngZone=e,this._platform=i,this._scrolled=new yn,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=o}register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){const i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=20){return this._platform.isBrowser?new xn(i=>{this._globalSubscription||this._addGlobalListener();const o=e>0?this._scrolled.pipe(yE(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{o.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):sn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){const o=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(oo(c=>!c||o.indexOf(c)>-1))}getAncestorScrollContainers(e){const i=[];return this.scrollContainers.forEach((o,c)=>{this._scrollableContainsElement(c,e)&&i.push(c)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(e,i){let o=Nd(i),c=e.getElementRef().nativeElement;do{if(o==c)return!0}while(o=o.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>og(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(e){return new(e||n)(We(Pn),We(Wo),We(ai,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),q2=(()=>{class n{constructor(e,i,o,c){this.elementRef=e,this.scrollDispatcher=i,this.ngZone=o,this.dir=c,this._destroyed=new yn,this._elementScrolled=new xn(f=>this.ngZone.runOutsideAngular(()=>og(this.elementRef.nativeElement,"scroll").pipe(il(this._destroyed)).subscribe(f)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){const i=this.elementRef.nativeElement,o=this.dir&&"rtl"==this.dir.value;null==e.left&&(e.left=o?e.end:e.start),null==e.right&&(e.right=o?e.start:e.end),null!=e.bottom&&(e.top=i.scrollHeight-i.clientHeight-e.bottom),o&&0!=$y()?(null!=e.left&&(e.right=i.scrollWidth-i.clientWidth-e.left),2==$y()?e.left=e.right:1==$y()&&(e.left=e.right?-e.right:e.right)):null!=e.right&&(e.left=i.scrollWidth-i.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){const i=this.elementRef.nativeElement;w2()?i.scrollTo(e):(null!=e.top&&(i.scrollTop=e.top),null!=e.left&&(i.scrollLeft=e.left))}measureScrollOffset(e){const i="left",o="right",c=this.elementRef.nativeElement;if("top"==e)return c.scrollTop;if("bottom"==e)return c.scrollHeight-c.clientHeight-c.scrollTop;const f=this.dir&&"rtl"==this.dir.value;return"start"==e?e=f?o:i:"end"==e&&(e=f?i:o),f&&2==$y()?e==i?c.scrollWidth-c.clientWidth-c.scrollLeft:c.scrollLeft:f&&1==$y()?e==i?c.scrollLeft+c.scrollWidth-c.clientWidth:-c.scrollLeft:e==i?c.scrollLeft:c.scrollWidth-c.clientWidth-c.scrollLeft}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(cx),ve(Pn),ve(gu,8))},n.\u0275dir=Vt({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),ux=(()=>{class n{constructor(e,i,o){this._platform=e,this._change=new yn,this._changeListener=c=>{this._change.next(c)},this._document=o,i.runOutsideAngular(()=>{if(e.isBrowser){const c=this._getWindow();c.addEventListener("resize",this._changeListener),c.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const e=this._getWindow();e.removeEventListener("resize",this._changeListener),e.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){const e=this.getViewportScrollPosition(),{width:i,height:o}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+o,right:e.left+i,height:o,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const e=this._document,i=this._getWindow(),o=e.documentElement,c=o.getBoundingClientRect();return{top:-c.top||e.body.scrollTop||i.scrollY||o.scrollTop||0,left:-c.left||e.body.scrollLeft||i.scrollX||o.scrollLeft||0}}change(e=20){return e>0?this._change.pipe(yE(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(e){return new(e||n)(We(Wo),We(Pn),We(ai,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const W2=new wt("VIRTUAL_SCROLLABLE");let wU=(()=>{class n extends q2{constructor(e,i,o,c){super(e,i,o,c)}measureViewportSize(e){const i=this.elementRef.nativeElement;return"horizontal"===e?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(cx),ve(Pn),ve(gu,8))},n.\u0275dir=Vt({type:n,features:[Zn]}),n})();const EU=typeof requestAnimationFrame<"u"?iU:uU;let DU=(()=>{class n extends wU{get orientation(){return this._orientation}set orientation(e){this._orientation!==e&&(this._orientation=e,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(e){this._appendOnly=xr(e)}constructor(e,i,o,c,f,v,C,S){super(e,v,o,f),this.elementRef=e,this._changeDetectorRef=i,this._scrollStrategy=c,this.scrollable=S,this._platform=bn(Wo),this._detachedSubject=new yn,this._renderedRangeSubject=new yn,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new xn(R=>this._scrollStrategy.scrolledIndexChange.subscribe(V=>Promise.resolve().then(()=>this.ngZone.run(()=>R.next(V))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=Ie.EMPTY,this._viewportChanges=C.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(Uh(null),yE(0,EU)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(e){this.ngZone.runOutsideAngular(()=>{this._forOf=e,this._forOf.dataStream.pipe(il(this._detachedSubject)).subscribe(i=>{const o=i.length;o!==this._dataLength&&(this._dataLength=o,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(e){return this.getElementRef().nativeElement.getBoundingClientRect()[e]}setTotalContentSize(e){this._totalContentSize!==e&&(this._totalContentSize=e,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(e){(function CU(n,t){return n.start==t.start&&n.end==t.end})(this._renderedRange,e)||(this.appendOnly&&(e={start:0,end:Math.max(this._renderedRange.end,e.end)}),this._renderedRangeSubject.next(this._renderedRange=e),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(e,i="to-start"){e=this.appendOnly&&"to-start"===i?0:e;const c="horizontal"==this.orientation,f=c?"X":"Y";let C=`translate${f}(${Number((c&&this.dir&&"rtl"==this.dir.value?-1:1)*e)}px)`;this._renderedContentOffset=e,"to-end"===i&&(C+=` translate${f}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=C&&(this._renderedContentTransform=C,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(e,i="auto"){const o={behavior:i};"horizontal"===this.orientation?o.start=e:o.top=e,this.scrollable.scrollTo(o)}scrollToIndex(e,i="auto"){this._scrollStrategy.scrollToIndex(e,i)}measureScrollOffset(e){let i;return i=this.scrollable==this?o=>super.measureScrollOffset(o):o=>this.scrollable.measureScrollOffset(o),Math.max(0,i(e??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(e){let i;const o="left",c="right",f="rtl"==this.dir?.value;i="start"==e?f?c:o:"end"==e?f?o:c:e||("horizontal"===this.orientation?"left":"top");const v=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-v}measureRenderedContentSize(){const e=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?e.offsetWidth:e.offsetHeight}measureRangeSize(e){return this._forOf?this._forOf.measureRangeSize(e,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(e){e&&this._runAfterChangeDetection.push(e),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const e=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of e)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(pa),ve(Pn),ve(vU,8),ve(gu,8),ve(cx),ve(ux),ve(W2,8))},n.\u0275cmp=mi({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(e,i){if(1&e&&mo(_U,7),2&e){let o;Gi(o=qi())&&(i._contentWrapper=o.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(e,i){2&e&&vr("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[Ki([{provide:q2,useFactory:(t,e)=>t||e,deps:[[new ds,new tc(W2)],n]}]),Zn,l1],ngContentSelectors:yU,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(e,i){1&e&&(Dl(),pe(0,"div",0,1),yr(2),xe(),It(3,"div",2)),2&e&&(Et(3),Kp("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),dx=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})(),Z2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[Zy,dx,DU,Zy,dx]}),n})();class vE{attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null!=t&&(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class bE extends vE{constructor(t,e,i,o,c){super(),this.component=t,this.viewContainerRef=e,this.injector=i,this.componentFactoryResolver=o,this.projectableNodes=c}}class Y2 extends vE{constructor(t,e,i,o){super(),this.templateRef=t,this.viewContainerRef=e,this.context=i,this.injector=o}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class MU extends vE{constructor(t){super(),this.element=t instanceof _i?t.nativeElement:t}}class X2{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t instanceof bE?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Y2?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof MU?(this._attachedPortal=t,this.attachDomPortal(t)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class SU extends X2{constructor(t,e,i,o,c){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=i,this._defaultInjector=o,this.attachDomPortal=f=>{const v=f.element,C=this._document.createComment("dom-portal");v.parentNode.insertBefore(C,v),this.outletElement.appendChild(v),this._attachedPortal=f,super.setDisposeFn(()=>{C.parentNode&&C.parentNode.replaceChild(v,C)})},this._document=c}attachComponentPortal(t){const i=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let o;return t.viewContainerRef?(o=t.viewContainerRef.createComponent(i,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector,t.projectableNodes||void 0),this.setDisposeFn(()=>o.destroy())):(o=i.create(t.injector||this._defaultInjector||Ts.NULL),this._appRef.attachView(o.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(o.hostView),o.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(o)),this._attachedPortal=t,o}attachTemplatePortal(t){let e=t.viewContainerRef,i=e.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return i.rootNodes.forEach(o=>this.outletElement.appendChild(o)),i.detectChanges(),this.setDisposeFn(()=>{let o=e.indexOf(i);-1!==o&&e.remove(o)}),this._attachedPortal=t,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let K2=(()=>{class n extends X2{constructor(e,i,o){super(),this._componentFactoryResolver=e,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new on,this.attachDomPortal=c=>{const f=c.element,v=this._document.createComment("dom-portal");c.setAttachedHost(this),f.parentNode.insertBefore(v,f),this._getRootNode().appendChild(f),this._attachedPortal=c,super.setDisposeFn(()=>{v.parentNode&&v.parentNode.replaceChild(f,v)})},this._document=o}get portal(){return this._attachedPortal}set portal(e){this.hasAttached()&&!e&&!this._isInitialized||(this.hasAttached()&&super.detach(),e&&super.attach(e),this._attachedPortal=e||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(e){e.setAttachedHost(this);const i=null!=e.viewContainerRef?e.viewContainerRef:this._viewContainerRef,c=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),f=i.createComponent(c,i.length,e.injector||i.injector,e.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(f.hostView.rootNodes[0]),super.setDisposeFn(()=>f.destroy()),this._attachedPortal=e,this._attachedRef=f,this.attached.emit(f),f}attachTemplatePortal(e){e.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=e,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const e=this._viewContainerRef.element.nativeElement;return e.nodeType===e.ELEMENT_NODE?e:e.parentNode}}return n.\u0275fac=function(e){return new(e||n)(ve(Kc),ve(tl),ve(ai))},n.\u0275dir=Vt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Zn]}),n})(),Q2=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const J2=w2();class TU{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=Po(-this._previousScrollPosition.left),t.style.top=Po(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,i=t.style,o=this._document.body.style,c=i.scrollBehavior||"",f=o.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),J2&&(i.scrollBehavior=o.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),J2&&(i.scrollBehavior=c,o.scrollBehavior=f)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const e=this._document.body,i=this._viewportRuler.getViewportSize();return e.scrollHeight>i.height||e.scrollWidth>i.width}}class AU{constructor(t,e,i,o){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=i,this._config=o,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0).pipe(oo(e=>!e||!this._overlayRef.overlayElement.contains(e.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const e=this._viewportRuler.getViewportScrollPosition().top;Math.abs(e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class ek{enable(){}disable(){}attach(){}}function xE(n,t){return t.some(e=>n.bottom<e.top||n.top>e.bottom||n.right<e.left||n.left>e.right)}function tk(n,t){return t.some(e=>n.top<e.top||n.bottom>e.bottom||n.left<e.left||n.right>e.right)}class IU{constructor(t,e,i,o){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=i,this._config=o,this._scrollSubscription=null}attach(t){this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:o}=this._viewportRuler.getViewportSize();xE(e,[{width:i,height:o,bottom:o,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let kU=(()=>{class n{constructor(e,i,o,c){this._scrollDispatcher=e,this._viewportRuler=i,this._ngZone=o,this.noop=()=>new ek,this.close=f=>new AU(this._scrollDispatcher,this._ngZone,this._viewportRuler,f),this.block=()=>new TU(this._viewportRuler,this._document),this.reposition=f=>new IU(this._scrollDispatcher,this._viewportRuler,this._ngZone,f),this._document=c}}return n.\u0275fac=function(e){return new(e||n)(We(cx),We(ux),We(Pn),We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class wE{constructor(t){if(this.scrollStrategy=new ek,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,t){const e=Object.keys(t);for(const i of e)void 0!==t[i]&&(this[i]=t[i])}}}class PU{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}let nk=(()=>{class n{constructor(e){this._attachedOverlays=[],this._document=e}ngOnDestroy(){this.detach()}add(e){this.remove(e),this._attachedOverlays.push(e)}remove(e){const i=this._attachedOverlays.indexOf(e);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(e){return new(e||n)(We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),RU=(()=>{class n extends nk{constructor(e,i){super(e),this._ngZone=i,this._keydownListener=o=>{const c=this._attachedOverlays;for(let f=c.length-1;f>-1;f--)if(c[f]._keydownEvents.observers.length>0){const v=c[f]._keydownEvents;this._ngZone?this._ngZone.run(()=>v.next(o)):v.next(o);break}}}add(e){super.add(e),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(e){return new(e||n)(We(ai),We(Pn,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),FU=(()=>{class n extends nk{constructor(e,i,o){super(e),this._platform=i,this._ngZone=o,this._cursorStyleIsSet=!1,this._pointerDownListener=c=>{this._pointerDownEventTarget=Yh(c)},this._clickListener=c=>{const f=Yh(c),v="click"===c.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:f;this._pointerDownEventTarget=null;const C=this._attachedOverlays.slice();for(let S=C.length-1;S>-1;S--){const R=C[S];if(R._outsidePointerEvents.observers.length<1||!R.hasAttached())continue;if(R.overlayElement.contains(f)||R.overlayElement.contains(v))break;const V=R._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>V.next(c)):V.next(c)}}}add(e){if(super.add(e),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const e=this._document.body;e.removeEventListener("pointerdown",this._pointerDownListener,!0),e.removeEventListener("click",this._clickListener,!0),e.removeEventListener("auxclick",this._clickListener,!0),e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(e){e.addEventListener("pointerdown",this._pointerDownListener,!0),e.addEventListener("click",this._clickListener,!0),e.addEventListener("auxclick",this._clickListener,!0),e.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(e){return new(e||n)(We(ai),We(Wo),We(Pn,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ik=(()=>{class n{constructor(e,i){this._platform=i,this._document=e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const e="cdk-overlay-container";if(this._platform.isBrowser||uE()){const o=this._document.querySelectorAll(`.${e}[platform="server"], .${e}[platform="test"]`);for(let c=0;c<o.length;c++)o[c].remove()}const i=this._document.createElement("div");i.classList.add(e),uE()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(e){return new(e||n)(We(ai),We(Wo))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class OU{constructor(t,e,i,o,c,f,v,C,S,R=!1){this._portalOutlet=t,this._host=e,this._pane=i,this._config=o,this._ngZone=c,this._keyboardDispatcher=f,this._document=v,this._location=C,this._outsideClickDispatcher=S,this._animationsDisabled=R,this._backdropElement=null,this._backdropClick=new yn,this._attachments=new yn,this._detachments=new yn,this._locationChanges=Ie.EMPTY,this._backdropClickHandler=V=>this._backdropClick.next(V),this._backdropTransitionendHandler=V=>{this._disposeBackdrop(V.target)},this._keydownEvents=new yn,this._outsidePointerEvents=new yn,o.scrollStrategy&&(this._scrollStrategy=o.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=o.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const e=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(ro(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof e?.onDestroy&&e.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config={...this._config,...t},this._updateElementSize()}setDirection(t){this._config={...this._config,direction:t},this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=Po(this._config.width),t.height=Po(this._config.height),t.minWidth=Po(this._config.minWidth),t.minHeight=Po(this._config.minHeight),t.maxWidth=Po(this._config.maxWidth),t.maxHeight=Po(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){const t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const t=this._backdropElement;if(t){if(this._animationsDisabled)return void this._disposeBackdrop(t);t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{t.addEventListener("transitionend",this._backdropTransitionendHandler)}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,e,i){const o=ox(e||[]).filter(c=>!!c);o.length&&(i?t.classList.add(...o):t.classList.remove(...o))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.pipe(il(qr(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){t&&(t.removeEventListener("click",this._backdropClickHandler),t.removeEventListener("transitionend",this._backdropTransitionendHandler),t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const rk="cdk-overlay-connected-position-bounding-box",LU=/([A-Za-z%]+)$/;class ok{get positions(){return this._preferredPositions}constructor(t,e,i,o,c){this._viewportRuler=e,this._document=i,this._platform=o,this._overlayContainer=c,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new yn,this._resizeSubscription=Ie.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(t)}attach(t){this._validatePositions(),t.hostElement.classList.add(rk),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._originRect,e=this._overlayRect,i=this._viewportRect,o=this._containerRect,c=[];let f;for(let v of this._preferredPositions){let C=this._getOriginPoint(t,o,v),S=this._getOverlayPoint(C,e,v),R=this._getOverlayFit(S,e,i,v);if(R.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(v,C);this._canFitWithFlexibleDimensions(R,S,i)?c.push({position:v,origin:C,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(C,v)}):(!f||f.overlayFit.visibleArea<R.visibleArea)&&(f={overlayFit:R,overlayPoint:S,originPoint:C,position:v,overlayRect:e})}if(c.length){let v=null,C=-1;for(const S of c){const R=S.boundingBoxRect.width*S.boundingBoxRect.height*(S.position.weight||1);R>C&&(C=R,v=S)}return this._isPushed=!1,void this._applyPosition(v.position,v.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(f.position,f.originPoint);this._applyPosition(f.position,f.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&mf(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(rk),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,e)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e,i){let o,c;if("center"==i.originX)o=t.left+t.width/2;else{const f=this._isRtl()?t.right:t.left,v=this._isRtl()?t.left:t.right;o="start"==i.originX?f:v}return e.left<0&&(o-=e.left),c="center"==i.originY?t.top+t.height/2:"top"==i.originY?t.top:t.bottom,e.top<0&&(c-=e.top),{x:o,y:c}}_getOverlayPoint(t,e,i){let o,c;return o="center"==i.overlayX?-e.width/2:"start"===i.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,c="center"==i.overlayY?-e.height/2:"top"==i.overlayY?0:-e.height,{x:t.x+o,y:t.y+c}}_getOverlayFit(t,e,i,o){const c=ak(e);let{x:f,y:v}=t,C=this._getOffset(o,"x"),S=this._getOffset(o,"y");C&&(f+=C),S&&(v+=S);let Q=0-v,oe=v+c.height-i.height,me=this._subtractOverflows(c.width,0-f,f+c.width-i.width),Ee=this._subtractOverflows(c.height,Q,oe),$e=me*Ee;return{visibleArea:$e,isCompletelyWithinViewport:c.width*c.height===$e,fitsInViewportVertically:Ee===c.height,fitsInViewportHorizontally:me==c.width}}_canFitWithFlexibleDimensions(t,e,i){if(this._hasFlexibleDimensions){const o=i.bottom-e.y,c=i.right-e.x,f=sk(this._overlayRef.getConfig().minHeight),v=sk(this._overlayRef.getConfig().minWidth);return(t.fitsInViewportVertically||null!=f&&f<=o)&&(t.fitsInViewportHorizontally||null!=v&&v<=c)}return!1}_pushOverlayOnScreen(t,e,i){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const o=ak(e),c=this._viewportRect,f=Math.max(t.x+o.width-c.width,0),v=Math.max(t.y+o.height-c.height,0),C=Math.max(c.top-i.top-t.y,0),S=Math.max(c.left-i.left-t.x,0);let R=0,V=0;return R=o.width<=c.width?S||-f:t.x<this._viewportMargin?c.left-i.left-t.x:0,V=o.height<=c.height?C||-v:t.y<this._viewportMargin?c.top-i.top-t.y:0,this._previousPushAmount={x:R,y:V},{x:t.x+R,y:t.y+V}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const i=this._getScrollVisibility(),o=new PU(t,i);this._positionChanges.next(o)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,o=t.overlayY;i="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let c=0;c<e.length;c++)e[c].style.transformOrigin=`${i} ${o}`}_calculateBoundingBoxRect(t,e){const i=this._viewportRect,o=this._isRtl();let c,f,v,R,V,Q;if("top"===e.overlayY)f=t.y,c=i.height-f+this._viewportMargin;else if("bottom"===e.overlayY)v=i.height-t.y+2*this._viewportMargin,c=i.height-v+this._viewportMargin;else{const oe=Math.min(i.bottom-t.y+i.top,t.y),me=this._lastBoundingBoxSize.height;c=2*oe,f=t.y-oe,c>me&&!this._isInitialRender&&!this._growAfterOpen&&(f=t.y-me/2)}if("end"===e.overlayX&&!o||"start"===e.overlayX&&o)Q=i.width-t.x+this._viewportMargin,R=t.x-this._viewportMargin;else if("start"===e.overlayX&&!o||"end"===e.overlayX&&o)V=t.x,R=i.right-t.x;else{const oe=Math.min(i.right-t.x+i.left,t.x),me=this._lastBoundingBoxSize.width;R=2*oe,V=t.x-oe,R>me&&!this._isInitialRender&&!this._growAfterOpen&&(V=t.x-me/2)}return{top:f,left:V,bottom:v,right:Q,width:R,height:c}}_setBoundingBoxStyles(t,e){const i=this._calculateBoundingBoxRect(t,e);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const o={};if(this._hasExactPosition())o.top=o.left="0",o.bottom=o.right=o.maxHeight=o.maxWidth="",o.width=o.height="100%";else{const c=this._overlayRef.getConfig().maxHeight,f=this._overlayRef.getConfig().maxWidth;o.height=Po(i.height),o.top=Po(i.top),o.bottom=Po(i.bottom),o.width=Po(i.width),o.left=Po(i.left),o.right=Po(i.right),o.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",o.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",c&&(o.maxHeight=Po(c)),f&&(o.maxWidth=Po(f))}this._lastBoundingBoxSize=i,mf(this._boundingBox.style,o)}_resetBoundingBoxStyles(){mf(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){mf(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const i={},o=this._hasExactPosition(),c=this._hasFlexibleDimensions,f=this._overlayRef.getConfig();if(o){const R=this._viewportRuler.getViewportScrollPosition();mf(i,this._getExactOverlayY(e,t,R)),mf(i,this._getExactOverlayX(e,t,R))}else i.position="static";let v="",C=this._getOffset(e,"x"),S=this._getOffset(e,"y");C&&(v+=`translateX(${C}px) `),S&&(v+=`translateY(${S}px)`),i.transform=v.trim(),f.maxHeight&&(o?i.maxHeight=Po(f.maxHeight):c&&(i.maxHeight="")),f.maxWidth&&(o?i.maxWidth=Po(f.maxWidth):c&&(i.maxWidth="")),mf(this._pane.style,i)}_getExactOverlayY(t,e,i){let o={top:"",bottom:""},c=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,i)),"bottom"===t.overlayY?o.bottom=this._document.documentElement.clientHeight-(c.y+this._overlayRect.height)+"px":o.top=Po(c.y),o}_getExactOverlayX(t,e,i){let f,o={left:"",right:""},c=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(c=this._pushOverlayOnScreen(c,this._overlayRect,i)),f=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===f?o.right=this._document.documentElement.clientWidth-(c.x+this._overlayRect.width)+"px":o.left=Po(c.x),o}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),i=this._scrollables.map(o=>o.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:tk(t,i),isOriginOutsideView:xE(t,i),isOverlayClipped:tk(e,i),isOverlayOutsideView:xE(e,i)}}_subtractOverflows(t,...e){return e.reduce((i,o)=>i-Math.max(o,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+t-this._viewportMargin,bottom:i.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&ox(t).forEach(e=>{""!==e&&-1===this._appliedPanelClasses.indexOf(e)&&(this._appliedPanelClasses.push(e),this._pane.classList.add(e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof _i)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,i=t.height||0;return{top:t.y,bottom:t.y+i,left:t.x,right:t.x+e,height:i,width:e}}}function mf(n,t){for(let e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function sk(n){if("number"!=typeof n&&null!=n){const[t,e]=n.split(LU);return e&&"px"!==e?null:parseFloat(t)}return n||null}function ak(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const lk="cdk-global-overlay-wrapper";class NU{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(lk),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:o,height:c,maxWidth:f,maxHeight:v}=i,C=!("100%"!==o&&"100vw"!==o||f&&"100%"!==f&&"100vw"!==f),S=!("100%"!==c&&"100vh"!==c||v&&"100%"!==v&&"100vh"!==v),R=this._xPosition,V=this._xOffset,Q="rtl"===this._overlayRef.getConfig().direction;let oe="",me="",Ee="";C?Ee="flex-start":"center"===R?(Ee="center",Q?me=V:oe=V):Q?"left"===R||"end"===R?(Ee="flex-end",oe=V):("right"===R||"start"===R)&&(Ee="flex-start",me=V):"left"===R||"start"===R?(Ee="flex-start",oe=V):("right"===R||"end"===R)&&(Ee="flex-end",me=V),t.position=this._cssPosition,t.marginLeft=C?"0":oe,t.marginTop=S?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=C?"0":me,e.justifyContent=Ee,e.alignItems=S?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,i=e.style;e.classList.remove(lk),i.justifyContent=i.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let BU=(()=>{class n{constructor(e,i,o,c){this._viewportRuler=e,this._document=i,this._platform=o,this._overlayContainer=c}global(){return new NU}flexibleConnectedTo(e){return new ok(e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(e){return new(e||n)(We(ux),We(ai),We(Wo),We(ik))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),zU=0,sg=(()=>{class n{constructor(e,i,o,c,f,v,C,S,R,V,Q,oe){this.scrollStrategies=e,this._overlayContainer=i,this._componentFactoryResolver=o,this._positionBuilder=c,this._keyboardDispatcher=f,this._injector=v,this._ngZone=C,this._document=S,this._directionality=R,this._location=V,this._outsideClickDispatcher=Q,this._animationsModuleType=oe}create(e){const i=this._createHostElement(),o=this._createPaneElement(i),c=this._createPortalOutlet(o),f=new wE(e);return f.direction=f.direction||this._directionality.value,new OU(c,i,o,f,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(e){const i=this._document.createElement("div");return i.id="cdk-overlay-"+zU++,i.classList.add("cdk-overlay-pane"),e.appendChild(i),i}_createHostElement(){const e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(e),e}_createPortalOutlet(e){return this._appRef||(this._appRef=this._injector.get(Jp)),new SU(e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(e){return new(e||n)(We(kU),We(ik),We(Kc),We(BU),We(RU),We(Ts),We(Pn),We(ai),We(gu),We(t0),We(FU),We(Bh,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const VU=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],ck=new wt("cdk-connected-overlay-scroll-strategy");let CE=(()=>{class n{constructor(e){this.elementRef=e}}return n.\u0275fac=function(e){return new(e||n)(ve(_i))},n.\u0275dir=Vt({type:n,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"],standalone:!0}),n})(),uk=(()=>{class n{get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e,this._position&&this._updatePositionStrategy(this._position)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(e){this._hasBackdrop=xr(e)}get lockPosition(){return this._lockPosition}set lockPosition(e){this._lockPosition=xr(e)}get flexibleDimensions(){return this._flexibleDimensions}set flexibleDimensions(e){this._flexibleDimensions=xr(e)}get growAfterOpen(){return this._growAfterOpen}set growAfterOpen(e){this._growAfterOpen=xr(e)}get push(){return this._push}set push(e){this._push=xr(e)}constructor(e,i,o,c,f){this._overlay=e,this._dir=f,this._hasBackdrop=!1,this._lockPosition=!1,this._growAfterOpen=!1,this._flexibleDimensions=!1,this._push=!1,this._backdropSubscription=Ie.EMPTY,this._attachSubscription=Ie.EMPTY,this._detachSubscription=Ie.EMPTY,this._positionSubscription=Ie.EMPTY,this.viewportMargin=0,this.open=!1,this.disableClose=!1,this.backdropClick=new on,this.positionChange=new on,this.attach=new on,this.detach=new on,this.overlayKeydown=new on,this.overlayOutsideClick=new on,this._templatePortal=new Y2(i,o),this._scrollStrategyFactory=c,this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(e){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),e.origin&&this.open&&this._position.apply()),e.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=VU);const e=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=e.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=e.detachments().subscribe(()=>this.detach.emit()),e.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),27===i.keyCode&&!this.disableClose&&!mu(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{this.overlayOutsideClick.next(i)})}_buildConfig(){const e=this._position=this.positionStrategy||this._createPositionStrategy(),i=new wE({direction:this._dir,positionStrategy:e,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop});return(this.width||0===this.width)&&(i.width=this.width),(this.height||0===this.height)&&(i.height=this.height),(this.minWidth||0===this.minWidth)&&(i.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(e){const i=this.positions.map(o=>({originX:o.originX,originY:o.originY,overlayX:o.overlayX,overlayY:o.overlayY,offsetX:o.offsetX||this.offsetX,offsetY:o.offsetY||this.offsetY,panelClass:o.panelClass||void 0}));return e.setOrigin(this._getFlexibleConnectedPositionStrategyOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const e=this._overlay.position().flexibleConnectedTo(this._getFlexibleConnectedPositionStrategyOrigin());return this._updatePositionStrategy(e),e}_getFlexibleConnectedPositionStrategyOrigin(){return this.origin instanceof CE?this.origin.elementRef:this.origin}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(e=>{this.backdropClick.emit(e)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(aA(()=>this.positionChange.observers.length>0)).subscribe(e=>{this.positionChange.emit(e),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(ve(sg),ve(qu),ve(tl),ve(ck),ve(gu,8))},n.\u0275dir=Vt({type:n,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:["cdkConnectedOverlayOrigin","origin"],positions:["cdkConnectedOverlayPositions","positions"],positionStrategy:["cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:["cdkConnectedOverlayOffsetX","offsetX"],offsetY:["cdkConnectedOverlayOffsetY","offsetY"],width:["cdkConnectedOverlayWidth","width"],height:["cdkConnectedOverlayHeight","height"],minWidth:["cdkConnectedOverlayMinWidth","minWidth"],minHeight:["cdkConnectedOverlayMinHeight","minHeight"],backdropClass:["cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:["cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:["cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:["cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:["cdkConnectedOverlayOpen","open"],disableClose:["cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:["cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:["cdkConnectedOverlayHasBackdrop","hasBackdrop"],lockPosition:["cdkConnectedOverlayLockPosition","lockPosition"],flexibleDimensions:["cdkConnectedOverlayFlexibleDimensions","flexibleDimensions"],growAfterOpen:["cdkConnectedOverlayGrowAfterOpen","growAfterOpen"],push:["cdkConnectedOverlayPush","push"]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],standalone:!0,features:[tr]}),n})();const jU={provide:ck,deps:[sg],useFactory:function UU(n){return()=>n.scrollStrategies.reposition()}};let dk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[sg,jU],imports:[Zy,Q2,Z2,Z2]}),n})();const $U=["text"];function HU(n,t){if(1&n&&It(0,"mat-pseudo-checkbox",6),2&n){const e=ri();ht("state",e.selected?"checked":"unchecked")("disabled",e.disabled)}}function GU(n,t){1&n&&It(0,"mat-pseudo-checkbox",7),2&n&&ht("disabled",ri().disabled)}function qU(n,t){if(1&n&&(pe(0,"span",8),Qe(1),xe()),2&n){const e=ri();Et(1),uu("(",e.group.label,")")}}const WU=[[["mat-icon"]],"*"],ZU=["mat-icon","*"],XU=new wt("mat-sanity-checks",{providedIn:"root",factory:function YU(){return!0}});let ma=(()=>{class n{constructor(e,i,o){this._sanityChecks=i,this._document=o,this._hasDoneGlobalChecks=!1,e._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(e){return!uE()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[e])}}return n.\u0275fac=function(e){return new(e||n)(We(j2),We(XU,8),We(ai))},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[Zy,Zy]}),n})();function fk(n){return class extends n{get disabled(){return this._disabled}set disabled(t){this._disabled=xr(t)}constructor(...t){super(...t),this._disabled=!1}}}function mk(n,t){return class extends n{get color(){return this._color}set color(e){const i=e||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}constructor(...e){super(...e),this.defaultColor=t,this.color=t}}}function gk(n){return class extends n{get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=xr(t)}constructor(...t){super(...t),this._disableRipple=!1}}}function KU(n,t=0){return class extends n{get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(e){this._tabIndex=null!=e?mE(e):this.defaultTabIndex}constructor(...e){super(...e),this._tabIndex=t,this.defaultTabIndex=t}}}function _k(n){return class extends n{updateErrorState(){const t=this.errorState,c=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);c!==t&&(this.errorState=c,this.stateChanges.next())}constructor(...t){super(...t),this.errorState=!1}}}const QU=new wt("MAT_DATE_LOCALE",{providedIn:"root",factory:function JU(){return bn(Wu)}});class Ps{constructor(){this._localeChanges=new yn,this.localeChanges=this._localeChanges}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let i=this.isValid(t),o=this.isValid(e);return i&&o?!this.compareDate(t,e):i==o}return t==e}clampDate(t,e,i){return e&&this.compareDate(t,e)<0?e:i&&this.compareDate(t,i)>0?i:t}}const gf=new wt("mat-date-formats"),ej=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function EE(n,t){const e=Array(n);for(let i=0;i<n;i++)e[i]=t(i);return e}let tj=(()=>{class n extends Ps{constructor(e,i){super(),this.useUtcForDisplay=!1,super.setLocale(e)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){const i=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return EE(12,o=>this._format(i,new Date(2017,o,1)))}getDateNames(){const e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return EE(31,i=>this._format(e,new Date(2017,0,i+1)))}getDayOfWeekNames(e){const i=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return EE(7,o=>this._format(i,new Date(2017,0,o+1)))}getYearName(e){const i=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(i,e)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,i,o){let c=this._createDateWithOverflow(e,i,o);return c.getMonth(),c}today(){return new Date}parse(e,i){return"number"==typeof e?new Date(e):e?new Date(Date.parse(e)):null}format(e,i){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");const o=new Intl.DateTimeFormat(this.locale,{...i,timeZone:"utc"});return this._format(o,e)}addCalendarYears(e,i){return this.addCalendarMonths(e,12*i)}addCalendarMonths(e,i){let o=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+i,this.getDate(e));return this.getMonth(o)!=((this.getMonth(e)+i)%12+12)%12&&(o=this._createDateWithOverflow(this.getYear(o),this.getMonth(o),0)),o}addCalendarDays(e,i){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+i)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if("string"==typeof e){if(!e)return null;if(ej.test(e)){let i=new Date(e);if(this.isValid(i))return i}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(e,i,o){const c=new Date;return c.setFullYear(e,i,o),c.setHours(0,0,0,0),c}_2digit(e){return("00"+e).slice(-2)}_format(e,i){const o=new Date;return o.setUTCFullYear(i.getFullYear(),i.getMonth(),i.getDate()),o.setUTCHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),e.format(o)}}return n.\u0275fac=function(e){return new(e||n)(We(QU,8),We(Wo))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const nj={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let ij=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[{provide:Ps,useClass:tj}]}),n})(),rj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[{provide:gf,useValue:nj}],imports:[ij]}),n})(),yk=(()=>{class n{isErrorState(e,i){return!!(e&&e.invalid&&(e.touched||i&&i.submitted))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class oj{constructor(t,e,i,o=!1){this._renderer=t,this.element=e,this.config=i,this._animationForciblyDisabledThroughCss=o,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const vk=jy({passive:!0,capture:!0});class sj{constructor(){this._events=new Map,this._delegateEventHandler=t=>{const e=Yh(t);e&&this._events.get(t.type)?.forEach((i,o)=>{(o===e||o.contains(e))&&i.forEach(c=>c.handleEvent(t))})}}addHandler(t,e,i,o){const c=this._events.get(e);if(c){const f=c.get(i);f?f.add(o):c.set(i,new Set([o]))}else this._events.set(e,new Map([[i,new Set([o])]])),t.runOutsideAngular(()=>{document.addEventListener(e,this._delegateEventHandler,vk)})}removeHandler(t,e,i){const o=this._events.get(t);if(!o)return;const c=o.get(e);c&&(c.delete(i),0===c.size&&o.delete(e),0===o.size&&(this._events.delete(t),document.removeEventListener(t,this._delegateEventHandler,vk)))}}const bk={enterDuration:225,exitDuration:150},xk=jy({passive:!0,capture:!0}),wk=["mousedown","touchstart"],Ck=["mouseup","mouseleave","touchend","touchcancel"];class Xy{constructor(t,e,i,o){this._target=t,this._ngZone=e,this._platform=o,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,o.isBrowser&&(this._containerElement=Nd(i))}fadeInRipple(t,e,i={}){const o=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),c={...bk,...i.animation};i.centered&&(t=o.left+o.width/2,e=o.top+o.height/2);const f=i.radius||function lj(n,t,e){const i=Math.max(Math.abs(n-e.left),Math.abs(n-e.right)),o=Math.max(Math.abs(t-e.top),Math.abs(t-e.bottom));return Math.sqrt(i*i+o*o)}(t,e,o),v=t-o.left,C=e-o.top,S=c.enterDuration,R=document.createElement("div");R.classList.add("mat-ripple-element"),R.style.left=v-f+"px",R.style.top=C-f+"px",R.style.height=2*f+"px",R.style.width=2*f+"px",null!=i.color&&(R.style.backgroundColor=i.color),R.style.transitionDuration=`${S}ms`,this._containerElement.appendChild(R);const V=window.getComputedStyle(R),oe=V.transitionDuration,me="none"===V.transitionProperty||"0s"===oe||"0s, 0s"===oe||0===o.width&&0===o.height,Ee=new oj(this,R,i,me);R.style.transform="scale3d(1, 1, 1)",Ee.state=0,i.persistent||(this._mostRecentTransientRipple=Ee);let $e=null;return!me&&(S||c.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const lt=()=>this._finishRippleTransition(Ee),St=()=>this._destroyRipple(Ee);R.addEventListener("transitionend",lt),R.addEventListener("transitioncancel",St),$e={onTransitionEnd:lt,onTransitionCancel:St}}),this._activeRipples.set(Ee,$e),(me||!S)&&this._finishRippleTransition(Ee),Ee}fadeOutRipple(t){if(2===t.state||3===t.state)return;const e=t.element,i={...bk,...t.config.animation};e.style.transitionDuration=`${i.exitDuration}ms`,e.style.opacity="0",t.state=2,(t._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(t)}fadeOutAll(){this._getActiveRipples().forEach(t=>t.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(t=>{t.config.persistent||t.fadeOut()})}setupTriggerEvents(t){const e=Nd(t);!this._platform.isBrowser||!e||e===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=e,wk.forEach(i=>{Xy._eventManager.addHandler(this._ngZone,i,e,this)}))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{Ck.forEach(e=>{this._triggerElement.addEventListener(e,this,xk)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(t){0===t.state?this._startFadeOutTransition(t):2===t.state&&this._destroyRipple(t)}_startFadeOutTransition(t){const e=t===this._mostRecentTransientRipple,{persistent:i}=t.config;t.state=1,!i&&(!e||!this._isPointerDown)&&t.fadeOut()}_destroyRipple(t){const e=this._activeRipples.get(t)??null;this._activeRipples.delete(t),this._activeRipples.size||(this._containerRect=null),t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),t.state=3,null!==e&&(t.element.removeEventListener("transitionend",e.onTransitionEnd),t.element.removeEventListener("transitioncancel",e.onTransitionCancel)),t.element.remove()}_onMousedown(t){const e=L2(t),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!e&&!i&&(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled&&!N2(t)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let i=0;i<e.length;i++)this.fadeInRipple(e[i].clientX,e[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const t=this._triggerElement;t&&(wk.forEach(e=>Xy._eventManager.removeHandler(e,t,this)),this._pointerUpEventsRegistered&&Ck.forEach(e=>t.removeEventListener(e,this,xk)))}}Xy._eventManager=new sj;const cj=new wt("mat-ripple-global-options");let hx=(()=>{class n{get disabled(){return this._disabled}set disabled(e){e&&this.fadeOutAllNonPersistent(),this._disabled=e,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(e){this._trigger=e,this._setupTriggerEventsIfEnabled()}constructor(e,i,o,c,f){this._elementRef=e,this._animationMode=f,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=c||{},this._rippleRenderer=new Xy(this,i,e,o)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(e,i=0,o){return"number"==typeof e?this._rippleRenderer.fadeInRipple(e,i,{...this.rippleConfig,...o}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...e})}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Pn),ve(Wo),ve(cj,8),ve(Bh,8))},n.\u0275dir=Vt({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(e,i){2&e&&vr("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),Ek=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma,ma]}),n})(),uj=(()=>{class n{constructor(e){this._animationMode=e,this.state="unchecked",this.disabled=!1,this.appearance="full"}}return n.\u0275fac=function(e){return new(e||n)(ve(Bh,8))},n.\u0275cmp=mi({type:n,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(e,i){2&e&&vr("mat-pseudo-checkbox-indeterminate","indeterminate"===i.state)("mat-pseudo-checkbox-checked","checked"===i.state)("mat-pseudo-checkbox-disabled",i.disabled)("mat-pseudo-checkbox-minimal","minimal"===i.appearance)("mat-pseudo-checkbox-full","full"===i.appearance)("_mat-animation-noopable","NoopAnimations"===i._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(e,i){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-full{border:2px solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0}),n})(),dj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma]}),n})();const Dk=new wt("MAT_OPTION_PARENT_COMPONENT"),Mk=new wt("MatOptgroup");let hj=0;class pj{constructor(t,e=!1){this.source=t,this.isUserInput=e}}let fj=(()=>{class n{get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(e){this._disabled=xr(e)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}constructor(e,i,o,c){this._element=e,this._changeDetectorRef=i,this._parent=o,this.group=c,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+hj++,this.onSelectionChange=new on,this._stateChanges=new yn}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(e,i){const o=this._getHostElement();"function"==typeof o.focus&&o.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(e){(13===e.keyCode||32===e.keyCode)&&!mu(e)&&(this._selectViaInteraction(),e.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const e=this.viewValue;e!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=e)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(e=!1){this.onSelectionChange.emit(new pj(this,e))}}return n.\u0275fac=function(e){nu()},n.\u0275dir=Vt({type:n,viewQuery:function(e,i){if(1&e&&mo($U,7),2&e){let o;Gi(o=qi())&&(i._text=o.first)}},inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),n})(),Sk=(()=>{class n extends fj{constructor(e,i,o,c){super(e,i,o,c)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(pa),ve(Dk,8),ve(Mk,8))},n.\u0275cmp=mi({type:n,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(e,i){1&e&&mn("click",function(){return i._selectViaInteraction()})("keydown",function(c){return i._handleKeydown(c)}),2&e&&(Fm("id",i.id),Ze("aria-selected",i.selected)("aria-disabled",i.disabled.toString()),vr("mdc-list-item--selected",i.selected)("mat-mdc-option-multiple",i.multiple)("mat-mdc-option-active",i.active)("mdc-list-item--disabled",i.disabled))},exportAs:["matOption"],features:[Zn],ngContentSelectors:ZU,decls:8,vars:5,consts:[["class","mat-mdc-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mdc-list-item__primary-text"],["text",""],["class","mat-mdc-option-pseudo-checkbox","state","checked","appearance","minimal",3,"disabled",4,"ngIf"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-mdc-option-ripple","mat-mdc-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-mdc-option-pseudo-checkbox",3,"state","disabled"],["state","checked","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"]],template:function(e,i){1&e&&(Dl(WU),$t(0,HU,1,2,"mat-pseudo-checkbox",0),yr(1),pe(2,"span",1,2),yr(4,1),xe(),$t(5,GU,1,1,"mat-pseudo-checkbox",3),$t(6,qU,2,1,"span",4),It(7,"div",5)),2&e&&(ht("ngIf",i.multiple),Et(5),ht("ngIf",!i.multiple&&i.selected&&!i.hideSingleSelectionIndicator),Et(1),ht("ngIf",i.group&&i.group._inert),Et(1),ht("matRippleTrigger",i._getHostElement())("matRippleDisabled",i.disabled||i.disableRipple))},dependencies:[hx,hy,uj],styles:['.mat-mdc-option{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:16px;padding-right:16px;-webkit-user-select:none;user-select:none;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);min-height:48px}.mat-mdc-option:focus{outline:none}[dir=rtl] .mat-mdc-option,.mat-mdc-option[dir=rtl]{padding-left:16px;padding-right:16px}.mat-mdc-option.mdc-list-item{align-items:center}.mat-mdc-option.mdc-list-item--disabled{opacity:.38;cursor:default}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}.cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-mdc-option.mdc-list-item--selected:not(.mat-mdc-option-multiple)::after{right:auto;left:16px}.mat-mdc-option-active .mat-mdc-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0}),n})(),Tk=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[Ek,jm,ma,dj]}),n})();const _j=["mat-button",""],yj=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],vj=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],xj=["mat-icon-button",""],wj=["*"],Cj=[{selector:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{selector:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{selector:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{selector:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{selector:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab"]},{selector:"mat-mini-fab",mdcClasses:["mdc-fab","mdc-fab--mini","mat-mdc-mini-fab"]},{selector:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],Ej=mk(fk(gk(class{constructor(n){this._elementRef=n}})));let Ak=(()=>{class n extends Ej{constructor(e,i,o,c){super(e),this._platform=i,this._ngZone=o,this._animationMode=c,this._focusMonitor=bn(z2),this._isFab=!1;const f=e.nativeElement.classList;for(const v of Cj)this._hasHostAttributes(v.selector)&&v.mdcClasses.forEach(C=>{f.add(C)})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(e="program",i){e?this._focusMonitor.focusVia(this._elementRef.nativeElement,e,i):this._elementRef.nativeElement.focus(i)}_hasHostAttributes(...e){return e.some(i=>this._elementRef.nativeElement.hasAttribute(i))}_isRippleDisabled(){return this.disableRipple||this.disabled}}return n.\u0275fac=function(e){nu()},n.\u0275dir=Vt({type:n,viewQuery:function(e,i){if(1&e&&mo(hx,5),2&e){let o;Gi(o=qi())&&(i.ripple=o.first)}},features:[Zn]}),n})(),Ik=(()=>{class n extends Ak{constructor(e,i,o,c){super(e,i,o,c)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Wo),ve(Pn),ve(Bh,8))},n.\u0275cmp=mi({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:7,hostBindings:function(e,i){2&e&&(Ze("disabled",i.disabled||null),vr("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Zn],attrs:_j,ngContentSelectors:vj,decls:8,vars:6,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,i){1&e&&(Dl(yj),It(0,"span",0),yr(1),pe(2,"span",1),yr(3,1),xe(),yr(4,2),It(5,"span",2)(6,"span",3)(7,"span",4)),2&e&&(vr("mdc-button__ripple",!i._isFab)("mdc-fab__ripple",i._isFab),Et(6),ht("matRippleDisabled",i._isRippleDisabled())("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[hx],styles:['.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button{position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0)}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top}[dir=rtl] .mdc-button .mdc-button__icon,.mdc-button .mdc-button__icon[dir=rtl]{margin-left:8px;margin-right:0}.mdc-button .mdc-button__progress-indicator{font-size:0;position:absolute;transform:translate(-50%, -50%);top:50%;left:50%;line-height:initial}.mdc-button .mdc-button__label{position:relative}.mdc-button .mdc-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(\n      100% + 4px\n    );width:calc(\n      100% + 4px\n    );display:none}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring{border-color:CanvasText}}.mdc-button .mdc-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-button .mdc-button__focus-ring::after{border-color:CanvasText}}@media screen and (forced-colors: active){.mdc-button.mdc-ripple-upgraded--background-focused .mdc-button__focus-ring,.mdc-button:not(.mdc-ripple-upgraded):focus .mdc-button__focus-ring{display:block}}.mdc-button .mdc-button__touch{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}[dir=rtl] .mdc-button__label+.mdc-button__icon,.mdc-button__label+.mdc-button__icon[dir=rtl]{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--touch{margin-top:6px;margin-bottom:6px}.mdc-button{padding:0 8px 0 8px}.mdc-button--unelevated{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--unelevated.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--unelevated.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--raised{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 16px 0 16px}.mdc-button--raised.mdc-button--icon-trailing{padding:0 12px 0 16px}.mdc-button--raised.mdc-button--icon-leading{padding:0 16px 0 12px}.mdc-button--outlined{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-button--outlined .mdc-button__ripple{border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button{height:var(--mdc-text-button-container-height, 36px);border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, inherit)}.mat-mdc-button:disabled{color:var(--mdc-text-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button{height:var(--mdc-filled-button-container-height, 36px);border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-unelevated-button:not(:disabled){background-color:var(--mdc-filled-button-container-color, transparent)}.mat-mdc-unelevated-button:disabled{background-color:var(--mdc-filled-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, inherit)}.mat-mdc-unelevated-button:disabled{color:var(--mdc-filled-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button{height:var(--mdc-protected-button-container-height, 36px);border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px));box-shadow:var(--mdc-protected-button-container-elevation, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){background-color:var(--mdc-protected-button-container-color, transparent)}.mat-mdc-raised-button:disabled{background-color:var(--mdc-protected-button-disabled-container-color, rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, inherit)}.mat-mdc-raised-button:disabled{color:var(--mdc-protected-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-raised-button.mdc-ripple-upgraded--background-focused,.mat-mdc-raised-button:not(.mdc-ripple-upgraded):focus{box-shadow:var(--mdc-protected-button-focus-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation, 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:not(:disabled):active{box-shadow:var(--mdc-protected-button-pressed-container-elevation, 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12))}.mat-mdc-raised-button:disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation, 0px 0px 0px 0px rgba(0, 0, 0, 0.2), 0px 0px 0px 0px rgba(0, 0, 0, 0.14), 0px 0px 0px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button{height:var(--mdc-outlined-button-container-height, 36px);border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px));padding:0 15px 0 15px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, inherit)}.mat-mdc-outlined-button:disabled{color:var(--mdc-outlined-button-disabled-label-text-color, rgba(0, 0, 0, 0.38))}.mat-mdc-outlined-button .mdc-button__ripple{border-radius:var(--mdc-outlined-button-container-shape, var(--mdc-shape-small, 4px))}.mat-mdc-outlined-button:not(:disabled){border-color:var(--mdc-outlined-button-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button:disabled{border-color:var(--mdc-outlined-button-disabled-outline-color, rgba(0, 0, 0, 0.12))}.mat-mdc-outlined-button.mdc-button--icon-trailing{padding:0 11px 0 15px}.mat-mdc-outlined-button.mdc-button--icon-leading{padding:0 15px 0 11px}.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:var(--mdc-outlined-button-outline-width, 1px)}.mat-mdc-outlined-button .mdc-button__touch{left:calc(-1 * var(--mdc-outlined-button-outline-width, 1px));width:calc(100% + 2 * var(--mdc-outlined-button-outline-width, 1px))}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-button .mat-ripple-element,.mat-mdc-unelevated-button .mat-ripple-element,.mat-mdc-raised-button .mat-ripple-element,.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-button .mdc-button__label,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-outlined-button .mdc-button__label{z-index:1}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button[disabled],.mat-mdc-unelevated-button[disabled],.mat-mdc-raised-button[disabled],.mat-mdc-outlined-button[disabled]{cursor:default;pointer-events:none}.mat-mdc-button .mat-mdc-button-touch-target,.mat-mdc-unelevated-button .mat-mdc-button-touch-target,.mat-mdc-raised-button .mat-mdc-button-touch-target,.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%)}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}[dir=rtl] .mat-mdc-button>.mat-icon,.mat-mdc-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}.mat-mdc-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon,.mat-mdc-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:0;margin-right:8px}.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{margin-left:0;margin-right:8px;display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem;margin-left:-4px;margin-right:8px}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:0}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon,[dir=rtl] .mat-mdc-raised-button>.mat-icon,[dir=rtl] .mat-mdc-outlined-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon[dir=rtl],.mat-mdc-raised-button>.mat-icon[dir=rtl],.mat-mdc-outlined-button>.mat-icon[dir=rtl]{margin-left:8px;margin-right:-4px}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon,.mat-mdc-raised-button .mdc-button__label+.mat-icon,.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-left:8px;margin-right:-4px}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon,.mat-mdc-unelevated-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-raised-button .mdc-button__label+.mat-icon[dir=rtl],.mat-mdc-outlined-button .mdc-button__label+.mat-icon[dir=rtl]{margin-left:-4px;margin-right:8px}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px;border-width:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px) * -1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),kk=(()=>{class n extends Ak{constructor(e,i,o,c){super(e,i,o,c)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Wo),ve(Pn),ve(Bh,8))},n.\u0275cmp=mi({type:n,selectors:[["button","mat-icon-button",""]],hostVars:7,hostBindings:function(e,i){2&e&&(Ze("disabled",i.disabled||null),vr("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-unthemed",!i.color)("mat-mdc-button-base",!0))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[Zn],attrs:xj,ngContentSelectors:wj,decls:5,vars:3,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-mdc-focus-indicator"],["matRipple","",1,"mat-mdc-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-mdc-button-touch-target"]],template:function(e,i){1&e&&(Dl(),It(0,"span",0),yr(1),It(2,"span",1)(3,"span",2)(4,"span",3)),2&e&&(Et(3),ht("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",!0)("matRippleTrigger",i._elementRef.nativeElement))},dependencies:[hx],styles:['.mdc-icon-button{font-size:24px;width:48px;height:48px;padding:12px}.mdc-icon-button .mdc-icon-button__focus-ring{max-height:48px;max-width:48px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__ripple{width:40px;height:40px;margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-icon-button.mdc-icon-button--reduced-size .mdc-icon-button__focus-ring{max-height:40px;max-width:40px}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mdc-icon-button svg,.mdc-icon-button img{width:24px;height:24px}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;user-select:none;z-index:0;overflow:visible}.mdc-icon-button .mdc-icon-button__touch{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}@media screen and (forced-colors: active){.mdc-icon-button.mdc-ripple-upgraded--background-focused .mdc-icon-button__focus-ring,.mdc-icon-button:not(.mdc-ripple-upgraded):focus .mdc-icon-button__focus-ring{display:block}}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button[hidden]{display:none}.mdc-icon-button--display-flex{align-items:center;display:inline-flex;justify-content:center}.mdc-icon-button__focus-ring{pointer-events:none;border:2px solid rgba(0,0,0,0);border-radius:6px;box-sizing:content-box;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:100%;width:100%;display:none}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring{border-color:CanvasText}}.mdc-icon-button__focus-ring::after{content:"";border:2px solid rgba(0,0,0,0);border-radius:8px;display:block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);height:calc(100% + 4px);width:calc(100% + 4px)}@media screen and (forced-colors: active){.mdc-icon-button__focus-ring::after{border-color:CanvasText}}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}.mdc-icon-button__link{height:100%;left:0;outline:none;position:absolute;top:0;width:100%}.mat-mdc-icon-button{height:var(--mdc-icon-button-state-layer-size, 48px);width:var(--mdc-icon-button-state-layer-size, 48px);color:var(--mdc-icon-button-icon-color, inherit);border-radius:50%;flex-shrink:0;text-align:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mdc-button__icon{font-size:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button svg,.mat-mdc-icon-button img{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px)}.mat-mdc-icon-button:disabled{opacity:var(--mdc-icon-button-disabled-icon-opacity, 0.38)}.mat-mdc-icon-button:disabled{color:var(--mdc-icon-button-disabled-icon-color, #000)}.mat-mdc-icon-button svg{vertical-align:baseline}.mat-mdc-icon-button[disabled]{cursor:default;pointer-events:none;opacity:1}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0;background-color:var(--mat-mdc-button-persistent-ripple-color)}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-mdc-button-ripple-color)}.mat-mdc-icon-button .mdc-button__label{z-index:1}.mat-mdc-icon-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0}),n})(),Sj=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma,Ek,ma]}),n})();class Pk{}class Tj{}const Bd="*";function Ky(n,t){return{type:7,name:n,definitions:t,options:{}}}function _f(n,t=null){return{type:4,styles:t,timings:n}}function Rk(n,t=null){return{type:2,steps:n,options:t}}function rl(n){return{type:6,styles:n,offset:null}}function px(n,t,e){return{type:0,name:n,styles:t,options:e}}function Fk(n){return{type:5,steps:n}}function Qh(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function Aj(n=null){return{type:9,options:n}}function Ij(n,t,e=null){return{type:11,selector:n,animation:t,options:e}}function Ok(n){Promise.resolve().then(n)}class Qy{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Ok(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Lk{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,o=0;const c=this.players.length;0==c?Ok(()=>this._onFinish()):this.players.forEach(f=>{f.onDone(()=>{++e==c&&this._onFinish()}),f.onDestroy(()=>{++i==c&&this._onDestroy()}),f.onStart(()=>{++o==c&&this._onStart()})}),this.totalTime=this.players.reduce((f,v)=>Math.max(f,v.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const o=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(o)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const DE="!",kj=["matFormFieldNotchedOutline",""],Pj=["*"],Rj=["textField"],Fj=["iconPrefixContainer"],Oj=["textPrefixContainer"];function Lj(n,t){1&n&&It(0,"span",19)}function Nj(n,t){if(1&n){const e=Xi();pe(0,"label",17),mn("cdkObserveContent",function(){return uo(e),Kr(ri(2)._refreshOutlineNotchWidth())}),yr(1,1),$t(2,Lj,1,0,"span",18),xe()}if(2&n){const e=ri(2);ht("floating",e._shouldLabelFloat())("cdkObserveContentDisabled",!e._hasOutline())("id",e._labelId),Ze("for",e._control.id)("aria-owns",e._control.id),Et(2),ht("ngIf",!e.hideRequiredMarker&&e._control.required)}}function Bj(n,t){1&n&&$t(0,Nj,3,6,"label",16),2&n&&ht("ngIf",ri()._hasFloatingLabel())}function zj(n,t){1&n&&It(0,"div",20)}function Vj(n,t){}function Uj(n,t){1&n&&$t(0,Vj,0,0,"ng-template",22),2&n&&(ri(2),ht("ngTemplateOutlet",Ii(1)))}function jj(n,t){if(1&n&&(pe(0,"div",21),$t(1,Uj,1,1,"ng-template",9),xe()),2&n){const e=ri();ht("matFormFieldNotchedOutlineOpen",e._shouldLabelFloat())("matFormFieldNotchedOutlineLabelWidth",e._labelWidth),Et(1),ht("ngIf",!e._forceDisplayInfixLabel())}}function $j(n,t){1&n&&(pe(0,"div",23,24),yr(2,2),xe())}function Hj(n,t){1&n&&(pe(0,"div",25,26),yr(2,3),xe())}function Gj(n,t){}function qj(n,t){1&n&&$t(0,Gj,0,0,"ng-template",22),2&n&&(ri(),ht("ngTemplateOutlet",Ii(1)))}function Wj(n,t){1&n&&(pe(0,"div",27),yr(1,4),xe())}function Zj(n,t){1&n&&(pe(0,"div",28),yr(1,5),xe())}function Yj(n,t){1&n&&It(0,"div",29)}function Xj(n,t){1&n&&(pe(0,"div",30),yr(1,6),xe()),2&n&&ht("@transitionMessages",ri()._subscriptAnimationState)}function Kj(n,t){if(1&n&&(pe(0,"mat-hint",34),Qe(1),xe()),2&n){const e=ri(2);ht("id",e._hintLabelId),Et(1),ms(e.hintLabel)}}function Qj(n,t){if(1&n&&(pe(0,"div",31),$t(1,Kj,2,2,"mat-hint",32),yr(2,7),It(3,"div",33),yr(4,8),xe()),2&n){const e=ri();ht("@transitionMessages",e._subscriptAnimationState),Et(1),ht("ngIf",e.hintLabel)}}const Jj=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],e6=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];let ME=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["mat-label"]]}),n})();const t6=new wt("MatError");let n6=0,SE=(()=>{class n{constructor(){this.align="start",this.id="mat-mdc-hint-"+n6++}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(e,i){2&e&&(Fm("id",i.id),Ze("align",null),vr("mat-mdc-form-field-hint-end","end"===i.align))},inputs:{align:"align",id:"id"}}),n})();const i6=new wt("MatPrefix"),Nk=new wt("MatSuffix");let r6=(()=>{class n{constructor(){this._isText=!1}set _isTextSelector(e){this._isText=!0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:["matTextSuffix","_isTextSelector"]},features:[Ki([{provide:Nk,useExisting:n}])]}),n})(),Bk=(()=>{class n{constructor(e){this._elementRef=e,this.floating=!1}getWidth(){return function o6(n){if(null!==n.offsetParent)return n.scrollWidth;const e=n.cloneNode(!0);e.style.setProperty("position","absolute"),e.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(e);const i=e.scrollWidth;return e.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}}return n.\u0275fac=function(e){return new(e||n)(ve(_i))},n.\u0275dir=Vt({type:n,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(e,i){2&e&&vr("mdc-floating-label--float-above",i.floating)},inputs:{floating:"floating"}}),n})();const zk="mdc-line-ripple--active",fx="mdc-line-ripple--deactivating";let Vk=(()=>{class n{constructor(e,i){this._elementRef=e,this._handleTransitionEnd=o=>{const c=this._elementRef.nativeElement.classList,f=c.contains(fx);"opacity"===o.propertyName&&f&&c.remove(zk,fx)},i.runOutsideAngular(()=>{e.nativeElement.addEventListener("transitionend",this._handleTransitionEnd)})}activate(){const e=this._elementRef.nativeElement.classList;e.remove(fx),e.add(zk)}deactivate(){this._elementRef.nativeElement.classList.add(fx)}ngOnDestroy(){this._elementRef.nativeElement.removeEventListener("transitionend",this._handleTransitionEnd)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Pn))},n.\u0275dir=Vt({type:n,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]}),n})(),Uk=(()=>{class n{constructor(e,i){this._elementRef=e,this._ngZone=i,this.labelWidth=0,this.open=!1}ngAfterViewInit(){const e=this._elementRef.nativeElement.querySelector(".mdc-floating-label");e?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(e.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>e.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_getNotchWidth(){return this.open?this.labelWidth>0?`calc(${this.labelWidth}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:"0px":null}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Pn))},n.\u0275cmp=mi({type:n,selectors:[["div","matFormFieldNotchedOutline",""]],hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(e,i){2&e&&vr("mdc-notched-outline--notched",i.open)},inputs:{labelWidth:["matFormFieldNotchedOutlineLabelWidth","labelWidth"],open:["matFormFieldNotchedOutlineOpen","open"]},attrs:kj,ngContentSelectors:Pj,decls:4,vars:2,consts:[[1,"mdc-notched-outline__leading"],[1,"mdc-notched-outline__notch"],[1,"mdc-notched-outline__trailing"]],template:function(e,i){1&e&&(Dl(),It(0,"div",0),pe(1,"div",1),yr(2),xe(),It(3,"div",2)),2&e&&(Et(1),Kp("width",i._getNotchWidth()))},encapsulation:2,changeDetection:0}),n})();const s6={transitionMessages:Ky("transitionMessages",[px("enter",rl({opacity:1,transform:"translateY(0%)"})),Qh("void => enter",[rl({opacity:0,transform:"translateY(-5px)"}),_f("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let TE=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n}),n})();const mx=new wt("MatFormField"),a6=new wt("MAT_FORM_FIELD_DEFAULT_OPTIONS");let jk=0,u6=(()=>{class n{get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(e){this._hideRequiredMarker=xr(e)}get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(e){e!==this._floatLabel&&(this._floatLabel=e,this._changeDetectorRef.markForCheck())}get appearance(){return this._appearance}set appearance(e){const i=this._appearance;this._appearance=e||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._refreshOutlineNotchWidth(),this._needsOutlineLabelOffsetUpdateOnStable=!0)}get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(e){this._subscriptSizing=e||this._defaults?.subscriptSizing||"fixed"}get hintLabel(){return this._hintLabel}set hintLabel(e){this._hintLabel=e,this._processHints()}get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(e){this._explicitFormFieldControl=e}constructor(e,i,o,c,f,v,C,S){this._elementRef=e,this._changeDetectorRef=i,this._ngZone=o,this._dir=c,this._platform=f,this._defaults=v,this._animationMode=C,this._document=S,this._hideRequiredMarker=!1,this.color="primary",this._appearance="fill",this._subscriptSizing=null,this._hintLabel="",this._hasIconPrefix=!1,this._hasTextPrefix=!1,this._hasIconSuffix=!1,this._hasTextSuffix=!1,this._labelId="mat-mdc-form-field-label-"+jk++,this._hintLabelId="mat-mdc-hint-"+jk++,this._subscriptAnimationState="",this._labelWidth=0,this._destroyed=new yn,this._isFocused=null,this._needsOutlineLabelOffsetUpdateOnStable=!1,v&&(v.appearance&&(this.appearance=v.appearance),this._hideRequiredMarker=Boolean(v?.hideRequiredMarker),v.color&&(this.color=v.color))}ngAfterViewInit(){this._updateFocusState(),this._refreshOutlineNotchWidth(),this._document?.fonts?.ready?this._document.fonts.ready.then(()=>{this._refreshOutlineNotchWidth(),this._changeDetectorRef.markForCheck()}):setTimeout(()=>this._refreshOutlineNotchWidth(),100),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(){const e=this._control;e.controlType&&this._elementRef.nativeElement.classList.add(`mat-mdc-form-field-type-${e.controlType}`),e.stateChanges.subscribe(()=>{this._updateFocusState(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),e.ngControl&&e.ngControl.valueChanges&&e.ngControl.valueChanges.pipe(il(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck())}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(e=>!e._isText),this._hasTextPrefix=!!this._prefixChildren.find(e=>e._isText),this._hasIconSuffix=!!this._suffixChildren.find(e=>!e._isText),this._hasTextSuffix=!!this._suffixChildren.find(e=>e._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),qr(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(il(this._destroyed)).subscribe(()=>{this._needsOutlineLabelOffsetUpdateOnStable&&(this._needsOutlineLabelOffsetUpdateOnStable=!1,this._updateOutlineLabelOffset())})}),this._dir.change.pipe(il(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdateOnStable=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel(){return!!this._labelChildNonStatic||!!this._labelChildStatic}_shouldLabelFloat(){return this._control.shouldLabelFloat||this._shouldAlwaysFloat()}_shouldForward(e){const i=this._control?this._control.ngControl:null;return i&&i[e]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_refreshOutlineNotchWidth(){!this._hasOutline()||!this._floatingLabel||(this._labelWidth=this._floatingLabel.getWidth())}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let e=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&e.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(c=>"start"===c.align):null,o=this._hintChildren?this._hintChildren.find(c=>"end"===c.align):null;i?e.push(i.id):this._hintLabel&&e.push(this._hintLabelId),o&&e.push(o.id)}else this._errorChildren&&e.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(e)}}_updateOutlineLabelOffset(){if(!this._platform.isBrowser||!this._hasOutline()||!this._floatingLabel)return;const e=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(e.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdateOnStable=!0);const i=this._iconPrefixContainer?.nativeElement,o=this._textPrefixContainer?.nativeElement,c=i?.getBoundingClientRect().width??0,f=o?.getBoundingClientRect().width??0;e.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${c+f}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`}_isAttachedToDom(){const e=this._elementRef.nativeElement;if(e.getRootNode){const i=e.getRootNode();return i&&i!==e}return document.documentElement.contains(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(pa),ve(Pn),ve(gu),ve(Wo),ve(a6,8),ve(Bh,8),ve(ai))},n.\u0275cmp=mi({type:n,selectors:[["mat-form-field"]],contentQueries:function(e,i,o){if(1&e&&(Ml(o,ME,5),Ml(o,ME,7),Ml(o,TE,5),Ml(o,i6,5),Ml(o,Nk,5),Ml(o,t6,5),Ml(o,SE,5)),2&e){let c;Gi(c=qi())&&(i._labelChildNonStatic=c.first),Gi(c=qi())&&(i._labelChildStatic=c.first),Gi(c=qi())&&(i._formFieldControl=c.first),Gi(c=qi())&&(i._prefixChildren=c),Gi(c=qi())&&(i._suffixChildren=c),Gi(c=qi())&&(i._errorChildren=c),Gi(c=qi())&&(i._hintChildren=c)}},viewQuery:function(e,i){if(1&e&&(mo(Rj,5),mo(Fj,5),mo(Oj,5),mo(Bk,5),mo(Uk,5),mo(Vk,5)),2&e){let o;Gi(o=qi())&&(i._textField=o.first),Gi(o=qi())&&(i._iconPrefixContainer=o.first),Gi(o=qi())&&(i._textPrefixContainer=o.first),Gi(o=qi())&&(i._floatingLabel=o.first),Gi(o=qi())&&(i._notchedOutline=o.first),Gi(o=qi())&&(i._lineRipple=o.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(e,i){2&e&&vr("mat-mdc-form-field-label-always-float",i._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",i._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",i._hasIconSuffix)("mat-form-field-invalid",i._control.errorState)("mat-form-field-disabled",i._control.disabled)("mat-form-field-autofilled",i._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===i._animationMode)("mat-form-field-appearance-fill","fill"==i.appearance)("mat-form-field-appearance-outline","outline"==i.appearance)("mat-form-field-hide-placeholder",i._hasFloatingLabel()&&!i._shouldLabelFloat())("mat-focused",i._control.focused)("mat-primary","accent"!==i.color&&"warn"!==i.color)("mat-accent","accent"===i.color)("mat-warn","warn"===i.color)("ng-untouched",i._shouldForward("untouched"))("ng-touched",i._shouldForward("touched"))("ng-pristine",i._shouldForward("pristine"))("ng-dirty",i._shouldForward("dirty"))("ng-valid",i._shouldForward("valid"))("ng-invalid",i._shouldForward("invalid"))("ng-pending",i._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Ki([{provide:mx,useExisting:n}])],ngContentSelectors:e6,decls:18,vars:23,consts:[["labelTemplate",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],["textField",""],["class","mat-mdc-form-field-focus-overlay",4,"ngIf"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth",4,"ngIf"],["class","mat-mdc-form-field-icon-prefix",4,"ngIf"],["class","mat-mdc-form-field-text-prefix",4,"ngIf"],[1,"mat-mdc-form-field-infix"],[3,"ngIf"],["class","mat-mdc-form-field-text-suffix",4,"ngIf"],["class","mat-mdc-form-field-icon-suffix",4,"ngIf"],["matFormFieldLineRipple","",4,"ngIf"],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align",3,"ngSwitch"],["class","mat-mdc-form-field-error-wrapper",4,"ngSwitchCase"],["class","mat-mdc-form-field-hint-wrapper",4,"ngSwitchCase"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent",4,"ngIf"],["matFormFieldFloatingLabel","",3,"floating","cdkObserveContentDisabled","id","cdkObserveContent"],["aria-hidden","true","class","mat-mdc-form-field-required-marker mdc-floating-label--required",4,"ngIf"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[1,"mat-mdc-form-field-focus-overlay"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen","matFormFieldNotchedOutlineLabelWidth"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-icon-prefix"],["iconPrefixContainer",""],[1,"mat-mdc-form-field-text-prefix"],["textPrefixContainer",""],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],[3,"id",4,"ngIf"],[1,"mat-mdc-form-field-hint-spacer"],[3,"id"]],template:function(e,i){1&e&&(Dl(Jj),$t(0,Bj,1,1,"ng-template",null,0,cS),pe(2,"div",1,2),mn("click",function(c){return i._control.onContainerClick&&i._control.onContainerClick(c)}),$t(4,zj,1,0,"div",3),pe(5,"div",4),$t(6,jj,2,3,"div",5),$t(7,$j,3,0,"div",6),$t(8,Hj,3,0,"div",7),pe(9,"div",8),$t(10,qj,1,1,"ng-template",9),yr(11),xe(),$t(12,Wj,2,0,"div",10),$t(13,Zj,2,0,"div",11),xe(),$t(14,Yj,1,0,"div",12),xe(),pe(15,"div",13),$t(16,Xj,2,1,"div",14),$t(17,Qj,5,2,"div",15),xe()),2&e&&(Et(2),vr("mdc-text-field--filled",!i._hasOutline())("mdc-text-field--outlined",i._hasOutline())("mdc-text-field--no-label",!i._hasFloatingLabel())("mdc-text-field--disabled",i._control.disabled)("mdc-text-field--invalid",i._control.errorState),Et(2),ht("ngIf",!i._hasOutline()&&!i._control.disabled),Et(2),ht("ngIf",i._hasOutline()),Et(1),ht("ngIf",i._hasIconPrefix),Et(1),ht("ngIf",i._hasTextPrefix),Et(2),ht("ngIf",!i._hasOutline()||i._forceDisplayInfixLabel()),Et(2),ht("ngIf",i._hasTextSuffix),Et(1),ht("ngIf",i._hasIconSuffix),Et(1),ht("ngIf",!i._hasOutline()),Et(1),vr("mat-mdc-form-field-subscript-dynamic-size","dynamic"===i.subscriptSizing),ht("ngSwitch",i._getDisplayedMessages()),Et(1),ht("ngSwitchCase","error"),Et(1),ht("ngSwitchCase","hint"))},dependencies:[hy,ET,nf,py,m4,SE,Bk,Uk,Vk],styles:['.mdc-text-field{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{height:28px;width:100%;min-width:0;border:none;border-radius:0;background:none;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{opacity:0}}@media all{.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}}@media all{.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}}.mdc-text-field__affix{height:28px;opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens: none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field__affix--prefix,.mdc-text-field__affix--prefix[dir=rtl]{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl]{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field__affix--suffix,.mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl]{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}[dir=rtl] .mdc-text-field--filled .mdc-floating-label,.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens: none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl]{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px, var(--mdc-shape-small, 4px))*2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:var(--mdc-shape-small, 4px);border-bottom-right-radius:var(--mdc-shape-small, 4px);border-bottom-left-radius:0}[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing,.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl]{border-top-left-radius:var(--mdc-shape-small, 4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:var(--mdc-shape-small, 4px)}@supports(top: max(0%)){.mdc-text-field--outlined{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined{padding-right:max(16px, var(--mdc-shape-small, 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}@supports(top: max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px, var(--mdc-shape-small, 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-right:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon,.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:max(16px, var(--mdc-shape-small, 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top: max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0}@supports(top: max(0%)){[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon,.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl]{padding-right:max(16px, calc(var(--mdc-shape-small, 4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(0.75)}.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer,.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl]{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter{transform:translateX(1px) translateY(1px)}[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl]{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}[dir=rtl] .mdc-text-field--with-leading-icon,.mdc-text-field--with-leading-icon[dir=rtl]{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl]{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl]{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(0.75)}[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl]{transform:translateY(-34.75px) translateX(32px) scale(0.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}[dir=rtl] .mdc-text-field--with-trailing-icon,.mdc-text-field--with-trailing-icon[dir=rtl]{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 64px / 0.75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 96px / 0.75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}@media screen and (forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl]{text-align:left}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix{direction:ltr}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading{order:1}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix{order:2}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input{order:3}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix{order:4}[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing{order:5}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input{text-align:right}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix{padding-right:12px}[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix,.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix{padding-left:2px}.mdc-floating-label{position:absolute;left:0;-webkit-transform-origin:left top;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label,.mdc-floating-label[dir=rtl]{right:0;left:auto;-webkit-transform-origin:right top;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0px;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after,.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)[dir=rtl]::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline,.mdc-notched-outline[dir=rtl]{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}[dir=rtl] .mdc-notched-outline__leading,.mdc-notched-outline__leading[dir=rtl]{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}[dir=rtl] .mdc-notched-outline__trailing,.mdc-notched-outline__trailing[dir=rtl]{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch,.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl]{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px}.mdc-line-ripple::after{border-bottom-width:2px}.mdc-line-ripple::before{z-index:1}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{line-height:normal;pointer-events:all}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-text-field-wrapper::before{content:none}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}.cdk-high-contrast-active .mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:12px;box-sizing:content-box}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}}@media all{.mdc-text-field--no-label .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__affix{transition:opacity 150ms 0ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea{transition:none}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-10.25px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-10.25px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-10.25px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-24.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-24.75px) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-24.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(0.75)}}[dir=rtl] .mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake,.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(0.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}33%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(calc(4% - 0%)) translateY(-106%) scale(0.75)}66%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(calc(-4% - 0%)) translateY(-106%) scale(0.75)}100%{transform:translateX(calc(0 - 0%)) translateY(-106%) scale(0.75)}}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}'],encapsulation:2,data:{animation:[s6.transitionMessages]},changeDetection:0}),n})(),gx=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma,jm,A2,ma]}),n})();const Gk=jy({passive:!0});let d6=(()=>{class n{constructor(e,i){this._platform=e,this._ngZone=i,this._monitoredElements=new Map}monitor(e){if(!this._platform.isBrowser)return Ft;const i=Nd(e),o=this._monitoredElements.get(i);if(o)return o.subject;const c=new yn,f="cdk-text-field-autofilled",v=C=>{"cdk-text-field-autofill-start"!==C.animationName||i.classList.contains(f)?"cdk-text-field-autofill-end"===C.animationName&&i.classList.contains(f)&&(i.classList.remove(f),this._ngZone.run(()=>c.next({target:C.target,isAutofilled:!1}))):(i.classList.add(f),this._ngZone.run(()=>c.next({target:C.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",v,Gk),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:c,unlisten:()=>{i.removeEventListener("animationstart",v,Gk)}}),c}stopMonitoring(e){const i=Nd(e),o=this._monitoredElements.get(i);o&&(o.unlisten(),o.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((e,i)=>this.stopMonitoring(i))}}return n.\u0275fac=function(e){return new(e||n)(We(Wo),We(Pn))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),h6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const qk=new wt("MAT_INPUT_VALUE_ACCESSOR"),p6=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let f6=0;const m6=_k(class{constructor(n,t,e,i){this._defaultErrorStateMatcher=n,this._parentForm=t,this._parentFormGroup=e,this.ngControl=i,this.stateChanges=new yn}});let g6=(()=>{class n extends m6{get disabled(){return this._disabled}set disabled(e){this._disabled=xr(e),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(e){this._id=e||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(BC.required)??!1}set required(e){this._required=xr(e)}get type(){return this._type}set type(e){this._type=e||"text",this._validateType(),!this._isTextarea&&x2().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(e){e!==this.value&&(this._inputValueAccessor.value=e,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(e){this._readonly=xr(e)}constructor(e,i,o,c,f,v,C,S,R,V){super(v,c,f,o),this._elementRef=e,this._platform=i,this._autofillMonitor=S,this._formField=V,this._uid="mat-input-"+f6++,this.focused=!1,this.stateChanges=new yn,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(me=>x2().has(me)),this._iOSKeyupListener=me=>{const Ee=me.target;!Ee.value&&0===Ee.selectionStart&&0===Ee.selectionEnd&&(Ee.setSelectionRange(1,1),Ee.setSelectionRange(0,0))};const Q=this._elementRef.nativeElement,oe=Q.nodeName.toLowerCase();this._inputValueAccessor=C||Q,this._previousNativeValue=this.value,this.id=this.id,i.IOS&&R.runOutsideAngular(()=>{e.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===oe,this._isTextarea="textarea"===oe,this._isInFormField=!!V,this._isNativeSelect&&(this.controlType=Q.multiple?"mat-native-select-multiple":"mat-native-select")}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(e=>{this.autofilled=e.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(e){this._elementRef.nativeElement.focus(e)}_focusChanged(e){e!==this.focused&&(this.focused=e,this.stateChanges.next())}_onInput(){}_dirtyCheckNativeValue(){const e=this._elementRef.nativeElement.value;this._previousNativeValue!==e&&(this._previousNativeValue=e,this.stateChanges.next())}_dirtyCheckPlaceholder(){const e=this._getPlaceholder();if(e!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=e,e?i.setAttribute("placeholder",e):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){p6.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let e=this._elementRef.nativeElement.validity;return e&&e.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const e=this._elementRef.nativeElement,i=e.options[0];return this.focused||e.multiple||!this.empty||!!(e.selectedIndex>-1&&i&&i.label)}return this.focused||!this.empty}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const e=this._elementRef.nativeElement;return this._isNativeSelect&&(e.multiple||e.size>1)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Wo),ve(Xu,10),ve(hf,8),ve(Vy,8),ve(yk),ve(qk,10),ve(d6),ve(Pn),ve(mx,8))},n.\u0275dir=Vt({type:n,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:18,hostBindings:function(e,i){1&e&&mn("focus",function(){return i._focusChanged(!0)})("blur",function(){return i._focusChanged(!1)})("input",function(){return i._onInput()}),2&e&&(Fm("id",i.id)("disabled",i.disabled)("required",i.required),Ze("name",i.name||null)("readonly",i.readonly&&!i._isNativeSelect||null)("aria-invalid",i.empty&&i.required?null:i.errorState)("aria-required",i.required)("id",i.id),vr("mat-input-server",i._isServer)("mat-mdc-form-field-textarea-control",i._isInFormField&&i._isTextarea)("mat-mdc-form-field-input-control",i._isInFormField)("mdc-text-field__input",i._isInFormField)("mat-mdc-native-select-inline",i._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[Ki([{provide:TE,useExisting:n}]),Zn,tr]}),n})(),_6=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma,gx,gx,h6,ma]}),n})();const y6=["mat-calendar-body",""];function v6(n,t){if(1&n&&(pe(0,"tr",3)(1,"td",4),Qe(2),xe()()),2&n){const e=ri();Et(1),Kp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Ze("colspan",e.numCols),Et(1),uu(" ",e.label," ")}}function b6(n,t){if(1&n&&(pe(0,"td",4),Qe(1),xe()),2&n){const e=ri(2);Kp("padding-top",e._cellPadding)("padding-bottom",e._cellPadding),Ze("colspan",e._firstRowOffset),Et(1),uu(" ",e._firstRowOffset>=e.labelMinRequiredCells?e.label:""," ")}}function x6(n,t){if(1&n){const e=Xi();pe(0,"td",8)(1,"button",9),mn("click",function(o){const f=uo(e).$implicit;return Kr(ri(2)._cellClicked(f,o))})("focus",function(o){const f=uo(e).$implicit;return Kr(ri(2)._emitActiveDateChange(f,o))}),pe(2,"span",10),Qe(3),xe(),It(4,"span",11),xe()()}if(2&n){const e=t.$implicit,i=t.index,o=ri().index,c=ri();Kp("width",c._cellWidth)("padding-top",c._cellPadding)("padding-bottom",c._cellPadding),Ze("data-mat-row",o)("data-mat-col",i),Et(1),vr("mat-calendar-body-disabled",!e.enabled)("mat-calendar-body-active",c._isActiveCell(o,i))("mat-calendar-body-range-start",c._isRangeStart(e.compareValue))("mat-calendar-body-range-end",c._isRangeEnd(e.compareValue))("mat-calendar-body-in-range",c._isInRange(e.compareValue))("mat-calendar-body-comparison-bridge-start",c._isComparisonBridgeStart(e.compareValue,o,i))("mat-calendar-body-comparison-bridge-end",c._isComparisonBridgeEnd(e.compareValue,o,i))("mat-calendar-body-comparison-start",c._isComparisonStart(e.compareValue))("mat-calendar-body-comparison-end",c._isComparisonEnd(e.compareValue))("mat-calendar-body-in-comparison-range",c._isInComparisonRange(e.compareValue))("mat-calendar-body-preview-start",c._isPreviewStart(e.compareValue))("mat-calendar-body-preview-end",c._isPreviewEnd(e.compareValue))("mat-calendar-body-in-preview",c._isInPreview(e.compareValue)),ht("ngClass",e.cssClasses)("tabindex",c._isActiveCell(o,i)?0:-1),Ze("aria-label",e.ariaLabel)("aria-disabled",!e.enabled||null)("aria-pressed",c._isSelected(e.compareValue))("aria-current",c.todayValue===e.compareValue?"date":null)("aria-describedby",c._getDescribedby(e.compareValue)),Et(1),vr("mat-calendar-body-selected",c._isSelected(e.compareValue))("mat-calendar-body-comparison-identical",c._isComparisonIdentical(e.compareValue))("mat-calendar-body-today",c.todayValue===e.compareValue),Et(1),uu(" ",e.displayValue," ")}}function w6(n,t){if(1&n&&(pe(0,"tr",5),$t(1,b6,2,6,"td",6),$t(2,x6,5,48,"td",7),xe()),2&n){const e=t.$implicit,i=t.index,o=ri();Et(1),ht("ngIf",0===i&&o._firstRowOffset),Et(1),ht("ngForOf",e)}}function C6(n,t){if(1&n&&(pe(0,"th",5)(1,"span",6),Qe(2),xe(),pe(3,"span",7),Qe(4),xe()()),2&n){const e=t.$implicit;Et(2),ms(e.long),Et(2),ms(e.narrow)}}const E6=["*"];function D6(n,t){}function M6(n,t){if(1&n){const e=Xi();pe(0,"mat-month-view",5),mn("activeDateChange",function(o){return uo(e),Kr(ri().activeDate=o)})("_userSelection",function(o){return uo(e),Kr(ri()._dateSelected(o))})("dragStarted",function(o){return uo(e),Kr(ri()._dragStarted(o))})("dragEnded",function(o){return uo(e),Kr(ri()._dragEnded(o))}),xe()}if(2&n){const e=ri();ht("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)("comparisonStart",e.comparisonStart)("comparisonEnd",e.comparisonEnd)("startDateAccessibleName",e.startDateAccessibleName)("endDateAccessibleName",e.endDateAccessibleName)("activeDrag",e._activeDrag)}}function S6(n,t){if(1&n){const e=Xi();pe(0,"mat-year-view",6),mn("activeDateChange",function(o){return uo(e),Kr(ri().activeDate=o)})("monthSelected",function(o){return uo(e),Kr(ri()._monthSelectedInYearView(o))})("selectedChange",function(o){return uo(e),Kr(ri()._goToDateInView(o,"month"))}),xe()}if(2&n){const e=ri();ht("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function T6(n,t){if(1&n){const e=Xi();pe(0,"mat-multi-year-view",7),mn("activeDateChange",function(o){return uo(e),Kr(ri().activeDate=o)})("yearSelected",function(o){return uo(e),Kr(ri()._yearSelectedInMultiYearView(o))})("selectedChange",function(o){return uo(e),Kr(ri()._goToDateInView(o,"year"))}),xe()}if(2&n){const e=ri();ht("activeDate",e.activeDate)("selected",e.selected)("dateFilter",e.dateFilter)("maxDate",e.maxDate)("minDate",e.minDate)("dateClass",e.dateClass)}}function A6(n,t){}const I6=["button"];function k6(n,t){1&n&&(q(),pe(0,"svg",3),It(1,"path",4),xe())}const P6=[[["","matDatepickerToggleIcon",""]]],R6=["[matDatepickerToggleIcon]"];let Jy=(()=>{class n{constructor(){this.changes=new yn,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(e,i){return`${e} \u2013 ${i}`}formatYearRangeLabel(e,i){return`${e} to ${i}`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class AE{constructor(t,e,i,o,c={},f=t,v){this.value=t,this.displayValue=e,this.ariaLabel=i,this.enabled=o,this.cssClasses=c,this.compareValue=f,this.rawValue=v}}let F6=1,ag=(()=>{class n{ngAfterViewChecked(){this._focusActiveCellAfterViewChecked&&(this._focusActiveCell(),this._focusActiveCellAfterViewChecked=!1)}constructor(e,i){this._elementRef=e,this._ngZone=i,this._platform=bn(Wo),this._focusActiveCellAfterViewChecked=!1,this.numCols=7,this.activeCell=0,this.isRange=!1,this.cellAspectRatio=1,this.previewStart=null,this.previewEnd=null,this.selectedValueChange=new on,this.previewChange=new on,this.activeDateChange=new on,this.dragStarted=new on,this.dragEnded=new on,this._didDragSinceMouseDown=!1,this._enterHandler=o=>{if(this._skipNextFocus&&"focus"===o.type)this._skipNextFocus=!1;else if(o.target&&this.isRange){const c=this._getCellFromElement(o.target);c&&this._ngZone.run(()=>this.previewChange.emit({value:c.enabled?c:null,event:o}))}},this._touchmoveHandler=o=>{if(!this.isRange)return;const c=Wk(o),f=c?this._getCellFromElement(c):null;c!==o.target&&(this._didDragSinceMouseDown=!0),kE(o.target)&&o.preventDefault(),this._ngZone.run(()=>this.previewChange.emit({value:f?.enabled?f:null,event:o}))},this._leaveHandler=o=>{null!==this.previewEnd&&this.isRange&&("blur"!==o.type&&(this._didDragSinceMouseDown=!0),o.target&&this._getCellFromElement(o.target)&&(!o.relatedTarget||!this._getCellFromElement(o.relatedTarget))&&this._ngZone.run(()=>this.previewChange.emit({value:null,event:o})))},this._mousedownHandler=o=>{if(!this.isRange)return;this._didDragSinceMouseDown=!1;const c=o.target&&this._getCellFromElement(o.target);!c||!this._isInRange(c.rawValue)||this._ngZone.run(()=>{this.dragStarted.emit({value:c.rawValue,event:o})})},this._mouseupHandler=o=>{if(!this.isRange)return;const c=kE(o.target);c?c.closest(".mat-calendar-body")===this._elementRef.nativeElement&&this._ngZone.run(()=>{const f=this._getCellFromElement(c);this.dragEnded.emit({value:f?.rawValue??null,event:o})}):this._ngZone.run(()=>{this.dragEnded.emit({value:null,event:o})})},this._touchendHandler=o=>{const c=Wk(o);c&&this._mouseupHandler({target:c})},this._id="mat-calendar-body-"+F6++,this._startDateLabelId=`${this._id}-start-date`,this._endDateLabelId=`${this._id}-end-date`,i.runOutsideAngular(()=>{const o=e.nativeElement;o.addEventListener("mouseenter",this._enterHandler,!0),o.addEventListener("touchmove",this._touchmoveHandler,!0),o.addEventListener("focus",this._enterHandler,!0),o.addEventListener("mouseleave",this._leaveHandler,!0),o.addEventListener("blur",this._leaveHandler,!0),o.addEventListener("mousedown",this._mousedownHandler),o.addEventListener("touchstart",this._mousedownHandler),this._platform.isBrowser&&(window.addEventListener("mouseup",this._mouseupHandler),window.addEventListener("touchend",this._touchendHandler))})}_cellClicked(e,i){this._didDragSinceMouseDown||e.enabled&&this.selectedValueChange.emit({value:e.value,event:i})}_emitActiveDateChange(e,i){e.enabled&&this.activeDateChange.emit({value:e.value,event:i})}_isSelected(e){return this.startValue===e||this.endValue===e}ngOnChanges(e){const i=e.numCols,{rows:o,numCols:c}=this;(e.rows||i)&&(this._firstRowOffset=o&&o.length&&o[0].length?c-o[0].length:0),(e.cellAspectRatio||i||!this._cellPadding)&&(this._cellPadding=50*this.cellAspectRatio/c+"%"),(i||!this._cellWidth)&&(this._cellWidth=100/c+"%")}ngOnDestroy(){const e=this._elementRef.nativeElement;e.removeEventListener("mouseenter",this._enterHandler,!0),e.removeEventListener("touchmove",this._touchmoveHandler,!0),e.removeEventListener("focus",this._enterHandler,!0),e.removeEventListener("mouseleave",this._leaveHandler,!0),e.removeEventListener("blur",this._leaveHandler,!0),e.removeEventListener("mousedown",this._mousedownHandler),e.removeEventListener("touchstart",this._mousedownHandler),this._platform.isBrowser&&(window.removeEventListener("mouseup",this._mouseupHandler),window.removeEventListener("touchend",this._touchendHandler))}_isActiveCell(e,i){let o=e*this.numCols+i;return e&&(o-=this._firstRowOffset),o==this.activeCell}_focusActiveCell(e=!0){this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe(ro(1)).subscribe(()=>{setTimeout(()=>{const i=this._elementRef.nativeElement.querySelector(".mat-calendar-body-active");i&&(e||(this._skipNextFocus=!0),i.focus())})})})}_scheduleFocusActiveCellAfterViewChecked(){this._focusActiveCellAfterViewChecked=!0}_isRangeStart(e){return PE(e,this.startValue,this.endValue)}_isRangeEnd(e){return RE(e,this.startValue,this.endValue)}_isInRange(e){return FE(e,this.startValue,this.endValue,this.isRange)}_isComparisonStart(e){return PE(e,this.comparisonStart,this.comparisonEnd)}_isComparisonBridgeStart(e,i,o){if(!this._isComparisonStart(e)||this._isRangeStart(e)||!this._isInRange(e))return!1;let c=this.rows[i][o-1];if(!c){const f=this.rows[i-1];c=f&&f[f.length-1]}return c&&!this._isRangeEnd(c.compareValue)}_isComparisonBridgeEnd(e,i,o){if(!this._isComparisonEnd(e)||this._isRangeEnd(e)||!this._isInRange(e))return!1;let c=this.rows[i][o+1];if(!c){const f=this.rows[i+1];c=f&&f[0]}return c&&!this._isRangeStart(c.compareValue)}_isComparisonEnd(e){return RE(e,this.comparisonStart,this.comparisonEnd)}_isInComparisonRange(e){return FE(e,this.comparisonStart,this.comparisonEnd,this.isRange)}_isComparisonIdentical(e){return this.comparisonStart===this.comparisonEnd&&e===this.comparisonStart}_isPreviewStart(e){return PE(e,this.previewStart,this.previewEnd)}_isPreviewEnd(e){return RE(e,this.previewStart,this.previewEnd)}_isInPreview(e){return FE(e,this.previewStart,this.previewEnd,this.isRange)}_getDescribedby(e){return this.isRange?this.startValue===e&&this.endValue===e?`${this._startDateLabelId} ${this._endDateLabelId}`:this.startValue===e?this._startDateLabelId:this.endValue===e?this._endDateLabelId:null:null}_getCellFromElement(e){const i=kE(e);if(i){const o=i.getAttribute("data-mat-row"),c=i.getAttribute("data-mat-col");if(o&&c)return this.rows[parseInt(o)][parseInt(c)]}return null}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Pn))},n.\u0275cmp=mi({type:n,selectors:[["","mat-calendar-body",""]],hostAttrs:[1,"mat-calendar-body"],inputs:{label:"label",rows:"rows",todayValue:"todayValue",startValue:"startValue",endValue:"endValue",labelMinRequiredCells:"labelMinRequiredCells",numCols:"numCols",activeCell:"activeCell",isRange:"isRange",cellAspectRatio:"cellAspectRatio",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",previewStart:"previewStart",previewEnd:"previewEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedValueChange:"selectedValueChange",previewChange:"previewChange",activeDateChange:"activeDateChange",dragStarted:"dragStarted",dragEnded:"dragEnded"},exportAs:["matCalendarBody"],features:[tr],attrs:y6,decls:6,vars:6,consts:[["aria-hidden","true",4,"ngIf"],["role","row",4,"ngFor","ngForOf"],[1,"mat-calendar-body-hidden-label",3,"id"],["aria-hidden","true"],[1,"mat-calendar-body-label"],["role","row"],["class","mat-calendar-body-label",3,"paddingTop","paddingBottom",4,"ngIf"],["role","gridcell","class","mat-calendar-body-cell-container",3,"width","paddingTop","paddingBottom",4,"ngFor","ngForOf"],["role","gridcell",1,"mat-calendar-body-cell-container"],["type","button",1,"mat-calendar-body-cell",3,"ngClass","tabindex","click","focus"],[1,"mat-calendar-body-cell-content","mat-focus-indicator"],["aria-hidden","true",1,"mat-calendar-body-cell-preview"]],template:function(e,i){1&e&&($t(0,v6,3,6,"tr",0),$t(1,w6,3,2,"tr",1),pe(2,"label",2),Qe(3),xe(),pe(4,"label",2),Qe(5),xe()),2&e&&(ht("ngIf",i._firstRowOffset<i.labelMinRequiredCells),Et(1),ht("ngForOf",i.rows),Et(1),ht("id",i._startDateLabelId),Et(1),uu(" ",i.startDateAccessibleName,"\n"),Et(1),ht("id",i._endDateLabelId),Et(1),uu(" ",i.endDateAccessibleName,"\n"))},dependencies:[dy,Um,hy],styles:['.mat-calendar-body{min-width:224px}.mat-calendar-body-label{height:0;line-height:0;text-align:left;padding-left:4.7142857143%;padding-right:4.7142857143%}.mat-calendar-body-hidden-label{display:none}.mat-calendar-body-cell-container{position:relative;height:0;line-height:0}.mat-calendar-body-cell{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);position:absolute;top:0;left:0;width:100%;height:100%;background:none;text-align:center;outline:none;font-family:inherit;margin:0}.mat-calendar-body-cell::-moz-focus-inner{border:0}.mat-calendar-body-cell::before,.mat-calendar-body-cell::after,.mat-calendar-body-cell-preview{content:"";position:absolute;top:5%;left:0;z-index:0;box-sizing:border-box;display:block;height:90%;width:100%}.mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-start::after,.mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,.mat-calendar-body-comparison-start::after,.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:5%;width:95%;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-range-start:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-start:not(.mat-calendar-body-comparison-bridge-start)::before,[dir=rtl] .mat-calendar-body-comparison-start::after,[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{left:0;border-radius:0;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,.mat-calendar-body-comparison-end::after,.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}[dir=rtl] .mat-calendar-body-range-end:not(.mat-calendar-body-in-comparison-range)::before,[dir=rtl] .mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-end:not(.mat-calendar-body-comparison-bridge-end)::before,[dir=rtl] .mat-calendar-body-comparison-end::after,[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{left:5%;border-radius:0;border-top-left-radius:999px;border-bottom-left-radius:999px}[dir=rtl] .mat-calendar-body-comparison-bridge-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-bridge-end.mat-calendar-body-range-start::after{width:95%;border-top-right-radius:999px;border-bottom-right-radius:999px}.mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,[dir=rtl] .mat-calendar-body-comparison-start.mat-calendar-body-range-end::after,.mat-calendar-body-comparison-end.mat-calendar-body-range-start::after,[dir=rtl] .mat-calendar-body-comparison-end.mat-calendar-body-range-start::after{width:90%}.mat-calendar-body-in-preview .mat-calendar-body-cell-preview{border-top:dashed 1px;border-bottom:dashed 1px}.mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:dashed 1px}[dir=rtl] .mat-calendar-body-preview-start .mat-calendar-body-cell-preview{border-left:0;border-right:dashed 1px}.mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:dashed 1px}[dir=rtl] .mat-calendar-body-preview-end .mat-calendar-body-cell-preview{border-right:0;border-left:dashed 1px}.mat-calendar-body-disabled{cursor:default}.cdk-high-contrast-active .mat-calendar-body-disabled{opacity:.5}.mat-calendar-body-cell-content{top:5%;left:5%;z-index:1;display:flex;align-items:center;justify-content:center;box-sizing:border-box;width:90%;height:90%;line-height:1;border-width:1px;border-style:solid;border-radius:999px}.mat-calendar-body-cell-content.mat-focus-indicator{position:absolute}.cdk-high-contrast-active .mat-calendar-body-cell-content{border:none}.cdk-high-contrast-active .mat-datepicker-popup:not(:empty),.cdk-high-contrast-active .mat-calendar-body-cell:not(.mat-calendar-body-in-range) .mat-calendar-body-selected{outline:solid 1px}.cdk-high-contrast-active .mat-calendar-body-today{outline:dotted 1px}.cdk-high-contrast-active .mat-calendar-body-cell::before,.cdk-high-contrast-active .mat-calendar-body-cell::after,.cdk-high-contrast-active .mat-calendar-body-selected{background:none}.cdk-high-contrast-active .mat-calendar-body-in-range::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-start::before,.cdk-high-contrast-active .mat-calendar-body-comparison-bridge-end::before{border-top:solid 1px;border-bottom:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-start::before{border-left:0;border-right:solid 1px}.cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:solid 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-range-end::before{border-right:0;border-left:solid 1px}.cdk-high-contrast-active .mat-calendar-body-in-comparison-range::before{border-top:dashed 1px;border-bottom:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-start::before{border-left:0;border-right:dashed 1px}.cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:dashed 1px}[dir=rtl] .cdk-high-contrast-active .mat-calendar-body-comparison-end::before{border-right:0;border-left:dashed 1px}[dir=rtl] .mat-calendar-body-label{text-align:right}'],encapsulation:2,changeDetection:0}),n})();function IE(n){return"TD"===n?.nodeName}function kE(n){let t;return IE(n)?t=n:IE(n.parentNode)?t=n.parentNode:IE(n.parentNode?.parentNode)&&(t=n.parentNode.parentNode),null!=t?.getAttribute("data-mat-row")?t:null}function PE(n,t,e){return null!==e&&t!==e&&n<e&&n===t}function RE(n,t,e){return null!==t&&t!==e&&n>=t&&n===e}function FE(n,t,e,i){return i&&null!==t&&null!==e&&t!==e&&n>=t&&n<=e}function Wk(n){const t=n.changedTouches[0];return document.elementFromPoint(t.clientX,t.clientY)}class ga{constructor(t,e){this.start=t,this.end=e}}let Jh=(()=>{class n{constructor(e,i){this.selection=e,this._adapter=i,this._selectionChanged=new yn,this.selectionChanged=this._selectionChanged,this.selection=e}updateSelection(e,i){const o=this.selection;this.selection=e,this._selectionChanged.next({selection:e,source:i,oldValue:o})}ngOnDestroy(){this._selectionChanged.complete()}_isValidDateInstance(e){return this._adapter.isDateInstance(e)&&this._adapter.isValid(e)}}return n.\u0275fac=function(e){nu()},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),O6=(()=>{class n extends Jh{constructor(e){super(null,e)}add(e){super.updateSelection(e,this)}isValid(){return null!=this.selection&&this._isValidDateInstance(this.selection)}isComplete(){return null!=this.selection}clone(){const e=new n(this._adapter);return e.updateSelection(this.selection,this),e}}return n.\u0275fac=function(e){return new(e||n)(We(Ps))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const Zk={provide:Jh,deps:[[new ds,new bl,Jh],Ps],useFactory:function N6(n,t){return n||new O6(t)}},_x=new wt("MAT_DATE_RANGE_SELECTION_STRATEGY");let Yk=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){const i=this._activeDate,o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._hasSameMonthAndYear(i,this._activeDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ga?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setRanges(this._selected)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,o,c,f){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=o,this._dir=c,this._rangeStrategy=f,this._rerenderSubscription=Ie.EMPTY,this.activeDrag=null,this.selectedChange=new on,this._userSelection=new on,this.dragStarted=new on,this.dragEnded=new on,this.activeDateChange=new on,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Uh(null)).subscribe(()=>this._init())}ngOnChanges(e){const i=e.comparisonStart||e.comparisonEnd;i&&!i.firstChange&&this._setRanges(this.selected),e.activeDrag&&!this.activeDrag&&this._clearPreview()}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_dateSelected(e){const i=e.value,o=this._getDateFromDayOfMonth(i);let c,f;this._selected instanceof ga?(c=this._getDateInCurrentMonth(this._selected.start),f=this._getDateInCurrentMonth(this._selected.end)):c=f=this._getDateInCurrentMonth(this._selected),(c!==i||f!==i)&&this.selectedChange.emit(o),this._userSelection.emit({value:o,event:e.event}),this._clearPreview(),this._changeDetectorRef.markForCheck()}_updateActiveDate(e){const o=this._activeDate;this.activeDate=this._getDateFromDayOfMonth(e.value),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this._activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,-7);break;case 40:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,7);break;case 36:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,1-this._dateAdapter.getDate(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarDays(this._activeDate,this._dateAdapter.getNumDaysInMonth(this._activeDate)-this._dateAdapter.getDate(this._activeDate));break;case 33:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,-1):this._dateAdapter.addCalendarMonths(this._activeDate,-1);break;case 34:this.activeDate=e.altKey?this._dateAdapter.addCalendarYears(this._activeDate,1):this._dateAdapter.addCalendarMonths(this._activeDate,1);break;case 13:case 32:return this._selectionKeyPressed=!0,void(this._canSelect(this._activeDate)&&e.preventDefault());case 27:return void(null!=this._previewEnd&&!mu(e)&&(this._clearPreview(),this.activeDrag?this.dragEnded.emit({value:null,event:e}):(this.selectedChange.emit(null),this._userSelection.emit({value:null,event:e})),e.preventDefault(),e.stopPropagation()));default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._canSelect(this._activeDate)&&this._dateSelected({value:this._dateAdapter.getDate(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setRanges(this.selected),this._todayDate=this._getCellCompareValue(this._dateAdapter.today()),this._monthLabel=this._dateFormats.display.monthLabel?this._dateAdapter.format(this.activeDate,this._dateFormats.display.monthLabel):this._dateAdapter.getMonthNames("short")[this._dateAdapter.getMonth(this.activeDate)].toLocaleUpperCase();let e=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),1);this._firstWeekOffset=(7+this._dateAdapter.getDayOfWeek(e)-this._dateAdapter.getFirstDayOfWeek())%7,this._initWeekdays(),this._createWeekCells(),this._changeDetectorRef.markForCheck()}_focusActiveCell(e){this._matCalendarBody._focusActiveCell(e)}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_previewChanged({event:e,value:i}){if(this._rangeStrategy){const o=i?i.rawValue:null,c=this._rangeStrategy.createPreview(o,this.selected,e);if(this._previewStart=this._getCellCompareValue(c.start),this._previewEnd=this._getCellCompareValue(c.end),this.activeDrag&&o){const f=this._rangeStrategy.createDrag?.(this.activeDrag.value,this.selected,o,e);f&&(this._previewStart=this._getCellCompareValue(f.start),this._previewEnd=this._getCellCompareValue(f.end))}this._changeDetectorRef.detectChanges()}}_dragEnded(e){if(this.activeDrag)if(e.value){const i=this._rangeStrategy?.createDrag?.(this.activeDrag.value,this.selected,e.value,e.event);this.dragEnded.emit({value:i??null,event:e.event})}else this.dragEnded.emit({value:null,event:e.event})}_getDateFromDayOfMonth(e){return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),e)}_initWeekdays(){const e=this._dateAdapter.getFirstDayOfWeek(),i=this._dateAdapter.getDayOfWeekNames("narrow");let c=this._dateAdapter.getDayOfWeekNames("long").map((f,v)=>({long:f,narrow:i[v]}));this._weekdays=c.slice(e).concat(c.slice(0,e))}_createWeekCells(){const e=this._dateAdapter.getNumDaysInMonth(this.activeDate),i=this._dateAdapter.getDateNames();this._weeks=[[]];for(let o=0,c=this._firstWeekOffset;o<e;o++,c++){7==c&&(this._weeks.push([]),c=0);const f=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),this._dateAdapter.getMonth(this.activeDate),o+1),v=this._shouldEnableDate(f),C=this._dateAdapter.format(f,this._dateFormats.display.dateA11yLabel),S=this.dateClass?this.dateClass(f,"month"):void 0;this._weeks[this._weeks.length-1].push(new AE(o+1,i[o],C,v,S,this._getCellCompareValue(f),f))}}_shouldEnableDate(e){return!!e&&(!this.minDate||this._dateAdapter.compareDate(e,this.minDate)>=0)&&(!this.maxDate||this._dateAdapter.compareDate(e,this.maxDate)<=0)&&(!this.dateFilter||this.dateFilter(e))}_getDateInCurrentMonth(e){return e&&this._hasSameMonthAndYear(e,this.activeDate)?this._dateAdapter.getDate(e):null}_hasSameMonthAndYear(e,i){return!(!e||!i||this._dateAdapter.getMonth(e)!=this._dateAdapter.getMonth(i)||this._dateAdapter.getYear(e)!=this._dateAdapter.getYear(i))}_getCellCompareValue(e){if(e){const i=this._dateAdapter.getYear(e),o=this._dateAdapter.getMonth(e),c=this._dateAdapter.getDate(e);return new Date(i,o,c).getTime()}return null}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setRanges(e){e instanceof ga?(this._rangeStart=this._getCellCompareValue(e.start),this._rangeEnd=this._getCellCompareValue(e.end),this._isRange=!0):(this._rangeStart=this._rangeEnd=this._getCellCompareValue(e),this._isRange=!1),this._comparisonRangeStart=this._getCellCompareValue(this.comparisonStart),this._comparisonRangeEnd=this._getCellCompareValue(this.comparisonEnd)}_canSelect(e){return!this.dateFilter||this.dateFilter(e)}_clearPreview(){this._previewStart=this._previewEnd=null}}return n.\u0275fac=function(e){return new(e||n)(ve(pa),ve(gf,8),ve(Ps,8),ve(gu,8),ve(_x,8))},n.\u0275cmp=mi({type:n,selectors:[["mat-month-view"]],viewQuery:function(e,i){if(1&e&&mo(ag,5),2&e){let o;Gi(o=qi())&&(i._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName",activeDrag:"activeDrag"},outputs:{selectedChange:"selectedChange",_userSelection:"_userSelection",dragStarted:"dragStarted",dragEnded:"dragEnded",activeDateChange:"activeDateChange"},exportAs:["matMonthView"],features:[tr],decls:7,vars:15,consts:[["role","grid",1,"mat-calendar-table"],[1,"mat-calendar-table-header"],["scope","col",4,"ngFor","ngForOf"],["aria-hidden","true","colspan","7",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","comparisonStart","comparisonEnd","previewStart","previewEnd","isRange","labelMinRequiredCells","activeCell","startDateAccessibleName","endDateAccessibleName","selectedValueChange","activeDateChange","previewChange","dragStarted","dragEnded","keyup","keydown"],["scope","col"],[1,"cdk-visually-hidden"],["aria-hidden","true"]],template:function(e,i){1&e&&(pe(0,"table",0)(1,"thead",1)(2,"tr"),$t(3,C6,5,2,"th",2),xe(),pe(4,"tr"),It(5,"th",3),xe()(),pe(6,"tbody",4),mn("selectedValueChange",function(c){return i._dateSelected(c)})("activeDateChange",function(c){return i._updateActiveDate(c)})("previewChange",function(c){return i._previewChanged(c)})("dragStarted",function(c){return i.dragStarted.emit(c)})("dragEnded",function(c){return i._dragEnded(c)})("keyup",function(c){return i._handleCalendarBodyKeyup(c)})("keydown",function(c){return i._handleCalendarBodyKeydown(c)}),xe()()),2&e&&(Et(3),ht("ngForOf",i._weekdays),Et(3),ht("label",i._monthLabel)("rows",i._weeks)("todayValue",i._todayDate)("startValue",i._rangeStart)("endValue",i._rangeEnd)("comparisonStart",i._comparisonRangeStart)("comparisonEnd",i._comparisonRangeEnd)("previewStart",i._previewStart)("previewEnd",i._previewEnd)("isRange",i._isRange)("labelMinRequiredCells",3)("activeCell",i._dateAdapter.getDate(i.activeDate)-1)("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName))},dependencies:[Um,ag],encapsulation:2,changeDetection:0}),n})();const Al=24;let Xk=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),Kk(this._dateAdapter,i,this._activeDate,this.minDate,this.maxDate)||this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ga?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedYear(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,o){this._changeDetectorRef=e,this._dateAdapter=i,this._dir=o,this._rerenderSubscription=Ie.EMPTY,this.selectedChange=new on,this.yearSelected=new on,this.activeDateChange=new on,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Uh(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_init(){this._todayYear=this._dateAdapter.getYear(this._dateAdapter.today());const i=this._dateAdapter.getYear(this._activeDate)-ev(this._dateAdapter,this.activeDate,this.minDate,this.maxDate);this._years=[];for(let o=0,c=[];o<Al;o++)c.push(i+o),4==c.length&&(this._years.push(c.map(f=>this._createCellForYear(f))),c=[]);this._changeDetectorRef.markForCheck()}_yearSelected(e){const i=e.value,o=this._dateAdapter.createDate(i,0,1),c=this._getDateFromYear(i);this.yearSelected.emit(o),this.selectedChange.emit(c)}_updateActiveDate(e){const o=this._activeDate;this.activeDate=this._getDateFromYear(e.value),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,-ev(this._dateAdapter,this.activeDate,this.minDate,this.maxDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,Al-ev(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)-1);break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*-Al:-Al);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10*Al:Al);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked(),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._yearSelected({value:this._dateAdapter.getYear(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_getActiveCell(){return ev(this._dateAdapter,this.activeDate,this.minDate,this.maxDate)}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getDateFromYear(e){const i=this._dateAdapter.getMonth(this.activeDate),o=this._dateAdapter.getNumDaysInMonth(this._dateAdapter.createDate(e,i,1));return this._dateAdapter.createDate(e,i,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForYear(e){const i=this._dateAdapter.createDate(e,0,1),o=this._dateAdapter.getYearName(i),c=this.dateClass?this.dateClass(i,"multi-year"):void 0;return new AE(e,o,o,this._shouldEnableYear(e),c)}_shouldEnableYear(e){if(null==e||this.maxDate&&e>this._dateAdapter.getYear(this.maxDate)||this.minDate&&e<this._dateAdapter.getYear(this.minDate))return!1;if(!this.dateFilter)return!0;for(let o=this._dateAdapter.createDate(e,0,1);this._dateAdapter.getYear(o)==e;o=this._dateAdapter.addCalendarDays(o,1))if(this.dateFilter(o))return!0;return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedYear(e){if(this._selectedYear=null,e instanceof ga){const i=e.start||e.end;i&&(this._selectedYear=this._dateAdapter.getYear(i))}else e&&(this._selectedYear=this._dateAdapter.getYear(e))}}return n.\u0275fac=function(e){return new(e||n)(ve(pa),ve(Ps,8),ve(gu,8))},n.\u0275cmp=mi({type:n,selectors:[["mat-multi-year-view"]],viewQuery:function(e,i){if(1&e&&mo(ag,5),2&e){let o;Gi(o=qi())&&(i._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",activeDateChange:"activeDateChange"},exportAs:["matMultiYearView"],decls:5,vars:7,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"rows","todayValue","startValue","endValue","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,i){1&e&&(pe(0,"table",0)(1,"thead",1)(2,"tr"),It(3,"th",2),xe()(),pe(4,"tbody",3),mn("selectedValueChange",function(c){return i._yearSelected(c)})("activeDateChange",function(c){return i._updateActiveDate(c)})("keyup",function(c){return i._handleCalendarBodyKeyup(c)})("keydown",function(c){return i._handleCalendarBodyKeydown(c)}),xe()()),2&e&&(Et(4),ht("rows",i._years)("todayValue",i._todayYear)("startValue",i._selectedYear)("endValue",i._selectedYear)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._getActiveCell()))},dependencies:[ag],encapsulation:2,changeDetection:0}),n})();function Kk(n,t,e,i,o){const c=n.getYear(t),f=n.getYear(e),v=Qk(n,i,o);return Math.floor((c-v)/Al)===Math.floor((f-v)/Al)}function ev(n,t,e,i){return function U6(n,t){return(n%t+t)%t}(n.getYear(t)-Qk(n,e,i),Al)}function Qk(n,t,e){let i=0;return e?i=n.getYear(e)-Al+1:t&&(i=n.getYear(t)),i}let Jk=(()=>{class n{get activeDate(){return this._activeDate}set activeDate(e){let i=this._activeDate;const o=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))||this._dateAdapter.today();this._activeDate=this._dateAdapter.clampDate(o,this.minDate,this.maxDate),this._dateAdapter.getYear(i)!==this._dateAdapter.getYear(this._activeDate)&&this._init()}get selected(){return this._selected}set selected(e){this._selected=e instanceof ga?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e)),this._setSelectedMonth(e)}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}constructor(e,i,o,c){this._changeDetectorRef=e,this._dateFormats=i,this._dateAdapter=o,this._dir=c,this._rerenderSubscription=Ie.EMPTY,this.selectedChange=new on,this.monthSelected=new on,this.activeDateChange=new on,this._activeDate=this._dateAdapter.today()}ngAfterContentInit(){this._rerenderSubscription=this._dateAdapter.localeChanges.pipe(Uh(null)).subscribe(()=>this._init())}ngOnDestroy(){this._rerenderSubscription.unsubscribe()}_monthSelected(e){const i=e.value,o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),i,1);this.monthSelected.emit(o);const c=this._getDateFromMonth(i);this.selectedChange.emit(c)}_updateActiveDate(e){const o=this._activeDate;this.activeDate=this._getDateFromMonth(e.value),this._dateAdapter.compareDate(o,this.activeDate)&&this.activeDateChange.emit(this.activeDate)}_handleCalendarBodyKeydown(e){const i=this._activeDate,o=this._isRtl();switch(e.keyCode){case 37:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?1:-1);break;case 39:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,o?-1:1);break;case 38:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-4);break;case 40:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,4);break;case 36:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,-this._dateAdapter.getMonth(this._activeDate));break;case 35:this.activeDate=this._dateAdapter.addCalendarMonths(this._activeDate,11-this._dateAdapter.getMonth(this._activeDate));break;case 33:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?-10:-1);break;case 34:this.activeDate=this._dateAdapter.addCalendarYears(this._activeDate,e.altKey?10:1);break;case 13:case 32:this._selectionKeyPressed=!0;break;default:return}this._dateAdapter.compareDate(i,this.activeDate)&&(this.activeDateChange.emit(this.activeDate),this._focusActiveCellAfterViewChecked()),e.preventDefault()}_handleCalendarBodyKeyup(e){(32===e.keyCode||13===e.keyCode)&&(this._selectionKeyPressed&&this._monthSelected({value:this._dateAdapter.getMonth(this._activeDate),event:e}),this._selectionKeyPressed=!1)}_init(){this._setSelectedMonth(this.selected),this._todayMonth=this._getMonthInCurrentYear(this._dateAdapter.today()),this._yearLabel=this._dateAdapter.getYearName(this.activeDate);let e=this._dateAdapter.getMonthNames("short");this._months=[[0,1,2,3],[4,5,6,7],[8,9,10,11]].map(i=>i.map(o=>this._createCellForMonth(o,e[o]))),this._changeDetectorRef.markForCheck()}_focusActiveCell(){this._matCalendarBody._focusActiveCell()}_focusActiveCellAfterViewChecked(){this._matCalendarBody._scheduleFocusActiveCellAfterViewChecked()}_getMonthInCurrentYear(e){return e&&this._dateAdapter.getYear(e)==this._dateAdapter.getYear(this.activeDate)?this._dateAdapter.getMonth(e):null}_getDateFromMonth(e){const i=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),o=this._dateAdapter.getNumDaysInMonth(i);return this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,Math.min(this._dateAdapter.getDate(this.activeDate),o))}_createCellForMonth(e,i){const o=this._dateAdapter.createDate(this._dateAdapter.getYear(this.activeDate),e,1),c=this._dateAdapter.format(o,this._dateFormats.display.monthYearA11yLabel),f=this.dateClass?this.dateClass(o,"year"):void 0;return new AE(e,i.toLocaleUpperCase(),c,this._shouldEnableMonth(e),f)}_shouldEnableMonth(e){const i=this._dateAdapter.getYear(this.activeDate);if(null==e||this._isYearAndMonthAfterMaxDate(i,e)||this._isYearAndMonthBeforeMinDate(i,e))return!1;if(!this.dateFilter)return!0;for(let c=this._dateAdapter.createDate(i,e,1);this._dateAdapter.getMonth(c)==e;c=this._dateAdapter.addCalendarDays(c,1))if(this.dateFilter(c))return!0;return!1}_isYearAndMonthAfterMaxDate(e,i){if(this.maxDate){const o=this._dateAdapter.getYear(this.maxDate),c=this._dateAdapter.getMonth(this.maxDate);return e>o||e===o&&i>c}return!1}_isYearAndMonthBeforeMinDate(e,i){if(this.minDate){const o=this._dateAdapter.getYear(this.minDate),c=this._dateAdapter.getMonth(this.minDate);return e<o||e===o&&i<c}return!1}_isRtl(){return this._dir&&"rtl"===this._dir.value}_setSelectedMonth(e){this._selectedMonth=e instanceof ga?this._getMonthInCurrentYear(e.start)||this._getMonthInCurrentYear(e.end):this._getMonthInCurrentYear(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(pa),ve(gf,8),ve(Ps,8),ve(gu,8))},n.\u0275cmp=mi({type:n,selectors:[["mat-year-view"]],viewQuery:function(e,i){if(1&e&&mo(ag,5),2&e){let o;Gi(o=qi())&&(i._matCalendarBody=o.first)}},inputs:{activeDate:"activeDate",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass"},outputs:{selectedChange:"selectedChange",monthSelected:"monthSelected",activeDateChange:"activeDateChange"},exportAs:["matYearView"],decls:5,vars:9,consts:[["role","grid",1,"mat-calendar-table"],["aria-hidden","true",1,"mat-calendar-table-header"],["colspan","4",1,"mat-calendar-table-header-divider"],["mat-calendar-body","",3,"label","rows","todayValue","startValue","endValue","labelMinRequiredCells","numCols","cellAspectRatio","activeCell","selectedValueChange","activeDateChange","keyup","keydown"]],template:function(e,i){1&e&&(pe(0,"table",0)(1,"thead",1)(2,"tr"),It(3,"th",2),xe()(),pe(4,"tbody",3),mn("selectedValueChange",function(c){return i._monthSelected(c)})("activeDateChange",function(c){return i._updateActiveDate(c)})("keyup",function(c){return i._handleCalendarBodyKeyup(c)})("keydown",function(c){return i._handleCalendarBodyKeydown(c)}),xe()()),2&e&&(Et(4),ht("label",i._yearLabel)("rows",i._months)("todayValue",i._todayMonth)("startValue",i._selectedMonth)("endValue",i._selectedMonth)("labelMinRequiredCells",2)("numCols",4)("cellAspectRatio",4/7)("activeCell",i._dateAdapter.getMonth(i.activeDate)))},dependencies:[ag],encapsulation:2,changeDetection:0}),n})(),j6=1,$6=(()=>{class n{constructor(e,i,o,c,f){this._intl=e,this.calendar=i,this._dateAdapter=o,this._dateFormats=c,this._id="mat-calendar-header-"+j6++,this._periodButtonLabelId=`${this._id}-period-label`,this.calendar.stateChanges.subscribe(()=>f.markForCheck())}get periodButtonText(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRange(...this._formatMinAndMaxYearLabels())}get periodButtonDescription(){return"month"==this.calendar.currentView?this._dateAdapter.format(this.calendar.activeDate,this._dateFormats.display.monthYearLabel).toLocaleUpperCase():"year"==this.calendar.currentView?this._dateAdapter.getYearName(this.calendar.activeDate):this._intl.formatYearRangeLabel(...this._formatMinAndMaxYearLabels())}get periodButtonLabel(){return"month"==this.calendar.currentView?this._intl.switchToMultiYearViewLabel:this._intl.switchToMonthViewLabel}get prevButtonLabel(){return{month:this._intl.prevMonthLabel,year:this._intl.prevYearLabel,"multi-year":this._intl.prevMultiYearLabel}[this.calendar.currentView]}get nextButtonLabel(){return{month:this._intl.nextMonthLabel,year:this._intl.nextYearLabel,"multi-year":this._intl.nextMultiYearLabel}[this.calendar.currentView]}currentPeriodClicked(){this.calendar.currentView="month"==this.calendar.currentView?"multi-year":"month"}previousClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,-1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?-1:-Al)}nextClicked(){this.calendar.activeDate="month"==this.calendar.currentView?this._dateAdapter.addCalendarMonths(this.calendar.activeDate,1):this._dateAdapter.addCalendarYears(this.calendar.activeDate,"year"==this.calendar.currentView?1:Al)}previousEnabled(){return!this.calendar.minDate||!this.calendar.minDate||!this._isSameView(this.calendar.activeDate,this.calendar.minDate)}nextEnabled(){return!this.calendar.maxDate||!this._isSameView(this.calendar.activeDate,this.calendar.maxDate)}_isSameView(e,i){return"month"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i)&&this._dateAdapter.getMonth(e)==this._dateAdapter.getMonth(i):"year"==this.calendar.currentView?this._dateAdapter.getYear(e)==this._dateAdapter.getYear(i):Kk(this._dateAdapter,e,i,this.calendar.minDate,this.calendar.maxDate)}_formatMinAndMaxYearLabels(){const i=this._dateAdapter.getYear(this.calendar.activeDate)-ev(this._dateAdapter,this.calendar.activeDate,this.calendar.minDate,this.calendar.maxDate),o=i+Al-1;return[this._dateAdapter.getYearName(this._dateAdapter.createDate(i,0,1)),this._dateAdapter.getYearName(this._dateAdapter.createDate(o,0,1))]}}return n.\u0275fac=function(e){return new(e||n)(ve(Jy),ve(ci(()=>NE)),ve(Ps,8),ve(gf,8),ve(pa))},n.\u0275cmp=mi({type:n,selectors:[["mat-calendar-header"]],exportAs:["matCalendarHeader"],ngContentSelectors:E6,decls:13,vars:11,consts:[[1,"mat-calendar-header"],[1,"mat-calendar-controls"],["mat-button","","type","button","aria-live","polite",1,"mat-calendar-period-button",3,"click"],["aria-hidden","true"],["viewBox","0 0 10 5","focusable","false","aria-hidden","true",1,"mat-calendar-arrow"],["points","0,0 5,5 10,0"],[1,"mat-calendar-spacer"],["mat-icon-button","","type","button",1,"mat-calendar-previous-button",3,"disabled","click"],["mat-icon-button","","type","button",1,"mat-calendar-next-button",3,"disabled","click"],[1,"mat-calendar-hidden-label",3,"id"]],template:function(e,i){1&e&&(Dl(),pe(0,"div",0)(1,"div",1)(2,"button",2),mn("click",function(){return i.currentPeriodClicked()}),pe(3,"span",3),Qe(4),xe(),q(),pe(5,"svg",4),It(6,"polygon",5),xe()(),re(),It(7,"div",6),yr(8),pe(9,"button",7),mn("click",function(){return i.previousClicked()}),xe(),pe(10,"button",8),mn("click",function(){return i.nextClicked()}),xe()()(),pe(11,"label",9),Qe(12),xe()),2&e&&(Et(2),Ze("aria-label",i.periodButtonLabel)("aria-describedby",i._periodButtonLabelId),Et(2),ms(i.periodButtonText),Et(1),vr("mat-calendar-invert","month"!==i.calendar.currentView),Et(4),ht("disabled",!i.previousEnabled()),Ze("aria-label",i.prevButtonLabel),Et(1),ht("disabled",!i.nextEnabled()),Ze("aria-label",i.nextButtonLabel),Et(1),ht("id",i._periodButtonLabelId),Et(1),ms(i.periodButtonDescription))},dependencies:[Ik,kk],encapsulation:2,changeDetection:0}),n})(),NE=(()=>{class n{get startAt(){return this._startAt}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get selected(){return this._selected}set selected(e){this._selected=e instanceof ga?e:this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get minDate(){return this._minDate}set minDate(e){this._minDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get maxDate(){return this._maxDate}set maxDate(e){this._maxDate=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get activeDate(){return this._clampedActiveDate}set activeDate(e){this._clampedActiveDate=this._dateAdapter.clampDate(e,this.minDate,this.maxDate),this.stateChanges.next(),this._changeDetectorRef.markForCheck()}get currentView(){return this._currentView}set currentView(e){const i=this._currentView!==e?e:null;this._currentView=e,this._moveFocusOnNextTick=!0,this._changeDetectorRef.markForCheck(),i&&this.viewChanged.emit(i)}constructor(e,i,o,c){this._dateAdapter=i,this._dateFormats=o,this._changeDetectorRef=c,this._moveFocusOnNextTick=!1,this.startView="month",this.selectedChange=new on,this.yearSelected=new on,this.monthSelected=new on,this.viewChanged=new on(!0),this._userSelection=new on,this._userDragDrop=new on,this._activeDrag=null,this.stateChanges=new yn,this._intlChanges=e.changes.subscribe(()=>{c.markForCheck(),this.stateChanges.next()})}ngAfterContentInit(){this._calendarHeaderPortal=new bE(this.headerComponent||$6),this.activeDate=this.startAt||this._dateAdapter.today(),this._currentView=this.startView}ngAfterViewChecked(){this._moveFocusOnNextTick&&(this._moveFocusOnNextTick=!1,this.focusActiveCell())}ngOnDestroy(){this._intlChanges.unsubscribe(),this.stateChanges.complete()}ngOnChanges(e){const i=e.minDate&&!this._dateAdapter.sameDate(e.minDate.previousValue,e.minDate.currentValue)?e.minDate:void 0,o=e.maxDate&&!this._dateAdapter.sameDate(e.maxDate.previousValue,e.maxDate.currentValue)?e.maxDate:void 0,c=i||o||e.dateFilter;if(c&&!c.firstChange){const f=this._getCurrentViewComponent();f&&(this._changeDetectorRef.detectChanges(),f._init())}this.stateChanges.next()}focusActiveCell(){this._getCurrentViewComponent()._focusActiveCell(!1)}updateTodaysDate(){this._getCurrentViewComponent()._init()}_dateSelected(e){const i=e.value;(this.selected instanceof ga||i&&!this._dateAdapter.sameDate(i,this.selected))&&this.selectedChange.emit(i),this._userSelection.emit(e)}_yearSelectedInMultiYearView(e){this.yearSelected.emit(e)}_monthSelectedInYearView(e){this.monthSelected.emit(e)}_goToDateInView(e,i){this.activeDate=e,this.currentView=i}_dragStarted(e){this._activeDrag=e}_dragEnded(e){this._activeDrag&&(e.value&&this._userDragDrop.emit(e),this._activeDrag=null)}_getCurrentViewComponent(){return this.monthView||this.yearView||this.multiYearView}}return n.\u0275fac=function(e){return new(e||n)(ve(Jy),ve(Ps,8),ve(gf,8),ve(pa))},n.\u0275cmp=mi({type:n,selectors:[["mat-calendar"]],viewQuery:function(e,i){if(1&e&&(mo(Yk,5),mo(Jk,5),mo(Xk,5)),2&e){let o;Gi(o=qi())&&(i.monthView=o.first),Gi(o=qi())&&(i.yearView=o.first),Gi(o=qi())&&(i.multiYearView=o.first)}},hostAttrs:[1,"mat-calendar"],inputs:{headerComponent:"headerComponent",startAt:"startAt",startView:"startView",selected:"selected",minDate:"minDate",maxDate:"maxDate",dateFilter:"dateFilter",dateClass:"dateClass",comparisonStart:"comparisonStart",comparisonEnd:"comparisonEnd",startDateAccessibleName:"startDateAccessibleName",endDateAccessibleName:"endDateAccessibleName"},outputs:{selectedChange:"selectedChange",yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",_userSelection:"_userSelection",_userDragDrop:"_userDragDrop"},exportAs:["matCalendar"],features:[Ki([Zk]),tr],decls:5,vars:5,consts:[[3,"cdkPortalOutlet"],["cdkMonitorSubtreeFocus","","tabindex","-1",1,"mat-calendar-content",3,"ngSwitch"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange",4,"ngSwitchCase"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","activeDrag","activeDateChange","_userSelection","dragStarted","dragEnded"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","monthSelected","selectedChange"],[3,"activeDate","selected","dateFilter","maxDate","minDate","dateClass","activeDateChange","yearSelected","selectedChange"]],template:function(e,i){1&e&&($t(0,D6,0,0,"ng-template",0),pe(1,"div",1),$t(2,M6,1,11,"mat-month-view",2),$t(3,S6,1,6,"mat-year-view",3),$t(4,T6,1,6,"mat-multi-year-view",4),xe()),2&e&&(ht("cdkPortalOutlet",i._calendarHeaderPortal),Et(1),ht("ngSwitch",i.currentView),Et(1),ht("ngSwitchCase","month"),Et(1),ht("ngSwitchCase","year"),Et(1),ht("ngSwitchCase","multi-year"))},dependencies:[nf,py,W4,K2,Yk,Jk,Xk],styles:['.mat-calendar{display:block}.mat-calendar-header{padding:8px 8px 0 8px}.mat-calendar-content{padding:0 8px 8px 8px;outline:none}.mat-calendar-controls{display:flex;align-items:center;margin:5% calc(4.7142857143% - 16px)}.mat-calendar-spacer{flex:1 1 auto}.mat-calendar-period-button{min-width:0;margin:0 8px}.mat-calendar-arrow{display:inline-block;width:10px;height:5px;margin:0 0 0 5px;vertical-align:middle}.mat-calendar-arrow.mat-calendar-invert{transform:rotate(180deg)}[dir=rtl] .mat-calendar-arrow{margin:0 5px 0 0}.cdk-high-contrast-active .mat-calendar-arrow{fill:CanvasText}.mat-calendar-previous-button,.mat-calendar-next-button{position:relative}.mat-calendar-previous-button::after,.mat-calendar-next-button::after{top:0;left:0;right:0;bottom:0;position:absolute;content:"";margin:15.5px;border:0 solid currentColor;border-top-width:2px}[dir=rtl] .mat-calendar-previous-button,[dir=rtl] .mat-calendar-next-button{transform:rotate(180deg)}.mat-calendar-previous-button::after{border-left-width:2px;transform:translateX(2px) rotate(-45deg)}.mat-calendar-next-button::after{border-right-width:2px;transform:translateX(-2px) rotate(45deg)}.mat-calendar-table{border-spacing:0;border-collapse:collapse;width:100%}.mat-calendar-table-header th{text-align:center;padding:0 0 8px 0}.mat-calendar-table-header-divider{position:relative;height:1px}.mat-calendar-table-header-divider::after{content:"";position:absolute;top:0;left:-8px;right:-8px;height:1px}.mat-calendar-body-cell-content::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.mat-calendar-body-cell:focus .mat-focus-indicator::before{content:""}.mat-calendar-hidden-label{display:none}'],encapsulation:2,changeDetection:0}),n})();const eP={transformPanel:Ky("transformPanel",[Qh("void => enter-dropdown",_f("120ms cubic-bezier(0, 0, 0.2, 1)",Fk([rl({opacity:0,transform:"scale(1, 0.8)"}),rl({opacity:1,transform:"scale(1, 1)"})]))),Qh("void => enter-dialog",_f("150ms cubic-bezier(0, 0, 0.2, 1)",Fk([rl({opacity:0,transform:"scale(0.7)"}),rl({transform:"none",opacity:1})]))),Qh("* => void",_f("100ms linear",rl({opacity:0})))]),fadeInCalendar:Ky("fadeInCalendar",[px("void",rl({opacity:0})),px("enter",rl({opacity:1})),Qh("void => *",_f("120ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)"))])};let H6=0;const tP=new wt("mat-datepicker-scroll-strategy"),q6={provide:tP,deps:[sg],useFactory:function G6(n){return()=>n.scrollStrategies.reposition()}},W6=mk(class{constructor(n){this._elementRef=n}});let Z6=(()=>{class n extends W6{constructor(e,i,o,c,f,v){super(e),this._changeDetectorRef=i,this._globalModel=o,this._dateAdapter=c,this._rangeSelectionStrategy=f,this._subscriptions=new Ie,this._animationDone=new yn,this._isAnimating=!1,this._actionsPortal=null,this._closeButtonText=v.closeCalendarLabel}ngOnInit(){this._animationState=this.datepicker.touchUi?"enter-dialog":"enter-dropdown"}ngAfterViewInit(){this._subscriptions.add(this.datepicker.stateChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})),this._calendar.focusActiveCell()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._animationDone.complete()}_handleUserSelection(e){const i=this._model.selection,o=e.value,c=i instanceof ga;if(c&&this._rangeSelectionStrategy){const f=this._rangeSelectionStrategy.selectionFinished(o,i,e.event);this._model.updateSelection(f,this)}else o&&(c||!this._dateAdapter.sameDate(o,i))&&this._model.add(o);(!this._model||this._model.isComplete())&&!this._actionsPortal&&this.datepicker.close()}_handleUserDragDrop(e){this._model.updateSelection(e.value,this)}_startExitAnimation(){this._animationState="void",this._changeDetectorRef.markForCheck()}_handleAnimationEvent(e){this._isAnimating="start"===e.phaseName,this._isAnimating||this._animationDone.next()}_getSelected(){return this._model.selection}_applyPendingSelection(){this._model!==this._globalModel&&this._globalModel.updateSelection(this._model.selection,this)}_assignActions(e,i){this._model=e?this._globalModel.clone():this._globalModel,this._actionsPortal=e,i&&this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(pa),ve(Jh),ve(Ps),ve(_x,8),ve(Jy))},n.\u0275cmp=mi({type:n,selectors:[["mat-datepicker-content"]],viewQuery:function(e,i){if(1&e&&mo(NE,5),2&e){let o;Gi(o=qi())&&(i._calendar=o.first)}},hostAttrs:[1,"mat-datepicker-content"],hostVars:3,hostBindings:function(e,i){1&e&&$r("@transformPanel.start",function(c){return i._handleAnimationEvent(c)})("@transformPanel.done",function(c){return i._handleAnimationEvent(c)}),2&e&&(Jw("@transformPanel",i._animationState),vr("mat-datepicker-content-touch",i.datepicker.touchUi))},inputs:{color:"color"},exportAs:["matDatepickerContent"],features:[Zn],decls:5,vars:26,consts:[["cdkTrapFocus","","role","dialog",1,"mat-datepicker-content-container"],[3,"id","ngClass","startAt","startView","minDate","maxDate","dateFilter","headerComponent","selected","dateClass","comparisonStart","comparisonEnd","startDateAccessibleName","endDateAccessibleName","yearSelected","monthSelected","viewChanged","_userSelection","_userDragDrop"],[3,"cdkPortalOutlet"],["type","button","mat-raised-button","",1,"mat-datepicker-close-button",3,"color","focus","blur","click"]],template:function(e,i){if(1&e&&(pe(0,"div",0)(1,"mat-calendar",1),mn("yearSelected",function(c){return i.datepicker._selectYear(c)})("monthSelected",function(c){return i.datepicker._selectMonth(c)})("viewChanged",function(c){return i.datepicker._viewChanged(c)})("_userSelection",function(c){return i._handleUserSelection(c)})("_userDragDrop",function(c){return i._handleUserDragDrop(c)}),xe(),$t(2,A6,0,0,"ng-template",2),pe(3,"button",3),mn("focus",function(){return i._closeButtonFocused=!0})("blur",function(){return i._closeButtonFocused=!1})("click",function(){return i.datepicker.close()}),Qe(4),xe()()),2&e){let o;vr("mat-datepicker-content-container-with-custom-header",i.datepicker.calendarHeaderComponent)("mat-datepicker-content-container-with-actions",i._actionsPortal),Ze("aria-modal",!0)("aria-labelledby",null!==(o=i._dialogLabelId)&&void 0!==o?o:void 0),Et(1),ht("id",i.datepicker.id)("ngClass",i.datepicker.panelClass)("startAt",i.datepicker.startAt)("startView",i.datepicker.startView)("minDate",i.datepicker._getMinDate())("maxDate",i.datepicker._getMaxDate())("dateFilter",i.datepicker._getDateFilter())("headerComponent",i.datepicker.calendarHeaderComponent)("selected",i._getSelected())("dateClass",i.datepicker.dateClass)("comparisonStart",i.comparisonStart)("comparisonEnd",i.comparisonEnd)("@fadeInCalendar","enter")("startDateAccessibleName",i.startDateAccessibleName)("endDateAccessibleName",i.endDateAccessibleName),Et(1),ht("cdkPortalOutlet",i._actionsPortal),Et(1),vr("cdk-visually-hidden",!i._closeButtonFocused),ht("color",i.color||"primary"),Et(1),ms(i._closeButtonText)}},dependencies:[dy,Ik,N4,K2,NE],styles:[".mat-datepicker-content{display:block;border-radius:4px}.mat-datepicker-content .mat-calendar{width:296px;height:354px}.mat-datepicker-content .mat-datepicker-content-container-with-custom-header .mat-calendar{height:auto}.mat-datepicker-content .mat-datepicker-close-button{position:absolute;top:100%;left:0;margin-top:8px}.ng-animating .mat-datepicker-content .mat-datepicker-close-button{display:none}.mat-datepicker-content-container{display:flex;flex-direction:column;justify-content:space-between}.mat-datepicker-content-touch{display:block;max-height:80vh;position:relative;overflow:visible}.mat-datepicker-content-touch .mat-datepicker-content-container{min-height:312px;max-height:788px;min-width:250px;max-width:750px}.mat-datepicker-content-touch .mat-calendar{width:100%;height:auto}@media all and (orientation: landscape){.mat-datepicker-content-touch .mat-datepicker-content-container{width:64vh;height:80vh}}@media all and (orientation: portrait){.mat-datepicker-content-touch .mat-datepicker-content-container{width:80vw;height:100vw}.mat-datepicker-content-touch .mat-datepicker-content-container-with-actions{height:115vw}}"],encapsulation:2,data:{animation:[eP.transformPanel,eP.fadeInCalendar]},changeDetection:0}),n})(),nP=(()=>{class n{get startAt(){return this._startAt||(this.datepickerInput?this.datepickerInput.getStartValue():null)}set startAt(e){this._startAt=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e))}get color(){return this._color||(this.datepickerInput?this.datepickerInput.getThemePalette():void 0)}set color(e){this._color=e}get touchUi(){return this._touchUi}set touchUi(e){this._touchUi=xr(e)}get disabled(){return void 0===this._disabled&&this.datepickerInput?this.datepickerInput.disabled:!!this._disabled}set disabled(e){const i=xr(e);i!==this._disabled&&(this._disabled=i,this.stateChanges.next(void 0))}get restoreFocus(){return this._restoreFocus}set restoreFocus(e){this._restoreFocus=xr(e)}get panelClass(){return this._panelClass}set panelClass(e){this._panelClass=function p4(n,t=/\s+/){const e=[];if(null!=n){const i=Array.isArray(n)?n:`${n}`.split(t);for(const o of i){const c=`${o}`.trim();c&&e.push(c)}}return e}(e)}get opened(){return this._opened}set opened(e){xr(e)?this.open():this.close()}_getMinDate(){return this.datepickerInput&&this.datepickerInput.min}_getMaxDate(){return this.datepickerInput&&this.datepickerInput.max}_getDateFilter(){return this.datepickerInput&&this.datepickerInput.dateFilter}constructor(e,i,o,c,f,v,C){this._overlay=e,this._ngZone=i,this._viewContainerRef=o,this._dateAdapter=f,this._dir=v,this._model=C,this._inputStateChanges=Ie.EMPTY,this._document=bn(ai),this.startView="month",this._touchUi=!1,this.xPosition="start",this.yPosition="below",this._restoreFocus=!0,this.yearSelected=new on,this.monthSelected=new on,this.viewChanged=new on(!0),this.openedStream=new on,this.closedStream=new on,this._opened=!1,this.id="mat-datepicker-"+H6++,this._focusedElementBeforeOpen=null,this._backdropHarnessClass=`${this.id}-backdrop`,this.stateChanges=new yn,this._scrollStrategy=c}ngOnChanges(e){const i=e.xPosition||e.yPosition;if(i&&!i.firstChange&&this._overlayRef){const o=this._overlayRef.getConfig().positionStrategy;o instanceof ok&&(this._setConnectedPositions(o),this.opened&&this._overlayRef.updatePosition())}this.stateChanges.next(void 0)}ngOnDestroy(){this._destroyOverlay(),this.close(),this._inputStateChanges.unsubscribe(),this.stateChanges.complete()}select(e){this._model.add(e)}_selectYear(e){this.yearSelected.emit(e)}_selectMonth(e){this.monthSelected.emit(e)}_viewChanged(e){this.viewChanged.emit(e)}registerInput(e){return this._inputStateChanges.unsubscribe(),this.datepickerInput=e,this._inputStateChanges=e.stateChanges.subscribe(()=>this.stateChanges.next(void 0)),this._model}registerActions(e){this._actionsPortal=e,this._componentRef?.instance._assignActions(e,!0)}removeActions(e){e===this._actionsPortal&&(this._actionsPortal=null,this._componentRef?.instance._assignActions(null,!0))}open(){this._opened||this.disabled||this._componentRef?.instance._isAnimating||(this._focusedElementBeforeOpen=C2(),this._openOverlay(),this._opened=!0,this.openedStream.emit())}close(){if(!this._opened||this._componentRef?.instance._isAnimating)return;const e=this._restoreFocus&&this._focusedElementBeforeOpen&&"function"==typeof this._focusedElementBeforeOpen.focus,i=()=>{this._opened&&(this._opened=!1,this.closedStream.emit())};if(this._componentRef){const{instance:o,location:c}=this._componentRef;o._startExitAnimation(),o._animationDone.pipe(ro(1)).subscribe(()=>{const f=this._document.activeElement;e&&(!f||f===this._document.activeElement||c.nativeElement.contains(f))&&this._focusedElementBeforeOpen.focus(),this._focusedElementBeforeOpen=null,this._destroyOverlay()})}e?setTimeout(i):i()}_applyPendingSelection(){this._componentRef?.instance?._applyPendingSelection()}_forwardContentValues(e){e.datepicker=this,e.color=this.color,e._dialogLabelId=this.datepickerInput.getOverlayLabelId(),e._assignActions(this._actionsPortal,!1)}_openOverlay(){this._destroyOverlay();const e=this.touchUi,i=new bE(Z6,this._viewContainerRef),o=this._overlayRef=this._overlay.create(new wE({positionStrategy:e?this._getDialogStrategy():this._getDropdownStrategy(),hasBackdrop:!0,backdropClass:[e?"cdk-overlay-dark-backdrop":"mat-overlay-transparent-backdrop",this._backdropHarnessClass],direction:this._dir,scrollStrategy:e?this._overlay.scrollStrategies.block():this._scrollStrategy(),panelClass:"mat-datepicker-"+(e?"dialog":"popup")}));this._getCloseStream(o).subscribe(c=>{c&&c.preventDefault(),this.close()}),o.keydownEvents().subscribe(c=>{const f=c.keyCode;(38===f||40===f||37===f||39===f||33===f||34===f)&&c.preventDefault()}),this._componentRef=o.attach(i),this._forwardContentValues(this._componentRef.instance),e||this._ngZone.onStable.pipe(ro(1)).subscribe(()=>o.updatePosition())}_destroyOverlay(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=this._componentRef=null)}_getDialogStrategy(){return this._overlay.position().global().centerHorizontally().centerVertically()}_getDropdownStrategy(){const e=this._overlay.position().flexibleConnectedTo(this.datepickerInput.getConnectedOverlayOrigin()).withTransformOriginOn(".mat-datepicker-content").withFlexibleDimensions(!1).withViewportMargin(8).withLockedPosition();return this._setConnectedPositions(e)}_setConnectedPositions(e){const i="end"===this.xPosition?"end":"start",o="start"===i?"end":"start",c="above"===this.yPosition?"bottom":"top",f="top"===c?"bottom":"top";return e.withPositions([{originX:i,originY:f,overlayX:i,overlayY:c},{originX:i,originY:c,overlayX:i,overlayY:f},{originX:o,originY:f,overlayX:o,overlayY:c},{originX:o,originY:c,overlayX:o,overlayY:f}])}_getCloseStream(e){const i=["ctrlKey","shiftKey","metaKey"];return qr(e.backdropClick(),e.detachments(),e.keydownEvents().pipe(oo(o=>27===o.keyCode&&!mu(o)||this.datepickerInput&&mu(o,"altKey")&&38===o.keyCode&&i.every(c=>!mu(o,c)))))}}return n.\u0275fac=function(e){return new(e||n)(ve(sg),ve(Pn),ve(tl),ve(tP),ve(Ps,8),ve(gu,8),ve(Jh))},n.\u0275dir=Vt({type:n,inputs:{calendarHeaderComponent:"calendarHeaderComponent",startAt:"startAt",startView:"startView",color:"color",touchUi:"touchUi",disabled:"disabled",xPosition:"xPosition",yPosition:"yPosition",restoreFocus:"restoreFocus",dateClass:"dateClass",panelClass:"panelClass",opened:"opened"},outputs:{yearSelected:"yearSelected",monthSelected:"monthSelected",viewChanged:"viewChanged",openedStream:"opened",closedStream:"closed"},features:[tr]}),n})(),Y6=(()=>{class n extends nP{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Jr(n)))(i||n)}}(),n.\u0275cmp=mi({type:n,selectors:[["mat-datepicker"]],exportAs:["matDatepicker"],features:[Ki([Zk,{provide:nP,useExisting:n}]),Zn],decls:0,vars:0,template:function(e,i){},encapsulation:2,changeDetection:0}),n})();class yx{constructor(t,e){this.target=t,this.targetElement=e,this.value=this.target.value}}let X6=(()=>{class n{get value(){return this._model?this._getValueFromModel(this._model.selection):this._pendingValue}set value(e){this._assignValueProgrammatically(e)}get disabled(){return!!this._disabled||this._parentDisabled()}set disabled(e){const i=xr(e),o=this._elementRef.nativeElement;this._disabled!==i&&(this._disabled=i,this.stateChanges.next(void 0)),i&&this._isInitialized&&o.blur&&o.blur()}_getValidators(){return[this._parseValidator,this._minValidator,this._maxValidator,this._filterValidator]}_registerModel(e){this._model=e,this._valueChangesSubscription.unsubscribe(),this._pendingValue&&this._assignValue(this._pendingValue),this._valueChangesSubscription=this._model.selectionChanged.subscribe(i=>{if(this._shouldHandleChangeEvent(i)){const o=this._getValueFromModel(i.selection);this._lastValueValid=this._isValidValue(o),this._cvaOnChange(o),this._onTouched(),this._formatValue(o),this.dateInput.emit(new yx(this,this._elementRef.nativeElement)),this.dateChange.emit(new yx(this,this._elementRef.nativeElement))}})}constructor(e,i,o){this._elementRef=e,this._dateAdapter=i,this._dateFormats=o,this.dateChange=new on,this.dateInput=new on,this.stateChanges=new yn,this._onTouched=()=>{},this._validatorOnChange=()=>{},this._cvaOnChange=()=>{},this._valueChangesSubscription=Ie.EMPTY,this._localeSubscription=Ie.EMPTY,this._parseValidator=()=>this._lastValueValid?null:{matDatepickerParse:{text:this._elementRef.nativeElement.value}},this._filterValidator=c=>{const f=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value));return!f||this._matchesFilter(f)?null:{matDatepickerFilter:!0}},this._minValidator=c=>{const f=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value)),v=this._getMinDate();return!v||!f||this._dateAdapter.compareDate(v,f)<=0?null:{matDatepickerMin:{min:v,actual:f}}},this._maxValidator=c=>{const f=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(c.value)),v=this._getMaxDate();return!v||!f||this._dateAdapter.compareDate(v,f)>=0?null:{matDatepickerMax:{max:v,actual:f}}},this._lastValueValid=!1,this._localeSubscription=i.localeChanges.subscribe(()=>{this._assignValueProgrammatically(this.value)})}ngAfterViewInit(){this._isInitialized=!0}ngOnChanges(e){(function K6(n,t){const e=Object.keys(n);for(let i of e){const{previousValue:o,currentValue:c}=n[i];if(!t.isDateInstance(o)||!t.isDateInstance(c))return!0;if(!t.sameDate(o,c))return!0}return!1})(e,this._dateAdapter)&&this.stateChanges.next(void 0)}ngOnDestroy(){this._valueChangesSubscription.unsubscribe(),this._localeSubscription.unsubscribe(),this.stateChanges.complete()}registerOnValidatorChange(e){this._validatorOnChange=e}validate(e){return this._validator?this._validator(e):null}writeValue(e){this._assignValueProgrammatically(e)}registerOnChange(e){this._cvaOnChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e}_onKeydown(e){mu(e,"altKey")&&40===e.keyCode&&["ctrlKey","shiftKey","metaKey"].every(c=>!mu(e,c))&&!this._elementRef.nativeElement.readOnly&&(this._openPopup(),e.preventDefault())}_onInput(e){const i=this._lastValueValid;let o=this._dateAdapter.parse(e,this._dateFormats.parse.dateInput);this._lastValueValid=this._isValidValue(o),o=this._dateAdapter.getValidDateOrNull(o);const c=!this._dateAdapter.sameDate(o,this.value);!o||c?this._cvaOnChange(o):(e&&!this.value&&this._cvaOnChange(o),i!==this._lastValueValid&&this._validatorOnChange()),c&&(this._assignValue(o),this.dateInput.emit(new yx(this,this._elementRef.nativeElement)))}_onChange(){this.dateChange.emit(new yx(this,this._elementRef.nativeElement))}_onBlur(){this.value&&this._formatValue(this.value),this._onTouched()}_formatValue(e){this._elementRef.nativeElement.value=null!=e?this._dateAdapter.format(e,this._dateFormats.display.dateInput):""}_assignValue(e){this._model?(this._assignValueToModel(e),this._pendingValue=null):this._pendingValue=e}_isValidValue(e){return!e||this._dateAdapter.isValid(e)}_parentDisabled(){return!1}_assignValueProgrammatically(e){e=this._dateAdapter.deserialize(e),this._lastValueValid=this._isValidValue(e),e=this._dateAdapter.getValidDateOrNull(e),this._assignValue(e),this._formatValue(e)}_matchesFilter(e){const i=this._getDateFilter();return!i||i(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Ps,8),ve(gf,8))},n.\u0275dir=Vt({type:n,inputs:{value:"value",disabled:"disabled"},outputs:{dateChange:"dateChange",dateInput:"dateInput"},features:[tr]}),n})();const Q6={provide:fu,useExisting:ci(()=>BE),multi:!0},J6={provide:ks,useExisting:ci(()=>BE),multi:!0};let BE=(()=>{class n extends X6{set matDatepicker(e){e&&(this._datepicker=e,this._closedSubscription=e.closedStream.subscribe(()=>this._onTouched()),this._registerModel(e.registerInput(this)))}get min(){return this._min}set min(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._min)||(this._min=i,this._validatorOnChange())}get max(){return this._max}set max(e){const i=this._dateAdapter.getValidDateOrNull(this._dateAdapter.deserialize(e));this._dateAdapter.sameDate(i,this._max)||(this._max=i,this._validatorOnChange())}get dateFilter(){return this._dateFilter}set dateFilter(e){const i=this._matchesFilter(this.value);this._dateFilter=e,this._matchesFilter(this.value)!==i&&this._validatorOnChange()}constructor(e,i,o,c){super(e,i,o),this._formField=c,this._closedSubscription=Ie.EMPTY,this._validator=BC.compose(super._getValidators())}getConnectedOverlayOrigin(){return this._formField?this._formField.getConnectedOverlayOrigin():this._elementRef}getOverlayLabelId(){return this._formField?this._formField.getLabelId():this._elementRef.nativeElement.getAttribute("aria-labelledby")}getThemePalette(){return this._formField?this._formField.color:void 0}getStartValue(){return this.value}ngOnDestroy(){super.ngOnDestroy(),this._closedSubscription.unsubscribe()}_openPopup(){this._datepicker&&this._datepicker.open()}_getValueFromModel(e){return e}_assignValueToModel(e){this._model&&this._model.updateSelection(e,this)}_getMinDate(){return this._min}_getMaxDate(){return this._max}_getDateFilter(){return this._dateFilter}_shouldHandleChangeEvent(e){return e.source!==this}}return n.\u0275fac=function(e){return new(e||n)(ve(_i),ve(Ps,8),ve(gf,8),ve(mx,8))},n.\u0275dir=Vt({type:n,selectors:[["input","matDatepicker",""]],hostAttrs:[1,"mat-datepicker-input"],hostVars:6,hostBindings:function(e,i){1&e&&mn("input",function(c){return i._onInput(c.target.value)})("change",function(){return i._onChange()})("blur",function(){return i._onBlur()})("keydown",function(c){return i._onKeydown(c)}),2&e&&(Fm("disabled",i.disabled),Ze("aria-haspopup",i._datepicker?"dialog":null)("aria-owns",(null==i._datepicker?null:i._datepicker.opened)&&i._datepicker.id||null)("min",i.min?i._dateAdapter.toIso8601(i.min):null)("max",i.max?i._dateAdapter.toIso8601(i.max):null)("data-mat-calendar",i._datepicker?i._datepicker.id:null))},inputs:{matDatepicker:"matDatepicker",min:"min",max:"max",dateFilter:["matDatepickerFilter","dateFilter"]},exportAs:["matDatepickerInput"],features:[Ki([Q6,J6,{provide:qk,useExisting:n}]),Zn]}),n})(),e$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Vt({type:n,selectors:[["","matDatepickerToggleIcon",""]]}),n})(),t$=(()=>{class n{get disabled(){return void 0===this._disabled&&this.datepicker?this.datepicker.disabled:!!this._disabled}set disabled(e){this._disabled=xr(e)}constructor(e,i,o){this._intl=e,this._changeDetectorRef=i,this._stateChanges=Ie.EMPTY;const c=Number(o);this.tabIndex=c||0===c?c:null}ngOnChanges(e){e.datepicker&&this._watchStateChanges()}ngOnDestroy(){this._stateChanges.unsubscribe()}ngAfterContentInit(){this._watchStateChanges()}_open(e){this.datepicker&&!this.disabled&&(this.datepicker.open(),e.stopPropagation())}_watchStateChanges(){const e=this.datepicker?this.datepicker.stateChanges:sn(),i=this.datepicker&&this.datepicker.datepickerInput?this.datepicker.datepickerInput.stateChanges:sn(),o=this.datepicker?qr(this.datepicker.openedStream,this.datepicker.closedStream):sn();this._stateChanges.unsubscribe(),this._stateChanges=qr(this._intl.changes,e,i,o).subscribe(()=>this._changeDetectorRef.markForCheck())}}return n.\u0275fac=function(e){return new(e||n)(ve(Jy),ve(pa),gd("tabindex"))},n.\u0275cmp=mi({type:n,selectors:[["mat-datepicker-toggle"]],contentQueries:function(e,i,o){if(1&e&&Ml(o,e$,5),2&e){let c;Gi(c=qi())&&(i._customIcon=c.first)}},viewQuery:function(e,i){if(1&e&&mo(I6,5),2&e){let o;Gi(o=qi())&&(i._button=o.first)}},hostAttrs:[1,"mat-datepicker-toggle"],hostVars:8,hostBindings:function(e,i){1&e&&mn("click",function(c){return i._open(c)}),2&e&&(Ze("tabindex",null)("data-mat-calendar",i.datepicker?i.datepicker.id:null),vr("mat-datepicker-toggle-active",i.datepicker&&i.datepicker.opened)("mat-accent",i.datepicker&&"accent"===i.datepicker.color)("mat-warn",i.datepicker&&"warn"===i.datepicker.color))},inputs:{datepicker:["for","datepicker"],tabIndex:"tabIndex",ariaLabel:["aria-label","ariaLabel"],disabled:"disabled",disableRipple:"disableRipple"},exportAs:["matDatepickerToggle"],features:[tr],ngContentSelectors:R6,decls:4,vars:6,consts:[["mat-icon-button","","type","button",3,"disabled","disableRipple"],["button",""],["class","mat-datepicker-toggle-default-icon","viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",4,"ngIf"],["viewBox","0 0 24 24","width","24px","height","24px","fill","currentColor","focusable","false",1,"mat-datepicker-toggle-default-icon"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"]],template:function(e,i){1&e&&(Dl(P6),pe(0,"button",0,1),$t(2,k6,2,0,"svg",2),yr(3),xe()),2&e&&(ht("disabled",i.disabled)("disableRipple",i.disableRipple),Ze("aria-haspopup",i.datepicker?"dialog":null)("aria-label",i.ariaLabel||i._intl.openCalendarLabel)("tabindex",i.disabled?-1:i.tabIndex),Et(2),ht("ngIf",!i._customIcon))},dependencies:[hy,kk],styles:[".mat-datepicker-toggle{pointer-events:auto}.cdk-high-contrast-active .mat-datepicker-toggle-default-icon{color:CanvasText}"],encapsulation:2,changeDetection:0}),n})(),r$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[Jy,q6],imports:[jm,Sj,dk,Z4,Q2,ma,dx]}),n})();class o${get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}constructor(t=!1,e,i=!0,o){this._multiple=t,this._emitChanges=i,this.compareWith=o,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new yn,e&&e.length&&(t?e.forEach(c=>this._markSelected(c)):this._markSelected(e[0]),this._selectedToEmit.length=0)}select(...t){this._verifyValueAssignment(t),t.forEach(i=>this._markSelected(i));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}deselect(...t){this._verifyValueAssignment(t),t.forEach(i=>this._unmarkSelected(i));const e=this._hasQueuedChanges();return this._emitChangeEvent(),e}setSelection(...t){this._verifyValueAssignment(t);const e=this.selected,i=new Set(t);t.forEach(c=>this._markSelected(c)),e.filter(c=>!i.has(c)).forEach(c=>this._unmarkSelected(c));const o=this._hasQueuedChanges();return this._emitChangeEvent(),o}toggle(t){return this.isSelected(t)?this.deselect(t):this.select(t)}clear(t=!0){this._unmarkAll();const e=this._hasQueuedChanges();return t&&this._emitChangeEvent(),e}isSelected(t){return this._selection.has(this._getConcreteValue(t))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(t){this._multiple&&this.selected&&this._selected.sort(t)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(t){t=this._getConcreteValue(t),this.isSelected(t)||(this._multiple||this._unmarkAll(),this.isSelected(t)||this._selection.add(t),this._emitChanges&&this._selectedToEmit.push(t))}_unmarkSelected(t){t=this._getConcreteValue(t),this.isSelected(t)&&(this._selection.delete(t),this._emitChanges&&this._deselectedToEmit.push(t))}_unmarkAll(){this.isEmpty()||this._selection.forEach(t=>this._unmarkSelected(t))}_verifyValueAssignment(t){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(t){if(this.compareWith){for(let e of this._selection)if(this.compareWith(t,e))return e;return t}return t}}const s$=["trigger"],a$=["panel"];function l$(n,t){if(1&n&&(pe(0,"span",10),Qe(1),xe()),2&n){const e=ri();Et(1),ms(e.placeholder)}}function c$(n,t){if(1&n&&(pe(0,"span",14),Qe(1),xe()),2&n){const e=ri(2);Et(1),ms(e.triggerValue)}}function u$(n,t){1&n&&yr(0,0,["*ngSwitchCase","true"])}function d$(n,t){1&n&&(pe(0,"span",11),$t(1,c$,2,1,"span",12),$t(2,u$,1,0,"ng-content",13),xe()),2&n&&(ht("ngSwitch",!!ri().customTrigger),Et(2),ht("ngSwitchCase",!0))}function h$(n,t){if(1&n){const e=Xi();q(),re(),pe(0,"div",15,16),mn("@transformPanel.done",function(o){return uo(e),Kr(ri()._panelDoneAnimatingStream.next(o.toState))})("keydown",function(o){return uo(e),Kr(ri()._handleKeydown(o))}),yr(2,1),xe()}if(2&n){const e=ri();tM("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",e._getPanelTheme(),""),ht("ngClass",e.panelClass)("@transformPanel","showing"),Ze("id",e.id+"-panel")("aria-multiselectable",e.multiple)("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby())}}const p$=[[["mat-select-trigger"]],"*"],f$=["mat-select-trigger","*"],m$={transformPanelWrap:Ky("transformPanelWrap",[Qh("* => void",Ij("@transformPanel",[Aj()],{optional:!0}))]),transformPanel:Ky("transformPanel",[px("void",rl({opacity:0,transform:"scale(1, 0.8)"})),Qh("void => showing",_f("120ms cubic-bezier(0, 0, 0.2, 1)",rl({opacity:1,transform:"scale(1, 1)"}))),Qh("* => void",_f("100ms linear",rl({opacity:0})))])};let rP=0;const oP=new wt("mat-select-scroll-strategy"),_$=new wt("MAT_SELECT_CONFIG"),y$={provide:oP,deps:[sg],useFactory:function g$(n){return()=>n.scrollStrategies.reposition()}},v$=new wt("MatSelectTrigger");class b${constructor(t,e){this.source=t,this.value=e}}const x$=gk(KU(fk(_k(class{constructor(n,t,e,i,o){this._elementRef=n,this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=i,this.ngControl=o,this.stateChanges=new yn}}))));let w$=(()=>{class n extends x${get focused(){return this._focused||this._panelOpen}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required??this.ngControl?.control?.hasValidator(BC.required)??!1}set required(e){this._required=xr(e),this.stateChanges.next()}get multiple(){return this._multiple}set multiple(e){this._multiple=xr(e)}get disableOptionCentering(){return this._disableOptionCentering}set disableOptionCentering(e){this._disableOptionCentering=xr(e)}get compareWith(){return this._compareWith}set compareWith(e){this._compareWith=e,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(e){this._assignValue(e)&&this._onChange(e)}get typeaheadDebounceInterval(){return this._typeaheadDebounceInterval}set typeaheadDebounceInterval(e){this._typeaheadDebounceInterval=mE(e)}get id(){return this._id}set id(e){this._id=e||this._uid,this.stateChanges.next()}constructor(e,i,o,c,f,v,C,S,R,V,Q,oe,me,Ee){super(f,c,C,S,V),this._viewportRuler=e,this._changeDetectorRef=i,this._ngZone=o,this._dir=v,this._parentFormField=R,this._liveAnnouncer=me,this._defaultOptions=Ee,this._panelOpen=!1,this._compareWith=($e,lt)=>$e===lt,this._uid="mat-select-"+rP++,this._triggerAriaLabelledBy=null,this._destroy=new yn,this._onChange=()=>{},this._onTouched=()=>{},this._valueId="mat-select-value-"+rP++,this._panelDoneAnimatingStream=new yn,this._overlayPanelClass=this._defaultOptions?.overlayPanelClass||"",this._focused=!1,this.controlType="mat-select",this._multiple=!1,this._disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1,this.ariaLabel="",this.optionSelectionChanges=_y(()=>{const $e=this.options;return $e?$e.changes.pipe(Uh($e),Ys(()=>qr(...$e.map(lt=>lt.onSelectionChange)))):this._ngZone.onStable.pipe(ro(1),Ys(()=>this.optionSelectionChanges))}),this.openedChange=new on,this._openedStream=this.openedChange.pipe(oo($e=>$e),nn(()=>{})),this._closedStream=this.openedChange.pipe(oo($e=>!$e),nn(()=>{})),this.selectionChange=new on,this.valueChange=new on,this.ngControl&&(this.ngControl.valueAccessor=this),null!=Ee?.typeaheadDebounceInterval&&(this._typeaheadDebounceInterval=Ee.typeaheadDebounceInterval),this._scrollStrategyFactory=oe,this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=parseInt(Q)||0,this.id=this.id}ngOnInit(){this._selectionModel=new o$(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(S2(),il(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen))}ngAfterContentInit(){this._initKeyManager(),this._selectionModel.changed.pipe(il(this._destroy)).subscribe(e=>{e.added.forEach(i=>i.select()),e.removed.forEach(i=>i.deselect())}),this.options.changes.pipe(Uh(null),il(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const e=this._getTriggerAriaLabelledby(),i=this.ngControl;if(e!==this._triggerAriaLabelledBy){const o=this._elementRef.nativeElement;this._triggerAriaLabelledBy=e,e?o.setAttribute("aria-labelledby",e):o.removeAttribute("aria-labelledby")}i&&(this._previousControl!==i.control&&(void 0!==this._previousControl&&null!==i.disabled&&i.disabled!==this.disabled&&(this.disabled=i.disabled),this._previousControl=i.control),this.updateErrorState())}ngOnChanges(e){(e.disabled||e.userAriaDescribedBy)&&this.stateChanges.next(),e.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this._typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck())}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched())}writeValue(e){this._assignValue(e)}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this.disabled=e,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const e=this._selectionModel.selected.map(i=>i.viewValue);return this._isRtl()&&e.reverse(),e.join(", ")}return this._selectionModel.selected[0].viewValue}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(e){this.disabled||(this.panelOpen?this._handleOpenKeydown(e):this._handleClosedKeydown(e))}_handleClosedKeydown(e){const i=e.keyCode,o=40===i||38===i||37===i||39===i,c=13===i||32===i,f=this._keyManager;if(!f.isTyping()&&c&&!mu(e)||(this.multiple||e.altKey)&&o)e.preventDefault(),this.open();else if(!this.multiple){const v=this.selected;f.onKeydown(e);const C=this.selected;C&&v!==C&&this._liveAnnouncer.announce(C.viewValue,1e4)}}_handleOpenKeydown(e){const i=this._keyManager,o=e.keyCode,c=40===o||38===o,f=i.isTyping();if(c&&e.altKey)e.preventDefault(),this.close();else if(f||13!==o&&32!==o||!i.activeItem||mu(e))if(!f&&this._multiple&&65===o&&e.ctrlKey){e.preventDefault();const v=this.options.some(C=>!C.disabled&&!C.selected);this.options.forEach(C=>{C.disabled||(v?C.select():C.deselect())})}else{const v=i.activeItemIndex;i.onKeydown(e),this._multiple&&c&&e.shiftKey&&i.activeItem&&i.activeItemIndex!==v&&i.activeItem._selectViaInteraction()}else e.preventDefault(),i.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(ro(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(e){if(this.options.forEach(i=>i.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&e)Array.isArray(e),e.forEach(i=>this._selectOptionByValue(i)),this._sortValues();else{const i=this._selectOptionByValue(e);i?this._keyManager.updateActiveItem(i):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(e){const i=this.options.find(o=>{if(this._selectionModel.isSelected(o))return!1;try{return null!=o.value&&this._compareWith(o.value,e)}catch{return!1}});return i&&this._selectionModel.select(i),i}_assignValue(e){return!!(e!==this._value||this._multiple&&Array.isArray(e))&&(this.options&&this._setSelectionByValue(e),this._value=e,!0)}_initKeyManager(){this._keyManager=new C4(this.options).withTypeAhead(this._typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const e=qr(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(il(e)).subscribe(i=>{this._onSelect(i.source,i.isUserInput),i.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),qr(...this.options.map(i=>i._stateChanges)).pipe(il(e)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(e,i){const o=this._selectionModel.isSelected(e);null!=e.value||this._multiple?(o!==e.selected&&(e.selected?this._selectionModel.select(e):this._selectionModel.deselect(e)),i&&this._keyManager.setActiveItem(e),this.multiple&&(this._sortValues(),i&&this.focus())):(e.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(e.value)),o!==this._selectionModel.isSelected(e)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const e=this.options.toArray();this._selectionModel.sort((i,o)=>this.sortComparator?this.sortComparator(i,o,e):e.indexOf(i)-e.indexOf(o)),this.stateChanges.next()}}_propagateChanges(e){let i=null;i=this.multiple?this.selected.map(o=>o.value):this.selected?this.selected.value:e,this._value=i,this.valueChange.emit(i),this._onChange(i),this.selectionChange.emit(this._getChangeEvent(i)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){this._keyManager&&(this.empty?this._keyManager.setFirstItemActive():this._keyManager.setActiveItem(this._selectionModel.selected[0]))}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(e){this._elementRef.nativeElement.focus(e)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();return this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const e=this._parentFormField?.getLabelId();let i=(e?e+" ":"")+this._valueId;return this.ariaLabelledby&&(i+=" "+this.ariaLabelledby),i}_panelDoneAnimating(e){this.openedChange.emit(e)}setDescribedByIds(e){e.length?this._elementRef.nativeElement.setAttribute("aria-describedby",e.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this._panelOpen||!this.empty||this._focused&&!!this._placeholder}}return n.\u0275fac=function(e){return new(e||n)(ve(ux),ve(pa),ve(Pn),ve(yk),ve(_i),ve(gu,8),ve(hf,8),ve(Vy,8),ve(mx,8),ve(Xu,10),gd("tabindex"),ve(oP),ve(G4),ve(_$,8))},n.\u0275dir=Vt({type:n,viewQuery:function(e,i){if(1&e&&(mo(s$,5),mo(a$,5),mo(uk,5)),2&e){let o;Gi(o=qi())&&(i.trigger=o.first),Gi(o=qi())&&(i.panel=o.first),Gi(o=qi())&&(i._overlayDir=o.first)}},inputs:{userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",placeholder:"placeholder",required:"required",multiple:"multiple",disableOptionCentering:"disableOptionCentering",compareWith:"compareWith",value:"value",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:"typeaheadDebounceInterval",sortComparator:"sortComparator",id:"id"},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},features:[Zn,tr]}),n})(),C$=(()=>{class n extends w${constructor(){super(...arguments),this._positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}],this._hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}ngOnInit(){super.ngOnInit(),this._viewportRuler.change().pipe(il(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(),this._changeDetectorRef.detectChanges())})}ngAfterViewInit(){this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin())}open(){this._overlayWidth=this._getOverlayWidth(),super.open(),this.stateChanges.next()}close(){super.close(),this.stateChanges.next()}_scrollOptionIntoView(e){const i=this.options.toArray()[e];if(i){const o=this.panel.nativeElement,c=function mj(n,t,e){if(e.length){let i=t.toArray(),o=e.toArray(),c=0;for(let f=0;f<n+1;f++)i[f].group&&i[f].group===o[c]&&c++;return c}return 0}(e,this.options,this.optionGroups),f=i._getHostElement();o.scrollTop=0===e&&1===c?0:function gj(n,t,e,i){return n<e?n:n+t>e+i?Math.max(0,n-i+t):e}(f.offsetTop,f.offsetHeight,o.scrollTop,o.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(e){return new b$(this,e)}_getOverlayWidth(){return(this._preferredOverlayOrigin instanceof CE?this._preferredOverlayOrigin.elementRef:this._preferredOverlayOrigin||this._elementRef).nativeElement.getBoundingClientRect().width}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=xr(e),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=Jr(n)))(i||n)}}(),n.\u0275cmp=mi({type:n,selectors:[["mat-select"]],contentQueries:function(e,i,o){if(1&e&&(Ml(o,v$,5),Ml(o,Sk,5),Ml(o,Mk,5)),2&e){let c;Gi(c=qi())&&(i.customTrigger=c.first),Gi(c=qi())&&(i.options=c),Gi(c=qi())&&(i.optionGroups=c)}},hostAttrs:["role","combobox","aria-autocomplete","none","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(e,i){1&e&&mn("keydown",function(c){return i._handleKeydown(c)})("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()}),2&e&&(Ze("id",i.id)("tabindex",i.tabIndex)("aria-controls",i.panelOpen?i.id+"-panel":null)("aria-expanded",i.panelOpen)("aria-label",i.ariaLabel||null)("aria-required",i.required.toString())("aria-disabled",i.disabled.toString())("aria-invalid",i.errorState)("aria-activedescendant",i._getAriaActiveDescendant()),vr("mat-mdc-select-disabled",i.disabled)("mat-mdc-select-invalid",i.errorState)("mat-mdc-select-required",i.required)("mat-mdc-select-empty",i.empty)("mat-mdc-select-multiple",i.multiple))},inputs:{disabled:"disabled",disableRipple:"disableRipple",tabIndex:"tabIndex",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matSelect"],features:[Ki([{provide:TE,useExisting:n},{provide:Dk,useExisting:n}]),Zn],ngContentSelectors:f$,decls:11,vars:11,consts:[["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],[1,"mat-mdc-select-value",3,"ngSwitch"],["class","mat-mdc-select-placeholder mat-mdc-select-min-line",4,"ngSwitchCase"],["class","mat-mdc-select-value-text",3,"ngSwitch",4,"ngSwitchCase"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth","backdropClick","attach","detach"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text",3,"ngSwitch"],["class","mat-mdc-select-min-line",4,"ngSwitchDefault"],[4,"ngSwitchCase"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"ngClass","keydown"],["panel",""]],template:function(e,i){if(1&e&&(Dl(p$),pe(0,"div",0,1),mn("click",function(){return i.toggle()}),pe(3,"div",2),$t(4,l$,2,1,"span",3),$t(5,d$,3,2,"span",4),xe(),pe(6,"div",5)(7,"div",6),q(),pe(8,"svg",7),It(9,"path",8),xe()()()(),$t(10,h$,3,9,"ng-template",9),mn("backdropClick",function(){return i.close()})("attach",function(){return i._onAttached()})("detach",function(){return i.close()})),2&e){const o=Ii(1);Ze("aria-owns",i.panelOpen?i.id+"-panel":null),Et(3),ht("ngSwitch",i.empty),Ze("id",i._valueId),Et(1),ht("ngSwitchCase",!0),Et(1),ht("ngSwitchCase",!1),Et(5),ht("cdkConnectedOverlayPanelClass",i._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",i._scrollStrategy)("cdkConnectedOverlayOrigin",i._preferredOverlayOrigin||o)("cdkConnectedOverlayOpen",i.panelOpen)("cdkConnectedOverlayPositions",i._positions)("cdkConnectedOverlayWidth",i._overlayWidth)}},dependencies:[dy,nf,py,xT,uk,CE],styles:['.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-width:var(--mdc-menu-max-width, calc(100vw - 32px));max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height, calc(100vh - 32px));margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;border-radius:4px;border-radius:var(--mdc-shape-medium, 4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:none}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(0.8);opacity:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0}[dir=rtl] .mdc-menu-surface,.mdc-menu-surface[dir=rtl]{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}.mat-mdc-select{display:inline-block;width:100%;outline:none}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:translateY(-8px)}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-select-arrow{width:10px;height:5px;position:relative}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}.cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .cdk-high-contrast-active .mat-mdc-select-arrow svg{fill:GrayText}.mdc-menu-surface.mat-mdc-select-panel{width:100%;max-height:275px;position:static;outline:0;margin:0;padding:8px 0;list-style-type:none}.mdc-menu-surface.mat-mdc-select-panel:focus{outline:none}.cdk-high-contrast-active .mdc-menu-surface.mat-mdc-select-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) .mdc-menu-surface.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above .mdc-menu-surface.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100% / 0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}'],encapsulation:2,data:{animation:[m$.transformPanel]},changeDetection:0}),n})(),E$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[y$],imports:[jm,dk,Tk,ma,dx,gx,Tk,ma]}),n})(),D$=(()=>{class n{constructor(e){this.localStorageService=e,this.nombre="",this.correo="",this.tel="",this.fecha="",this.habitacion="",this.minDate=new Date}guardarRegistro(){const e={nombre:this.nombre,correo:this.correo,tel:this.tel,fecha:this.fecha,habitacion:this.habitacion};this.localStorageService.obtenerRegistros().find(c=>c.fecha===e.fecha)?v2().fire({icon:"error",title:"La fecha ya existe en los registros.",showConfirmButton:!1,timer:1500}):(this.localStorageService.guardarRegistro(e),v2().fire({icon:"success",title:"\xa1Registro guardado!",showConfirmButton:!1,timer:1500}),this.nombre="",this.correo="",this.tel="",this.fecha="",this.habitacion="")}}return n.\u0275fac=function(e){return new(e||n)(ve(aE))},n.\u0275cmp=mi({type:n,selectors:[["app-registro"]],decls:60,vars:8,consts:[["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1"],["rel","stylesheet","href","https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"],[1,"container",2,"background-color","#FFC4C4"],[1,"mb-4"],[3,"submit"],[1,"form-group"],["for","nombre"],["type","text","name","nombre","id","nombre","placeholder","Introduce tu nombre",1,"form-control",3,"ngModel","ngModelChange"],["for","correo"],["type","email","name","correo","id","correo","placeholder","Introduce tu correo electr\xf3nico",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-group","mb-4"],["for","telefono"],["type","tel","name","tel","id","telefono","placeholder","Introduce tu n\xfamero de tel\xe9fono",1,"form-control",3,"ngModel","ngModelChange"],[1,"text-center","form-group","mb-4",2,"background-color","#FFC4C4","border-color","#FFC4C4"],["for","habitacion"],["appearance","fill"],["name","habitacion","id","habitacion",3,"ngModel","ngModelChange"],["value","Individual"],["value","Doble"],["value","Triple"],["value","Familiar"],["value","Suite"],["name","fecha","matInput","",3,"ngModel","matDatepicker","min","ngModelChange"],[1,"text-center"],["matSuffix","",3,"for"],["picker",""],["type","submit",1,"btn","btn-primary"]],template:function(e,i){if(1&e&&(pe(0,"html")(1,"head")(2,"title"),Qe(3,"Formulario de contacto"),xe(),It(4,"meta",0)(5,"meta",1)(6,"link",2),xe(),pe(7,"body")(8,"div",3)(9,"h2",4),Qe(10,"FORMULARIO PARA EL HOTEL"),xe(),pe(11,"form",5),mn("submit",function(){return i.guardarRegistro()}),pe(12,"h2"),Qe(13,"Registro"),xe(),pe(14,"div",6)(15,"label",7),Qe(16,"Nombre:"),xe(),pe(17,"input",8),mn("ngModelChange",function(c){return i.nombre=c}),xe()(),pe(18,"div",6)(19,"label",9),Qe(20,"Correo electr\xf3nico:"),xe(),pe(21,"input",10),mn("ngModelChange",function(c){return i.correo=c}),xe()(),pe(22,"div",11)(23,"label",12),Qe(24,"Tel\xe9fono:"),xe(),pe(25,"input",13),mn("ngModelChange",function(c){return i.tel=c}),xe()(),pe(26,"div",14)(27,"div",11)(28,"div")(29,"label",15),Qe(30,"Habitaci\xf3n:"),xe()(),pe(31,"mat-form-field",16)(32,"mat-label"),Qe(33,"Seleccione su habitaci\xf3n"),xe(),pe(34,"mat-select",17),mn("ngModelChange",function(c){return i.habitacion=c}),pe(35,"mat-option",18),Qe(36,"Individual"),xe(),pe(37,"mat-option",19),Qe(38,"Doble"),xe(),pe(39,"mat-option",20),Qe(40,"Triple"),xe(),pe(41,"mat-option",21),Qe(42,"Familiar"),xe(),pe(43,"mat-option",22),Qe(44,"Suite"),xe()()()(),pe(45,"div",14)(46,"div")(47,"label"),Qe(48,"Elige la fecha de reserva:"),xe()(),pe(49,"mat-form-field",16)(50,"mat-label"),Qe(51,"Escoge una fecha"),xe(),pe(52,"input",23),mn("ngModelChange",function(c){return i.fecha=c}),xe(),pe(53,"mat-hint",24),Qe(54,"MM/DD/YYYY"),xe(),It(55,"mat-datepicker-toggle",25)(56,"mat-datepicker",null,26),xe()()(),pe(58,"button",27),Qe(59,"Guardar"),xe()()()()()),2&e){const o=Ii(57);Et(17),ht("ngModel",i.nombre),Et(4),ht("ngModel",i.correo),Et(4),ht("ngModel",i.tel),Et(9),ht("ngModel",i.habitacion),Et(18),ht("ngModel",i.fecha)("matDatepicker",o)("min",i.minDate),Et(3),ht("for",o)}},dependencies:[eE,Fy,jC,$C,J0,hf,Y6,BE,t$,g6,u6,ME,SE,r6,C$,Sk],styles:["body[_ngcontent-%COMP%]{background-color:#fff5e4;font-family:Arial,sans-serif}.container[_ngcontent-%COMP%]{background-color:#fff;padding:30px;margin-top:50px;border-radius:10px;box-shadow:0 0 10px #00000080}.form-control[_ngcontent-%COMP%]{border-color:#ee6983;box-shadow:none}.form-control[_ngcontent-%COMP%]:focus{border-color:#850e35;box-shadow:none}label[_ngcontent-%COMP%]{color:#850e35;font-weight:700}.btn-primary[_ngcontent-%COMP%]{background-color:#850e35;border-color:#850e35;font-weight:700}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#ee6983;border-color:#ee6983}"]}),n})();function M$(n,t){if(1&n&&(pe(0,"tr")(1,"td"),Qe(2),xe(),pe(3,"td"),Qe(4),xe(),pe(5,"td"),Qe(6),xe(),pe(7,"td"),Qe(8),xe(),pe(9,"td"),Qe(10),xe()()),2&n){const e=t.$implicit;Et(2),ms(e.nombre),Et(2),ms(e.correo),Et(2),ms(e.tel),Et(2),ms(e.fecha),Et(2),ms(e.habitacion)}}let S$=(()=>{class n{constructor(e){this.localStorageService=e,this.registros=[],this.registros=this.localStorageService.obtenerRegistros()}}return n.\u0275fac=function(e){return new(e||n)(ve(aE))},n.\u0275cmp=mi({type:n,selectors:[["app-reservaciones"]],decls:15,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(pe(0,"table")(1,"thead")(2,"tr")(3,"th"),Qe(4,"Nombre"),xe(),pe(5,"th"),Qe(6,"Correo"),xe(),pe(7,"th"),Qe(8,"Tel\xe9fono"),xe(),pe(9,"th"),Qe(10,"Fecha"),xe(),pe(11,"th"),Qe(12,"Habitaci\xf3n"),xe()()(),pe(13,"tbody"),$t(14,M$,11,5,"tr",0),xe()()),2&e&&(Et(14),ht("ngForOf",i.registros))},dependencies:[Um],styles:["table[_ngcontent-%COMP%]{border-collapse:collapse;width:80%;margin:20px auto 0}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:left;padding:8px}th[_ngcontent-%COMP%]{background-color:#850e35;color:#fff}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#fff5e4}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#ffc4c4}tr[_ngcontent-%COMP%]:hover{background-color:#ee6983}","table[_ngcontent-%COMP%] {\n        margin: 0 auto;\n        border-collapse: collapse;\n      }\n      \n      td[_ngcontent-%COMP%], th[_ngcontent-%COMP%] {\n        border: 1px solid black;\n        padding: 5px;\n      }"]}),n})(),T$=(()=>{class n{constructor(e){this.domSanitizer=e}transform(e,i){return this.domSanitizer.bypassSecurityTrustResourceUrl(i+e)}}return n.\u0275fac=function(e){return new(e||n)(ve(y0,16))},n.\u0275pipe=Ir({name:"video",type:n,pure:!0}),n})(),A$=(()=>{class n{constructor(){this.video="4K6Sh1tsAW4"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-galeria"]],decls:70,vars:4,consts:[[1,"container","text-center"],[2,"color","#EE6983","font-size","24px","font-weight","bold"],["id","gallery",1,"gallery"],["width","560","height","315","frameborder","0","allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",1,"swiper-slide",3,"src"],["id","childern"],[1,"card-columns"],[1,"card"],["src","https://www.yavas.com/images/upload/EM_hoteles/LosCabos-hotel-barato.jpg","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],["src","https://www.qhotels.es/wp-content/uploads/2022/12/pano-hotel_1500-e1672331060671.jpg","alt","...",1,"card-img-top"],["src","https://es.israel21c.org/wp-content/uploads/2022/07/setai-main-1168x657.png","alt","...",1,"card-img"],[1,"card","bg-primary","text-white","text-center","p-3"],[1,"blockquote","mb-0"],[1,"blockquote-footer","text-white"],["title","Source Title"],[1,"card","text-center"],["src","https://e00-expansion.uecdn.es/assets/multimedia/imagenes/2022/02/08/16443177167892.jpg","alt","...",1,"card-img"],["src","https://neextt.com/wp-content/uploads/2021/02/nuevos-hoteles-abriran-mexico-2021-1.jpg","alt","...",1,"card-img"],[1,"card","p-3","text-right"],["src","https://static1.eskypartners.com/travelguide/vancouver-hotels.jpg","alt","...",1,"card-img"],["src","https://www.oaxaca-mio.com/oaxaca/wp-content/uploads/2020/04/FOTO_CASADEADOBE.jpg","alt","...",1,"card-img"],[1,"card-text"],[1,"text-muted"],["src","https://booked.mx/data/Photos/380x200/7250/725056/725056252/Casa-Marlene-Hotel-Valladolid-Exterior.JPEG","alt","...",1,"card-img"],["src","https://casablancasayulita.com/wp-content/uploads/2022/04/Jacuzzi-de-asotea-en-sayulita.jpg","alt","...",1,"card-img"],["src","https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/900/450/75/vision-dam/digital/parks-platform/parks-global-assets/disneyland/resorts/disneys-grand-californian-hotel-and-spa/spa/Relaxation-Lounge-16x9.jpg?2021-11-01T16:41:40+00:00","alt","...",1,"card-img"]],template:function(e,i){1&e&&(pe(0,"div",0)(1,"h3",1),Qe(2,"Video Axolotl Palace"),xe(),pe(3,"section",2),It(4,"iframe",3),function JM(n,t){const e=ui();let i;const o=n+Ai;e.firstCreatePass?(i=function vO(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[o]=i,i.onDestroy&&(e.destroyHooks??(e.destroyHooks=[])).push(o,i.onDestroy)):i=e.data[o];const c=i.factory||(i.factory=Vc(i.type)),f=Co(ve);try{const v=ho(!1),C=c();return ho(v),function Hi(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,ft(),o,C),C}finally{Co(f)}}(5,"video"),xe()(),pe(6,"div",0)(7,"h3",1),Qe(8,"Galeria Axolotl Palace"),xe(),pe(9,"div",4)(10,"div",5)(11,"div",6),It(12,"img",7),pe(13,"div",8)(14,"h5",9),Qe(15,"Una de nuestras habitaciones"),xe()()(),pe(16,"div",6),It(17,"img",10),pe(18,"div",8)(19,"h5",9),Qe(20,"Disfruta nuestro hotel"),xe()()(),pe(21,"div",6),It(22,"img",11),xe(),pe(23,"div",12)(24,"blockquote",13)(25,"footer",14)(26,"small")(27,"cite",15),Qe(28,"Te vas a relajar"),xe()()()()(),pe(29,"div",16)(30,"div",8)(31,"h5",9),Qe(32,"Habitacion"),xe(),It(33,"img",17),xe()(),pe(34,"div",6),It(35,"img",18),xe(),pe(36,"div",19),It(37,"img",20),xe(),pe(38,"div",6)(39,"div",8),It(40,"img",21),pe(41,"h5",9),Qe(42,"Uno de nuestros mejores lugares"),xe(),pe(43,"p",22)(44,"small",23),Qe(45,"La mas comoda"),xe()()()(),pe(46,"div",6),It(47,"img",24),xe(),pe(48,"div",12)(49,"blockquote",13)(50,"footer",14)(51,"small")(52,"cite",15),Qe(53,"No hay problemas "),xe()()()()(),pe(54,"div",6),It(55,"img",25),xe(),pe(56,"div",12)(57,"blockquote",13)(58,"footer",14)(59,"small")(60,"cite",15),Qe(61,"Aqui no te vas a estresar"),xe()()()()(),pe(62,"div",6),It(63,"img",26),xe(),pe(64,"div",12)(65,"blockquote",13)(66,"footer",14)(67,"small")(68,"cite",15),Qe(69,"Te vas a relajar"),xe()()()()()()()()),2&e&&(Et(4),ht("src",eS(5,1,i.video,"https://www.youtube.com/embed/"),Rp))},dependencies:[T$],styles:["@media (min-width: 576px){.card-columns[_ngcontent-%COMP%]{column-count:2}}@media (min-width: 768px){.card-columns[_ngcontent-%COMP%]{column-count:3}}@media (min-width: 992px){.card-columns[_ngcontent-%COMP%]{column-count:4}}@media (min-width: 1200px){.card-columns[_ngcontent-%COMP%]{column-count:5}}",".grid[_ngcontent-%COMP%] {\n  width: 100%;\n  display: grid;\n  grid-gap: 20px;\n\n  .custom-heading {\n      color: #EE6983;\n      font-size: 24px;\n      font-weight: bold;\n    }\n}\n\n@media (min-width: 768px) {\n  .grid[_ngcontent-%COMP%] {\n    grid-template-columns: repeat(5, 1fr);\n  }\n}"]}),n})(),sP=(()=>{class n{constructor(){this.habitaciones=[{id:1,nombre:"Habitaci\xf3n individual",tipo:"Individual",precio:500,descripcion:"Habitaci\xf3n para una persona",imagen:"https://bufondearenillashotel.es/wp-content/uploads/2015/02/habitacion-individual.jpg"},{id:2,nombre:"Habitaci\xf3n doble",tipo:"Doble",precio:800,descripcion:"Habitaci\xf3n para dos personas",imagen:"https://hotelmalinallihuamantla.com/wp-content/uploads/2019/12/habitacion-doble-malinalli-1.jpg"},{id:3,nombre:"Habitaci\xf3n triple",tipo:"Triple",precio:1100,descripcion:"Habitaci\xf3n para tres personas",imagen:"https://hotelflamingoinn.com.mx/wp-content/uploads/2021/05/habitacion-ejecuiva-triple.jpg"},{id:4,nombre:"Suite",tipo:"Suite",precio:1500,descripcion:"Habitaci\xf3n de lujo para dos personas",imagen:"https://s3.us-east-1.amazonaws.com/comercial-production-gx-cms-content-bucket/hxm/rooms/suites/ocean-front-family/ocean-front-fam-005.jpg"},{id:5,nombre:"Habitaci\xf3n familiar",tipo:"Familiar",precio:1200,descripcion:"Habitaci\xf3n para cuatro personas",imagen:"https://as01.epimg.net/diarioas/imagenes/2022/05/06/actualidad/1651826263_229801_1651826454_noticia_normal_recorte1.jpg"}]}getHabitaciones(){return sn(this.habitaciones)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function I$(n,t){if(1&n&&(pe(0,"li"),Qe(1),xe()),2&n){const e=t.$implicit;Et(1),ms(e)}}let k$=(()=>{class n{constructor(){this.comments=[],this.newCommentAdded=new on,this.newComment=""}addComment(){this.newComment&&(this.comments.push(this.newComment),this.newCommentAdded.emit(this.newComment),this.newComment="")}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=mi({type:n,selectors:[["app-comments"]],inputs:{comments:"comments"},outputs:{newCommentAdded:"newCommentAdded"},decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"]],template:function(e,i){1&e&&(pe(0,"div")(1,"h3"),Qe(2,"Comentarios"),xe(),pe(3,"ul"),$t(4,I$,2,1,"li",0),xe(),pe(5,"textarea",1),mn("ngModelChange",function(c){return i.newComment=c}),xe(),pe(6,"button",2),mn("click",function(){return i.addComment()}),Qe(7,"Agregar comentario"),xe()()),2&e&&(Et(4),ht("ngForOf",i.comments),Et(1),ht("ngModel",i.newComment))},dependencies:[Um,Fy,jC,J0],styles:[".btn-primary[_ngcontent-%COMP%]{background-color:#850e35;border-color:#850e35;font-weight:700}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#ee6983;border-color:#ee6983}"]}),n})();function P$(n,t){if(1&n&&(pe(0,"li"),It(1,"img",12),pe(2,"h5",13),Qe(3),xe(),pe(4,"p",14),Qe(5),xe(),pe(6,"p",14),Qe(7),xe(),pe(8,"p",14),Qe(9),xe()()),2&n){const e=t.$implicit;Et(1),Nh("src",e.imagen,i_),Nh("alt",e.nombre),Et(2),ms(e.nombre),Et(2),ms(e.descripcion),Et(2),uu("Tipo: ",e.tipo,""),Et(2),uu("Precio: $",e.precio,"")}}function F$(n,t){1&n&&(pe(0,"div",3)(1,"h2",4),Qe(2,"Habitaci\xf3n Individual"),xe(),pe(3,"p",5),Qe(4," Disponible por 500 pesos, es un espacio acogedor y funcional que ofrece comodidad a un precio asequible. Aunque es una habitaci\xf3n de tama\xf1o moderado, est\xe1 dise\xf1ada de manera eficiente para maximizar el espacio disponible. "),xe(),pe(5,"p",6),Qe(6,"$500 por noche"),xe()()),2&n&&ht("ngClass","individual-style")}function O$(n,t){1&n&&(pe(0,"div",3)(1,"h2",4),Qe(2,"Habitaci\xf3n Triple"),xe(),pe(3,"p",5),Qe(4," La habitaci\xf3n triple es un espacio amplio y vers\xe1til que puede alojar a tres personas c\xf3modamente. Normalmente cuenta con tres camas individuales o una combinaci\xf3n de camas individuales y camas matrimoniales, todas ellas con ropa de cama de calidad. Tambi\xe9n incluye mesitas de noche, l\xe1mparas individuales y armarios o espacios de almacenamiento suficientes para cada hu\xe9sped. "),xe(),pe(5,"p",6),Qe(6,"$1100 por noche"),xe()()),2&n&&ht("ngClass","triple-style")}function L$(n,t){1&n&&(pe(0,"div",3)(1,"h2",4),Qe(2,"Habitaci\xf3n Doble"),xe(),pe(3,"p",5),Qe(4," La habitaci\xf3n doble es un espacio dise\xf1ado para alojar a dos personas. Por lo general, cuenta con una cama matrimonial o dos camas individuales con ropa de cama c\xf3moda y suave. Al igual que en la habitaci\xf3n triple, encontrar\xe1s mesitas de noche con l\xe1mparas, armarios o espacios de almacenamiento y, dependiendo del lugar, un ba\xf1o privado o compartido. "),xe(),pe(5,"p",6),Qe(6,"$800 por noche"),xe()()),2&n&&ht("ngClass","double-style")}function N$(n,t){1&n&&(pe(0,"div",3)(1,"h2",4),Qe(2,"Habitaci\xf3n Suite"),xe(),pe(3,"p",5),Qe(4," La habitaci\xf3n suite es un espacio de alojamiento m\xe1s lujoso y amplio, dise\xf1ado para ofrecer una experiencia de hospedaje de mayor categor\xeda. Suele contar con una zona de dormitorio separada y una sala de estar o \xe1rea de estar adicional. La habitaci\xf3n suite puede incluir una cama matrimonial o una combinaci\xf3n de camas individuales y matrimoniales, todas ellas con ropa de cama de alta calidad. "),xe(),pe(5,"p",6),Qe(6,"$1500 por noche"),xe()()),2&n&&ht("ngClass","suite-style")}function B$(n,t){1&n&&(pe(0,"div",3)(1,"h2",4),Qe(2,"Habitaci\xf3n Familiar"),xe(),pe(3,"p",5),Qe(4," La habitaci\xf3n familiar es una opci\xf3n ideal para familias o grupos m\xe1s grandes que desean alojarse juntos. Suele contar con camas matrimoniales y camas individuales en una combinaci\xf3n adecuada para acomodar a varios miembros de la familia o grupo. Al igual que en las otras habitaciones, se proporciona ropa de cama de calidad y comodidades b\xe1sicas como mesitas de noche, l\xe1mparas, armarios o espacios de almacenamiento y ba\xf1o privado o compartido. Adem\xe1s, la habitaci\xf3n familiar puede contar con espacio adicional, como una sala de estar o un \xe1rea de juegos, para que todos los miembros de la familia puedan disfrutar de su estancia juntos. "),xe(),pe(5,"p",6),Qe(6,"$1200 por noche"),xe()()),2&n&&ht("ngClass","family-style")}const z$=[{path:"",component:Z5},{path:"about",component:Y5},{path:"registro",component:D$},{path:"reservaciones",component:S$},{path:"galeria",component:A$},{path:"habitacion-list",component:(()=>{class n{constructor(e){this.habitacionService=e,this.comments=[],this.habitaciones=[]}ngOnInit(){this.getHabitaciones()}getHabitaciones(){this.habitacionService.getHabitaciones().subscribe(e=>this.habitaciones=e)}onNewCommentAdded(e){this.comments.push(e)}}return n.\u0275fac=function(e){return new(e||n)(ve(sP))},n.\u0275cmp=mi({type:n,selectors:[["app-habitacion-list"]],decls:18,vars:1,consts:[["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1"],["rel","stylesheet","href","https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"],[2,"text-align","center","width","80%","margin","0 auto"],[4,"ngFor","ngForOf"],[2,"text-align","center","width","90%","margin","0 auto","padding","5%"],[3,"newCommentAdded"],["routerLink","/habitacion/individual"],["routerLink","/habitacion/doble"],["routerLink","/habitacion/triple"],["routerLink","/habitacion/familiar"],["routerLink","/habitacion/suite"],["width","150","height","150",3,"src","alt"],[1,"card-title"],[1,"card-text"]],template:function(e,i){1&e&&(It(0,"meta",0)(1,"meta",1)(2,"link",2),pe(3,"ul",3),$t(4,P$,10,6,"li",4),pe(5,"div",5)(6,"app-comments",6),mn("newCommentAdded",function(c){return i.onNewCommentAdded(c)}),xe()(),pe(7,"button",7),Qe(8,"Habitaci\xf3n Individual"),xe(),pe(9,"button",8),Qe(10,"Habitaci\xf3n Doble"),xe(),pe(11,"button",9),Qe(12,"Habitaci\xf3n Triple"),xe(),pe(13,"button",10),Qe(14,"Habitaci\xf3n Familiar"),xe(),pe(15,"button",11),Qe(16,"Habitaci\xf3n Suite"),xe(),It(17,"router-outlet"),xe()),2&e&&(Et(4),ht("ngForOf",i.habitaciones))},dependencies:[Um,F0,Py,k$],styles:["*[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;background-color:#ffc4c4;font-weight:700}li[_ngcontent-%COMP%]{padding:20px}img[_ngcontent-%COMP%]{border-radius:15px}h5[_ngcontent-%COMP%]{padding-top:45px}ul[_ngcontent-%COMP%]{padding:30}li[_ngcontent-%COMP%]{padding-left:90px}.room-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.room-card[_ngcontent-%COMP%]{width:300px;padding:20px;margin:10px;border:1px solid #ccc;border-radius:5px;background-color:#fff5e4;box-shadow:0 2px 4px #0000001a}.room-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:10px}.room-description[_ngcontent-%COMP%]{margin-bottom:10px}.room-price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#850e35}.individual-style[_ngcontent-%COMP%]{background-color:#fff5e4}.triple-style[_ngcontent-%COMP%]{background-color:#ffc4c4}.double-style[_ngcontent-%COMP%]{background-color:#ffc2cf}.suite-style[_ngcontent-%COMP%]{background-color:#f5a6c0}.family-style[_ngcontent-%COMP%]{background-color:#ffdbdb}"]}),n})()},{path:"habitacion/:habitacion",component:(()=>{class n{constructor(e){this.route=e,this.habitacion=""}ngOnInit(){this.route.paramMap.subscribe(e=>{this.habitacion=e.get("habitacion")??""})}}return n.\u0275fac=function(e){return new(e||n)(ve(cf))},n.\u0275cmp=mi({type:n,selectors:[["app-habitaciones"]],decls:7,vars:6,consts:[[1,"room-container"],[1,"room-card",3,"ngSwitch"],[3,"ngClass",4,"ngSwitchCase"],[3,"ngClass"],[1,"room-title"],[1,"room-description"],[1,"room-price"]],template:function(e,i){1&e&&(pe(0,"div",0)(1,"div",1),$t(2,F$,7,1,"div",2),$t(3,O$,7,1,"div",2),$t(4,L$,7,1,"div",2),$t(5,N$,7,1,"div",2),$t(6,B$,7,1,"div",2),xe()()),2&e&&(Et(1),ht("ngSwitch",i.habitacion),Et(1),ht("ngSwitchCase","individual"),Et(1),ht("ngSwitchCase","triple"),Et(1),ht("ngSwitchCase","doble"),Et(1),ht("ngSwitchCase","suite"),Et(1),ht("ngSwitchCase","familiar"))},dependencies:[dy,nf,py],styles:[".room-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.room-card[_ngcontent-%COMP%]{width:300px;padding:20px;margin:10px;border:1px solid #ccc;border-radius:5px;background-color:#fff5e4;box-shadow:0 2px 4px #0000001a}.room-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:10px}.room-description[_ngcontent-%COMP%]{margin-bottom:10px}.room-price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#850e35}.individual-style[_ngcontent-%COMP%]{background-color:#fff5e4}.triple-style[_ngcontent-%COMP%]{background-color:#ffc4c4}.double-style[_ngcontent-%COMP%]{background-color:#ffc2cf}.suite-style[_ngcontent-%COMP%]{background-color:#f5a6c0}.family-style[_ngcontent-%COMP%]{background-color:#ffdbdb}"]}),n})()}];let V$=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[hI.forRoot(z$),hI]}),n})();function aP(n){return new nt(3e3,!1)}function xH(){return typeof window<"u"&&typeof window.document<"u"}function VE(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function ep(n){switch(n.length){case 0:return new Qy;case 1:return n[0];default:return new Lk(n)}}function lP(n,t,e,i,o=new Map,c=new Map){const f=[],v=[];let C=-1,S=null;if(i.forEach(R=>{const V=R.get("offset"),Q=V==C,oe=Q&&S||new Map;R.forEach((me,Ee)=>{let $e=Ee,lt=me;if("offset"!==Ee)switch($e=t.normalizePropertyName($e,f),lt){case DE:lt=o.get(Ee);break;case Bd:lt=c.get(Ee);break;default:lt=t.normalizeStyleValue(Ee,$e,lt,f)}oe.set($e,lt)}),Q||v.push(oe),S=oe,C=V}),f.length)throw function cH(n){return new nt(3502,!1)}();return v}function UE(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&jE(e,"start",n)));break;case"done":n.onDone(()=>i(e&&jE(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&jE(e,"destroy",n)))}}function jE(n,t,e){const c=$E(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,e.totalTime??n.totalTime,!!e.disabled),f=n._data;return null!=f&&(c._data=f),c}function $E(n,t,e,i,o="",c=0,f){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:o,totalTime:c,disabled:!!f}}function Il(n,t,e){let i=n.get(t);return i||n.set(t,i=e),i}function cP(n){const t=n.indexOf(":");return[n.substring(1,t),n.slice(t+1)]}let HE=(n,t)=>!1,uP=(n,t,e)=>[],dP=null;function GE(n){const t=n.parentNode||n.host;return t===dP?null:t}(VE()||typeof Element<"u")&&(xH()?(dP=(()=>document.documentElement)(),HE=(n,t)=>{for(;t;){if(t===n)return!0;t=GE(t)}return!1}):HE=(n,t)=>n.contains(t),uP=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let yf=null,hP=!1;const pP=HE,fP=uP;let mP=(()=>{class n{validateStyleProperty(e){return function CH(n){yf||(yf=function EH(){return typeof document<"u"?document.body:null}()||{},hP=!!yf.style&&"WebkitAppearance"in yf.style);let t=!0;return yf.style&&!function wH(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in yf.style,!t&&hP&&(t="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in yf.style)),t}(e)}matchesElement(e,i){return!1}containsElement(e,i){return pP(e,i)}getParentElement(e){return GE(e)}query(e,i,o){return fP(e,i,o)}computeStyle(e,i,o){return o||""}animate(e,i,o,c,f,v=[],C){return new Qy(o,c)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),qE=(()=>{class n{}return n.NOOP=new mP,n})();const DH=1e3,WE="ng-enter",vx="ng-leave",bx="ng-trigger",xx=".ng-trigger",_P="ng-animating",ZE=".ng-animating";function zd(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:YE(parseFloat(t[1]),t[2])}function YE(n,t){return"s"===t?n*DH:n}function wx(n,t,e){return n.hasOwnProperty("duration")?n:function SH(n,t,e){let o,c=0,f="";if("string"==typeof n){const v=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===v)return t.push(aP()),{duration:0,delay:0,easing:""};o=YE(parseFloat(v[1]),v[2]);const C=v[3];null!=C&&(c=YE(parseFloat(C),v[4]));const S=v[5];S&&(f=S)}else o=n;if(!e){let v=!1,C=t.length;o<0&&(t.push(function U$(){return new nt(3100,!1)}()),v=!0),c<0&&(t.push(function j$(){return new nt(3101,!1)}()),v=!0),v&&t.splice(C,0,aP())}return{duration:o,delay:c,easing:f}}(n,t,e)}function tv(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function yP(n){const t=new Map;return Object.keys(n).forEach(e=>{t.set(e,n[e])}),t}function tp(n,t=new Map,e){if(e)for(let[i,o]of e)t.set(i,o);for(let[i,o]of n)t.set(i,o);return t}function bP(n,t,e){return e?t+":"+e+";":""}function xP(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=bP(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=bP(0,kH(e),n.style[e]));n.setAttribute("style",t)}function Ku(n,t,e){n.style&&(t.forEach((i,o)=>{const c=KE(o);e&&!e.has(o)&&e.set(o,n.style[c]),n.style[c]=i}),VE()&&xP(n))}function vf(n,t){n.style&&(t.forEach((e,i)=>{const o=KE(i);n.style[o]=""}),VE()&&xP(n))}function nv(n){return Array.isArray(n)?1==n.length?n[0]:Rk(n):n}const XE=new RegExp("{{\\s*(.+?)\\s*}}","g");function wP(n){let t=[];if("string"==typeof n){let e;for(;e=XE.exec(n);)t.push(e[1]);XE.lastIndex=0}return t}function iv(n,t,e){const i=n.toString(),o=i.replace(XE,(c,f)=>{let v=t[f];return null==v&&(e.push(function H$(n){return new nt(3003,!1)}()),v=""),v.toString()});return o==i?n:o}function Cx(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const IH=/-+([a-z0-9])/g;function KE(n){return n.replace(IH,(...t)=>t[1].toUpperCase())}function kH(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function kl(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function G$(n){return new nt(3004,!1)}()}}function CP(n,t){return window.getComputedStyle(n)[t]}const Mx="*";function NH(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function BH(n,t,e){if(":"==n[0]){const C=function zH(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function oH(n){return new nt(3016,!1)}()),"* => *"}}(n,e);if("function"==typeof C)return void t.push(C);n=C}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function rH(n){return new nt(3015,!1)}()),t;const o=i[1],c=i[2],f=i[3];t.push(EP(o,f));"<"==c[0]&&!(o==Mx&&f==Mx)&&t.push(EP(f,o))}(i,e,t)):e.push(n),e}const Sx=new Set(["true","1"]),Tx=new Set(["false","0"]);function EP(n,t){const e=Sx.has(n)||Tx.has(n),i=Sx.has(t)||Tx.has(t);return(o,c)=>{let f=n==Mx||n==o,v=t==Mx||t==c;return!f&&e&&"boolean"==typeof o&&(f=o?Sx.has(n):Tx.has(n)),!v&&i&&"boolean"==typeof c&&(v=c?Sx.has(t):Tx.has(t)),f&&v}}const VH=new RegExp("s*:selfs*,?","g");function QE(n,t,e,i){return new UH(n).build(t,e,i)}class UH{constructor(t){this._driver=t}build(t,e,i){const o=new HH(e);return this._resetContextStyleTimingState(o),kl(this,nv(t),o)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles=new Map,t.collectedStyles.set("",new Map),t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,o=e.depCount=0;const c=[],f=[];return"@"==t.name.charAt(0)&&e.errors.push(function W$(){return new nt(3006,!1)}()),t.definitions.forEach(v=>{if(this._resetContextStyleTimingState(e),0==v.type){const C=v,S=C.name;S.toString().split(/\s*,\s*/).forEach(R=>{C.name=R,c.push(this.visitState(C,e))}),C.name=S}else if(1==v.type){const C=this.visitTransition(v,e);i+=C.queryCount,o+=C.depCount,f.push(C)}else e.errors.push(function Z$(){return new nt(3007,!1)}())}),{type:7,name:t.name,states:c,transitions:f,queryCount:i,depCount:o,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),o=t.options&&t.options.params||null;if(i.containsDynamicStyles){const c=new Set,f=o||{};i.styles.forEach(v=>{v instanceof Map&&v.forEach(C=>{wP(C).forEach(S=>{f.hasOwnProperty(S)||c.add(S)})})}),c.size&&(Cx(c.values()),e.errors.push(function Y$(n,t){return new nt(3008,!1)}()))}return{type:0,name:t.name,style:i,options:o?{params:o}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=kl(this,nv(t.animation),e);return{type:1,matchers:NH(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:bf(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>kl(this,i,e)),options:bf(t.options)}}visitGroup(t,e){const i=e.currentTime;let o=0;const c=t.steps.map(f=>{e.currentTime=i;const v=kl(this,f,e);return o=Math.max(o,e.currentTime),v});return e.currentTime=o,{type:3,steps:c,options:bf(t.options)}}visitAnimate(t,e){const i=function qH(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return JE(wx(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(c=>"{"==c.charAt(0)&&"{"==c.charAt(1))){const c=JE(0,0,"");return c.dynamic=!0,c.strValue=e,c}const o=wx(e,t);return JE(o.duration,o.delay,o.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let o,c=t.styles?t.styles:rl({});if(5==c.type)o=this.visitKeyframes(c,e);else{let f=t.styles,v=!1;if(!f){v=!0;const S={};i.easing&&(S.easing=i.easing),f=rl(S)}e.currentTime+=i.duration+i.delay;const C=this.visitStyle(f,e);C.isEmptyStep=v,o=C}return e.currentAnimateTimings=null,{type:4,timings:i,style:o,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[],o=Array.isArray(t.styles)?t.styles:[t.styles];for(let v of o)"string"==typeof v?v===Bd?i.push(v):e.errors.push(new nt(3002,!1)):i.push(yP(v));let c=!1,f=null;return i.forEach(v=>{if(v instanceof Map&&(v.has("easing")&&(f=v.get("easing"),v.delete("easing")),!c))for(let C of v.values())if(C.toString().indexOf("{{")>=0){c=!0;break}}),{type:6,styles:i,easing:f,offset:t.offset,containsDynamicStyles:c,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let o=e.currentTime,c=e.currentTime;i&&c>0&&(c-=i.duration+i.delay),t.styles.forEach(f=>{"string"!=typeof f&&f.forEach((v,C)=>{const S=e.collectedStyles.get(e.currentQuerySelector),R=S.get(C);let V=!0;R&&(c!=o&&c>=R.startTime&&o<=R.endTime&&(e.errors.push(function K$(n,t,e,i,o){return new nt(3010,!1)}()),V=!1),c=R.startTime),V&&S.set(C,{startTime:c,endTime:o}),e.options&&function AH(n,t,e){const i=t.params||{},o=wP(n);o.length&&o.forEach(c=>{i.hasOwnProperty(c)||e.push(function $$(n){return new nt(3001,!1)}())})}(v,e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function Q$(){return new nt(3011,!1)}()),i;let c=0;const f=[];let v=!1,C=!1,S=0;const R=t.steps.map(lt=>{const St=this._makeStyleAst(lt,e);let rt=null!=St.offset?St.offset:function GH(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;t=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const e=n;t=parseFloat(e.get("offset")),e.delete("offset")}return t}(St.styles),Yt=0;return null!=rt&&(c++,Yt=St.offset=rt),C=C||Yt<0||Yt>1,v=v||Yt<S,S=Yt,f.push(Yt),St});C&&e.errors.push(function J$(){return new nt(3012,!1)}()),v&&e.errors.push(function eH(){return new nt(3200,!1)}());const V=t.steps.length;let Q=0;c>0&&c<V?e.errors.push(function tH(){return new nt(3202,!1)}()):0==c&&(Q=1/(V-1));const oe=V-1,me=e.currentTime,Ee=e.currentAnimateTimings,$e=Ee.duration;return R.forEach((lt,St)=>{const rt=Q>0?St==oe?1:Q*St:f[St],Yt=rt*$e;e.currentTime=me+Ee.delay+Yt,Ee.duration=Yt,this._validateStyleAst(lt,e),lt.offset=rt,i.styles.push(lt)}),i}visitReference(t,e){return{type:8,animation:kl(this,nv(t.animation),e),options:bf(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:bf(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:bf(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,o=t.options||{};e.queryCount++,e.currentQuery=t;const[c,f]=function jH(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(VH,"")),n=n.replace(/@\*/g,xx).replace(/@\w+/g,e=>xx+"-"+e.slice(1)).replace(/:animating/g,ZE),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+c:c,Il(e.collectedStyles,e.currentQuerySelector,new Map);const v=kl(this,nv(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:c,limit:o.limit||0,optional:!!o.optional,includeSelf:f,animation:v,originalSelector:t.selector,options:bf(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function nH(){return new nt(3013,!1)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:wx(t.timings,e.errors,!0);return{type:12,animation:kl(this,nv(t.animation),e),timings:i,options:null}}}class HH{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function bf(n){return n?(n=tv(n)).params&&(n.params=function $H(n){return n?tv(n):null}(n.params)):n={},n}function JE(n,t,e){return{duration:n,delay:t,easing:e}}function eD(n,t,e,i,o,c,f=null,v=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:o,delay:c,totalTime:o+c,easing:f,subTimeline:v}}class Ax{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const YH=new RegExp(":enter","g"),KH=new RegExp(":leave","g");function tD(n,t,e,i,o,c=new Map,f=new Map,v,C,S=[]){return(new QH).buildKeyframes(n,t,e,i,o,c,f,v,C,S)}class QH{buildKeyframes(t,e,i,o,c,f,v,C,S,R=[]){S=S||new Ax;const V=new nD(t,e,S,o,c,R,[]);V.options=C;const Q=C.delay?zd(C.delay):0;V.currentTimeline.delayNextStep(Q),V.currentTimeline.setStyles([f],null,V.errors,C),kl(this,i,V);const oe=V.timelines.filter(me=>me.containsAnimation());if(oe.length&&v.size){let me;for(let Ee=oe.length-1;Ee>=0;Ee--){const $e=oe[Ee];if($e.element===e){me=$e;break}}me&&!me.allowOnlyTimelineStyles()&&me.setStyles([v],null,V.errors,C)}return oe.length?oe.map(me=>me.buildKeyframes()):[eD(e,[],[],[],0,Q,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const o=e.createSubContext(t.options),c=e.currentTimeline.currentTime,f=this._visitSubInstructions(i,o,o.options);c!=f&&e.transformIntoNewTimeline(f)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([t.options,t.animation.options],e,i),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_applyAnimationRefDelays(t,e,i){for(const o of t){const c=o?.delay;if(c){const f="number"==typeof c?c:zd(iv(c,o?.params??{},e.errors));i.delayNextStep(f)}}}_visitSubInstructions(t,e,i){let c=e.currentTimeline.currentTime;const f=null!=i.duration?zd(i.duration):null,v=null!=i.delay?zd(i.delay):null;return 0!==f&&t.forEach(C=>{const S=e.appendInstructionToTimeline(C,f,v);c=Math.max(c,S.duration+S.delay)}),c}visitReference(t,e){e.updateOptions(t.options,!0),kl(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let o=e;const c=t.options;if(c&&(c.params||c.delay)&&(o=e.createSubContext(c),o.transformIntoNewTimeline(),null!=c.delay)){6==o.previousNode.type&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=Ix);const f=zd(c.delay);o.delayNextStep(f)}t.steps.length&&(t.steps.forEach(f=>kl(this,f,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>i&&o.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let o=e.currentTimeline.currentTime;const c=t.options&&t.options.delay?zd(t.options.delay):0;t.steps.forEach(f=>{const v=e.createSubContext(t.options);c&&v.delayNextStep(c),kl(this,f,v),o=Math.max(o,v.currentTimeline.currentTime),i.push(v.currentTimeline)}),i.forEach(f=>e.currentTimeline.mergeTimelineCollectedStyles(f)),e.transformIntoNewTimeline(o),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return wx(e.params?iv(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),o=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),o.snapshotCurrentStyles());const c=t.style;5==c.type?this.visitKeyframes(c,e):(e.incrementTime(i.duration),this.visitStyle(c,e),o.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,o=e.currentAnimateTimings;!o&&i.hasCurrentStyleProperties()&&i.forwardFrame();const c=o&&o.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(c):i.setStyles(t.styles,c,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,o=e.currentTimeline.duration,c=i.duration,v=e.createSubContext().currentTimeline;v.easing=i.easing,t.styles.forEach(C=>{v.forwardTime((C.offset||0)*c),v.setStyles(C.styles,C.easing,e.errors,e.options),v.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(v),e.transformIntoNewTimeline(o+c),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,o=t.options||{},c=o.delay?zd(o.delay):0;c&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Ix);let f=i;const v=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!o.optional,e.errors);e.currentQueryTotal=v.length;let C=null;v.forEach((S,R)=>{e.currentQueryIndex=R;const V=e.createSubContext(t.options,S);c&&V.delayNextStep(c),S===e.element&&(C=V.currentTimeline),kl(this,t.animation,V),V.currentTimeline.applyStylesToKeyframe(),f=Math.max(f,V.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(f),C&&(e.currentTimeline.mergeTimelineCollectedStyles(C),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,o=e.currentTimeline,c=t.timings,f=Math.abs(c.duration),v=f*(e.currentQueryTotal-1);let C=f*e.currentQueryIndex;switch(c.duration<0?"reverse":c.easing){case"reverse":C=v-C;break;case"full":C=i.currentStaggerTime}const R=e.currentTimeline;C&&R.delayNextStep(C);const V=R.currentTime;kl(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=o.currentTime-V+(o.startTime-i.currentTimeline.startTime)}}const Ix={};class nD{constructor(t,e,i,o,c,f,v,C){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=o,this._leaveClassName=c,this.errors=f,this.timelines=v,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Ix,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=C||new kx(this._driver,e,0),v.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let o=this.options;null!=i.duration&&(o.duration=zd(i.duration)),null!=i.delay&&(o.delay=zd(i.delay));const c=i.params;if(c){let f=o.params;f||(f=this.options.params={}),Object.keys(c).forEach(v=>{(!e||!f.hasOwnProperty(v))&&(f[v]=iv(c[v],f,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(o=>{i[o]=e[o]})}}return t}createSubContext(t=null,e,i){const o=e||this.element,c=new nD(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,i||0));return c.previousNode=this.previousNode,c.currentAnimateTimings=this.currentAnimateTimings,c.options=this._copyOptions(),c.updateOptions(t),c.currentQueryIndex=this.currentQueryIndex,c.currentQueryTotal=this.currentQueryTotal,c.parentContext=this,this.subContextCount++,c}transformIntoNewTimeline(t){return this.previousNode=Ix,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const o={duration:e??t.duration,delay:this.currentTimeline.currentTime+(i??0)+t.delay,easing:""},c=new JH(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,o,t.stretchStartingKeyframe);return this.timelines.push(c),o}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,o,c,f){let v=[];if(o&&v.push(this.element),t.length>0){t=(t=t.replace(YH,"."+this._enterClassName)).replace(KH,"."+this._leaveClassName);let S=this._driver.query(this.element,t,1!=i);0!==i&&(S=i<0?S.slice(S.length+i,S.length):S.slice(0,i)),v.push(...S)}return!c&&0==v.length&&f.push(function iH(n){return new nt(3014,!1)}()),v}}class kx{constructor(t,e,i,o){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=o,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new kx(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles.set(t,e),this._globalTimelineStyles.set(t,e),this._styleSummary.set(t,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&this._previousKeyframe.set("easing",t);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||Bd),this._currentKeyframe.set(e,Bd);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,o){e&&this._previousKeyframe.set("easing",e);const c=o&&o.params||{},f=function e8(n,t){const e=new Map;let i;return n.forEach(o=>{if("*"===o){i=i||t.keys();for(let c of i)e.set(c,Bd)}else tp(o,e)}),e}(t,this._globalTimelineStyles);for(let[v,C]of f){const S=iv(C,c,i);this._pendingStyles.set(v,S),this._localTimelineStyles.has(v)||this._backFill.set(v,this._globalTimelineStyles.get(v)??Bd),this._updateStyle(v,S)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((t,e)=>{this._currentKeyframe.set(e,t)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((t,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,t)}))}snapshotCurrentStyles(){for(let[t,e]of this._localTimelineStyles)this._pendingStyles.set(t,e),this._updateStyle(t,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){t._styleSummary.forEach((e,i)=>{const o=this._styleSummary.get(i);(!o||e.time>o.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let o=[];this._keyframes.forEach((v,C)=>{const S=tp(v,new Map,this._backFill);S.forEach((R,V)=>{R===DE?t.add(V):R===Bd&&e.add(V)}),i||S.set("offset",C/this.duration),o.push(S)});const c=t.size?Cx(t.values()):[],f=e.size?Cx(e.values()):[];if(i){const v=o[0],C=new Map(v);v.set("offset",0),C.set("offset",1),o=[v,C]}return eD(this.element,o,c,f,this.duration,this.startTime,this.easing,!1)}}class JH extends kx{constructor(t,e,i,o,c,f,v=!1){super(t,e,f.delay),this.keyframes=i,this.preStyleProps=o,this.postStyleProps=c,this._stretchStartingKeyframe=v,this.timings={duration:f.duration,delay:f.delay,easing:f.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:o}=this.timings;if(this._stretchStartingKeyframe&&e){const c=[],f=i+e,v=e/f,C=tp(t[0]);C.set("offset",0),c.push(C);const S=tp(t[0]);S.set("offset",SP(v)),c.push(S);const R=t.length-1;for(let V=1;V<=R;V++){let Q=tp(t[V]);const oe=Q.get("offset");Q.set("offset",SP((e+oe*i)/f)),c.push(Q)}i=f,e=0,o="",t=c}return eD(this.element,t,this.preStyleProps,this.postStyleProps,i,e,o,!0)}}function SP(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class iD{}const t8=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class n8 extends iD{normalizePropertyName(t,e){return KE(t)}normalizeStyleValue(t,e,i,o){let c="";const f=i.toString().trim();if(t8.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)c="px";else{const v=i.match(/^[+-]?[\d\.]+([a-z]*)$/);v&&0==v[1].length&&o.push(function q$(n,t){return new nt(3005,!1)}())}return f+c}}function TP(n,t,e,i,o,c,f,v,C,S,R,V,Q){return{type:0,element:n,triggerName:t,isRemovalTransition:o,fromState:e,fromStyles:c,toState:i,toStyles:f,timelines:v,queriedElements:C,preStyleProps:S,postStyleProps:R,totalTime:V,errors:Q}}const rD={};class AP{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,o){return function i8(n,t,e,i,o){return n.some(c=>c(t,e,i,o))}(this.ast.matchers,t,e,i,o)}buildStyles(t,e,i){let o=this._stateStyles.get("*");return void 0!==t&&(o=this._stateStyles.get(t?.toString())||o),o?o.buildStyles(e,i):new Map}build(t,e,i,o,c,f,v,C,S,R){const V=[],Q=this.ast.options&&this.ast.options.params||rD,me=this.buildStyles(i,v&&v.params||rD,V),Ee=C&&C.params||rD,$e=this.buildStyles(o,Ee,V),lt=new Set,St=new Map,rt=new Map,Yt="void"===o,Ci={params:r8(Ee,Q),delay:this.ast.options?.delay},Qi=R?[]:tD(t,e,this.ast.animation,c,f,me,$e,Ci,S,V);let Xs=0;if(Qi.forEach(Ud=>{Xs=Math.max(Ud.duration+Ud.delay,Xs)}),V.length)return TP(e,this._triggerName,i,o,Yt,me,$e,[],[],St,rt,Xs,V);Qi.forEach(Ud=>{const jd=Ud.element,dR=Il(St,jd,new Set);Ud.preStyleProps.forEach(wf=>dR.add(wf));const lv=Il(rt,jd,new Set);Ud.postStyleProps.forEach(wf=>lv.add(wf)),jd!==e&&lt.add(jd)});const Vd=Cx(lt.values());return TP(e,this._triggerName,i,o,Yt,me,$e,Qi,Vd,St,rt,Xs)}}function r8(n,t){const e=tv(t);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(e[i]=n[i]);return e}class o8{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i=new Map,o=tv(this.defaultParams);return Object.keys(t).forEach(c=>{const f=t[c];null!==f&&(o[c]=f)}),this.styles.styles.forEach(c=>{"string"!=typeof c&&c.forEach((f,v)=>{f&&(f=iv(f,o,e));const C=this.normalizer.normalizePropertyName(v,e);f=this.normalizer.normalizeStyleValue(v,C,f,e),i.set(v,f)})}),i}}class a8{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(o=>{this.states.set(o.name,new o8(o.style,o.options&&o.options.params||{},i))}),IP(this.states,"true","1"),IP(this.states,"false","0"),e.transitions.forEach(o=>{this.transitionFactories.push(new AP(t,o,this.states))}),this.fallbackTransition=function l8(n,t,e){return new AP(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(f,v)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,o){return this.transitionFactories.find(f=>f.match(t,e,i,o))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function IP(n,t,e){n.has(t)?n.has(e)||n.set(e,n.get(t)):n.has(e)&&n.set(t,n.get(e))}const c8=new Ax;class u8{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(t,e){const i=[],o=[],c=QE(this._driver,e,i,o);if(i.length)throw function uH(n){return new nt(3503,!1)}();this._animations.set(t,c)}_buildPlayer(t,e,i){const o=t.element,c=lP(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(o,c,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const o=[],c=this._animations.get(t);let f;const v=new Map;if(c?(f=tD(this._driver,e,c,WE,vx,new Map,new Map,i,c8,o),f.forEach(R=>{const V=Il(v,R.element,new Map);R.postStyleProps.forEach(Q=>V.set(Q,null))})):(o.push(function dH(){return new nt(3300,!1)}()),f=[]),o.length)throw function hH(n){return new nt(3504,!1)}();v.forEach((R,V)=>{R.forEach((Q,oe)=>{R.set(oe,this._driver.computeStyle(V,oe,Bd))})});const S=ep(f.map(R=>{const V=v.get(R.element);return this._buildPlayer(R,new Map,V)}));return this._playersById.set(t,S),S.onDestroy(()=>this.destroy(t)),this.players.push(S),S}destroy(t){const e=this._getPlayer(t);e.destroy(),this._playersById.delete(t);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById.get(t);if(!e)throw function pH(n){return new nt(3301,!1)}();return e}listen(t,e,i,o){const c=$E(e,"","","");return UE(this._getPlayer(t),i,c,o),()=>{}}command(t,e,i,o){if("register"==i)return void this.register(t,o[0]);if("create"==i)return void this.create(t,e,o[0]||{});const c=this._getPlayer(t);switch(i){case"play":c.play();break;case"pause":c.pause();break;case"reset":c.reset();break;case"restart":c.restart();break;case"finish":c.finish();break;case"init":c.init();break;case"setPosition":c.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(t)}}}const kP="ng-animate-queued",oD="ng-animate-disabled",m8=[],PP={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},g8={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},gc="__ng_removed";class sD{get params(){return this.options.params}constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function b8(n){return n??null}(i?t.value:t),i){const c=tv(t);delete c.value,this.options=c}else this.options={};this.options.params||(this.options.params={})}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(o=>{null==i[o]&&(i[o]=e[o])})}}}const rv="void",aD=new sD(rv);class _8{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,_c(e,this._hostClassName)}listen(t,e,i,o){if(!this._triggers.has(e))throw function fH(n,t){return new nt(3302,!1)}();if(null==i||0==i.length)throw function mH(n){return new nt(3303,!1)}();if(!function x8(n){return"start"==n||"done"==n}(i))throw function gH(n,t){return new nt(3400,!1)}();const c=Il(this._elementListeners,t,[]),f={name:e,phase:i,callback:o};c.push(f);const v=Il(this._engine.statesByElement,t,new Map);return v.has(e)||(_c(t,bx),_c(t,bx+"-"+e),v.set(e,aD)),()=>{this._engine.afterFlush(()=>{const C=c.indexOf(f);C>=0&&c.splice(C,1),this._triggers.has(e)||v.delete(e)})}}register(t,e){return!this._triggers.has(t)&&(this._triggers.set(t,e),!0)}_getTrigger(t){const e=this._triggers.get(t);if(!e)throw function _H(n){return new nt(3401,!1)}();return e}trigger(t,e,i,o=!0){const c=this._getTrigger(e),f=new lD(this.id,e,t);let v=this._engine.statesByElement.get(t);v||(_c(t,bx),_c(t,bx+"-"+e),this._engine.statesByElement.set(t,v=new Map));let C=v.get(e);const S=new sD(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&C&&S.absorbOptions(C.options),v.set(e,S),C||(C=aD),S.value!==rv&&C.value===S.value){if(!function E8(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let o=0;o<e.length;o++){const c=e[o];if(!t.hasOwnProperty(c)||n[c]!==t[c])return!1}return!0}(C.params,S.params)){const Ee=[],$e=c.matchStyles(C.value,C.params,Ee),lt=c.matchStyles(S.value,S.params,Ee);Ee.length?this._engine.reportError(Ee):this._engine.afterFlush(()=>{vf(t,$e),Ku(t,lt)})}return}const Q=Il(this._engine.playersByElement,t,[]);Q.forEach(Ee=>{Ee.namespaceId==this.id&&Ee.triggerName==e&&Ee.queued&&Ee.destroy()});let oe=c.matchTransition(C.value,S.value,t,S.params),me=!1;if(!oe){if(!o)return;oe=c.fallbackTransition,me=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:oe,fromState:C,toState:S,player:f,isFallbackTransition:me}),me||(_c(t,kP),f.onStart(()=>{lg(t,kP)})),f.onDone(()=>{let Ee=this.players.indexOf(f);Ee>=0&&this.players.splice(Ee,1);const $e=this._engine.playersByElement.get(t);if($e){let lt=$e.indexOf(f);lt>=0&&$e.splice(lt,1)}}),this.players.push(f),Q.push(f),f}deregister(t){this._triggers.delete(t),this._engine.statesByElement.forEach(e=>e.delete(t)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(o=>o.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,xx,!0);i.forEach(o=>{if(o[gc])return;const c=this._engine.fetchNamespacesByElement(o);c.size?c.forEach(f=>f.triggerLeaveAnimation(o,e,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(t,e,i,o){const c=this._engine.statesByElement.get(t),f=new Map;if(c){const v=[];if(c.forEach((C,S)=>{if(f.set(S,C.value),this._triggers.has(S)){const R=this.trigger(t,S,rv,o);R&&v.push(R)}}),v.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,f),i&&ep(v).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const o=new Set;e.forEach(c=>{const f=c.name;if(o.has(f))return;o.add(f);const C=this._triggers.get(f).fallbackTransition,S=i.get(f)||aD,R=new sD(rv),V=new lD(this.id,f,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:f,transition:C,fromState:S,toState:R,player:V,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let o=!1;if(i.totalAnimations){const c=i.players.length?i.playersByQueriedElement.get(t):[];if(c&&c.length)o=!0;else{let f=t;for(;f=f.parentNode;)if(i.statesByElement.get(f)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(t),o)i.markElementAsRemoved(this.id,t,!1,e);else{const c=t[gc];(!c||c===PP)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){_c(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const o=i.player;if(o.destroyed)return;const c=i.element,f=this._elementListeners.get(c);f&&f.forEach(v=>{if(v.name==i.triggerName){const C=$E(c,i.triggerName,i.fromState.value,i.toState.value);C._data=t,UE(i.player,v.phase,C,v.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):e.push(i)}),this._queue=[],e.sort((i,o)=>{const c=i.transition.ast.depCount,f=o.transition.ast.depCount;return 0==c||0==f?c-f:this._engine.driver.containsElement(i.element,o.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class y8{_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,c)=>{}}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new _8(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,o=this.namespacesByHostElement;if(i.length-1>=0){let f=!1,v=this.driver.getParentElement(e);for(;v;){const C=o.get(v);if(C){const S=i.indexOf(C);i.splice(S+1,0,t),f=!0;break}v=this.driver.getParentElement(v)}f||i.unshift(t)}else i.push(t);return o.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let o=this._namespaceLookup[t];o&&o.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const o=this._namespaceList.indexOf(i);o>=0&&this._namespaceList.splice(o,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i)for(let o of i.values())if(o.namespaceId){const c=this._fetchNamespace(o.namespaceId);c&&e.add(c)}return e}trigger(t,e,i,o){if(Px(e)){const c=this._fetchNamespace(t);if(c)return c.trigger(e,i,o),!0}return!1}insertNode(t,e,i,o){if(!Px(e))return;const c=e[gc];if(c&&c.setForRemoval){c.setForRemoval=!1,c.setForMove=!0;const f=this.collectedLeaveElements.indexOf(e);f>=0&&this.collectedLeaveElements.splice(f,1)}if(t){const f=this._fetchNamespace(t);f&&f.insertNode(e,i)}o&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),_c(t,oD)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),lg(t,oD))}removeNode(t,e,i,o){if(Px(e)){const c=t?this._fetchNamespace(t):null;if(c?c.removeNode(e,o):this.markElementAsRemoved(t,e,!1,o),i){const f=this.namespacesByHostElement.get(e);f&&f.id!==t&&f.removeNode(e,o)}}else this._onRemovalComplete(e,o)}markElementAsRemoved(t,e,i,o,c){this.collectedLeaveElements.push(e),e[gc]={namespaceId:t,setForRemoval:o,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:c}}listen(t,e,i,o,c){return Px(e)?this._fetchNamespace(t).listen(e,i,o,c):()=>{}}_buildInstruction(t,e,i,o,c){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,o,t.fromState.options,t.toState.options,e,c)}destroyInnerAnimations(t){let e=this.driver.query(t,xx,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,ZE,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return ep(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t[gc];if(e&&e.setForRemoval){if(t[gc]=PP,e.namespaceId){this.destroyInnerAnimations(t);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}t.classList?.contains(oD)&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,o)=>this._balanceNamespaceList(i,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)_c(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let o=0;o<i.length;o++)i[o]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?ep(e).onDone(()=>{i.forEach(o=>o())}):i.forEach(o=>o())}}reportError(t){throw function yH(n){return new nt(3402,!1)}()}_flushAnimations(t,e){const i=new Ax,o=[],c=new Map,f=[],v=new Map,C=new Map,S=new Map,R=new Set;this.disabledNodes.forEach(hn=>{R.add(hn);const Dn=this.driver.query(hn,".ng-animate-queued",!0);for(let Bn=0;Bn<Dn.length;Bn++)R.add(Dn[Bn])});const V=this.bodyNode,Q=Array.from(this.statesByElement.keys()),oe=OP(Q,this.collectedEnterElements),me=new Map;let Ee=0;oe.forEach((hn,Dn)=>{const Bn=WE+Ee++;me.set(Dn,Bn),hn.forEach(Wi=>_c(Wi,Bn))});const $e=[],lt=new Set,St=new Set;for(let hn=0;hn<this.collectedLeaveElements.length;hn++){const Dn=this.collectedLeaveElements[hn],Bn=Dn[gc];Bn&&Bn.setForRemoval&&($e.push(Dn),lt.add(Dn),Bn.hasAnimation?this.driver.query(Dn,".ng-star-inserted",!0).forEach(Wi=>lt.add(Wi)):St.add(Dn))}const rt=new Map,Yt=OP(Q,Array.from(lt));Yt.forEach((hn,Dn)=>{const Bn=vx+Ee++;rt.set(Dn,Bn),hn.forEach(Wi=>_c(Wi,Bn))}),t.push(()=>{oe.forEach((hn,Dn)=>{const Bn=me.get(Dn);hn.forEach(Wi=>lg(Wi,Bn))}),Yt.forEach((hn,Dn)=>{const Bn=rt.get(Dn);hn.forEach(Wi=>lg(Wi,Bn))}),$e.forEach(hn=>{this.processLeaveNode(hn)})});const Ci=[],Qi=[];for(let hn=this._namespaceList.length-1;hn>=0;hn--)this._namespaceList[hn].drainQueuedTransitions(e).forEach(Bn=>{const Wi=Bn.player,gs=Bn.element;if(Ci.push(Wi),this.collectedEnterElements.length){const Ks=gs[gc];if(Ks&&Ks.setForMove){if(Ks.previousTriggersValues&&Ks.previousTriggersValues.has(Bn.triggerName)){const Cf=Ks.previousTriggersValues.get(Bn.triggerName),yc=this.statesByElement.get(Bn.element);if(yc&&yc.has(Bn.triggerName)){const Vx=yc.get(Bn.triggerName);Vx.value=Cf,yc.set(Bn.triggerName,Vx)}}return void Wi.destroy()}}const Qu=!V||!this.driver.containsElement(V,gs),Pl=rt.get(gs),op=me.get(gs),Gr=this._buildInstruction(Bn,i,op,Pl,Qu);if(Gr.errors&&Gr.errors.length)return void Qi.push(Gr);if(Qu)return Wi.onStart(()=>vf(gs,Gr.fromStyles)),Wi.onDestroy(()=>Ku(gs,Gr.toStyles)),void o.push(Wi);if(Bn.isFallbackTransition)return Wi.onStart(()=>vf(gs,Gr.fromStyles)),Wi.onDestroy(()=>Ku(gs,Gr.toStyles)),void o.push(Wi);const fR=[];Gr.timelines.forEach(Ks=>{Ks.stretchStartingKeyframe=!0,this.disabledNodes.has(Ks.element)||fR.push(Ks)}),Gr.timelines=fR,i.append(gs,Gr.timelines),f.push({instruction:Gr,player:Wi,element:gs}),Gr.queriedElements.forEach(Ks=>Il(v,Ks,[]).push(Wi)),Gr.preStyleProps.forEach((Ks,Cf)=>{if(Ks.size){let yc=C.get(Cf);yc||C.set(Cf,yc=new Set),Ks.forEach((Vx,yD)=>yc.add(yD))}}),Gr.postStyleProps.forEach((Ks,Cf)=>{let yc=S.get(Cf);yc||S.set(Cf,yc=new Set),Ks.forEach((Vx,yD)=>yc.add(yD))})});if(Qi.length){const hn=[];Qi.forEach(Dn=>{hn.push(function vH(n,t){return new nt(3505,!1)}())}),Ci.forEach(Dn=>Dn.destroy()),this.reportError(hn)}const Xs=new Map,Vd=new Map;f.forEach(hn=>{const Dn=hn.element;i.has(Dn)&&(Vd.set(Dn,Dn),this._beforeAnimationBuild(hn.player.namespaceId,hn.instruction,Xs))}),o.forEach(hn=>{const Dn=hn.element;this._getPreviousPlayers(Dn,!1,hn.namespaceId,hn.triggerName,null).forEach(Wi=>{Il(Xs,Dn,[]).push(Wi),Wi.destroy()})});const Ud=$e.filter(hn=>NP(hn,C,S)),jd=new Map;FP(jd,this.driver,St,S,Bd).forEach(hn=>{NP(hn,C,S)&&Ud.push(hn)});const lv=new Map;oe.forEach((hn,Dn)=>{FP(lv,this.driver,new Set(hn),C,DE)}),Ud.forEach(hn=>{const Dn=jd.get(hn),Bn=lv.get(hn);jd.set(hn,new Map([...Array.from(Dn?.entries()??[]),...Array.from(Bn?.entries()??[])]))});const wf=[],hR=[],pR={};f.forEach(hn=>{const{element:Dn,player:Bn,instruction:Wi}=hn;if(i.has(Dn)){if(R.has(Dn))return Bn.onDestroy(()=>Ku(Dn,Wi.toStyles)),Bn.disabled=!0,Bn.overrideTotalTime(Wi.totalTime),void o.push(Bn);let gs=pR;if(Vd.size>1){let Pl=Dn;const op=[];for(;Pl=Pl.parentNode;){const Gr=Vd.get(Pl);if(Gr){gs=Gr;break}op.push(Pl)}op.forEach(Gr=>Vd.set(Gr,gs))}const Qu=this._buildAnimation(Bn.namespaceId,Wi,Xs,c,lv,jd);if(Bn.setRealPlayer(Qu),gs===pR)wf.push(Bn);else{const Pl=this.playersByElement.get(gs);Pl&&Pl.length&&(Bn.parentPlayer=ep(Pl)),o.push(Bn)}}else vf(Dn,Wi.fromStyles),Bn.onDestroy(()=>Ku(Dn,Wi.toStyles)),hR.push(Bn),R.has(Dn)&&o.push(Bn)}),hR.forEach(hn=>{const Dn=c.get(hn.element);if(Dn&&Dn.length){const Bn=ep(Dn);hn.setRealPlayer(Bn)}}),o.forEach(hn=>{hn.parentPlayer?hn.syncPlayerEvents(hn.parentPlayer):hn.destroy()});for(let hn=0;hn<$e.length;hn++){const Dn=$e[hn],Bn=Dn[gc];if(lg(Dn,vx),Bn&&Bn.hasAnimation)continue;let Wi=[];if(v.size){let Qu=v.get(Dn);Qu&&Qu.length&&Wi.push(...Qu);let Pl=this.driver.query(Dn,ZE,!0);for(let op=0;op<Pl.length;op++){let Gr=v.get(Pl[op]);Gr&&Gr.length&&Wi.push(...Gr)}}const gs=Wi.filter(Qu=>!Qu.destroyed);gs.length?w8(this,Dn,gs):this.processLeaveNode(Dn)}return $e.length=0,wf.forEach(hn=>{this.players.push(hn),hn.onDone(()=>{hn.destroy();const Dn=this.players.indexOf(hn);this.players.splice(Dn,1)}),hn.play()}),wf}elementContainsData(t,e){let i=!1;const o=e[gc];return o&&o.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,o,c){let f=[];if(e){const v=this.playersByQueriedElement.get(t);v&&(f=v)}else{const v=this.playersByElement.get(t);if(v){const C=!c||c==rv;v.forEach(S=>{S.queued||!C&&S.triggerName!=o||f.push(S)})}}return(i||o)&&(f=f.filter(v=>!(i&&i!=v.namespaceId||o&&o!=v.triggerName))),f}_beforeAnimationBuild(t,e,i){const c=e.element,f=e.isRemovalTransition?void 0:t,v=e.isRemovalTransition?void 0:e.triggerName;for(const C of e.timelines){const S=C.element,R=S!==c,V=Il(i,S,[]);this._getPreviousPlayers(S,R,f,v,e.toState).forEach(oe=>{const me=oe.getRealPlayer();me.beforeDestroy&&me.beforeDestroy(),oe.destroy(),V.push(oe)})}vf(c,e.fromStyles)}_buildAnimation(t,e,i,o,c,f){const v=e.triggerName,C=e.element,S=[],R=new Set,V=new Set,Q=e.timelines.map(me=>{const Ee=me.element;R.add(Ee);const $e=Ee[gc];if($e&&$e.removedBeforeQueried)return new Qy(me.duration,me.delay);const lt=Ee!==C,St=function C8(n){const t=[];return LP(n,t),t}((i.get(Ee)||m8).map(Xs=>Xs.getRealPlayer())).filter(Xs=>!!Xs.element&&Xs.element===Ee),rt=c.get(Ee),Yt=f.get(Ee),Ci=lP(0,this._normalizer,0,me.keyframes,rt,Yt),Qi=this._buildPlayer(me,Ci,St);if(me.subTimeline&&o&&V.add(Ee),lt){const Xs=new lD(t,v,Ee);Xs.setRealPlayer(Qi),S.push(Xs)}return Qi});S.forEach(me=>{Il(this.playersByQueriedElement,me.element,[]).push(me),me.onDone(()=>function v8(n,t,e){let i=n.get(t);if(i){if(i.length){const o=i.indexOf(e);i.splice(o,1)}0==i.length&&n.delete(t)}return i}(this.playersByQueriedElement,me.element,me))}),R.forEach(me=>_c(me,_P));const oe=ep(Q);return oe.onDestroy(()=>{R.forEach(me=>lg(me,_P)),Ku(C,e.toStyles)}),V.forEach(me=>{Il(o,me,[]).push(oe)}),oe}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new Qy(t.duration,t.delay)}}class lD{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new Qy,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,this._queuedCallbacks.forEach((e,i)=>{e.forEach(o=>UE(t,i,void 0,o))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){Il(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Px(n){return n&&1===n.nodeType}function RP(n,t){const e=n.style.display;return n.style.display=t??"none",e}function FP(n,t,e,i,o){const c=[];e.forEach(C=>c.push(RP(C)));const f=[];i.forEach((C,S)=>{const R=new Map;C.forEach(V=>{const Q=t.computeStyle(S,V,o);R.set(V,Q),(!Q||0==Q.length)&&(S[gc]=g8,f.push(S))}),n.set(S,R)});let v=0;return e.forEach(C=>RP(C,c[v++])),f}function OP(n,t){const e=new Map;if(n.forEach(v=>e.set(v,[])),0==t.length)return e;const i=1,o=new Set(t),c=new Map;function f(v){if(!v)return i;let C=c.get(v);if(C)return C;const S=v.parentNode;return C=e.has(S)?S:o.has(S)?i:f(S),c.set(v,C),C}return t.forEach(v=>{const C=f(v);C!==i&&e.get(C).push(v)}),e}function _c(n,t){n.classList?.add(t)}function lg(n,t){n.classList?.remove(t)}function w8(n,t,e){ep(e).onDone(()=>n.processLeaveNode(t))}function LP(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof Lk?LP(i.players,t):t.push(i)}}function NP(n,t,e){const i=e.get(n);if(!i)return!1;let o=t.get(n);return o?i.forEach(c=>o.add(c)):t.set(n,i),e.delete(n),!0}class Rx{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,c)=>{},this._transitionEngine=new y8(t,e,i),this._timelineEngine=new u8(t,e,i),this._transitionEngine.onRemovalComplete=(o,c)=>this.onRemovalComplete(o,c)}registerTrigger(t,e,i,o,c){const f=t+"-"+o;let v=this._triggerCache[f];if(!v){const C=[],S=[],R=QE(this._driver,c,C,S);if(C.length)throw function lH(n,t){return new nt(3404,!1)}();v=function s8(n,t,e){return new a8(n,t,e)}(o,R,this._normalizer),this._triggerCache[f]=v}this._transitionEngine.registerTrigger(e,o,v)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,o){this._transitionEngine.insertNode(t,e,i,o)}onRemove(t,e,i,o){this._transitionEngine.removeNode(t,e,o||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,o){if("@"==i.charAt(0)){const[c,f]=cP(i);this._timelineEngine.command(c,e,f,o)}else this._transitionEngine.trigger(t,e,i,o)}listen(t,e,i,o,c){if("@"==i.charAt(0)){const[f,v]=cP(i);return this._timelineEngine.listen(f,e,v,c)}return this._transitionEngine.listen(t,e,i,o,c)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let M8=(()=>{class n{constructor(e,i,o){this._element=e,this._startStyles=i,this._endStyles=o,this._state=0;let c=n.initialStylesByElement.get(e);c||n.initialStylesByElement.set(e,c=new Map),this._initialStyles=c}start(){this._state<1&&(this._startStyles&&Ku(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ku(this._element,this._initialStyles),this._endStyles&&(Ku(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(vf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(vf(this._element,this._endStyles),this._endStyles=null),Ku(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function cD(n){let t=null;return n.forEach((e,i)=>{(function S8(n){return"display"===n||"position"===n})(i)&&(t=t||new Map,t.set(i,e))}),t}class BP{constructor(t,e,i,o){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(t){const e=[];return t.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(t,e,i){return t.animate(this._convertKeyframesToObject(e),i)}onStart(t){this._originalOnStartFns.push(t),this._onStartFns.push(t)}onDone(t){this._originalOnDoneFns.push(t),this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,o)=>{"offset"!==o&&t.set(o,this._finished?i:CP(this.element,o))}),this.currentSnapshot=t}triggerCallback(t){const e="start"===t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class T8{validateStyleProperty(t){return!0}validateAnimatableStyleProperty(t){return!0}matchesElement(t,e){return!1}containsElement(t,e){return pP(t,e)}getParentElement(t){return GE(t)}query(t,e,i){return fP(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,o,c,f=[]){const C={duration:i,delay:o,fill:0==o?"both":"forwards"};c&&(C.easing=c);const S=new Map,R=f.filter(oe=>oe instanceof BP);(function PH(n,t){return 0===n||0===t})(i,o)&&R.forEach(oe=>{oe.currentSnapshot.forEach((me,Ee)=>S.set(Ee,me))});let V=function TH(n){return n.length?n[0]instanceof Map?n:n.map(t=>yP(t)):[]}(e).map(oe=>tp(oe));V=function RH(n,t,e){if(e.size&&t.length){let i=t[0],o=[];if(e.forEach((c,f)=>{i.has(f)||o.push(f),i.set(f,c)}),o.length)for(let c=1;c<t.length;c++){let f=t[c];o.forEach(v=>f.set(v,CP(n,v)))}}return t}(t,V,S);const Q=function D8(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=cD(t[0]),t.length>1&&(i=cD(t[t.length-1]))):t instanceof Map&&(e=cD(t)),e||i?new M8(n,e,i):null}(t,V);return new BP(t,V,C,Q)}}let A8=(()=>{class n extends Pk{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:No.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(e)?Rk(e):e;return zP(this._renderer,null,i,"register",[o]),new I8(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(We(Qc),We(ai))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class I8 extends Tj{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new k8(this._id,t,e||{},this._renderer)}}class k8{constructor(t,e,i,o){this.id=t,this.element=e,this._renderer=o,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return zP(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function zP(n,t,e,i,o){return n.setProperty(t,`@@${e}:${i}`,o)}const VP="@.disabled";let P8=(()=>{class n{constructor(e,i,o){this.delegate=e,this.engine=i,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(c,f)=>{const v=f?.parentNode(c);v&&f.removeChild(v,c)}}createRenderer(e,i){const c=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let R=this._rendererCache.get(c);return R||(R=new UP("",c,this.engine,()=>this._rendererCache.delete(c)),this._rendererCache.set(c,R)),R}const f=i.id,v=i.id+"-"+this._currentId;this._currentId++,this.engine.register(v,e);const C=R=>{Array.isArray(R)?R.forEach(C):this.engine.registerTrigger(f,v,e,R.name,R)};return i.data.animation.forEach(C),new R8(this,v,c,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,o){e>=0&&e<this._microtaskId?this._zone.run(()=>i(o)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(c=>{const[f,v]=c;f(v)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(We(Qc),We(Rx),We(Pn))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class UP{constructor(t,e,i,o){this.namespaceId=t,this.delegate=e,this.engine=i,this._onDestroy=o,this.destroyNode=this.delegate.destroyNode?c=>e.destroyNode(c):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,o=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,o)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,o){this.delegate.setAttribute(t,e,i,o)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,o){this.delegate.setStyle(t,e,i,o)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==VP?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class R8 extends UP{constructor(t,e,i,o,c){super(e,i,o,c),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==VP?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.slice(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const o=function F8(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let c=e.slice(1),f="";return"@"!=c.charAt(0)&&([c,f]=function O8(n){const t=n.indexOf(".");return[n.substring(0,t),n.slice(t+1)]}(c)),this.engine.listen(this.namespaceId,o,c,f,v=>{this.factory.scheduleListenerCallback(v._data||-1,i,v)})}return this.delegate.listen(t,e,i)}}const jP=[{provide:Pk,useClass:A8},{provide:iD,useFactory:function N8(){return new n8}},{provide:Rx,useClass:(()=>{class n extends Rx{constructor(e,i,o,c){super(e.body,i,o)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(We(ai),We(qE),We(iD),We(Jp))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})()},{provide:Qc,useFactory:function B8(n,t,e){return new P8(n,t,e)},deps:[_0,Rx,Pn]}],uD=[{provide:qE,useFactory:()=>new T8},{provide:Bh,useValue:"BrowserAnimations"},...jP],$P=[{provide:qE,useClass:mP},{provide:Bh,useValue:"NoopAnimations"},...jP];let z8=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?$P:uD}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:uD,imports:[YT]}),n})(),dG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({imports:[ma,ma]}),n})();pi(893);let hG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({}),n})();const rp=new xn(un),fG={connector:()=>new yn};function sR(n,t=fG){const{connector:e}=t;return Xn((i,o)=>{const c=e();H(n(function pG(n){return new xn(t=>n.subscribe(t))}(c))).subscribe(o),o.add(i.subscribe(c))})}function aR(n,t){return t?e=>$m(t.pipe(ro(1),function _G(){return Xn((n,t)=>{n.subscribe(Rn(t,un))})}()),e.pipe(aR(n))):Je((e,i)=>H(n(e,i)).pipe(ro(1),lA(e)))}const av="Service workers are disabled or not supported by this browser";class zx{constructor(t){if(this.serviceWorker=t,t){const i=og(t,"controllerchange").pipe(nn(()=>t.controller)),c=$m(_y(()=>sn(t.controller)),i);this.worker=c.pipe(oo(R=>!!R)),this.registration=this.worker.pipe(Ys(()=>t.getRegistration()));const S=og(t,"message").pipe(nn(R=>R.data)).pipe(oo(R=>R&&R.type)).pipe(function gG(n){return n?t=>sR(n)(t):t=>function mG(n,t){const e=Nt(n)?n:()=>n;return Nt(t)?sR(t,{connector:e}):i=>new uC(i,e)}(new yn)(t)}());S.connect(),this.events=S}else this.worker=this.events=this.registration=function vG(n){return _y(()=>rf(new Error(n)))}(av)}postMessage(t,e){return this.worker.pipe(ro(1),yo(i=>{i.postMessage({action:t,...e})})).toPromise().then(()=>{})}postMessageWithOperation(t,e,i){const o=this.waitForOperationCompleted(i),c=this.postMessage(t,e);return Promise.all([c,o]).then(([,f])=>f)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(t){let e;return e="string"==typeof t?i=>i.type===t:i=>t.includes(i.type),this.events.pipe(oo(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(ro(1))}waitForOperationCompleted(t){return this.eventsOfType("OPERATION_COMPLETED").pipe(oo(e=>e.nonce===t),ro(1),nn(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let bG=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,this.pushManager=null,this.subscriptionChanges=new yn,!e.isEnabled)return this.messages=rp,this.notificationClicks=rp,void(this.subscription=rp);this.messages=this.sw.eventsOfType("PUSH").pipe(nn(o=>o.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(nn(o=>o.data)),this.pushManager=this.sw.registration.pipe(nn(o=>o.pushManager));const i=this.pushManager.pipe(Ys(o=>o.getSubscription()));this.subscription=qr(i,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(av));const i={userVisibleOnly:!0};let o=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(o.length));for(let f=0;f<o.length;f++)c[f]=o.charCodeAt(f);return i.applicationServerKey=c,this.pushManager.pipe(Ys(f=>f.subscribe(i)),ro(1)).toPromise().then(f=>(this.subscriptionChanges.next(f),f))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(ro(1),Ys(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(o=>{if(!o)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(av))}decodeBase64(e){return atob(e)}}return n.\u0275fac=function(e){return new(e||n)(We(zx))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),xG=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=rp,this.available=rp,this.activated=rp,void(this.unrecoverable=rp);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(oo(i=>"VERSION_READY"===i.type),nn(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(av));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(av));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return n.\u0275fac=function(e){return new(e||n)(We(zx))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class _D{}const lR=new wt("NGSW_REGISTER_SCRIPT");function wG(n,t,e,i){return()=>{if(!K1(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let o;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)o=e.registrationStrategy();else{const[f,...v]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(f){case"registerImmediately":o=sn(null);break;case"registerWithDelay":o=cR(+v[0]||0);break;case"registerWhenStable":o=v[0]?qr(uR(n),cR(+v[0])):uR(n);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}n.get(Pn).runOutsideAngular(()=>o.pipe(ro(1)).subscribe(()=>navigator.serviceWorker.register(t,{scope:e.scope}).catch(f=>console.error("Service worker registration failed with:",f))))}}function cR(n){return sn(null).pipe(function yG(n,t=rx){const e=G2(n,t);return aR(()=>e)}(n))}function uR(n){return n.get(Jp).isStable.pipe(oo(e=>e))}function CG(n,t){return new zx(K1(t)&&!1!==n.enabled?navigator.serviceWorker:void 0)}let EG=(()=>{class n{static register(e,i={}){return{ngModule:n,providers:[{provide:lR,useValue:e},{provide:_D,useValue:i},{provide:zx,useFactory:CG,deps:[_D,ay]},{provide:oy,useFactory:wG,deps:[Ts,lR,_D,ay],multi:!0}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n}),n.\u0275inj=qn({providers:[bG,xG]}),n})(),DG=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ii({type:n,bootstrap:[q3]}),n.\u0275inj=qn({providers:[sP,aE],imports:[YT,V$,z8,q5,W5,r$,rj,_6,gx,dG,hG,jm,E$,EG.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:30000"})]}),n})();rz().bootstrapModule(DG).catch(n=>console.error(n))},349:(Tr,Jt,pi)=>{var Nt,ze;!function(Vi,h){"use strict";Nt=function(){var h=function(){var Ie=window.Element.prototype;if(Ie.matches)return"matches";if(Ie.matchesSelector)return"matchesSelector";for(var Xt=["webkit","moz","ms","o"],kt=0;kt<Xt.length;kt++){var He=Xt[kt]+"MatchesSelector";if(Ie[He])return He}}();return function(Xt,kt){return Xt[h](kt)}},void 0!==(ze=Nt.call(Jt,pi,Jt,Tr))&&(Tr.exports=ze)}(window)},665:function(Tr,Jt,pi){var Nt,ze;typeof window<"u"&&window,void 0!==(ze="function"==typeof(Nt=function(){"use strict";function Vi(){}var h=Vi.prototype;return h.on=function(Ie,Xt){if(Ie&&Xt){var kt=this._events=this._events||{},xt=kt[Ie]=kt[Ie]||[];return-1==xt.indexOf(Xt)&&xt.push(Xt),this}},h.once=function(Ie,Xt){if(Ie&&Xt){this.on(Ie,Xt);var kt=this._onceEvents=this._onceEvents||{};return(kt[Ie]=kt[Ie]||{})[Xt]=!0,this}},h.off=function(Ie,Xt){var kt=this._events&&this._events[Ie];if(kt&&kt.length){var xt=kt.indexOf(Xt);return-1!=xt&&kt.splice(xt,1),this}},h.emitEvent=function(Ie,Xt){var kt=this._events&&this._events[Ie];if(kt&&kt.length){kt=kt.slice(0),Xt=Xt||[];for(var xt=this._onceEvents&&this._onceEvents[Ie],He=0;He<kt.length;He++){var yt=kt[He];xt&&xt[yt]&&(this.off(Ie,yt),delete xt[yt]),yt.apply(this,Xt)}return this}},h.allOff=function(){delete this._events,delete this._onceEvents},Vi})?Nt.call(Jt,pi,Jt,Tr):Nt)&&(Tr.exports=ze)},777:(Tr,Jt,pi)=>{var Nt,ze,Vi;Vi=window,Nt=[pi(349)],void 0!==(ze=function(Ie){return function(h,Ie){"use strict";var Xt={extend:function(He,yt){for(var Lt in yt)He[Lt]=yt[Lt];return He},modulo:function(He,yt){return(He%yt+yt)%yt}},kt=Array.prototype.slice;Xt.makeArray=function(He){return Array.isArray(He)?He:null==He?[]:"object"==typeof He&&"number"==typeof He.length?kt.call(He):[He]},Xt.removeFrom=function(He,yt){var Lt=He.indexOf(yt);-1!=Lt&&He.splice(Lt,1)},Xt.getParent=function(He,yt){for(;He.parentNode&&He!=document.body;)if(Ie(He=He.parentNode,yt))return He},Xt.getQueryElement=function(He){return"string"==typeof He?document.querySelector(He):He},Xt.handleEvent=function(He){var yt="on"+He.type;this[yt]&&this[yt](He)},Xt.filterFindElements=function(He,yt){He=Xt.makeArray(He);var Lt=[];return He.forEach(function(un){if(un instanceof HTMLElement){if(!yt)return void Lt.push(un);Ie(un,yt)&&Lt.push(un);for(var Yn=un.querySelectorAll(yt),Pt=0;Pt<Yn.length;Pt++)Lt.push(Yn[Pt])}}),Lt},Xt.debounceMethod=function(He,yt,Lt){Lt=Lt||100;var un=He.prototype[yt],Yn=yt+"Timeout";He.prototype[yt]=function(){clearTimeout(this[Yn]);var pt=arguments,tn=this;this[Yn]=setTimeout(function(){un.apply(tn,pt),delete tn[Yn]},Lt)}},Xt.docReady=function(He){var yt=document.readyState;"complete"==yt||"interactive"==yt?setTimeout(He):document.addEventListener("DOMContentLoaded",He)},Xt.toDashed=function(He){return He.replace(/(.)([A-Z])/g,function(yt,Lt,un){return Lt+"-"+un}).toLowerCase()};var xt=h.console;return Xt.htmlInit=function(He,yt){Xt.docReady(function(){var Lt=Xt.toDashed(yt),un="data-"+Lt,Yn=document.querySelectorAll("["+un+"]"),Pt=document.querySelectorAll(".js-"+Lt),pt=Xt.makeArray(Yn).concat(Xt.makeArray(Pt)),tn=un+"-options",en=h.jQuery;pt.forEach(function(it){var De,ae=it.getAttribute(un)||it.getAttribute(tn);try{De=ae&&JSON.parse(ae)}catch(gt){return void(xt&&xt.error("Error parsing "+un+" on "+it.className+": "+gt))}var ot=new He(it,De);en&&en.data(it,yt,ot)})})},Xt}(Vi,Ie)}.apply(Jt,Nt))&&(Tr.exports=ze)},390:(Tr,Jt,pi)=>{var Nt,ze;window,void 0!==(ze="function"==typeof(Nt=function(){"use strict";function h(pt){var tn=parseFloat(pt);return-1==pt.indexOf("%")&&!isNaN(tn)&&tn}var Xt=typeof console>"u"?function Ie(){}:function(pt){console.error(pt)},kt=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],xt=kt.length;function yt(pt){var tn=getComputedStyle(pt);return tn||Xt("Style returned "+tn+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),tn}var un,Lt=!1;function Pt(pt){if(function Yn(){if(!Lt){Lt=!0;var pt=document.createElement("div");pt.style.width="200px",pt.style.padding="1px 2px 3px 4px",pt.style.borderStyle="solid",pt.style.borderWidth="1px 2px 3px 4px",pt.style.boxSizing="border-box";var tn=document.body||document.documentElement;tn.appendChild(pt);var en=yt(pt);un=200==Math.round(h(en.width)),Pt.isBoxSizeOuter=un,tn.removeChild(pt)}}(),"string"==typeof pt&&(pt=document.querySelector(pt)),pt&&"object"==typeof pt&&pt.nodeType){var tn=yt(pt);if("none"==tn.display)return function He(){for(var pt={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},tn=0;tn<xt;tn++)pt[kt[tn]]=0;return pt}();var en={};en.width=pt.offsetWidth,en.height=pt.offsetHeight;for(var it=en.isBorderBox="border-box"==tn.boxSizing,ae=0;ae<xt;ae++){var De=kt[ae],gt=parseFloat(tn[De]);en[De]=isNaN(gt)?0:gt}var _n=en.paddingLeft+en.paddingRight,Ti=en.paddingTop+en.paddingBottom,Ui=en.marginLeft+en.marginRight,er=en.marginTop+en.marginBottom,fr=en.borderLeftWidth+en.borderRightWidth,gn=en.borderTopWidth+en.borderBottomWidth,mr=it&&un,wr=h(tn.width);!1!==wr&&(en.width=wr+(mr?0:_n+fr));var vo=h(tn.height);return!1!==vo&&(en.height=vo+(mr?0:Ti+gn)),en.innerWidth=en.width-(_n+fr),en.innerHeight=en.height-(Ti+gn),en.outerWidth=en.width+Ui,en.outerHeight=en.height+er,en}}return Pt})?Nt.call(Jt,pi,Jt,Tr):Nt)&&(Tr.exports=ze)},898:function(Tr){Tr.exports=function(){"use strict";var Jt,pi,Nt;function ze(h,Ie){if(Jt)if(pi){var Xt="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Jt+")(sharedChunk); ("+pi+")(sharedChunk); self.onerror = null;",kt={};Jt(kt),Nt=Ie(kt),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Nt.workerUrl=window.URL.createObjectURL(new Blob([Xt],{type:"text/javascript"})))}else pi=Ie;else Jt=Ie}return ze(0,function(h){var Ie=typeof self<"u"?self:{},Xt="2.14.1";let kt;const xt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==kt){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{kt=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):s}catch{kt=s}}return kt},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!xt.API_URL)return null;try{const s=new URL(xt.API_URL);return"api.mapbox.cn"===s.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===s.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},He={supported:!1,testSupport:function(s){!un&&Lt&&(Yn?Pt(s):yt=s)}};let yt,Lt,un=!1,Yn=!1;function Pt(s){const r=s.createTexture();s.bindTexture(s.TEXTURE_2D,r);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,Lt),s.isContextLost())return;He.supported=!0}catch{}s.deleteTexture(r),un=!0}Ie.document&&(Lt=Ie.document.createElement("img"),Lt.onload=function(){yt&&Pt(yt),yt=null,Yn=!0},Lt.onerror=function(){un=!0,yt=null},Lt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const pt="01";var tn=en;function en(s,r,a,u){this.cx=3*s,this.bx=3*(a-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=a,this.p2y=u}en.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(void 0===r&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var a=s,u=0;u<8;u++){var p=this.sampleCurveX(a)-s;if(Math.abs(p)<r)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=p/g}var y=0,x=1;for(a=s,u=0;u<20&&(p=this.sampleCurveX(a),!(Math.abs(p-s)<r));u++)s>p?y=a:x=a,a=.5*(x-y)+y;return a},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var it=ae;function ae(s,r){this.x=s,this.y=r}ae.prototype={clone:function(){return new ae(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,a=s.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),a=Math.sin(s),u=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=u,this},_rotateAround:function(s,r){var a=Math.cos(s),u=Math.sin(s),p=r.y+u*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-u*(this.y-r.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ae.convert=function(s){return s instanceof ae?s:Array.isArray(s)?new ae(s[0],s[1]):s};const De=Math.PI/180,ot=180/Math.PI;function gt(s){return s*De}function _n(s){return s*ot}const Ti=[[0,0],[1,0],[1,1],[0,1]];function Ui(s){if(s<=0)return 0;if(s>=1)return 1;const r=s*s,a=r*s;return 4*(s<.5?a:3*(s-r)+a-.75)}function er(s,r,a,u){const p=new tn(s,r,a,u);return function(g){return p.solve(g)}}const fr=er(.25,.1,.25,1);function gn(s,r,a){return Math.min(a,Math.max(r,s))}function mr(s,r,a){return(a=gn((a-s)/(r-s),0,1))*a*(3-2*a)}function wr(s,r,a){const u=a-r,p=((s-r)%u+u)%u+r;return p===r?a:p}function vo(s,r,a){if(!s.length)return a(null,[]);let u=s.length;const p=new Array(s.length);let g=null;s.forEach((y,x)=>{r(y,(E,D)=>{E&&(g=E),p[x]=D,0==--u&&a(g,p)})})}function Ro(s){const r=[];for(const a in s)r.push(s[a]);return r}function xn(s,...r){for(const a of r)for(const u in a)s[u]=a[u];return s}let Zo=1;function _a(){return Zo++}function Fs(){return function s(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)}()}function Yo(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function yn(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function Xo(s,r){s.forEach(a=>{r[a]&&(r[a]=r[a].bind(r))})}function _s(s,r){return-1!==s.indexOf(r,s.length-r.length)}function Xn(s,r,a){const u={};for(const p in s)u[p]=r.call(a||this,s[p],p,s);return u}function Rn(s,r,a){const u={};for(const p in s)r.call(a||this,s[p],p,s)&&(u[p]=s[p]);return u}function ar(s){return Array.isArray(s)?s.map(ar):"object"==typeof s&&s?Xn(s,ar):s}const nn={};function ei(s){nn[s]||(typeof console<"u"&&console.warn(s),nn[s]=!0)}function Ko(s,r,a){return(a.y-s.y)*(r.x-s.x)>(r.y-s.y)*(a.x-s.x)}function Kn(s){let r=0;for(let a,u,p=0,g=s.length,y=g-1;p<g;y=p++)a=s[p],u=s[y],r+=(u.x-a.x)*(a.y+u.y);return r}function ys(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Gn(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,u,p,g)=>{const y=p||g;return r[u]=!y||y.toLowerCase(),""}),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}let Fo=null;function so(s){if(null==Fo){const r=s.navigator?s.navigator.userAgent:null;Fo=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Fo}function Qs(s){try{const r=Ie[s];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function ir(s,r){return[s[4*r],s[4*r+1],s[4*r+2],s[4*r+3]]}const gr="mapbox-tiles";let vs,Oo,Fr=500,ol=50;function vc(){try{return Ie.caches}catch{}}function Os(){vc()&&!vs&&(vs=Ie.caches.open(gr))}function ya(s){const r=s.indexOf("?");if(r<0)return s;const u=function(p){const g=p.indexOf("?");return g>0?p.slice(g+1).split("&"):[]}(s).filter(p=>{const g=p.split("=");return"language"===g[0]||"worldview"===g[0]});return u.length?`${s.slice(0,r)}?${u.join("&")}`:s.slice(0,r)}let bc=1/0;const xc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(xc);class wn extends Error{constructor(r,a,u){401===a&&Ol(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const bs=ys()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Ie.location.protocol?Ie.parent:Ie).location.href,va=function(s,r){if(!(/^file:/.test(a=s.url)||/^file:/.test(bs())&&!/^\w+:/.test(a))){if(Ie.fetch&&Ie.Request&&Ie.AbortController&&Ie.Request.prototype.hasOwnProperty("signal"))return function(u,p){const g=new Ie.AbortController,y=new Ie.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:bs(),referrerPolicy:u.referrerPolicy,signal:g.signal});let x=!1,E=!1;const D=(A=y.url).indexOf("sku=")>0&&Ol(A);var A;"json"===u.type&&y.headers.set("Accept","application/json");const P=(B,z,$)=>{if(E)return;if(B&&"SecurityError"!==B.message&&ei(B),z&&$)return O(z);const Z=Date.now();Ie.fetch(y).then(ie=>{if(ie.ok){const he=D?ie.clone():null;return O(ie,he,Z)}return p(new wn(ie.statusText,ie.status,u.url))}).catch(ie=>{"AbortError"!==ie.name&&p(new Error(`${ie.message} ${u.url}`))})},O=(B,z,$)=>{("arrayBuffer"===u.type?B.arrayBuffer():"json"===u.type?B.json():B.text()).then(Z=>{E||(z&&$&&function(ie,he,ne){if(Os(),!vs)return;const ce={status:he.status,statusText:he.statusText,headers:new Ie.Headers};he.headers.forEach((Oe,Pe)=>ce.headers.set(Pe,Oe));const _e=Gn(he.headers.get("Cache-Control")||"");if(_e["no-store"])return;_e["max-age"]&&ce.headers.set("Expires",new Date(ne+1e3*_e["max-age"]).toUTCString());const de=ce.headers.get("Expires");de&&(new Date(de).getTime()-ne<42e4||function(Oe,Pe){if(void 0===Oo)try{new Response(new ReadableStream),Oo=!0}catch{Oo=!1}Oo?Pe(Oe.body):Oe.blob().then(Pe)}(he,Oe=>{const Pe=new Ie.Response(Oe,ce);Os(),vs&&vs.then(Ge=>Ge.put(ya(ie.url),Pe)).catch(Ge=>ei(Ge.message))}))}(y,z,$),x=!0,p(null,Z,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(Z=>{E||p(new Error(Z.message))})};return D?function(B,z){if(Os(),!vs)return z(null);const $=ya(B.url);vs.then(Z=>{Z.match($).then(ie=>{const he=function(ne){if(!ne)return!1;const ce=new Date(ne.headers.get("Expires")||0),_e=Gn(ne.headers.get("Cache-Control")||"");return ce>Date.now()&&!_e["no-cache"]}(ie);Z.delete($),he&&Z.put($,ie.clone()),z(null,ie,he)}).catch(z)}).catch(z)}(y,P):P(null,null),{cancel:()=>{E=!0,x||g.abort()}}}(s,r);if(ys()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,r,void 0,!0)}var a;return function(u,p){const g=new Ie.XMLHttpRequest;g.open(u.method||"GET",u.url,!0),"arrayBuffer"===u.type&&(g.responseType="arraybuffer");for(const y in u.headers)g.setRequestHeader(y,u.headers[y]);return"json"===u.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===u.credentials,g.onerror=()=>{p(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){let y=g.response;if("json"===u.type)try{y=JSON.parse(g.response)}catch(x){return p(x)}p(null,y,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else p(new wn(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}}(s,r)},sl=function(s,r){return va(xn(s,{type:"arrayBuffer"}),r)};function wc(s){const r=Ie.document.createElement("a");return r.href=s,r.protocol===Ie.document.location.protocol&&r.host===Ie.document.location.host}const Cc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Qo,Rl;Qo=[],Rl=0;const _u=function(s,r){if(He.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Rl>=xt.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:s,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Qo.push(g),g}Rl++;let a=!1;const u=()=>{if(!a)for(a=!0,Rl--;Qo.length&&Rl<xt.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Qo.shift(),{requestParameters:y,callback:x,cancelled:E}=g;E||(g.cancel=_u(y,x).cancel)}},p=sl(s,(g,y,x,E)=>{u(),g?r(g):y&&(Ie.createImageBitmap?function(D,A){const P=new Ie.Blob([new Uint8Array(D)],{type:"image/png"});Ie.createImageBitmap(P).then(O=>{A(null,O)}).catch(O=>{A(new Error(`Could not load image because of ${O.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(D,A)=>r(D,A,x,E)):function(D,A){const P=new Ie.Image,O=Ie.URL;P.onload=()=>{A(null,P),O.revokeObjectURL(P.src),P.onload=null,Ie.requestAnimationFrame(()=>{P.src=Cc})},P.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new Ie.Blob([new Uint8Array(D)],{type:"image/png"});P.src=D.byteLength?O.createObjectURL(B):Cc}(y,(D,A)=>r(D,A,x,E)))});return{cancel:()=>{p.cancel(),u()}}},Fl="NO_ACCESS_TOKEN";function Ls(s){return 0===s.indexOf("mapbox:")}function Ol(s){return xt.API_URL_REGEX.test(s)}function ba(s){return xt.API_CDN_URL_REGEX.test(s)}function Ec(s){return xt.API_STYLE_REGEX.test(s)&&!al(s)}function al(s){return xt.API_SPRITE_REGEX.test(s)}const Jo=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function bo(s){const r=s.match(Jo);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function xa(s){const r=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${r}`}function Dc(s){if(!s)return null;const r=s.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(Ie.atob(r[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class wa{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const a=Dc(xt.ACCESS_TOKEN);let u="";return u=a&&a.u?Ie.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(p,g)=>String.fromCharCode(Number("0x"+g)))):xt.ACCESS_TOKEN||"",r?`mapbox.eventData.${r}:${u}`:`mapbox.eventData:${u}`}fetchEventData(){const r=Qs("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(r)try{const p=Ie.localStorage.getItem(a);p&&(this.eventData=JSON.parse(p));const g=Ie.localStorage.getItem(u);g&&(this.anonId=g)}catch{ei("Unable to read from LocalStorage")}}saveEventData(){const r=Qs("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(r)try{Ie.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&Ie.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{ei("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,a,u,p){if(!xt.EVENTS_URL)return;const g=bo(xt.EVENTS_URL);g.params.push(`access_token=${p||xt.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(r).toISOString()},x=a?xn(y,a):y,E={url:xa(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};var A;this.pendingRequest=(A=D=>{this.pendingRequest=null,u(D),this.saveEventData(),this.processRequests(p)},va(xn(E,{method:"POST"}),A))}queueRequest(r,a){this.queue.push(r),this.processRequests(a)}}const te=new class extends wa{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,r){xt.EVENTS_URL&&xt.ACCESS_TOKEN&&Array.isArray(s)&&s.some(a=>Ls(a)||Ol(a))&&this.queueRequest(Date.now(),r)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Dc(xt.ACCESS_TOKEN),a=r?r.u:xt.ACCESS_TOKEN;let u=a!==this.eventData.tokenU;yn(this.anonId)||(this.anonId=Fs(),u=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),y=new Date(p),x=(p-this.eventData.lastSuccess)/864e5;u=u||x>=1||x<-1||g.getDate()!==y.getDate()}else u=!0;u?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Xt,skuId:pt,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=p,this.eventData.tokenU=a)},s):this.processRequests()}},j=te.postTurnstileEvent.bind(te),H=new class extends wa{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,r,a,u){this.skuToken=r,this.errorCb=u,xt.EVENTS_URL&&(a||xt.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Fl)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),yn(this.anonId)||(this.anonId=Fs()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Xt,skuId:pt,skuToken:this.skuToken,userId:this.anonId},u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},s))}},ee=H.postMapLoadEvent.bind(H),ue=new class extends wa{constructor(){super("gljs.performance")}postPerformanceEvent(s,r){xt.EVENTS_URL&&(s||xt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},s)}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:a}=this.queue.shift(),u=function(p){const g=Ie.performance.getEntriesByType("resource"),y=Ie.performance.getEntriesByType("mark"),x=function(O){const B={};if(O)for(const z in O)if("other"!==z)for(const $ of O[z]){const Z=`${z}ResolveRangeMin`,ie=`${z}ResolveRangeMax`,he=`${z}RequestCount`,ne=`${z}RequestCachedCount`;B[Z]=Math.min(B[Z]||1/0,$.startTime),B[ie]=Math.max(B[ie]||-1/0,$.responseEnd);const ce=_e=>{void 0===B[_e]&&(B[_e]=0),++B[_e]};void 0!==$.transferSize&&0===$.transferSize&&ce(ne),ce(he)}return B}(function(O,B){const z={};if(O)for(const $ of O){const Z=B($);void 0===z[Z]&&(z[Z]=[]),z[Z].push($)}return z}(g,Tt)),E=Ie.devicePixelRatio,D=Ie.navigator.connection||Ie.navigator.mozConnection||Ie.navigator.webkitConnection,A={counters:[],metadata:[],attributes:[]},P=(O,B,z)=>{null!=z&&O.push({name:B,value:z.toString()})};for(const O in x)P(A.counters,O,x[O]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(P(A.counters,"interactionRangeMin",p.interactionRange[0]),P(A.counters,"interactionRangeMax",p.interactionRange[1])),y)for(const O of Object.keys(Re)){const B=Re[O],z=y.find($=>$.name===B);z&&P(A.counters,B,z.startTime)}return P(A.counters,"visibilityHidden",p.visibilityHidden),P(A.attributes,"style",function(O){if(O)for(const B of O){const z=B.name.split("?")[0];if(Ec(z)){const $=z.split("/").slice(-2);if(2===$.length)return`mapbox://styles/${$[0]}/${$[1]}`}}}(g)),P(A.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),P(A.attributes,"fogEnabled",p.fogEnabled?"true":"false"),P(A.attributes,"projection",p.projection),P(A.attributes,"zoom",p.zoom),P(A.metadata,"devicePixelRatio",E),P(A.metadata,"connectionEffectiveType",D?D.effectiveType:void 0),P(A.metadata,"navigatorUserAgent",Ie.navigator.userAgent),P(A.metadata,"screenWidth",Ie.screen.width),P(A.metadata,"screenHeight",Ie.screen.height),P(A.metadata,"windowWidth",Ie.innerWidth),P(A.metadata,"windowHeight",Ie.innerHeight),P(A.metadata,"mapWidth",p.width/E),P(A.metadata,"mapHeight",p.height/E),P(A.metadata,"webglRenderer",p.renderer),P(A.metadata,"webglVendor",p.vendor),P(A.metadata,"sdkVersion",Xt),P(A.metadata,"sdkIdentifier","mapbox-gl-js"),A}(a);for(const p of u.metadata);for(const p of u.counters);for(const p of u.attributes);this.postEvent(r,u,()=>{},s)}},be=ue.postPerformanceEvent.bind(ue),Ae=new class extends wa{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,r,a,u){if(!xt.API_URL||!xt.SESSION_PATH)return;const p=bo(xt.API_URL+xt.SESSION_PATH);p.params.push(`sku=${r||""}`),p.params.push(`access_token=${u||xt.ACCESS_TOKEN||""}`);const g={url:xa(p),headers:{"Content-Type":"text/plain"}};var x;this.pendingRequest=(x=y=>{this.pendingRequest=null,a(y),this.saveEventData(),this.processRequests(u)},va(xn(g,{method:"GET"}),x))}getSessionAPI(s,r,a,u){this.skuToken=r,this.errorCb=u,xt.SESSION_PATH&&xt.API_URL&&(a||xt.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Fl)))}processRequests(s){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||this.getSession(a,this.skuToken,u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},s)}},Te=Ae.getSessionAPI.bind(Ae),Ce=new Set,Re={create:"create",load:"load",fullLoad:"fullLoad"},tt={mark(s){Ie.performance.mark(s)},measure(s,r,a){Ie.performance.measure(s,r,a)}};function Tt(s){const r=s.name.split("?")[0];return ba(r)&&r.includes("mapbox-gl.js")?"javascript":ba(r)&&r.includes("mapbox-gl.css")?"css":xt.API_FONTS_REGEX.test(r)?"fontRange":al(r)?"sprite":Ec(r)?"style":xt.API_TILEJSON_REGEX.test(r)?"tilejson":"other"}const Je=Ie.performance;function zt(s){const r=s?s.url.toString():void 0;return Je.getEntriesByName(r)}let Ft,Gt,Ut,Mn;const Qn={now:()=>void 0!==Ut?Ut:Ie.performance.now(),setNow(s){Ut=s},restoreNow(){Ut=void 0},frame(s){const r=Ie.requestAnimationFrame(s);return{cancel:()=>Ie.cancelAnimationFrame(r)}},getImageData(s,r=0){const{width:a,height:u}=s;Mn||(Mn=Ie.document.createElement("canvas"));const p=Mn.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(a>Mn.width||u>Mn.height)&&(Mn.width=a,Mn.height=u),p.clearRect(-r,-r,a+2*r,u+2*r),p.drawImage(s,0,0,a,u),p.getImageData(-r,-r,a+2*r,u+2*r)},resolveURL:s=>(Ft||(Ft=Ie.document.createElement("a")),Ft.href=s,Ft.href),get devicePixelRatio(){return Ie.devicePixelRatio},get prefersReducedMotion(){return!!Ie.matchMedia&&(null==Gt&&(Gt=Ie.matchMedia("(prefers-reduced-motion: reduce)")),Gt.matches)}};function rn(s,r,a){a[s]&&-1!==a[s].indexOf(r)||(a[s]=a[s]||[],a[s].push(r))}function ti(s,r,a){if(a&&a[s]){const u=a[s].indexOf(r);-1!==u&&a[s].splice(u,1)}}class Ei{constructor(r,a={}){xn(this,a),this.type=r}}class Js extends Ei{constructor(r,a={}){super("error",xn({error:r},a))}}class Ns{on(r,a){return this._listeners=this._listeners||{},rn(r,a,this._listeners),this}off(r,a){return ti(r,a,this._listeners),ti(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},rn(r,a,this._oneTimeListeners),this):new Promise(u=>this.once(r,u))}fire(r,a){"string"==typeof r&&(r=new Ei(r,a||{}));const u=r.type;if(this.listens(u)){r.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const x of p)x.call(this,r);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const x of g)ti(u,x,this._oneTimeListeners),x.call(this,r);const y=this._eventedParent;y&&(xn(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(r))}else r instanceof Js&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var qe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ea(s,...r){for(const a of r)for(const u in a)s[u]=a[u];return s}function rr(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Ca(s){if(Array.isArray(s))return s.map(Ca);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const a in s)r[a]=Ca(s[a]);return r}return rr(s)}class Ju extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}var Bs=Ju;class Ll{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[u,p]of a)this.bindings[u]=p}concat(r){return new Ll(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var lr=Ll;const qr={kind:"null"},bt={kind:"number"},In={kind:"string"},Ht={kind:"boolean"},es={kind:"color"},vi={kind:"object"},Tn={kind:"value"},Nl={kind:"collator"},ci={kind:"formatted"},pn={kind:"resolvedImage"};function or(s,r){return{kind:"array",itemType:s,N:r}}function bi(s){if("array"===s.kind){const r=bi(s.itemType);return"number"==typeof s.N?`array<${r}, ${s.N}>`:"value"===s.itemType.kind?"array":`array<${r}>`}return s.kind}const sp=[qr,bt,In,Ht,es,ci,vi,or(Tn),pn];function Cr(s,r){if("error"===r.kind)return null;if("array"===s.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!Cr(s.itemType,r.itemType))&&("number"!=typeof s.N||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if("value"===s.kind)for(const a of sp)if(!Cr(a,r))return null}return`Expected ${bi(s)} but found ${bi(r)} instead.`}function nt(s,r){return r.some(a=>a.kind===s.kind)}function zs(s,r){return r.some(a=>"null"===a?null===s:"array"===a?Array.isArray(s):"object"===a?s&&!Array.isArray(s)&&"object"==typeof s:a===typeof s)}var Sn,fi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Mc(s){return(s=Math.round(s))<0?0:s>255?255:s}function Bl(s){return Mc("%"===s[s.length-1]?parseFloat(s)/100*255:parseInt(s))}function zl(s){return(r="%"===s[s.length-1]?parseFloat(s)/100:parseFloat(s))<0?0:r>1?1:r;var r}function Vs(s,r,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?s+(r-s)*a*6:2*a<1?r:3*a<2?s+(r-s)*(2/3-a)*6:s}try{Sn={}.parseCSSColor=function(s){var r,a=s.replace(/ /g,"").toLowerCase();if(a in fi)return fi[a].slice();if("#"===a[0])return 4===a.length?(r=parseInt(a.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===a.length&&(r=parseInt(a.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var u=a.indexOf("("),p=a.indexOf(")");if(-1!==u&&p+1===a.length){var g=a.substr(0,u),y=a.substr(u+1,p-(u+1)).split(","),x=1;switch(g){case"rgba":if(4!==y.length)return null;x=zl(y.pop());case"rgb":return 3!==y.length?null:[Bl(y[0]),Bl(y[1]),Bl(y[2]),x];case"hsla":if(4!==y.length)return null;x=zl(y.pop());case"hsl":if(3!==y.length)return null;var E=(parseFloat(y[0])%360+360)%360/360,D=zl(y[1]),A=zl(y[2]),P=A<=.5?A*(D+1):A+D-A*D,O=2*A-P;return[Mc(255*Vs(O,P,E+1/3)),Mc(255*Vs(O,P,E)),Mc(255*Vs(O,P,E-1/3)),x];default:return null}}return null}}catch{}class Zi{constructor(r,a,u,p=1){this.r=r,this.g=a,this.b=u,this.a=p}static parse(r){if(!r)return;if(r instanceof Zi)return r;if("string"!=typeof r)return;const a=Sn(r);return a?new Zi(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[r,a,u,p]=this.toArray();return`rgba(${Math.round(r)},${Math.round(a)},${Math.round(u)},${p})`}toArray(){const{r,g:a,b:u,a:p}=this;return 0===p?[0,0,0,0]:[255*r/p,255*a/p,255*u/p,p]}toArray01(){const{r,g:a,b:u,a:p}=this;return 0===p?[0,0,0,0]:[r/p,a/p,u/p,p]}toArray01PremultipliedAlpha(){const{r,g:a,b:u,a:p}=this;return[r,a,u,p]}}Zi.black=new Zi(0,0,0,1),Zi.white=new Zi(1,1,1,1),Zi.transparent=new Zi(0,0,0,0),Zi.red=new Zi(1,0,0,1),Zi.blue=new Zi(0,0,1,1);var sr=Zi;class yu{constructor(r,a,u){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vu{constructor(r,a,u,p,g){this.text=r.normalize?r.normalize():r,this.image=a,this.scale=u,this.fontStack=p,this.textColor=g}}class cr{constructor(r){this.sections=r}static fromString(r){return new cr([new vu(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.name.length)}static factory(r){return r instanceof cr?r:cr.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const a of this.sections){if(a.image){r.push(["image",a.image.name]);continue}r.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(u)}return r}}class xo{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new xo({name:r,available:!1}):null}serialize(){return["image",this.name]}}function ap(s,r,a,u){return"number"==typeof s&&s>=0&&s<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===u||"number"==typeof u&&u>=0&&u<=1?null:`Invalid rgba value [${[s,r,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof u?[s,r,a,u]:[s,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ed(s){if(null===s||"string"==typeof s||"boolean"==typeof s||"number"==typeof s||s instanceof sr||s instanceof yu||s instanceof cr||s instanceof xo)return!0;if(Array.isArray(s)){for(const r of s)if(!ed(r))return!1;return!0}if("object"==typeof s){for(const r in s)if(!ed(s[r]))return!1;return!0}return!1}function Er(s){if(null===s)return qr;if("string"==typeof s)return In;if("boolean"==typeof s)return Ht;if("number"==typeof s)return bt;if(s instanceof sr)return es;if(s instanceof yu)return Nl;if(s instanceof cr)return ci;if(s instanceof xo)return pn;if(Array.isArray(s)){const r=s.length;let a;for(const u of s){const p=Er(u);if(a){if(a===p)continue;a=Tn;break}a=p}return or(a||Tn,r)}return vi}function Sc(s){const r=typeof s;return null===s?"":"string"===r||"number"===r||"boolean"===r?String(s):s instanceof sr||s instanceof cr||s instanceof xo?s.toString():JSON.stringify(s)}class $d{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(2!==r.length)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!ed(r[1]))return a.error("invalid value");const u=r[1];let p=Er(u);const g=a.expectedType;return"array"!==p.kind||0!==p.N||!g||"array"!==g.kind||"number"==typeof g.N&&0!==g.N||(p=g),new $d(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof sr?["rgba"].concat(this.value.toArray()):this.value instanceof cr?this.value.serialize():this.value}}var Vl=$d,Wr=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const Ar={string:In,number:bt,boolean:Ht,object:vi};class oi{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let u,p=1;const g=r[0];if("array"===g){let x,E;if(r.length>2){const D=r[1];if("string"!=typeof D||!(D in Ar)||"object"===D)return a.error('The item type argument of "array" must be one of string, number, boolean',1);x=Ar[D],p++}else x=Tn;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);E=r[2],p++}u=or(x,E)}else u=Ar[g];const y=[];for(;p<r.length;p++){const x=a.parse(r[p],p,Tn);if(!x)return null;y.push(x)}return new oi(u,y)}evaluate(r){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(r);if(!Cr(this.type,Er(u)))return u;if(a===this.args.length-1)throw new Wr(`Expected value to be of type ${bi(this.type)}, but found ${bi(Er(u))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,a=[r.kind];if("array"===r.kind){const u=r.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){a.push(u.kind);const p=r.N;("number"==typeof p||this.args.length>1)&&a.push(p)}}return a.concat(this.args.map(u=>u.serialize()))}}var Ea=oi;class bu{constructor(r){this.type=ci,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const u=r[1];if(!Array.isArray(u)&&"object"==typeof u)return a.error("First argument must be an image or text section.");const p=[];let g=!1;for(let y=1;y<=r.length-1;++y){const x=r[y];if(g&&"object"==typeof x&&!Array.isArray(x)){g=!1;let E=null;if(x["font-scale"]&&(E=a.parse(x["font-scale"],1,bt),!E))return null;let D=null;if(x["text-font"]&&(D=a.parse(x["text-font"],1,or(In)),!D))return null;let A=null;if(x["text-color"]&&(A=a.parse(x["text-color"],1,es),!A))return null;const P=p[p.length-1];P.scale=E,P.font=D,P.textColor=A}else{const E=a.parse(r[y],1,Tn);if(!E)return null;const D=E.type.kind;if("string"!==D&&"value"!==D&&"null"!==D&&"resolvedImage"!==D)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,p.push({content:E,scale:null,font:null,textColor:null})}}return new bu(p)}evaluate(r){return new cr(this.sections.map(a=>{const u=a.content.evaluate(r);return Er(u)===pn?new vu("",u,null,null,null):new vu(Sc(u),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const a of this.sections){r.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),r.push(u)}return r}}class ll{constructor(r){this.type=pn,this.input=r}static parse(r,a){if(2!==r.length)return a.error("Expected two arguments.");const u=a.parse(r[1],1,In);return u?new ll(u):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),u=xo.fromString(a);return u&&r.availableImages&&(u.available=r.availableImages.indexOf(a)>-1),u}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Mt={"to-boolean":Ht,"to-color":es,"to-number":bt,"to-string":In};class Hd{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const u=r[0];if(("to-boolean"===u||"to-string"===u)&&2!==r.length)return a.error("Expected one argument.");const p=Mt[u],g=[];for(let y=1;y<r.length;y++){const x=a.parse(r[y],y,Tn);if(!x)return null;g.push(x)}return new Hd(p,g)}evaluate(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){let a,u;for(const p of this.args){if(a=p.evaluate(r),u=null,a instanceof sr)return a;if("string"==typeof a){const g=r.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:ap(a[0],a[1],a[2],a[3]),!u))return new sr(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Wr(u||`Could not parse color from value '${"string"==typeof a?a:String(JSON.stringify(a))}'`)}if("number"===this.type.kind){let a=null;for(const u of this.args){if(a=u.evaluate(r),null===a)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Wr(`Could not convert ${JSON.stringify(a)} to number.`)}return"formatted"===this.type.kind?cr.fromString(Sc(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?xo.fromString(Sc(this.args[0].evaluate(r))):Sc(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new bu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ll(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(a=>{r.push(a.serialize())}),r}}var qn=Hd;const Ul=["Unknown","Point","LineString","Polygon"];var jl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ul[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:a,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*r-s[0])+this.featureDistanceData.bearing[1]*(u*r-s[1])}return 0}parseColor(s){let r=this._parseColorCache[s];return r||(r=this._parseColorCache[s]=sr.parse(s)),r}};class Da{constructor(r,a,u,p){this.name=r,this.type=a,this._evaluate=u,this.args=p}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,a){const u=r[0],p=Da.definitions[u];if(!p)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(p)?p[0]:p.type,y=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,x=y.filter(([D])=>!Array.isArray(D)||D.length===r.length-1);let E=null;for(const[D,A]of x){E=new We(a.registry,a.path,null,a.scope);const P=[];let O=!1;for(let B=1;B<r.length;B++){const z=r[B],$=Array.isArray(D)?D[B-1]:D.type,Z=E.parse(z,1+P.length,$);if(!Z){O=!0;break}P.push(Z)}if(!O)if(Array.isArray(D)&&D.length!==P.length)E.error(`Expected ${D.length} arguments, but found ${P.length} instead.`);else{for(let B=0;B<P.length;B++){const z=Array.isArray(D)?D[B]:D.type,$=P[B];E.concat(B+1).checkSubtype(z,$.type)}if(0===E.errors.length)return new Da(u,g,A,P)}}if(1===x.length)a.errors.push(...E.errors);else{const D=(x.length?x:y).map(([P])=>{return O=P,Array.isArray(O)?`(${O.map(bi).join(", ")})`:`(${bi(O.type)}...)`;var O}).join(" | "),A=[];for(let P=1;P<r.length;P++){const O=a.parse(r[P],1+A.length);if(!O)return null;A.push(bi(O.type))}a.error(`Expected arguments of type ${D}, but found (${A.join(", ")}) instead.`)}return null}static register(r,a){Da.definitions=a;for(const u in a)r[u]=Da}}var Ma=Da;class Tc{constructor(r,a,u){this.type=Nl,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(2!==r.length)return a.error("Expected one argument.");const u=r[1];if("object"!=typeof u||Array.isArray(u))return a.error("Collator options argument must be an object.");const p=a.parse(void 0!==u["case-sensitive"]&&u["case-sensitive"],1,Ht);if(!p)return null;const g=a.parse(void 0!==u["diacritic-sensitive"]&&u["diacritic-sensitive"],1,Ht);if(!g)return null;let y=null;return u.locale&&(y=a.parse(u.locale,1,In),!y)?null:new Tc(p,g,y)}evaluate(r){return new yu(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const xs=8192;function wo(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function $l(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Gd(s,r){const a=(180+s[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(a*p*xs),Math.round(u*p*xs)]}function dn(s,r,a){const u=s[0]-r[0],p=s[1]-r[1],g=s[0]-a[0],y=s[1]-a[1];return u*y-g*p==0&&u*g<=0&&p*y<=0}function Hl(s,r){let a=!1;for(let y=0,x=r.length;y<x;y++){const E=r[y];for(let D=0,A=E.length;D<A-1;D++){if(dn(s,E[D],E[D+1]))return!1;(p=E[D])[1]>(u=s)[1]!=(g=E[D+1])[1]>u[1]&&u[0]<(g[0]-p[0])*(u[1]-p[1])/(g[1]-p[1])+p[0]&&(a=!a)}}var u,p,g;return a}function qd(s,r){for(let a=0;a<r.length;a++)if(Hl(s,r[a]))return!0;return!1}function Co(s,r,a,u){const p=u[0]-a[0],g=u[1]-a[1],y=(s[0]-a[0])*g-p*(s[1]-a[1]),x=(r[0]-a[0])*g-p*(r[1]-a[1]);return y>0&&x<0||y<0&&x>0}function Ac(s,r,a){for(const D of a)for(let A=0;A<D.length-1;++A)if((x=[(y=D[A+1])[0]-(g=D[A])[0],y[1]-g[1]])[0]*(E=[(p=r)[0]-(u=s)[0],p[1]-u[1]])[1]-x[1]*E[0]!=0&&Co(u,p,g,y)&&Co(g,y,u,p))return!0;var u,p,g,y,x,E;return!1}function Gl(s,r){for(let a=0;a<s.length;++a)if(!Hl(s[a],r))return!1;for(let a=0;a<s.length-1;++a)if(Ac(s[a],s[a+1],r))return!1;return!0}function Oi(s,r){for(let a=0;a<r.length;a++)if(Gl(s,r[a]))return!0;return!1}function td(s,r,a){const u=[];for(let p=0;p<s.length;p++){const g=[];for(let y=0;y<s[p].length;y++){const x=Gd(s[p][y],a);wo(r,x),g.push(x)}u.push(g)}return u}function nd(s,r,a){const u=[];for(let p=0;p<s.length;p++){const g=td(s[p],r,a);u.push(g)}return u}function Wd(s,r,a,u){if(s[0]<a[0]||s[0]>a[2]){const p=.5*u;let g=s[0]-a[0]>p?-u:a[0]-s[0]>p?u:0;0===g&&(g=s[0]-a[2]>p?-u:a[2]-s[0]>p?u:0),s[0]+=g}wo(r,s)}function ws(s,r,a,u){const p=Math.pow(2,u.z)*xs,g=[u.x*xs,u.y*xs],y=[];if(!s)return y;for(const x of s)for(const E of x){const D=[E.x+g[0],E.y+g[1]];Wd(D,r,a,p),y.push(D)}return y}function ni(s,r,a,u){const p=Math.pow(2,u.z)*xs,g=[u.x*xs,u.y*xs],y=[];if(!s)return y;for(const E of s){const D=[];for(const A of E){const P=[A.x+g[0],A.y+g[1]];wo(r,P),D.push(P)}y.push(D)}if(r[2]-r[0]<=p/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const E of y)for(const D of E)Wd(D,r,a,p)}var x;return y}class Sa{constructor(r,a){this.type=Ht,this.geojson=r,this.geometries=a}static parse(r,a){if(2!==r.length)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ed(r[1])){const u=r[1];if("FeatureCollection"===u.type)for(let p=0;p<u.features.length;++p){const g=u.features[p].geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new Sa(u,u.features[p].geometry)}else if("Feature"===u.type){const p=u.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Sa(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new Sa(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(a,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if("Polygon"===u.type){const x=td(u.coordinates,g,y),E=ws(a.geometry(),p,g,y);if(!$l(p,g))return!1;for(const D of E)if(!Hl(D,x))return!1}if("MultiPolygon"===u.type){const x=nd(u.coordinates,g,y),E=ws(a.geometry(),p,g,y);if(!$l(p,g))return!1;for(const D of E)if(!qd(D,x))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(a,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if("Polygon"===u.type){const x=td(u.coordinates,g,y),E=ni(a.geometry(),p,g,y);if(!$l(p,g))return!1;for(const D of E)if(!Gl(D,x))return!1}if("MultiPolygon"===u.type){const x=nd(u.coordinates,g,y),E=ni(a.geometry(),p,g,y);if(!$l(p,g))return!1;for(const D of E)if(!Oi(D,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var id=Sa;function Ic(s){if(s instanceof Ma&&("get"===s.name&&1===s.args.length||"feature-state"===s.name||"has"===s.name&&1===s.args.length||"properties"===s.name||"geometry-type"===s.name||"id"===s.name||/^filter-/.test(s.name))||s instanceof id)return!1;let r=!0;return s.eachChild(a=>{r&&!Ic(a)&&(r=!1)}),r}function ql(s){if(s instanceof Ma&&"feature-state"===s.name)return!1;let r=!0;return s.eachChild(a=>{r&&!ql(a)&&(r=!1)}),r}function cl(s,r){if(s instanceof Ma&&r.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild(u=>{a&&!cl(u,r)&&(a=!1)}),a}class ta{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(2!==r.length||"string"!=typeof r[1])return a.error("'var' expression requires exactly one string literal argument.");const u=r[1];return a.scope.has(u)?new ta(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Lo=ta;class xu{constructor(r,a=[],u,p=new lr,g=[]){this.registry=r,this.path=a,this.key=a.map(y=>`[${y}]`).join(""),this.scope=p,this.errors=g,this.expectedType=u}parse(r,a,u,p,g={}){return a?this.concat(a,u,p)._parse(r,g):this._parse(r,g)}_parse(r,a){function u(p,g,y){return"assert"===y?new Ea(g,[p]):"coerce"===y?new qn(g,[p]):p}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=r[0];if("string"!=typeof p)return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[p];if(g){let y=g.parse(r,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,E=y.type;if("string"!==x.kind&&"number"!==x.kind&&"boolean"!==x.kind&&"object"!==x.kind&&"array"!==x.kind||"value"!==E.kind)if("color"!==x.kind&&"formatted"!==x.kind&&"resolvedImage"!==x.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(x,E))return null}else y=u(y,x,a.typeAnnotation||"coerce");else y=u(y,x,a.typeAnnotation||"assert")}if(!(y instanceof Vl)&&"resolvedImage"!==y.type.kind&&na(y)){const x=new jl;try{y=new Vl(y.type,y.evaluate(x))}catch(E){return this.error(E.message),null}}return y}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,u){const p="number"==typeof r?this.path.concat(r):this.path,g=u?this.scope.concat(u):this.scope;return new xu(this.registry,p,a||null,g,this.errors)}error(r,...a){const u=`${this.key}${a.map(p=>`[${p}]`).join("")}`;this.errors.push(new Bs(u,r))}checkSubtype(r,a){const u=Cr(r,a);return u&&this.error(u),u}}var We=xu;function na(s){if(s instanceof Lo)return na(s.boundExpression);if(s instanceof Ma&&"error"===s.name||s instanceof Tc||s instanceof id)return!1;const r=s instanceof qn||s instanceof Ea;let a=!0;return s.eachChild(u=>{a=r?a&&na(u):a&&u instanceof Vl}),!!a&&Ic(s)&&cl(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function bn(s,r){const a=s.length-1;let u,p,g=0,y=a,x=0;for(;g<=y;)if(x=Math.floor((g+y)/2),u=s[x],p=s[x+1],u<=r){if(x===a||r<p)return x;g=x+1}else{if(!(u>r))throw new Wr("Input is not a number.");y=x-1}return 0}class ul{constructor(r,a,u){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[p,g]of u)this.labels.push(p),this.outputs.push(g)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(r[1],1,bt);if(!u)return null;const p=[];let g=null;a.expectedType&&"value"!==a.expectedType.kind&&(g=a.expectedType);for(let y=1;y<r.length;y+=2){const x=1===y?-1/0:r[y],E=r[y+1],D=y,A=y+1;if("number"!=typeof x)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(p.length&&p[p.length-1][0]>=x)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const P=a.parse(E,A,g);if(!P)return null;g=g||P.type,p.push([x,P])}return new ul(g,u,p)}evaluate(r){const a=this.labels,u=this.outputs;if(1===a.length)return u[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return u[0].evaluate(r);const g=a.length;return p>=a[g-1]?u[g-1].evaluate(r):u[bn(a,p)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r}}var kc=ul;function zn(s,r,a){return s*(1-a)+r*a}var Pc=Object.freeze({__proto__:null,number:zn,color:function(s,r,a){return new sr(zn(s.r,r.r,a),zn(s.g,r.g,a),zn(s.b,r.b,a),zn(s.a,r.a,a))},array:function(s,r,a){return s.map((u,p)=>zn(u,r[p],a))}});const Zd=.95047,wu=1.08883,ts=4/29,ns=6/29,No=3*ns*ns,Us=Math.PI/180,xi=180/Math.PI;function dl(s){return s>.008856451679035631?Math.pow(s,1/3):s/No+ts}function hl(s){return s>ns?s*s*s:No*(s-ts)}function pl(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Wl(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function is(s){const r=Wl(s.r),a=Wl(s.g),u=Wl(s.b),p=dl((.4124564*r+.3575761*a+.1804375*u)/Zd),g=dl((.2126729*r+.7151522*a+.072175*u)/1);return{l:116*g-16,a:500*(p-g),b:200*(g-dl((.0193339*r+.119192*a+.9503041*u)/wu)),alpha:s.a}}function Zl(s){let r=(s.l+16)/116,a=isNaN(s.a)?r:r+s.a/500,u=isNaN(s.b)?r:r-s.b/200;return r=1*hl(r),a=Zd*hl(a),u=wu*hl(u),new sr(pl(3.2404542*a-1.5371385*r-.4985314*u),pl(-.969266*a+1.8760108*r+.041556*u),pl(.0556434*a-.2040259*r+1.0572252*u),s.alpha)}function lp(s,r,a){const u=r-s;return s+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const mi={forward:is,reverse:Zl,interpolate:function(s,r,a){return{l:zn(s.l,r.l,a),a:zn(s.a,r.a,a),b:zn(s.b,r.b,a),alpha:zn(s.alpha,r.alpha,a)}}},Ta={forward:function(s){const{l:r,a,b:u}=is(s),p=Math.atan2(u,a)*xi;return{h:p<0?p+360:p,c:Math.sqrt(a*a+u*u),l:r,alpha:s.a}},reverse:function(s){const r=s.h*Us,a=s.c;return Zl({l:s.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:s.alpha})},interpolate:function(s,r,a){return{h:lp(s.h,r.h,a),c:zn(s.c,r.c,a),l:zn(s.l,r.l,a),alpha:zn(s.alpha,r.alpha,a)}}};var Yd=Object.freeze({__proto__:null,lab:mi,hcl:Ta});class Rc{constructor(r,a,u,p,g){this.type=r,this.operator=a,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[y,x]of g)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(r,a,u,p){let g=0;if("exponential"===r.name)g=ii(a,r.base,u,p);else if("linear"===r.name)g=ii(a,1,u,p);else if("cubic-bezier"===r.name){const y=r.controlPoints;g=new tn(y[0],y[1],y[2],y[3]).solve(ii(a,1,u,p))}return g}static parse(r,a){let[u,p,g,...y]=r;if(!Array.isArray(p)||0===p.length)return a.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){const D=p[1];if("number"!=typeof D)return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:D}}else{if("cubic-bezier"!==p[0])return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const D=p.slice(1);if(4!==D.length||D.some(A=>"number"!=typeof A||A<0||A>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,bt),!g)return null;const x=[];let E=null;"interpolate-hcl"===u||"interpolate-lab"===u?E=es:a.expectedType&&"value"!==a.expectedType.kind&&(E=a.expectedType);for(let D=0;D<y.length;D+=2){const A=y[D],P=y[D+1],O=D+3,B=D+4;if("number"!=typeof A)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(x.length&&x[x.length-1][0]>=A)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const z=a.parse(P,B,E);if(!z)return null;E=E||z.type,x.push([A,z])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Rc(E,u,p,g,x):a.error(`Type ${bi(E)} is not interpolatable.`)}evaluate(r){const a=this.labels,u=this.outputs;if(1===a.length)return u[0].evaluate(r);const p=this.input.evaluate(r);if(p<=a[0])return u[0].evaluate(r);const g=a.length;if(p>=a[g-1])return u[g-1].evaluate(r);const y=bn(a,p),x=Rc.interpolationFactor(this.interpolation,p,a[y],a[y+1]),E=u[y].evaluate(r),D=u[y+1].evaluate(r);return"interpolate"===this.operator?Pc[this.type.kind.toLowerCase()](E,D,x):"interpolate-hcl"===this.operator?Ta.reverse(Ta.interpolate(Ta.forward(E),Ta.forward(D),x)):mi.reverse(mi.interpolate(mi.forward(E),mi.forward(D),x))}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,r,this.input.serialize()];for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function ii(s,r,a,u){const p=u-a,g=s-a;return 0===p?0:1===r?g/p:(Math.pow(r,g)-1)/(Math.pow(r,p)-1)}var js=Rc;class Fc{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let u=null;const p=a.expectedType;p&&"value"!==p.kind&&(u=p);const g=[];for(const x of r.slice(1)){const E=a.parse(x,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,g.push(E)}const y=p&&g.some(x=>Cr(p,x.type));return new Fc(y?Tn:u,g)}evaluate(r){let a,u=null,p=0;for(const g of this.args){if(p++,u=g.evaluate(r),u&&u instanceof xo&&!u.available&&(a||(a=u),u=null,p===this.args.length))return a;if(null!==u)break}return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Vt=Fc;class Ir{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const u=[];for(let g=1;g<r.length-1;g+=2){const y=r[g];if("string"!=typeof y)return a.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=a.parse(r[g+1],g+1);if(!x)return null;u.push([y,x])}const p=a.parse(r[r.length-1],r.length-1,a.expectedType,u);return p?new Ir(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[a,u]of this.bindings)r.push(a,u.serialize());return r.push(this.result.serialize()),r}}var wi=Ir;class Dr{constructor(r,a,u){this.type=r,this.index=a,this.input=u}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,bt),p=a.parse(r[2],2,or(a.expectedType||Tn));return u&&p?new Dr(p.type.itemType,u,p):null}evaluate(r){const a=this.index.evaluate(r),u=this.input.evaluate(r);if(a<0)throw new Wr(`Array index out of bounds: ${a} < 0.`);if(a>=u.length)throw new Wr(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a!==Math.floor(a))throw new Wr(`Array index must be an integer, but found ${a} instead.`);return u[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ao=Dr;class ia{constructor(r,a){this.type=Ht,this.needle=r,this.haystack=a}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Tn),p=a.parse(r[2],2,Tn);return u&&p?nt(u.type,[Ht,In,bt,qr,Tn])?new ia(u,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${bi(u.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(null==u)return!1;if(!zs(a,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${bi(Er(a))} instead.`);if(!zs(u,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${bi(Er(u))} instead.`);return u.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Eo=ia;class Yl{constructor(r,a,u){this.type=bt,this.needle=r,this.haystack=a,this.fromIndex=u}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Tn),p=a.parse(r[2],2,Tn);if(!u||!p)return null;if(!nt(u.type,[Ht,In,bt,qr,Tn]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${bi(u.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,bt);return g?new Yl(u,p,g):null}return new Yl(u,p)}evaluate(r){const a=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!zs(a,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${bi(Er(a))} instead.`);if(!zs(u,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${bi(Er(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(r);return u.indexOf(a,p)}return u.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var rd=Yl;class fl{constructor(r,a,u,p,g,y){this.inputType=r,this.type=a,this.input=u,this.cases=p,this.outputs=g,this.otherwise=y}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let u,p;a.expectedType&&"value"!==a.expectedType.kind&&(p=a.expectedType);const g={},y=[];for(let D=2;D<r.length-1;D+=2){let A=r[D];const P=r[D+1];Array.isArray(A)||(A=[A]);const O=a.concat(D);if(0===A.length)return O.error("Expected at least one branch label.");for(const z of A){if("number"!=typeof z&&"string"!=typeof z)return O.error("Branch labels must be numbers or strings.");if("number"==typeof z&&Math.abs(z)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof z&&Math.floor(z)!==z)return O.error("Numeric branch labels must be integer values.");if(u){if(O.checkSubtype(u,Er(z)))return null}else u=Er(z);if(void 0!==g[String(z)])return O.error("Branch labels must be unique.");g[String(z)]=y.length}const B=a.parse(P,D,p);if(!B)return null;p=p||B.type,y.push(B)}const x=a.parse(r[1],1,Tn);if(!x)return null;const E=a.parse(r[r.length-1],r.length-1,p);return E?"value"!==x.type.kind&&a.concat(1).checkSubtype(u,x.type)?null:new fl(u,p,x,g,y,E):null}evaluate(r){const a=this.input.evaluate(r);return(Er(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],p={};for(const y of a){const x=p[this.cases[y]];void 0===x?(p[this.cases[y]]=u.length,u.push([this.cases[y],[y]])):u[x][1].push(y)}const g=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,x]of u)r.push(1===x.length?g(x[0]):x.map(g)),r.push(this.outputs[y].serialize());return r.push(this.otherwise.serialize()),r}}var Cs=fl;class jt{constructor(r,a,u){this.type=r,this.branches=a,this.otherwise=u}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&"value"!==a.expectedType.kind&&(u=a.expectedType);const p=[];for(let y=1;y<r.length-1;y+=2){const x=a.parse(r[y],y,Ht);if(!x)return null;const E=a.parse(r[y+1],y+1,u);if(!E)return null;p.push([x,E]),u=u||E.type}const g=a.parse(r[r.length-1],r.length-1,u);return g?new jt(u,p,g):null}evaluate(r){for(const[a,u]of this.branches)if(a.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,u]of this.branches)r(a),r(u);r(this.otherwise)}outputDefined(){return this.branches.every(([r,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Un=jt;class Li{constructor(r,a,u,p){this.type=r,this.input=a,this.beginIndex=u,this.endIndex=p}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=a.parse(r[1],1,Tn),p=a.parse(r[2],2,bt);if(!u||!p)return null;if(!nt(u.type,[or(Tn),In,Tn]))return a.error(`Expected first argument to be of type array or string, but found ${bi(u.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,bt);return g?new Li(u.type,u,p,g):null}return new Li(u.type,u,p)}evaluate(r){const a=this.input.evaluate(r),u=this.beginIndex.evaluate(r);if(!zs(a,["string","array"]))throw new Wr(`Expected first argument to be of type array or string, but found ${bi(Er(a))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(r);return a.slice(u,p)}return a.slice(u)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var rs=Li;function $s(s,r){return"=="===s||"!="===s?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function Or(s,r,a,u){return 0===u.compare(r,a)}function Es(s,r,a){const u="=="!==s&&"!="!==s;return class mR{constructor(g,y,x){this.type=Ht,this.lhs=g,this.rhs=y,this.collator=x,this.hasUntypedArgument="value"===g.type.kind||"value"===y.type.kind}static parse(g,y){if(3!==g.length&&4!==g.length)return y.error("Expected two or three arguments.");const x=g[0];let E=y.parse(g[1],1,Tn);if(!E)return null;if(!$s(x,E.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${bi(E.type)}'.`);let D=y.parse(g[2],2,Tn);if(!D)return null;if(!$s(x,D.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${bi(D.type)}'.`);if(E.type.kind!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return y.error(`Cannot compare types '${bi(E.type)}' and '${bi(D.type)}'.`);u&&("value"===E.type.kind&&"value"!==D.type.kind?E=new Ea(D.type,[E]):"value"!==E.type.kind&&"value"===D.type.kind&&(D=new Ea(E.type,[D])));let A=null;if(4===g.length){if("string"!==E.type.kind&&"string"!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return y.error("Cannot use collator to compare non-string types.");if(A=y.parse(g[3],3,Nl),!A)return null}return new mR(E,D,A)}evaluate(g){const y=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const E=Er(y),D=Er(x);if(E.kind!==D.kind||"string"!==E.kind&&"number"!==E.kind)throw new Wr(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${E.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=Er(y),D=Er(x);if("string"!==E.kind||"string"!==D.kind)return r(g,y,x)}return this.collator?a(g,y,x,this.collator.evaluate(g)):r(g,y,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[s];return this.eachChild(y=>{g.push(y.serialize())}),g}}}const ur=Es("==",function(s,r,a){return r===a},Or),Oc=Es("!=",function(s,r,a){return r!==a},function(s,r,a,u){return!Or(0,r,a,u)}),Lc=Es("<",function(s,r,a){return r<a},function(s,r,a,u){return u.compare(r,a)<0}),jn=Es(">",function(s,r,a){return r>a},function(s,r,a,u){return u.compare(r,a)>0}),Nc=Es("<=",function(s,r,a){return r<=a},function(s,r,a,u){return u.compare(r,a)<=0}),Bc=Es(">=",function(s,r,a){return r>=a},function(s,r,a,u){return u.compare(r,a)>=0});class Cu{constructor(r,a,u,p,g,y){this.type=In,this.number=r,this.locale=a,this.currency=u,this.unit=p,this.minFractionDigits=g,this.maxFractionDigits=y}static parse(r,a){if(3!==r.length)return a.error("Expected two arguments.");const u=a.parse(r[1],1,bt);if(!u)return null;const p=r[2];if("object"!=typeof p||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let g=null;if(p.locale&&(g=a.parse(p.locale,1,In),!g))return null;let y=null;if(p.currency&&(y=a.parse(p.currency,1,In),!y))return null;let x=null;if(p.unit&&(x=a.parse(p.unit,1,In),!x))return null;let E=null;if(p["min-fraction-digits"]&&(E=a.parse(p["min-fraction-digits"],1,bt),!E))return null;let D=null;return p["max-fraction-digits"]&&(D=a.parse(p["max-fraction-digits"],1,bt),!D)?null:new Cu(u,g,y,x,E,D)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class Do{constructor(r){this.type=bt,this.input=r}static parse(r,a){if(2!==r.length)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const u=a.parse(r[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?a.error(`Expected argument of type string or array, but found ${bi(u.type)} instead.`):new Do(u):null}evaluate(r){const a=this.input.evaluate(r);if("string"==typeof a||Array.isArray(a))return a.length;throw new Wr(`Expected value to be of type string or array, but found ${bi(Er(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(a=>{r.push(a.serialize())}),r}}const kr={"==":ur,"!=":Oc,">":jn,"<":Lc,">=":Bc,"<=":Nc,array:Ea,at:ao,boolean:Ea,case:Un,coalesce:Vt,collator:Tc,format:bu,image:ll,in:Eo,"index-of":rd,interpolate:js,"interpolate-hcl":js,"interpolate-lab":js,length:Do,let:wi,literal:Vl,match:Cs,number:Ea,"number-format":Cu,object:Ea,slice:rs,step:kc,string:Ea,"to-boolean":qn,"to-color":qn,"to-number":qn,"to-string":qn,var:Lo,within:id};function Xl(s,[r,a,u,p]){r=r.evaluate(s),a=a.evaluate(s),u=u.evaluate(s);const g=p?p.evaluate(s):1,y=ap(r,a,u,g);if(y)throw new Wr(y);return new sr(r/255*g,a/255*g,u/255*g,g)}function Aa(s,r){return s in r}function os(s,r){const a=r[s];return void 0===a?null:a}function ss(s){return{type:s}}Ma.register(kr,{error:[{kind:"error"},[In],(s,[r])=>{throw new Wr(r.evaluate(s))}],typeof:[In,[Tn],(s,[r])=>bi(Er(r.evaluate(s)))],"to-rgba":[or(bt,4),[es],(s,[r])=>r.evaluate(s).toArray()],rgb:[es,[bt,bt,bt],Xl],rgba:[es,[bt,bt,bt,bt],Xl],has:{type:Ht,overloads:[[[In],(s,[r])=>Aa(r.evaluate(s),s.properties())],[[In,vi],(s,[r,a])=>Aa(r.evaluate(s),a.evaluate(s))]]},get:{type:Tn,overloads:[[[In],(s,[r])=>os(r.evaluate(s),s.properties())],[[In,vi],(s,[r,a])=>os(r.evaluate(s),a.evaluate(s))]]},"feature-state":[Tn,[In],(s,[r])=>os(r.evaluate(s),s.featureState||{})],properties:[vi,[],s=>s.properties()],"geometry-type":[In,[],s=>s.geometryType()],id:[Tn,[],s=>s.id()],zoom:[bt,[],s=>s.globals.zoom],pitch:[bt,[],s=>s.globals.pitch||0],"distance-from-center":[bt,[],s=>s.distanceFromCenter()],"heatmap-density":[bt,[],s=>s.globals.heatmapDensity||0],"line-progress":[bt,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[bt,[],s=>s.globals.skyRadialProgress||0],accumulated:[Tn,[],s=>void 0===s.globals.accumulated?null:s.globals.accumulated],"+":[bt,ss(bt),(s,r)=>{let a=0;for(const u of r)a+=u.evaluate(s);return a}],"*":[bt,ss(bt),(s,r)=>{let a=1;for(const u of r)a*=u.evaluate(s);return a}],"-":{type:bt,overloads:[[[bt,bt],(s,[r,a])=>r.evaluate(s)-a.evaluate(s)],[[bt],(s,[r])=>-r.evaluate(s)]]},"/":[bt,[bt,bt],(s,[r,a])=>r.evaluate(s)/a.evaluate(s)],"%":[bt,[bt,bt],(s,[r,a])=>r.evaluate(s)%a.evaluate(s)],ln2:[bt,[],()=>Math.LN2],pi:[bt,[],()=>Math.PI],e:[bt,[],()=>Math.E],"^":[bt,[bt,bt],(s,[r,a])=>Math.pow(r.evaluate(s),a.evaluate(s))],sqrt:[bt,[bt],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[bt,[bt],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[bt,[bt],(s,[r])=>Math.log(r.evaluate(s))],log2:[bt,[bt],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[bt,[bt],(s,[r])=>Math.sin(r.evaluate(s))],cos:[bt,[bt],(s,[r])=>Math.cos(r.evaluate(s))],tan:[bt,[bt],(s,[r])=>Math.tan(r.evaluate(s))],asin:[bt,[bt],(s,[r])=>Math.asin(r.evaluate(s))],acos:[bt,[bt],(s,[r])=>Math.acos(r.evaluate(s))],atan:[bt,[bt],(s,[r])=>Math.atan(r.evaluate(s))],min:[bt,ss(bt),(s,r)=>Math.min(...r.map(a=>a.evaluate(s)))],max:[bt,ss(bt),(s,r)=>Math.max(...r.map(a=>a.evaluate(s)))],abs:[bt,[bt],(s,[r])=>Math.abs(r.evaluate(s))],round:[bt,[bt],(s,[r])=>{const a=r.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[bt,[bt],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[bt,[bt],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Ht,[In,Tn],(s,[r,a])=>s.properties()[r.value]===a.value],"filter-id-==":[Ht,[Tn],(s,[r])=>s.id()===r.value],"filter-type-==":[Ht,[In],(s,[r])=>s.geometryType()===r.value],"filter-<":[Ht,[In,Tn],(s,[r,a])=>{const u=s.properties()[r.value],p=a.value;return typeof u==typeof p&&u<p}],"filter-id-<":[Ht,[Tn],(s,[r])=>{const a=s.id(),u=r.value;return typeof a==typeof u&&a<u}],"filter->":[Ht,[In,Tn],(s,[r,a])=>{const u=s.properties()[r.value],p=a.value;return typeof u==typeof p&&u>p}],"filter-id->":[Ht,[Tn],(s,[r])=>{const a=s.id(),u=r.value;return typeof a==typeof u&&a>u}],"filter-<=":[Ht,[In,Tn],(s,[r,a])=>{const u=s.properties()[r.value],p=a.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[Ht,[Tn],(s,[r])=>{const a=s.id(),u=r.value;return typeof a==typeof u&&a<=u}],"filter->=":[Ht,[In,Tn],(s,[r,a])=>{const u=s.properties()[r.value],p=a.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[Ht,[Tn],(s,[r])=>{const a=s.id(),u=r.value;return typeof a==typeof u&&a>=u}],"filter-has":[Ht,[Tn],(s,[r])=>r.value in s.properties()],"filter-has-id":[Ht,[],s=>null!==s.id()&&void 0!==s.id()],"filter-type-in":[Ht,[or(In)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Ht,[or(Tn)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Ht,[In,or(Tn)],(s,[r,a])=>a.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Ht,[In,or(Tn)],(s,[r,a])=>function(u,p,g,y){for(;g<=y;){const x=g+y>>1;if(p[x]===u)return!0;p[x]>u?y=x-1:g=x+1}return!1}(s.properties()[r.value],a.value,0,a.value.length-1)],all:{type:Ht,overloads:[[[Ht,Ht],(s,[r,a])=>r.evaluate(s)&&a.evaluate(s)],[ss(Ht),(s,r)=>{for(const a of r)if(!a.evaluate(s))return!1;return!0}]]},any:{type:Ht,overloads:[[[Ht,Ht],(s,[r,a])=>r.evaluate(s)||a.evaluate(s)],[ss(Ht),(s,r)=>{for(const a of r)if(a.evaluate(s))return!0;return!1}]]},"!":[Ht,[Ht],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Ht,[In],(s,[r])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(r.evaluate(s))}],upcase:[In,[In],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[In,[In],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[In,ss(Tn),(s,r)=>r.map(a=>Sc(a.evaluate(s))).join("")],"resolved-locale":[In,[Nl],(s,[r])=>r.evaluate(s).resolvedLocale()]});var ml=kr;function Ai(s){return{result:"success",value:s}}function zc(s){return{result:"error",value:s}}function Ia(s){return"data-driven"===s["property-type"]}function Hs(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Zr(s){return!!s.expression&&s.expression.interpolated}function Cn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":null===s?"null":typeof s}function ra(s){return"object"==typeof s&&null!==s&&!Array.isArray(s)}function lo(s){return s}function Xd(s,r){const a="color"===r.type,u=s.stops&&"object"==typeof s.stops[0][0],p=u||!(u||void 0!==s.property),g=s.type||(Zr(r)?"exponential":"interval");if(a&&((s=ea({},s)).stops&&(s.stops=s.stops.map(D=>[D[0],sr.parse(D[1])])),s.default=sr.parse(s.default?s.default:r.default)),s.colorSpace&&"rgb"!==s.colorSpace&&!Yd[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let y,x,E;if("exponential"===g)y=ka;else if("interval"===g)y=Eu;else if("categorical"===g){y=Bo,x=Object.create(null);for(const D of s.stops)x[D[0]]=D[1];E=typeof s.stops[0][0]}else{if("identity"!==g)throw new Error(`Unknown function type "${g}"`);y=Pa}if(u){const D={},A=[];for(let B=0;B<s.stops.length;B++){const z=s.stops[B],$=z[0].zoom;void 0===D[$]&&(D[$]={zoom:$,type:s.type,property:s.property,default:s.default,stops:[]},A.push($)),D[$].stops.push([z[0].value,z[1]])}const P=[];for(const B of A)P.push([D[B].zoom,Xd(D[B],r)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:js.interpolationFactor.bind(void 0,O),zoomStops:P.map(B=>B[0]),evaluate:({zoom:B},z)=>ka({stops:P,base:s.base},r,B).evaluate(B,z)}}if(p){const D="exponential"===g?{name:"exponential",base:void 0!==s.base?s.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:js.interpolationFactor.bind(void 0,D),zoomStops:s.stops.map(A=>A[0]),evaluate:({zoom:A})=>y(s,r,A,x,E)}}return{kind:"source",evaluate(D,A){const P=A&&A.properties?A.properties[s.property]:void 0;return void 0===P?Lr(s.default,r.default):y(s,r,P,x,E)}}}function Lr(s,r,a){return void 0!==s?s:void 0!==r?r:void 0!==a?a:void 0}function Bo(s,r,a,u,p){return Lr(typeof a===p?u[a]:void 0,s.default,r.default)}function Eu(s,r,a){if("number"!==Cn(a))return Lr(s.default,r.default);const u=s.stops.length;if(1===u||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[u-1][0])return s.stops[u-1][1];const p=bn(s.stops.map(g=>g[0]),a);return s.stops[p][1]}function ka(s,r,a){const u=void 0!==s.base?s.base:1;if("number"!==Cn(a))return Lr(s.default,r.default);const p=s.stops.length;if(1===p||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[p-1][0])return s.stops[p-1][1];const g=bn(s.stops.map(A=>A[0]),a),y=function(A,P,O,B){const z=B-O,$=A-O;return 0===z?0:1===P?$/z:(Math.pow(P,$)-1)/(Math.pow(P,z)-1)}(a,u,s.stops[g][0],s.stops[g+1][0]),x=s.stops[g][1],E=s.stops[g+1][1];let D=Pc[r.type]||lo;if(s.colorSpace&&"rgb"!==s.colorSpace){const A=Yd[s.colorSpace];D=(P,O)=>A.reverse(A.interpolate(A.forward(P),A.forward(O),y))}return"function"==typeof x.evaluate?{evaluate(...A){const P=x.evaluate.apply(void 0,A),O=E.evaluate.apply(void 0,A);if(void 0!==P&&void 0!==O)return D(P,O,y)}}:D(x,E,y)}function Pa(s,r,a){return"color"===r.type?a=sr.parse(a):"formatted"===r.type?a=cr.fromString(a.toString()):"resolvedImage"===r.type?a=xo.fromString(a.toString()):Cn(a)===r.type||"enum"===r.type&&r.values[a]||(a=void 0),Lr(a,s.default,r.default)}class k{constructor(r,a){var u;this.expression=r,this._warningHistory={},this._evaluator=new jl,this._defaultValue=a?"color"===(u=a).type&&(ra(u.default)||Array.isArray(u.default))?new sr(0,0,0,0):"color"===u.type?sr.parse(u.default)||null:void 0===u.default?null:u.default:null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(r,a,u,p,g,y,x,E){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(r,a,u,p,g,y,x,E){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null;try{const D=this.expression.evaluate(this._evaluator);if(null==D||"number"==typeof D&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Wr(`Expected value to be one of ${Object.keys(this._enumValues).map(A=>JSON.stringify(A)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function F(s){return Array.isArray(s)&&s.length>0&&"string"==typeof s[0]&&s[0]in ml}function G(s,r){const a=new We(ml,[],r?function(p){const g={color:es,string:In,number:bt,enum:In,boolean:Ht,formatted:ci,resolvedImage:pn};return"array"===p.type?or(g[p.value]||Tn,p.length):g[p.type]}(r):void 0),u=a.parse(s,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return u?Ai(new k(u,r)):zc(a.errors)}class fe{constructor(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent="constant"!==r&&!ql(a.expression)}evaluateWithoutErrorHandling(r,a,u,p,g,y){return this._styleExpression.evaluateWithoutErrorHandling(r,a,u,p,g,y)}evaluate(r,a,u,p,g,y){return this._styleExpression.evaluate(r,a,u,p,g,y)}}class Xe{constructor(r,a,u,p){this.kind=r,this.zoomStops=u,this._styleExpression=a,this.isStateDependent="camera"!==r&&!ql(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,a,u,p,g,y){return this._styleExpression.evaluateWithoutErrorHandling(r,a,u,p,g,y)}evaluate(r,a,u,p,g,y){return this._styleExpression.evaluate(r,a,u,p,g,y)}interpolationFactor(r,a,u){return this.interpolationType?js.interpolationFactor(this.interpolationType,r,a,u):0}}function an(s,r){if("error"===(s=G(s,r)).result)return s;const a=s.value.expression,u=Ic(a);if(!u&&!Ia(r))return zc([new Bs("","data expressions not supported")]);const p=cl(a,["zoom","pitch","distance-from-center"]);if(!p&&!Hs(r))return zc([new Bs("","zoom expressions not supported")]);const g=Yr(a);return g||p?g instanceof Bs?zc([g]):g instanceof js&&!Zr(r)?zc([new Bs("",'"interpolate" expressions cannot be used with this property')]):Ai(g?new Xe(u?"camera":"composite",s.value,g.labels,g instanceof js?g.interpolation:void 0):new fe(u?"constant":"source",s.value)):zc([new Bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Pi{constructor(r,a){this._parameters=r,this._specification=a,ea(this,Xd(this._parameters,this._specification))}static deserialize(r){return new Pi(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Yr(s){let r=null;if(s instanceof wi)r=Yr(s.result);else if(s instanceof Vt){for(const a of s.args)if(r=Yr(a),r)break}else(s instanceof kc||s instanceof js)&&s.input instanceof Ma&&"zoom"===s.input.name&&(r=s);return r instanceof Bs||s.eachChild(a=>{const u=Yr(a);u instanceof Bs?r=u:!r&&u?r=new Bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&u&&r!==u&&(r=new Bs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}class _t{constructor(r,a,u,p){this.message=(r?`${r}: `:"")+u,p&&(this.identifier=p),null!=a&&a.__line__&&(this.line=a.__line__)}}function Xr(s){const r=s.key,a=s.value,u=s.valueSpec||{},p=s.objectElementValidators||{},g=s.style,y=s.styleSpec;let x=[];const E=Cn(a);if("object"!==E)return[new _t(r,a,`object expected, ${E} found`)];for(const D in a){const A=D.split(".")[0];let O;p[A]?O=p[A]:u[A]?O=ji:p["*"]?O=p["*"]:u["*"]&&(O=ji),O?x=x.concat(O({key:(r&&`${r}.`)+D,value:a[D],valueSpec:u[A]||u["*"],style:g,styleSpec:y,object:a,objectKey:D},a)):x.push(new _t(r,a[D],`unknown property "${D}"`))}for(const D in u)p[D]||u[D].required&&void 0===u[D].default&&void 0===a[D]&&x.push(new _t(r,a,`missing required property "${D}"`));return x}function od(s){const r=s.value,a=s.valueSpec,u=s.style,p=s.styleSpec,g=s.key,y=s.arrayElementValidator||ji;if("array"!==Cn(r))return[new _t(g,r,`array expected, ${Cn(r)} found`)];if(a.length&&r.length!==a.length)return[new _t(g,r,`array length ${a.length} expected, length ${r.length} found`)];if(a["min-length"]&&r.length<a["min-length"])return[new _t(g,r,`array length at least ${a["min-length"]} expected, length ${r.length} found`)];let x={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};p.$version<7&&(x.function=a.function),"object"===Cn(a.value)&&(x=a.value);let E=[];for(let D=0;D<r.length;D++)E=E.concat(y({array:r,arrayIndex:D,value:r[D],valueSpec:x,style:u,styleSpec:p,key:`${g}[${D}]`}));return E}function Ef(s){const r=s.key,a=s.value,u=s.valueSpec;let p=Cn(a);if("number"===p&&a!=a&&(p="NaN"),"number"!==p)return[new _t(r,a,`number expected, ${p} found`)];if("minimum"in u){let g=u.minimum;if("array"===Cn(u.minimum)&&(g=u.minimum[s.arrayIndex]),a<g)return[new _t(r,a,`${a} is less than the minimum value ${g}`)]}if("maximum"in u){let g=u.maximum;if("array"===Cn(u.maximum)&&(g=u.maximum[s.arrayIndex]),a>g)return[new _t(r,a,`${a} is greater than the maximum value ${g}`)]}return[]}function Kd(s){const r=s.valueSpec,a=rr(s.value.type);let u,p,g,y={};const x="categorical"!==a&&void 0===s.value.property,E=!x,D="array"===Cn(s.value.stops)&&"array"===Cn(s.value.stops[0])&&"object"===Cn(s.value.stops[0][0]),A=Xr({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(B){if("identity"===a)return[new _t(B.key,B.value,'identity function may not have a "stops" property')];let z=[];const $=B.value;return z=z.concat(od({key:B.key,value:$,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:P})),"array"===Cn($)&&0===$.length&&z.push(new _t(B.key,$,"array must have at least one stop")),z},default:function(B){return ji({key:B.key,value:B.value,valueSpec:r,style:B.style,styleSpec:B.styleSpec})}}});return"identity"===a&&x&&A.push(new _t(s.key,s.value,'missing required property "property"')),"identity"===a||s.value.stops||A.push(new _t(s.key,s.value,'missing required property "stops"')),"exponential"===a&&s.valueSpec.expression&&!Zr(s.valueSpec)&&A.push(new _t(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(E&&!Ia(s.valueSpec)?A.push(new _t(s.key,s.value,"property functions not supported")):x&&!Hs(s.valueSpec)&&A.push(new _t(s.key,s.value,"zoom functions not supported"))),"categorical"!==a&&!D||void 0!==s.value.property||A.push(new _t(s.key,s.value,'"property" property is required')),A;function P(B){let z=[];const $=B.value,Z=B.key;if("array"!==Cn($))return[new _t(Z,$,`array expected, ${Cn($)} found`)];if(2!==$.length)return[new _t(Z,$,`array length 2 expected, length ${$.length} found`)];if(D){if("object"!==Cn($[0]))return[new _t(Z,$,`object expected, ${Cn($[0])} found`)];if(void 0===$[0].zoom)return[new _t(Z,$,"object stop key must have zoom")];if(void 0===$[0].value)return[new _t(Z,$,"object stop key must have value")];const ie=rr($[0].zoom);if("number"!=typeof ie)return[new _t(Z,$[0].zoom,"stop zoom values must be numbers")];if(g&&g>ie)return[new _t(Z,$[0].zoom,"stop zoom values must appear in ascending order")];ie!==g&&(g=ie,p=void 0,y={}),z=z.concat(Xr({key:`${Z}[0]`,value:$[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Ef,value:O}}))}else z=z.concat(O({key:`${Z}[0]`,value:$[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},$));return F(Ca($[1]))?z.concat([new _t(`${Z}[1]`,$[1],"expressions are not allowed in function stops.")]):z.concat(ji({key:`${Z}[1]`,value:$[1],valueSpec:r,style:B.style,styleSpec:B.styleSpec}))}function O(B,z){const $=Cn(B.value),Z=rr(B.value),ie=null!==B.value?B.value:z;if(u){if($!==u)return[new _t(B.key,ie,`${$} stop domain type must match previous stop domain type ${u}`)]}else u=$;if("number"!==$&&"string"!==$&&"boolean"!==$&&"number"!=typeof Z&&"string"!=typeof Z&&"boolean"!=typeof Z)return[new _t(B.key,ie,"stop domain value must be a number, string, or boolean")];if("number"!==$&&"categorical"!==a){let he=`number expected, ${$} found`;return Ia(r)&&void 0===a&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new _t(B.key,ie,he)]}return"categorical"!==a||"number"!==$||"number"==typeof Z&&isFinite(Z)&&Math.floor(Z)===Z?"categorical"!==a&&"number"===$&&"number"==typeof Z&&"number"==typeof p&&void 0!==p&&Z<p?[new _t(B.key,ie,"stop domain values must appear in ascending order")]:(p=Z,"categorical"===a&&Z in y?[new _t(B.key,ie,"stop domain values must be unique")]:(y[Z]=!0,[])):[new _t(B.key,ie,`integer expected, found ${String(Z)}`)]}}function sd(s){const r=("property"===s.expressionContext?an:G)(Ca(s.value),s.valueSpec);if("error"===r.result)return r.value.map(u=>new _t(`${s.key}${u.key}`,s.value,u.message));const a=r.value.expression||r.value._styleExpression.expression;if("property"===s.expressionContext&&"text-font"===s.propertyKey&&!a.outputDefined())return[new _t(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===s.expressionContext&&"layout"===s.propertyType&&!ql(a))return[new _t(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===s.expressionContext)return dg(a,s);if(s.expressionContext&&0===s.expressionContext.indexOf("cluster")){if(!cl(a,["zoom","feature-state"]))return[new _t(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===s.expressionContext&&!Ic(a))return[new _t(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dg(s,r){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const p of r.valueSpec.expression.parameters)a.delete(p);if(0===a.size)return[];const u=[];return s instanceof Ma&&a.has(s.name)?[new _t(r.key,r.value,`["${s.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(s.eachChild(p=>{u.push(...dg(p,r))}),u)}function cp(s){const r=s.key,a=s.value,u=s.valueSpec,p=[];return Array.isArray(u.values)?-1===u.values.indexOf(rr(a))&&p.push(new _t(r,a,`expected one of [${u.values.join(", ")}], ${JSON.stringify(a)} found`)):-1===Object.keys(u.values).indexOf(rr(a))&&p.push(new _t(r,a,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Df(s){if(!0===s||!1===s)return!0;if(!Array.isArray(s)||0===s.length)return!1;switch(s[0]){case"has":return s.length>=2&&"$id"!==s[1]&&"$type"!==s[1];case"in":return s.length>=3&&("string"!=typeof s[1]||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==s.length||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!Df(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}function ad(s,r="fill"){if(null==s)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Df(s)||(s=tr(s));const a=s;let u=!0;try{u=function(D){if(!co(D))return D;let A=Ca(D);return Qd(A),A=Du(A),A}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(a,null,2)}\n        `)}const p=qe[`filter_${r}`],g=G(u,p);let y=null;if("error"===g.result)throw new Error(g.value.map(D=>`${D.key}: ${D.message}`).join(", "));y=(D,A,P)=>g.value.evaluate(D,A,{},P);let x=null,E=null;if(u!==a){const D=G(a,p);if("error"===D.result)throw new Error(D.value.map(A=>`${A.key}: ${A.message}`).join(", "));x=(A,P,O,B,z)=>D.value.evaluate(A,P,{},O,void 0,void 0,B,z),E=!Ic(D.value.expression)}return{filter:y,dynamicFilter:x||void 0,needGeometry:Mf(u),needFeature:!!E}}function Du(s){if(!Array.isArray(s))return s;const r=function(a){if(up.has(a[0]))for(let u=1;u<a.length;u++)if(co(a[u]))return!0;return a}(s);return!0===r?r:r.map(a=>Du(a))}function Qd(s){let r=!1;const a=[];if("case"===s[0]){for(let u=1;u<s.length-1;u+=2)r=r||co(s[u]),a.push(s[u+1]);a.push(s[s.length-1])}else if("match"===s[0]){r=r||co(s[1]);for(let u=2;u<s.length-1;u+=2)a.push(s[u+1]);a.push(s[s.length-1])}else if("step"===s[0]){r=r||co(s[1]);for(let u=1;u<s.length-1;u+=2)a.push(s[u+1])}r&&(s.length=0,s.push("any",...a));for(let u=1;u<s.length;u++)Qd(s[u])}function co(s){if(!Array.isArray(s))return!1;if("pitch"===(r=s[0])||"distance-from-center"===r)return!0;var r;for(let a=1;a<s.length;a++)if(co(s[a]))return!0;return!1}const up=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Vc(s,r){return s<r?-1:s>r?1:0}function Mf(s){if(!Array.isArray(s))return!1;if("within"===s[0])return!0;for(let r=1;r<s.length;r++)if(Mf(s[r]))return!0;return!1}function tr(s){if(!s)return!0;const r=s[0];return s.length<=1?"any"!==r:"=="===r?Jd(s[1],s[2],"=="):"!="===r?Uc(Jd(s[1],s[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Jd(s[1],s[2],r):"any"===r?(a=s.slice(1),["any"].concat(a.map(tr))):"all"===r?["all"].concat(s.slice(1).map(tr)):"none"===r?["all"].concat(s.slice(1).map(tr).map(Uc)):"in"===r?eh(s[1],s.slice(2)):"!in"===r?Uc(eh(s[1],s.slice(2))):"has"===r?Sf(s[1]):"!has"===r?Uc(Sf(s[1])):"within"!==r||s;var a}function Jd(s,r,a){switch(s){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,s,r]}}function eh(s,r){if(0===r.length)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(a=>typeof a!=typeof r[0])?["filter-in-large",s,["literal",r.sort(Vc)]]:["filter-in-small",s,["literal",r]]}}function Sf(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Uc(s){return["!",s]}function th(s){return Df(Ca(s.value))?sd(ea({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):Tf(s)}function Tf(s){const r=s.value,a=s.key;if("array"!==Cn(r))return[new _t(a,r,`array expected, ${Cn(r)} found`)];const u=s.styleSpec;let p,g=[];if(r.length<1)return[new _t(a,r,"filter array must have at least 1 element")];switch(g=g.concat(cp({key:`${a}[0]`,value:r[0],valueSpec:u.filter_operator,style:s.style,styleSpec:s.styleSpec})),rr(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===rr(r[1])&&g.push(new _t(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&g.push(new _t(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=Cn(r[1]),"string"!==p&&g.push(new _t(`${a}[1]`,r[1],`string expected, ${p} found`)));for(let y=2;y<r.length;y++)p=Cn(r[y]),"$type"===rr(r[1])?g=g.concat(cp({key:`${a}[${y}]`,value:r[y],valueSpec:u.geometry_type,style:s.style,styleSpec:s.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&g.push(new _t(`${a}[${y}]`,r[y],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let y=1;y<r.length;y++)g=g.concat(Tf({key:`${a}[${y}]`,value:r[y],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Cn(r[1]),2!==r.length?g.push(new _t(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==p&&g.push(new _t(`${a}[1]`,r[1],`string expected, ${p} found`));break;case"within":p=Cn(r[1]),2!==r.length?g.push(new _t(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==p&&g.push(new _t(`${a}[1]`,r[1],`object expected, ${p} found`))}return g}function Mu(s,r){const a=s.key,u=s.style,p=s.styleSpec,g=s.value,y=s.objectKey,x=p[`${r}_${s.layerType}`];if(!x)return[];const E=y.match(/^(.*)-transition$/);if("paint"===r&&E&&x[E[1]]&&x[E[1]].transition)return ji({key:a,value:g,valueSpec:p.transition,style:u,styleSpec:p});const D=s.valueSpec||x[y];if(!D)return[new _t(a,g,`unknown property "${y}"`)];let A;if("string"===Cn(g)&&Ia(D)&&!D.tokens&&(A=/^{([^}]+)}$/.exec(g))){const O=`\`{ "type": "identity", "property": ${A?JSON.stringify(A[1]):'"_"'} }\``;return[new _t(a,g,`"${y}" does not support interpolation syntax\nUse an identity property function instead: ${O}.`)]}const P=[];return"symbol"===s.layerType&&("text-field"===y&&u&&!u.glyphs&&P.push(new _t(a,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&ra(Ca(g))&&"identity"===rr(g.type)&&P.push(new _t(a,g,'"text-font" does not support identity functions'))),P.concat(ji({key:s.key,value:g,valueSpec:D,style:u,styleSpec:p,expressionContext:"property",propertyType:r,propertyKey:y}))}function Af(s){return Mu(s,"paint")}function as(s){return Mu(s,"layout")}function nh(s){let r=[];const a=s.value,u=s.key,p=s.style,g=s.styleSpec;a.type||a.ref||r.push(new _t(u,a,'either "type" or "ref" is required'));let y=rr(a.type);const x=rr(a.ref);if(a.id){const E=rr(a.id);for(let D=0;D<s.arrayIndex;D++){const A=p.layers[D];rr(A.id)===E&&r.push(new _t(u,a.id,`duplicate layer id "${a.id}", previously used at line ${A.id.__line__}`))}}if("ref"in a){let E;["type","source","source-layer","filter","layout"].forEach(D=>{D in a&&r.push(new _t(u,a[D],`"${D}" is prohibited for ref layers`))}),p.layers.forEach(D=>{rr(D.id)===x&&(E=D)}),E?E.ref?r.push(new _t(u,a.ref,"ref cannot reference another ref layer")):y=rr(E.type):"string"==typeof x&&r.push(new _t(u,a.ref,`ref layer "${x}" not found`))}else if("background"!==y&&"sky"!==y)if(a.source){const E=p.sources&&p.sources[a.source],D=E&&rr(E.type);E?"vector"===D&&"raster"===y?r.push(new _t(u,a.source,`layer "${a.id}" requires a raster source`)):"raster"===D&&"raster"!==y?r.push(new _t(u,a.source,`layer "${a.id}" requires a vector source`)):"vector"!==D||a["source-layer"]?"raster-dem"===D&&"hillshade"!==y?r.push(new _t(u,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||"geojson"===D&&E.lineMetrics||r.push(new _t(u,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new _t(u,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new _t(u,a.source,`source "${a.source}" not found`))}else r.push(new _t(u,a,'missing required property "source"'));return r=r.concat(Xr({key:u,value:a,valueSpec:g.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ji({key:`${u}.type`,value:a.type,valueSpec:g.layer.type,style:s.style,styleSpec:s.styleSpec,object:a,objectKey:"type"}),filter:E=>th(ea({layerType:y},E)),layout:E=>Xr({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>as(ea({layerType:y},D))}}),paint:E=>Xr({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>Af(ea({layerType:y},D))}})}})),r}function jc(s){const r=s.value,a=s.key,u=Cn(r);return"string"!==u?[new _t(a,r,`string expected, ${u} found`)]:[]}const Pr={promoteId:function({key:s,value:r}){if("string"===Cn(r))return jc({key:s,value:r});{const a=[];for(const u in r)a.push(...jc({key:`${s}.${u}`,value:r[u]}));return a}}};function ld(s){const r=s.value,a=s.key,u=s.styleSpec,p=s.style;if(!r.type)return[new _t(a,r,'"type" is required')];const g=rr(r.type);let y;switch(g){case"vector":case"raster":case"raster-dem":return y=Xr({key:a,value:r,valueSpec:u[`source_${g.replace("-","_")}`],style:s.style,styleSpec:u,objectElementValidators:Pr}),y;case"geojson":if(y=Xr({key:a,value:r,valueSpec:u.source_geojson,style:p,styleSpec:u,objectElementValidators:Pr}),r.cluster)for(const x in r.clusterProperties){const[E,D]=r.clusterProperties[x],A="string"==typeof E?[E,["accumulated"],["get",x]]:E;y.push(...sd({key:`${a}.${x}.map`,value:D,expressionContext:"cluster-map"})),y.push(...sd({key:`${a}.${x}.reduce`,value:A,expressionContext:"cluster-reduce"}))}return y;case"video":return Xr({key:a,value:r,valueSpec:u.source_video,style:p,styleSpec:u});case"image":return Xr({key:a,value:r,valueSpec:u.source_image,style:p,styleSpec:u});case"canvas":return[new _t(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return cp({key:`${a}.type`,value:r.type,valueSpec:{values:cd(u)},style:p,styleSpec:u})}}function cd(s){return s.source.reduce((r,a)=>{const u=s[a];return"enum"===u.type.type&&(r=r.concat(Object.keys(u.type.values))),r},[])}function ls(s){const r=s.value,a=s.styleSpec,u=a.light,p=s.style;let g=[];const y=Cn(r);if(void 0===r)return g;if("object"!==y)return g=g.concat([new _t("light",r,`object expected, ${y} found`)]),g;for(const x in r){const E=x.match(/^(.*)-transition$/);g=g.concat(E&&u[E[1]]&&u[E[1]].transition?ji({key:x,value:r[x],valueSpec:a.transition,style:p,styleSpec:a}):u[x]?ji({key:x,value:r[x],valueSpec:u[x],style:p,styleSpec:a}):[new _t(x,r[x],`unknown property "${x}"`)])}return g}function dp(s){const r=s.value,a=s.key,u=s.style,p=s.styleSpec,g=p.terrain;let y=[];const x=Cn(r);if(void 0===r)return y;if("object"!==x)return y=y.concat([new _t("terrain",r,`object expected, ${x} found`)]),y;for(const E in r){const D=E.match(/^(.*)-transition$/);y=y.concat(D&&g[D[1]]&&g[D[1]].transition?ji({key:E,value:r[E],valueSpec:p.transition,style:u,styleSpec:p}):g[E]?ji({key:E,value:r[E],valueSpec:g[E],style:u,styleSpec:p}):[new _t(E,r[E],`unknown property "${E}"`)])}if(r.source){const E=u.sources&&u.sources[r.source],D=E&&rr(E.type);E?"raster-dem"!==D&&y.push(new _t(a,r.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):y.push(new _t(a,r.source,`source "${r.source}" not found`))}else y.push(new _t(a,r,'terrain is missing required property "source"'));return y}function hp(s){const r=s.value,a=s.style,u=s.styleSpec,p=u.fog;let g=[];const y=Cn(r);if(void 0===r)return g;if("object"!==y)return g=g.concat([new _t("fog",r,`object expected, ${y} found`)]),g;for(const x in r){const E=x.match(/^(.*)-transition$/);g=g.concat(E&&p[E[1]]&&p[E[1]].transition?ji({key:x,value:r[x],valueSpec:u.transition,style:a,styleSpec:u}):p[x]?ji({key:x,value:r[x],valueSpec:p[x],style:a,styleSpec:u}):[new _t(x,r[x],`unknown property "${x}"`)])}return g}const gl={"*":()=>[],array:od,boolean:function(s){const r=s.value,a=s.key,u=Cn(r);return"boolean"!==u?[new _t(a,r,`boolean expected, ${u} found`)]:[]},number:Ef,color:function(s){const r=s.key,a=s.value,u=Cn(a);return"string"!==u?[new _t(r,a,`color expected, ${u} found`)]:null===Sn(a)?[new _t(r,a,`color expected, "${a}" found`)]:[]},enum:cp,filter:th,function:Kd,layer:nh,object:Xr,source:ld,light:ls,terrain:dp,fog:hp,string:jc,formatted:function(s){return 0===jc(s).length?[]:sd(s)},resolvedImage:function(s){return 0===jc(s).length?[]:sd(s)},projection:function(s){const r=s.value,a=s.styleSpec,u=a.projection,p=s.style;let g=[];const y=Cn(r);if("object"===y)for(const x in r)g=g.concat(ji({key:x,value:r[x],valueSpec:u[x],style:p,styleSpec:a}));else"string"!==y&&(g=g.concat([new _t("projection",r,`object or string expected, ${y} found`)]));return g}};function ji(s){const r=s.value,a=s.valueSpec,u=s.styleSpec;return a.expression&&ra(rr(r))?Kd(s):a.expression&&F(Ca(r))?sd(s):a.type&&gl[a.type]?gl[a.type](s):Xr(ea({},s,{valueSpec:a.type?u[a.type]:a}))}function hg(s){const r=s.value,a=s.key,u=jc(s);return u.length||(-1===r.indexOf("{fontstack}")&&u.push(new _t(a,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&u.push(new _t(a,r,'"glyphs" url must include a "{range}" token'))),u}function ud(s,r=qe){return Ra(ji({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,objectElementValidators:{glyphs:hg,"*":()=>[]}}))}const pg=s=>Ra(Af(s)),_l=s=>Ra(as(s));function Ra(s){return s.slice().sort((r,a)=>r.line&&a.line?r.line-a.line:0)}function ih(s,r){let a=!1;if(r&&r.length)for(const u of r)s.fire(new Js(new Error(u.message))),a=!0;return a}var En=oa;function oa(s,r,a){var u=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var p=new Int32Array(this.arrayBuffer);s=p[0],this.d=(r=p[1])+2*(a=p[2]);for(var g=0;g<this.d*this.d;g++){var y=p[3+g],x=p[3+g+1];u.push(y===x?null:p.subarray(y,x))}var E=p[3+u.length+1];this.keys=p.subarray(p[3+u.length],E),this.bboxes=p.subarray(E),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var D=0;D<this.d*this.d;D++)u.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=s,this.padding=a,this.scale=r/s,this.uid=0;var A=a/r*s;this.min=-A,this.max=s+A}oa.prototype.insert=function(s,r,a,u,p){this._forEachCell(r,a,u,p,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p)},oa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},oa.prototype._insertCell=function(s,r,a,u,p,g){this.cells[p].push(g)},oa.prototype.query=function(s,r,a,u,p){var g=this.min,y=this.max;if(s<=g&&r<=g&&y<=a&&y<=u&&!p)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(s,r,a,u,this._queryCell,x,{},p),x},oa.prototype._queryCell=function(s,r,a,u,p,g,y,x){var E=this.cells[p];if(null!==E)for(var D=this.keys,A=this.bboxes,P=0;P<E.length;P++){var O=E[P];if(void 0===y[O]){var B=4*O;(x?x(A[B+0],A[B+1],A[B+2],A[B+3]):s<=A[B+2]&&r<=A[B+3]&&a>=A[B+0]&&u>=A[B+1])?(y[O]=!0,g.push(D[O])):y[O]=!1}}},oa.prototype._forEachCell=function(s,r,a,u,p,g,y,x){for(var E=this._convertToCellCoord(s),D=this._convertToCellCoord(r),A=this._convertToCellCoord(a),P=this._convertToCellCoord(u),O=E;O<=A;O++)for(var B=D;B<=P;B++){var z=this.d*B+O;if((!x||x(this._convertFromCellCoord(O),this._convertFromCellCoord(B),this._convertFromCellCoord(O+1),this._convertFromCellCoord(B+1)))&&p.call(this,s,r,a,u,z,g,y,x))return}},oa.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},oa.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},oa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,r=3+this.cells.length+1+1,a=0,u=0;u<this.cells.length;u++)a+=this.cells[u].length;var p=new Int32Array(r+a+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var g=r,y=0;y<s.length;y++){var x=s[y];p[3+y]=g,p.set(x,g),g+=x.length}return p[3+s.length]=g,p.set(this.keys,g),p[3+s.length+1]=g+=this.keys.length,p.set(this.bboxes,g),g+=this.bboxes.length,p.buffer};const pp={};function Ot(s,r,a={}){Object.defineProperty(s,"_classRegistryKey",{value:r,writeable:!1}),pp[r]={klass:s,omit:a.omit||[]}}Ot(Object,"Object"),En.serialize=function(s,r){const a=s.toArrayBuffer();return r&&r.push(a),{buffer:a}},En.deserialize=function(s){return new En(s.buffer)},Object.defineProperty(En,"name",{value:"Grid"}),Ot(En,"Grid"),Ot(sr,"Color"),Ot(Error,"Error"),Ot(wn,"AJAXError"),Ot(xo,"ResolvedImage"),Ot(Pi,"StylePropertyFunction"),Ot(k,"StyleExpression",{omit:["_evaluator"]}),Ot(Xe,"ZoomDependentExpression"),Ot(fe,"ZoomConstantExpression"),Ot(Ma,"CompoundExpression",{omit:["_evaluate"]});for(const s in ml)pp[ml[s]._classRegistryKey]||Ot(ml[s],`Expression${s}`);function If(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&"ArrayBuffer"===s.constructor.name)}function dd(s){return Ie.ImageBitmap&&s instanceof Ie.ImageBitmap}function Su(s,r){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(If(s)||dd(s))return r&&r.push(s),s;if(ArrayBuffer.isView(s)){const a=s;return r&&r.push(a.buffer),a}if(s instanceof Ie.ImageData)return r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const a=[];for(const u of s)a.push(Su(u,r));return a}if("object"==typeof s){const a=s.constructor,u=a._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=a.serialize?a.serialize(s,r):{};if(!a.serialize){for(const g in s)s.hasOwnProperty(g)&&(pp[u].omit.indexOf(g)>=0||(p[g]=Su(s[g],r)));s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof s)}function hd(s){if(null==s||"boolean"==typeof s||"number"==typeof s||"string"==typeof s||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||If(s)||dd(s)||ArrayBuffer.isView(s)||s instanceof Ie.ImageData)return s;if(Array.isArray(s))return s.map(hd);if("object"==typeof s){const r=s.$name||"Object",{klass:a}=pp[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(s);const u=Object.create(a.prototype);for(const p of Object.keys(s))"$name"!==p&&(u[p]=hd(s[p]));return u}throw new Error("can't deserialize object of type "+typeof s)}const pd=s=>s>=1536&&s<=1791,ft=s=>s>=1872&&s<=1919,ui=s=>s>=2208&&s<=2303,uo=s=>s>=11904&&s<=12031,Kr=s=>s>=12032&&s<=12255,Nr=s=>s>=12272&&s<=12287,Tu=s=>s>=12288&&s<=12351,Kl=s=>s>=12352&&s<=12447,zo=s=>s>=12448&&s<=12543,Au=s=>s>=12544&&s<=12591,rh=s=>s>=12704&&s<=12735,kf=s=>s>=12736&&s<=12783,Pf=s=>s>=12784&&s<=12799,fp=s=>s>=12800&&s<=13055,Mo=s=>s>=13056&&s<=13311,Fa=s=>s>=13312&&s<=19903,oh=s=>s>=19968&&s<=40959,$c=s=>s>=40960&&s<=42127,Oa=s=>s>=42128&&s<=42191,Rf=s=>s>=44032&&s<=55215,mp=s=>s>=63744&&s<=64255,sh=s=>s>=64336&&s<=65023,fd=s=>s>=65040&&s<=65055,m=s=>s>=65072&&s<=65103,l=s=>s>=65104&&s<=65135,d=s=>s>=65136&&s<=65279,_=s=>s>=65280&&s<=65519;function b(s){for(const r of s)if(T(r.charCodeAt(0)))return!0;return!1}function w(s){for(const r of s)if(!M(r.charCodeAt(0)))return!1;return!0}function M(s){return!(pd(s)||ft(s)||ui(s)||sh(s)||d(s))}function T(s){return!(746!==s&&747!==s&&(s<4352||!(rh(s)||Au(s)||m(s)&&!(s>=65097&&s<=65103)||mp(s)||Mo(s)||uo(s)||kf(s)||!(!Tu(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||12336===s)||Fa(s)||oh(s)||fp(s)||(r=s,r>=12592&&r<=12687)||(r=>r>=43360&&r<=43391)(s)||(r=>r>=55216&&r<=55295)(s)||(r=>r>=4352&&r<=4607)(s)||Rf(s)||Kl(s)||Nr(s)||(r=>r>=12688&&r<=12703)(s)||Kr(s)||Pf(s)||zo(s)&&12540!==s||!(!_(s)||65288===s||65289===s||65293===s||s>=65306&&s<=65310||65339===s||65341===s||65343===s||s>=65371&&s<=65503||65507===s||s>=65512&&s<=65519)||!(!l(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(r=>r>=5120&&r<=5759)(s)||(r=>r>=6320&&r<=6399)(s)||fd(s)||(r=>r>=19904&&r<=19967)(s)||$c(s)||Oa(s))));var r}function I(s){return!(T(s)||(r=s,(a=r)>=128&&a<=255&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||(a=>a>=8192&&a<=8303)(r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||(a=>a>=8448&&a<=8527)(r)||(a=>a>=8528&&a<=8591)(r)||(a=>a>=8960&&a<=9215)(r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||(a=>a>=9216&&a<=9279)(r)&&9251!==r||(a=>a>=9280&&a<=9311)(r)||(a=>a>=9312&&a<=9471)(r)||(a=>a>=9632&&a<=9727)(r)||(a=>a>=9728&&a<=9983)(r)&&!(r>=9754&&r<=9759)||(a=>a>=11008&&a<=11263)(r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Tu(r)||zo(r)||(a=>a>=57344&&a<=63743)(r)||m(r)||l(r)||_(r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r,a}function N(s){return s>=1424&&s<=2303||sh(s)||d(s)}function L(s,r){return!(!r&&N(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(a=s,a>=6016&&a<=6143));var a}function U(s){for(const r of s)if(N(r.charCodeAt(0)))return!0;return!1}const W="deferred",X="loading",K="loaded";let J=null,Y="unavailable",q=null;const se=function(s){s&&"string"==typeof s&&s.indexOf("NetworkError")>-1&&(Y="error"),J&&J(s)};function re(){le.fire(new Ei("pluginStateChange",{pluginStatus:Y,pluginURL:q}))}const le=new Ns,ye=function(){return Y},ge=function(){if(Y!==W||!q)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Y=X,re(),q&&sl({url:q},s=>{s?se(s):(Y=K,re())})},we={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Y===K||null!=we.applyArabicShaping,isLoading:()=>Y===X,setState(s){Y=s.pluginStatus,q=s.pluginURL},isParsed:()=>null!=we.applyArabicShaping&&null!=we.processBidirectionalText&&null!=we.processStyledBidirectionalText,getPluginURL:()=>q};class Se{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(r){return function(a,u){for(const p of a)if(!L(p.charCodeAt(0),u))return!1;return!0}(r,we.isLoaded())}}class Fe{constructor(r,a){this.property=r,this.value=a,this.expression=function(u,p){if(ra(u))return new Pi(u,p);if(F(u)){const g=an(u,p);if("error"===g.result)throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=u;return"string"==typeof u&&"color"===p.type&&(g=sr.parse(u)),{kind:"constant",evaluate:()=>g}}}(void 0===a?r.specification.default:a,r.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,a,u){return this.property.possiblyEvaluate(this,r,a,u)}}class Le{constructor(r){this.property=r,this.value=new Fe(r,void 0)}transitioned(r,a){return new ke(this.property,this.value,a,xn({},r.transition,this.transition),r.now)}untransitioned(){return new ke(this.property,this.value,null,{},0)}}class mt{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return ar(this._values[r].value.value)}setValue(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new Le(this._values[r].property)),this._values[r].value=new Fe(this._values[r].property,null===a?void 0:ar(a))}getTransition(r){return ar(this._values[r].transition)}setTransition(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new Le(this._values[r].property)),this._values[r].transition=ar(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const u=this.getValue(a);void 0!==u&&(r[a]=u);const p=this.getTransition(a);void 0!==p&&(r[`${a}-transition`]=p)}return r}transitioned(r,a){const u=new Ke(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(r,a._values[p]);return u}untransitioned(){const r=new Ke(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class ke{constructor(r,a,u,p,g){const y=p.delay||0,x=p.duration||0;g=g||0,this.property=r,this.value=a,this.begin=g+y,this.end=this.begin+x,r.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(r,a,u){const p=r.now||0,g=this.value.possiblyEvaluate(r,a,u),y=this.prior;if(y){if(p>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(p<this.begin)return y.possiblyEvaluate(r,a,u);{const x=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(r,a,u),g,Ui(x))}}return g}}class Ke{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,u){const p=new Ne(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,a,u);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class je{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return ar(this._values[r].value)}setValue(r,a){this._values[r]=new Fe(this._values[r].property,null===a?void 0:ar(a))}serialize(){const r={};for(const a of Object.keys(this._values)){const u=this.getValue(a);void 0!==u&&(r[a]=u)}return r}possiblyEvaluate(r,a,u){const p=new Ne(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,a,u);return p}}class ct{constructor(r,a,u){this.property=r,this.value=a,this.parameters=u}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,a,u,p){return this.property.evaluate(this.value,this.parameters,r,a,u,p)}}class Ne{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Me{constructor(r){this.specification=r}possiblyEvaluate(r,a){return r.expression.evaluate(a)}interpolate(r,a,u){const p=Pc[this.specification.type];return p?p(r,a,u):r}}class Ve{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,u,p){return new ct(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(a,null,{},u,p)}:r.expression,a)}interpolate(r,a,u){if("constant"!==r.value.kind||"constant"!==a.value.kind)return r;if(void 0===r.value.value||void 0===a.value.value)return new ct(this,{kind:"constant",value:void 0},r.parameters);const p=Pc[this.specification.type];return p?new ct(this,{kind:"constant",value:p(r.value.value,a.value.value,u)},r.parameters):r}evaluate(r,a,u,p,g,y){return"constant"===r.kind?r.value:r.evaluate(a,u,p,g,y)}}class st{constructor(r){this.specification=r}possiblyEvaluate(r,a,u,p){return!!r.expression.evaluate(a,null,{},u,p)}interpolate(){return!1}}class ut{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new Se(0,{});for(const u in r){const p=r[u];p.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new Fe(p,void 0),y=this.defaultTransitionablePropertyValues[u]=new Le(p);this.defaultTransitioningPropertyValues[u]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate(a)}}}function qt(s,r){return 256*(s=gn(Math.floor(s),0,255))+gn(Math.floor(r),0,255)}Ot(Ve,"DataDrivenProperty"),Ot(Me,"DataConstantProperty"),Ot(st,"ColorRampProperty");const Fn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Rt{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class At{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Wt(s,r=1){let a=0,u=0;return{members:s.map(p=>{const g=Fn[p.type].BYTES_PER_ELEMENT,y=a=kn(a,Math.max(r,g)),x=p.components||1;return u=Math.max(u,g),a+=g*x,{name:p.name,type:p.type,components:x,offset:y}}),size:kn(a,Math.max(u,r)),alignment:r}}function kn(s,r){return Math.ceil(s/r)*r}class Kt extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const p=2*r;return this.int16[p+0]=a,this.int16[p+1]=u,r}}Kt.prototype.bytesPerElement=4,Ot(Kt,"StructArrayLayout2i4");class gi extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)}emplace(r,a,u,p){const g=3*r;return this.int16[g+0]=a,this.int16[g+1]=u,this.int16[g+2]=p,r}}gi.prototype.bytesPerElement=6,Ot(gi,"StructArrayLayout3i6");class di extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p)}emplace(r,a,u,p,g){const y=4*r;return this.int16[y+0]=a,this.int16[y+1]=u,this.int16[y+2]=p,this.int16[y+3]=g,r}}di.prototype.bytesPerElement=8,Ot(di,"StructArrayLayout4i8");class $i extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,u,p,g,y,x)}emplace(r,a,u,p,g,y,x,E){const D=6*r,A=12*r,P=3*r;return this.int16[D+0]=a,this.int16[D+1]=u,this.uint8[A+4]=p,this.uint8[A+5]=g,this.uint8[A+6]=y,this.uint8[A+7]=x,this.float32[P+2]=E,r}}$i.prototype.bytesPerElement=12,Ot($i,"StructArrayLayout2i4ub1f12");class Di extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p)}emplace(r,a,u,p,g){const y=4*r;return this.float32[y+0]=a,this.float32[y+1]=u,this.float32[y+2]=p,this.float32[y+3]=g,r}}Di.prototype.bytesPerElement=16,Ot(Di,"StructArrayLayout4f16");class dr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,u,p,g)}emplace(r,a,u,p,g,y){const x=6*r,E=3*r;return this.uint16[x+0]=a,this.uint16[x+1]=u,this.uint16[x+2]=p,this.uint16[x+3]=g,this.float32[E+2]=y,r}}dr.prototype.bytesPerElement=12,Ot(dr,"StructArrayLayout4ui1f12");class ho extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p)}emplace(r,a,u,p,g){const y=4*r;return this.uint16[y+0]=a,this.uint16[y+1]=u,this.uint16[y+2]=p,this.uint16[y+3]=g,r}}ho.prototype.bytesPerElement=8,Ot(ho,"StructArrayLayout4ui8");class La extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,p,g,y)}emplace(r,a,u,p,g,y,x){const E=6*r;return this.int16[E+0]=a,this.int16[E+1]=u,this.int16[E+2]=p,this.int16[E+3]=g,this.int16[E+4]=y,this.int16[E+5]=x,r}}La.prototype.bytesPerElement=12,Ot(La,"StructArrayLayout6i12");class Na extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x,E,D,A,P,O){const B=this.length;return this.resize(B+1),this.emplace(B,r,a,u,p,g,y,x,E,D,A,P,O)}emplace(r,a,u,p,g,y,x,E,D,A,P,O,B){const z=12*r;return this.int16[z+0]=a,this.int16[z+1]=u,this.int16[z+2]=p,this.int16[z+3]=g,this.uint16[z+4]=y,this.uint16[z+5]=x,this.uint16[z+6]=E,this.uint16[z+7]=D,this.int16[z+8]=A,this.int16[z+9]=P,this.int16[z+10]=O,this.int16[z+11]=B,r}}Na.prototype.bytesPerElement=24,Ot(Na,"StructArrayLayout4i4ui4i24");class Yi extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y){const x=this.length;return this.resize(x+1),this.emplace(x,r,a,u,p,g,y)}emplace(r,a,u,p,g,y,x){const E=10*r,D=5*r;return this.int16[E+0]=a,this.int16[E+1]=u,this.int16[E+2]=p,this.float32[D+2]=g,this.float32[D+3]=y,this.float32[D+4]=x,r}}Yi.prototype.bytesPerElement=20,Ot(Yi,"StructArrayLayout3i3f20");class Ni extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}Ni.prototype.bytesPerElement=4,Ot(Ni,"StructArrayLayout1ul4");class On extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x,E,D,A,P,O,B){const z=this.length;return this.resize(z+1),this.emplace(z,r,a,u,p,g,y,x,E,D,A,P,O,B)}emplace(r,a,u,p,g,y,x,E,D,A,P,O,B,z){const $=20*r,Z=10*r;return this.int16[$+0]=a,this.int16[$+1]=u,this.int16[$+2]=p,this.int16[$+3]=g,this.int16[$+4]=y,this.float32[Z+3]=x,this.float32[Z+4]=E,this.float32[Z+5]=D,this.float32[Z+6]=A,this.int16[$+14]=P,this.uint32[Z+8]=O,this.uint16[$+18]=B,this.uint16[$+19]=z,r}}On.prototype.bytesPerElement=40,Ot(On,"StructArrayLayout5i4f1i1ul2ui40");class hr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,u,p,g,y,x)}emplace(r,a,u,p,g,y,x,E){const D=8*r;return this.int16[D+0]=a,this.int16[D+1]=u,this.int16[D+2]=p,this.int16[D+4]=g,this.int16[D+5]=y,this.int16[D+6]=x,this.int16[D+7]=E,r}}hr.prototype.bytesPerElement=16,Ot(hr,"StructArrayLayout3i2i2i16");class Br extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,u,p,g)}emplace(r,a,u,p,g,y){const x=4*r,E=8*r;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=p,this.int16[E+6]=g,this.int16[E+7]=y,r}}Br.prototype.bytesPerElement=16,Ot(Br,"StructArrayLayout2f1f2i16");class Bi extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p)}emplace(r,a,u,p,g){const y=12*r,x=3*r;return this.uint8[y+0]=a,this.uint8[y+1]=u,this.float32[x+1]=p,this.float32[x+2]=g,r}}Bi.prototype.bytesPerElement=12,Ot(Bi,"StructArrayLayout2ub2f12");class po extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)}emplace(r,a,u,p){const g=3*r;return this.float32[g+0]=a,this.float32[g+1]=u,this.float32[g+2]=p,r}}po.prototype.bytesPerElement=12,Ot(po,"StructArrayLayout3f12");class Qr extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,a,u)}emplace(r,a,u,p){const g=3*r;return this.uint16[g+0]=a,this.uint16[g+1]=u,this.uint16[g+2]=p,r}}Qr.prototype.bytesPerElement=6,Ot(Qr,"StructArrayLayout3ui6");class Ba extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e){const de=this.length;return this.resize(de+1),this.emplace(de,r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e)}emplace(r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e,de){const Oe=30*r,Pe=15*r,Ge=60*r;return this.int16[Oe+0]=a,this.int16[Oe+1]=u,this.int16[Oe+2]=p,this.float32[Pe+2]=g,this.float32[Pe+3]=y,this.uint16[Oe+8]=x,this.uint16[Oe+9]=E,this.uint32[Pe+5]=D,this.uint32[Pe+6]=A,this.uint32[Pe+7]=P,this.uint16[Oe+16]=O,this.uint16[Oe+17]=B,this.uint16[Oe+18]=z,this.float32[Pe+10]=$,this.float32[Pe+11]=Z,this.uint8[Ge+48]=ie,this.uint8[Ge+49]=he,this.uint8[Ge+50]=ne,this.uint32[Pe+13]=ce,this.int16[Oe+28]=_e,this.uint8[Ge+58]=de,r}}Ba.prototype.bytesPerElement=60,Ot(Ba,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Iu extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e,de,Oe,Pe,Ge,Ze,Be,Ye,et,at){const dt=this.length;return this.resize(dt+1),this.emplace(dt,r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e,de,Oe,Pe,Ge,Ze,Be,Ye,et,at)}emplace(r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z,ie,he,ne,ce,_e,de,Oe,Pe,Ge,Ze,Be,Ye,et,at,dt){const Ue=38*r,vt=19*r;return this.int16[Ue+0]=a,this.int16[Ue+1]=u,this.int16[Ue+2]=p,this.float32[vt+2]=g,this.float32[vt+3]=y,this.int16[Ue+8]=x,this.int16[Ue+9]=E,this.int16[Ue+10]=D,this.int16[Ue+11]=A,this.int16[Ue+12]=P,this.int16[Ue+13]=O,this.uint16[Ue+14]=B,this.uint16[Ue+15]=z,this.uint16[Ue+16]=$,this.uint16[Ue+17]=Z,this.uint16[Ue+18]=ie,this.uint16[Ue+19]=he,this.uint16[Ue+20]=ne,this.uint16[Ue+21]=ce,this.uint16[Ue+22]=_e,this.uint16[Ue+23]=de,this.uint16[Ue+24]=Oe,this.uint16[Ue+25]=Pe,this.uint16[Ue+26]=Ge,this.uint16[Ue+27]=Ze,this.uint16[Ue+28]=Be,this.uint32[vt+15]=Ye,this.float32[vt+16]=et,this.float32[vt+17]=at,this.float32[vt+18]=dt,r}}Iu.prototype.bytesPerElement=76,Ot(Iu,"StructArrayLayout3i2f6i15ui1ul3f76");class cs extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}cs.prototype.bytesPerElement=4,Ot(cs,"StructArrayLayout1f4");class Ds extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,u,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,u,p,g)}emplace(r,a,u,p,g,y){const x=5*r;return this.float32[x+0]=a,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=g,this.float32[x+4]=y,r}}Ds.prototype.bytesPerElement=20,Ot(Ds,"StructArrayLayout5f20");class za extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,u,p)}emplace(r,a,u,p,g){const y=6*r;return this.uint32[3*r+0]=a,this.uint16[y+2]=u,this.uint16[y+3]=p,this.uint16[y+4]=g,r}}za.prototype.bytesPerElement=12,Ot(za,"StructArrayLayout1ul3ui12");class yl extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const p=2*r;return this.uint16[p+0]=a,this.uint16[p+1]=u,r}}yl.prototype.bytesPerElement=4,Ot(yl,"StructArrayLayout2ui4");class Ql extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}Ql.prototype.bytesPerElement=2,Ot(Ql,"StructArrayLayout1ui2");class vl extends At{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const u=this.length;return this.resize(u+1),this.emplace(u,r,a)}emplace(r,a,u){const p=2*r;return this.float32[p+0]=a,this.float32[p+1]=u,r}}vl.prototype.bytesPerElement=8,Ot(vl,"StructArrayLayout2f8");class ku extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ku.prototype.size=40;class fg extends On{get(r){return new ku(this,r)}}Ot(fg,"CollisionBoxArray");class mg extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}mg.prototype.size=60;class gg extends Ba{get(r){return new mg(this,r)}}Ot(gg,"PlacedSymbolArray");class md extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}md.prototype.size=76;class cv extends Iu{get(r){return new md(this,r)}}Ot(cv,"SymbolInstanceArray");class Jr extends cs{getoffsetX(r){return this.float32[1*r+0]}}Ot(Jr,"GlyphOffsetArray");class Ff extends Kt{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}Ot(Ff,"SymbolLineVertexArray");class uv extends Rt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}uv.prototype.size=12;class _g extends za{get(r){return new uv(this,r)}}Ot(_g,"FeatureIndexArray");class gd extends yl{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}Ot(gd,"FillExtrusionCentroidArray");const ah=Wt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),lh=Wt([{name:"a_dash",components:4,type:"Uint16"}]);var Va={},dv={get exports(){return Va},set exports(s){Va=s}},gp={};({get exports(){return gp},set exports(s){gp=s}}).exports=function(s,r){var a,u,p,g,y,x,E,D;for(u=s.length-(a=3&s.length),p=r,y=3432918353,x=461845907,D=0;D<u;)E=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,p=27492+(65535&(g=5*(65535&(p=(p^=E=(65535&(E=(E=(65535&E)*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(E=0,a){case 3:E^=(255&s.charCodeAt(D+2))<<16;case 2:E^=(255&s.charCodeAt(D+1))<<8;case 1:p^=E=(65535&(E=(E=(65535&(E^=255&s.charCodeAt(D)))*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295}return p^=s.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Pu={};({get exports(){return Pu},set exports(s){Pu=s}}).exports=function(s,r){for(var a,u=s.length,p=r^u,g=0;u>=4;)a=1540483477*(65535&(a=255&s.charCodeAt(g)|(255&s.charCodeAt(++g))<<8|(255&s.charCodeAt(++g))<<16|(255&s.charCodeAt(++g))<<24))+((1540483477*(a>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++g;switch(u){case 3:p^=(255&s.charCodeAt(g+2))<<16;case 2:p^=(255&s.charCodeAt(g+1))<<8;case 1:p=1540483477*(65535&(p^=255&s.charCodeAt(g)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var Ux=gp,jx=Pu;dv.exports=Ux,Va.murmur3=Ux,Va.murmur2=jx;class wt{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,u,p){this.ids.push($x(r)),this.positions.push(a,u,p)}getPositions(r){const a=$x(r);let u=0,p=this.ids.length-1;for(;u<p;){const y=u+p>>1;this.ids[y]>=a?p=y:u=y+1}const g=[];for(;this.ids[u]===a;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(r,a){const u=new Float64Array(r.ids),p=new Uint32Array(r.positions);return hv(u,p,0,u.length-1),a&&a.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(r){const a=new wt;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function $x(s){const r=+s;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Va(String(s))}function hv(s,r,a,u){for(;a<u;){const p=s[a+u>>1];let g=a-1,y=u+1;for(;;){do{g++}while(s[g]<p);do{y--}while(s[y]>p);if(g>=y)break;yg(s,g,y),yg(r,3*g,3*y),yg(r,3*g+1,3*y+1),yg(r,3*g+2,3*y+2)}y-a<u-y?(hv(s,r,a,y),a=y+1):(hv(s,r,y+1,u),u=y)}}function yg(s,r,a){const u=s[r];s[r]=s[a],s[a]=u}Ot(wt,"FeaturePositionMap");class Ru{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,a),this.initialized=!0),!!this.location}}class vg extends Ru{constructor(r){super(r),this.current=0}set(r,a,u){this.fetchUniformLocation(r,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Hx extends Ru{constructor(r){super(r),this.current=[0,0,0,0]}set(r,a,u){this.fetchUniformLocation(r,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Gx extends Ru{constructor(r){super(r),this.current=sr.transparent}set(r,a,u){this.fetchUniformLocation(r,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const _p=new Float32Array(16),vD=new Float32Array(9),bD=new Float32Array(4);function zr(s){return[qt(255*s.r,255*s.g),qt(255*s.b,255*s.a)]}class _d{constructor(r,a,u){this.value=r,this.uniformNames=a.map(p=>`u_${p}`),this.type=u}setUniform(r,a,u,p,g){a.set(r,g,p.constantOr(this.value))}getBinding(r,a){return"color"===this.type?new Gx(r):new vg(r)}}class Jl{constructor(r,a){this.uniformNames=a.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,a,u,p,g){const y="u_pattern"===g||"u_dash"===g?this.pattern:"u_pixel_ratio"===g?this.pixelRatio:null;y&&a.set(r,g,y)}getBinding(r,a){return"u_pattern"===a||"u_dash"===a?new Hx(r):new vg(r)}}class Hc{constructor(r,a,u,p){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===u?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(r,a,u,p,g,y){const x=this.paintVertexArray.length,E=this.expression.evaluate(new Se(0),a,{},g,p,y);this.paintVertexArray.resize(r),this._setPaintValue(x,r,E)}updatePaintArray(r,a,u,p,g){const y=this.expression.evaluate({zoom:0},u,p,void 0,g);this._setPaintValue(r,a,y)}_setPaintValue(r,a,u){if("color"===this.type){const p=zr(u);for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,p[0],p[1])}else{for(let p=r;p<a;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Rr{constructor(r,a,u,p,g,y){this.expression=r,this.uniformNames=a.map(x=>`u_${x}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===u?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(r,a,u,p,g,y){const x=this.expression.evaluate(new Se(this.zoom),a,{},g,p,y),E=this.expression.evaluate(new Se(this.zoom+1),a,{},g,p,y),D=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(D,r,x,E)}updatePaintArray(r,a,u,p,g){const y=this.expression.evaluate({zoom:this.zoom},u,p,void 0,g),x=this.expression.evaluate({zoom:this.zoom+1},u,p,void 0,g);this._setPaintValue(r,a,y,x)}_setPaintValue(r,a,u,p){if("color"===this.type){const g=zr(u),y=zr(p);for(let x=r;x<a;x++)this.paintVertexArray.emplace(x,g[0],g[1],y[0],y[1])}else{for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a,u,p,g){const y=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,x=gn(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);a.set(r,g,x)}getBinding(r,a){return new vg(r)}}class Gs{constructor(r,a,u,p,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=("array"===u?lh:ah).members;for(let y=0;y<a.length;++y);this.paintVertexArray=new p}populatePaintArray(r,a,u){const p=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(p,r,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(r,a,u,p,g,y){this._setPaintValues(r,a,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(r,a,u,p){if(!p||!u)return;const g=p[u];if(!g)return;const{tl:y,br:x,pixelRatio:E}=g;for(let D=r;D<a;D++)this.paintVertexArray.emplace(D,y[0],y[1],x[0],x[1],E)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gc{constructor(r,a,u=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const g in r.paint._values){if(!u(g))continue;const y=r.paint.get(g);if(!(y instanceof ct&&Ia(y.property.specification)))continue;const x=qx(g,r.type),E=y.value,D=y.property.specification.type,A=!!y.property.useIntegerZoom,P="line-dasharray"===g||g.endsWith("pattern"),O="line-dasharray"===g&&"constant"!==r.layout.get("line-cap").value.kind;if("constant"!==E.kind||O)if("source"===E.kind||O||P){const B=Zx(g,D,"source");this.binders[g]=P?new Gs(E,x,D,B,r.id):new Hc(E,x,D,B),p.push(`/a_${g}`)}else{const B=Zx(g,D,"composite");this.binders[g]=new Rr(E,x,D,A,a,B),p.push(`/z_${g}`)}else this.binders[g]=P?new Jl(E.value,x):new _d(E.value,x,D),p.push(`/u_${g}`)}this.cacheKey=p.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof Hc||a instanceof Rr?a.maxValue:0}populatePaintArrays(r,a,u,p,g,y){for(const x in this.binders){const E=this.binders[x];(E instanceof Hc||E instanceof Rr||E instanceof Gs)&&E.populatePaintArray(r,a,u,p,g,y)}}setConstantPatternPositions(r){for(const a in this.binders){const u=this.binders[a];u instanceof Jl&&u.setConstantPatternPositions(r)}}updatePaintArrays(r,a,u,p,g,y){let x=!1;for(const E in r){const D=a.getPositions(E);for(const A of D){const P=u.feature(A.index);for(const O in this.binders){const B=this.binders[O];if((B instanceof Hc||B instanceof Rr||B instanceof Gs)&&!0===B.expression.isStateDependent){const z=p.paint.get(O);B.expression=z.value,B.updatePaintArray(A.start,A.end,P,r[E],g,y),x=!0}}}}return x}defines(){const r=[];for(const a in this.binders){const u=this.binders[a];(u instanceof _d||u instanceof Jl)&&r.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Hc||u instanceof Rr||u instanceof Gs)for(let p=0;p<u.paintVertexAttributes.length;p++)r.push(u.paintVertexAttributes[p].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof _d||u instanceof Jl||u instanceof Rr)for(const p of u.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof _d||p instanceof Jl||p instanceof Rr)for(const g of p.uniformNames)a.push({name:g,property:u,binding:p.getBinding(r,g)})}return a}setUniforms(r,a,u,p,g){for(const{name:y,property:x,binding:E}of u)this.binders[x].setUniform(r,E,g,p.get(x),y)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Hc||a instanceof Rr||a instanceof Gs)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(r){for(const a in this.binders){const u=this.binders[a];(u instanceof Hc||u instanceof Rr||u instanceof Gs)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof Hc||a instanceof Rr||a instanceof Gs)&&a.destroy()}}}class ec{constructor(r,a,u=(()=>!0)){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new Gc(p,a,u);this.needsUpload=!1,this._featureMap=new wt,this._bufferOffset=0}populatePaintArrays(r,a,u,p,g,y,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(r,a,p,g,y,x);void 0!==a.id&&this._featureMap.add(a.id,u,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,u,p,g){for(const y of u)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(r,this._featureMap,a,y,p,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const yp={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function qx(s,r){return yp[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}const xD={"line-pattern":{source:dr,composite:dr},"fill-pattern":{source:dr,composite:dr},"fill-extrusion-pattern":{source:dr,composite:dr},"line-dasharray":{source:ho,composite:ho}},Wx={color:{source:vl,composite:Di},number:{source:cs,composite:vl}};function Zx(s,r,a){const u=xD[s];return u&&u[a]||Wx[r][a]}Ot(_d,"ConstantBinder"),Ot(Jl,"PatternConstantBinder"),Ot(Hc,"SourceExpressionBinder"),Ot(Gs,"PatternCompositeBinder"),Ot(Rr,"CompositeExpressionBinder"),Ot(Gc,"ProgramConfiguration",{omit:["_buffers"]}),Ot(ec,"ProgramConfigurationSet");const us="-transition";class sa extends Ns{constructor(r,a){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==r.type&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&"sky"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new je(a.layout)),a.paint)){this._transitionablePaint=new mt(a.paint);for(const u in r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(const u in r.layout)this.setLayoutProperty(u,r.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ne(a.paint)}}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a,u={}){null!=a&&this._validate(_l,`layers.${this.id}.layout.${r}`,r,a,u)||("visibility"!==r?this._unevaluatedLayout.setValue(r,a):this.visibility=a)}getPaintProperty(r){return _s(r,us)?this._transitionablePaint.getTransition(r.slice(0,-us.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,u={}){if(null!=a&&this._validate(pg,`layers.${this.id}.paint.${r}`,r,a,u))return!1;if(_s(r,us))return this._transitionablePaint.setTransition(r.slice(0,-us.length),a||void 0),!1;{const p=this._transitionablePaint._values[r],g=p.value.isDataDriven(),y=p.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const x=this._transitionablePaint._values[r].value,E=x.isDataDriven(),D=_s(r,"pattern")||"line-dasharray"===r;return E||g||D||this._handleOverridablePaintPropertyUpdate(r,y,x)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,a,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Rn(r,(a,u)=>!(void 0===a||"layout"===u&&!Object.keys(a).length||"paint"===u&&!Object.keys(a).length))}_validate(r,a,u,p,g={}){return(!g||!1!==g.validate)&&ih(this,r.call(ud,{key:a,layerType:this.type,objectKey:u,value:p,styleSpec:qe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof ct&&Ia(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ad(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ch=Wt([{name:"a_pos",components:2,type:"Int16"}],4),wD=Wt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class _r{constructor(r=[]){this.segments=r}prepareSegment(r,a,u,p){let g=this.segments[this.segments.length-1];return r>_r.MAX_VERTEX_ARRAY_LENGTH&&ei(`Max vertices per segment is ${_r.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>_r.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==p)&&(g={vertexOffset:a.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},void 0!==p&&(g.sortKey=p),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,u,p){return new _r([{vertexOffset:r,primitiveOffset:a,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}_r.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ot(_r,"SegmentVector");var fn=8192;class Fu{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof si?new si(r.lng,r.lat):si.convert(r),this}setSouthWest(r){return this._sw=r instanceof si?new si(r.lng,r.lat):si.convert(r),this}extend(r){const a=this._sw,u=this._ne;let p,g;if(r instanceof si)p=r,g=r;else{if(!(r instanceof Fu))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(Fu.convert(r)):this.extend(si.convert(r)):"object"==typeof r&&null!==r&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(si.convert(r)):this;if(p=r._sw,g=r._ne,!p||!g)return this}return a||u?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new si(p.lng,p.lat),this._ne=new si(g.lng,g.lat)),this}getCenter(){return new si((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new si(this.getWest(),this.getNorth())}getSouthEast(){return new si(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:u}=si.convert(r);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(r){return!r||r instanceof Fu?r:new Fu(r)}}var Of=1e-6,qs=typeof Float32Array<"u"?Float32Array:Array;function pv(){var s=new qs(9);return qs!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function fv(s,r,a){var u=r[0],p=r[1],g=r[2],y=r[3],x=r[4],E=r[5],D=r[6],A=r[7],P=r[8],O=a[0],B=a[1],z=a[2],$=a[3],Z=a[4],ie=a[5],he=a[6],ne=a[7],ce=a[8];return s[0]=O*u+B*y+z*D,s[1]=O*p+B*x+z*A,s[2]=O*g+B*E+z*P,s[3]=$*u+Z*y+ie*D,s[4]=$*p+Z*x+ie*A,s[5]=$*g+Z*E+ie*P,s[6]=he*u+ne*y+ce*D,s[7]=he*p+ne*x+ce*A,s[8]=he*g+ne*E+ce*P,s}function aa(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function uh(s,r){var a=r[0],u=r[1],p=r[2],g=r[3],y=r[4],x=r[5],E=r[6],D=r[7],A=r[8],P=r[9],O=r[10],B=r[11],z=r[12],$=r[13],Z=r[14],ie=r[15],he=a*x-u*y,ne=a*E-p*y,ce=a*D-g*y,_e=u*E-p*x,de=u*D-g*x,Oe=p*D-g*E,Pe=A*$-P*z,Ge=A*Z-O*z,Ze=A*ie-B*z,Be=P*Z-O*$,Ye=P*ie-B*$,et=O*ie-B*Z,at=he*et-ne*Ye+ce*Be+_e*Ze-de*Ge+Oe*Pe;return at?(s[0]=(x*et-E*Ye+D*Be)*(at=1/at),s[1]=(p*Ye-u*et-g*Be)*at,s[2]=($*Oe-Z*de+ie*_e)*at,s[3]=(O*de-P*Oe-B*_e)*at,s[4]=(E*Ze-y*et-D*Ge)*at,s[5]=(a*et-p*Ze+g*Ge)*at,s[6]=(Z*ce-z*Oe-ie*ne)*at,s[7]=(A*Oe-O*ce+B*ne)*at,s[8]=(y*Ye-x*Ze+D*Pe)*at,s[9]=(u*Ze-a*Ye-g*Pe)*at,s[10]=(z*de-$*ce+ie*he)*at,s[11]=(P*ce-A*de-B*he)*at,s[12]=(x*Ge-y*Be-E*Pe)*at,s[13]=(a*Be-u*Ge+p*Pe)*at,s[14]=($*ne-z*_e-Z*he)*at,s[15]=(A*_e-P*ne+O*he)*at,s):null}function tc(s,r,a){var u=r[0],p=r[1],g=r[2],y=r[3],x=r[4],E=r[5],D=r[6],A=r[7],P=r[8],O=r[9],B=r[10],z=r[11],$=r[12],Z=r[13],ie=r[14],he=r[15],ne=a[0],ce=a[1],_e=a[2],de=a[3];return s[0]=ne*u+ce*x+_e*P+de*$,s[1]=ne*p+ce*E+_e*O+de*Z,s[2]=ne*g+ce*D+_e*B+de*ie,s[3]=ne*y+ce*A+_e*z+de*he,s[4]=(ne=a[4])*u+(ce=a[5])*x+(_e=a[6])*P+(de=a[7])*$,s[5]=ne*p+ce*E+_e*O+de*Z,s[6]=ne*g+ce*D+_e*B+de*ie,s[7]=ne*y+ce*A+_e*z+de*he,s[8]=(ne=a[8])*u+(ce=a[9])*x+(_e=a[10])*P+(de=a[11])*$,s[9]=ne*p+ce*E+_e*O+de*Z,s[10]=ne*g+ce*D+_e*B+de*ie,s[11]=ne*y+ce*A+_e*z+de*he,s[12]=(ne=a[12])*u+(ce=a[13])*x+(_e=a[14])*P+(de=a[15])*$,s[13]=ne*p+ce*E+_e*O+de*Z,s[14]=ne*g+ce*D+_e*B+de*ie,s[15]=ne*y+ce*A+_e*z+de*he,s}function ds(s,r,a){var u,p,g,y,x,E,D,A,P,O,B,z,$=a[0],Z=a[1],ie=a[2];return r===s?(s[12]=r[0]*$+r[4]*Z+r[8]*ie+r[12],s[13]=r[1]*$+r[5]*Z+r[9]*ie+r[13],s[14]=r[2]*$+r[6]*Z+r[10]*ie+r[14],s[15]=r[3]*$+r[7]*Z+r[11]*ie+r[15]):(p=r[1],g=r[2],y=r[3],x=r[4],E=r[5],D=r[6],A=r[7],P=r[8],O=r[9],B=r[10],z=r[11],s[0]=u=r[0],s[1]=p,s[2]=g,s[3]=y,s[4]=x,s[5]=E,s[6]=D,s[7]=A,s[8]=P,s[9]=O,s[10]=B,s[11]=z,s[12]=u*$+x*Z+P*ie+r[12],s[13]=p*$+E*Z+O*ie+r[13],s[14]=g*$+D*Z+B*ie+r[14],s[15]=y*$+A*Z+z*ie+r[15]),s}function Ou(s,r,a){var u=a[0],p=a[1],g=a[2];return s[0]=r[0]*u,s[1]=r[1]*u,s[2]=r[2]*u,s[3]=r[3]*u,s[4]=r[4]*p,s[5]=r[5]*p,s[6]=r[6]*p,s[7]=r[7]*p,s[8]=r[8]*g,s[9]=r[9]*g,s[10]=r[10]*g,s[11]=r[11]*g,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s}function bl(s,r,a){var u=Math.sin(a),p=Math.cos(a),g=r[4],y=r[5],x=r[6],E=r[7],D=r[8],A=r[9],P=r[10],O=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=g*p+D*u,s[5]=y*p+A*u,s[6]=x*p+P*u,s[7]=E*p+O*u,s[8]=D*p-g*u,s[9]=A*p-y*u,s[10]=P*p-x*u,s[11]=O*p-E*u,s}function Lf(s,r,a){var u=Math.sin(a),p=Math.cos(a),g=r[0],y=r[1],x=r[2],E=r[3],D=r[8],A=r[9],P=r[10],O=r[11];return r!==s&&(s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=g*p-D*u,s[1]=y*p-A*u,s[2]=x*p-P*u,s[3]=E*p-O*u,s[8]=g*u+D*p,s[9]=y*u+A*p,s[10]=x*u+P*p,s[11]=E*u+O*p,s}function bg(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function dh(s,r,a){var u,p,g,y=a[0],x=a[1],E=a[2],D=Math.hypot(y,x,E);return D<Of?null:(y*=D=1/D,x*=D,E*=D,u=Math.sin(r),p=Math.cos(r),s[0]=y*y*(g=1-p)+p,s[1]=x*y*g+E*u,s[2]=E*y*g-x*u,s[3]=0,s[4]=y*x*g-E*u,s[5]=x*x*g+p,s[6]=E*x*g+y*u,s[7]=0,s[8]=y*E*g+x*u,s[9]=x*E*g-y*u,s[10]=E*E*g+p,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var Nf=tc;function Bf(){var s=new qs(3);return qs!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function mv(s){var r=new qs(3);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r}function vp(s){return Math.hypot(s[0],s[1],s[2])}function xl(s,r,a){var u=new qs(3);return u[0]=s,u[1]=r,u[2]=a,u}function la(s,r,a){return s[0]=r[0]+a[0],s[1]=r[1]+a[1],s[2]=r[2]+a[2],s}function xg(s,r,a){return s[0]=r[0]-a[0],s[1]=r[1]-a[1],s[2]=r[2]-a[2],s}function Yx(s,r,a){return s[0]=r[0]*a[0],s[1]=r[1]*a[1],s[2]=r[2]*a[2],s}function hh(s,r,a){return s[0]=Math.min(r[0],a[0]),s[1]=Math.min(r[1],a[1]),s[2]=Math.min(r[2],a[2]),s}function bp(s,r,a){return s[0]=Math.max(r[0],a[0]),s[1]=Math.max(r[1],a[1]),s[2]=Math.max(r[2],a[2]),s}function Ua(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s}function xp(s,r,a,u){return s[0]=r[0]+a[0]*u,s[1]=r[1]+a[1]*u,s[2]=r[2]+a[2]*u,s}function hs(s,r){var a=r[0],u=r[1],p=r[2],g=a*a+u*u+p*p;return g>0&&(g=1/Math.sqrt(g)),s[0]=r[0]*g,s[1]=r[1]*g,s[2]=r[2]*g,s}function ja(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]}function ph(s,r,a){var u=r[0],p=r[1],g=r[2],y=a[0],x=a[1],E=a[2];return s[0]=p*E-g*x,s[1]=g*y-u*E,s[2]=u*x-p*y,s}function pr(s,r,a){var u=r[0],p=r[1],g=r[2],y=a[3]*u+a[7]*p+a[11]*g+a[15];return s[0]=(a[0]*u+a[4]*p+a[8]*g+a[12])/(y=y||1),s[1]=(a[1]*u+a[5]*p+a[9]*g+a[13])/y,s[2]=(a[2]*u+a[6]*p+a[10]*g+a[14])/y,s}function gv(s,r,a){var u=a[0],p=a[1],g=a[2],y=r[0],x=r[1],E=r[2],D=p*E-g*x,A=g*y-u*E,P=u*x-p*y,O=p*P-g*A,B=g*D-u*P,z=u*A-p*D,$=2*a[3];return A*=$,P*=$,B*=2,z*=2,s[0]=y+(D*=$)+(O*=2),s[1]=x+A+B,s[2]=E+P+z,s}var fh,nc=xg,_v=Yx,CD=vp;function yv(s,r,a){return s[0]=r[0]*a,s[1]=r[1]*a,s[2]=r[2]*a,s[3]=r[3]*a,s}function vv(s,r){var a=r[0],u=r[1],p=r[2],g=r[3],y=a*a+u*u+p*p+g*g;return y>0&&(y=1/Math.sqrt(y)),s[0]=a*y,s[1]=u*y,s[2]=p*y,s[3]=g*y,s}function qc(s,r,a){var u=r[0],p=r[1],g=r[2],y=r[3];return s[0]=a[0]*u+a[4]*p+a[8]*g+a[12]*y,s[1]=a[1]*u+a[5]*p+a[9]*g+a[13]*y,s[2]=a[2]*u+a[6]*p+a[10]*g+a[14]*y,s[3]=a[3]*u+a[7]*p+a[11]*g+a[15]*y,s}function Xx(){var s=new qs(4);return qs!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Kx(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function zf(s,r,a){a*=.5;var u=r[0],p=r[1],g=r[2],y=r[3],x=Math.sin(a),E=Math.cos(a);return s[0]=u*E+y*x,s[1]=p*E+g*x,s[2]=g*E-p*x,s[3]=y*E-u*x,s}function Qx(s,r,a){a*=.5;var u=r[0],p=r[1],g=r[2],y=r[3],x=Math.sin(a),E=Math.cos(a);return s[0]=u*E-g*x,s[1]=p*E+y*x,s[2]=g*E+u*x,s[3]=y*E-p*x,s}Bf(),fh=new qs(4),qs!=Float32Array&&(fh[0]=0,fh[1]=0,fh[2]=0,fh[3]=0);var ED=vv;Bf(),xl(1,0,0),xl(0,1,0),Xx(),Xx(),pv();const DD=Wt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Jx}=DD,ew=Wt([{name:"a_pos_3",components:3,type:"Int16"}]);var wp=Wt([{name:"a_pos",type:"Int16",components:2}]);class Vf{constructor(r,a){this.pos=r,this.dir=a}intersectsPlane(r,a,u){const p=ja(a,this.dir);if(Math.abs(p)<1e-6)return!1;const g=((r[0]-this.pos[0])*a[0]+(r[1]-this.pos[1])*a[1]+(r[2]-this.pos[2])*a[2])/p;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,u[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,a,u){if($=(B=this.pos)[0],Z=B[1],ie=B[2],he=(z=r)[0],ne=z[1],ce=z[2],Math.abs($-he)<=Of*Math.max(1,Math.abs($),Math.abs(he))&&Math.abs(Z-ne)<=Of*Math.max(1,Math.abs(Z),Math.abs(ne))&&Math.abs(ie-ce)<=Of*Math.max(1,Math.abs(ie),Math.abs(ce))||0===a)return u[0]=u[1]=u[2]=0,!1;var B,z,$,Z,ie,he,ne,ce;const[p,g,y]=this.dir,x=this.pos[0]-r[0],E=this.pos[1]-r[1],D=this.pos[2]-r[2],A=p*p+g*g+y*y,P=2*(x*p+E*g+D*y),O=P*P-4*A*(x*x+E*E+D*D-a*a);if(O<0){const B=Math.max(-P/2,0),z=x+p*B,$=E+g*B,Z=D+y*B,ie=Math.hypot(z,$,Z);return u[0]=z*a/ie,u[1]=$*a/ie,u[2]=Z*a/ie,!1}{const B=(-P-Math.sqrt(O))/(2*A);if(B<0){const z=Math.hypot(x,E,D);return u[0]=x*a/z,u[1]=E*a/z,u[2]=D*a/z,!1}return u[0]=x+p*B,u[1]=E+g*B,u[2]=D+y*B,!0}}}class Cp{constructor(r,a,u,p,g){this.TL=r,this.TR=a,this.BR=u,this.BL=p,this.horizon=g}static fromInvProjectionMatrix(r,a,u){const p=[-1,1,1],g=[1,1,1],y=[1,-1,1],x=[-1,-1,1],E=pr(p,p,r),D=pr(g,g,r),A=pr(y,y,r),P=pr(x,x,r);return new Cp(E,D,A,P,a/u)}}class Uf{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,u,p){const g=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const D=qc([],E,r),A=1/D[3]/a*g;return(P=D)[0]=(O=D)[0]*(B=[A,A,p?1/D[3]:A,A])[0],P[1]=O[1]*B[1],P[2]=O[2]*B[2],P[3]=O[3]*B[3],P;var P,O,B}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const D=hs([],ph([],nc([],y[E[0]],y[E[1]]),nc([],y[E[2]],y[E[1]]))),A=-ja(D,y[E[1]]);return D.concat(A)});return new Uf(y,x)}}class Vo{static fromPoints(r){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const p of r)hh(a,a,p),bp(u,u,p);return new Vo(a,u)}static applyTransform(r,a){const u=r.getCorners();for(let p=0;p<u.length;++p)pr(u[p],u[p],a);return Vo.fromPoints(u)}constructor(r,a){this.min=r,this.max=a,this.center=Ua([],la([],this.min,this.max),.5)}quadrant(r){const a=[r%2==0,r<2],u=mv(this.min),p=mv(this.max);for(let g=0;g<a.length;g++)u[g]=a[g]?this.min[g]:this.center[g],p[g]=a[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Vo(u,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,a=this.max;return[[r[0],r[1],r[2]],[a[0],r[1],r[2]],[a[0],a[1],r[2]],[r[0],a[1],r[2]],[r[0],r[1],a[2]],[a[0],r[1],a[2]],[a[0],a[1],a[2]],[r[0],a[1],a[2]]]}intersects(r){const a=this.getCorners();let u=!0;for(let p=0;p<r.planes.length;p++){const g=r.planes[p];let y=0;for(let x=0;x<a.length;x++)y+=ja(g,a[x])+g[3]>=0;if(0===y)return 0;y!==a.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let x=0;x<r.points.length;x++){const E=r.points[x][p]-this.min[p];g=Math.min(g,E),y=Math.max(y,E)}if(y<0||g>this.max[p]-this.min[p])return 0}return 1}}const wl=fn/Math.PI/2,Ep=[64,32,16],$a=-wl,Ha=wl,bv=[new Vo([$a,$a,$a],[Ha,Ha,Ha]),new Vo([$a,$a,$a],[0,0,Ha]),new Vo([0,$a,$a],[Ha,0,Ha]),new Vo([$a,0,$a],[0,Ha,Ha]),new Vo([0,0,$a],[Ha,Ha,Ha])];function mh(s){return s*wl/Tp}function xv(s,r,a,u=!0){const p=Ua([],s._camera.position,s.worldSize),g=[r,a,1,1];qc(g,g,s.pixelMatrixInverse),yv(g,g,1/g[3]);const y=hs([],nc([],g,p)),x=s.globeMatrix,E=[x[12],x[13],x[14]],D=nc([],E,p),A=vp(D),P=hs([],D),O=s.worldSize/(2*Math.PI),B=ja(P,y),z=Math.asin(O/A);if(z<Math.acos(B)){if(!u)return null;const Ze=[],Be=[];Ua(Ze,y,A/B),hs(Be,nc(Be,Ze,D)),hs(y,la(y,D,Ua(y,Be,Math.tan(z)*A)))}const $=[];new Vf(p,y).closestPointOnSphere(E,O,$);const Z=hs([],ir(x,0)),ie=hs([],ir(x,1)),he=hs([],ir(x,2)),ne=ja(Z,$),ce=ja(ie,$),_e=ja(he,$),de=_n(Math.asin(-ce/O));let Oe=_n(Math.atan2(ne,_e));Oe=s.center.lng+function(Ze,Be){const Ye=(Be-Ze+180)%360-180;return Ye<-180?Ye+360:Ye}(s.center.lng,Oe);const Pe=Ga(Oe),Ge=gn(qa(de),0,1);return new bh(Pe,Ge)}class tw{constructor(r,a,u){this.a=nc([],r,u),this.b=nc([],a,u),this.center=u;const p=hs([],this.a),g=hs([],this.b);this.angle=Math.acos(ja(p,g))}}function wg(s,r){if(0===s.angle)return null;let a;return a=0===s.a[r]?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[r]/s.a[r]/Math.sin(s.angle)-1/Math.tan(s.angle)),a<0||a>1?null:function(u,p,g,y){const x=Math.sin(g);return u*(Math.sin((1-y)*g)/x)+p*(Math.sin(y*g)/x)}(s.a[r],s.b[r],s.angle,gn(a,0,1))+s.center[r]}function Cl(s){if(s.z<=1)return bv[s.z+2*s.y+s.x];const r=Mp(Dp(s));return Vo.fromPoints(r)}function yd(s,r,a){return Ua(s,s,1-a),xp(s,s,r,a)}function wv(s,r){const a=yh(r.zoom);if(0===a)return Cl(s);const u=Dp(s),p=Mp(u),g=Ga(u.getWest())*r.worldSize,y=Ga(u.getEast())*r.worldSize,x=qa(u.getNorth())*r.worldSize,E=qa(u.getSouth())*r.worldSize,D=[g,x,0],A=[y,x,0],P=[g,E,0],O=[y,E,0],B=uh([],r.globeMatrix);return pr(D,D,B),pr(A,A,B),pr(P,P,B),pr(O,O,B),p[0]=yd(p[0],P,a),p[1]=yd(p[1],O,a),p[2]=yd(p[2],A,a),p[3]=yd(p[3],D,a),Vo.fromPoints(p)}function Ms(s,r,a){for(const u of s)pr(u,u,r),Ua(u,u,a)}function Dp({x:s,y:r,z:a}){const u=1/(1<<a),p=new si(So(s*u),to((r+1)*u)),g=new si(So((s+1)*u),to(r*u));return new Fu(p,g)}function Mp(s){const r=gt(s.getNorth()),a=gt(s.getSouth()),u=Math.cos(r),p=Math.cos(a),g=Math.sin(r),y=Math.sin(a),x=s.getWest(),E=s.getEast();return[Vr(p,y,x),Vr(p,y,E),Vr(u,g,E),Vr(u,g,x)]}function Vr(s,r,a,u=wl){return a=gt(a),[s*Math.sin(a)*u,-r*u,s*Math.cos(a)*u]}function ic(s,r,a){return Vr(Math.cos(gt(s)),Math.sin(gt(s)),r,a)}function gh(s,r,a,u){const p=1<<a.z,g=(s/fn+a.x)/p;return ic(to((r/fn+a.y)/p),So(g),u)}function Sp({min:s,max:r}){return 16383/Math.max(r[0]-s[0],r[1]-s[1],r[2]-s[2])}const Cv=new Float64Array(16);function _h(s){const r=Sp(s),a=bg(Cv,[r,r,r]);return ds(a,a,((u=[])[0]=-(p=s.min)[0],u[1]=-p[1],u[2]=-p[2],u));var u,p}function Eg(s){const r=(u=s.min,(a=Cv)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=u[0],a[13]=u[1],a[14]=u[2],a[15]=1,a);var a,u;const p=1/Sp(s);return Ou(r,r,[p,p,p])}function Dg(s,r,a,u,p){const g=function(E){const D=fn/(2*Math.PI);return E/(2*Math.PI)/D}(a),y=[s,r,-a/(2*Math.PI)],x=aa(new Float64Array(16));return ds(x,x,y),Ou(x,x,[g,g,g]),bl(x,x,gt(-p)),Lf(x,x,gt(-u)),x}function yh(s){return mr(5,6,s)}function Mg(s,r){const a=ic(r.lat,r.lng);return y=(p=xg([],function(z){const $=ic(z._center.lat,z._center.lng);let Z=ph([],xl(0,1,0),$);const ie=dh([],-z.angle,$);Z=pr(Z,Z,ie),dh(ie,-z._pitch,Z);const he=hs([],$);return Ua(he,he,mh(z.cameraToCenterDistance/z.pixelsPerMeter)),pr(he,he,ie),la([],$,he)}(s),a))[0],x=p[1],E=p[2],D=(g=a)[0],A=g[1],P=g[2],B=(O=Math.sqrt(y*y+x*x+E*E)*Math.sqrt(D*D+A*A+P*P))&&ja(p,g)/O,Math.acos(Math.min(Math.max(B,-1),1));var p,g,y,x,E,D,A,P,O,B}function Sg(s,r){return Mg(s,r)>Math.PI/2*1.01}const Ev=gt(85),Tg=Math.cos(Ev),Ag=Math.sin(Ev),Tp=6371008.8,vh=2*Math.PI*Tp;class si{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new si(wr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,u=this.lat*a,p=r.lat*a,g=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((r.lng-this.lng)*a);return Tp*Math.acos(Math.min(g,1))}toBounds(r=0){const a=360*r/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new Fu(new si(this.lng-u,this.lat-a),new si(this.lng+u,this.lat+a))}toEcef(r){const a=mh(r);return ic(this.lat,this.lng,wl+a)}static convert(r){if(r instanceof si)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new si(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new si(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Ig(s){return vh*Math.cos(s*Math.PI/180)}function Ga(s){return(180+s)/360}function qa(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Wa(s,r){return s/Ig(r)}function So(s){return 360*s-180}function to(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function kg(s,r){return s*Ig(to(r))}const To=85.051129;function jf(s){return 1/Math.cos(s*Math.PI/180)}class bh{constructor(r,a,u=0){this.x=+r,this.y=+a,this.z=+u}static fromLngLat(r,a=0){const u=si.convert(r);return new bh(Ga(u.lng),qa(u.lat),Wa(a,u.lat))}toLngLat(){return new si(So(this.x),to(this.y))}toAltitude(){return kg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/vh*jf(to(this.y))}}function Pg(s,r,a,u,p,g,y,x,E){const D=(r+u)/2,A=(a+p)/2,P=new it(D,A);x(P),function(O,B,z,$,Z,ie){const he=z-Z,ne=$-ie;return Math.abs(($-B)*he-(z-O)*ne)/Math.hypot(he,ne)}(P.x,P.y,g.x,g.y,y.x,y.y)>=E?(Pg(s,r,a,D,A,g,P,x,E),Pg(s,D,A,u,p,P,y,x,E)):s.push(y)}function Dv(s,r,a){let u=s[0],p=u.x,g=u.y;r(u);const y=[u];for(let x=1;x<s.length;x++){const E=s[x],{x:D,y:A}=E;r(E),Pg(y,p,g,D,A,u,E,r,a),p=D,g=A,u=E}return y}function Rg(s,r,a,u){if(u(r,a)){const p=r.add(a)._mult(.5);Rg(s,r,p,u),Rg(s,p,a,u)}else s.push(a)}function nw(s,r){let a=s[0];const u=[a];for(let p=1;p<s.length;p++){const g=s[p];Rg(u,a,g,r),a=g}return u}const Fg=Math.pow(2,14)-1,Og=-Fg-1;function Lg(s,r){const a=Math.round(s.x*r),u=Math.round(s.y*r);return s.x=gn(a,Og,Fg),s.y=gn(u,Og,Fg),(a<s.x||a>s.x+1||u<s.y||u>s.y+1)&&ei("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function rc(s,r,a){const u=s.loadGeometry(),p=s.extent,g=fn/p;if(r&&a&&a.projection.isReprojectedInTileSpace){const y=1<<r.z,{scale:x,x:E,y:D,projection:A}=a,P=O=>{const B=So((r.x+O.x/p)/y),z=to((r.y+O.y/p)/y),$=A.project(B,z);O.x=($.x*x-E)*p,O.y=($.y*x-D)*p};for(let O=0;O<u.length;O++)if(1!==s.type)u[O]=Dv(u[O],P,1);else{const B=[];for(const z of u[O])z.x<0||z.x>=p||z.y<0||z.y>=p||(P(z),B.push(z));u[O]=B}}for(const y of u)for(const x of y)Lg(x,g);return u}function Wc(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?rc(s):[]}}function $f(s,r,a,u,p){s.emplaceBack(2*r+(u+1)/2,2*a+(p+1)/2)}function Hf(s,r,a){s.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class Gf{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Kt,this.indexArray=new Qr,this.segments=new _r,this.programConfigurations=new ec(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,u,p){const g=this.layers[0],y=[];let x=null;"circle"===g.type&&(x=g.layout.get("circle-sort-key"));for(const{feature:D,id:A,index:P,sourceLayerIndex:O}of r){const B=this.layers[0]._featureFilter.needGeometry,z=Wc(D,B);if(!this.layers[0]._featureFilter.filter(new Se(this.zoom),z,u))continue;const $=x?x.evaluate(z,{},u):void 0,Z={id:A,properties:D.properties,type:D.type,sourceLayerIndex:O,index:P,geometry:B?z.geometry:rc(D,u,p),patterns:{},sortKey:$};y.push(Z)}x&&y.sort((D,A)=>D.sortKey-A.sortKey);let E=null;"globe"===p.projection.name&&(this.globeExtVertexArray=new La,E=p.projection);for(const D of y){const{geometry:A,index:P,sourceLayerIndex:O}=D,B=r[P].feature;this.addFeature(D,A,P,a.availableImages,u,E),a.featureIndex.insert(B,A,P,O,this.index)}}update(r,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,u,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ch.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,wD.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,a,u,p,g,y){for(const x of a)for(const E of x){const D=E.x,A=E.y;if(D<0||D>=fn||A<0||A>=fn)continue;if(y){const B=y.projectTilePoint(D,A,g),z=y.upVector(g,D,A),$=this.globeExtVertexArray;Hf($,B,z),Hf($,B,z),Hf($,B,z),Hf($,B,z)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),O=P.vertexLength;$f(this.layoutVertexArray,D,A,-1,-1),$f(this.layoutVertexArray,D,A,1,-1),$f(this.layoutVertexArray,D,A,1,1),$f(this.layoutVertexArray,D,A,-1,1),this.indexArray.emplaceBack(O,O+1,O+2),this.indexArray.emplaceBack(O,O+2,O+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},p,g)}}function Ng(s,r){for(let a=0;a<s.length;a++)if(Lu(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(Lu(s,r[a]))return!0;return!!zg(s,r)}function vd(s,r,a){return!!Lu(s,r)||!!xh(r,s,a)}function Bg(s,r){if(1===s.length)return Vg(r,s[0]);for(let a=0;a<r.length;a++){const u=r[a];for(let p=0;p<u.length;p++)if(Lu(s,u[p]))return!0}for(let a=0;a<s.length;a++)if(Vg(r,s[a]))return!0;for(let a=0;a<r.length;a++)if(zg(s,r[a]))return!0;return!1}function Mv(s,r,a){if(s.length>1){if(zg(s,r))return!0;for(let u=0;u<r.length;u++)if(xh(r[u],s,a))return!0}for(let u=0;u<s.length;u++)if(xh(s[u],r,a))return!0;return!1}function zg(s,r){if(0===s.length||0===r.length)return!1;for(let a=0;a<s.length-1;a++){const u=s[a],p=s[a+1];for(let g=0;g<r.length-1;g++)if(MD(u,p,r[g],r[g+1]))return!0}return!1}function MD(s,r,a,u){return Ko(s,a,u)!==Ko(r,a,u)&&Ko(s,r,a)!==Ko(s,r,u)}function xh(s,r,a){const u=a*a;if(1===r.length)return s.distSqr(r[0])<u;for(let p=1;p<r.length;p++)if(Sv(s,r[p-1],r[p])<u)return!0;return!1}function Sv(s,r,a){const u=r.distSqr(a);if(0===u)return s.distSqr(r);const p=((s.x-r.x)*(a.x-r.x)+(s.y-r.y)*(a.y-r.y))/u;return s.distSqr(p<0?r:p>1?a:a.sub(r)._mult(p)._add(r))}function Vg(s,r){let a,u,p,g=!1;for(let y=0;y<s.length;y++){a=s[y];for(let x=0,E=a.length-1;x<a.length;E=x++)u=a[x],p=a[E],u.y>r.y!=p.y>r.y&&r.x<(p.x-u.x)*(r.y-u.y)/(p.y-u.y)+u.x&&(g=!g)}return g}function Lu(s,r){let a=!1;for(let u=0,p=s.length-1;u<s.length;p=u++){const g=s[u],y=s[p];g.y>r.y!=y.y>r.y&&r.x<(y.x-g.x)*(r.y-g.y)/(y.y-g.y)+g.x&&(a=!a)}return a}function Ug(s,r,a,u,p){for(const y of s)if(r<=y.x&&a<=y.y&&u>=y.x&&p>=y.y)return!0;const g=[new it(r,a),new it(r,p),new it(u,p),new it(u,a)];if(s.length>2)for(const y of g)if(Lu(s,y))return!0;for(let y=0;y<s.length-1;y++)if(jg(s[y],s[y+1],g))return!0;return!1}function jg(s,r,a){const u=a[0],p=a[2];if(s.x<u.x&&r.x<u.x||s.x>p.x&&r.x>p.x||s.y<u.y&&r.y<u.y||s.y>p.y&&r.y>p.y)return!1;const g=Ko(s,r,a[0]);return g!==Ko(s,r,a[1])||g!==Ko(s,r,a[2])||g!==Ko(s,r,a[3])}function bd(s,r,a){const u=r.paint.get(s).value;return"constant"===u.kind?u.value:a.programConfigurations.get(r.id).getMaxValue(s)}function xd(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Ap(s,r,a,u,p){if(!r[0]&&!r[1])return s;const g=it.convert(r)._mult(p);"viewport"===a&&g._rotate(-u);const y=[];for(let x=0;x<s.length;x++)y.push(s[x].sub(g));return y}function $g(s,r,a,u){const p=it.convert(s)._mult(u);return"viewport"===r&&p._rotate(-a),p}Ot(Gf,"CircleBucket",{omit:["layers"]});const Hg=new ut({"circle-sort-key":new Ve(qe.layout_circle["circle-sort-key"])});var Gg={paint:new ut({"circle-radius":new Ve(qe.paint_circle["circle-radius"]),"circle-color":new Ve(qe.paint_circle["circle-color"]),"circle-blur":new Ve(qe.paint_circle["circle-blur"]),"circle-opacity":new Ve(qe.paint_circle["circle-opacity"]),"circle-translate":new Me(qe.paint_circle["circle-translate"]),"circle-translate-anchor":new Me(qe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Me(qe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Me(qe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ve(qe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ve(qe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ve(qe.paint_circle["circle-stroke-opacity"])}),layout:Hg};function qf(s,r,a,u,p,g,y,x,E){if(g&&s.queryGeometry.isAboveHorizon)return!1;g&&(E*=s.pixelToTileUnitsFactor);const D=s.tileID.canonical,A=a.projection.upVectorScale(D,a.center.lat,a.worldSize).metersToTile;for(const P of r)for(const O of P){const B=O.add(x),z=p&&a.elevation?a.elevation.exaggeration()*p.getElevationAt(B.x,B.y,!0):0,$=a.projection.projectTilePoint(B.x,B.y,D);if(z>0){const ne=a.projection.upVector(D,B.x,B.y);$.x+=ne[0]*A*z,$.y+=ne[1]*A*z,$.z+=ne[2]*A*z}const Z=g?B:Ip($.x,$.y,$.z,u),ie=g?s.tilespaceRays.map(ne=>iw(ne,z)):s.queryGeometry.screenGeometry,he=qc([],[$.x,$.y,$.z,1],u);if(!y&&g?E*=he[3]/a.cameraToCenterDistance:y&&!g&&(E*=a.cameraToCenterDistance/he[3]),g){const ne=to((O.y/fn+D.y)/(1<<D.z));E/=a.projection.pixelsPerMeter(ne,1)/Wa(1,ne)}if(vd(ie,Z,E))return!0}return!1}function Ip(s,r,a,u){const p=qc([],[s,r,a,1],u);return new it(p[0]/p[3],p[1]/p[3])}const Tv=xl(0,0,0),Av=xl(0,0,1);function iw(s,r){const a=Bf();return Tv[2]=r,s.intersectsPlane(Tv,Av,a),new it(a[0],a[1])}class Iv extends Gf{}function kv(s,{width:r,height:a},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*a*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(r*a*u);return s.width=r,s.height=a,s.data=p,s}function qg(s,r,a){const{width:u,height:p}=r;u===s.width&&p===s.height||(Wf(s,r,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,u),height:Math.min(s.height,p)},a),s.width=u,s.height=p,s.data=r.data)}function Wf(s,r,a,u,p,g){if(0===p.width||0===p.height)return r;if(p.width>s.width||p.height>s.height||a.x>s.width-p.width||a.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||u.x>r.width-p.width||u.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const y=s.data,x=r.data;for(let E=0;E<p.height;E++){const D=((a.y+E)*s.width+a.x)*g,A=((u.y+E)*r.width+u.x)*g;for(let P=0;P<p.width*g;P++)x[A+P]=y[D+P]}return r}Ot(Iv,"HeatmapBucket",{omit:["layers"]});class Za{constructor(r,a){kv(this,r,1,a)}resize(r){qg(this,new Za(r),1)}clone(){return new Za({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,u,p,g){Wf(r,a,u,p,g,1)}}class ps{constructor(r,a){kv(this,r,4,a)}resize(r){qg(this,new ps(r),4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new ps({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,u,p,g){Wf(r,a,u,p,g,4)}}Ot(Za,"AlphaImage"),Ot(ps,"RGBAImage");var wh={paint:new ut({"heatmap-radius":new Ve(qe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ve(qe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Me(qe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new st(qe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Me(qe.paint_heatmap["heatmap-opacity"])})};function Wg(s){const r={},a=s.resolution||256,u=s.clips?s.clips.length:1,p=s.image||new ps({width:a,height:u}),g=(y,x,E)=>{r[s.evaluationKey]=E;const D=s.expression.evaluate(r);p.data[y+x+0]=Math.floor(255*D.r/D.a),p.data[y+x+1]=Math.floor(255*D.g/D.a),p.data[y+x+2]=Math.floor(255*D.b/D.a),p.data[y+x+3]=Math.floor(255*D.a)};if(s.clips)for(let y=0,x=0;y<u;++y,x+=4*a)for(let E=0,D=0;E<a;E++,D+=4){const A=E/(a-1),{start:P,end:O}=s.clips[y];g(x,D,P*(1-A)+O*A)}else for(let y=0,x=0;y<a;y++,x+=4)g(0,x,y/(a-1));return p}var rw={paint:new ut({"hillshade-illumination-direction":new Me(qe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Me(qe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Me(qe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Me(qe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Me(qe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Me(qe.paint_hillshade["hillshade-accent-color"])})};const SD=Wt([{name:"a_pos",components:2,type:"Int16"}],4),{members:ow}=SD;var Nu={};function Zf(s,r,a){a=a||2;var u,p,g,y,x,E,D,A=r&&r.length,P=A?r[0]*a:s.length,O=Zg(s,0,P,a,!0),B=[];if(!O||O.next===O.prev)return B;if(A&&(O=function($,Z,ie,he){var ne,ce,_e,de=[];for(ne=0,ce=Z.length;ne<ce;ne++)(_e=Zg($,Z[ne]*he,ne<ce-1?Z[ne+1]*he:$.length,he,!1))===_e.next&&(_e.steiner=!0),de.push(cw(_e));for(de.sort(sw),ne=0;ne<de.length;ne++)ie=aw(de[ne],ie);return ie}(s,r,O,a)),s.length>80*a){u=g=s[0],p=y=s[1];for(var z=a;z<P;z+=a)(x=s[z])<u&&(u=x),(E=s[z+1])<p&&(p=E),x>g&&(g=x),E>y&&(y=E);D=0!==(D=Math.max(g-u,y-p))?32767/D:0}return wd(O,B,a,u,p,D,0),B}function Zg(s,r,a,u,p){var g,y;if(p===Qg(s,r,a,u)>0)for(g=r;g<a;g+=u)y=Lv(g,s[g],s[g+1],y);else for(g=a-u;g>=r;g-=u)y=Lv(g,s[g],s[g+1],y);return y&&Yf(y,y.next)&&(Pp(y),y=y.next),y}function oc(s,r){if(!s)return s;r||(r=s);var a,u=s;do{if(a=!1,u.steiner||!Yf(u,u.next)&&0!==Mr(u.prev,u,u.next))u=u.next;else{if(Pp(u),(u=r=u.prev)===u.next)break;a=!0}}while(a||u!==r);return r}function wd(s,r,a,u,p,g,y){if(s){!y&&g&&function(A,P,O,B){var z=A;do{0===z.z&&(z.z=Yg(z.x,z.y,P,O,B)),z.prevZ=z.prev,z.nextZ=z.next,z=z.next}while(z!==A);z.prevZ.nextZ=null,z.prevZ=null,function($){var Z,ie,he,ne,ce,_e,de,Oe,Pe=1;do{for(ie=$,$=null,ce=null,_e=0;ie;){for(_e++,he=ie,de=0,Z=0;Z<Pe&&(de++,he=he.nextZ);Z++);for(Oe=Pe;de>0||Oe>0&&he;)0!==de&&(0===Oe||!he||ie.z<=he.z)?(ne=ie,ie=ie.nextZ,de--):(ne=he,he=he.nextZ,Oe--),ce?ce.nextZ=ne:$=ne,ne.prevZ=ce,ce=ne;ie=he}ce.nextZ=null,Pe*=2}while(_e>1)}(z)}(s,u,p,g);for(var x,E,D=s;s.prev!==s.next;)if(x=s.prev,E=s.next,g?Rv(s,u,p,g):Pv(s))r.push(x.i/a|0),r.push(s.i/a|0),r.push(E.i/a|0),Pp(s),s=E.next,D=E.next;else if((s=E)===D){y?1===y?wd(s=Fv(oc(s),r,a),r,a,u,p,g,2):2===y&&Cd(s,r,a,u,p,g):wd(oc(s),r,a,u,p,g,1);break}}}function Pv(s){var r=s.prev,a=s,u=s.next;if(Mr(r,a,u)>=0)return!1;for(var p=r.x,g=a.x,y=u.x,x=r.y,E=a.y,D=u.y,A=p<g?p<y?p:y:g<y?g:y,P=x<E?x<D?x:D:E<D?E:D,O=p>g?p>y?p:y:g>y?g:y,B=x>E?x>D?x:D:E>D?E:D,z=u.next;z!==r;){if(z.x>=A&&z.x<=O&&z.y>=P&&z.y<=B&&Ao(p,x,g,E,y,D,z.x,z.y)&&Mr(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function Rv(s,r,a,u){var p=s.prev,g=s,y=s.next;if(Mr(p,g,y)>=0)return!1;for(var x=p.x,E=g.x,D=y.x,A=p.y,P=g.y,O=y.y,B=x<E?x<D?x:D:E<D?E:D,z=A<P?A<O?A:O:P<O?P:O,$=x>E?x>D?x:D:E>D?E:D,Z=A>P?A>O?A:O:P>O?P:O,ie=Yg(B,z,r,a,u),he=Yg($,Z,r,a,u),ne=s.prevZ,ce=s.nextZ;ne&&ne.z>=ie&&ce&&ce.z<=he;){if(ne.x>=B&&ne.x<=$&&ne.y>=z&&ne.y<=Z&&ne!==p&&ne!==y&&Ao(x,A,E,P,D,O,ne.x,ne.y)&&Mr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ce.x>=B&&ce.x<=$&&ce.y>=z&&ce.y<=Z&&ce!==p&&ce!==y&&Ao(x,A,E,P,D,O,ce.x,ce.y)&&Mr(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;ne&&ne.z>=ie;){if(ne.x>=B&&ne.x<=$&&ne.y>=z&&ne.y<=Z&&ne!==p&&ne!==y&&Ao(x,A,E,P,D,O,ne.x,ne.y)&&Mr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ce&&ce.z<=he;){if(ce.x>=B&&ce.x<=$&&ce.y>=z&&ce.y<=Z&&ce!==p&&ce!==y&&Ao(x,A,E,P,D,O,ce.x,ce.y)&&Mr(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function Fv(s,r,a){var u=s;do{var p=u.prev,g=u.next.next;!Yf(p,g)&&Ov(p,u,u.next,g)&&kp(p,g)&&kp(g,p)&&(r.push(p.i/a|0),r.push(u.i/a|0),r.push(g.i/a|0),Pp(u),Pp(u.next),u=s=g),u=u.next}while(u!==s);return oc(u)}function Cd(s,r,a,u,p,g){var y=s;do{for(var x=y.next.next;x!==y.prev;){if(y.i!==x.i&&sc(y,x)){var E=Xg(y,x);return y=oc(y,y.next),E=oc(E,E.next),wd(y,r,a,u,p,g,0),void wd(E,r,a,u,p,g,0)}x=x.next}y=y.next}while(y!==s)}function sw(s,r){return s.x-r.x}function aw(s,r){var a=function(p,g){var y,x=g,E=p.x,D=p.y,A=-1/0;do{if(D<=x.y&&D>=x.next.y&&x.next.y!==x.y){var P=x.x+(D-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(P<=E&&P>A&&(A=P,y=x.x<x.next.x?x:x.next,P===E))return y}x=x.next}while(x!==g);if(!y)return null;var O,B=y,z=y.x,$=y.y,Z=1/0;x=y;do{E>=x.x&&x.x>=z&&E!==x.x&&Ao(D<$?E:A,D,z,$,D<$?A:E,D,x.x,x.y)&&(O=Math.abs(D-x.y)/(E-x.x),kp(x,p)&&(O<Z||O===Z&&(x.x>y.x||x.x===y.x&&lw(y,x)))&&(y=x,Z=O)),x=x.next}while(x!==B);return y}(s,r);if(!a)return r;var u=Xg(a,s);return oc(u,u.next),oc(a,a.next)}function lw(s,r){return Mr(s.prev,s,r.prev)<0&&Mr(r.next,s,s.next)<0}function Yg(s,r,a,u,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function cw(s){var r=s,a=s;do{(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next}while(r!==s);return a}function Ao(s,r,a,u,p,g,y,x){return(p-y)*(r-x)>=(s-y)*(g-x)&&(s-y)*(u-x)>=(a-y)*(r-x)&&(a-y)*(g-x)>=(p-y)*(u-x)}function sc(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(a,u){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==u.i&&p.next.i!==u.i&&Ov(p,p.next,a,u))return!0;p=p.next}while(p!==a);return!1}(s,r)&&(kp(s,r)&&kp(r,s)&&function(a,u){var p=a,g=!1,y=(a.x+u.x)/2,x=(a.y+u.y)/2;do{p.y>x!=p.next.y>x&&p.next.y!==p.y&&y<(p.next.x-p.x)*(x-p.y)/(p.next.y-p.y)+p.x&&(g=!g),p=p.next}while(p!==a);return g}(s,r)&&(Mr(s.prev,s,r.prev)||Mr(s,r.prev,r))||Yf(s,r)&&Mr(s.prev,s,s.next)>0&&Mr(r.prev,r,r.next)>0)}function Mr(s,r,a){return(r.y-s.y)*(a.x-r.x)-(r.x-s.x)*(a.y-r.y)}function Yf(s,r){return s.x===r.x&&s.y===r.y}function Ov(s,r,a,u){var p=Kf(Mr(s,r,a)),g=Kf(Mr(s,r,u)),y=Kf(Mr(a,u,s)),x=Kf(Mr(a,u,r));return p!==g&&y!==x||!(0!==p||!Xf(s,a,r))||!(0!==g||!Xf(s,u,r))||!(0!==y||!Xf(a,s,u))||!(0!==x||!Xf(a,r,u))}function Xf(s,r,a){return r.x<=Math.max(s.x,a.x)&&r.x>=Math.min(s.x,a.x)&&r.y<=Math.max(s.y,a.y)&&r.y>=Math.min(s.y,a.y)}function Kf(s){return s>0?1:s<0?-1:0}function kp(s,r){return Mr(s.prev,s,s.next)<0?Mr(s,r,s.next)>=0&&Mr(s,s.prev,r)>=0:Mr(s,r,s.prev)<0||Mr(s,s.next,r)<0}function Xg(s,r){var a=new Kg(s.i,s.x,s.y),u=new Kg(r.i,r.x,r.y),p=s.next,g=r.prev;return s.next=r,r.prev=s,a.next=p,p.prev=a,u.next=a,a.prev=u,g.next=u,u.prev=g,u}function Lv(s,r,a,u){var p=new Kg(s,r,a);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Pp(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Kg(s,r,a){this.i=s,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qg(s,r,a,u){for(var p=0,g=r,y=a-u;g<a;g+=u)p+=(s[y]-s[g])*(s[g+1]+s[y+1]),y=g;return p}function Qf(s,r,a,u,p){ac(s,r,a||0,u||s.length-1,p||Nv)}function ac(s,r,a,u,p){for(;u>a;){if(u-a>600){var g=u-a+1,y=r-a+1,x=Math.log(g),E=.5*Math.exp(2*x/3),D=.5*Math.sqrt(x*E*(g-E)/g)*(y-g/2<0?-1:1);ac(s,r,Math.max(a,Math.floor(r-y*E/g+D)),Math.min(u,Math.floor(r+(g-y)*E/g+D)),p)}var A=s[r],P=a,O=u;for(Zc(s,a,r),p(s[u],A)>0&&Zc(s,a,u);P<O;){for(Zc(s,P,O),P++,O--;p(s[P],A)<0;)P++;for(;p(s[O],A)>0;)O--}0===p(s[a],A)?Zc(s,a,O):Zc(s,++O,u),O<=r&&(a=O+1),r<=O&&(u=O-1)}}function Zc(s,r,a){var u=s[r];s[r]=s[a],s[a]=u}function Nv(s,r){return s<r?-1:s>r?1:0}function Jf(s,r){const a=s.length;if(a<=1)return[s];const u=[];let p,g;for(let y=0;y<a;y++){const x=Kn(s[y]);0!==x&&(s[y].area=Math.abs(x),void 0===g&&(g=x<0),g===x<0?(p&&u.push(p),p=[s[y]]):p.push(s[y]))}if(p&&u.push(p),r>1)for(let y=0;y<u.length;y++)u[y].length<=r||(Qf(u[y],r,1,u[y].length-1,Bv),u[y]=u[y].slice(0,r));return u}function Bv(s,r){return r.area-s.area}function zv(s,r,a){const u=a.patternDependencies;let p=!1;for(const g of r){const y=g.paint.get(`${s}-pattern`);y.isConstant()||(p=!0);const x=y.constantOr(null);x&&(p=!0,u[x]=!0)}return p}function Vv(s,r,a,u,p){const g=p.patternDependencies;for(const y of r){const x=y.paint.get(`${s}-pattern`).value;if("constant"!==x.kind){let E=x.evaluate({zoom:u},a,{},p.availableImages);E=E&&E.name?E.name:E,g[E]=!0,a.patterns[y.id]=E}}return a}({get exports(){return Nu},set exports(s){Nu=s}}).exports=Zf,Nu.default=Zf,Zf.deviation=function(s,r,a,u){var p=r&&r.length,g=Math.abs(Qg(s,0,p?r[0]*a:s.length,a));if(p)for(var y=0,x=r.length;y<x;y++)g-=Math.abs(Qg(s,r[y]*a,y<x-1?r[y+1]*a:s.length,a));var E=0;for(y=0;y<u.length;y+=3){var D=u[y]*a,A=u[y+1]*a,P=u[y+2]*a;E+=Math.abs((s[D]-s[P])*(s[A+1]-s[D+1])-(s[D]-s[A])*(s[P+1]-s[D+1]))}return 0===g&&0===E?0:Math.abs((E-g)/g)},Zf.flatten=function(s){for(var r=s[0][0].length,a={vertices:[],holes:[],dimensions:r},u=0,p=0;p<s.length;p++){for(var g=0;g<s[p].length;g++)for(var y=0;y<r;y++)a.vertices.push(s[p][g][y]);p>0&&a.holes.push(u+=s[p-1].length)}return a};class Jg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Kt,this.indexArray=new Qr,this.indexArray2=new yl,this.programConfigurations=new ec(r.layers,r.zoom),this.segments=new _r,this.segments2=new _r,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=r.projection}populate(r,a,u,p){this.hasPattern=zv("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:x,id:E,index:D,sourceLayerIndex:A}of r){const P=this.layers[0]._featureFilter.needGeometry,O=Wc(x,P);if(!this.layers[0]._featureFilter.filter(new Se(this.zoom),O,u))continue;const B=g?g.evaluate(O,{},u,a.availableImages):void 0,z={id:E,properties:x.properties,type:x.type,sourceLayerIndex:A,index:D,geometry:P?O.geometry:rc(x,u,p),patterns:{},sortKey:B};y.push(z)}g&&y.sort((x,E)=>x.sortKey-E.sortKey);for(const x of y){const{geometry:E,index:D,sourceLayerIndex:A}=x;if(this.hasPattern){const P=Vv("fill",this.layers,x,this.zoom,a);this.patternFeatures.push(P)}else this.addFeature(x,E,D,u,{},a.availableImages);a.featureIndex.insert(r[D].feature,E,D,A,this.index)}}update(r,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,u,p)}addFeatures(r,a,u,p,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,u,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ow),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,u,p,g,y=[]){for(const x of Jf(a,500)){let E=0;for(const z of x)E+=z.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),A=D.vertexLength,P=[],O=[];for(const z of x){if(0===z.length)continue;z!==x[0]&&O.push(P.length/2);const $=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),Z=$.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(Z+z.length-1,Z),P.push(z[0].x),P.push(z[0].y);for(let ie=1;ie<z.length;ie++)this.layoutVertexArray.emplaceBack(z[ie].x,z[ie].y),this.indexArray2.emplaceBack(Z+ie-1,Z+ie),P.push(z[ie].x),P.push(z[ie].y);$.vertexLength+=z.length,$.primitiveLength+=z.length}const B=Nu(P,O);for(let z=0;z<B.length;z+=3)this.indexArray.emplaceBack(A+B[z],A+B[z+1],A+B[z+2]);D.vertexLength+=E,D.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,y,p)}}Ot(Jg,"FillBucket",{omit:["layers","patternFeatures"]});const e_=new ut({"fill-sort-key":new Ve(qe.layout_fill["fill-sort-key"])});var t_={paint:new ut({"fill-antialias":new Me(qe.paint_fill["fill-antialias"]),"fill-opacity":new Ve(qe.paint_fill["fill-opacity"]),"fill-color":new Ve(qe.paint_fill["fill-color"]),"fill-outline-color":new Ve(qe.paint_fill["fill-outline-color"]),"fill-translate":new Me(qe.paint_fill["fill-translate"]),"fill-translate-anchor":new Me(qe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ve(qe.paint_fill["fill-pattern"])}),layout:e_};const TD=Wt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),AD=Wt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Uv=Wt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:uw}=TD;var em={},dw=it,jv=Ed;function Ed(s,r,a,u,p){this.properties={},this.extent=a,this.type=0,this._pbf=s,this._geometry=-1,this._keys=u,this._values=p,s.readFields(tm,this,r)}function tm(s,r,a){1==s?r.id=a.readVarint():2==s?function(u,p){for(var g=u.readVarint()+u.pos;u.pos<g;){var y=p._keys[u.readVarint()],x=p._values[u.readVarint()];p.properties[y]=x}}(a,r):3==s?r.type=a.readVarint():4==s&&(r._geometry=a.pos)}function $v(s){for(var r,a,u=0,p=0,g=s.length,y=g-1;p<g;y=p++)u+=((a=s[y]).x-(r=s[p]).x)*(r.y+a.y);return u}Ed.types=["Unknown","Point","LineString","Polygon"],Ed.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,a=s.readVarint()+s.pos,u=1,p=0,g=0,y=0,x=[];s.pos<a;){if(p<=0){var E=s.readVarint();u=7&E,p=E>>3}if(p--,1===u||2===u)g+=s.readSVarint(),y+=s.readSVarint(),1===u&&(r&&x.push(r),r=[]),r.push(new dw(g,y));else{if(7!==u)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}return r&&x.push(r),x},Ed.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,a=1,u=0,p=0,g=0,y=1/0,x=-1/0,E=1/0,D=-1/0;s.pos<r;){if(u<=0){var A=s.readVarint();a=7&A,u=A>>3}if(u--,1===a||2===a)(p+=s.readSVarint())<y&&(y=p),p>x&&(x=p),(g+=s.readSVarint())<E&&(E=g),g>D&&(D=g);else if(7!==a)throw new Error("unknown command "+a)}return[y,E,x,D]},Ed.prototype.toGeoJSON=function(s,r,a){var u,p,g=this.extent*Math.pow(2,a),y=this.extent*s,x=this.extent*r,E=this.loadGeometry(),D=Ed.types[this.type];function A(B){for(var z=0;z<B.length;z++){var $=B[z];B[z]=[360*($.x+y)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+x)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(u=0;u<E.length;u++)P[u]=E[u][0];A(E=P);break;case 2:for(u=0;u<E.length;u++)A(E[u]);break;case 3:for(E=function(B){var z=B.length;if(z<=1)return[B];for(var $,Z,ie=[],he=0;he<z;he++){var ne=$v(B[he]);0!==ne&&(void 0===Z&&(Z=ne<0),Z===ne<0?($&&ie.push($),$=[B[he]]):$.push(B[he]))}return $&&ie.push($),ie}(E),u=0;u<E.length;u++)for(p=0;p<E[u].length;p++)A(E[u][p])}1===E.length?E=E[0]:D="Multi"+D;var O={type:"Feature",geometry:{type:D,coordinates:E},properties:this.properties};return"id"in this&&(O.id=this.id),O};var n_=jv,Hv=zi;function zi(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(hw,this,r),this.length=this._features.length}function hw(s,r,a){15===s?r.version=a.readVarint():1===s?r.name=a.readString():5===s?r.extent=a.readVarint():2===s?r._features.push(a.pos):3===s?r._keys.push(a.readString()):4===s&&r._values.push(function(u){for(var p=null,g=u.readVarint()+u.pos;u.pos<g;){var y=u.readVarint()>>3;p=1===y?u.readString():2===y?u.readFloat():3===y?u.readDouble():4===y?u.readVarint64():5===y?u.readVarint():6===y?u.readSVarint():7===y?u.readBoolean():null}return p}(a))}zi.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new n_(this._pbf,r,this.extent,this._keys,this._values)};var pw=Hv;function i_(s,r,a){if(3===s){var u=new pw(a,a.readVarint()+a.pos);u.length&&(r[u.name]=u)}}var Rp=em.VectorTile=function(s,r){this.layers=s.readFields(i_,{},r)},nm=em.VectorTileFeature=jv;function im(s,r,a,u){const p=[],g=0===u?(y,x,E,D,A,P)=>{y.push(new it(P,E+(P-x)/(D-x)*(A-E)))}:(y,x,E,D,A,P)=>{y.push(new it(x+(P-E)/(A-E)*(D-x),P))};for(const y of s){const x=[];for(const E of y){if(E.length<=2)continue;const D=[];for(let O=0;O<E.length-1;O++){const B=E[O].x,z=E[O].y,$=E[O+1].x,Z=E[O+1].y,ie=0===u?B:z,he=0===u?$:Z;ie<r?he>r&&g(D,B,z,$,Z,r):ie>a?he<a&&g(D,B,z,$,Z,a):D.push(E[O]),he<r&&ie>=r&&g(D,B,z,$,Z,r),he>a&&ie<=a&&g(D,B,z,$,Z,a)}let A=E[E.length-1];const P=0===u?A.x:A.y;P>=r&&P<=a&&D.push(A),D.length&&(A=D[D.length-1],D[0].x===A.x&&D[0].y===A.y||D.push(D[0]),x.push(D))}x.length&&p.push(x)}return p}em.VectorTileLayer=Hv;const fw=nm.types,mw=Math.pow(2,13);function Ch(s,r,a,u,p,g,y,x){s.emplaceBack((r<<1)+y,(a<<1)+g,(Math.floor(u*mw)<<1)+p,Math.round(x))}function rm(s,r,a){s.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class gw{constructor(){this.acc=new it(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new it(r.x,r.y),this.max=new it(r.x,r.y))}append(r,a){this.currentPolyCount.edges++,this.acc._add(r);const u=this.min,p=this.max;r.x<u.x?u.x=r.x:r.x>p.x&&(p.x=r.x),r.y<u.y?u.y=r.y:r.y>p.y&&(p.y=r.y),((0===r.x||r.x===fn)&&r.x===a.x)!=((0===r.y||r.y===fn)&&r.y===a.y)&&this.processBorderOverlap(r,a),a.x<0!=r.x<0&&this.addBorderIntersection(0,zn(a.y,r.y,(0-a.x)/(r.x-a.x))),a.x>fn!=r.x>fn&&this.addBorderIntersection(1,zn(a.y,r.y,(fn-a.x)/(r.x-a.x))),a.y<0!=r.y<0&&this.addBorderIntersection(2,zn(a.x,r.x,(0-a.y)/(r.y-a.y))),a.y>fn!=r.y>fn&&this.addBorderIntersection(3,zn(a.x,r.x,(fn-a.y)/(r.y-a.y)))}addBorderIntersection(r,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[r];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(r,a){if(r.x===a.x){if(r.y===a.y)return;const u=0===r.x?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,r.y)}else{const u=0===r.y?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,r.x)}}centroid(){const r=this.polyCount.reduce((a,u)=>a+u.edges,0);return 0!==r?this.acc.div(r)._round():new it(0,0)}span(){return new it(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((r,a)=>r+ +(a[0]!==Number.MAX_VALUE),0)}}class Yc{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.layoutVertexArray=new di,this.centroidVertexArray=new gd,this.indexArray=new Qr,this.programConfigurations=new ec(r.layers,r.zoom),this.segments=new _r,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.enableTerrain=r.enableTerrain}populate(r,a,u,p){this.features=[],this.hasPattern=zv("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const y=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*y/(y*y+1)/fn/(1<<g.z)}(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:y,index:x,sourceLayerIndex:E}of r){const D=this.layers[0]._featureFilter.needGeometry,A=Wc(g,D);if(!this.layers[0]._featureFilter.filter(new Se(this.zoom),A,u))continue;const P={id:y,sourceLayerIndex:E,index:x,geometry:D?A.geometry:rc(g,u,p),properties:g.properties,type:g.type,patterns:{}},O=this.layoutVertexArray.length;this.hasPattern?this.features.push(Vv("fill-extrusion",this.layers,P,this.zoom,a)):this.addFeature(P,P.geometry,x,u,{},a.availableImages,p),a.featureIndex.insert(g,P.geometry,x,E,this.index,O)}this.sortBorders()}addFeatures(r,a,u,p,g){for(const y of this.features){const{geometry:x}=y;this.addFeature(y,x,y.index,a,u,p,g)}this.sortBorders()}update(r,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,u,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,uw),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,Uv.members,!0))),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,AD.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,u,p,g,y,x){const E=[new it(0,0),new it(fn,fn)],D=x.projection,A="globe"===D.name,P=this.enableTerrain&&!A?new gw:null,O="Polygon"===fw[r.type];A&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new La);const B=Jf(a,500);for(let ie=B.length-1;ie>=0;ie--){const he=B[ie];(0===he.length||(z=he[0]).every(ne=>ne.x<=0)||z.every(ne=>ne.x>=fn)||z.every(ne=>ne.y<=0)||z.every(ne=>ne.y>=fn))&&B.splice(ie,1)}var z;let $;if(A)$=a_(B,E,p);else{$=[];for(const ie of B)$.push({polygon:ie,bounds:E})}const Z=O?this.edgeRadius:0;for(const{polygon:ie,bounds:he}of $){let ne=0,ce=0;for(const de of ie)O&&!de[0].equals(de[de.length-1])&&de.push(de[0]),ce+=O?de.length-1:de.length;const _e=this.segments.prepareSegment((O?5:4)*ce,this.layoutVertexArray,this.indexArray);if(O){const de=[],Oe=[];ne=_e.vertexLength;for(const Ge of ie){let Ze,Be;Ge.length&&Ge!==ie[0]&&Oe.push(de.length/2),Ze=Ge[1].sub(Ge[0])._perp()._unit();for(let Ye=1;Ye<Ge.length;Ye++){const et=Ge[Ye],at=Ge[Ye===Ge.length-1?1:Ye+1];let{x:dt,y:Ue}=et;if(Z){Be=at.sub(et)._perp()._unit();const vt=Ze.add(Be)._unit(),Qt=Z*Math.min(4,1/(Ze.x*vt.x+Ze.y*vt.y));dt+=Qt*vt.x,Ue+=Qt*vt.y,Ze=Be}Ch(this.layoutVertexArray,dt,Ue,0,0,1,1,0),_e.vertexLength++,de.push(et.x,et.y),A&&rm(this.layoutVertexExtArray,D.projectTilePoint(dt,Ue,p),D.upVector(p,dt,Ue))}}const Pe=Nu(de,Oe);for(let Ge=0;Ge<Pe.length;Ge+=3)this.indexArray.emplaceBack(ne+Pe[Ge],ne+Pe[Ge+2],ne+Pe[Ge+1]),_e.primitiveLength++}for(const de of ie){P&&de.length&&P.startRing(de[0]);let Oe,Pe,Ge,Ze=de.length>4&&_w(de[de.length-2],de[0],de[1]),Be=Z?Gv(de[de.length-2],de[0],de[1],Z):0;Pe=de[1].sub(de[0])._perp()._unit();let Ye=!0;for(let et=1,at=0;et<de.length;et++){let dt=de[et-1],Ue=de[et];const vt=de[et===de.length-1?1:et+1];if(P&&O&&P.currentPolyCount.top++,o_(Ue,dt,he)){Z&&(Pe=vt.sub(Ue)._perp()._unit(),Ye=!Ye);continue}P&&P.append(Ue,dt);const Qt=Ue.sub(dt)._perp(),Dt=Qt.x/(Math.abs(Qt.x)+Math.abs(Qt.y)),Bt=Qt.y>0?1:0,Ct=dt.dist(Ue);if(at+Ct>32768&&(at=0),Z){Ge=vt.sub(Ue)._perp()._unit();let Ln=r_(dt,Ue,vt,Fp(Pe,Ge),Z);isNaN(Ln)&&(Ln=0);const cn=Ue.sub(dt)._unit();dt=dt.add(cn.mult(Be))._round(),Ue=Ue.add(cn.mult(-Ln))._round(),Be=Ln,Pe=Ge}const ln=_e.vertexLength,Hn=de.length>4&&_w(dt,Ue,vt);let Vn=qv(at,Ze,Ye);if(Ch(this.layoutVertexArray,dt.x,dt.y,Dt,Bt,0,0,Vn),Ch(this.layoutVertexArray,dt.x,dt.y,Dt,Bt,0,1,Vn),at+=Ct,Vn=qv(at,Hn,!Ye),Ze=Hn,Ch(this.layoutVertexArray,Ue.x,Ue.y,Dt,Bt,0,0,Vn),Ch(this.layoutVertexArray,Ue.x,Ue.y,Dt,Bt,0,1,Vn),_e.vertexLength+=4,this.indexArray.emplaceBack(ln+0,ln+1,ln+2),this.indexArray.emplaceBack(ln+1,ln+3,ln+2),_e.primitiveLength+=2,Z){const Ln=ne+(1===et?de.length-2:et-2),cn=1===et?ne:Ln+1;if(this.indexArray.emplaceBack(ln+1,Ln,ln+3),this.indexArray.emplaceBack(Ln,cn,ln+3),_e.primitiveLength+=2,void 0===Oe&&(Oe=ln),!o_(vt,de[et],he)){const Mi=et===de.length-1?Oe:_e.vertexLength;this.indexArray.emplaceBack(ln+2,ln+3,Mi),this.indexArray.emplaceBack(ln+3,Mi+1,Mi),this.indexArray.emplaceBack(ln+3,cn,Mi+1),_e.primitiveLength+=3}Ye=!Ye}if(A){const Ln=this.layoutVertexExtArray,cn=D.projectTilePoint(dt.x,dt.y,p),Mi=D.projectTilePoint(Ue.x,Ue.y,p),vn=D.upVector(p,dt.x,dt.y),Wn=D.upVector(p,Ue.x,Ue.y);rm(Ln,cn,vn),rm(Ln,cn,vn),rm(Ln,Mi,Wn),rm(Ln,Mi,Wn)}}O&&(ne+=de.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const ie=P.borders,he=this.featuresOnBorder.push(P)-1;for(let ne=0;ne<4;ne++)ie[ne][0]!==Number.MAX_VALUE&&this.borders[ne].push(he)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,y,p)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort((a,u)=>this.featuresOnBorder[a].borders[r][0]-this.featuresOnBorder[u].borders[r][0])}encodeCentroid(r,a,u=!0){let p,g;if(r)if(0!==r.y){const x=a.span()._mult(this.tileToMeter);p=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(x.x/10)),g=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else p=Math.ceil(7*(r.x+450)),g=0;else p=0,g=+u;let y=u?this.centroidVertexArray.length:a.vertexArrayOffset;for(const x of a.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let E=0;E<x.top;E++)this.centroidVertexArray.emplace(y++,p,g);for(let E=0;E<2*x.edges;E++)this.centroidVertexArray.emplace(y++,0,g),this.centroidVertexArray.emplace(y++,p,g)}}}function Fp(s,r){const a=s.add(r)._unit();return s.x*a.x+s.y*a.y}function Gv(s,r,a,u){const p=r.sub(s)._perp()._unit(),g=a.sub(r)._perp()._unit();return r_(s,r,a,Fp(p,g),u)}function r_(s,r,a,u,p){const g=Math.sqrt(1-u*u);return Math.min(s.dist(r)/3,r.dist(a)/3,p*g/u)}function o_(s,r,a){return s.x<a[0].x&&r.x<a[0].x||s.x>a[1].x&&r.x>a[1].x||s.y<a[0].y&&r.y<a[0].y||s.y>a[1].y&&r.y>a[1].y}function _w(s,r,a){if(s.x<0||s.x>=fn||r.x<0||r.x>=fn||a.x<0||a.x>=fn)return!1;const u=a.sub(r),p=u.perp(),g=s.sub(r);return(u.x*g.x+u.y*g.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(g.x*g.x+g.y*g.y))>-.866&&p.x*g.x+p.y*g.y<0}function qv(s,r,a){const u=r?2|s:-3&s;return a?1|u:-2&u}function s_(){const s=Math.PI/32,r=Math.tan(s),a=Tp;return a*Math.sqrt(1+2*r*r)-a}function a_(s,r,a){const u=1<<a.z,p=So(a.x/u),g=So((a.x+1)/u),y=to(a.y/u),x=to((a.y+1)/u);return function(E,D,A,P,O=0,B){const z=[];if(!E.length||!A||!P)return z;const $=(de,Oe)=>{for(const Pe of de)z.push({polygon:Pe,bounds:Oe})},Z=Math.ceil(Math.log2(A)),ie=Math.ceil(Math.log2(P)),he=Z-ie,ne=[];for(let de=0;de<Math.abs(he);de++)ne.push(he>0?0:1);for(let de=0;de<Math.min(Z,ie);de++)ne.push(0),ne.push(1);let ce=E;if(ce=im(ce,D[0].y-O,D[1].y+O,1),ce=im(ce,D[0].x-O,D[1].x+O,0),!ce.length)return z;const _e=[];for(ne.length?_e.push({polygons:ce,bounds:D,depth:0}):$(ce,D);_e.length;){const de=_e.pop(),Oe=de.depth,Pe=ne[Oe],Ge=de.bounds[0],Ze=de.bounds[1],Be=0===Pe?Ge.x:Ge.y,Ye=0===Pe?Ze.x:Ze.y,et=B?B(Pe,Be,Ye):.5*(Be+Ye),at=im(de.polygons,Be-O,et+O,Pe),dt=im(de.polygons,et-O,Ye+O,Pe);if(at.length){const Ue=[Ge,new it(0===Pe?et:Ze.x,1===Pe?et:Ze.y)];ne.length>Oe+1?_e.push({polygons:at,bounds:Ue,depth:Oe+1}):$(at,Ue)}if(dt.length){const Ue=[new it(0===Pe?et:Ge.x,1===Pe?et:Ge.y),Ze];ne.length>Oe+1?_e.push({polygons:dt,bounds:Ue,depth:Oe+1}):$(dt,Ue)}}return z}(s,r,Math.ceil((g-p)/11.25),Math.ceil((y-x)/11.25),1,(E,D,A)=>{if(0===E)return.5*(D+A);{const P=to((a.y+D/fn)/u);return(qa(.5*(to((a.y+A/fn)/u)+P))*u-a.y)*fn}})}Ot(Yc,"FillExtrusionBucket",{omit:["layers","features"]}),Ot(gw,"PartMetadata");const l_=new ut({"fill-extrusion-edge-radius":new Me(qe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var ID={paint:new ut({"fill-extrusion-opacity":new Me(qe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ve(qe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Me(qe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Me(qe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ve(qe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ve(qe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ve(qe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Me(qe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Me(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Me(qe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:l_};function om(s,r,a){var u=2*Math.PI*6378137/256/Math.pow(2,a);return[s*u-2*Math.PI*6378137/2,r*u-2*Math.PI*6378137/2]}class sm{constructor(r,a,u){this.z=r,this.x=a,this.y=u,this.key=Eh(0,r,r,a,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a){const u=(y=this.y,x=this.z,E=om(256*(g=this.x),256*(y=Math.pow(2,x)-y-1),x),D=om(256*(g+1),256*(y+1),x),E[0]+","+E[1]+","+D[0]+","+D[1]),p=function(g,y,x){let E,D="";for(let A=g;A>0;A--)E=1<<A-1,D+=(y&E?1:0)+(x&E?2:0);return D}(this.z,this.x,this.y);var g,y,x,E,D;return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===a?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class am{constructor(r,a){this.wrap=r,this.canonical=a,this.key=Eh(r,a.z,a.z,a.x,a.y)}}class Uo{constructor(r,a,u,p,g){this.overscaledZ=r,this.wrap=a,this.canonical=new sm(u,+p,+g),this.key=0===a&&r===u?this.canonical.key:Eh(a,r,u,p,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const a=this.canonical.z-r;return r>this.canonical.z?new Uo(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a=!0){if(this.overscaledZ===r&&a)return this.key;if(r>this.canonical.z)return Eh(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-r;return Eh(this.wrap*+a,r,r,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Uo(a,this.wrap,a,u,p),new Uo(a,this.wrap,a,u+1,p),new Uo(a,this.wrap,a,u,p+1),new Uo(a,this.wrap,a,u+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Uo(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new am(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Eh(s,r,a,u,p){const g=1<<Math.min(a,22);let y=g*(p%g)+u%g;return s&&a<22&&(y+=g*g*((s<0?-2*s-1:2*s)%(1<<2*(22-a)))),16*(32*y+a)+(r-a)}Ot(sm,"CanonicalTileID"),Ot(Uo,"OverscaledTileID",{omit:["projMatrix"]});class Ya extends it{constructor(r,a,u){super(r,a),this.z=u}}function Op(s,r){return s.x*r.x+s.y*r.y}function lm(s,r){if(1===s.length){let a=0;const u=r[a++];let p;for(;!p||u.equals(p);)if(p=r[a++],!p)return 1/0;for(;a<r.length;a++){const g=r[a],y=s[0],x=p.sub(u),E=g.sub(u),D=y.sub(u),A=Op(x,x),P=Op(x,E),O=Op(E,E),B=Op(D,x),z=Op(D,E),$=A*O-P*P,Z=(O*B-P*z)/$,ie=(A*z-P*B)/$,he=u.z*(1-Z-ie)+p.z*Z+g.z*ie;if(isFinite(he))return he}return 1/0}{let a=1/0;for(const u of r)a=Math.min(a,u.z);return a}}function Lp(s,r,a,u,p,g,y,x){const E=y*p.getElevationAt(s,r,!0,!0),D=0!==g[0],A=D?0===g[1]?y*(g[0]/7-450):y*function(P,O,B){const z=Math.floor(O[0]/8),$=Math.floor(O[1]/8),Z=10*(O[0]-8*z),ie=10*(O[1]-8*$),he=P.getElevationAt(z,$,!0,!0),ne=P.getMeterToDEM(B),ce=Math.floor(.5*(Z*ne-1)),_e=Math.floor(.5*(ie*ne-1)),de=P.tileCoordToPixel(z,$),Oe=2*ce+1,Pe=2*_e+1,Ge=(Qt=Oe,Dt=Pe,[(dt=P).getElevationAtPixel(Ue=de.x-ce,vt=de.y-_e,!0),dt.getElevationAtPixel(Ue+Dt,vt,!0),dt.getElevationAtPixel(Ue,vt+Dt,!0),dt.getElevationAtPixel(Ue+Qt,vt+Dt,!0)]),Ze=Math.abs(Ge[0]-Ge[1]),Be=Math.abs(Ge[2]-Ge[3]),Ye=Math.abs(Ge[0]-Ge[2])+Math.abs(Ge[1]-Ge[3]),et=Math.min(.25,.5*ne*(Ze+Be)/Oe),at=Math.min(.25,.5*ne*Ye/Pe);var dt,Ue,vt,Qt,Dt;return he+Math.max(et*Z,at*ie)}(p,g,x):E;return{base:E+(0===a)?-1:a,top:D?Math.max(A+u,E+a+2):E+u}}const yw=Wt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:c_}=yw,cm=Wt([{name:"a_packed",components:4,type:"Float32"}]),{members:Xc}=cm,Wv=nm.types,u_=Math.cos(Math.PI/180*37.5);class um{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new $i,this.layoutVertexArray2=new Di,this.indexArray=new Qr,this.programConfigurations=new ec(r.layers,r.zoom),this.segments=new _r,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,u,p){this.hasPattern=zv("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:A,id:P,index:O,sourceLayerIndex:B}of r){const z=this.layers[0]._featureFilter.needGeometry,$=Wc(A,z);if(!this.layers[0]._featureFilter.filter(new Se(this.zoom),$,u))continue;const Z=g?g.evaluate($,{},u):void 0,ie={id:P,properties:A.properties,type:A.type,sourceLayerIndex:B,index:O,geometry:z?$.geometry:rc(A,u,p),patterns:{},sortKey:Z};y.push(ie)}g&&y.sort((A,P)=>A.sortKey-P.sortKey);const{lineAtlas:x,featureIndex:E}=a,D=this.addConstantDashes(x);for(const A of y){const{geometry:P,index:O,sourceLayerIndex:B}=A;if(D&&this.addFeatureDashes(A,x),this.hasPattern){const z=Vv("line",this.layers,A,this.zoom,a);this.patternFeatures.push(z)}else this.addFeature(A,P,O,u,x.positions,a.availableImages);E.insert(r[O].feature,P,O,B,this.index)}}addConstantDashes(r){let a=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if("constant"!==p.kind||"constant"!==g.kind)a=!0;else{const y=g.value,x=p.value;if(!x)continue;r.addDash(x,y)}}return a}addFeatureDashes(r,a){const u=this.zoom;for(const p of this.layers){const g=p.paint.get("line-dasharray").value,y=p.layout.get("line-cap").value;if("constant"===g.kind&&"constant"===y.kind)continue;let x,E;if("constant"===g.kind){if(x=g.value,!x)continue}else x=g.evaluate({zoom:u},r);E="constant"===y.kind?y.value:y.evaluate({zoom:u},r),a.addDash(x,E),r.patterns[p.id]=a.getKey(x,E)}}update(r,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,u,p)}addFeatures(r,a,u,p,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,u,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,Xc)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,c_),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,u,p,g,y){const x=this.layers[0].layout,E=x.get("line-join").evaluate(r,{}),D=x.get("line-cap").evaluate(r,{}),A=x.get("line-miter-limit"),P=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const O of a)this.addLine(O,r,E,D,A,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,y,p)}addLine(r,a,u,p,g,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<r.length-1;ie++)this.totalDistance+=r[ie].dist(r[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x="Polygon"===Wv[a.type];let E=r.length;for(;E>=2&&r[E-1].equals(r[E-2]);)E--;let D=0;for(;D<E-1&&r[D].equals(r[D+1]);)D++;if(E<(x?3:2))return;"bevel"===u&&(g=1.05);const A=this.overscaling<=16?122880/(512*this.overscaling):0,P=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let O,B,z,$,Z;this.e1=this.e2=-1,x&&(O=r[E-2],Z=r[D].sub(O)._unit()._perp());for(let ie=D;ie<E;ie++){if(z=ie===E-1?x?r[D+1]:void 0:r[ie+1],z&&r[ie].equals(z))continue;Z&&($=Z),O&&(B=O),O=r[ie],Z=z?z.sub(O)._unit()._perp():$,$=$||Z;let he=$.add(Z);0===he.x&&0===he.y||he._unit();const ne=$.x*Z.x+$.y*Z.y,ce=he.x*Z.x+he.y*Z.y,_e=0!==ce?1/ce:1/0,de=2*Math.sqrt(2-2*ce),Oe=ce<u_&&B&&z,Pe=$.x*Z.y-$.y*Z.x>0;if(Oe&&ie>D){const Be=O.dist(B);if(Be>2*A){const Ye=O.sub(O.sub(B)._mult(A/Be)._round());this.updateDistance(B,Ye),this.addCurrentVertex(Ye,$,0,0,P),B=Ye}}const Ge=B&&z;let Ze=Ge?u:x?"butt":p;if(Ge&&"round"===Ze&&(_e<y?Ze="miter":_e<=2&&(Ze="fakeround")),"miter"===Ze&&_e>g&&(Ze="bevel"),"bevel"===Ze&&(_e>2&&(Ze="flipbevel"),_e<g&&(Ze="miter")),B&&this.updateDistance(B,O),"miter"===Ze)he._mult(_e),this.addCurrentVertex(O,he,0,0,P);else if("flipbevel"===Ze){if(_e>100)he=Z.mult(-1);else{const Be=_e*$.add(Z).mag()/$.sub(Z).mag();he._perp()._mult(Be*(Pe?-1:1))}this.addCurrentVertex(O,he,0,0,P),this.addCurrentVertex(O,he.mult(-1),0,0,P)}else if("bevel"===Ze||"fakeround"===Ze){const Be=-Math.sqrt(_e*_e-1),Ye=Pe?Be:0,et=Pe?0:Be;if(B&&this.addCurrentVertex(O,$,Ye,et,P),"fakeround"===Ze){const at=Math.round(180*de/Math.PI/20);for(let dt=1;dt<at;dt++){let Ue=dt/at;if(.5!==Ue){const Qt=Ue-.5;Ue+=Ue*Qt*(Ue-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*Qt*Qt+(.848013+ne*(.215638*ne-1.06021)))}const vt=Z.sub($)._mult(Ue)._add($)._unit()._mult(Pe?-1:1);this.addHalfVertex(O,vt.x,vt.y,!1,Pe,0,P)}}z&&this.addCurrentVertex(O,Z,-Ye,-et,P)}else if("butt"===Ze)this.addCurrentVertex(O,he,0,0,P);else if("square"===Ze){const Be=B?1:-1;B||this.addCurrentVertex(O,he,Be,Be,P),this.addCurrentVertex(O,he,0,0,P),B&&this.addCurrentVertex(O,he,Be,Be,P)}else"round"===Ze&&(B&&(this.addCurrentVertex(O,$,0,0,P),this.addCurrentVertex(O,$,1,1,P,!0)),z&&(this.addCurrentVertex(O,Z,-1,-1,P,!0),this.addCurrentVertex(O,Z,0,0,P)));if(Oe&&ie<E-1){const Be=O.dist(z);if(Be>2*A){const Ye=O.add(z.sub(O)._mult(A/Be)._round());this.updateDistance(O,Ye),this.addCurrentVertex(Ye,Z,0,0,P),O=Ye}}}}addCurrentVertex(r,a,u,p,g,y=!1){const x=a.y*p-a.x,E=-a.y-a.x*p;this.addHalfVertex(r,a.x+a.y*u,a.y-a.x*u,y,!1,u,g),this.addHalfVertex(r,x,E,y,!0,-p,g)}addHalfVertex({x:r,y:a},u,p,g,y,x,E){this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(a<<1)+(y?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(0===x?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),E.primitiveLength++),y?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}Ot(um,"LineBucket",{omit:["layers","patternFeatures"]});const vw=new ut({"line-cap":new Ve(qe.layout_line["line-cap"]),"line-join":new Ve(qe.layout_line["line-join"]),"line-miter-limit":new Me(qe.layout_line["line-miter-limit"]),"line-round-limit":new Me(qe.layout_line["line-round-limit"]),"line-sort-key":new Ve(qe.layout_line["line-sort-key"])});var d_={paint:new ut({"line-opacity":new Ve(qe.paint_line["line-opacity"]),"line-color":new Ve(qe.paint_line["line-color"]),"line-translate":new Me(qe.paint_line["line-translate"]),"line-translate-anchor":new Me(qe.paint_line["line-translate-anchor"]),"line-width":new Ve(qe.paint_line["line-width"]),"line-gap-width":new Ve(qe.paint_line["line-gap-width"]),"line-offset":new Ve(qe.paint_line["line-offset"]),"line-blur":new Ve(qe.paint_line["line-blur"]),"line-dasharray":new Ve(qe.paint_line["line-dasharray"]),"line-pattern":new Ve(qe.paint_line["line-pattern"]),"line-gradient":new st(qe.paint_line["line-gradient"]),"line-trim-offset":new Me(qe.paint_line["line-trim-offset"])}),layout:vw};const Dd=new class extends Ve{possiblyEvaluate(s,r){return r=new Se(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(s,r)}evaluate(s,r,a,u){return r=xn({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(s,r,a,u)}}(d_.paint.properties["line-width"].specification);function Zv(s,r){return r>0?r+2*s:s}Dd.useIntegerZoom=!0;const bw=Wt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),xw=Wt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),h_=Wt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Wt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ww=Wt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Yv=Wt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Wt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Xv=Wt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Kv=Wt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Wt([{name:"triangle",components:3,type:"Uint16"}]),Wt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Wt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Wt([{type:"Float32",name:"offsetX"}]),Wt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var jo=24;const lc=128;function Kc(s,r){const{expression:a}=r;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new Se(s+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:u,interpolationType:p}=a;let g=0;for(;g<u.length&&u[g]<=s;)g++;g=Math.max(0,g-1);let y=g;for(;y<u.length&&u[y]<s+1;)y++;y=Math.min(u.length-1,y);const x=u[g],E=u[y];return"composite"===a.kind?{kind:"composite",minZoom:x,maxZoom:E,interpolationType:p}:{kind:"camera",minZoom:x,maxZoom:E,minSize:a.evaluate(new Se(x)),maxSize:a.evaluate(new Se(E)),interpolationType:p}}}function dm(s,{uSize:r,uSizeT:a},{lowerSize:u,upperSize:p}){return"source"===s.kind?u/lc:"composite"===s.kind?zn(u/lc,p/lc,a):r}function El(s,r){let a=0,u=0;if("constant"===s.kind)u=s.layoutSize;else if("source"!==s.kind){const{interpolationType:p,minZoom:g,maxZoom:y}=s,x=p?gn(js.interpolationFactor(p,r,g,y),0,1):0;"camera"===s.kind?u=zn(s.minSize,s.maxSize,x):a=x}return{uSizeT:a,uSize:u}}var _i=Object.freeze({__proto__:null,getSizeData:Kc,evaluateSizeForFeature:dm,evaluateSizeForZoom:El,SIZE_PACK_FACTOR:lc});function Cw(s,r,a){return s.sections.forEach(u=>{u.text=function(p,g,y){const x=g.layout.get("text-transform").evaluate(y,{});return"uppercase"===x?p=p.toLocaleUpperCase():"lowercase"===x&&(p=p.toLocaleLowerCase()),we.applyArabicShaping&&(p=we.applyArabicShaping(p)),p}(u.text,r,a)}),s}const Qc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Jc(s){return"\ufe36"===s||"\ufe48"===s||"\ufe38"===s||"\ufe44"===s||"\ufe42"===s||"\ufe3e"===s||"\ufe3c"===s||"\ufe3a"===s||"\ufe18"===s||"\ufe40"===s||"\ufe10"===s||"\ufe13"===s||"\ufe14"===s||"\uff40"===s||"\uffe3"===s||"\ufe11"===s||"\ufe12"===s}function Ew(s){return"\ufe35"===s||"\ufe47"===s||"\ufe37"===s||"\ufe43"===s||"\ufe41"===s||"\ufe3d"===s||"\ufe3b"===s||"\ufe39"===s||"\ufe17"===s||"\ufe3f"===s}var Np=Ri,Bu=function(s,r,a,u,p){var g,y,x=8*p-u-1,E=(1<<x)-1,D=E>>1,A=-7,P=a?p-1:0,O=a?-1:1,B=s[r+P];for(P+=O,g=B&(1<<-A)-1,B>>=-A,A+=x;A>0;g=256*g+s[r+P],P+=O,A-=8);for(y=g&(1<<-A)-1,g>>=-A,A+=u;A>0;y=256*y+s[r+P],P+=O,A-=8);if(0===g)g=1-D;else{if(g===E)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,u),g-=D}return(B?-1:1)*y*Math.pow(2,g-u)},Qv=function(s,r,a,u,p,g){var y,x,E,D=8*g-p-1,A=(1<<D)-1,P=A>>1,O=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,B=u?0:g-1,z=u?1:-1,$=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,y=A):(y=Math.floor(Math.log(r)/Math.LN2),r*(E=Math.pow(2,-y))<1&&(y--,E*=2),(r+=y+P>=1?O/E:O*Math.pow(2,1-P))*E>=2&&(y++,E/=2),y+P>=A?(x=0,y=A):y+P>=1?(x=(r*E-1)*Math.pow(2,p),y+=P):(x=r*Math.pow(2,P-1)*Math.pow(2,p),y=0));p>=8;s[a+B]=255&x,B+=z,x/=256,p-=8);for(y=y<<p|x,D+=p;D>0;s[a+B]=255&y,B+=z,y/=256,D-=8);s[a+B-z]|=128*$};function Ri(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Ri.Varint=0,Ri.Fixed64=1,Ri.Bytes=2,Ri.Fixed32=5;var Bp=4294967296,Jv=1/Bp,hm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function fs(s){return s.type===Ri.Bytes?s.readVarint()+s.pos:s.pos+1}function eb(s,r,a){var u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(u);for(var p=a.pos-1;p>=s;p--)a.buf[p+u]=a.buf[p]}function Dw(s,r){for(var a=0;a<s.length;a++)r.writeVarint(s[a])}function Mw(s,r){for(var a=0;a<s.length;a++)r.writeSVarint(s[a])}function Sw(s,r){for(var a=0;a<s.length;a++)r.writeFloat(s[a])}function Tw(s,r){for(var a=0;a<s.length;a++)r.writeDouble(s[a])}function Aw(s,r){for(var a=0;a<s.length;a++)r.writeBoolean(s[a])}function Mh(s,r){for(var a=0;a<s.length;a++)r.writeFixed32(s[a])}function eu(s,r){for(var a=0;a<s.length;a++)r.writeSFixed32(s[a])}function Iw(s,r){for(var a=0;a<s.length;a++)r.writeFixed64(s[a])}function kw(s,r){for(var a=0;a<s.length;a++)r.writeSFixed64(s[a])}function p_(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function zp(s,r,a){s[a]=r,s[a+1]=r>>>8,s[a+2]=r>>>16,s[a+3]=r>>>24}function f_(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}function kD(s,r,a){r.glyphs=[],1===s&&a.readMessage(tb,r)}function tb(s,r,a){if(3===s){const{id:u,bitmap:p,width:g,height:y,left:x,top:E,advance:D}=a.readMessage(nb,{});r.glyphs.push({id:u,bitmap:new Za({width:g+6,height:y+6},p),metrics:{width:g,height:y,left:x,top:E,advance:D}})}else 4===s?r.ascender=a.readSVarint():5===s&&(r.descender=a.readSVarint())}function nb(s,r,a){1===s?r.id=a.readVarint():2===s?r.bitmap=a.readBytes():3===s?r.width=a.readVarint():4===s?r.height=a.readVarint():5===s?r.left=a.readSVarint():6===s?r.top=a.readSVarint():7===s&&(r.advance=a.readVarint())}function m_(s){let r=0,a=0;for(const y of s)r+=y.w*y.h,a=Math.max(a,y.w);s.sort((y,x)=>x.h-y.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let p=0,g=0;for(const y of s)for(let x=u.length-1;x>=0;x--){const E=u[x];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,g=Math.max(g,y.y+y.h),p=Math.max(p,y.x+y.w),y.w===E.w&&y.h===E.h){const D=u.pop();x<u.length&&(u[x]=D)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(u.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:p,h:g,fill:r/(p*g)||0}}Ri.prototype={destroy:function(){this.buf=null},readFields:function(s,r,a){for(a=a||this.length;this.pos<a;){var u=this.readVarint(),p=u>>3,g=this.pos;this.type=7&u,s(p,r,this),this.pos===g&&this.skip(u)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=p_(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=f_(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=p_(this.buf,this.pos)+p_(this.buf,this.pos+4)*Bp;return this.pos+=8,s},readSFixed64:function(){var s=p_(this.buf,this.pos)+f_(this.buf,this.pos+4)*Bp;return this.pos+=8,s},readFloat:function(){var s=Bu(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Bu(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,a,u=this.buf;return r=127&(a=u[this.pos++]),a<128?r:(r|=(127&(a=u[this.pos++]))<<7,a<128?r:(r|=(127&(a=u[this.pos++]))<<14,a<128?r:(r|=(127&(a=u[this.pos++]))<<21,a<128?r:function(p,g,y){var x,E,D=y.buf;if(x=(112&(E=D[y.pos++]))>>4,E<128||(x|=(127&(E=D[y.pos++]))<<3,E<128)||(x|=(127&(E=D[y.pos++]))<<10,E<128)||(x|=(127&(E=D[y.pos++]))<<17,E<128)||(x|=(127&(E=D[y.pos++]))<<24,E<128)||(x|=(1&(E=D[y.pos++]))<<31,E<128))return function Dh(s,r,a){return a?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}(p,x,g);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=u[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&hm?hm.decode(this.buf.subarray(r,s)):function(a,u,p){for(var g="",y=u;y<p;){var x,E,D,A=a[y],P=null,O=A>239?4:A>223?3:A>191?2:1;if(y+O>p)break;1===O?A<128&&(P=A):2===O?128==(192&(x=a[y+1]))&&(P=(31&A)<<6|63&x)<=127&&(P=null):3===O?(E=a[y+2],128==(192&(x=a[y+1]))&&128==(192&E)&&((P=(15&A)<<12|(63&x)<<6|63&E)<=2047||P>=55296&&P<=57343)&&(P=null)):4===O&&(E=a[y+2],D=a[y+3],128==(192&(x=a[y+1]))&&128==(192&E)&&128==(192&D)&&((P=(15&A)<<18|(63&x)<<12|(63&E)<<6|63&D)<=65535||P>=1114112)&&(P=null)),null===P?(P=65533,O=1):P>65535&&(P-=65536,g+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),g+=String.fromCharCode(P),y+=O}return g}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==Ri.Bytes)return s.push(this.readVarint(r));var a=fs(this);for(s=s||[];this.pos<a;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==Ri.Bytes)return s.push(this.readSVarint());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Ri.Bytes)return s.push(this.readBoolean());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Ri.Bytes)return s.push(this.readFloat());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Ri.Bytes)return s.push(this.readDouble());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Ri.Bytes)return s.push(this.readFixed32());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Ri.Bytes)return s.push(this.readSFixed32());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Ri.Bytes)return s.push(this.readFixed64());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Ri.Bytes)return s.push(this.readSFixed64());var r=fs(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===Ri.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ri.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ri.Fixed32)this.pos+=4;else{if(r!==Ri.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),zp(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),zp(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),zp(this.buf,-1&s,this.pos),zp(this.buf,Math.floor(s*Jv),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),zp(this.buf,-1&s,this.pos),zp(this.buf,Math.floor(s*Jv),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,a){var u,p,g,x;if(r>=0?(u=r%4294967296|0,p=r/4294967296|0):(p=~(-r/4294967296),4294967295^(u=~(-r%4294967296))?u=u+1|0:(u=0,p=p+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),g=u,(x=a).buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,x.buf[x.pos]=127&(g>>>=7),function(g,y){var x=(7&g)<<4;y.buf[y.pos++]|=x|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))}(p,a)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(Boolean(s))},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(u,p,g){for(var y,x,E=0;E<p.length;E++){if((y=p.charCodeAt(E))>55295&&y<57344){if(!x){y>56319||E+1===p.length?(u[g++]=239,u[g++]=191,u[g++]=189):x=y;continue}if(y<56320){u[g++]=239,u[g++]=191,u[g++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(u[g++]=239,u[g++]=191,u[g++]=189,x=null);y<128?u[g++]=y:(y<2048?u[g++]=y>>6|192:(y<65536?u[g++]=y>>12|224:(u[g++]=y>>18|240,u[g++]=y>>12&63|128),u[g++]=y>>6&63|128),u[g++]=63&y|128)}return g}(this.buf,s,this.pos);var a=this.pos-r;a>=128&&eb(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(s){this.realloc(4),Qv(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Qv(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=s[a]},writeRawMessage:function(s,r){this.pos++;var a=this.pos;s(r,this);var u=this.pos-a;u>=128&&eb(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeMessage:function(s,r,a){this.writeTag(s,Ri.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,Dw,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,Mw,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,Aw,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,Sw,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,Tw,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,Mh,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,eu,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,Iw,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,kw,r)},writeBytesField:function(s,r){this.writeTag(s,Ri.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,Ri.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,Ri.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,Ri.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,Ri.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,Ri.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,Ri.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,Ri.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,Ri.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,Ri.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,Boolean(r))}};class pm{constructor(r,{pixelRatio:a,version:u,stretchX:p,stretchY:g,content:y}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=p,this.stretchY=g,this.content=y,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ib{constructor(r,a){const u={},p={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,u,g),this.addImages(a,p,g);const{w:y,h:x}=m_(g),E=new ps({width:y||1,height:x||1});for(const D in r){const A=r[D],P=u[D].paddedRect;ps.copy(A.data,E,{x:0,y:0},{x:P.x+1,y:P.y+1},A.data)}for(const D in a){const A=a[D],P=p[D].paddedRect,O=P.x+1,B=P.y+1,z=A.data.width,$=A.data.height;ps.copy(A.data,E,{x:0,y:0},{x:O,y:B},A.data),ps.copy(A.data,E,{x:0,y:$-1},{x:O,y:B-1},{width:z,height:1}),ps.copy(A.data,E,{x:0,y:0},{x:O,y:B+$},{width:z,height:1}),ps.copy(A.data,E,{x:z-1,y:0},{x:O-1,y:B},{width:1,height:$}),ps.copy(A.data,E,{x:0,y:0},{x:O+z,y:B},{width:1,height:$})}this.image=E,this.iconPositions=u,this.patternPositions=p}addImages(r,a,u){for(const p in r){const g=r[p],y={x:0,y:0,w:g.data.width+2,h:g.data.height+2};u.push(y),a[p]=new pm(y,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(r,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>r.hasImage(u)),r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in r.updatedImages)this.patchUpdatedImage(this.iconPositions[u],r.getImage(u),a),this.patchUpdatedImage(this.patternPositions[u],r.getImage(u),a)}patchUpdatedImage(r,a,u){if(!r||!a||r.version===a.version)return;r.version=a.version;const[p,g]=r.tl;u.update(a.data,void 0,{x:p,y:g})}}Ot(pm,"ImagePosition"),Ot(ib,"ImageAtlas");const ca={horizontal:1,vertical:2,horizontalOnly:3};class Ss{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const u=new Ss;return u.scale=r||1,u.fontStack=a,u}static forImage(r){const a=new Ss;return a.imageName=r,a}}class Sh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const u=new Sh;for(let p=0;p<r.sections.length;p++){const g=r.sections[p];g.image?u.addImageSection(g):u.addTextSection(g,a)}return u}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=function(a,u){let p="";for(let g=0;g<a.length;g++){const y=a.charCodeAt(g+1)||null,x=a.charCodeAt(g-1)||null;p+=!u&&(y&&I(y)&&!Qc[a[g+1]]||x&&I(x)&&!Qc[a[g-1]])||!Qc[a[g]]?a[g]:Qc[a[g]]}return p}(this.text,r)}trim(){let r=0;for(let u=0;u<this.text.length&&mm[this.text.charCodeAt(u)];u++)r++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&mm[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const u=new Sh;return u.text=this.text.substring(r,a),u.sectionIndex=this.sectionIndex.slice(r,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,a)=>Math.max(r,this.sections[a].scale),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(Ss.forText(r.scale,r.fontStack||a));const u=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(u)}addImageSection(r){const a=r.image?r.image.name:"";if(0===a.length)return void ei("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Ss.forImage(a)),this.sectionIndex.push(this.sections.length-1)):ei("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fm(s,r,a,u,p,g,y,x,E,D,A,P,O,B,z){const $=Sh.fromFeature(s,p);P===ca.vertical&&$.verticalizePunctuation(O);let Z=[];const ie=function(de,Oe,Pe,Ge,Ze,Be){if(!de)return[];const Ye=[],et=function(vt,Qt,Dt,Bt,Ct,ln){let Hn=0;for(let Vn=0;Vn<vt.length();Vn++){const Ln=vt.getSection(Vn);Hn+=rb(vt.getCharCode(Vn),Ln,Bt,Ct,Qt,ln)}return Hn/Math.max(1,Math.ceil(Hn/Dt))}(de,Oe,Pe,Ge,Ze,Be),at=de.text.indexOf("\u200b")>=0;let dt=0;for(let vt=0;vt<de.length();vt++){const Qt=de.getSection(vt),Dt=de.getCharCode(vt);if(mm[Dt]||(dt+=rb(Dt,Qt,Ge,Ze,Oe,Be)),vt<de.length()-1){const Bt=!((Ue=Dt)<11904||!(rh(Ue)||Au(Ue)||m(Ue)||mp(Ue)||Mo(Ue)||uo(Ue)||kf(Ue)||Tu(Ue)||Fa(Ue)||oh(Ue)||fp(Ue)||_(Ue)||Kl(Ue)||Nr(Ue)||Kr(Ue)||Pf(Ue)||zo(Ue)||fd(Ue)||Oa(Ue)||$c(Ue)));(Pw[Dt]||Bt||Qt.imageName)&&Ye.push(ab(vt+1,dt,et,Ye,sb(Dt,de.getCharCode(vt+1),Bt&&at),!1))}}var Ue;return lb(ab(de.length(),dt,et,Ye,0,!0))}($,D,g,r,u,B),{processBidirectionalText:he,processStyledBidirectionalText:ne}=we;if(he&&1===$.sections.length){const de=he($.toString(),ie);for(const Oe of de){const Pe=new Sh;Pe.text=Oe,Pe.sections=$.sections;for(let Ge=0;Ge<Oe.length;Ge++)Pe.sectionIndex.push(0);Z.push(Pe)}}else if(ne){const de=ne($.text,$.sectionIndex,ie);for(const Oe of de){const Pe=new Sh;Pe.text=Oe[0],Pe.sectionIndex=Oe[1],Pe.sections=$.sections,Z.push(Pe)}}else Z=function(de,Oe){const Pe=[],Ge=de.text;let Ze=0;for(const Be of Oe)Pe.push(de.substring(Ze,Be)),Ze=Be;return Ze<Ge.length&&Pe.push(de.substring(Ze,Ge.length)),Pe}($,ie);const ce=[],_e={positionedLines:ce,text:$.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(de,Oe,Pe,Ge,Ze,Be,Ye,et,at,dt,Ue,vt){let Qt=0,Dt=0,Bt=0;const Ct="right"===et?1:"left"===et?0:.5;let ln=!1;for(const vn of Ze){const Wn=vn.getSections();for(const Fi of Wn){if(Fi.imageName)continue;const $t=Oe[Fi.fontStack];if($t&&(ln=void 0!==$t.ascender&&void 0!==$t.descender,!ln))break}if(!ln)break}let Hn=0;for(const vn of Ze){vn.trim();const Wn=vn.getMaxScale(),Fi=(Wn-1)*jo,$t={positionedGlyphs:[],lineOffset:0};de.positionedLines[Hn]=$t;const Hi=$t.positionedGlyphs;let Ii=0;if(!vn.length()){Dt+=Be,++Hn;continue}let ht=0,nr=0;for(let pe=0;pe<vn.length();pe++){const xe=vn.getSection(pe),It=vn.getSectionIndex(pe),hi=vn.getCharCode(pe);let Ji=xe.scale,Sr=null,ki=null,Xi=null,Ur=jo,no=0;const jr=!(at===ca.horizontal||!Ue&&!T(hi)||Ue&&(mm[hi]||(Vn=hi,pd(Vn)||ft(Vn)||ui(Vn)||sh(Vn)||d(Vn))));if(xe.imageName){const mn=Ge[xe.imageName];if(!mn)continue;Xi=xe.imageName,de.iconsInText=de.iconsInText||!0,ki=mn.paddedRect;const $r=mn.displaySize;Ji=Ji*jo/vt,Sr={width:$r[0],height:$r[1],left:1,top:-3,advance:jr?$r[1]:$r[0],localGlyph:!1},no=ln?-Sr.height*Ji:Wn*jo-17-$r[1]*Ji,Ur=Sr.advance;const ou=(jr?$r[0]:$r[1])*Ji-jo*Wn;ou>0&&ou>Ii&&(Ii=ou)}else{const mn=Pe[xe.fontStack];if(!mn)continue;mn[hi]&&(ki=mn[hi]);const $r=Oe[xe.fontStack];if(!$r)continue;const ou=$r.glyphs[hi];if(!ou)continue;if(Sr=ou.metrics,Ur=8203!==hi?jo:0,ln){const Td=void 0!==$r.ascender?Math.abs($r.ascender):0,Oh=void 0!==$r.descender?Math.abs($r.descender):0,Lh=(Td+Oh)*Ji;ht<Lh&&(ht=Lh,nr=(Td-Oh)/2*Ji),no=-Td*Ji}else no=(Wn-Ji)*jo-17}jr?(de.verticalizable=!0,Hi.push({glyph:hi,imageName:Xi,x:Qt,y:Dt+no,vertical:jr,scale:Ji,localGlyph:Sr.localGlyph,fontStack:xe.fontStack,sectionIndex:It,metrics:Sr,rect:ki}),Qt+=Ur*Ji+dt):(Hi.push({glyph:hi,imageName:Xi,x:Qt,y:Dt+no,vertical:jr,scale:Ji,localGlyph:Sr.localGlyph,fontStack:xe.fontStack,sectionIndex:It,metrics:Sr,rect:ki}),Qt+=Sr.advance*Ji+dt)}0!==Hi.length&&(Bt=Math.max(Qt-dt,Bt),ln?$n(Hi,Ct,Ii,nr,Be*Wn/2):$n(Hi,Ct,Ii,0,Be/2)),Qt=0;const fo=Be*Wn+Ii;$t.lineOffset=Math.max(Ii,Fi),Dt+=fo,++Hn}var Vn;const Ln=Dt,{horizontalAlign:cn,verticalAlign:Mi}=g_(Ye);(function(vn,Wn,Fi,$t,Hi,Ii){const ht=(Wn-Fi)*Hi,nr=-Ii*$t;for(const fo of vn)for(const pe of fo.positionedGlyphs)pe.x+=ht,pe.y+=nr})(de.positionedLines,Ct,cn,Mi,Bt,Ln),de.top+=-Mi*Ln,de.bottom=de.top+Ln,de.left+=-cn*Bt,de.right=de.left+Bt,de.hasBaseline=ln}(_e,r,a,u,Z,y,x,E,P,D,O,z),!function(de){for(const Oe of de)if(0!==Oe.positionedGlyphs.length)return!1;return!0}(ce)&&_e}const mm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Pw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function rb(s,r,a,u,p,g){if(r.imageName){const y=u[r.imageName];return y?y.displaySize[0]*r.scale*jo/g+p:0}{const y=a[r.fontStack],x=y&&y.glyphs[s];return x?x.metrics.advance*r.scale+p:0}}function ob(s,r,a,u){const p=Math.pow(s-r,2);return u?s<r?p/2:2*p:p+Math.abs(a)*a}function sb(s,r,a){let u=0;return 10===s&&(u-=1e4),a&&(u+=150),40!==s&&65288!==s||(u+=50),41!==r&&65289!==r||(u+=50),u}function ab(s,r,a,u,p,g){let y=null,x=ob(r,a,p,g);for(const E of u){const D=ob(r-E.x,a,p,g)+E.badness;D<=x&&(y=E,x=D)}return{index:s,x:r,priorBreak:y,badness:x}}function lb(s){return s?lb(s.priorBreak).concat(s.index):[]}function g_(s){let r=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function $n(s,r,a,u,p){if(!(r||a||u||p))return;const g=s.length-1,y=s[g],x=(y.x+y.metrics.advance*y.scale)*r;for(let E=0;E<=g;E++)s[E].x-=x,s[E].y+=a+u+p}function Et(s,r,a){const{horizontalAlign:u,verticalAlign:p}=g_(a),g=r[0]-s.displaySize[0]*u,y=r[1]-s.displaySize[1]*p;return{image:s,top:y,bottom:y+s.displaySize[1],left:g,right:g+s.displaySize[0]}}function __(s,r,a,u,p,g){const y=s.image;let x;if(y.content){const Z=y.content,ie=y.pixelRatio||1;x=[Z[0]/ie,Z[1]/ie,y.displaySize[0]-Z[2]/ie,y.displaySize[1]-Z[3]/ie]}const E=r.left*g,D=r.right*g;let A,P,O,B;"width"===a||"both"===a?(B=p[0]+E-u[3],P=p[0]+D+u[1]):(B=p[0]+(E+D-y.displaySize[0])/2,P=B+y.displaySize[0]);const z=r.top*g,$=r.bottom*g;return"height"===a||"both"===a?(A=p[1]+z-u[0],O=p[1]+$+u[2]):(A=p[1]+(z+$-y.displaySize[1])/2,O=A+y.displaySize[1]),{image:y,top:A,right:P,bottom:O,left:B,collisionPadding:x}}class cc extends it{constructor(r,a,u,p,g){super(r,a),this.angle=p,this.z=u,void 0!==g&&(this.segment=g)}clone(){return new cc(this.x,this.y,this.z,this.angle,this.segment)}}function cb(s,r,a,u,p){if(void 0===r.segment)return!0;let g=r,y=r.segment+1,x=0;for(;x>-a/2;){if(y--,y<0)return!1;x-=s[y].dist(g),g=s[y]}x+=s[y].dist(s[y+1]),y++;const E=[];let D=0;for(;x<a/2;){const A=s[y],P=s[y+1];if(!P)return!1;let O=s[y-1].angleTo(A)-A.angleTo(P);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:x,angleDelta:O}),D+=O;x-E[0].distance>u;)D-=E.shift().angleDelta;if(D>p)return!1;y++,x+=A.dist(P)}return!0}function ub(s){let r=0;for(let a=0;a<s.length-1;a++)r+=s[a].dist(s[a+1]);return r}function y_(s,r,a){return s?.6*r*a:0}function db(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function hb(s,r,a,u,p,g){const y=y_(a,p,g),x=db(a,u)*g;let E=0;const D=ub(s)/2;for(let A=0;A<s.length-1;A++){const P=s[A],O=s[A+1],B=P.dist(O);if(E+B>D){const z=(D-E)/B,$=zn(P.x,O.x,z),Z=zn(P.y,O.y,z),ie=new cc($,Z,0,O.angleTo(P),A);return!y||cb(s,ie,x,y,r)?ie:void 0}E+=B}}function Rw(s,r,a,u,p,g,y,x,E){const D=y_(u,g,y),A=db(u,p),P=A*y,O=0===s[0].x||s[0].x===E||0===s[0].y||s[0].y===E;return r-P<r/4&&(r=P+r/4),pb(s,O?r/2*x%r:(A/2+2*g)*y*x%r,r,D,a,P,O,!1,E)}function pb(s,r,a,u,p,g,y,x,E){const D=g/2,A=ub(s);let P=0,O=r-a,B=[];for(let z=0;z<s.length-1;z++){const $=s[z],Z=s[z+1],ie=$.dist(Z),he=Z.angleTo($);for(;O+a<P+ie;){O+=a;const ne=(O-P)/ie,ce=zn($.x,Z.x,ne),_e=zn($.y,Z.y,ne);if(ce>=0&&ce<E&&_e>=0&&_e<E&&O-D>=0&&O+D<=A){const de=new cc(ce,_e,0,he,z);de._round(),u&&!cb(s,de,g,u,p)||B.push(de)}}P+=ie}return x||B.length||y||(B=pb(s,P/2,a,u,p,g,y,!0,E)),B}function Fw(s,r,a,u,p){const g=[];for(let y=0;y<s.length;y++){const x=s[y];let E;for(let D=0;D<x.length-1;D++){let A=x[D],P=x[D+1];A.x<r&&P.x<r||(A.x<r?A=new it(r,A.y+(r-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x<r&&(P=new it(r,A.y+(r-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y<a&&P.y<a||(A.y<a?A=new it(A.x+(a-A.y)/(P.y-A.y)*(P.x-A.x),a)._round():P.y<a&&(P=new it(A.x+(a-A.y)/(P.y-A.y)*(P.x-A.x),a)._round()),A.x>=u&&P.x>=u||(A.x>=u?A=new it(u,A.y+(u-A.x)/(P.x-A.x)*(P.y-A.y))._round():P.x>=u&&(P=new it(u,A.y+(u-A.x)/(P.x-A.x)*(P.y-A.y))._round()),A.y>=p&&P.y>=p||(A.y>=p?A=new it(A.x+(p-A.y)/(P.y-A.y)*(P.x-A.x),p)._round():P.y>=p&&(P=new it(A.x+(p-A.y)/(P.y-A.y)*(P.x-A.x),p)._round()),E&&A.equals(E[E.length-1])||(E=[A],g.push(E)),E.push(P)))))}}return g}Ot(cc,"Anchor");const Th=1e20;function v_(s,r,a,u,p,g,y,x,E){for(let D=r;D<r+u;D++)Ts(s,a*g+D,g,p,y,x,E);for(let D=a;D<a+p;D++)Ts(s,D*g+r,1,u,y,x,E)}function Ts(s,r,a,u,p,g,y){g[0]=0,y[0]=-Th,y[1]=Th,p[0]=s[r];for(let x=1,E=0,D=0;x<u;x++){p[x]=s[r+x*a];const A=x*x;do{const P=g[E];D=(p[x]-p[P]+A-P*P)/(x-P)/2}while(D<=y[E]&&--E>-1);E++,g[E]=x,y[E]=D,y[E+1]=Th}for(let x=0,E=0;x<u;x++){for(;y[E+1]<x;)E++;const D=g[E],A=x-D;s[r+x*a]=p[D]+A*A}}const b_={none:0,ideographs:1,all:2};class zu{constructor(r,a,u){this.requestManager=r,this.localGlyphMode=a,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,a){const u=[];for(const p in r)for(const g of r[p])u.push({stack:p,id:g});vo(u,({stack:p,id:g},y)=>{let x=this.entries[p];x||(x=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=x.glyphs[g];if(void 0!==E)return void y(null,{stack:p,id:g,glyph:E});if(E=this._tinySDF(x,p,g),E)return x.glyphs[g]=E,void y(null,{stack:p,id:g,glyph:E});const D=Math.floor(g/256);if(256*D>65535)return void y(new Error("glyphs > 65535 not supported"));if(x.ranges[D])return void y(null,{stack:p,id:g,glyph:E});let A=x.requests[D];A||(A=x.requests[D]=[],zu.loadGlyphRange(p,D,this.url,this.requestManager,(P,O)=>{if(O){x.ascender=O.ascender,x.descender=O.descender;for(const B in O.glyphs)this._doesCharSupportLocalGlyph(+B)||(x.glyphs[+B]=O.glyphs[+B]);x.ranges[D]=!0}for(const B of A)B(P,O);delete x.requests[D]})),A.push((P,O)=>{P?y(P):O&&y(null,{stack:p,id:g,glyph:O.glyphs[g]||null})})},(p,g)=>{if(p)a(p);else if(g){const y={};for(const{stack:x,id:E,glyph:D}of g)void 0===y[x]&&(y[x]={}),void 0===y[x].glyphs&&(y[x].glyphs={}),y[x].glyphs[E]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},y[x].ascender=this.entries[x].ascender,y[x].descender=this.entries[x].descender;a(null,y)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==b_.none&&(this.localGlyphMode===b_.all?!!this.localFontFamily:!!this.localFontFamily&&(oh(r)||Rf(r)||Kl(r)||zo(r)||Tu(r)))}_tinySDF(r,a,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=r.tinySDF;if(!g){let $="400";/bold/i.test(a)?$="900":/medium/i.test(a)?$="500":/light/i.test(a)&&($="200"),g=r.tinySDF=new zu.TinySDF({fontFamily:p,fontWeight:$,fontSize:48,buffer:6,radius:16}),g.fontWeight=$}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const y=String.fromCharCode(u),{data:x,width:E,height:D,glyphWidth:A,glyphHeight:P,glyphLeft:O,glyphTop:B,glyphAdvance:z}=g.draw(y);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new Za({width:E,height:D},x),metrics:{width:A/2,height:P/2,left:O/2,top:B/2-27,advance:z/2,localGlyph:!0}}}}function gm(s,r,a,u){const p=[],g=s.image,y=g.pixelRatio,x=g.paddedRect.w-2,E=g.paddedRect.h-2,D=s.right-s.left,A=s.bottom-s.top,P=g.stretchX||[[0,x]],O=g.stretchY||[[0,E]],B=(Be,Ye)=>Be+Ye[1]-Ye[0],z=P.reduce(B,0),$=O.reduce(B,0),Z=x-z,ie=E-$;let he=0,ne=z,ce=0,_e=$,de=0,Oe=Z,Pe=0,Ge=ie;if(g.content&&u){const Be=g.content;he=_m(P,0,Be[0]),ce=_m(O,0,Be[1]),ne=_m(P,Be[0],Be[2]),_e=_m(O,Be[1],Be[3]),de=Be[0]-he,Pe=Be[1]-ce,Oe=Be[2]-Be[0]-ne,Ge=Be[3]-Be[1]-_e}const Ze=(Be,Ye,et,at)=>{const dt=x_(Be.stretch-he,ne,D,s.left),Ue=w_(Be.fixed-de,Oe,Be.stretch,z),vt=x_(Ye.stretch-ce,_e,A,s.top),Qt=w_(Ye.fixed-Pe,Ge,Ye.stretch,$),Dt=x_(et.stretch-he,ne,D,s.left),Bt=w_(et.fixed-de,Oe,et.stretch,z),Ct=x_(at.stretch-ce,_e,A,s.top),ln=w_(at.fixed-Pe,Ge,at.stretch,$),Hn=new it(dt,vt),Vn=new it(Dt,vt),Ln=new it(Dt,Ct),cn=new it(dt,Ct),Mi=new it(Ue/y,Qt/y),vn=new it(Bt/y,ln/y),Wn=r*Math.PI/180;if(Wn){const Hi=Math.sin(Wn),Ii=Math.cos(Wn),ht=[Ii,-Hi,Hi,Ii];Hn._matMult(ht),Vn._matMult(ht),cn._matMult(ht),Ln._matMult(ht)}const Fi=Be.stretch+Be.fixed,$t=Ye.stretch+Ye.fixed;return{tl:Hn,tr:Vn,bl:cn,br:Ln,tex:{x:g.paddedRect.x+1+Fi,y:g.paddedRect.y+1+$t,w:et.stretch+et.fixed-Fi,h:at.stretch+at.fixed-$t},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Mi,pixelOffsetBR:vn,minFontScaleX:Oe/y/D,minFontScaleY:Ge/y/A,isSDF:a}};if(u&&(g.stretchX||g.stretchY)){const Be=Ow(P,Z,z),Ye=Ow(O,ie,$);for(let et=0;et<Be.length-1;et++){const at=Be[et],dt=Be[et+1];for(let Ue=0;Ue<Ye.length-1;Ue++)p.push(Ze(at,Ye[Ue],dt,Ye[Ue+1]))}}else p.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:E+1}));return p}function _m(s,r,a){let u=0;for(const p of s)u+=Math.max(r,Math.min(a,p[1]))-Math.max(r,Math.min(a,p[0]));return u}function Ow(s,r,a){const u=[{fixed:-1,stretch:0}];for(const[p,g]of s){const y=u[u.length-1];u.push({fixed:p-y.stretch,stretch:y.stretch}),u.push({fixed:p-y.stretch,stretch:y.stretch+(g-p)})}return u.push({fixed:r+1,stretch:a}),u}function x_(s,r,a,u){return s/r*a+u}function w_(s,r,a,u){return s-r*a/u}function Lw(s,r,a,u){const p=r+s.positionedLines[u].lineOffset;return 0===u?a+p/2:a+(p+(r+s.positionedLines[u-1].lineOffset))/2}zu.loadGlyphRange=function(s,r,a,u,p){const g=256*r,y=g+255,x=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",s).replace("{range}",`${g}-${y}`),xc.Glyphs);sl(x,(E,D)=>{if(E)p(E);else if(D){const A={},P=new Np(D).readFields(kD,{});for(const O of P.glyphs)A[O.id]=O;p(null,{glyphs:A,ascender:P.ascender,descender:P.descender})}})},zu.TinySDF=class{constructor({fontSize:s=24,buffer:r=3,radius:a=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:y="normal"}={}){this.buffer=r,this.cutoff=u,this.radius=a;const x=this.size=s+4*r,E=this._createCanvas(x),D=this.ctx=E.getContext("2d",{willReadFrequently:!0});D.font=`${y} ${g} ${s}px ${p}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(s){const r=document.createElement("canvas");return r.width=r.height=s,r}draw(s){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(s),y=Math.ceil(a),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-p))),E=Math.min(this.size-this.buffer,y+Math.ceil(u)),D=x+2*this.buffer,A=E+2*this.buffer,P=Math.max(D*A,0),O=new Uint8ClampedArray(P),B={data:O,width:D,height:A,glyphWidth:x,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:r};if(0===x||0===E)return B;const{ctx:z,buffer:$,gridInner:Z,gridOuter:ie}=this;z.clearRect($,$,x,E),z.fillText(s,$,$+y);const he=z.getImageData($,$,x,E);ie.fill(Th,0,P),Z.fill(0,0,P);for(let ne=0;ne<E;ne++)for(let ce=0;ce<x;ce++){const _e=he.data[4*(ne*x+ce)+3]/255;if(0===_e)continue;const de=(ne+$)*D+ce+$;if(1===_e)ie[de]=0,Z[de]=Th;else{const Oe=.5-_e;ie[de]=Oe>0?Oe*Oe:0,Z[de]=Oe<0?Oe*Oe:0}}v_(ie,0,0,D,A,D,this.f,this.v,this.z),v_(Z,$,$,x,E,D,this.f,this.v,this.z);for(let ne=0;ne<P;ne++){const ce=Math.sqrt(ie[ne])-Math.sqrt(Z[ne]);O[ne]=Math.round(255-255*(ce/this.radius+this.cutoff))}return B}};class fb{constructor(r=[],a=PD){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:u}=this,p=a[r];for(;r>0;){const g=r-1>>1,y=a[g];if(u(p,y)>=0)break;a[r]=y,r=g}a[r]=p}_down(r){const{data:a,compare:u}=this,p=this.length>>1,g=a[r];for(;r<p;){let y=1+(r<<1),x=a[y];const E=y+1;if(E<this.length&&u(a[E],x)<0&&(y=E,x=a[E]),u(x,g)>=0)break;a[r]=x,r=y}a[r]=g}}function PD(s,r){return s<r?-1:s>r?1:0}function Nw(s,r=1,a=!1){let u=1/0,p=1/0,g=-1/0,y=-1/0;const x=s[0];for(let B=0;B<x.length;B++){const z=x[B];(!B||z.x<u)&&(u=z.x),(!B||z.y<p)&&(p=z.y),(!B||z.x>g)&&(g=z.x),(!B||z.y>y)&&(y=z.y)}const E=Math.min(g-u,y-p);let D=E/2;const A=new fb([],Ah);if(0===E)return new it(u,p);for(let B=u;B<g;B+=E)for(let z=p;z<y;z+=E)A.push(new Ih(B+D,z+D,D,s));let P=function(B){let z=0,$=0,Z=0;const ie=B[0];for(let he=0,ne=ie.length,ce=ne-1;he<ne;ce=he++){const _e=ie[he],de=ie[ce],Oe=_e.x*de.y-de.x*_e.y;$+=(_e.x+de.x)*Oe,Z+=(_e.y+de.y)*Oe,z+=3*Oe}return new Ih($/z,Z/z,0,B)}(s),O=A.length;for(;A.length;){const B=A.pop();(B.d>P.d||!P.d)&&(P=B,a&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,O)),B.max-P.d<=r||(D=B.h/2,A.push(new Ih(B.p.x-D,B.p.y-D,D,s)),A.push(new Ih(B.p.x+D,B.p.y-D,D,s)),A.push(new Ih(B.p.x-D,B.p.y+D,D,s)),A.push(new Ih(B.p.x+D,B.p.y+D,D,s)),O+=4)}return a&&(console.log(`num probes: ${O}`),console.log(`best distance: ${P.d}`)),P.p}function Ah(s,r){return r.max-s.max}class Ih{constructor(r,a,u,p){this.p=new it(r,a),this.h=u,this.d=function(g,y){let x=!1,E=1/0;for(let D=0;D<y.length;D++){const A=y[D];for(let P=0,O=A.length,B=O-1;P<O;B=P++){const z=A[P],$=A[B];z.y>g.y!=$.y>g.y&&g.x<($.x-z.x)*(g.y-z.y)/($.y-z.y)+z.x&&(x=!x),E=Math.min(E,Sv(g,z,$))}}return(x?1:-1)*Math.sqrt(E)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const ym=Number.POSITIVE_INFINITY,vm=Math.sqrt(2);function mb(s,[r,a]){let u=0,p=0;if(a===ym){r<0&&(r=0);const g=r/vm;switch(s){case"top-right":case"top-left":p=g-7;break;case"bottom-right":case"bottom-left":p=7-g;break;case"bottom":p=7-r;break;case"top":p=r-7}switch(s){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=r;break;case"right":u=-r}}else{switch(r=Math.abs(r),a=Math.abs(a),s){case"top-right":case"top-left":case"top":p=a-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-a}switch(s){case"top-right":case"bottom-right":case"right":u=-r;break;case"top-left":case"bottom-left":case"left":u=r}}return[u,p]}function gb(s,r,a,u,p,g,y,x,E,D){s.createArrays(),s.tilePixelRatio=fn/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const A=s.layers[0].layout,P=s.layers[0]._unevaluatedLayout._values,O={};if("composite"===s.textSizeData.kind){const{minZoom:$,maxZoom:Z}=s.textSizeData;O.compositeTextSizes=[P["text-size"].possiblyEvaluate(new Se($),x),P["text-size"].possiblyEvaluate(new Se(Z),x)]}if("composite"===s.iconSizeData.kind){const{minZoom:$,maxZoom:Z}=s.iconSizeData;O.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new Se($),x),P["icon-size"].possiblyEvaluate(new Se(Z),x)]}O.layoutTextSize=P["text-size"].possiblyEvaluate(new Se(E+1),x),O.layoutIconSize=P["icon-size"].possiblyEvaluate(new Se(E+1),x),O.textMaxSize=P["text-size"].possiblyEvaluate(new Se(18),x);const B="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),z=A.get("text-size");for(const $ of s.features){const Z=A.get("text-font").evaluate($,{},x).join(","),ie=z.evaluate($,{},x),he=O.layoutTextSize.evaluate($,{},x),ne=(O.layoutIconSize.evaluate($,{},x),{horizontal:{},vertical:void 0}),ce=$.text;let _e,de=[0,0];if(ce){const Ge=ce.toString(),Ze=A.get("text-letter-spacing").evaluate($,{},x)*jo,Be=A.get("text-line-height").evaluate($,{},x)*jo,Ye=w(Ge)?Ze:0,et=A.get("text-anchor").evaluate($,{},x),at=A.get("text-variable-anchor");if(!at){const Dt=A.get("text-radial-offset").evaluate($,{},x);de=Dt?mb(et,[Dt*jo,ym]):A.get("text-offset").evaluate($,{},x).map(Bt=>Bt*jo)}let dt=B?"center":A.get("text-justify").evaluate($,{},x);const Ue="point"===A.get("symbol-placement"),vt=Ue?A.get("text-max-width").evaluate($,{},x)*jo:1/0,Qt=Dt=>{s.allowVerticalPlacement&&b(Ge)&&(ne.vertical=fm(ce,r,a,p,Z,vt,Be,et,Dt,Ye,de,ca.vertical,!0,he,ie))};if(!B&&at){const Dt="auto"===dt?at.map(Ct=>C_(Ct)):[dt];let Bt=!1;for(let Ct=0;Ct<Dt.length;Ct++){const ln=Dt[Ct];if(!ne.horizontal[ln])if(Bt)ne.horizontal[ln]=ne.horizontal[0];else{const Hn=fm(ce,r,a,p,Z,vt,Be,"center",ln,Ye,de,ca.horizontal,!1,he,ie);Hn&&(ne.horizontal[ln]=Hn,Bt=1===Hn.positionedLines.length)}}Qt("left")}else{if("auto"===dt&&(dt=C_(et)),Ue||A.get("text-writing-mode").indexOf("horizontal")>=0||!b(Ge)){const Dt=fm(ce,r,a,p,Z,vt,Be,et,dt,Ye,de,ca.horizontal,!1,he,ie);Dt&&(ne.horizontal[dt]=Dt)}Qt(Ue?"left":dt)}}let Oe=!1;if($.icon&&$.icon.name){const Ge=u[$.icon.name];Ge&&(_e=Et(p[$.icon.name],A.get("icon-offset").evaluate($,{},x),A.get("icon-anchor").evaluate($,{},x)),Oe=Ge.sdf,void 0===s.sdfIcons?s.sdfIcons=Ge.sdf:s.sdfIcons!==Ge.sdf&&ei("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ge.pixelRatio!==s.pixelRatio||0!==A.get("icon-rotate").constantOr(1))&&(s.iconsNeedLinear=!0))}const Pe=yb(ne.horizontal)||ne.vertical;s.iconsInText||(s.iconsInText=!!Pe&&Pe.iconsInText),(Pe||_e)&&Bw(s,$,ne,_e,u,O,he,0,de,Oe,y,x,D)}g&&s.generateCollisionDebugBuffers(E,s.collisionBoxArray)}function C_(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Bw(s,r,a,u,p,g,y,x,E,D,A,P,O){let B=g.textMaxSize.evaluate(r,{},P);void 0===B&&(B=y);const z=s.layers[0].layout,$=z.get("icon-offset").evaluate(r,{},P),Z=yb(a.horizontal)||a.vertical,ie="globe"===O.name,he=y/24,ne=s.tilePixelRatio*B/24,ce=(Ye=s.overscaling,s.zoom>18&&Ye>2&&(Ye>>=1),Math.max(fn/(512*Ye),1)*z.get("symbol-spacing")),_e=z.get("text-padding")*s.tilePixelRatio,de=z.get("icon-padding")*s.tilePixelRatio,Oe=gt(z.get("text-max-angle")),Pe="map"===z.get("text-rotation-alignment")&&"point"!==z.get("symbol-placement"),Ge="map"===z.get("icon-rotation-alignment")&&"point"!==z.get("symbol-placement"),Ze=z.get("symbol-placement"),Be=ce/2;var Ye;const et=z.get("icon-text-fit");let at;u&&"none"!==et&&(s.allowVerticalPlacement&&a.vertical&&(at=__(u,a.vertical,et,z.get("icon-text-fit-padding"),$,he)),Z&&(u=__(u,Z,et,z.get("icon-text-fit-padding"),$,he)));const dt=(Ue,vt,Qt)=>{if(vt.x<0||vt.x>=fn||vt.y<0||vt.y>=fn)return;let Dt=null;if(ie){const{x:Bt,y:Ct,z:ln}=O.projectTilePoint(vt.x,vt.y,Qt);Dt={anchor:new cc(Bt,Ct,ln,0,void 0),up:O.upVector(Qt,vt.x,vt.y)}}!function(Bt,Ct,ln,Hn,Vn,Ln,cn,Mi,vn,Wn,Fi,$t,Hi,Ii,ht,nr,fo,pe,xe,It,hi,Ji,Sr,ki,Xi){const Ur=Bt.addToLineVertexArray(Ct,Hn);let no,jr,mn,$r,ou,Td,Oh,Lh=0,ri=0,Nb=0,Dl=0,yr=-1,Nh=-1;const Ja={};let W_=Va("");const $u=ln?ln.anchor:Ct;let Im=0,km=0;if(void 0===vn._unevaluatedLayout.getValue("text-radial-offset")?[Im,km]=vn.layout.get("text-offset").evaluate(hi,{},Xi).map(As=>As*jo):(Im=vn.layout.get("text-radial-offset").evaluate(hi,{},Xi)*jo,km=ym),Bt.allowVerticalPlacement&&Vn.vertical){const As=Vn.vertical;if(ht)Td=E_(As),Mi&&(Oh=E_(Mi));else{const Ho=vn.layout.get("text-rotate").evaluate(hi,{},Xi)+90;mn=Vp(Wn,$u,Ct,Fi,$t,Hi,As,Ii,Ho,nr),Mi&&($r=Vp(Wn,$u,Ct,Fi,$t,Hi,Mi,pe,Ho))}}if(Ln){const As=vn.layout.get("icon-rotate").evaluate(hi,{},Xi),Ho="none"!==vn.layout.get("icon-text-fit"),el=gm(Ln,As,Sr,Ho),Z_=Mi?gm(Mi,As,Sr,Ho):void 0;jr=Vp(Wn,$u,Ct,Fi,$t,Hi,Ln,pe,As),Lh=4*el.length;const zb=Bt.iconSizeData;let au=null;"source"===zb.kind?(au=[lc*vn.layout.get("icon-size").evaluate(hi,{},Xi)],au[0]>Vu&&ei(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===zb.kind&&(au=[lc*Ji.compositeIconSizes[0].evaluate(hi,{},Xi),lc*Ji.compositeIconSizes[1].evaluate(hi,{},Xi)],(au[0]>Vu||au[1]>Vu)&&ei(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Bt.addSymbols(Bt.icon,el,au,It,xe,hi,!1,ln,Ct,Ur.lineStartIndex,Ur.lineLength,-1,ki,Xi),yr=Bt.icon.placedSymbolArray.length-1,Z_&&(ri=4*Z_.length,Bt.addSymbols(Bt.icon,Z_,au,It,xe,hi,ca.vertical,ln,Ct,Ur.lineStartIndex,Ur.lineLength,-1,ki,Xi),Nh=Bt.icon.placedSymbolArray.length-1)}for(const As in Vn.horizontal){const Ho=Vn.horizontal[As];no||(W_=Va(Ho.text),ht?ou=E_(Ho):no=Vp(Wn,$u,Ct,Fi,$t,Hi,Ho,Ii,vn.layout.get("text-rotate").evaluate(hi,{},Xi),nr));const el=1===Ho.positionedLines.length;if(Nb+=_b(Bt,ln,Ct,Ho,cn,vn,ht,hi,nr,Ur,Vn.vertical?ca.horizontal:ca.horizontalOnly,el?Object.keys(Vn.horizontal):[As],Ja,yr,Ji,ki,Xi),el)break}Vn.vertical&&(Dl+=_b(Bt,ln,Ct,Vn.vertical,cn,vn,ht,hi,nr,Ur,ca.vertical,["vertical"],Ja,Nh,Ji,ki,Xi));let su=-1;const Pm=(As,Ho)=>As?Math.max(As,Ho):Ho;su=Pm(ou,su),su=Pm(Td,su),su=Pm(Oh,su);const Bb=su>-1?1:0;Bt.glyphOffsetArray.length>=Uu.MAX_GLYPHS&&ei("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==hi.sortKey&&Bt.addToSortKeyRanges(Bt.symbolInstances.length,hi.sortKey),Bt.symbolInstances.emplaceBack($u.x,$u.y,$u.z,Ct.x,Ct.y,Ja.right>=0?Ja.right:-1,Ja.center>=0?Ja.center:-1,Ja.left>=0?Ja.left:-1,Ja.vertical>=0?Ja.vertical:-1,yr,Nh,W_,void 0!==no?no:Bt.collisionBoxArray.length,void 0!==no?no+1:Bt.collisionBoxArray.length,void 0!==mn?mn:Bt.collisionBoxArray.length,void 0!==mn?mn+1:Bt.collisionBoxArray.length,void 0!==jr?jr:Bt.collisionBoxArray.length,void 0!==jr?jr+1:Bt.collisionBoxArray.length,$r||Bt.collisionBoxArray.length,$r?$r+1:Bt.collisionBoxArray.length,Fi,Nb,Dl,Lh,ri,Bb,0,Im,km,su)}(s,vt,Dt,Ue,a,u,p,at,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,_e,Pe,E,0,de,Ge,$,r,g,D,A,P)};if("line"===Ze)for(const Ue of Fw(r.geometry,0,0,fn,fn)){const vt=Rw(Ue,ce,Oe,a.vertical||Z,u,24,ne,s.overscaling,fn);for(const Qt of vt)Z&&vb(s,Z.text,Be,Qt)||dt(Ue,Qt,P)}else if("line-center"===Ze){for(const Ue of r.geometry)if(Ue.length>1){const vt=hb(Ue,Oe,a.vertical||Z,u,24,ne);vt&&dt(Ue,vt,P)}}else if("Polygon"===r.type)for(const Ue of Jf(r.geometry,0)){const vt=Nw(Ue,16);dt(Ue[0],new cc(vt.x,vt.y,0,0,void 0),P)}else if("LineString"===r.type)for(const Ue of r.geometry)dt(Ue,new cc(Ue[0].x,Ue[0].y,0,0,void 0),P);else if("Point"===r.type)for(const Ue of r.geometry)for(const vt of Ue)dt([vt],new cc(vt.x,vt.y,0,0,void 0),P)}const Vu=32640;function _b(s,r,a,u,p,g,y,x,E,D,A,P,O,B,z,$,Z){const ie=function(ce,_e,de,Oe,Pe,Ge,Ze,Be){const Ye=[];if(0===_e.positionedLines.length)return Ye;const et=Oe.layout.get("text-rotate").evaluate(Ge,{})*Math.PI/180,at=function(Dt){const Bt=Dt[0],Ct=Dt[1],ln=Bt*Ct;return ln>0?[Bt,-Ct]:ln<0?[-Bt,Ct]:0===Bt?[Ct,Bt]:[Ct,-Bt]}(de);let dt=Math.abs(_e.top-_e.bottom);for(const Dt of _e.positionedLines)dt-=Dt.lineOffset;const Ue=_e.positionedLines.length,vt=dt/Ue;let Qt=_e.top-de[1];for(let Dt=0;Dt<Ue;++Dt){const Bt=_e.positionedLines[Dt];Qt=Lw(_e,vt,Qt,Dt);for(const Ct of Bt.positionedGlyphs){if(!Ct.rect)continue;const ln=Ct.rect||{};let Hn=4,Vn=!0,Ln=1,cn=0;if(Ct.imageName){const ki=Ze[Ct.imageName];if(!ki)continue;if(ki.sdf){ei("SDF images are not supported in formatted text and will be ignored.");continue}Vn=!1,Ln=ki.pixelRatio,Hn=1/Ln}const Mi=(Pe||Be)&&Ct.vertical,vn=Ct.metrics.advance*Ct.scale/2,Wn=Ct.metrics,Fi=Ct.rect;if(null===Fi)continue;Be&&_e.verticalizable&&(cn=Ct.imageName?vn-Ct.metrics.width*Ct.scale/2:0);const $t=Pe?[Ct.x+vn,Ct.y]:[0,0];let Hi=[0,0],Ii=[0,0],ht=!1;Pe||(Mi?(Ii=[Ct.x+vn+at[0],Ct.y+at[1]-cn],ht=!0):Hi=[Ct.x+vn+de[0],Ct.y+de[1]-cn]);const nr=Fi.w*Ct.scale/(Ln*(Ct.localGlyph?2:1)),fo=Fi.h*Ct.scale/(Ln*(Ct.localGlyph?2:1));let pe,xe,It,hi;if(Mi){const ki=Ct.y-Qt,Xi=new it(-vn,vn-ki),Ur=-Math.PI/2,no=new it(...Ii);pe=new it(-vn+Hi[0],Hi[1]),pe._rotateAround(Ur,Xi)._add(no),pe.x+=-ki+vn,pe.y-=(Wn.left-Hn)*Ct.scale;const jr=Ct.imageName?Wn.advance*Ct.scale:jo*Ct.scale,mn=String.fromCharCode(Ct.glyph);Jc(mn)?pe.x+=(1-Hn)*Ct.scale:Ew(mn)?pe.x+=jr-Wn.height*Ct.scale+(-Hn-1)*Ct.scale:pe.x+=Ct.imageName||Wn.width+2*Hn===Fi.w&&Wn.height+2*Hn===Fi.h?(jr-fo)/2:(jr-(Wn.height+2*Hn)*Ct.scale)/2,xe=new it(pe.x,pe.y-nr),It=new it(pe.x+fo,pe.y),hi=new it(pe.x+fo,pe.y-nr)}else{const ki=(Wn.left-Hn)*Ct.scale-vn+Hi[0],Xi=(-Wn.top-Hn)*Ct.scale+Hi[1],Ur=ki+nr,no=Xi+fo;pe=new it(ki,Xi),xe=new it(Ur,Xi),It=new it(ki,no),hi=new it(Ur,no)}if(et){let ki;ki=Pe?new it(0,0):ht?new it(at[0],at[1]):new it(de[0],de[1]),pe._rotateAround(et,ki),xe._rotateAround(et,ki),It._rotateAround(et,ki),hi._rotateAround(et,ki)}const Ji=new it(0,0),Sr=new it(0,0);Ye.push({tl:pe,tr:xe,bl:It,br:hi,tex:ln,writingMode:_e.writingMode,glyphOffset:$t,sectionIndex:Ct.sectionIndex,isSDF:Vn,pixelOffsetTL:Ji,pixelOffsetBR:Sr,minFontScaleX:0,minFontScaleY:0})}}return Ye}(0,u,E,g,y,x,p,s.allowVerticalPlacement),he=s.textSizeData;let ne=null;"source"===he.kind?(ne=[lc*g.layout.get("text-size").evaluate(x,{},Z)],ne[0]>Vu&&ei(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===he.kind&&(ne=[lc*z.compositeTextSizes[0].evaluate(x,{},Z),lc*z.compositeTextSizes[1].evaluate(x,{},Z)],(ne[0]>Vu||ne[1]>Vu)&&ei(`${s.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),s.addSymbols(s.text,ie,ne,E,y,x,A,r,a,D.lineStartIndex,D.lineLength,B,$,Z);for(const ce of P)O[ce]=s.text.placedSymbolArray.length-1;return 4*ie.length}function yb(s){for(const r in s)return s[r];return null}function Vp(s,r,a,u,p,g,y,x,E,D){let A=y.top,P=y.bottom,O=y.left,B=y.right;const z=y.collisionPadding;if(z&&(O-=z[0],A-=z[1],B+=z[2],P+=z[3]),E){const $=new it(O,A),Z=new it(B,A),ie=new it(O,P),he=new it(B,P),ne=gt(E);let ce=new it(0,0);D&&(ce=new it(D[0],D[1])),$._rotateAround(ne,ce),Z._rotateAround(ne,ce),ie._rotateAround(ne,ce),he._rotateAround(ne,ce),O=Math.min($.x,Z.x,ie.x,he.x),B=Math.max($.x,Z.x,ie.x,he.x),A=Math.min($.y,Z.y,ie.y,he.y),P=Math.max($.y,Z.y,ie.y,he.y)}return s.emplaceBack(r.x,r.y,r.z,a.x,a.y,O,A,B,P,x,u,p,g),s.length-1}function E_(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const r=s.bottom-s.top;return r>0?Math.max(10,r):null}function vb(s,r,a,u){const p=s.compareText;if(r in p){const g=p[r];for(let y=g.length-1;y>=0;y--)if(u.dist(g[y])<a)return!0}else p[r]=[];return p[r].push(u),!1}function D_(s,r){const a=s.fovAboveCenter,u=s.elevation?s.elevation.getMinElevationBelowMSL()*r:0,p=(s._camera.position[2]*s.worldSize-u)/Math.cos(s._pitch),g=Math.sin(a)*p/Math.sin(Math.max(Math.PI/2-s._pitch-a,.01)),y=Math.sin(s._pitch)*g+p;return Math.min(1.01*y,p*(1/s._horizonShift))}function tu(s,r){if(!r.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:r};const a=Math.pow(2,-s.z),u=s.x*a,p=(s.x+1)*a,g=s.y*a,y=(s.y+1)*a,x=So(u),E=So(p),D=to(g),A=to(y),P=r.project(x,D),O=r.project(E,D),B=r.project(E,A),z=r.project(x,A);let $=Math.min(P.x,O.x,B.x,z.x),Z=Math.min(P.y,O.y,B.y,z.y),ie=Math.max(P.x,O.x,B.x,z.x),he=Math.max(P.y,O.y,B.y,z.y);const ne=a/16;function ce(de,Oe,Pe,Ge,Ze,Be){const Ye=(Pe+Ze)/2,et=(Ge+Be)/2,at=r.project(So(Ye),to(et)),dt=Math.max(0,$-at.x,Z-at.y,at.x-ie,at.y-he);$=Math.min($,at.x),ie=Math.max(ie,at.x),Z=Math.min(Z,at.y),he=Math.max(he,at.y),dt>ne&&(ce(de,at,Pe,Ge,Ye,et),ce(at,Oe,Ye,et,Ze,Be))}ce(P,O,u,g,p,g),ce(O,B,p,g,p,y),ce(B,z,p,y,u,y),ce(z,P,u,y,u,g),$-=ne,Z-=ne,ie+=ne,he+=ne;const _e=1/Math.max(ie-$,he-Z);return{scale:_e,x:$*_e,y:Z*_e,x2:ie*_e,y2:he*_e,projection:r}}const RD=aa(new Float32Array(16));class uc{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,a){return{x:0,y:0,z:0}}unproject(r,a){return new si(0,0)}projectTilePoint(r,a,u){return{x:r,y:a,z:0}}locationPoint(r,a,u=!0){return r._coordinatePoint(r.locationCoordinate(a),u)}pixelsPerMeter(r,a){return Wa(1,r)*a}pixelSpaceConversion(r,a,u){return 1}farthestPixelDistance(r){return D_(r,r.pixelsPerMeter)}pointCoordinate(r,a,u,p){const g=r.horizonLineFromTop(!1),y=new it(a,Math.max(g,u));return r.rayIntersectionCoordinate(r.pointRayIntersection(y,p))}pointCoordinate3D(r,a,u){const p=new it(a,u);if(r.elevation)return r.elevation.pointCoordinate(p);{const g=this.pointCoordinate(r,p.x,p.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,a){if(r.elevation)return!this.pointCoordinate3D(r,a.x,a.y);const u=r.horizonLineFromTop();return a.y<u}createInversionMatrix(r,a){return RD}createTileMatrix(r,a,u){let p,g,y;const x=u.canonical,E=aa(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=tu(x,this);p=1,g=D.x+u.wrap*D.scale,y=D.y,Ou(E,E,[p/D.scale,p/D.scale,r.pixelsPerMeter/a])}else p=a/r.zoomScale(x.z),g=(x.x+Math.pow(2,x.z)*u.wrap)*p,y=x.y*p;return ds(E,E,[g,y,0]),Ou(E,E,[p/fn,p/fn,1]),E}upVector(r,a,u){return[0,0,1]}upVectorScale(r,a,u){return{metersToTile:1}}}class zw extends uc{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[a,u]=this.parallels=r.parallels||[29.5,45.5],p=Math.sin(gt(a));this.n=(p+Math.sin(gt(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(r,a){const{n:u,c:p,r0:g}=this,y=gt(r-this.center[0]),x=gt(a),E=Math.sqrt(p-2*u*Math.sin(x))/u;return{x:E*Math.sin(y*u),y:E*Math.cos(y*u)-g,z:0}}unproject(r,a){const{n:u,c:p,r0:g}=this,y=g+a;let x=Math.atan2(r,Math.abs(y))*Math.sign(y);y*u<0&&(x-=Math.PI*Math.sign(r)*Math.sign(y));const E=gt(this.center[0])*u;x=wr(x,-Math.PI-E,Math.PI-E);const D=gn(_n(x/u)+this.center[0],-180,180),A=Math.asin(gn((p-(r*r+y*y)*u*u)/(2*u),-1,1)),P=gn(_n(A),-To,To);return new si(D,P)}}const bm=1.340264,ve=-.081106,nu=893e-6,Up=.003796,jp=Math.sqrt(3)/2;class Vw extends uc{project(r,a){a=a/180*Math.PI,r=r/180*Math.PI;const u=Math.asin(jp*Math.sin(a)),p=u*u,g=p*p*p;return{x:.5*(r*Math.cos(u)/(jp*(bm+3*ve*p+g*(7*nu+9*Up*p)))/Math.PI+.5),y:1-.5*(u*(bm+ve*p+g*(nu+Up*p))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,p=u*u,g=p*p*p;for(let A,P,O,B=0;B<12&&(P=u*(bm+ve*p+g*(nu+Up*p))-a,O=bm+3*ve*p+g*(7*nu+9*Up*p),A=P/O,u=gn(u-A,-Math.PI/3,Math.PI/3),p=u*u,g=p*p*p,!(Math.abs(A)<1e-12));++B);const y=jp*r*(bm+3*ve*p+g*(7*nu+9*Up*p))/Math.cos(u),x=Math.asin(Math.sin(u)/jp),E=gn(180*y/Math.PI,-180,180),D=gn(180*x/Math.PI,-To,To);return new si(E,D)}}class Uw extends uc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){return{x:.5+r/360,y:.5-a/360,z:0}}unproject(r,a){const u=360*(r-.5),p=gn(360*(.5-a),-To,To);return new si(u,p)}}const iu=Math.PI/2;function ru(s){return Math.tan((iu+s)/2)}class M_ extends uc{constructor(r){super(r),this.center=r.center||[0,30];const[a,u]=this.parallels=r.parallels||[30,30];let p=gt(a),g=gt(u);this.southernCenter=p+g<0,this.southernCenter&&(p=-p,g=-g);const y=Math.cos(p),x=ru(p);this.n=p===g?Math.sin(p):Math.log(y/Math.cos(g))/Math.log(ru(g)/x),this.f=y*Math.pow(ru(p),this.n)/this.n}project(r,a){a=gt(a),this.southernCenter&&(a=-a),r=gt(r-this.center[0]);const u=1e-6,{n:p,f:g}=this;g>0?a<-iu+u&&(a=-iu+u):a>iu-u&&(a=iu-u);const y=g/Math.pow(ru(a),p);let x=y*Math.sin(p*r),E=g-y*Math.cos(p*r);return x=.5*(x/Math.PI+.5),E=.5*(E/Math.PI+.5),{x,y:this.southernCenter?E:1-E,z:0}}unproject(r,a){r=(2*r-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f:p}=this,g=p-a,y=Math.sign(g),x=Math.sign(u)*Math.sqrt(r*r+g*g);let E=Math.atan2(r,Math.abs(g))*y;g*u<0&&(E-=Math.PI*Math.sign(r)*y);const D=gn(_n(E/u)+this.center[0],-180,180),A=gn(_n(2*Math.atan(Math.pow(p/x,1/u))-iu),-To,To);return new si(D,this.southernCenter?-A:A)}}class kh extends uc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,a){return{x:Ga(r),y:qa(a),z:0}}unproject(r,a){const u=So(r),p=to(a);return new si(u,p)}}const xm=gt(To);class wm extends uc{project(r,a){const u=(a=gt(a))*a,p=u*u;return{x:.5*((r=gt(r))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,p=25,g=0,y=u*u;do{y=u*u;const D=y*y;g=(u*(1.007226+y*(.015085+D*(.028874*y-.044475-.005916*D)))-a)/(1.007226+y*(.045255+D*(.259866*y-.311325-.005916*11*D))),u=gn(u-g,-xm,xm)}while(Math.abs(g)>1e-6&&--p>0);y=u*u;const x=gn(_n(r/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=_n(u);return new si(x,E)}}const S_=gt(To);class T_ extends uc{project(r,a){a=gt(a),r=gt(r);const u=Math.cos(a),p=2/Math.PI,g=Math.acos(u*Math.cos(r/2)),y=Math.sin(g)/g,x=.5*(r*p+2*u*Math.sin(r/2)/y)||0,E=.5*(a+Math.sin(a)/y)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(r,a){let u=r=(2*r-.5)*Math.PI,p=a=(2*(1-a)-1)*Math.PI,g=25;const y=1e-6;let x=0,E=0;do{const D=Math.cos(p),A=Math.sin(p),P=2*A*D,O=A*A,B=D*D,z=Math.cos(u/2),$=Math.sin(u/2),Z=2*z*$,ie=$*$,he=1-B*z*z,ne=he?1/he:0,ce=he?Math.acos(D*z)*Math.sqrt(1/he):0,_e=.5*(2*ce*D*$+2*u/Math.PI)-r,de=.5*(ce*A+p)-a,Oe=.5*ne*(B*ie+ce*D*z*O)+1/Math.PI,Pe=ne*(Z*P/4-ce*A*$),Ge=.125*ne*(P*$-ce*A*B*Z),Ze=.5*ne*(O*z+ce*ie*D)+.5,Be=Pe*Ge-Ze*Oe;x=(de*Pe-_e*Ze)/Be,E=(_e*Ge-de*Oe)/Be,u=gn(u-x,-Math.PI,Math.PI),p=gn(p-E,-S_,S_)}while((Math.abs(x)>y||Math.abs(E)>y)&&--g>0);return new si(_n(u),_n(p))}}class Cm extends uc{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(gt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){const{scale:u,cosPhi:p}=this;return{x:gt(r)*p*u+.5,y:-Math.sin(gt(a))/p*u+.5,z:0}}unproject(r,a){const{scale:u,cosPhi:p}=this,g=-(a-.5)/u,y=gn(_n((r-.5)/u)/p,-180,180),x=Math.asin(gn(g*p,-1,1)),E=gn(_n(x),-To,To);return new si(y,E)}}class A_ extends kh{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,a,u){const p=gh(r,a,u);return pr(p,p,_h(Cl(u))),{x:p[0],y:p[1],z:p[2]}}locationPoint(r,a){const u=ic(a.lat,a.lng),p=hs([],u),g=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(a),r._centerAltitude):r._centerAltitude;xp(u,u,p,Wa(1,0)*fn*g);const y=aa(new Float64Array(16));return tc(y,r.pixelMatrix,r.globeMatrix),pr(u,u,y),new it(u[0],u[1])}pixelsPerMeter(r,a){return Wa(1,0)*a}pixelSpaceConversion(r,a,u){const p=Wa(1,r)*a,g=zn(Wa(1,45)*a,p,u);return this.pixelsPerMeter(r,a)/g}createTileMatrix(r,a,u){const p=Eg(Cl(u.canonical));return tc(new Float64Array(16),r.globeMatrix,p)}createInversionMatrix(r,a){const{center:u}=r,p=_h(Cl(a));return Lf(p,p,gt(u.lng)),bl(p,p,gt(u.lat)),Ou(p,p,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(r,a,u,p){return xv(r,a,u,!0)||new bh(0,0)}pointCoordinate3D(r,a,u){const p=this.pointCoordinate(r,a,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(r,a){return!xv(r,a.x,a.y,!1)}farthestPixelDistance(r){const a=function(p,g){const y=p.cameraToCenterDistance,x=p._centerAltitude*g,E=p._camera,D=p._camera.forward(),A=la([],Ua([],D,-y),[0,0,x]),P=p.worldSize/(2*Math.PI),O=[0,0,-P],B=p.width/p.height,z=Math.tan(p.fovAboveCenter),$=Ua([],E.up(),z),Z=Ua([],E.right(),z*B),ie=hs([],la([],la([],D,$),Z)),he=[];let ne;if(new Vf(A,ie).closestPointOnSphere(O,P,he)){const ce=la([],he,O),_e=nc([],ce,A);ne=Math.cos(p.fovAboveCenter)*vp(_e)}else{const ce=nc([],A,O),_e=nc([],O,A);hs(_e,_e);const de=vp(ce)-P;ne=Math.sqrt(de*(de+2*P));const Oe=Math.acos(ne/(P+de))-Math.acos(ja(D,_e));ne*=Math.cos(Oe)}return 1.01*ne}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),u=yh(r.zoom);if(u>0){const p=D_(r,Wa(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),y=Math.max(r.width,r.height)/r.worldSize*Math.PI;return zn(a,p+g*(1-Math.cos(y)),Math.pow(u,10))}return a}upVector(r,a,u){return gh(a,u,r,1)}upVectorScale(r){return{metersToTile:mh(Sp(Cl(r)))}}}function I_(s){const r=s.parallels,a=!!r&&Math.abs(r[0]+r[1])<.01;switch(s.name){case"mercator":return new kh(s);case"equirectangular":return new Uw(s);case"naturalEarth":return new wm(s);case"equalEarth":return new Vw(s);case"winkelTripel":return new T_(s);case"albers":return a?new Cm(s):new zw(s);case"lambertConformalConic":return a?new Cm(s):new M_(s);case"globe":return new A_(s)}throw new Error(`Invalid projection name: ${s.name}`)}const k_=nm.types,jw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Em(s,r,a,u,p,g,y,x,E,D,A,P,O){const B=x?Math.min(Vu,Math.round(x[0])):0,z=x?Math.min(Vu,Math.round(x[1])):0;s.emplaceBack(r,a,Math.round(32*u),Math.round(32*p),g,y,(B<<1)+(E?1:0),z,16*D,16*A,256*P,256*O)}function $p(s,r,a,u,p,g,y){s.emplaceBack(r,a,u,p,g,y)}function Dm(s,r,a,u,p){s.emplaceBack(r,a,u,p),s.emplaceBack(r,a,u,p),s.emplaceBack(r,a,u,p),s.emplaceBack(r,a,u,p)}function bb(s){for(const r of s.sections)if(U(r.text))return!0;return!1}class Mm{constructor(r){this.layoutVertexArray=new Na,this.indexArray=new Qr,this.programConfigurations=r,this.segments=new _r,this.dynamicLayoutVertexArray=new Di,this.opacityVertexArray=new Ni,this.placedSymbolArray=new gg,this.globeExtVertexArray=new Yi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(r,a,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,bw.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,h_.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,jw,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,xw.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ot(Mm,"SymbolBuffers");class P_{constructor(r,a,u){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new u,this.segments=new _r,this.collisionVertexArray=new Bi,this.collisionVertexArrayExt=new po}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,ww.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,Yv.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ot(P_,"CollisionBuffers");class Uu{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(y=>y.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=aa([]),this.placementViewportMatrix=aa([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Kc(this.zoom,a["text-size"]),this.iconSizeData=Kc(this.zoom,a["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==g&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===g||"auto"===g&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(y=>ca[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=r.sourceID,this.projection=r.projection}createArrays(){this.text=new Mm(new ec(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new Mm(new ec(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new Jr,this.lineVertexArray=new Ff,this.symbolInstances=new cv}calculateGlyphDependencies(r,a,u,p,g){for(let y=0;y<r.length;y++)if(a[r.charCodeAt(y)]=!0,p&&g){const x=Qc[r.charAt(y)];x&&(a[x.charCodeAt(0)]=!0)}}populate(r,a,u,p){const g=this.layers[0],y=g.layout,x="globe"===this.projection.name,E=y.get("text-font"),D=y.get("text-field"),A=y.get("icon-image"),P=("constant"!==D.value.kind||D.value.value instanceof cr&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),O="constant"!==A.value.kind||!!A.value.value||Object.keys(A.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!P&&!O)return;const z=a.iconDependencies,$=a.glyphDependencies,Z=a.availableImages,ie=new Se(this.zoom);for(const{feature:he,id:ne,index:ce,sourceLayerIndex:_e}of r){const de=g._featureFilter.needGeometry,Oe=Wc(he,de);if(!g._featureFilter.filter(ie,Oe,u))continue;if(de||(Oe.geometry=rc(he,u,p)),x&&1!==he.type&&u.z<=5){const Be=Oe.geometry,Ye=.98078528056,et=(at,dt)=>ja(gh(at.x,at.y,u,1),gh(dt.x,dt.y,u,1))<Ye;for(let at=0;at<Be.length;at++)Be[at]=nw(Be[at],et)}let Pe,Ge;if(P){const Be=g.getValueAndResolveTokens("text-field",Oe,u,Z),Ye=cr.factory(Be);bb(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ye()||this.hasRTLText&&we.isParsed())&&(Pe=Cw(Ye,g,Oe))}if(O){const Be=g.getValueAndResolveTokens("icon-image",Oe,u,Z);Ge=Be instanceof xo?Be:xo.fromString(Be)}if(!Pe&&!Ge)continue;const Ze=this.sortFeaturesByKey?B.evaluate(Oe,{},u):void 0;if(this.features.push({id:ne,text:Pe,icon:Ge,index:ce,sourceLayerIndex:_e,geometry:Oe.geometry,properties:he.properties,type:k_[he.type],sortKey:Ze}),Ge&&(z[Ge.name]=!0),Pe){const Be=E.evaluate(Oe,{},u).join(","),Ye="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ca.vertical)>=0;for(const et of Pe.sections)if(et.image)z[et.image.name]=!0;else{const at=b(Pe.toString()),dt=et.fontStack||Be,Ue=$[dt]=$[dt]||{};this.calculateGlyphDependencies(et.text,Ue,Ye,this.allowVerticalPlacement,at)}}}"line"===y.get("symbol-placement")&&(this.features=function(he){const ne={},ce={},_e=[];let de=0;function Oe(Be){_e.push(he[Be]),de++}function Pe(Be,Ye,et){const at=ce[Be];return delete ce[Be],ce[Ye]=at,_e[at].geometry[0].pop(),_e[at].geometry[0]=_e[at].geometry[0].concat(et[0]),at}function Ge(Be,Ye,et){const at=ne[Ye];return delete ne[Ye],ne[Be]=at,_e[at].geometry[0].shift(),_e[at].geometry[0]=et[0].concat(_e[at].geometry[0]),at}function Ze(Be,Ye,et){const at=et?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Be}:${at.x}:${at.y}`}for(let Be=0;Be<he.length;Be++){const Ye=he[Be],et=Ye.geometry,at=Ye.text?Ye.text.toString():null;if(!at){Oe(Be);continue}const dt=Ze(at,et),Ue=Ze(at,et,!0);if(dt in ce&&Ue in ne&&ce[dt]!==ne[Ue]){const vt=Ge(dt,Ue,et),Qt=Pe(dt,Ue,_e[vt].geometry);delete ne[dt],delete ce[Ue],ce[Ze(at,_e[Qt].geometry,!0)]=Qt,_e[vt].geometry=null}else dt in ce?Pe(dt,Ue,et):Ue in ne?Ge(dt,Ue,et):(Oe(Be),ne[dt]=de-1,ce[Ue]=de-1)}return _e.filter(Be=>Be.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((he,ne)=>he.sortKey-ne.sortKey)}update(r,a,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,u,p),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,u,p))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=I_(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const u=this.lineVertexArray.length;if(void 0!==r.segment)for(const{x:p,y:g}of a)this.lineVertexArray.emplaceBack(p,g);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,a,u,p,g,y,x,E,D,A,P,O,B,z){const $=r.indexArray,Z=r.layoutVertexArray,ie=r.globeExtVertexArray,he=r.segments.prepareSegment(4*a.length,Z,$,this.canOverlap?y.sortKey:void 0),ne=this.glyphOffsetArray.length,ce=he.vertexLength,_e=this.allowVerticalPlacement&&x===ca.vertical?Math.PI/2:0,de=y.text&&y.text.sections;for(let Pe=0;Pe<a.length;Pe++){const{tl:Ge,tr:Ze,bl:Be,br:Ye,tex:et,pixelOffsetTL:at,pixelOffsetBR:dt,minFontScaleX:Ue,minFontScaleY:vt,glyphOffset:Qt,isSDF:Dt,sectionIndex:Bt}=a[Pe],Ct=he.vertexLength,ln=Qt[1];if(Em(Z,D.x,D.y,Ge.x,ln+Ge.y,et.x,et.y,u,Dt,at.x,at.y,Ue,vt),Em(Z,D.x,D.y,Ze.x,ln+Ze.y,et.x+et.w,et.y,u,Dt,dt.x,at.y,Ue,vt),Em(Z,D.x,D.y,Be.x,ln+Be.y,et.x,et.y+et.h,u,Dt,at.x,dt.y,Ue,vt),Em(Z,D.x,D.y,Ye.x,ln+Ye.y,et.x+et.w,et.y+et.h,u,Dt,dt.x,dt.y,Ue,vt),E){const{x:Hn,y:Vn,z:Ln}=E.anchor,[cn,Mi,vn]=E.up;$p(ie,Hn,Vn,Ln,cn,Mi,vn),$p(ie,Hn,Vn,Ln,cn,Mi,vn),$p(ie,Hn,Vn,Ln,cn,Mi,vn),$p(ie,Hn,Vn,Ln,cn,Mi,vn),Dm(r.dynamicLayoutVertexArray,Hn,Vn,Ln,_e)}else Dm(r.dynamicLayoutVertexArray,D.x,D.y,D.z,_e);$.emplaceBack(Ct,Ct+1,Ct+2),$.emplaceBack(Ct+1,Ct+2,Ct+3),he.vertexLength+=4,he.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qt[0]),Pe!==a.length-1&&Bt===a[Pe+1].sectionIndex||r.programConfigurations.populatePaintArrays(Z.length,y,y.index,{},B,z,de&&de[Bt])}const Oe=E?E.anchor:D;r.placedSymbolArray.emplaceBack(Oe.x,Oe.y,Oe.z,D.x,D.y,ne,this.glyphOffsetArray.length-ne,ce,A,P,D.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],x,0,!1,0,O,0)}_commitLayoutVertex(r,a,u,p,g,y,x){r.emplaceBack(a,u,p,g,y,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(r,a,u,p,g,y,x){const E=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),D=E.vertexLength,A=x.tileAnchorX,P=x.tileAnchorY;for(let B=0;B<4;B++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(a,-r.padding,-r.padding),u.collisionVertexArrayExt.emplaceBack(a,r.padding,-r.padding),u.collisionVertexArrayExt.emplaceBack(a,r.padding,r.padding),u.collisionVertexArrayExt.emplaceBack(a,-r.padding,r.padding),this._commitLayoutVertex(u.layoutVertexArray,p,g,y,A,P,new it(r.x1,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,y,A,P,new it(r.x2,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,y,A,P,new it(r.x2,r.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,g,y,A,P,new it(r.x1,r.y2)),E.vertexLength+=4;const O=u.indexArray;O.emplaceBack(D,D+1),O.emplaceBack(D+1,D+2),O.emplaceBack(D+2,D+3),O.emplaceBack(D+3,D),E.primitiveLength+=4}_addTextDebugCollisionBoxes(r,a,u,p,g,y){for(let x=p;x<g;x++){const E=u.get(x),D=this.getSymbolInstanceTextSize(r,y,a,x);this._addCollisionDebugVertices(E,D,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(r,a,u,p,g,y){for(let x=p;x<g;x++){const E=u.get(x),D=this.getSymbolInstanceIconSize(r,a,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,D,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(r,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new P_(hr,Xv.members,yl),this.iconCollisionBox=new P_(hr,Xv.members,yl);const u=El(this.iconSizeData,r),p=El(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const y=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(p,r,a,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(p,r,a,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(u,r,a,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(u,r,a,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(r,a,u,p){const g=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:p),y=dm(this.textSizeData,r,g)/jo;return this.tilePixelRatio*y}getSymbolInstanceIconSize(r,a,u){const p=this.icon.placedSymbolArray.get(u),g=dm(this.iconSizeData,r,p);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,a,u){r.emplaceBack(a,-u,-u),r.emplaceBack(a,u,-u),r.emplaceBack(a,u,u),r.emplaceBack(a,-u,u)}_updateTextDebugCollisionBoxes(r,a,u,p,g,y){for(let x=p;x<g;x++){const E=u.get(x),D=this.getSymbolInstanceTextSize(r,y,a,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,E.padding)}}_updateIconDebugCollisionBoxes(r,a,u,p,g,y){for(let x=p;x<g;x++){const E=u.get(x),D=this.getSymbolInstanceIconSize(r,a,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,E.padding)}}updateCollisionDebugBuffers(r,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=El(this.iconSizeData,r),p=El(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const y=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(p,r,a,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(p,r,a,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(u,r,a,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(u,r,a,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,a,u,p,g,y,x,E,D){const A={};if(a<u){const{x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce,featureIndex:_e}=r.get(a);A.textBox={x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce},A.textFeatureIndex=_e}if(p<g){const{x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce,featureIndex:_e}=r.get(p);A.verticalTextBox={x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce},A.verticalTextFeatureIndex=_e}if(y<x){const{x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce,featureIndex:_e}=r.get(y);A.iconBox={x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce},A.iconFeatureIndex=_e}if(E<D){const{x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce,featureIndex:_e}=r.get(E);A.verticalIconBox={x1:P,y1:O,x2:B,y2:z,padding:$,projectedAnchorX:Z,projectedAnchorY:ie,projectedAnchorZ:he,tileAnchorX:ne,tileAnchorY:ce},A.verticalIconFeatureIndex=_e}return A}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const u=r.placedSymbolArray.get(a),p=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<p;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(r),u=Math.cos(r),p=[],g=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const E=this.symbolInstances.get(x);p.push(0|Math.round(a*E.tileAnchorX+u*E.tileAnchorY)),g.push(E.featureIndex)}return y.sort((x,E)=>p[x]-p[E]||g[E]-g[x]),y}addToSortKeyRanges(r,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:D}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&y!==g&&y!==p&&this.addIndicesForPlacedSymbol(this.text,y),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ot(Uu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Uu.MAX_GLYPHS=65535,Uu.addDynamicAttributes=Dm;const ua=new ut({"symbol-placement":new Me(qe.layout_symbol["symbol-placement"]),"symbol-spacing":new Me(qe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Me(qe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ve(qe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Me(qe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Me(qe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Me(qe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Me(qe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Me(qe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ve(qe.layout_symbol["icon-size"]),"icon-text-fit":new Me(qe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Me(qe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ve(qe.layout_symbol["icon-image"]),"icon-rotate":new Ve(qe.layout_symbol["icon-rotate"]),"icon-padding":new Me(qe.layout_symbol["icon-padding"]),"icon-keep-upright":new Me(qe.layout_symbol["icon-keep-upright"]),"icon-offset":new Ve(qe.layout_symbol["icon-offset"]),"icon-anchor":new Ve(qe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Me(qe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Me(qe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Me(qe.layout_symbol["text-rotation-alignment"]),"text-field":new Ve(qe.layout_symbol["text-field"]),"text-font":new Ve(qe.layout_symbol["text-font"]),"text-size":new Ve(qe.layout_symbol["text-size"]),"text-max-width":new Ve(qe.layout_symbol["text-max-width"]),"text-line-height":new Ve(qe.layout_symbol["text-line-height"]),"text-letter-spacing":new Ve(qe.layout_symbol["text-letter-spacing"]),"text-justify":new Ve(qe.layout_symbol["text-justify"]),"text-radial-offset":new Ve(qe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Me(qe.layout_symbol["text-variable-anchor"]),"text-anchor":new Ve(qe.layout_symbol["text-anchor"]),"text-max-angle":new Me(qe.layout_symbol["text-max-angle"]),"text-writing-mode":new Me(qe.layout_symbol["text-writing-mode"]),"text-rotate":new Ve(qe.layout_symbol["text-rotate"]),"text-padding":new Me(qe.layout_symbol["text-padding"]),"text-keep-upright":new Me(qe.layout_symbol["text-keep-upright"]),"text-transform":new Ve(qe.layout_symbol["text-transform"]),"text-offset":new Ve(qe.layout_symbol["text-offset"]),"text-allow-overlap":new Me(qe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Me(qe.layout_symbol["text-ignore-placement"]),"text-optional":new Me(qe.layout_symbol["text-optional"])});var R_={paint:new ut({"icon-opacity":new Ve(qe.paint_symbol["icon-opacity"]),"icon-color":new Ve(qe.paint_symbol["icon-color"]),"icon-halo-color":new Ve(qe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ve(qe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ve(qe.paint_symbol["icon-halo-blur"]),"icon-translate":new Me(qe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Me(qe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ve(qe.paint_symbol["text-opacity"]),"text-color":new Ve(qe.paint_symbol["text-color"],{runtimeType:es,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Ve(qe.paint_symbol["text-halo-color"]),"text-halo-width":new Ve(qe.paint_symbol["text-halo-width"]),"text-halo-blur":new Ve(qe.paint_symbol["text-halo-blur"]),"text-translate":new Me(qe.paint_symbol["text-translate"]),"text-translate-anchor":new Me(qe.paint_symbol["text-translate-anchor"])}),layout:ua};class xb{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:qr,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ot(xb,"FormatSectionOverride",{omit:["defaultValue"]});class F_ extends sa{constructor(r){super(r,R_)}recalculate(r,a){super.recalculate(r,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const g of u)p.indexOf(g)<0&&p.push(g);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,a,u,p){const g=this.layout.get(r).evaluate(a,{},u,p),y=this._unevaluatedLayout._values[r];return y.isDataDriven()||F(y.value)||!g?g:(x=a.properties,g.replace(/{([^{}]+)}/g,(D,A)=>A in x?String(x[A]):""));var x}createBucket(r){return new Uu(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of R_.paint.overridableProperties){if(!F_.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),u=new xb(a),p=new k(u,a.property.specification);let g=null;g="constant"===a.value.kind||"source"===a.value.kind?new fe("source",p):new Xe("composite",p,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new ct(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&F_.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const u=r.get("text-field"),p=R_.paint.properties[a];let g=!1;const y=x=>{for(const E of x)if(p.overrides&&p.overrides.hasOverride(E))return void(g=!0)};if("constant"===u.value.kind&&u.value.value instanceof cr)y(u.value.value.sections);else if("source"===u.value.kind){const x=D=>{g||(D instanceof Vl&&Er(D.value)===ci?y(D.value.sections):D instanceof bu?y(D.sections):D.eachChild(x))},E=u.value;E._styleExpression&&x(E._styleExpression.expression)}return g}getProgramConfiguration(r){return new Gc(this,r)}}var O_={paint:new ut({"background-color":new Me(qe.paint_background["background-color"]),"background-pattern":new Me(qe.paint_background["background-pattern"]),"background-opacity":new Me(qe.paint_background["background-opacity"])})},wb={paint:new ut({"raster-opacity":new Me(qe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Me(qe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Me(qe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Me(qe.paint_raster["raster-brightness-max"]),"raster-saturation":new Me(qe.paint_raster["raster-saturation"]),"raster-contrast":new Me(qe.paint_raster["raster-contrast"]),"raster-resampling":new Me(qe.paint_raster["raster-resampling"]),"raster-fade-duration":new Me(qe.paint_raster["raster-fade-duration"])})};class $w extends sa{constructor(r){super(r,{}),this.implementation=r}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var Hw={paint:new ut({"sky-type":new Me(qe.paint_sky["sky-type"]),"sky-atmosphere-sun":new Me(qe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Me(qe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Me(qe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Me(qe.paint_sky["sky-gradient-radius"]),"sky-gradient":new st(qe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Me(qe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Me(qe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Me(qe.paint_sky["sky-opacity"])})};function L_(s,r,a){const u=[0,0,1],p=Kx([]);return Qx(p,p,a?-gt(s)+Math.PI:gt(s)),zf(p,p,-gt(r)),gv(u,u,p),hs(u,u)}const Cb={circle:class extends sa{constructor(s){super(s,Gg)}createBucket(s){return new Gf(s)}queryRadius(s){const r=s;return bd("circle-radius",this,r)+bd("circle-stroke-width",this,r)+xd(this.paint.get("circle-translate"))}queryIntersectsFeature(s,r,a,u,p,g,y,x){const E=$g(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a);return qf(s,u,g,y,x,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,D)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new Gc(this,s)}},heatmap:class extends sa{createBucket(s){return new Iv(s)}constructor(s){super(s,wh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"heatmap-color"===s&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Wg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return bd("heatmap-radius",this,s)}queryIntersectsFeature(s,r,a,u,p,g,y,x){const E=this.paint.get("heatmap-radius").evaluate(r,a);return qf(s,u,g,y,x,!0,!0,new it(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new Gc(this,s)}},hillshade:class extends sa{constructor(s){super(s,rw)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends sa{constructor(s){super(s,t_)}getProgramIds(){const s=this.paint.get("fill-pattern"),r=s&&s.constantOr(1),a=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(s){return new Gc(this,s)}recalculate(s,r){super.recalculate(s,r);const a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Jg(s)}queryRadius(){return xd(this.paint.get("fill-translate"))}queryIntersectsFeature(s,r,a,u,p,g){return!s.queryGeometry.isAboveHorizon&&Bg(Ap(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends sa{constructor(s){super(s,ID)}createBucket(s){return new Yc(s)}queryRadius(){return xd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new Gc(this,s)}queryIntersectsFeature(s,r,a,u,p,g,y,x,E){const D=$g(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(r,a),P=this.paint.get("fill-extrusion-base").evaluate(r,a),O=[0,0],B=x&&g.elevation,z=g.elevation?g.elevation.exaggeration():1,$=s.tile.getBucket(this);if(B&&$ instanceof Yc){const ce=$.centroidVertexArray,_e=E+1;_e<ce.length&&(O[0]=ce.geta_centroid_pos0(_e),O[1]=ce.geta_centroid_pos1(_e))}if(0===O[0]&&1===O[1])return!1;"globe"===g.projection.name&&(u=a_([u],[new it(0,0),new it(fn,fn)],s.tileID.canonical).map(ce=>ce.polygon).flat());const Z=B?x:null,[ie,he]=(_e=u,de=P,Oe=A,Pe=D,Ge=y,Ze=Z,Be=O,Ye=z,et=g.center.lat,"globe"===(ce=g).projection.name?function(dt,Ue,vt,Qt,Dt,Bt,Ct,ln,Hn,Vn,Ln){const cn=[],Mi=[],vn=dt.projection.upVectorScale(Ln,dt.center.lat,dt.worldSize).metersToTile,Wn=[0,0,0,1],Fi=[0,0,0,1],$t=(Ii,ht,nr,fo)=>{Ii[0]=ht,Ii[1]=nr,Ii[2]=fo,Ii[3]=1},Hi=s_();vt>0&&(vt+=Hi),Qt+=Hi;for(const Ii of Ue){const ht=[],nr=[];for(const fo of Ii){const pe=fo.x+Dt.x,xe=fo.y+Dt.y,It=dt.projection.projectTilePoint(pe,xe,Ln),hi=dt.projection.upVector(Ln,fo.x,fo.y);let Ji=vt,Sr=Qt;if(Ct){const ki=Lp(pe,xe,vt,Qt,Ct,ln,Hn,Vn);Ji+=ki.base,Sr+=ki.top}0!==vt?$t(Wn,It.x+hi[0]*vn*Ji,It.y+hi[1]*vn*Ji,It.z+hi[2]*vn*Ji):$t(Wn,It.x,It.y,It.z),$t(Fi,It.x+hi[0]*vn*Sr,It.y+hi[1]*vn*Sr,It.z+hi[2]*vn*Sr),pr(Wn,Wn,Bt),pr(Fi,Fi,Bt),ht.push(new Ya(Wn[0],Wn[1],Wn[2])),nr.push(new Ya(Fi[0],Fi[1],Fi[2]))}cn.push(ht),Mi.push(nr)}return[cn,Mi]}(ce,_e,de,Oe,Pe,Ge,Ze,Be,Ye,et,s.tileID.canonical):Ze?function(dt,Ue,vt,Qt,Dt,Bt,Ct,ln,Hn){const Vn=[],Ln=[],cn=[0,0,0,1];for(const Mi of dt){const vn=[],Wn=[];for(const Fi of Mi){const $t=Fi.x+Qt.x,Hi=Fi.y+Qt.y,Ii=Lp($t,Hi,Ue,vt,Bt,Ct,ln,Hn);cn[0]=$t,cn[1]=Hi,cn[2]=Ii.base,cn[3]=1,qc(cn,cn,Dt),cn[3]=Math.max(cn[3],1e-5);const ht=new Ya(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);cn[0]=$t,cn[1]=Hi,cn[2]=Ii.top,cn[3]=1,qc(cn,cn,Dt),cn[3]=Math.max(cn[3],1e-5);const nr=new Ya(cn[0]/cn[3],cn[1]/cn[3],cn[2]/cn[3]);vn.push(ht),Wn.push(nr)}Vn.push(vn),Ln.push(Wn)}return[Vn,Ln]}(_e,de,Oe,Pe,Ge,Ze,Be,Ye,et):function(dt,Ue,vt,Qt,Dt){const Bt=[],Ct=[],ln=Dt[8]*Ue,Hn=Dt[9]*Ue,Vn=Dt[10]*Ue,Ln=Dt[11]*Ue,cn=Dt[8]*vt,Mi=Dt[9]*vt,vn=Dt[10]*vt,Wn=Dt[11]*vt;for(const Fi of dt){const $t=[],Hi=[];for(const Ii of Fi){const ht=Ii.x+Qt.x,nr=Ii.y+Qt.y,fo=Dt[0]*ht+Dt[4]*nr+Dt[12],pe=Dt[1]*ht+Dt[5]*nr+Dt[13],xe=Dt[2]*ht+Dt[6]*nr+Dt[14],It=Dt[3]*ht+Dt[7]*nr+Dt[15],hi=fo+ln,Ji=pe+Hn,Sr=xe+Vn,ki=Math.max(It+Ln,1e-5),Xi=fo+cn,Ur=pe+Mi,no=xe+vn,jr=Math.max(It+Wn,1e-5);$t.push(new Ya(hi/ki,Ji/ki,Sr/ki)),Hi.push(new Ya(Xi/jr,Ur/jr,no/jr))}Bt.push($t),Ct.push(Hi)}return[Bt,Ct]}(_e,de,Oe,Pe,Ge)),ne=s.queryGeometry;var ce,_e,de,Oe,Pe,Ge,Ze,Be,Ye,et;return function(ce,_e,de){let Oe=1/0;Bg(de,_e)&&(Oe=lm(de,_e[0]));for(let Pe=0;Pe<_e.length;Pe++){const Ge=_e[Pe],Ze=ce[Pe];for(let Be=0;Be<Ge.length-1;Be++){const Ye=Ge[Be],et=[Ye,Ge[Be+1],Ze[Be+1],Ze[Be],Ye];Ng(de,et)&&(Oe=Math.min(Oe,lm(de,et)))}}return Oe!==1/0&&Oe}(ie,he,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends sa{constructor(s){super(s,d_),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if("line-gradient"===s){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof kc,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,r){super.recalculate(s,r),this.paint._values["line-floorwidth"]=Dd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new um(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new Gc(this,s)}queryRadius(s){const r=s,a=Zv(bd("line-width",this,r),bd("line-gap-width",this,r)),u=bd("line-offset",this,r);return a/2+Math.abs(u)+xd(this.paint.get("line-translate"))}queryIntersectsFeature(s,r,a,u,p,g){if(s.queryGeometry.isAboveHorizon)return!1;const y=Ap(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),x=s.pixelToTileUnitsFactor/2*Zv(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),E=this.paint.get("line-offset").evaluate(r,a);return E&&(u=function(D,A){const P=[],O=new it(0,0);for(let B=0;B<D.length;B++){const z=D[B],$=[];for(let Z=0;Z<z.length;Z++){const he=z[Z],ne=z[Z+1],ce=0===Z?O:he.sub(z[Z-1])._unit()._perp(),_e=Z===z.length-1?O:ne.sub(he)._unit()._perp(),de=ce._add(_e)._unit();de._mult(1/(de.x*_e.x+de.y*_e.y)),$.push(de._mult(A)._add(he))}P.push($)}return P}(u,E*s.pixelToTileUnitsFactor)),function(D,A,P){for(let O=0;O<A.length;O++){const B=A[O];if(D.length>=3)for(let z=0;z<B.length;z++)if(Lu(D,B[z]))return!0;if(Mv(D,B,P))return!0}return!1}(y,u,x)}isTileClipped(){return!0}},symbol:F_,background:class extends sa{constructor(s){super(s,O_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends sa{constructor(s){super(s,wb)}getProgramIds(){return["raster"]}},sky:class extends sa{constructor(s){super(s,Hw),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){"sky-gradient"===s?this._updateColorRamp():"sky-atmosphere-sun"!==s&&"sky-atmosphere-halo-color"!==s&&"sky-atmosphere-color"!==s&&"sky-atmosphere-sun-intensity"!==s||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Wg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(s,r){if("atmosphere"===this.paint.get("sky-type")){const u=this.paint.get("sky-atmosphere-sun"),p=!u,g=s.style.light,y=g.properties.get("position");return p&&"viewport"===g.properties.get("anchor")&&ei("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?L_(y.azimuthal,90-y.polar,r):L_(u[0],90-u[1],r)}const a=this.paint.get("sky-gradient-center");return L_(a[0],90-a[1],r)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return"atmosphere"===s?["skyboxCapture","skybox"]:"gradient"===s?["skyboxGradient"]:null}}};class Hp{constructor(r,a,u,p){this.context=r,this.format=u,this.texture=r.gl.createTexture(),this.update(a,p)}update(r,a,u){const{width:p,height:g}=r,{context:y}=this,{gl:x}=y,{HTMLImageElement:E,HTMLCanvasElement:D,HTMLVideoElement:A,ImageData:P,ImageBitmap:O}=Ie;if(x.bindTexture(x.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!a||!1!==a.premultiply)),u||this.size&&this.size[0]===p&&this.size[1]===g){const{x:B,y:z}=u||{x:0,y:0};r instanceof E||r instanceof D||r instanceof A||r instanceof P||O&&r instanceof O?x.texSubImage2D(x.TEXTURE_2D,0,B,z,x.RGBA,x.UNSIGNED_BYTE,r):x.texSubImage2D(x.TEXTURE_2D,0,B,z,p,g,x.RGBA,x.UNSIGNED_BYTE,r.data)}else this.size=[p,g],r instanceof E||r instanceof D||r instanceof A||r instanceof P||O&&r instanceof O?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,r):x.texImage2D(x.TEXTURE_2D,0,this.format,p,g,0,this.format,x.UNSIGNED_BYTE,r.data);this.useMipmap=Boolean(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,a){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?r===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:r),this.filter=r),a!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Gw{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class N_{constructor(){this.tasks={},this.taskQueue=[],Xo(["process"],this),this.invoker=new Gw(this.process),this.nextId=0}add(r,a){const u=this.nextId++,p=function({type:g,isSymbolTile:y,zoom:x}){return x=x||0,"message"===g?0:"maybePrepare"!==g||y?"parseTile"!==g||y?"parseTile"===g&&y?300-x:"maybePrepare"===g&&y?400-x:500:200-x:100-x}(a);if(0===p){ys();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:r,metadata:a,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){ys();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const r=this.pick();if(null===r)return;const a=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let r=null,a=1/0;for(let p=0;p<this.taskQueue.length;p++){const g=this.tasks[this.taskQueue[p]];g.priority<a&&(a=g.priority,r=p)}if(null===r)return null;const u=this.taskQueue[r];return this.taskQueue.splice(r,1),u}remove(){this.invoker.remove()}}class Eb{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const u=r[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const qw=["tile","layer","source","sourceLayer","state"];class Db{constructor(r,a,u,p,g){this.type="Feature",this._vectorTileFeature=r,this._z=a,this._x=u,this._y=p,this.properties=r.properties,this.id=g}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(r.id=this.id);for(const a of qw)void 0!==this[a]&&(r[a]=this[a]);return r}}const Xa=32,dc=33,$o=new Uint16Array(8184);for(let s=0;s<2046;s++){let r=s+2,a=0,u=0,p=0,g=0,y=0,x=0;for(1&r?p=g=y=Xa:a=u=x=Xa;(r>>=1)>1;){const D=a+p>>1,A=u+g>>1;1&r?(p=a,g=u,a=y,u=x):(a=p,u=g,p=y,g=x),y=D,x=A}const E=4*s;$o[E+0]=a,$o[E+1]=u,$o[E+2]=p,$o[E+3]=g}const Ka=new Uint16Array(2178),ju=new Uint8Array(1089),Sm=new Uint16Array(1089);function B_(s){return 0===s?-.03125:32===s?.03125:0}var Mb=Wt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Sb={type:2,extent:fn,loadGeometry:()=>[[new it(0,0),new it(8193,0),new it(8193,8193),new it(0,8193),new it(0,0)]]};class z_{constructor(r,a,u,p,g){this.tileID=r,this.uid=_a(),this.uses=0,this.tileSize=a,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(r){const a=r+this.timeAdded;a<Qn.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=tu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,a,u){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,g){const y={};if(!g)return y;for(const x of p){const E=x.layerIds.map(D=>g.getLayer(D)).filter(Boolean);if(0!==E.length){x.layers=E,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(D=>E.filter(A=>A.id===D)[0]));for(const D of E)y[D.id]=x}}return y}(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof Uu){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof Uu&&g.hasRTLText){this.hasRTLText=!0,we.isLoading()||we.isLoaded()||"deferred"!==ye()||ge();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(g))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new fg}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Hp(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Hp(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Hp(r,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,u,p,g,y,x,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:x,transform:y,params:g,tileTransform:this.tileTransform},r,a,u):{}}querySourceFeatures(r,a){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),g=a?a.sourceLayer:"",y=p._geojsonTileLayer||p[g];if(!y)return;const x=ad(a&&a.filter),{z:E,x:D,y:A}=this.tileID.canonical,P={z:E,x:D,y:A};for(let O=0;O<y.length;O++){const B=y.feature(O);if(x.needGeometry){const Z=Wc(B,!0);if(!x.filter(new Se(this.tileID.overscaledZ),Z,this.tileID.canonical))continue}else if(!x.filter(new Se(this.tileID.overscaledZ),B))continue;const z=u.getId(B,g),$=new Db(B,E,D,A,z);$.tile=P,r.push($)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const u=Gn(r.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const g=this.expirationTime-a;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(r).length||!a)return;const u=this.latestFeatureIndex.loadVTLayers(),p=a.style.listImages();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const y=this.buckets[g],x=y.layers[0].sourceLayer||"_geojsonTileLayer",E=u[x],D=r[x];if(!E||!D||0===Object.keys(D).length)continue;if(y.update(D,E,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof um||y instanceof Jg){const P=a.style._getSourceCache(y.layers[0].source);a._terrain&&a._terrain.enabled&&P&&y.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(P.id,this.tileID)}const A=a&&a.style&&a.style.getLayer(g);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Qn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=Qn.now()+r}setTexture(r,a){const u=a.context,p=u.gl;this.texture=this.texture||a.getTileTexture(r.width),this.texture?this.texture.update(r,{useMipmap:!0}):(this.texture=new Hp(u,r,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(r,a){const u={};for(const p of a)u[p]=!0;this.dependencies[r]=u}hasDependency(r,a){for(const u of r){const p=this.dependencies[u];if(p)for(const g of a)if(p[g])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,a){if(!a||"mercator"===a.name||this._tileDebugBuffer)return;const u=rc(Sb,this.tileID.canonical,this.tileTransform)[0],p=new Kt,g=new Ql;for(let y=0;y<u.length;y++){const{x,y:E}=u[y];p.emplaceBack(x,E),g.emplaceBack(y)}g.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(g),this._tileDebugBuffer=r.createVertexBuffer(p,wp.members),this._tileDebugSegments=_r.simpleSegment(0,0,p.length,g.length)}_makeTileBoundsBuffers(r,a){if(this._tileBoundsBuffer||!a||"mercator"===a.name)return;const u=rc(Sb,this.tileID.canonical,this.tileTransform)[0];let p,g;if(this.isRaster){const y=function(x,E){const D=tu(x,E),A=Math.pow(2,x.z);for(let Z=0;Z<dc;Z++)for(let ie=0;ie<dc;ie++){const he=So((x.x+(ie+B_(ie))/Xa)/A),ne=to((x.y+(Z+B_(Z))/Xa)/A),ce=E.project(he,ne),_e=Z*dc+ie;Ka[2*_e+0]=Math.round((ce.x*D.scale-D.x)*fn),Ka[2*_e+1]=Math.round((ce.y*D.scale-D.y)*fn)}ju.fill(0),Sm.fill(0);for(let Z=2045;Z>=0;Z--){const ie=4*Z,he=$o[ie+0],ne=$o[ie+1],ce=$o[ie+2],_e=$o[ie+3],de=he+ce>>1,Oe=ne+_e>>1,Pe=de+Oe-ne,Ge=Oe+he-de,Ze=ne*dc+he,Be=_e*dc+ce,Ye=Oe*dc+de,et=Math.hypot((Ka[2*Ze+0]+Ka[2*Be+0])/2-Ka[2*Ye+0],(Ka[2*Ze+1]+Ka[2*Be+1])/2-Ka[2*Ye+1])>=16;ju[Ye]=ju[Ye]||(et?1:0),Z<1022&&(ju[Ye]=ju[Ye]||ju[(ne+Ge>>1)*dc+(he+Pe>>1)]||ju[(_e+Ge>>1)*dc+(ce+Pe>>1)])}const P=new di,O=new Qr;let B=0;function z(Z,ie){const he=ie*dc+Z;return 0===Sm[he]&&(P.emplaceBack(Ka[2*he+0],Ka[2*he+1],Z*fn/Xa,ie*fn/Xa),Sm[he]=++B),Sm[he]-1}function $(Z,ie,he,ne,ce,_e){const de=Z+he>>1,Oe=ie+ne>>1;if(Math.abs(Z-ce)+Math.abs(ie-_e)>1&&ju[Oe*dc+de])$(ce,_e,Z,ie,de,Oe),$(he,ne,ce,_e,de,Oe);else{const Pe=z(Z,ie),Ge=z(he,ne),Ze=z(ce,_e);O.emplaceBack(Pe,Ge,Ze)}}return $(0,0,Xa,Xa,Xa,0),$(Xa,Xa,0,0,0,Xa),{vertices:P,indices:O}}(this.tileID.canonical,a);p=y.vertices,g=y.indices}else{p=new di,g=new Qr;for(const{x,y:E}of u)p.emplaceBack(x,E,0,0);const y=Nu(p.int16,void 0,4);for(let x=0;x<y.length;x+=3)g.emplaceBack(y[x],y[x+1],y[x+2])}this._tileBoundsBuffer=r.createVertexBuffer(p,Mb.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(g),this._tileBoundsSegments=_r.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugBuffers(r,a){const u=a.projection;if(!u||"globe"!==u.name||a.freezeTileCoverage)return;const p=this.tileID.canonical,g=_h(wv(p,a)),y=yh(a.zoom);let x;y>0&&(x=uh(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,p,a,g,x,y),this._makeGlobeTileDebugTextBuffer(r,p,a,g,x,y)}_globePoint(r,a,u,p,g,y,x){let E=gh(r,a,u);if(y){const D=1<<u.z,A=Ga(p.center.lng),P=qa(p.center.lat),O=(u.x+.5)/D-A;let B=0;O>.5?B=-1:O<-.5&&(B=1);let z=(r/fn+u.x)/D+B,$=(a/fn+u.y)/D;z=(z-A)*p._pixelsPerMercatorPixel+A,$=($-P)*p._pixelsPerMercatorPixel+P;const Z=[z*p.worldSize,$*p.worldSize,0];pr(Z,Z,y),E=yd(E,Z,x)}return pr(E,E,g)}_makeGlobeTileDebugBorderBuffer(r,a,u,p,g,y){const x=new Kt,E=new Ql,D=new gi,A=(O,B,z,$,Z)=>{const ie=(z-O)/(Z-1),he=($-B)/(Z-1),ne=x.length;for(let ce=0;ce<Z;ce++){const _e=O+ce*ie,de=B+ce*he;x.emplaceBack(_e,de);const Oe=this._globePoint(_e,de,a,u,p,g,y);D.emplaceBack(Oe[0],Oe[1],Oe[2]),E.emplaceBack(ne+ce)}},P=fn;A(0,0,P,0,16),A(P,0,P,P,16),A(P,P,0,P,16),A(0,P,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(E),this._tileDebugBuffer=r.createVertexBuffer(x,wp.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(D,ew.members),this._tileDebugSegments=_r.simpleSegment(0,0,x.length,E.length)}_makeGlobeTileDebugTextBuffer(r,a,u,p,g,y){const x=new Kt,E=new Qr,D=new gi,A=25;E.reserve(32),x.reserve(A),D.reserve(A);const P=(O,B)=>A*O+B;for(let O=0;O<A;O++){const B=2048*O;for(let z=0;z<A;z++){const $=2048*z;x.emplaceBack($,B);const Z=this._globePoint($,B,a,u,p,g,y);D.emplaceBack(Z[0],Z[1],Z[2])}}for(let O=0;O<4;O++)for(let B=0;B<4;B++){const z=P(O,B),$=P(O,B+1),Z=P(O+1,B),ie=P(O+1,B+1);E.emplaceBack(z,$,Z),E.emplaceBack(Z,$,ie)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(E),this._tileDebugTextBuffer=r.createVertexBuffer(x,wp.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(D,ew.members),this._tileDebugTextSegments=_r.simpleSegment(0,0,A,32)}}class V_{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,u){const p=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},xn(this.stateChanges[r][p],u),null===this.deletedStates[r]){this.deletedStates[r]={};for(const g in this.state[r])g!==p&&(this.deletedStates[r][g]=null)}else if(this.deletedStates[r]&&null===this.deletedStates[r][p]){this.deletedStates[r][p]={};for(const g in this.state[r][p])u[g]||(this.deletedStates[r][p][g]=null)}else for(const g in u)this.deletedStates[r]&&this.deletedStates[r][p]&&null===this.deletedStates[r][p][g]&&delete this.deletedStates[r][p][g]}removeFeatureState(r,a,u){if(null===this.deletedStates[r])return;const p=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},u&&void 0!==a)null!==this.deletedStates[r][p]&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][u]=null);else if(void 0!==a)if(this.stateChanges[r]&&this.stateChanges[r][p])for(u in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][u]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,a){const u=String(a),p=xn({},(this.state[r]||{})[u],(this.stateChanges[r]||{})[u]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){const g=this.deletedStates[r][a];if(null===g)return{};for(const y in g)delete p[y]}return p}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const y in this.stateChanges[p])this.state[p][y]||(this.state[p][y]={}),xn(this.state[p][y],this.stateChanges[p][y]),g[y]=this.state[p][y];u[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(null===this.deletedStates[p])for(const y in this.state[p])g[y]={},this.state[p][y]={};else for(const y in this.deletedStates[p]){if(null===this.deletedStates[p][y])this.state[p][y]={};else if(this.state[p][y])for(const x of Object.keys(this.deletedStates[p][y]))delete this.state[p][y][x];g[y]=this.state[p][y]}u[p]=u[p]||{},xn(u[p],g)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(u).length)for(const p in r)r[p].setFeatureState(u,a)}}class Tb{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,a){const u=this.toIdx(r,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(r,a){return this.leaves[this.toIdx(r,a)]}toIdx(r,a){return a*this.size+r}}function Ab(s,r,a,u){let p=0,g=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(u[y])<1e-15){if(a[y]<s[y]||a[y]>r[y])return null}else{const x=1/u[y];let E=(s[y]-a[y])*x,D=(r[y]-a[y])*x;if(E>D){const A=E;E=D,D=A}if(E>p&&(p=E),D<g&&(g=D),p>g)return null}return p}function Gp(s,r,a,u,p,g,y,x,E,D,A){const P=u-s,O=p-r,B=g-a,z=y-s,$=x-r,Z=E-a,ie=A[1]*Z-A[2]*$,he=A[2]*z-A[0]*Z,ne=A[0]*$-A[1]*z,ce=P*ie+O*he+B*ne;if(Math.abs(ce)<1e-15)return null;const _e=1/ce,de=D[0]-s,Oe=D[1]-r,Pe=D[2]-a,Ge=(de*ie+Oe*he+Pe*ne)*_e;if(Ge<0||Ge>1)return null;const Ze=Oe*B-Pe*O,Be=Pe*P-de*B,Ye=de*O-Oe*P,et=(A[0]*Ze+A[1]*Be+A[2]*Ye)*_e;return et<0||Ge+et>1?null:(z*Ze+$*Be+Z*Ye)*_e}function qp(s,r,a){return(s-r)/(a-r)}function Wp(s,r,a,u,p,g,y,x,E){const D=1<<a,A=g-u,P=y-p,O=(s+1)/D*A+u,B=(r+0)/D*P+p,z=(r+1)/D*P+p;x[0]=(s+0)/D*A+u,x[1]=B,E[0]=O,E[1]=z}class Ww{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(g){const y=Math.ceil(Math.log2(g.dim/8)),x=[];let E=Math.ceil(Math.pow(2,y));const D=1/E,A=(B,z,$,Z,ie)=>{const he=Z?1:0,ne=(B+1)*$-he,ce=z*$,_e=(z+1)*$-he;ie[0]=B*$,ie[1]=ce,ie[2]=ne,ie[3]=_e};let P=new Tb(E);const O=[];for(let B=0;B<E*E;B++){A(B%E,Math.floor(B/E),D,!1,O);const z=Md(O[0],O[1],g),$=Md(O[2],O[1],g),Z=Md(O[2],O[3],g),ie=Md(O[0],O[3],g);P.minimums.push(Math.min(z,$,Z,ie)),P.maximums.push(Math.max(z,$,Z,ie)),P.leaves.push(1)}for(x.push(P),E/=2;E>=1;E/=2){const B=x[x.length-1];P=new Tb(E);for(let z=0;z<E*E;z++){A(z%E,Math.floor(z/E),2,!0,O);const $=B.getElevation(O[0],O[1]),Z=B.getElevation(O[2],O[1]),ie=B.getElevation(O[2],O[3]),he=B.getElevation(O[0],O[3]),ne=B.isLeaf(O[0],O[1]),ce=B.isLeaf(O[2],O[1]),_e=B.isLeaf(O[2],O[3]),de=B.isLeaf(O[0],O[3]),Oe=Math.min($.min,Z.min,ie.min,he.min),Pe=Math.max($.max,Z.max,ie.max,he.max),Ge=ne&&ce&&_e&&de;P.maximums.push(Pe),P.minimums.push(Oe),P.leaves.push(Pe-Oe<=5&&Ge?1:0)}x.push(P)}return x}(this.dem),u=a.length-1,p=a[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(r,a,u,p,g,y,x=1){return Ab([r,a,-100],[u,p,this.maximums[0]*x],g,y)}raycast(r,a,u,p,g,y,x=1){if(!this.nodeCount)return null;const E=this.raycastRoot(r,a,u,p,g,y,x);if(null==E)return null;const D=[],A=[],P=[],O=[],B=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:z,t:$,nodex:Z,nodey:ie,depth:he}=B.pop();if(this.leaves[z]){Wp(Z,ie,he,r,a,u,p,P,O);const ce=1<<he,_e=(Z+0)/ce,de=(Z+1)/ce,Oe=(ie+0)/ce,Pe=(ie+1)/ce,Ge=Md(_e,Oe,this.dem)*x,Ze=Md(de,Oe,this.dem)*x,Be=Md(de,Pe,this.dem)*x,Ye=Md(_e,Pe,this.dem)*x,et=Gp(P[0],P[1],Ge,O[0],P[1],Ze,O[0],O[1],Be,g,y),at=Gp(O[0],O[1],Be,P[0],O[1],Ye,P[0],P[1],Ge,g,y),dt=Math.min(null!==et?et:Number.MAX_VALUE,null!==at?at:Number.MAX_VALUE);if(dt!==Number.MAX_VALUE)return dt;{const Ue=xp([],g,y,$);if(Tm(Ge,Ze,Ye,Be,qp(Ue[0],P[0],O[0]),qp(Ue[1],P[1],O[1]))>=Ue[2])return $}continue}let ne=0;for(let ce=0;ce<this._siblingOffset.length;ce++){Wp((Z<<1)+this._siblingOffset[ce][0],(ie<<1)+this._siblingOffset[ce][1],he+1,r,a,u,p,P,O),P[2]=-100,O[2]=this.maximums[this.childOffsets[z]+ce]*x;const _e=Ab(P,O,g,y);if(null!=_e){const de=_e;D[ce]=de;let Oe=!1;for(let Pe=0;Pe<ne&&!Oe;Pe++)de>=D[A[Pe]]&&(A.splice(Pe,0,ce),Oe=!0);Oe||(A[ne]=ce),ne++}}for(let ce=0;ce<ne;ce++){const _e=A[ce];B.push({idx:this.childOffsets[z]+_e,t:D[_e],nodex:(Z<<1)+this._siblingOffset[_e][0],nodey:(ie<<1)+this._siblingOffset[_e][1],depth:he+1})}}return null}_addNode(r,a,u){return this.minimums.push(r),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(r,a,u,p,g){if(1===r[p].isLeaf(a,u))return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const y=p-1,x=r[y];let E=0,D=0;for(let A=0;A<this._siblingOffset.length;A++){const P=2*a+this._siblingOffset[A][0],O=2*u+this._siblingOffset[A][1],B=x.getElevation(P,O),z=x.isLeaf(P,O),$=this._addNode(B.min,B.max,z);z&&(E|=1<<A),D||(D=$)}for(let A=0;A<this._siblingOffset.length;A++)E&1<<A||this._construct(r,2*a+this._siblingOffset[A][0],2*u+this._siblingOffset[A][1],y,D+A)}}function Tm(s,r,a,u,p,g){return zn(zn(s,a,g),zn(r,u,g),p)}function Md(s,r,a){const u=a.dim,p=gn(s*u-.5,0,u-1),g=gn(r*u-.5,0,u-1),y=Math.floor(p),x=Math.floor(g),E=Math.min(y+1,u-1),D=Math.min(x+1,u-1);return Tm(a.get(y,x),a.get(E,x),a.get(y,D),a.get(E,D),p-y,g-x)}const U_={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ib(s,r,a){return(256*s*256+256*r+a)/10-1e4}function kb(s,r,a){return 256*s+r+a/256-32768}class Zp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,a,u,p=!1,g=!1){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return ei(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const y=this.dim=a.height-2,x=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=u||"mapbox",this.borderReady=p,!p){for(let E=0;E<y;E++)x[this._idx(-1,E)]=x[this._idx(0,E)],x[this._idx(y,E)]=x[this._idx(y-1,E)],x[this._idx(E,-1)]=x[this._idx(E,0)],x[this._idx(E,y)]=x[this._idx(E,y-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(y,-1)]=x[this._idx(y-1,0)],x[this._idx(-1,y)]=x[this._idx(0,y-1)],x[this._idx(y,y)]=x[this._idx(y-1,y-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ww(this)}get(r,a,u=!1){u&&(r=gn(r,-1,this.dim),a=gn(a,-1,this.dim));const p=4*this._idx(r,a);return("terrarium"===this.encoding?kb:Ib)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(r){return U_[r]}get unpackVector(){return U_[this.encoding]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}static pack(r,a){const u=[0,0,0,0],p=Zp.getUnpackVector(a);let g=Math.floor((r+p[3])/p[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new ps({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,a,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,g=a*this.dim+this.dim,y=u*this.dim,x=u*this.dim+this.dim;switch(a){case-1:p=g-1;break;case 1:g=p+1}switch(u){case-1:y=x-1;break;case 1:x=y+1}const E=-a*this.dim,D=-u*this.dim;for(let A=y;A<x;A++)for(let P=p;P<g;P++){const O=4*this._idx(P,A),B=4*this._idx(P+E,A+D);this.pixels[O+0]=r.pixels[B+0],this.pixels[O+1]=r.pixels[B+1],this.pixels[O+2]=r.pixels[B+2],this.pixels[O+3]=r.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ot(Zp,"DEMData"),Ot(Ww,"DemMinMaxQuadTree",{omit:["dem"]});class j_{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,u){const p=r.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const g={value:a,timeout:void 0};if(void 0!==u&&(g.timeout=setTimeout(()=>{this.remove(r,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const u=r.wrapped().key,p=void 0===a?0:this.data[u].indexOf(a),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),0===this.data[u].length&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const u in this.data)for(const p of this.data[u])r(p.value)||a.push(p);for(const u of a)this.remove(u.value.tileID,u)}}class Ws{constructor(r,a,u){this.func=r,this.mask=a,this.range=u}}Ws.ReadOnly=!1,Ws.ReadWrite=!0,Ws.disabled=new Ws(519,Ws.ReadOnly,[0,1]);class Rh{constructor(r,a,u,p,g,y){this.test=r,this.ref=a,this.mask=u,this.fail=p,this.depthFail=g,this.pass=y}}Rh.disabled=new Rh({func:519,mask:0},0,0,7680,7680,7680);class Zs{constructor(r,a,u){this.blendFunction=r,this.blendColor=a,this.mask=u}}Zs.Replace=[1,0],Zs.disabled=new Zs(Zs.Replace,sr.transparent,[!1,!1,!1,!1]),Zs.unblended=new Zs(Zs.Replace,sr.transparent,[!0,!0,!0,!0]),Zs.alphaBlended=new Zs([1,771],sr.transparent,[!0,!0,!0,!0]);class Qa{constructor(r,a,u){this.enable=r,this.mode=a,this.frontFace=u}}Qa.disabled=new Qa(!1,1029,2305),Qa.backCCW=new Qa(!0,1029,2305),Qa.backCW=new Qa(!0,1029,2304),Qa.frontCW=new Qa(!0,1028,2304),Qa.frontCCW=new Qa(!0,1028,2305);class Sd extends Ns{constructor(r,a,u){super(),this.id=r,this._onlySymbols=u,a.on("data",p=>{"source"===p.dataType&&"metadata"===p.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===p.dataType&&"content"===p.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new j_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new V_,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(r){this.map=r,this._minTileCacheSize=void 0===this._minTileCacheSize&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const a=this._tiles[r];if("loaded"!==a.state&&"errored"!==a.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,a){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,a)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const u=this._tiles[a];u.upload(r),u.prepare(this.map.style.imageManager)}}getIds(){return Ro(this._tiles).map(r=>r.tileID).sort(Pb).map(r=>r.key)}getRenderableIds(r){const a=[];for(const u in this._tiles)this._isIdRenderable(+u,r)&&a.push(this._tiles[u]);return r?a.sort((u,p)=>{const g=u.tileID,y=p.tileID,x=new it(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new it(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-y.overscaledZ||E.y-x.y||E.x-x.x}).map(u=>u.tileID.key):a.map(u=>u.tileID).sort(Pb).map(u=>u.key)}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(+r,"reloading")}}_reloadTile(r,a){const u=this._tiles[r];u&&("loading"!==u.state&&(u.state=a),this._loadTile(u,this._tileLoaded.bind(this,u,r,a)))}_tileLoaded(r,a,u,p){if(p)if(r.state="errored",404!==p.status)this._source.fire(new Js(p,{tile:r}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else r.timeAdded=Qn.now(),"expired"===u&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),"raster-dem"===this._source.type&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new Ei("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const g=a[p];if(r.neighboringTiles&&r.neighboringTiles[g]){const y=this.getTileByID(g);u(r,y),u(y,r)}}function u(p,g){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let y=g.tileID.canonical.x-p.tileID.canonical.x;const x=g.tileID.canonical.y-p.tileID.canonical.y,E=Math.pow(2,p.tileID.canonical.z),D=g.tileID.key;0===y&&0===x||Math.abs(x)>1||(Math.abs(y)>1&&(1===Math.abs(y+E)?y+=E:1===Math.abs(y-E)&&(y-=E)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,y,x),p.neighboringTiles&&p.neighboringTiles[D]&&(p.neighboringTiles[D].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,u,p){for(const g in this._tiles){let y=this._tiles[g];if(p[g]||!y.hasData()||y.tileID.overscaledZ<=a||y.tileID.overscaledZ>u)continue;let x=y.tileID;for(;y&&y.tileID.overscaledZ>a+1;){const D=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[D.key],y&&y.hasData()&&(x=D)}let E=x;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),r[E.key]){p[x.key]=x;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const u=this._loadedParentTiles[r.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=r.overscaledZ-1;u>=a;u--){const p=r.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,a){a=a||this._source.tileSize;const u=Math.ceil(r.width/a)+1,p=Math.ceil(r.height/a)+1,g=Math.floor(u*p*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,g):g,x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(x)}handleWrapJump(r){const a=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,a){const u={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),u[g.tileID.key]=g}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(r,a,u){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let p;this.updateCacheSize(r,a),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Uo(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(p=r.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(x=>this._source.hasTile(x)))):p=[];const g=this._updateRetainedTiles(p);if(Fh(this._source.type)&&0!==p.length){const x={},E={},D=Object.keys(g);for(const P of D){const O=g[P],B=this._tiles[P];if(!B||B.fadeEndTime&&B.fadeEndTime<=Qn.now())continue;const z=this.findLoadedParent(O,Math.max(O.overscaledZ-Sd.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),x[z.tileID.key]=z.tileID),E[P]=O}const A=p[p.length-1].overscaledZ;for(const P in this._tiles){const O=this._tiles[P];if(g[P]||!O.hasData())continue;let B=O.tileID;for(;B.overscaledZ>A;){B=B.scaledTo(B.overscaledZ-1);const z=this._tiles[B.key];if(z&&z.hasData()&&E[B.key]){g[P]=O.tileID;break}}}for(const P in x)g[P]||(this._coveredTiles[P]=!0,g[P]=x[P])}for(const x in g)this._tiles[x].clearFadeHold();const y=function(x,E){const D=[];for(const A in x)A in E||D.push(A);return D}(this._tiles,g);for(const x of y){const E=this._tiles[x];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const a={};if(0===r.length)return a;const u={},p=r.reduce((D,A)=>Math.min(D,A.overscaledZ),1/0),g=r[0].overscaledZ,y=Math.max(g-Sd.maxOverzooming,this._source.minzoom),x=Math.max(g+Sd.maxUnderzooming,this._source.minzoom),E={};for(const D of r){const A=this._addTile(D);a[D.key]=D,A.hasData()||p<this._source.maxzoom&&(E[D.key]=D)}this._retainLoadedChildren(E,p,x,a);for(const D of r){let A=this._tiles[D.key];if(A.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const O=D.children(this._source.maxzoom)[0],B=this.getTile(O);if(B&&B.hasData()){a[O.key]=O;continue}}else{const O=D.children(this._source.maxzoom);if(a[O[0].key]&&a[O[1].key]&&a[O[2].key]&&a[O[3].key])continue}let P=A.wasRequested();for(let O=D.overscaledZ-1;O>=y;--O){const B=D.scaledTo(O);if(u[B.key]||(u[B.key]=!0,A=this.getTile(B),!A&&P&&(A=this._addTile(B)),A&&(a[B.key]=B,P=A.wasRequested(),A.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let u,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}a.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(const g of a)this._loadedParentTiles[g]=u}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const u=Boolean(a);if(!u){const p=this.map?this.map.painter:null;a=new z_(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,r.key,a.state))}return a?(a.uses++,this._tiles[r.key]=a,u||this._source.fire(new Ei("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const u=a.getExpiryTimeout();u&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},u))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&"reloading"!==a.state?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,a,u){const p=[],g=this.transform;if(!g)return p;const y="globe"===g.projection.name,x=Ga(g.center.lng);for(const E in this._tiles){const D=this._tiles[E];if(u&&D.clearQueryDebugViz(),D.holdingForFade())continue;let A;if(y){const P=D.tileID.canonical;if(0===P.z){const O=[Math.abs(gn(x,...Yp(P,-1))-x),Math.abs(gn(x,...Yp(P,1))-x)];A=[0,2*O.indexOf(Math.min(...O))-1]}else{const O=[Math.abs(gn(x,...Yp(P,-1))-x),Math.abs(gn(x,...Yp(P,0))-x),Math.abs(gn(x,...Yp(P,1))-x)];A=[O.indexOf(Math.min(...O))-1]}}else A=[0];for(const P of A){const O=r.containsTile(D,g,a,P);O&&p.push(O)}}return p}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map(u=>this._tiles[u].tileID);for(const u of a)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Fh(this._source.type))for(const r in this._tiles){const a=this._tiles[r];if(void 0!==a.fadeEndTime&&a.fadeEndTime>=Qn.now())return!0}return!1}setFeatureState(r,a,u){this._state.updateState(r=r||"_geojsonTileLayer",a,u)}removeFeatureState(r,a,u){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,u)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,u){const p=this._tiles[r];p&&p.setDependencies(a,u)}reloadTilesForDependencies(r,a){for(const u in this._tiles)this._tiles[u].hasDependency(r,a)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(r,a))}_preloadTiles(r,a){const u=new Map,p=Array.isArray(r)?r:[r],g=this.map.painter.terrain,y=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const x of p){const E=x.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of E)u.set(D.key,D);this.usedForTerrain&&x.updateElevation(!1)}vo(Array.from(u.values()),(x,E)=>{const D=new z_(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,A=>{"raster-dem"===this._source.type&&D.dem&&this._backfillDEM(D),E(A,D)})},a)}}function Pb(s,r){const a=Math.abs(2*s.wrap)-+(s.wrap<0),u=Math.abs(2*r.wrap)-+(r.wrap<0);return s.overscaledZ-r.overscaledZ||u-a||r.canonical.y-s.canonical.y||r.canonical.x-s.canonical.x}function Fh(s){return"raster"===s||"image"===s||"video"===s||"custom"===s}function Yp(s,r){const a=1<<s.z;return[s.x/a+r,(s.x+1)/a+r]}Sd.maxOverzooming=10,Sd.maxUnderzooming=3;class H_{constructor(r,a,u){this._demTile=r,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(r,a,u){const p=u||r.findDEMTileFor(a);if(!p||!p.dem)return;const g=p.dem,y=p.tileID,x=1<<a.canonical.z-y.canonical.z;return new H_(p,p.tileSize/fn/x,[(a.canonical.x/x-y.canonical.x)*g.dim,(a.canonical.y/x-y.canonical.y)*g.dim])}tileCoordToPixel(r,a){const u=a*this._scale+this._offset[1],p=Math.floor(r*this._scale+this._offset[0]),g=Math.floor(u);return new it(p,g)}getElevationAt(r,a,u,p){const g=r*this._scale+this._offset[0],y=a*this._scale+this._offset[1],x=Math.floor(g),E=Math.floor(y),D=this._dem;return p=!!p,u?zn(zn(D.get(x,E,p),D.get(x,E+1,p),y-E),zn(D.get(x+1,E,p),D.get(x+1,E+1,p),y-E),g-x):D.get(x,E,p)}getElevationAtPixel(r,a,u){return this._dem.get(r,a,!!u)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*Wa(1,r)*this._dem.stride}}class Rb{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new En(fn,16,0),this.featureIndexArray=new _g,this.promoteId=a}insert(r,a,u,p,g,y=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,g,y);const E=this.grid;for(let D=0;D<a.length;D++){const A=a[D],P=[1/0,1/0,-1/0,-1/0];for(let O=0;O<A.length;O++){const B=A[O];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<fn&&P[1]<fn&&P[2]>=0&&P[3]>=0&&E.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Rp(new Np(this.rawTileData)).layers,this.sourceLayerCoder=new Eb(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,a,u,p){this.loadVTLayers();const g=r.params||{},y=ad(g.filter),x=r.tileResult,E=r.transform,D=x.bufferedTilespaceBounds,A=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(z,$,Z,ie)=>Ug(x.bufferedTilespaceGeometry,z,$,Z,ie));A.sort(Zw);let P=null;E.elevation&&A.length>0&&(P=H_.create(E.elevation,this.tileID));const O={};let B;for(let z=0;z<A.length;z++){const $=A[z];if($===B)continue;B=$;const Z=this.featureIndexArray.get($);let ie=null;this.loadMatchingFeature(O,Z,y,g.layers,g.availableImages,a,u,p,(he,ne,ce,_e=0)=>(ie||(ie=rc(he,this.tileID.canonical,r.tileTransform)),ne.queryIntersectsFeature(x,he,ce,ie,this.z,r.transform,r.pixelPosMatrix,P,_e)))}return O}loadMatchingFeature(r,a,u,p,g,y,x,E,D){const{featureIndex:A,bucketIndex:P,sourceLayerIndex:O,layoutVertexArrayOffset:B}=a,z=this.bucketLayerIDs[P];if(p&&!function(he,ne){for(let ce=0;ce<he.length;ce++)if(ne.indexOf(he[ce])>=0)return!0;return!1}(p,z))return;const $=this.sourceLayerCoder.decode(O),Z=this.vtLayers[$].feature(A);if(u.needGeometry){const he=Wc(Z,!0);if(!u.filter(new Se(this.tileID.overscaledZ),he,this.tileID.canonical))return}else if(!u.filter(new Se(this.tileID.overscaledZ),Z))return;const ie=this.getId(Z,$);for(let he=0;he<z.length;he++){const ne=z[he];if(p&&p.indexOf(ne)<0)continue;const ce=y[ne];if(!ce)continue;let _e={};void 0!==ie&&E&&(_e=E.getState(ce.sourceLayer||"_geojsonTileLayer",ie));const de=xn({},x[ne]);de.paint=Fb(de.paint,ce.paint,Z,_e,g),de.layout=Fb(de.layout,ce.layout,Z,_e,g);const Oe=!D||D(Z,ce,_e,B);if(!Oe)continue;const Pe=new Db(Z,this.z,this.x,this.y,ie);Pe.layer=de;let Ge=r[ne];void 0===Ge&&(Ge=r[ne]=[]),Ge.push({featureIndex:A,feature:Pe,intersectionZ:Oe})}}lookupSymbolFeatures(r,a,u,p,g,y,x,E){const D={};this.loadVTLayers();const A=ad(g);for(const P of r)this.loadMatchingFeature(D,{bucketIndex:u,sourceLayerIndex:p,featureIndex:P,layoutVertexArrayOffset:0},A,y,x,E,a);return D}loadFeature(r){const{featureIndex:a,sourceLayerIndex:u}=r;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),g=this.vtFeatures[p];if(g[a])return g[a];const y=this.vtLayers[p].feature(a);return g[a]=y,y}hasLayer(r){for(const a of this.bucketLayerIDs)for(const u of a)if(r===u)return!0;return!1}getId(r,a){let u=r.id;if(this.promoteId){const p="string"==typeof this.promoteId?this.promoteId:this.promoteId[a];null!=p&&(u=r.properties[p]),"boolean"==typeof u&&(u=Number(u))}return u}}function Fb(s,r,a,u,p){return Xn(s,(g,y)=>{const x=r instanceof Ne?r.get(y):null;return x&&x.evaluate?x.evaluate(a,u,p):x})}function Zw(s,r){return r-s}Ot(Rb,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Ob{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.image=new Za({width:r,height:a}),this.positions={},this.uploaded=!1}getDash(r,a){const u=this.getKey(r,a);return this.positions[u]}trim(){const r=this.width,a=this.height=Yo(this.nextRow);this.image.resize({width:r,height:a})}getKey(r,a){return r.join(",")+a}getDashRanges(r,a,u){const p=[];let g=r.length%2==1?-r[r.length-1]*u:0,y=r[0]*u,x=!0;p.push({left:g,right:y,isDash:x,zeroLength:0===r[0]});let E=r[0];for(let D=1;D<r.length;D++){x=!x;const A=r[D];g=E*u,E+=A,y=E*u,p.push({left:g,right:y,isDash:x,zeroLength:0===A})}return p}addRoundDash(r,a,u){const p=a/2;for(let g=-u;g<=u;g++){const y=this.width*(this.nextRow+u+g);let x=0,E=r[x];for(let D=0;D<this.width;D++){D/E.right>1&&(E=r[++x]);const A=Math.abs(D-E.left),P=Math.abs(D-E.right),O=Math.min(A,P);let B;const z=g/u*(p+1);if(E.isDash){const $=p-Math.abs(z);B=Math.sqrt(O*O+$*$)}else B=p-Math.sqrt(O*O+z*z);this.image.data[y+D]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(r,a){for(let E=r.length-1;E>=0;--E){const D=r[E],A=r[E+1];D.zeroLength?r.splice(E,1):A&&A.isDash===D.isDash&&(A.left=D.left,r.splice(E,1))}const u=r[0],p=r[r.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const g=this.width*this.nextRow;let y=0,x=r[y];for(let E=0;E<this.width;E++){E/x.right>1&&(x=r[++y]);const D=Math.abs(E-x.left),A=Math.abs(E-x.right),P=Math.min(D,A);this.image.data[g+E]=Math.max(0,Math.min(255,(x.isDash?P:-P)+a+128))}}addDash(r,a){const u=this.getKey(r,a);if(this.positions[u])return this.positions[u];const p="round"===a,g=p?7:0,y=2*g+1;if(this.nextRow+y>this.height)return ei("LineAtlas out of space"),null;0===r.length&&r.push(1);let x=0;for(let A=0;A<r.length;A++)r[A]<0&&(ei("Negative value is found in line dasharray, replacing values with 0"),r[A]=0),x+=r[A];if(0!==x){const A=this.width/x,P=this.getDashRanges(r,this.width,A);p?this.addRoundDash(P,A,g):this.addRegularDash(P,"square"===a?.5*A:0)}const E=this.nextRow+g;this.nextRow+=y;const D={tl:[E,g],br:[x,0]};return this.positions[u]=D,D}}Ot(Ob,"LineAtlas");class Lb{constructor(r){const a={},u=[];for(const x in r){const E=r[x],D=a[x]={};for(const A in E.glyphs){const P=E.glyphs[+A];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const O=P.metrics.localGlyph?2:1,B={x:0,y:0,w:P.bitmap.width+2*O,h:P.bitmap.height+2*O};u.push(B),D[A]=B}}const{w:p,h:g}=m_(u),y=new Za({width:p||1,height:g||1});for(const x in r){const E=r[x];for(const D in E.glyphs){const A=E.glyphs[+D];if(!A||0===A.bitmap.width||0===A.bitmap.height)continue;const P=a[x][D],O=A.metrics.localGlyph?2:1;Za.copy(A.bitmap,y,{x:0,y:0},{x:P.x+O,y:P.y+O},A.bitmap)}}this.image=y,this.positions=a}}Ot(Lb,"GlyphAtlas");class Yw{constructor(r){this.tileID=new Uo(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,this.tileTransform=tu(r.tileID.canonical,r.projection),this.projection=r.projection}parse(r,a,u,p,g){this.status="parsing",this.data=r,this.collisionBoxArray=new fg;const y=new Eb(Object.keys(r.layers).sort()),x=new Rb(this.tileID,this.promoteId);x.bucketLayerIDs=[];const E={},D=new Ob(256,256),A={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:u},P=a.familiesBySource[this.source];for(const _e in P){const de=r.layers[_e];if(!de)continue;let Oe=!1,Pe=!1;for(const Be of P[_e])"symbol"===Be[0].type?Oe=!0:Pe=!0;if(!0===this.isSymbolTile&&!Oe||!1===this.isSymbolTile&&!Pe)continue;1===de.version&&ei(`Vector tile source "${this.source}" layer "${_e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ge=y.encode(_e),Ze=[];for(let Be=0;Be<de.length;Be++){const Ye=de.feature(Be),et=x.getId(Ye,_e);Ze.push({feature:Ye,id:et,index:Be,sourceLayerIndex:Ge})}for(const Be of P[_e]){const Ye=Be[0];void 0!==this.isSymbolTile&&"symbol"===Ye.type!==this.isSymbolTile||Ye.minzoom&&this.zoom<Math.floor(Ye.minzoom)||Ye.maxzoom&&this.zoom>=Ye.maxzoom||"none"!==Ye.visibility&&(G_(Be,this.zoom,u),(E[Ye.id]=Ye.createBucket({index:x.bucketLayerIDs.length,layers:Be,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ge,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:u})).populate(Ze,A,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(Be.map(et=>et.id)))}}let O,B,z,$;D.trim();const Z={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ie=Xn(A.glyphDependencies,_e=>Object.keys(_e).map(Number));Object.keys(ie).length?p.send("getGlyphs",{uid:this.uid,stacks:ie},(_e,de)=>{O||(O=_e,B=de,ce.call(this))},void 0,!1,Z):B={};const he=Object.keys(A.iconDependencies);he.length?p.send("getImages",{icons:he,source:this.source,tileID:this.tileID,type:"icons"},(_e,de)=>{O||(O=_e,z=de,ce.call(this))},void 0,!1,Z):z={};const ne=Object.keys(A.patternDependencies);function ce(){if(O)return g(O);if(B&&z&&$){const _e=new Lb(B),de=new ib(z,$);for(const Oe in E){const Pe=E[Oe];Pe instanceof Uu?(G_(Pe.layers,this.zoom,u),gb(Pe,B,_e.positions,z,de.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):Pe.hasPattern&&(Pe instanceof um||Pe instanceof Jg||Pe instanceof Yc)&&(G_(Pe.layers,this.zoom,u),Pe.addFeatures(A,this.tileID.canonical,de.patternPositions,u,this.tileTransform))}this.status="done",g(null,{buckets:Ro(E).filter(Oe=>!Oe.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:_e.image,lineAtlas:D,imageAtlas:de,glyphMap:this.returnDependencies?B:null,iconMap:this.returnDependencies?z:null,glyphPositions:this.returnDependencies?_e.positions:null})}}ne.length?p.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"patterns"},(_e,de)=>{O||(O=_e,$=de,ce.call(this))},void 0,!1,Z):$={},ce.call(this)}}function G_(s,r,a){const u=new Se(r);for(const p of s)p.recalculate(u,a)}class q_{constructor(r){this.entries={},this.scheduler=r}request(r,a,u,p){const g=this.entries[r]=this.entries[r]||{callbacks:[]};if(g.result){const[y,x]=g.result;return this.scheduler?this.scheduler.add(()=>{p(y,x)},a):p(y,x),()=>{}}return g.callbacks.push(p),g.cancel||(g.cancel=u((y,x)=>{g.result=[y,x];for(const E of g.callbacks)this.scheduler?this.scheduler.add(()=>{E(y,x)},a):E(y,x);setTimeout(()=>delete this.entries[r],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(y=>y!==p),g.callbacks.length||(g.cancel(),delete this.entries[r]))}}}function Zn(s,r,a){const u=JSON.stringify(s.request);return s.data&&(this.deduped.entries[u]={result:[null,s.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},p=>{const g=sl(s.request,(y,x,E,D)=>{y?p(y):x&&p(null,{vectorTile:a?void 0:new Rp(new Np(x)),rawData:x,cacheControl:E,expires:D})});return()=>{g.cancel(),p()}},r)}h.ARRAY_TYPE=qs,h.AUTH_ERR_MSG=Fl,h.Aabb=Vo,h.Actor=class{constructor(s,r,a){this.target=s,this.parent=r,this.mapId=a,this.callbacks={},this.cancelCallbacks={},Xo(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ys()?s:Ie,this.scheduler=new N_}send(s,r,a,u,p=!1,g){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=g,this.callbacks[y]=a);const x=so(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:s,hasCallback:!!a,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:Su(r,x)},x),{cancel:()=>{a&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(s){const r=s.data,a=r.id;if(a&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const u=this.cancelCallbacks[a];delete this.cancelCallbacks[a],u&&u.cancel()}else if(r.mustQueue||ys()){const u=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add(()=>this.processTask(a,r),u&&u.metadata||{type:"message"})}else this.processTask(a,r)}processTask(s,r){if("<response>"===r.type){const a=this.callbacks[s];delete this.callbacks[s],a&&(r.error?a(hd(r.error)):a(null,hd(r.data)))}else{const a=so(this.globalScope)?void 0:[],u=r.hasCallback?(g,y)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:g?Su(g):null,data:Su(y,a)},a)}:g=>{},p=hd(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,p,u);else if(this.parent.getWorkerSource){const g=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,g[0],p.source)[g[1]](p,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},h.CanonicalTileID=sm,h.Color=sr,h.ColorMode=Zs,h.CullFaceMode=Qa,h.DEMData=Zp,h.DataConstantProperty=Me,h.DedupedRequest=q_,h.DepthMode=Ws,h.EXTENT=fn,h.Elevation=class{isDataAvailableAtPoint(s){const r=this._source();if(this.isUsingMockSource()||!r||s.y<0||s.y>1)return!1;const a=r.getSource().maxzoom,u=1<<a,p=Math.floor(s.x),g=Math.floor((s.x-p)*u),y=Math.floor(s.y*u),x=this.findDEMTileFor(new Uo(a,p,a,g,y));return!(!x||!x.dem)}getAtPointOrZero(s,r=0){return this.getAtPoint(s,r)||0}getAtPoint(s,r,a=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const u=this._source();if(!u||s.y<0||s.y>1)return r;const p=u.getSource().maxzoom,g=1<<p,y=Math.floor(s.x),x=s.x-y,E=new Uo(p,y,p,Math.floor(x*g),Math.floor(s.y*g)),D=this.findDEMTileFor(E);if(!D||!D.dem)return r;const A=D.dem,P=1<<D.tileID.canonical.z,O=(x*P-D.tileID.canonical.x)*A.dim,B=(s.y*P-D.tileID.canonical.y)*A.dim,z=Math.floor(O),$=Math.floor(B);return(a?this.exaggeration():1)*zn(zn(A.get(z,$),A.get(z,$+1),B-$),zn(A.get(z+1,$),A.get(z+1,$+1),B-$),O-z)}getAtTileOffset(s,r,a){const u=1<<s.canonical.z;return this.getAtPointOrZero(new bh(s.wrap+(s.canonical.x+r/fn)/u,(s.canonical.y+a/fn)/u))}getAtTileOffsetFunc(s,r,a,u){return p=>{const g=this.getAtTileOffset(s,p.x,p.y),y=u.upVector(s.canonical,p.x,p.y);return Ua(y,y,g*u.upVectorScale(s.canonical,r,a).metersToTile),y}}getForTilePoints(s,r,a,u){if(this.isUsingMockSource())return!1;const p=H_.create(this,s,u);return!!p&&(r.forEach(g=>{g[2]=this.exaggeration()*p.getElevationAt(g[0],g[1],a)}),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(s);if(!r||!r.dem)return null;const a=r.dem.tree,u=r.tileID,p=1<<s.canonical.z-u.canonical.z;let g=s.canonical.x/p-u.canonical.x,y=s.canonical.y/p-u.canonical.y,x=0;for(let E=0;E<s.canonical.z-u.canonical.z&&!a.leaves[x];E++){g*=2,y*=2;const D=2*Math.floor(y)+Math.floor(g);x=a.childOffsets[x]+D,g%=1,y%=1}return{min:this.exaggeration()*a.minimums[x],max:this.exaggeration()*a.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,r,a){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},h.ErrorEvent=Js,h.EvaluationParameters=Se,h.Event=Ei,h.Evented=Ns,h.FillExtrusionBucket=Yc,h.Frustum=Uf,h.FrustumCorners=Cp,h.GLOBE_RADIUS=wl,h.GLOBE_SCALE_MATCH_LATITUDE=45,h.GLOBE_ZOOM_THRESHOLD_MAX=6,h.GLOBE_ZOOM_THRESHOLD_MIN=5,h.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_fillGridMeshWithLods(s,r){const a=new Kt,u=new Qr,p=[],g=s+1+2,y=r[0]+1,x=r[0]+1+(1+r.length),E=(D,A,P)=>{let O=D===g-1?D-2:0===D?D:D-1;return O+=P?24575:0,[O,A]};for(let D=0;D<g;++D)a.emplaceBack(...E(D,0,!0));for(let D=0;D<y;++D)for(let A=0;A<g;++A)a.emplaceBack(...E(A,D,(0===A||A===g-1)&&!0));for(let D=0;D<r.length;++D){const A=r[D];for(let P=0;P<g;++P)a.emplaceBack(...E(P,A,!0))}for(let D=0;D<r.length;++D){const A=u.length,P=r[D]+1+2,O=new Qr;for(let $=0;$<P-1;$++){const Z=$===P-2,ie=Z?g*(x-r.length+D-$):g;for(let he=0;he<g-1;he++){const ne=$*g+he;0===$||Z||0===he||he===g-2?(O.emplaceBack(ne+1,ne,ne+ie),O.emplaceBack(ne+ie,ne+ie+1,ne+1)):(u.emplaceBack(ne+1,ne,ne+ie),u.emplaceBack(ne+ie,ne+ie+1,ne+1))}}const B=_r.simpleSegment(0,A,a.length,u.length-A);for(let $=0;$<O.uint16.length;$+=3)u.emplaceBack(O.uint16[$],O.uint16[$+1],O.uint16[$+2]);const z=_r.simpleSegment(0,A,a.length,u.length-A);p.push({withoutSkirts:B,withSkirts:z})}return{vertices:a,indices:u,segments:p}}_createGrid(s){const r=this._fillGridMeshWithLods(64,Ep);this._gridSegments=r.segments,this._gridBuffer=s.createVertexBuffer(r.vertices,wp.members),this._gridIndexBuffer=s.createIndexBuffer(r.indices,!0)}_createPoles(s){const r=new Qr;for(let p=0;p<=64;p++)r.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=s.createIndexBuffer(r,!0);const a=new Ds,u=new Ds;this._poleSegments=[];for(let p=0,g=0;p<5;p++){const y=360/(1<<p);a.emplaceBack(0,-wl,0,.5,0),u.emplaceBack(0,-wl,0,.5,1);for(let x=0;x<=64;x++){const E=x/64,D=zn(0,y,E),[A,P,O]=Vr(Tg,Ag,D,wl);a.emplaceBack(A,P,O,E,0),u.emplaceBack(A,P,O,E,1)}this._poleSegments.push(_r.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(a,Jx,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(u,Jx,!1)}getGridBuffers(s,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,r){if(!this._wireframeSegments){const a=new yl,u=64,p=u+1+2,g=1;this._wireframeSegments=[];for(let y=0,x=0;y<Ep.length;y++){const E=Ep[y];for(let A=g;A<E+g;A++)for(let P=g;P<u+g;P++){const O=A*p+P;a.emplaceBack(O,O+1),a.emplaceBack(O,O+p),a.emplaceBack(O,O+p+1)}const D=E*u*3;this._wireframeSegments.push(_r.simpleSegment(0,x,(E+1)*p,D)),x+=D}this._wireframeIndexBuffer=s.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[r]]}},h.GlyphManager=zu,h.ImagePosition=pm,h.LivePerformanceUtils=tt,h.LngLat=si,h.LngLatBounds=Fu,h.LocalGlyphMode=b_,h.MAX_MERCATOR_LATITUDE=To,h.MercatorCoordinate=bh,h.ONE_EM=jo,h.OverscaledTileID=Uo,h.PerformanceMarkers=Re,h.Properties=ut,h.RGBAImage=ps,h.Ray=Vf,h.RequestManager=class{constructor(s,r,a){this._transformRequestFn=s,this._customAccessToken=r,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const s=function(){let r="";for(let a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",pt,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,r){return this._transformRequestFn&&this._transformRequestFn(s,r)||{url:s}}normalizeStyleURL(s,r){if(!Ls(s))return s;const a=bo(s);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeGlyphsURL(s,r){if(!Ls(s))return s;const a=bo(s);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeSourceURL(s,r,a,u){if(!Ls(s))return s;const p=bo(s);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),a&&p.params.push(`language=${a}`),u&&p.params.push(`worldview=${u}`),this._makeAPIURL(p,this._customAccessToken||r)}normalizeSpriteURL(s,r,a,u){const p=bo(s);return Ls(s)?(p.path=`/styles/v1${p.path}/sprite${r}${a}`,this._makeAPIURL(p,this._customAccessToken||u)):(p.path+=`${r}${a}`,xa(p))}normalizeTileURL(s,r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!Ls(s))return s;const u=bo(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||a&&"raster"!==u.authority&&512===a?"@2x":""}${He.supported?".webp":"$1"}`),"raster"===u.authority?u.path=`/${xt.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${xt.TILE_URL_VERSION}${u.path}`);const p=this._customAccessToken||function(g){for(const y of g){const x=y.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(u.params)||xt.ACCESS_TOKEN;return xt.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,p)}canonicalizeTileURL(s,r){const a=bo(s);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return s;let u="mapbox://";a.path.match(/^\/raster\/v1\//)?u+=`raster/${a.path.replace(`/${xt.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${a.path.replace(`/${xt.TILE_URL_VERSION}/`,"")}`;let p=a.params;return r&&(p=p.filter(g=>!g.match(/^access_token=/))),p.length&&(u+=`?${p.join("&")}`),u}canonicalizeTileset(s,r){const a=!!r&&Ls(r),u=[];for(const p of s.tiles||[])Ol(p)?u.push(this.canonicalizeTileURL(p,a)):u.push(p);return u}_makeAPIURL(s,r){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=bo(xt.API_URL);if(s.protocol=u.protocol,s.authority=u.authority,"http"===s.protocol){const p=s.params.indexOf("secure");p>=0&&s.params.splice(p,1)}if("/"!==u.path&&(s.path=`${u.path}${s.path}`),!xt.REQUIRE_ACCESS_TOKEN)return xa(s);if(r=r||xt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return s.params=s.params.filter(p=>-1===p.indexOf("access_token")),s.params.push(`access_token=${r||""}`),xa(s)}},h.ResourceType=xc,h.SegmentVector=_r,h.SourceCache=Sd,h.StencilMode=Rh,h.StructArrayLayout1ui2=Ql,h.StructArrayLayout2f1f2i16=Br,h.StructArrayLayout2i4=Kt,h.StructArrayLayout2ui4=yl,h.StructArrayLayout3f12=po,h.StructArrayLayout3ui6=Qr,h.StructArrayLayout4i8=di,h.StructArrayLayout5f20=Ds,h.Texture=Hp,h.Tile=z_,h.Transitionable=mt,h.Uniform1f=vg,h.Uniform1i=class extends Ru{constructor(s){super(s),this.current=0}set(s,r,a){this.fetchUniformLocation(s,r)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},h.Uniform2f=class extends Ru{constructor(s){super(s),this.current=[0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},h.Uniform3f=class extends Ru{constructor(s){super(s),this.current=[0,0,0]}set(s,r,a){this.fetchUniformLocation(s,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},h.Uniform4f=Hx,h.UniformColor=Gx,h.UniformMatrix2f=class extends Ru{constructor(s){super(s),this.current=bD}set(s,r,a){if(this.fetchUniformLocation(s,r))for(let u=0;u<4;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}},h.UniformMatrix3f=class extends Ru{constructor(s){super(s),this.current=vD}set(s,r,a){if(this.fetchUniformLocation(s,r))for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},h.UniformMatrix4f=class extends Ru{constructor(s){super(s),this.current=_p}set(s,r,a){if(this.fetchUniformLocation(s,r)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let u=1;u<16;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},h.UnwrappedTileID=am,h.ValidationError=_t,h.VectorTileFeature=nm,h.VectorTileWorkerSource=class extends Ns{constructor(s,r,a,u,p){super(),this.actor=s,this.layerIndex=r,this.availableImages=a,this.loadVectorData=p||Zn,this.loading={},this.loaded={},this.deduped=new q_(s.scheduler),this.isSpriteLoaded=u,this.scheduler=s.scheduler}loadTile(s,r){const a=s.uid,u=s&&s.request,p=u&&u.collectResourceTiming,g=this.loading[a]=new Yw(s);g.abort=this.loadVectorData(s,(y,x)=>{const E=!this.loading[a];if(delete this.loading[a],E||y||!x)return g.status="done",E||(this.loaded[a]=g),r(y);const D=x.rawData,A={};x.expires&&(A.expires=x.expires),x.cacheControl&&(A.cacheControl=x.cacheControl),g.vectorTile=x.vectorTile||new Rp(new Np(D));const P=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(O,B)=>{if(O||!B)return r(O);const z={};if(p){const $=zt(u);$.length>0&&(z.resourceTiming=JSON.parse(JSON.stringify($)))}r(null,xn({rawTileData:D.slice(0)},B,A,z))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[a]=g})}reloadTile(s,r){const a=this.loaded,u=s.uid,p=this;if(a&&a[u]){const g=a[u];g.showCollisionBoxes=s.showCollisionBoxes,g.enableTerrain=!!s.enableTerrain,g.projection=s.projection,g.tileTransform=tu(s.tileID.canonical,s.projection);const y=(x,E)=>{const D=g.reloadCallback;D&&(delete g.reloadCallback,g.parse(g.vectorTile,p.layerIndex,this.availableImages,p.actor,D)),r(x,E)};"parsing"===g.status?g.reloadCallback=y:"done"===g.status&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(s,r){const a=s.uid,u=this.loading[a];u&&(u.abort&&u.abort(),delete this.loading[a]),r()}removeTile(s,r){const a=this.loaded,u=s.uid;a&&a[u]&&delete a[u],r()}},h.WritingMode=ca,h.ZoomDependentExpression=Xe,h.add=la,h.addDynamicAttributes=Dm,h.adjoint=function(s,r){var a=r[0],u=r[1],p=r[2],g=r[3],y=r[4],x=r[5],E=r[6],D=r[7],A=r[8];return s[0]=y*A-x*D,s[1]=p*D-u*A,s[2]=u*x-p*y,s[3]=x*E-g*A,s[4]=a*A-p*E,s[5]=p*g-a*x,s[6]=g*D-y*E,s[7]=u*E-a*D,s[8]=a*y-u*g,s},h.asyncAll=vo,h.bezier=er,h.bindAll=Xo,h.boundsAttributes=Mb,h.bufferConvexPolygon=function(s,r){const a=[];for(let u=0;u<s.length;u++){const p=wr(u-1,-1,s.length-1),g=wr(u+1,-1,s.length-1),y=s[u],x=s[g],E=s[p].sub(y).unit(),D=x.sub(y).unit(),A=D.angleWithSep(E.x,E.y),P=E.add(D).unit().mult(-1*r/Math.sin(A/2));a.push(y.add(P))}return a},h.cacheEntryPossiblyAdded=function(s){bc++,bc>ol&&(s.getActor().send("enforceCacheSizeLimit",Fr),bc=0)},h.calculateGlobeLabelMatrix=function(s,r){const{x:a,y:u}=s.point,p=Dg(a,u,s.worldSize/s._pixelsPerMercatorPixel,0,0);return tc(p,p,Eg(Cl(r)))},h.calculateGlobeMatrix=function(s){const{x:r,y:a}=s.point,{lng:u,lat:p}=s._center;return Dg(r,a,s.worldSize,u,p)},h.calculateGlobeMercatorMatrix=function(s){const r=s.pixelsPerMeter,a=r/Wa(1,s.center.lat),u=aa(new Float64Array(16));return ds(u,u,[s.point.x,s.point.y,0]),Ou(u,u,[a,a,r]),Float32Array.from(u)},h.circumferenceAtLatitude=Ig,h.clamp=gn,h.clearTileCache=function(s){if(!vc())return;const r=Ie.caches.delete(gr);s&&r.catch(s).then(()=>s())},h.clipLine=Fw,h.clone=function(s){var r=new qs(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},h.clone$1=ar,h.collisionCircleLayout=Kv,h.config=xt,h.conjugate=function(s,r){return s[0]=-r[0],s[1]=-r[1],s[2]=-r[2],s[3]=r[3],s},h.create=function(){var s=new qs(16);return qs!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},h.create$1=pv,h.createExpression=G,h.createLayout=Wt,h.createStyleLayer=function(s){return"custom"===s.type?new $w(s):new Cb[s.type](s)},h.cross=ph,h.degToRad=gt,h.distance=function(s,r){return Math.hypot(r[0]-s[0],r[1]-s[1],r[2]-s[2])},h.div=function(s,r,a){return s[0]=r[0]/a[0],s[1]=r[1]/a[1],s[2]=r[2]/a[2],s},h.dot=ja,h.earthRadius=Tp,h.ease=fr,h.easeCubicInOut=Ui,h.ecefToLatLng=function([s,r,a]){const u=Math.hypot(s,r,a),p=Math.atan2(s,a),g=.5*Math.PI-Math.acos(-r/u);return new si(_n(p),_n(g))},h.emitValidationErrors=ih,h.endsWith=_s,h.enforceCacheSizeLimit=function(s){Os(),vs&&vs.then(r=>{r.keys().then(a=>{for(let u=0;u<a.length-s;u++)r.delete(a[u])})})},h.evaluateSizeForFeature=dm,h.evaluateSizeForZoom=El,h.evaluateVariableOffset=mb,h.evented=le,h.exactEquals=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]},h.exactEquals$1=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]},h.exported=Qn,h.exported$1=He,h.extend=xn,h.extend$1=ea,h.fillExtrusionHeightLift=s_,h.filterObject=Rn,h.fromMat4=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[4],s[4]=r[5],s[5]=r[6],s[6]=r[8],s[7]=r[9],s[8]=r[10],s},h.fromQuat=function(s,r){var a=r[0],u=r[1],p=r[2],g=r[3],y=a+a,x=u+u,E=p+p,D=a*y,A=u*y,P=u*x,O=p*y,B=p*x,z=p*E,$=g*y,Z=g*x,ie=g*E;return s[0]=1-P-z,s[1]=A+ie,s[2]=O-Z,s[3]=0,s[4]=A-ie,s[5]=1-D-z,s[6]=B+$,s[7]=0,s[8]=O+Z,s[9]=B-$,s[10]=1-D-P,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},h.fromRotation=function(s,r){var a=Math.sin(r),u=Math.cos(r);return s[0]=u,s[1]=a,s[2]=0,s[3]=-a,s[4]=u,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},h.fromScaling=bg,h.furthestTileCorner=function(s){const r=Math.round((s+45+360)%360/90)%4;return Ti[r]},h.getAABBPointSquareDist=function(s,r,a){let u=0;for(let p=0;p<2;++p){const g=a?a[p]:0;s[p]>g&&(u+=(s[p]-g)*(s[p]-g)),r[p]<g&&(u+=(g-r[p])*(g-r[p]))}return u},h.getAnchorAlignment=g_,h.getAnchorJustification=C_,h.getBounds=function(s){let r=1/0,a=1/0,u=-1/0,p=-1/0;for(const g of s)r=Math.min(r,g.x),a=Math.min(a,g.y),u=Math.max(u,g.x),p=Math.max(p,g.y);return{min:new it(r,a),max:new it(u,p)}},h.getColumn=ir,h.getGridMatrix=function(s,r,a,u){const p=r.getNorth(),g=r.getSouth(),y=r.getWest(),x=r.getEast(),E=1<<s.z,D=x-y,A=p-g,P=D/64,O=-A/Ep[a],B=[0,P,0,O,0,0,p,y,0];if(s.z>0){const z=180/u;fv(B,B,[z/D+1,0,0,0,z/A+1,0,-.5*z/P,.5*z/O,1])}return B[2]=E,B[5]=s.x,B[8]=s.y,B},h.getImage=_u,h.getJSON=function(s,r){return va(xn(s,{type:"json"}),r)},h.getLatitudinalLod=function(s){const r=To-5;s=gn(s,-r,r)/r*90;const a=Math.pow(Math.abs(Math.sin(gt(s))),3);return Math.round(a*(Ep.length-1))},h.getMapSessionAPI=Te,h.getPerformanceMeasurement=zt,h.getProjection=I_,h.getRTLTextPluginStatus=ye,h.getReferrer=bs,h.getTilePoint=function(s,{x:r,y:a},u=0){return new it(((r-u)*s.scale-s.x)*fn,(a*s.scale-s.y)*fn)},h.getTileVec3=function(s,r,a=0){return xl(((r.x-a)*s.scale-s.x)*fn,(r.y*s.scale-s.y)*fn,kg(r.z,r.y))},h.getVideo=function(s,r){const a=Ie.document.createElement("video");a.muted=!0,a.onloadstart=function(){r(null,a)};for(let u=0;u<s.length;u++){const p=Ie.document.createElement("source");wc(s[u])||(a.crossOrigin="Anonymous"),p.src=s[u],a.appendChild(p)}return{cancel:()=>{}}},h.globeCenterToScreenPoint=function(s){const r=[0,0,0],a=aa(new Float64Array(16));return tc(a,s.pixelMatrix,s.globeMatrix),pr(r,r,a),new it(r[0],r[1])},h.globeDenormalizeECEF=Eg,h.globeECEFOrigin=function(s,r){const a=[0,0,0];return pr(a,a,_h(Cl(r.canonical))),pr(a,a,s),a},h.globeMetersToEcef=mh,h.globeNormalizeECEF=_h,h.globePixelsToTileUnits=function(s,r){return fn/(512*Math.pow(2,s))*Sp(Cl(r))},h.globePoleMatrixForTile=function(s,r,a){const u=aa(new Float64Array(16)),p=(r/(1<<s)-.5)*Math.PI*2;return Lf(u,a.globeMatrix,p),Float32Array.from(u)},h.globeTileBounds=Cl,h.globeTiltAtLngLat=Mg,h.globeToMercatorTransition=yh,h.globeUseCustomAntiAliasing=function(s,r,a){const u=yh(a.zoom),p=s.style.map._antialias,g=!!r.extStandardDerivatives,y=r.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return 0===u&&!p&&!y&&g},h.identity=aa,h.identity$1=Kx,h.invert=uh,h.isFullscreen=function(){return!!Ie.document.fullscreenElement||!!Ie.document.webkitFullscreenElement},h.isLngLatBehindGlobe=Sg,h.isMapAuthenticated=function(s){return Ce.has(s)},h.isMapboxURL=Ls,h.isSafariWithAntialiasingBug=function(s){const r=s.navigator?s.navigator.userAgent:null;return!!so(s)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},h.latFromMercatorY=to,h.latLngToECEF=ic,h.len=CD,h.length=vp,h.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},h.lngFromMercatorX=So,h.loadVectorTile=Zn,h.makeRequest=va,h.mapValue=function(s,r,a,u,p){return gn((s-r)/(a-r)*(p-u)+u,u,p)},h.mercatorScale=jf,h.mercatorXfromLng=Ga,h.mercatorYfromLat=qa,h.mercatorZfromAltitude=Wa,h.mul=Nf,h.mul$1=_v,h.multiply=tc,h.multiply$1=fv,h.multiply$2=Yx,h.nextPowerOfTwo=Yo,h.normalize=hs,h.normalize$1=ED,h.normalize$2=vv,h.number=zn,h.ortho=function(s,r,a,u,p,g,y){var x=1/(r-a),E=1/(u-p),D=1/(g-y);return s[0]=-2*x,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*D,s[11]=0,s[12]=(r+a)*x,s[13]=(p+u)*E,s[14]=(y+g)*D,s[15]=1,s},h.pbf=Np,h.perspective=function(s,r,a,u,p){var g,y=1/Math.tan(r/2);return s[0]=y/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=y,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,null!=p&&p!==1/0?(s[10]=(p+u)*(g=1/(u-p)),s[14]=2*p*u*g):(s[10]=-1,s[14]=-2*u),s},h.pick=function(s,r){const a={};for(let u=0;u<r.length;u++){const p=r[u];p in s&&(a[p]=s[p])}return a},h.plugin=we,h.pointGeometry=it,h.polesInViewport=function(s){const r=aa(new Float64Array(16));tc(r,s.pixelMatrix,s.globeMatrix);const a=[0,$a,0],u=[0,Ha,0];return pr(a,a,r),pr(u,u,r),[a[0]>0&&a[0]<=s.width&&a[1]>0&&a[1]<=s.height&&!Sg(s,new si(s.center.lat,90)),u[0]>0&&u[0]<=s.width&&u[1]>0&&u[1]<=s.height&&!Sg(s,new si(s.center.lat,-90))]},h.polygonContainsPoint=Lu,h.polygonIntersectsBox=Ug,h.polygonIntersectsPolygon=Ng,h.polygonizeBounds=function(s,r,a=0,u=!0){const p=new it(a,a),g=s.sub(p),y=r.add(p),x=[g,new it(y.x,g.y),y,new it(g.x,y.y)];return u&&x.push(g.clone()),x},h.posAttributes=wp,h.postMapLoadEvent=ee,h.postPerformanceEvent=be,h.postTurnstileEvent=j,h.potpack=m_,h.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},h.radToDeg=_n,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.registerForPluginStateChange=function(s){return s({pluginStatus:Y,pluginURL:q}),le.on("pluginStateChange",s),s},h.removeAuthState=function(s){Ce.delete(s)},h.renderColorRamp=Wg,h.resample=Dv,h.rotateX=bl,h.rotateX$1=zf,h.rotateY=Lf,h.rotateY$1=Qx,h.rotateZ=function(s,r,a){var u=Math.sin(a),p=Math.cos(a),g=r[0],y=r[1],x=r[2],E=r[3],D=r[4],A=r[5],P=r[6],O=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=g*p+D*u,s[1]=y*p+A*u,s[2]=x*p+P*u,s[3]=E*p+O*u,s[4]=D*p-g*u,s[5]=A*p-y*u,s[6]=P*p-x*u,s[7]=O*p-E*u,s},h.rotateZ$1=function(s,r,a){a*=.5;var u=r[0],p=r[1],g=r[2],y=r[3],x=Math.sin(a),E=Math.cos(a);return s[0]=u*E+p*x,s[1]=p*E-u*x,s[2]=g*E+y*x,s[3]=y*E-g*x,s},h.scale=Ou,h.scale$1=yv,h.scale$2=Ua,h.scaleAndAdd=xp,h.set=function(s,r,a,u){return s[0]=r,s[1]=a,s[2]=u,s},h.setCacheLimits=function(s,r){Fr=s,ol=r},h.setColumn=function(s,r,a){s[4*r+0]=a[0],s[4*r+1]=a[1],s[4*r+2]=a[2],s[4*r+3]=a[3]},h.setRTLTextPlugin=function(s,r,a=!1){if(Y===W||Y===X||Y===K)throw new Error("setRTLTextPlugin cannot be called multiple times.");q=Qn.resolveURL(s),Y=W,J=r,re(),a||ge()},h.smoothstep=mr,h.spec=qe,h.squaredLength=function(s){var r=s[0],a=s[1],u=s[2];return r*r+a*a+u*u},h.storeAuthState=function(s,r){r?Ce.add(s):Ce.delete(s)},h.sub=nc,h.subtract=xg,h.symbolSize=_i,h.tileAABB=function(s,r,a,u,p,g,y,x,E){if("globe"===E.name)return function Cg(s,r,a){const u=r/s.worldSize,p=s.globeMatrix;if(a.z<=1){const Pe=Cl(a).getCorners();return Ms(Pe,p,u),Vo.fromPoints(Pe)}const g=Dp(a),y=Mp(g);Ms(y,p,u);const x=Number.MAX_VALUE,E=[-x,-x,-x],D=[x,x,x];if(g.contains(s.center)){for(const Ze of y)hh(D,D,Ze),bp(E,E,Ze);E[2]=0;const Pe=s.point,Ge=[Pe.x*u,Pe.y*u,0];return hh(D,D,Ge),bp(E,E,Ge),new Vo(D,E)}const A=[p[12]*u,p[13]*u,p[14]*u],P=g.getCenter(),O=gn(s.center.lat,-To,To),B=gn(P.lat,-To,To),z=Ga(s.center.lng),$=qa(O);let Z=z-Ga(P.lng);const ie=$-qa(B);Z>.5?Z-=1:Z<-.5&&(Z+=1);let he=0;Math.abs(Z)>Math.abs(ie)?he=Z>=0?1:3:(he=ie>=0?0:2,xp(A,A,[p[4]*u,p[5]*u,p[6]*u],-Math.sin(gt(ie>=0?g.getSouth():g.getNorth()))*wl));const ne=y[he],ce=y[(he+1)%4],_e=new tw(ne,ce,A),de=[wg(_e,0)||ne[0],wg(_e,1)||ne[1],wg(_e,2)||ne[2]],Oe=yh(s.zoom);if(Oe>0){const Pe=function({x:Ze,y:Be,z:Ye},et,at,dt,Ue){const vt=1/(1<<Ye);let Qt=Ze*vt,Dt=Qt+vt,Bt=Be*vt,Ct=Bt+vt,ln=0;const Hn=(Qt+Dt)/2-dt;return Hn>.5?ln=-1:Hn<-.5&&(ln=1),Qt=((Qt+ln)*et-(dt*=et))*at+dt,Dt=((Dt+ln)*et-dt)*at+dt,Bt=(Bt*et-(Ue*=et))*at+Ue,Ct=(Ct*et-Ue)*at+Ue,[[Qt,Ct,0],[Dt,Ct,0],[Dt,Bt,0],[Qt,Bt,0]]}(a,r,s._pixelsPerMercatorPixel,z,$);for(let Ze=0;Ze<y.length;Ze++)yd(y[Ze],Pe[Ze],Oe);const Ge=la([],Pe[he],Pe[(he+1)%4]);Ua(Ge,Ge,.5),yd(de,Ge,Oe)}for(const Pe of y)hh(D,D,Pe),bp(E,E,Pe);return D[2]=Math.min(ne[2],ce[2]),hh(D,D,de),bp(E,E,de),new Vo(D,E)}(s,r,new sm(a,u,p));const D=tu({z:a,x:u,y:p},E);return new Vo([(g+D.x/D.scale)*r,r*(D.y/D.scale),y],[(g+D.x2/D.scale)*r,r*(D.y2/D.scale),x])},h.tileCornersToBounds=Dp,h.tileTransform=tu,h.transformMat3=function(s,r,a){var u=r[0],p=r[1],g=r[2];return s[0]=u*a[0]+p*a[3]+g*a[6],s[1]=u*a[1]+p*a[4]+g*a[7],s[2]=u*a[2]+p*a[5]+g*a[8],s},h.transformMat4=pr,h.transformMat4$1=qc,h.transformQuat=gv,h.transitionTileAABBinECEF=wv,h.translate=ds,h.transpose=function(s,r){if(s===r){var a=r[1],u=r[2],p=r[5];s[1]=r[3],s[2]=r[6],s[3]=a,s[5]=r[7],s[6]=u,s[7]=p}else s[0]=r[0],s[1]=r[3],s[2]=r[6],s[3]=r[1],s[4]=r[4],s[5]=r[7],s[6]=r[2],s[7]=r[5],s[8]=r[8];return s},h.triggerPluginCompletionEvent=se,h.uniqueId=_a,h.updateGlobeVertexNormal=function(s,r,a,u,p){const g=5*r+2;s.float32[g+0]=a,s.float32[g+1]=u,s.float32[g+2]=p},h.validateCustomStyleLayer=function(s){const r=[],a=s.id;return void 0===a&&r.push({message:`layers.${a}: missing required property "id"`}),void 0===s.render&&r.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&"2d"!==s.renderingMode&&"3d"!==s.renderingMode&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},h.validateFilter=s=>Ra(th(s)),h.validateFog=s=>Ra(hp(s)),h.validateLayer=s=>Ra(nh(s)),h.validateLight=s=>Ra(ls(s)),h.validateSource=s=>Ra(ld(s)),h.validateStyle=ud,h.validateTerrain=s=>Ra(dp(s)),h.values=Ro,h.vectorTile=em,h.version=Xt,h.warnOnce=ei,h.window=Ie,h.wrap=wr}),ze(0,function(h){function Ie(te){if("number"==typeof te||"boolean"==typeof te||"string"==typeof te||null==te)return JSON.stringify(te);if(Array.isArray(te)){let H="[";for(const ee of te)H+=`${Ie(ee)},`;return`${H}]`}let j="{";for(const H of Object.keys(te).sort())j+=`${H}:${Ie(te[H])},`;return`${j}}`}function Xt(te){let j="";for(const H of h.refProperties)j+=`/${Ie(te[H])}`;return j}class kt{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,H){for(const ue of j)this._layerConfigs[ue.id]=ue,(this._layers[ue.id]=h.createStyleLayer(ue)).compileFilter(),this.keyCache[ue.id]&&delete this.keyCache[ue.id];for(const ue of H)delete this.keyCache[ue],delete this._layerConfigs[ue],delete this._layers[ue];this.familiesBySource={};const ee=function(ue,be){const Ae={};for(let Ce=0;Ce<ue.length;Ce++){const Re=be&&be[ue[Ce].id]||Xt(ue[Ce]);be&&(be[ue[Ce].id]=Re);let tt=Ae[Re];tt||(tt=Ae[Re]=[]),tt.push(ue[Ce])}const Te=[];for(const Ce in Ae)Te.push(Ae[Ce]);return Te}(h.values(this._layerConfigs),this.keyCache);for(const ue of ee){const be=ue.map(Tt=>this._layers[Tt.id]),Ae=be[0];if("none"===Ae.visibility)continue;const Te=Ae.source||"";let Ce=this.familiesBySource[Te];Ce||(Ce=this.familiesBySource[Te]={});const Re=Ae.sourceLayer||"_geojsonTileLayer";let tt=Ce[Re];tt||(tt=Ce[Re]=[]),tt.push(be)}}}class xt{loadTile(j,H){const{uid:ee,encoding:ue,rawImageData:be,padding:Ae,buildQuadTree:Te}=j,Ce=h.window.ImageBitmap&&be instanceof h.window.ImageBitmap?this.getImageData(be,Ae):be;H(null,new h.DEMData(ee,Ce,ue,Ae<1,Te))}getImageData(j,H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(j.width,j.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=j.width,this.offscreenCanvas.height=j.height,this.offscreenCanvasContext.drawImage(j,0,0,j.width,j.height);const ee=this.offscreenCanvasContext.getImageData(-H,-H,j.width+2*H,j.height+2*H);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ee}}var He=function te(j,H){var ee,ue=j&&j.type;if("FeatureCollection"===ue)for(ee=0;ee<j.features.length;ee++)te(j.features[ee],H);else if("GeometryCollection"===ue)for(ee=0;ee<j.geometries.length;ee++)te(j.geometries[ee],H);else if("Feature"===ue)te(j.geometry,H);else if("Polygon"===ue)yt(j.coordinates,H);else if("MultiPolygon"===ue)for(ee=0;ee<j.coordinates.length;ee++)yt(j.coordinates[ee],H);return j};function yt(te,j){if(0!==te.length){Lt(te[0],j);for(var H=1;H<te.length;H++)Lt(te[H],!j)}}function Lt(te,j){for(var H=0,ee=0,ue=0,be=te.length,Ae=be-1;ue<be;Ae=ue++){var Te=(te[ue][0]-te[Ae][0])*(te[Ae][1]+te[ue][1]),Ce=H+Te;ee+=Math.abs(H)>=Math.abs(Te)?H-Ce+Te:Te-Ce+H,H=Ce}H+ee>=0!=!!j&&te.reverse()}const un=h.VectorTileFeature.prototype.toGeoJSON;class Yn{constructor(j){this._feature=j,this.extent=h.EXTENT,this.type=j.type,this.properties=j.tags,"id"in j&&!isNaN(j.id)&&(this.id=parseInt(j.id,10))}loadGeometry(){if(1===this._feature.type){const j=[];for(const H of this._feature.geometry)j.push([new h.pointGeometry(H[0],H[1])]);return j}{const j=[];for(const H of this._feature.geometry){const ee=[];for(const ue of H)ee.push(new h.pointGeometry(ue[0],ue[1]));j.push(ee)}return j}}toGeoJSON(j,H,ee){return un.call(this,j,H,ee)}}class Pt{constructor(j){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=j.length,this._features=j}feature(j){return new Yn(this._features[j])}}var pt={},tn={get exports(){return pt},set exports(te){pt=te}},en=h.pointGeometry,it=h.vectorTile.VectorTileFeature,ae=De;function De(te,j){this.options=j||{},this.features=te,this.length=te.length}function ot(te,j){this.id="number"==typeof te.id?te.id:void 0,this.type=te.type,this.rawGeometry=1===te.type?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=j||4096}De.prototype.feature=function(te){return new ot(this.features[te],this.options.extent)},ot.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var j=0;j<te.length;j++){for(var H=te[j],ee=[],ue=0;ue<H.length;ue++)ee.push(new en(H[ue][0],H[ue][1]));this.geometry.push(ee)}return this.geometry},ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,j=1/0,H=-1/0,ee=1/0,ue=-1/0,be=0;be<te.length;be++)for(var Ae=te[be],Te=0;Te<Ae.length;Te++){var Ce=Ae[Te];j=Math.min(j,Ce.x),H=Math.max(H,Ce.x),ee=Math.min(ee,Ce.y),ue=Math.max(ue,Ce.y)}return[j,ee,H,ue]},ot.prototype.toGeoJSON=it.prototype.toGeoJSON;var gt=h.pbf,_n=ae;function Ti(te){var j=new gt;return function(H,ee){for(var ue in H.layers)ee.writeMessage(3,Ui,H.layers[ue])}(te,j),j.finish()}function Ui(te,j){var H;j.writeVarintField(15,te.version||1),j.writeStringField(1,te.name||""),j.writeVarintField(5,te.extent||4096);var ee={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<te.length;H++)ee.feature=te.feature(H),j.writeMessage(2,er,ee);var ue=ee.keys;for(H=0;H<ue.length;H++)j.writeStringField(3,ue[H]);var be=ee.values;for(H=0;H<be.length;H++)j.writeMessage(4,vo,be[H])}function er(te,j){var H=te.feature;void 0!==H.id&&j.writeVarintField(1,H.id),j.writeMessage(2,fr,te),j.writeVarintField(3,H.type),j.writeMessage(4,wr,H)}function fr(te,j){var H=te.feature,ee=te.keys,ue=te.values,be=te.keycache,Ae=te.valuecache;for(var Te in H.properties){var Ce=H.properties[Te],Re=be[Te];if(null!==Ce){void 0===Re&&(ee.push(Te),be[Te]=Re=ee.length-1),j.writeVarint(Re);var tt=typeof Ce;"string"!==tt&&"boolean"!==tt&&"number"!==tt&&(Ce=JSON.stringify(Ce));var Tt=tt+":"+Ce,Je=Ae[Tt];void 0===Je&&(ue.push(Ce),Ae[Tt]=Je=ue.length-1),j.writeVarint(Je)}}}function gn(te,j){return(j<<3)+(7&te)}function mr(te){return te<<1^te>>31}function wr(te,j){for(var H=te.loadGeometry(),ee=te.type,ue=0,be=0,Ae=H.length,Te=0;Te<Ae;Te++){var Ce=H[Te],Re=1;1===ee&&(Re=Ce.length),j.writeVarint(gn(1,Re));for(var tt=3===ee?Ce.length-1:Ce.length,Tt=0;Tt<tt;Tt++){1===Tt&&1!==ee&&j.writeVarint(gn(2,tt-1));var Je=Ce[Tt].x-ue,zt=Ce[Tt].y-be;j.writeVarint(mr(Je)),j.writeVarint(mr(zt)),ue+=Je,be+=zt}3===ee&&j.writeVarint(gn(7,1))}}function vo(te,j){var H=typeof te;"string"===H?j.writeStringField(1,te):"boolean"===H?j.writeBooleanField(7,te):"number"===H&&(te%1!=0?j.writeDoubleField(3,te):te<0?j.writeSVarintField(6,te):j.writeVarintField(5,te))}function Ro(te,j,H,ee,ue,be){if(ue-ee<=H)return;const Ae=ee+ue>>1;xn(te,j,Ae,ee,ue,be%2),Ro(te,j,H,ee,Ae-1,be+1),Ro(te,j,H,Ae+1,ue,be+1)}function xn(te,j,H,ee,ue,be){for(;ue>ee;){if(ue-ee>600){const Re=ue-ee+1,tt=H-ee+1,Tt=Math.log(Re),Je=.5*Math.exp(2*Tt/3),zt=.5*Math.sqrt(Tt*Je*(Re-Je)/Re)*(tt-Re/2<0?-1:1);xn(te,j,H,Math.max(ee,Math.floor(H-tt*Je/Re+zt)),Math.min(ue,Math.floor(H+(Re-tt)*Je/Re+zt)),be)}const Ae=j[2*H+be];let Te=ee,Ce=ue;for(Zo(te,j,ee,H),j[2*ue+be]>Ae&&Zo(te,j,ee,ue);Te<Ce;){for(Zo(te,j,Te,Ce),Te++,Ce--;j[2*Te+be]<Ae;)Te++;for(;j[2*Ce+be]>Ae;)Ce--}j[2*ee+be]===Ae?Zo(te,j,ee,Ce):(Ce++,Zo(te,j,Ce,ue)),Ce<=H&&(ee=Ce+1),H<=Ce&&(ue=Ce-1)}}function Zo(te,j,H,ee){_a(te,H,ee),_a(j,2*H,2*ee),_a(j,2*H+1,2*ee+1)}function _a(te,j,H){const ee=te[j];te[j]=te[H],te[H]=ee}function Fs(te,j,H,ee){const ue=te-H,be=j-ee;return ue*ue+be*be}tn.exports=Ti,pt.fromVectorTileJs=Ti,pt.fromGeojsonVt=function(te,j){j=j||{};var H={};for(var ee in te)H[ee]=new _n(te[ee].features,j),H[ee].name=ee,H[ee].version=j.version,H[ee].extent=j.extent;return Ti({layers:H})},pt.GeoJSONWrapper=_n;const Yo=te=>te[0],yn=te=>te[1];class Xo{constructor(j,H=Yo,ee=yn,ue=64,be=Float64Array){this.nodeSize=ue,this.points=j;const Ae=j.length<65536?Uint16Array:Uint32Array,Te=this.ids=new Ae(j.length),Ce=this.coords=new be(2*j.length);for(let Re=0;Re<j.length;Re++)Te[Re]=Re,Ce[2*Re]=H(j[Re]),Ce[2*Re+1]=ee(j[Re]);Ro(Te,Ce,ue,0,Te.length-1,0)}range(j,H,ee,ue){return function(be,Ae,Te,Ce,Re,tt,Tt){const Je=[0,be.length-1,0],zt=[];let Ft,Gt;for(;Je.length;){const Ut=Je.pop(),Mn=Je.pop(),Qn=Je.pop();if(Mn-Qn<=Tt){for(let Ei=Qn;Ei<=Mn;Ei++)Ft=Ae[2*Ei],Gt=Ae[2*Ei+1],Ft>=Te&&Ft<=Re&&Gt>=Ce&&Gt<=tt&&zt.push(be[Ei]);continue}const rn=Math.floor((Qn+Mn)/2);Ft=Ae[2*rn],Gt=Ae[2*rn+1],Ft>=Te&&Ft<=Re&&Gt>=Ce&&Gt<=tt&&zt.push(be[rn]);const ti=(Ut+1)%2;(0===Ut?Te<=Ft:Ce<=Gt)&&(Je.push(Qn),Je.push(rn-1),Je.push(ti)),(0===Ut?Re>=Ft:tt>=Gt)&&(Je.push(rn+1),Je.push(Mn),Je.push(ti))}return zt}(this.ids,this.coords,j,H,ee,ue,this.nodeSize)}within(j,H,ee){return function(ue,be,Ae,Te,Ce,Re){const tt=[0,ue.length-1,0],Tt=[],Je=Ce*Ce;for(;tt.length;){const zt=tt.pop(),Ft=tt.pop(),Gt=tt.pop();if(Ft-Gt<=Re){for(let ti=Gt;ti<=Ft;ti++)Fs(be[2*ti],be[2*ti+1],Ae,Te)<=Je&&Tt.push(ue[ti]);continue}const Ut=Math.floor((Gt+Ft)/2),Mn=be[2*Ut],Qn=be[2*Ut+1];Fs(Mn,Qn,Ae,Te)<=Je&&Tt.push(ue[Ut]);const rn=(zt+1)%2;(0===zt?Ae-Ce<=Mn:Te-Ce<=Qn)&&(tt.push(Gt),tt.push(Ut-1),tt.push(rn)),(0===zt?Ae+Ce>=Mn:Te+Ce>=Qn)&&(tt.push(Ut+1),tt.push(Ft),tt.push(rn))}return Tt}(this.ids,this.coords,j,H,ee,this.nodeSize)}}const _s={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:te=>te},Xn=Math.fround||(Rn=new Float32Array(1),te=>(Rn[0]=+te,Rn[0]));var Rn;class ar{constructor(j){this.options=so(Object.create(_s),j),this.trees=new Array(this.options.maxZoom+1)}load(j){const{log:H,minZoom:ee,maxZoom:ue,nodeSize:be}=this.options;H&&console.time("total time");const Ae=`prepare ${j.length} points`;H&&console.time(Ae),this.points=j;let Te=[];for(let Ce=0;Ce<j.length;Ce++)j[Ce].geometry&&Te.push(ei(j[Ce],Ce));this.trees[ue+1]=new Xo(Te,Qs,ir,be,Float32Array),H&&console.timeEnd(Ae);for(let Ce=ue;Ce>=ee;Ce--){const Re=+Date.now();Te=this._cluster(Te,Ce),this.trees[Ce]=new Xo(Te,Qs,ir,be,Float32Array),H&&console.log("z%d: %d clusters in %dms",Ce,Te.length,+Date.now()-Re)}return H&&console.timeEnd("total time"),this}getClusters(j,H){let ee=((j[0]+180)%360+360)%360-180;const ue=Math.max(-90,Math.min(90,j[1]));let be=180===j[2]?180:((j[2]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)ee=-180,be=180;else if(ee>be){const tt=this.getClusters([ee,ue,180,Ae],H),Tt=this.getClusters([-180,ue,be,Ae],H);return tt.concat(Tt)}const Te=this.trees[this._limitZoom(H)],Ce=Te.range(ys(ee),Gn(Ae),ys(be),Gn(ue)),Re=[];for(const tt of Ce){const Tt=Te.points[tt];Re.push(Tt.numPoints?Ko(Tt):this.points[Tt.index])}return Re}getChildren(j){const H=this._getOriginId(j),ee=this._getOriginZoom(j),ue="No cluster with the specified id.",be=this.trees[ee];if(!be)throw new Error(ue);const Ae=be.points[H];if(!Ae)throw new Error(ue);const Te=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),Ce=be.within(Ae.x,Ae.y,Te),Re=[];for(const tt of Ce){const Tt=be.points[tt];Tt.parentId===j&&Re.push(Tt.numPoints?Ko(Tt):this.points[Tt.index])}if(0===Re.length)throw new Error(ue);return Re}getLeaves(j,H,ee){const ue=[];return this._appendLeaves(ue,j,H=H||10,ee=ee||0,0),ue}getTile(j,H,ee){const ue=this.trees[this._limitZoom(j)],be=Math.pow(2,j),{extent:Ae,radius:Te}=this.options,Ce=Te/Ae,Re=(ee-Ce)/be,tt=(ee+1+Ce)/be,Tt={features:[]};return this._addTileFeatures(ue.range((H-Ce)/be,Re,(H+1+Ce)/be,tt),ue.points,H,ee,be,Tt),0===H&&this._addTileFeatures(ue.range(1-Ce/be,Re,1,tt),ue.points,be,ee,be,Tt),H===be-1&&this._addTileFeatures(ue.range(0,Re,Ce/be,tt),ue.points,-1,ee,be,Tt),Tt.features.length?Tt:null}getClusterExpansionZoom(j){let H=this._getOriginZoom(j)-1;for(;H<=this.options.maxZoom;){const ee=this.getChildren(j);if(H++,1!==ee.length)break;j=ee[0].properties.cluster_id}return H}_appendLeaves(j,H,ee,ue,be){const Ae=this.getChildren(H);for(const Te of Ae){const Ce=Te.properties;if(Ce&&Ce.cluster?be+Ce.point_count<=ue?be+=Ce.point_count:be=this._appendLeaves(j,Ce.cluster_id,ee,ue,be):be<ue?be++:j.push(Te),j.length===ee)break}return be}_addTileFeatures(j,H,ee,ue,be,Ae){for(const Te of j){const Ce=H[Te],Re=Ce.numPoints;let tt,Tt,Je;if(Re)tt=Kn(Ce),Tt=Ce.x,Je=Ce.y;else{const Gt=this.points[Ce.index];tt=Gt.properties,Tt=ys(Gt.geometry.coordinates[0]),Je=Gn(Gt.geometry.coordinates[1])}const zt={type:1,geometry:[[Math.round(this.options.extent*(Tt*be-ee)),Math.round(this.options.extent*(Je*be-ue))]],tags:tt};let Ft;Re?Ft=Ce.id:this.options.generateId?Ft=Ce.index:this.points[Ce.index].id&&(Ft=this.points[Ce.index].id),void 0!==Ft&&(zt.id=Ft),Ae.features.push(zt)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,H){const ee=[],{radius:ue,extent:be,reduce:Ae,minPoints:Te}=this.options,Ce=ue/(be*Math.pow(2,H));for(let Re=0;Re<j.length;Re++){const tt=j[Re];if(tt.zoom<=H)continue;tt.zoom=H;const Tt=this.trees[H+1],Je=Tt.within(tt.x,tt.y,Ce),zt=tt.numPoints||1;let Ft=zt;for(const Gt of Je){const Ut=Tt.points[Gt];Ut.zoom>H&&(Ft+=Ut.numPoints||1)}if(Ft>zt&&Ft>=Te){let Gt=tt.x*zt,Ut=tt.y*zt,Mn=Ae&&zt>1?this._map(tt,!0):null;const Qn=(Re<<5)+(H+1)+this.points.length;for(const rn of Je){const ti=Tt.points[rn];if(ti.zoom<=H)continue;ti.zoom=H;const Ei=ti.numPoints||1;Gt+=ti.x*Ei,Ut+=ti.y*Ei,ti.parentId=Qn,Ae&&(Mn||(Mn=this._map(tt,!0)),Ae(Mn,this._map(ti)))}tt.parentId=Qn,ee.push(nn(Gt/Ft,Ut/Ft,Qn,Ft,Mn))}else if(ee.push(tt),Ft>1)for(const Gt of Je){const Ut=Tt.points[Gt];Ut.zoom<=H||(Ut.zoom=H,ee.push(Ut))}}return ee}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,H){if(j.numPoints)return H?so({},j.properties):j.properties;const ee=this.points[j.index].properties,ue=this.options.map(ee);return H&&ue===ee?so({},ue):ue}}function nn(te,j,H,ee,ue){return{x:Xn(te),y:Xn(j),zoom:1/0,id:H,parentId:-1,numPoints:ee,properties:ue}}function ei(te,j){const[H,ee]=te.geometry.coordinates;return{x:Xn(ys(H)),y:Xn(Gn(ee)),zoom:1/0,index:j,parentId:-1}}function Ko(te){return{type:"Feature",id:te.id,properties:Kn(te),geometry:{type:"Point",coordinates:[(j=te.x,360*(j-.5)),Fo(te.y)]}};var j}function Kn(te){const j=te.numPoints,H=j>=1e4?`${Math.round(j/1e3)}k`:j>=1e3?Math.round(j/100)/10+"k":j;return so(so({},te.properties),{cluster:!0,cluster_id:te.id,point_count:j,point_count_abbreviated:H})}function ys(te){return te/360+.5}function Gn(te){const j=Math.sin(te*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function Fo(te){const j=(180-360*te)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function so(te,j){for(const H in j)te[H]=j[H];return te}function Qs(te){return te.x}function ir(te){return te.y}function gr(te,j,H,ee){for(var ue,be=ee,Ae=H-j>>1,Te=H-j,Ce=te[j],Re=te[j+1],tt=te[H],Tt=te[H+1],Je=j+3;Je<H;Je+=3){var zt=vs(te[Je],te[Je+1],Ce,Re,tt,Tt);if(zt>be)ue=Je,be=zt;else if(zt===be){var Ft=Math.abs(Je-Ae);Ft<Te&&(ue=Je,Te=Ft)}}be>ee&&(ue-j>3&&gr(te,j,ue,ee),te[ue+2]=be,H-ue>3&&gr(te,ue,H,ee))}function vs(te,j,H,ee,ue,be){var Ae=ue-H,Te=be-ee;if(0!==Ae||0!==Te){var Ce=((te-H)*Ae+(j-ee)*Te)/(Ae*Ae+Te*Te);Ce>1?(H=ue,ee=be):Ce>0&&(H+=Ae*Ce,ee+=Te*Ce)}return(Ae=te-H)*Ae+(Te=j-ee)*Te}function Oo(te,j,H,ee){var ue={id:void 0===te?null:te,type:j,geometry:H,tags:ee,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(be){var Ae=be.geometry,Te=be.type;if("Point"===Te||"MultiPoint"===Te||"LineString"===Te)Fr(be,Ae);else if("Polygon"===Te||"MultiLineString"===Te)for(var Ce=0;Ce<Ae.length;Ce++)Fr(be,Ae[Ce]);else if("MultiPolygon"===Te)for(Ce=0;Ce<Ae.length;Ce++)for(var Re=0;Re<Ae[Ce].length;Re++)Fr(be,Ae[Ce][Re])}(ue),ue}function Fr(te,j){for(var H=0;H<j.length;H+=3)te.minX=Math.min(te.minX,j[H]),te.minY=Math.min(te.minY,j[H+1]),te.maxX=Math.max(te.maxX,j[H]),te.maxY=Math.max(te.maxY,j[H+1])}function ol(te,j,H,ee){if(j.geometry){var ue=j.geometry.coordinates,be=j.geometry.type,Ae=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),Te=[],Ce=j.id;if(H.promoteId?Ce=j.properties[H.promoteId]:H.generateId&&(Ce=ee||0),"Point"===be)vc(ue,Te);else if("MultiPoint"===be)for(var Re=0;Re<ue.length;Re++)vc(ue[Re],Te);else if("LineString"===be)Os(ue,Te,Ae,!1);else if("MultiLineString"===be){if(H.lineMetrics){for(Re=0;Re<ue.length;Re++)Os(ue[Re],Te=[],Ae,!1),te.push(Oo(Ce,"LineString",Te,j.properties));return}ya(ue,Te,Ae,!1)}else if("Polygon"===be)ya(ue,Te,Ae,!0);else{if("MultiPolygon"!==be){if("GeometryCollection"===be){for(Re=0;Re<j.geometry.geometries.length;Re++)ol(te,{id:Ce,geometry:j.geometry.geometries[Re],properties:j.properties},H,ee);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Re=0;Re<ue.length;Re++){var tt=[];ya(ue[Re],tt,Ae,!0),Te.push(tt)}}te.push(Oo(Ce,be,Te,j.properties))}}function vc(te,j){j.push(bc(te[0])),j.push(xc(te[1])),j.push(0)}function Os(te,j,H,ee){for(var ue,be,Ae=0,Te=0;Te<te.length;Te++){var Ce=bc(te[Te][0]),Re=xc(te[Te][1]);j.push(Ce),j.push(Re),j.push(0),Te>0&&(Ae+=ee?(ue*Re-Ce*be)/2:Math.sqrt(Math.pow(Ce-ue,2)+Math.pow(Re-be,2))),ue=Ce,be=Re}var tt=j.length-3;j[2]=1,gr(j,0,tt,H),j[tt+2]=1,j.size=Math.abs(Ae),j.start=0,j.end=j.size}function ya(te,j,H,ee){for(var ue=0;ue<te.length;ue++){var be=[];Os(te[ue],be,H,ee),j.push(be)}}function bc(te){return te/360+.5}function xc(te){var j=Math.sin(te*Math.PI/180),H=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return H<0?0:H>1?1:H}function wn(te,j,H,ee,ue,be,Ae,Te){if(ee/=j,be>=(H/=j)&&Ae<ee)return te;if(Ae<H||be>=ee)return null;for(var Ce=[],Re=0;Re<te.length;Re++){var tt=te[Re],Tt=tt.geometry,Je=tt.type,zt=0===ue?tt.minX:tt.minY,Ft=0===ue?tt.maxX:tt.maxY;if(zt>=H&&Ft<ee)Ce.push(tt);else if(!(Ft<H||zt>=ee)){var Gt=[];if("Point"===Je||"MultiPoint"===Je)bs(Tt,Gt,H,ee,ue);else if("LineString"===Je)va(Tt,Gt,H,ee,ue,!1,Te.lineMetrics);else if("MultiLineString"===Je)wc(Tt,Gt,H,ee,ue,!1);else if("Polygon"===Je)wc(Tt,Gt,H,ee,ue,!0);else if("MultiPolygon"===Je)for(var Ut=0;Ut<Tt.length;Ut++){var Mn=[];wc(Tt[Ut],Mn,H,ee,ue,!0),Mn.length&&Gt.push(Mn)}if(Gt.length){if(Te.lineMetrics&&"LineString"===Je){for(Ut=0;Ut<Gt.length;Ut++)Ce.push(Oo(tt.id,Je,Gt[Ut],tt.tags));continue}"LineString"!==Je&&"MultiLineString"!==Je||(1===Gt.length?(Je="LineString",Gt=Gt[0]):Je="MultiLineString"),"Point"!==Je&&"MultiPoint"!==Je||(Je=3===Gt.length?"Point":"MultiPoint"),Ce.push(Oo(tt.id,Je,Gt,tt.tags))}}}return Ce.length?Ce:null}function bs(te,j,H,ee,ue){for(var be=0;be<te.length;be+=3){var Ae=te[be+ue];Ae>=H&&Ae<=ee&&(j.push(te[be]),j.push(te[be+1]),j.push(te[be+2]))}}function va(te,j,H,ee,ue,be,Ae){for(var Te,Ce,Re=sl(te),tt=0===ue?Qo:Rl,Tt=te.start,Je=0;Je<te.length-3;Je+=3){var zt=te[Je],Ft=te[Je+1],Gt=te[Je+2],Ut=te[Je+3],Mn=te[Je+4],Qn=0===ue?zt:Ft,rn=0===ue?Ut:Mn,ti=!1;Ae&&(Te=Math.sqrt(Math.pow(zt-Ut,2)+Math.pow(Ft-Mn,2))),Qn<H?rn>H&&(Ce=tt(Re,zt,Ft,Ut,Mn,H),Ae&&(Re.start=Tt+Te*Ce)):Qn>ee?rn<ee&&(Ce=tt(Re,zt,Ft,Ut,Mn,ee),Ae&&(Re.start=Tt+Te*Ce)):Cc(Re,zt,Ft,Gt),rn<H&&Qn>=H&&(Ce=tt(Re,zt,Ft,Ut,Mn,H),ti=!0),rn>ee&&Qn<=ee&&(Ce=tt(Re,zt,Ft,Ut,Mn,ee),ti=!0),!be&&ti&&(Ae&&(Re.end=Tt+Te*Ce),j.push(Re),Re=sl(te)),Ae&&(Tt+=Te)}var Ei=te.length-3;zt=te[Ei],Ft=te[Ei+1],Gt=te[Ei+2],(Qn=0===ue?zt:Ft)>=H&&Qn<=ee&&Cc(Re,zt,Ft,Gt),Ei=Re.length-3,be&&Ei>=3&&(Re[Ei]!==Re[0]||Re[Ei+1]!==Re[1])&&Cc(Re,Re[0],Re[1],Re[2]),Re.length&&j.push(Re)}function sl(te){var j=[];return j.size=te.size,j.start=te.start,j.end=te.end,j}function wc(te,j,H,ee,ue,be){for(var Ae=0;Ae<te.length;Ae++)va(te[Ae],j,H,ee,ue,be,!1)}function Cc(te,j,H,ee){te.push(j),te.push(H),te.push(ee)}function Qo(te,j,H,ee,ue,be){var Ae=(be-j)/(ee-j);return te.push(be),te.push(H+(ue-H)*Ae),te.push(1),Ae}function Rl(te,j,H,ee,ue,be){var Ae=(be-H)/(ue-H);return te.push(j+(ee-j)*Ae),te.push(be),te.push(1),Ae}function _u(te,j){for(var H=[],ee=0;ee<te.length;ee++){var ue,be=te[ee],Ae=be.type;if("Point"===Ae||"MultiPoint"===Ae||"LineString"===Ae)ue=Fl(be.geometry,j);else if("MultiLineString"===Ae||"Polygon"===Ae){ue=[];for(var Te=0;Te<be.geometry.length;Te++)ue.push(Fl(be.geometry[Te],j))}else if("MultiPolygon"===Ae)for(ue=[],Te=0;Te<be.geometry.length;Te++){for(var Ce=[],Re=0;Re<be.geometry[Te].length;Re++)Ce.push(Fl(be.geometry[Te][Re],j));ue.push(Ce)}H.push(Oo(be.id,Ae,ue,be.tags))}return H}function Fl(te,j){var H=[];H.size=te.size,void 0!==te.start&&(H.start=te.start,H.end=te.end);for(var ee=0;ee<te.length;ee+=3)H.push(te[ee]+j,te[ee+1],te[ee+2]);return H}function Ls(te,j){if(te.transformed)return te;var H,ee,ue,be=1<<te.z,Ae=te.x,Te=te.y;for(H=0;H<te.features.length;H++){var Ce=te.features[H],Re=Ce.geometry,tt=Ce.type;if(Ce.geometry=[],1===tt)for(ee=0;ee<Re.length;ee+=2)Ce.geometry.push(Ol(Re[ee],Re[ee+1],j,be,Ae,Te));else for(ee=0;ee<Re.length;ee++){var Tt=[];for(ue=0;ue<Re[ee].length;ue+=2)Tt.push(Ol(Re[ee][ue],Re[ee][ue+1],j,be,Ae,Te));Ce.geometry.push(Tt)}}return te.transformed=!0,te}function Ol(te,j,H,ee,ue,be){return[Math.round(H*(te*ee-ue)),Math.round(H*(j*ee-be))]}function ba(te,j,H,ee,ue){for(var be=j===ue.maxZoom?0:ue.tolerance/((1<<j)*ue.extent),Ae={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:ee,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Te=0;Te<te.length;Te++){Ae.numFeatures++,Ec(Ae,te[Te],be,ue);var Ce=te[Te].minX,Re=te[Te].minY,tt=te[Te].maxX,Tt=te[Te].maxY;Ce<Ae.minX&&(Ae.minX=Ce),Re<Ae.minY&&(Ae.minY=Re),tt>Ae.maxX&&(Ae.maxX=tt),Tt>Ae.maxY&&(Ae.maxY=Tt)}return Ae}function Ec(te,j,H,ee){var ue=j.geometry,be=j.type,Ae=[];if("Point"===be||"MultiPoint"===be)for(var Te=0;Te<ue.length;Te+=3)Ae.push(ue[Te]),Ae.push(ue[Te+1]),te.numPoints++,te.numSimplified++;else if("LineString"===be)al(Ae,ue,te,H,!1,!1);else if("MultiLineString"===be||"Polygon"===be)for(Te=0;Te<ue.length;Te++)al(Ae,ue[Te],te,H,"Polygon"===be,0===Te);else if("MultiPolygon"===be)for(var Ce=0;Ce<ue.length;Ce++){var Re=ue[Ce];for(Te=0;Te<Re.length;Te++)al(Ae,Re[Te],te,H,!0,0===Te)}if(Ae.length){var tt=j.tags||null;if("LineString"===be&&ee.lineMetrics){for(var Tt in tt={},j.tags)tt[Tt]=j.tags[Tt];tt.mapbox_clip_start=ue.start/ue.size,tt.mapbox_clip_end=ue.end/ue.size}var Je={geometry:Ae,type:"Polygon"===be||"MultiPolygon"===be?3:"LineString"===be||"MultiLineString"===be?2:1,tags:tt};null!==j.id&&(Je.id=j.id),te.features.push(Je)}}function al(te,j,H,ee,ue,be){var Ae=ee*ee;if(ee>0&&j.size<(ue?Ae:ee))H.numPoints+=j.length/3;else{for(var Te=[],Ce=0;Ce<j.length;Ce+=3)(0===ee||j[Ce+2]>Ae)&&(H.numSimplified++,Te.push(j[Ce]),Te.push(j[Ce+1])),H.numPoints++;ue&&function(Re,tt){for(var Tt=0,Je=0,zt=Re.length,Ft=zt-2;Je<zt;Ft=Je,Je+=2)Tt+=(Re[Je]-Re[Ft])*(Re[Je+1]+Re[Ft+1]);if(Tt>0===tt)for(Je=0,zt=Re.length;Je<zt/2;Je+=2){var Gt=Re[Je],Ut=Re[Je+1];Re[Je]=Re[zt-2-Je],Re[Je+1]=Re[zt-1-Je],Re[zt-2-Je]=Gt,Re[zt-1-Je]=Ut}}(Te,be),te.push(Te)}}function Jo(te,j){var H=(j=this.options=function(ue,be){for(var Ae in be)ue[Ae]=be[Ae];return ue}(Object.create(this.options),j)).debug;if(H&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var ue,be,Ae,Te,Ce,Re,ee=function(ue,be){var Ae=[];if("FeatureCollection"===ue.type)for(var Te=0;Te<ue.features.length;Te++)ol(Ae,ue.features[Te],be,Te);else ol(Ae,"Feature"===ue.type?ue:{geometry:ue},be);return Ae}(te,j);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Te=ue=ee,Ce=wn(ue,1,-1-(Ae=(be=j).buffer/be.extent),Ae,0,-1,2,be),Re=wn(ue,1,1-Ae,2+Ae,0,-1,2,be),(Ce||Re)&&(Te=wn(ue,1,-Ae,1+Ae,0,-1,2,be)||[],Ce&&(Te=_u(Ce,1).concat(Te)),Re&&(Te=Te.concat(_u(Re,-1)))),(ee=Te).length&&this.splitTile(ee,0,0,0),H&&(ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function bo(te,j,H){return 32*((1<<te)*H+j)+te}function xa(te,j){const H=te.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);const ee=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!ee)return j(null,null);const ue=new Pt(ee.features);let be=pt(ue);0===be.byteOffset&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),j(null,{vectorTile:ue,rawData:be.buffer})}Jo.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Jo.prototype.splitTile=function(te,j,H,ee,ue,be,Ae){for(var Te=[te,j,H,ee],Ce=this.options,Re=Ce.debug;Te.length;){ee=Te.pop(),H=Te.pop(),j=Te.pop(),te=Te.pop();var tt=1<<j,Tt=bo(j,H,ee),Je=this.tiles[Tt];if(!Je&&(Re>1&&console.time("creation"),Je=this.tiles[Tt]=ba(te,j,H,ee,Ce),this.tileCoords.push({z:j,x:H,y:ee}),Re)){Re>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,H,ee,Je.numFeatures,Je.numPoints,Je.numSimplified),console.timeEnd("creation"));var zt="z"+j;this.stats[zt]=(this.stats[zt]||0)+1,this.total++}if(Je.source=te,ue){if(j===Ce.maxZoom||j===ue)continue;var Ft=1<<ue-j;if(H!==Math.floor(be/Ft)||ee!==Math.floor(Ae/Ft))continue}else if(j===Ce.indexMaxZoom||Je.numPoints<=Ce.indexMaxPoints)continue;if(Je.source=null,0!==te.length){Re>1&&console.time("clipping");var Gt,Ut,Mn,Qn,rn,ti,Ei=.5*Ce.buffer/Ce.extent,Js=.5-Ei,Ns=.5+Ei,qe=1+Ei;Gt=Ut=Mn=Qn=null,rn=wn(te,tt,H-Ei,H+Ns,0,Je.minX,Je.maxX,Ce),ti=wn(te,tt,H+Js,H+qe,0,Je.minX,Je.maxX,Ce),te=null,rn&&(Gt=wn(rn,tt,ee-Ei,ee+Ns,1,Je.minY,Je.maxY,Ce),Ut=wn(rn,tt,ee+Js,ee+qe,1,Je.minY,Je.maxY,Ce),rn=null),ti&&(Mn=wn(ti,tt,ee-Ei,ee+Ns,1,Je.minY,Je.maxY,Ce),Qn=wn(ti,tt,ee+Js,ee+qe,1,Je.minY,Je.maxY,Ce),ti=null),Re>1&&console.timeEnd("clipping"),Te.push(Gt||[],j+1,2*H,2*ee),Te.push(Ut||[],j+1,2*H,2*ee+1),Te.push(Mn||[],j+1,2*H+1,2*ee),Te.push(Qn||[],j+1,2*H+1,2*ee+1)}}},Jo.prototype.getTile=function(te,j,H){var ee=this.options,ue=ee.extent,be=ee.debug;if(te<0||te>24)return null;var Ae=1<<te,Te=bo(te,j=(j%Ae+Ae)%Ae,H);if(this.tiles[Te])return Ls(this.tiles[Te],ue);be>1&&console.log("drilling down to z%d-%d-%d",te,j,H);for(var Ce,Re=te,tt=j,Tt=H;!Ce&&Re>0;)Re--,tt=Math.floor(tt/2),Tt=Math.floor(Tt/2),Ce=this.tiles[bo(Re,tt,Tt)];return Ce&&Ce.source?(be>1&&console.log("found parent tile z%d-%d-%d",Re,tt,Tt),be>1&&console.time("drilling down"),this.splitTile(Ce.source,Re,tt,Tt,te,j,H),be>1&&console.timeEnd("drilling down"),this.tiles[Te]?Ls(this.tiles[Te],ue):null):null};class Dc extends h.VectorTileWorkerSource{constructor(j,H,ee,ue,be){super(j,H,ee,ue,xa),be&&(this.loadGeoJSON=be)}loadData(j,H){const ee=j&&j.request,ue=ee&&ee.collectResourceTiming;this.loadGeoJSON(j,(be,Ae)=>{if(be||!Ae)return H(be);if("object"!=typeof Ae)return H(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));{He(Ae,!0);try{if(j.filter){const Ce=h.createExpression(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ce.result)throw new Error(Ce.value.map(tt=>`${tt.key}: ${tt.message}`).join(", "));Ae={type:"FeatureCollection",features:Ae.features.filter(tt=>Ce.value.evaluate({zoom:0},tt))}}this._geoJSONIndex=j.cluster?new ar(function({superclusterOptions:Ce,clusterProperties:Re}){if(!Re||!Ce)return Ce;const tt={},Tt={},Je={accumulated:null,zoom:0},zt={properties:null},Ft=Object.keys(Re);for(const Gt of Ft){const[Ut,Mn]=Re[Gt],Qn=h.createExpression(Mn),rn=h.createExpression("string"==typeof Ut?[Ut,["accumulated"],["get",Gt]]:Ut);tt[Gt]=Qn.value,Tt[Gt]=rn.value}return Ce.map=Gt=>{zt.properties=Gt;const Ut={};for(const Mn of Ft)Ut[Mn]=tt[Mn].evaluate(Je,zt);return Ut},Ce.reduce=(Gt,Ut)=>{zt.properties=Ut;for(const Mn of Ft)Je.accumulated=Gt[Mn],Gt[Mn]=Tt[Mn].evaluate(Je,zt)},Ce}(j)).load(Ae.features):new Jo(Ce=Ae,j.geojsonVtOptions)}catch(Ce){return H(Ce)}this.loaded={};const Te={};if(ue){const Ce=h.getPerformanceMeasurement(ee);Ce&&(Te.resourceTiming={},Te.resourceTiming[j.source]=JSON.parse(JSON.stringify(Ce)))}H(null,Te)}var Ce})}reloadTile(j,H){const ee=this.loaded;return ee&&ee[j.uid]?super.reloadTile(j,H):this.loadTile(j,H)}loadGeoJSON(j,H){if(j.request)h.getJSON(j.request,H);else{if("string"!=typeof j.data)return H(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));try{return H(null,JSON.parse(j.data))}catch{return H(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(j,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(ee){H(ee)}}getClusterChildren(j,H){try{H(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(ee){H(ee)}}getClusterLeaves(j,H){try{H(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(ee){H(ee)}}}class wa{constructor(j){this.self=j,this.actor=new h.Actor(j,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=h.getProjection({name:"mercator"}),this.workerSourceTypes={vector:h.VectorTileWorkerSource,geojson:Dc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,ee)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=ee},this.self.registerRTLTextPlugin=H=>{if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=H.applyArabicShaping,h.plugin.processBidirectionalText=H.processBidirectionalText,h.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}clearCaches(j,H,ee){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j],ee()}checkIfReady(j,H,ee){ee()}setReferrer(j,H){this.referrer=H}spriteLoaded(j,H){this.isSpriteLoaded[j]=H;for(const ee in this.workerSources[j]){const ue=this.workerSources[j][ee];for(const be in ue)ue[be]instanceof h.VectorTileWorkerSource&&(ue[be].isSpriteLoaded=H,ue[be].fire(new h.Event("isSpriteLoaded")))}}setImages(j,H,ee){this.availableImages[j]=H;for(const ue in this.workerSources[j]){const be=this.workerSources[j][ue];for(const Ae in be)be[Ae].availableImages=H}ee()}enableTerrain(j,H,ee){this.terrain=H,ee()}setProjection(j,H){this.projections[j]=h.getProjection(H)}setLayers(j,H,ee){this.getLayerIndex(j).replace(H),ee()}updateLayers(j,H,ee){this.getLayerIndex(j).update(H.layers,H.removedIds),ee()}loadTile(j,H,ee){const ue=this.enableTerrain?h.extend({enableTerrain:this.terrain},H):H;ue.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,H.type,H.source).loadTile(ue,ee)}loadDEMTile(j,H,ee){const ue=this.enableTerrain?h.extend({buildQuadTree:this.terrain},H):H;this.getDEMWorkerSource(j,H.source).loadTile(ue,ee)}reloadTile(j,H,ee){const ue=this.enableTerrain?h.extend({enableTerrain:this.terrain},H):H;ue.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,H.type,H.source).reloadTile(ue,ee)}abortTile(j,H,ee){this.getWorkerSource(j,H.type,H.source).abortTile(H,ee)}removeTile(j,H,ee){this.getWorkerSource(j,H.type,H.source).removeTile(H,ee)}removeSource(j,H,ee){if(!this.workerSources[j]||!this.workerSources[j][H.type]||!this.workerSources[j][H.type][H.source])return;const ue=this.workerSources[j][H.type][H.source];delete this.workerSources[j][H.type][H.source],void 0!==ue.removeSource?ue.removeSource(H,ee):ee()}loadWorkerSource(j,H,ee){try{this.self.importScripts(H.url),ee()}catch(ue){ee(ue.toString())}}syncRTLPluginState(j,H,ee){try{h.plugin.setState(H);const ue=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&null!=ue){this.self.importScripts(ue);const be=h.plugin.isParsed();ee(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ue}`),be)}}catch(ue){ee(ue.toString())}}getAvailableImages(j){let H=this.availableImages[j];return H||(H=[]),H}getLayerIndex(j){let H=this.layerIndexes[j];return H||(H=this.layerIndexes[j]=new kt),H}getWorkerSource(j,H,ee){return this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][H]||(this.workerSources[j][H]={}),this.workerSources[j][H][ee]||(this.workerSources[j][H][ee]=new this.workerSourceTypes[H]({send:(be,Ae,Te,Ce,Re,tt)=>{this.actor.send(be,Ae,Te,j,Re,tt)},scheduler:this.actor.scheduler},this.getLayerIndex(j),this.getAvailableImages(j),this.isSpriteLoaded[j])),this.workerSources[j][H][ee]}getDEMWorkerSource(j,H){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][H]||(this.demWorkerSources[j][H]=new xt),this.demWorkerSources[j][H]}enforceCacheSizeLimit(j,H){h.enforceCacheSizeLimit(H)}getWorkerPerformanceMetrics(j,H,ee){ee(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new wa(self)),wa}),ze(0,function(h){function Ie(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let d=0;d<m.length;d++)if(!Ie(m[d],l[d]))return!1;return!0}if("object"==typeof m&&null!==m&&null!==l){if("object"!=typeof l||Object.keys(m).length!==Object.keys(l).length)return!1;for(const d in m)if(!Ie(m[d],l[d]))return!1;return!0}return m===l}var Xt=kt;function kt(m){return l=m,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,b,w=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(w);try{b=new Worker(M),_=!0}catch{_=!1}return b&&b.terminate(),URL.revokeObjectURL(M),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var b=_.getContext("2d");if(!b)return!1;var w=b.getImageData(0,0,1,1);return w&&w.width===_.width}()||(void 0===xt[d=l&&l.failIfMajorPerformanceCaveat]&&(xt[d]=function(_){var b,M,T,I,w=(M=_,T=document.createElement("canvas"),(I=Object.create(kt.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,T.getContext("webgl",I)||T.getContext("experimental-webgl",I));if(!w)return!1;try{b=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!b||w.isContextLost())&&(w.shaderSource(b,"void main() {}"),w.compileShader(b),!0===w.getShaderParameter(b,w.COMPILE_STATUS))}(d)),!xt[d]||document.documentMode));var l,d}var xt={};function He(m,l,d){const _=h.window.document.createElement(m);return void 0!==l&&(_.className=l),d&&d.appendChild(_),_}function yt(m,l,d){const _=h.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const b of Object.keys(l))_.setAttributeNS(null,b,l[b]);return d&&d.appendChild(_),_}kt.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Lt=h.window.document&&h.window.document.documentElement.style,un=Lt&&void 0!==Lt.userSelect?"userSelect":"WebkitUserSelect";let Yn;function Pt(){Lt&&un&&(Yn=Lt[un],Lt[un]="none")}function pt(){Lt&&un&&(Lt[un]=Yn)}function tn(m){m.preventDefault(),m.stopPropagation(),h.window.removeEventListener("click",tn,!0)}function en(){h.window.addEventListener("click",tn,!0),h.window.setTimeout(()=>{h.window.removeEventListener("click",tn,!0)},0)}function it(m,l){const d=m.getBoundingClientRect();return ot(m,d,l)}function ae(m,l){const d=m.getBoundingClientRect(),_=[];for(let b=0;b<l.length;b++)_.push(ot(m,d,l[b]));return _}function De(m){return void 0!==h.window.InstallTrigger&&2===m.button&&m.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function ot(m,l,d){const _=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new h.pointGeometry((d.clientX-l.left)*_,(d.clientY-l.top)*_)}function gt(m,l){var d=l[0],_=l[1],b=l[2],w=l[3],M=d*w-b*_;return M?(m[0]=w*(M=1/M),m[1]=-_*M,m[2]=-b*M,m[3]=d*M,m):null}function _n(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ti extends h.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:d,callback:_}of this.requestors)this._notify(d,_);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,d){this._validate(l,d)&&(this.images[l]=d)}_validate(l,d){let _=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new h.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),_=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new h.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),_=!1),this._validateContent(d.content,d)||(this.fire(new h.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),_=!1),_}_validateStretch(l,d){if(!l)return!0;let _=0;for(const b of l){if(b[0]<_||b[1]<b[0]||d<b[1])return!1;_=b[1]}return!0}_validateContent(l,d){return!(l&&(4!==l.length||l[0]<0||d.data.width<l[0]||l[1]<0||d.data.height<l[1]||l[2]<0||d.data.width<l[2]||l[3]<0||d.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,d){d.version=this.images[l].version+1,this.images[l]=d,this.updatedImages[l]=!0}removeImage(l){const d=this.images[l];delete this.images[l],delete this.patterns[l],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,d){let _=!0;if(!this.isLoaded())for(const b of l)this.images[b]||(_=!1);this.isLoaded()||_?this._notify(l,d):this.requestors.push({ids:l,callback:d})}_notify(l,d){const _={};for(const b of l){this.images[b]||this.fire(new h.Event("styleimagemissing",{id:b}));const w=this.images[b];w?_[b]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:Boolean(w.userImage&&w.userImage.render)}:h.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,_)}getPixelSize(){const{width:l,height:d}=this.atlasImage;return{width:l,height:d}}getPattern(l){const d=this.patterns[l],_=this.getImage(l);if(!_)return null;if(d&&d.position.version===_.version)return d.position;if(d)d.position.version=_.version;else{const b={w:_.data.width+2,h:_.data.height+2,x:0,y:0},w=new h.ImagePosition(b,_);this.patterns[l]={bin:b,position:w}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const d=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(l,this.atlasImage,d.RGBA),this.atlasTexture&&this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const w in this.patterns)l.push(this.patterns[w].bin);const{w:d,h:_}=h.potpack(l),b=this.atlasImage;b.resize({width:d||1,height:_||1});for(const w in this.patterns){const{bin:M}=this.patterns[w],T=M.x+1,I=M.y+1,N=this.images[w].data,L=N.width,U=N.height;h.RGBAImage.copy(N,b,{x:0,y:0},{x:T,y:I},{width:L,height:U}),h.RGBAImage.copy(N,b,{x:0,y:U-1},{x:T,y:I-1},{width:L,height:1}),h.RGBAImage.copy(N,b,{x:0,y:0},{x:T,y:I+U},{width:L,height:1}),h.RGBAImage.copy(N,b,{x:L-1,y:0},{x:T-1,y:I},{width:1,height:U}),h.RGBAImage.copy(N,b,{x:0,y:0},{x:T+L,y:I},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const d of l){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const _=this.images[d];_n(_)&&this.updateImage(d,_)}}}const Ui=new h.Properties({anchor:new h.DataConstantProperty(h.spec.light.anchor),position:new class{constructor(){this.specification=h.spec.light.position}possiblyEvaluate(m,l){return function([d,_,b]){const w=h.degToRad(_+90),M=h.degToRad(b);return{x:d*Math.cos(w)*Math.sin(M),y:d*Math.sin(w)*Math.sin(M),z:d*Math.cos(M),azimuthal:_,polar:b}}(m.expression.evaluate(l))}interpolate(m,l,d){return{x:h.number(m.x,l.x,d),y:h.number(m.y,l.y,d),z:h.number(m.z,l.z,d),azimuthal:h.number(m.azimuthal,l.azimuthal,d),polar:h.number(m.polar,l.polar,d)}}},color:new h.DataConstantProperty(h.spec.light.color),intensity:new h.DataConstantProperty(h.spec.light.intensity)}),er="-transition";class fr extends h.Evented{constructor(l){super(),this._transitionable=new h.Transitionable(Ui),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,d={}){if(!this._validate(h.validateLight,l,d))for(const _ in l){const b=l[_];h.endsWith(_,er)?this._transitionable.setTransition(_.slice(0,-er.length),b):this._transitionable.setValue(_,b)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,_){return(!_||!1!==_.validate)&&h.emitValidationErrors(this,l.call(h.validateStyle,h.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}const gn=new h.Properties({source:new h.DataConstantProperty(h.spec.terrain.source),exaggeration:new h.DataConstantProperty(h.spec.terrain.exaggeration)}),mr="-transition";class wr extends h.Evented{constructor(l,d){super(),this._transitionable=new h.Transitionable(gn),this.set(l),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=d}get(){return this._transitionable.serialize()}set(l){for(const d in l){const _=l[d];h.endsWith(d,mr)?this._transitionable.setTransition(d.slice(0,-mr.length),_):this._transitionable.setValue(d,_)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}}function vo(m,l,d,_){const b=h.smoothstep(45,65,d),[w,M]=Ro(m,_),T=h.length(l);let I=1-Math.min(1,Math.exp((T-w)/(M-w)*-6));return I*=I*I,I=Math.min(1,1.00747*I),I*b*m.alpha}function Ro(m,l){const d=.5/Math.tan(.5*l);return[m.range[0]+d,m.range[1]+d]}const xn=new h.Properties({range:new h.DataConstantProperty(h.spec.fog.range),color:new h.DataConstantProperty(h.spec.fog.color),"high-color":new h.DataConstantProperty(h.spec.fog["high-color"]),"space-color":new h.DataConstantProperty(h.spec.fog["space-color"]),"horizon-blend":new h.DataConstantProperty(h.spec.fog["horizon-blend"]),"star-intensity":new h.DataConstantProperty(h.spec.fog["star-intensity"])}),Zo="-transition";class _a extends h.Evented{constructor(l,d){super(),this._transitionable=new h.Transitionable(xn),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=d}get state(){const l=this._transform,d="globe"===l.projection.name,_=h.globeToMercatorTransition(l.zoom),b=this.properties.get("range"),w=[.5,3];return{range:d?[h.number(w[0],b[0],_),h.number(w[1],b[1],_)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,d={}){if(!this._validate(h.validateFog,l,d)){for(const _ of Object.keys(h.spec.fog))l&&void 0===l[_]&&(l[_]=h.spec.fog[_].default);for(const _ in l){const b=l[_];h.endsWith(_,Zo)?this._transitionable.setTransition(_.slice(0,-Zo.length),b):this._transitionable.setValue(_,b)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const d=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:h.smoothstep(45,65,l))*d.a}getOpacityAtLatLng(l,d){return this._transform.projection.supportsFog?function(_,b,w){const M=h.MercatorCoordinate.fromLngLat(b),T=w.elevation?w.elevation.getAtPointOrZero(M):0,I=[M.x,M.y,T];return h.transformMat4(I,I,w.mercatorFogMatrix),vo(_,I,w.pitch,w._fov)}(this.state,l,d):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?Ro(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,d,_){return(!_||!1!==_.validate)&&h.emitValidationErrors(this,l.call(h.validateStyle,h.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:h.spec})))}}class Fs{constructor(l,d){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=h.uniqueId();const _=this.workerPool.acquire(this.id);for(let b=0;b<_.length;b++){const w=new Fs.Actor(_[b],d,this.id);w.name=`Worker ${b}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,d,_){h.asyncAll(this.actors,(b,w)=>{b.send(l,d,w)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Yo(m,l,d){return l*(h.EXTENT/(m.tileSize*Math.pow(2,d-m.tileID.overscaledZ)))}Fs.Actor=h.Actor;class yn{constructor(l,d,_,b){this.screenBounds=l,this.cameraPoint=d,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(l,d){let _,b;if(l instanceof h.pointGeometry||"number"==typeof l[0]){const w=h.pointGeometry.convert(l);_=[w],b=d.isPointAboveHorizon(w)}else{const w=h.pointGeometry.convert(l[0]),M=h.pointGeometry.convert(l[1]);_=[w,M],b=h.polygonizeBounds(w,M).every(T=>d.isPointAboveHorizon(T))}return new yn(_,d.getCameraPoint(),b,d)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(l){return h.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const d=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new h.pointGeometry(1,1)):this.screenBounds[1],b=h.polygonizeBounds(d,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>d.x&&this.cameraPoint.x<_.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?b[2]=this.cameraPoint:this.cameraPoint.x<=d.x&&(b[3]=this.cameraPoint)),h.bufferConvexPolygon(b,l)}bufferedCameraGeometryGlobe(l){const d=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new h.pointGeometry(1,1)):this.screenBounds[1],b=h.polygonizeBounds(d,_,l),w=this.cameraPoint.clone();switch(3*((w.y>d.y)+(w.y>_.y))+((w.x>d.x)+(w.x>_.x))){case 0:b[0]=w,b[4]=w.clone();break;case 1:b.splice(1,0,w);break;case 2:b[1]=w;break;case 3:b.splice(4,0,w);break;case 5:b.splice(2,0,w);break;case 6:b[3]=w;break;case 7:b.splice(3,0,w);break;case 8:b[2]=w}return b}containsTile(l,d,_,b=0){const w=l.queryPadding/d._pixelsPerMercatorPixel+1,M=_?this._bufferedCameraMercator(w,d):this._bufferedScreenMercator(w,d);let T=l.tileID.wrap+(M.unwrapped?b:0);const I=M.polygon.map(Y=>h.getTilePoint(l.tileTransform,Y,T));if(!h.polygonIntersectsBox(I,0,0,h.EXTENT,h.EXTENT))return;T=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const N=this.screenGeometryMercator.polygon.map(Y=>h.getTileVec3(l.tileTransform,Y,T)),L=N.map(Y=>new h.pointGeometry(Y[0],Y[1])),U=d.getFreeCameraOptions().position||new h.MercatorCoordinate(0,0,0),W=h.getTileVec3(l.tileTransform,U,T),X=N.map(Y=>{const q=h.sub(Y,Y,W);return h.normalize(q,q),new h.Ray(W,q)}),K=Yo(l,1,d.zoom)*d._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:L,tilespaceRays:X,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(J=h.getBounds(I),J.min.x=h.clamp(J.min.x,0,h.EXTENT),J.min.y=h.clamp(J.min.y,0,h.EXTENT),J.max.x=h.clamp(J.max.x,0,h.EXTENT),J.max.y=h.clamp(J.max.y,0,h.EXTENT),J),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:K};var J}_bufferedScreenMercator(l,d){const _=Xn(l);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let b;return b="globe"===d.projection.name?this._projectAndResample(this.bufferedScreenGeometry(l),d):{polygon:this.bufferedScreenGeometry(l).map(w=>d.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[_]=b,b}}_bufferedCameraMercator(l,d){const _=Xn(l);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let b;return b="globe"===d.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),d):{polygon:this.bufferedCameraGeometry(l).map(w=>d.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[_]=b,b}}_projectAndResample(l,d){const _=function(w,M){const T=h.multiply([],M.pixelMatrix,M.globeMatrix),I=[0,-h.GLOBE_RADIUS,0,1],N=[0,h.GLOBE_RADIUS,0,1],L=[0,0,0,1];h.transformMat4$1(I,I,T),h.transformMat4$1(N,N,T),h.transformMat4$1(L,L,T);const U=new h.pointGeometry(I[0]/I[3],I[1]/I[3]),W=new h.pointGeometry(N[0]/N[3],N[1]/N[3]),X=h.polygonContainsPoint(w,U)&&I[3]<L[3],K=h.polygonContainsPoint(w,W)&&N[3]<L[3];if(!X&&!K)return null;const J=function(we,Se,Fe){for(let Le=1;Le<we.length;Le++){const mt=_s(Se.pointCoordinate3D(we[Le-1]).x),ke=_s(Se.pointCoordinate3D(we[Le]).x);if(Fe<0){if(mt<ke)return{idx:Le,t:-mt/(ke-1-mt)}}else if(ke<mt)return{idx:Le,t:(1-mt)/(ke+1-mt)}}return null}(w,M,X?-1:1);if(!J)return null;const{idx:Y,t:q}=J;let se=Y>1?Xo(w.slice(0,Y),M):[],re=Y<w.length?Xo(w.slice(Y),M):[];se=se.map(we=>new h.pointGeometry(_s(we.x),we.y)),re=re.map(we=>new h.pointGeometry(_s(we.x),we.y));const le=[...se];0===le.length&&le.push(re[re.length-1]);const ye=h.number(le[le.length-1].y,(0===re.length?se[0]:re[0]).y,q);let ge;return ge=X?[new h.pointGeometry(0,ye),new h.pointGeometry(0,0),new h.pointGeometry(1,0),new h.pointGeometry(1,ye)]:[new h.pointGeometry(1,ye),new h.pointGeometry(1,1),new h.pointGeometry(0,1),new h.pointGeometry(0,ye)],le.push(...ge),0===re.length?le.push(se[0]):le.push(...re),{polygon:le.map(we=>new h.MercatorCoordinate(we.x,we.y)),unwrapped:!1}}(l,d);if(_)return _;const b=function(w,M){let T=!1,I=-1/0,N=0;for(let U=0;U<w.length-1;U++)w[U].x>I&&(I=w[U].x,N=U);for(let U=0;U<w.length-1;U++){const W=(N+U)%(w.length-1),X=w[W],K=w[W+1];Math.abs(X.x-K.x)>.5&&(X.x<K.x?(X.x+=1,0===W&&(w[w.length-1].x+=1)):(K.x+=1,W+1===w.length-1&&(w[0].x+=1)),T=!0)}const L=h.mercatorXfromLng(M.center.lng);return T&&L<Math.abs(L-1)&&w.forEach(U=>{U.x-=1}),{polygon:w,unwrapped:T}}(Xo(l,d).map(w=>new h.pointGeometry(_s(w.x),w.y)),d);return{polygon:b.polygon.map(w=>new h.MercatorCoordinate(w.x,w.y)),unwrapped:b.unwrapped}}}function Xo(m,l){return h.resample(m,d=>{const _=l.pointCoordinate3D(d);d.x=_.x,d.y=_.y},1/256)}function _s(m){return m<0?1+m%1:m%1}function Xn(m){return 100*m|0}function Rn(m,l,d,_,b){const w=function(M,T){if(M)return b(M);if(T){m.url&&T.tiles&&m.tiles&&delete m.tiles;const I=h.pick(h.extend(T,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);T.vector_layers&&(I.vectorLayers=T.vector_layers,I.vectorLayerIds=I.vectorLayers.map(N=>N.id)),I.tiles=l.canonicalizeTileset(I,m.url),b(null,I)}};return m.url?h.getJSON(l.transformRequest(l.normalizeSourceURL(m.url,null,d,_),h.ResourceType.Source),w):h.exported.frame(()=>w(null,m))}class ar{constructor(l,d,_){this.bounds=h.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=d||0,this.maxzoom=_||24}validateBounds(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const d=Math.pow(2,l.z),_=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*d),b=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*d),w=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*d),M=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*d);return l.x>=_&&l.x<w&&l.y>=b&&l.y<M}}class nn{constructor(l,d,_){this.context=l;const b=l.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ei={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ko{constructor(l,d,_,b){this.length=d.length,this.attributes=_,this.itemSize=d.bytesPerElement,this.dynamicDraw=b,this.context=l;const w=l.gl;this.buffer=w.createBuffer(),l.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||d.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,d){for(let _=0;_<this.attributes.length;_++){const b=d.attributes[this.attributes[_].name];void 0!==b&&l.enableVertexAttribArray(b)}}setVertexAttribPointers(l,d,_){for(let b=0;b<this.attributes.length;b++){const w=this.attributes[b],M=d.attributes[w.name];void 0!==M&&l.vertexAttribPointer(M,w.components,l[ei[w.type]],!1,this.itemSize,w.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ys extends Kn{getDefault(){return h.Color.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Gn extends Kn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Fo extends Kn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class so extends Kn{getDefault(){return[!0,!0,!0,!0]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Qs extends Kn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class ir extends Kn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class gr extends Kn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const d=this.current;(l.func!==d.func||l.ref!==d.ref||l.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class vs extends Kn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Oo extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=l,this.dirty=!1}}class Fr extends Kn{getDefault(){return[0,1]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class ol extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=l,this.dirty=!1}}class vc extends Kn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Os extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.BLEND):d.disable(d.BLEND),this.current=l,this.dirty=!1}}class ya extends Kn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class bc extends Kn{getDefault(){return h.Color.transparent}set(l){const d=this.current;(l.r!==d.r||l.g!==d.g||l.b!==d.b||l.a!==d.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class xc extends Kn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class wn extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;l?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=l,this.dirty=!1}}class bs extends Kn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class va extends Kn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class sl extends Kn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class wc extends Kn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Cc extends Kn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const d=this.current;(l[0]!==d[0]||l[1]!==d[1]||l[2]!==d[2]||l[3]!==d[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Qo extends Kn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Rl extends Kn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class _u extends Kn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Fl extends Kn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ls extends Kn{getDefault(){return null}set(l){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Ol extends Kn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class ba extends Kn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Ec extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class al extends Kn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Jo extends Kn{constructor(l,d){super(l),this.context=l,this.parent=d}getDefault(){return null}}class bo extends Jo{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class xa extends Jo{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,this.attachment(),d.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Dc extends xa{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class wa{constructor(l,d,_,b){this.context=l,this.width=d,this.height=_;const w=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new bo(l,w),b&&(this.depthAttachment=new xa(l,w))}destroy(){const l=this.context.gl,d=this.colorAttachment.get();if(d&&l.deleteTexture(d),this.depthAttachment){const _=this.depthAttachment.get();_&&l.deleteRenderbuffer(_)}l.deleteFramebuffer(this.framebuffer)}}class te{constructor(l,d=!1){if(this.gl=l,this.isWebGL2=d,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),d){const _=l;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(l),deleteVertexArrayOES:_.deleteVertexArray.bind(l),bindVertexArrayOES:_.bindVertexArray.bind(l)}}this.clearColor=new ys(this),this.clearDepth=new Gn(this),this.clearStencil=new Fo(this),this.colorMask=new so(this),this.depthMask=new Qs(this),this.stencilMask=new ir(this),this.stencilFunc=new gr(this),this.stencilOp=new vs(this),this.stencilTest=new Oo(this),this.depthRange=new Fr(this),this.depthTest=new ol(this),this.depthFunc=new vc(this),this.blend=new Os(this),this.blendFunc=new ya(this),this.blendColor=new bc(this),this.blendEquation=new xc(this),this.cullFace=new wn(this),this.cullFaceSide=new bs(this),this.frontFace=new va(this),this.program=new sl(this),this.activeTexture=new wc(this),this.viewport=new Cc(this),this.bindFramebuffer=new Qo(this),this.bindRenderbuffer=new Rl(this),this.bindTexture=new _u(this),this.bindVertexBuffer=new Fl(this),this.bindElementBuffer=new Ls(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Ol(this),this.pixelStoreUnpack=new ba(this),this.pixelStoreUnpackPremultiplyAlpha=new Ec(this),this.pixelStoreUnpackFlipY=new al(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),d||(this.extTextureHalfFloat=l.getExtension("OES_texture_half_float")),(d||this.extTextureHalfFloat&&l.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=d||l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,d){return new nn(this,l,d)}createVertexBuffer(l,d,_){return new Ko(this,l,d,_)}createRenderbuffer(l,d,_){const b=this.gl,w=b.createRenderbuffer();return this.bindRenderbuffer.set(w),b.renderbufferStorage(b.RENDERBUFFER,l,d,_),this.bindRenderbuffer.set(null),w}createFramebuffer(l,d,_){return new wa(this,l,d,_)}clear({color:l,depth:d,stencil:_}){const b=this.gl;let w=0;l&&(w|=b.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(w|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==_&&(w|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),b.clear(w)}setCullFace(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){Ie(l.blendFunction,h.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class j extends h.Evented{constructor(l,d,_,b){if(super(),this.id=l,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(d,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new h.DedupedRequest}load(l){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"}));const d=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=Rn(this._options,this.map._requestManager,d,_,(b,w)=>{this._tileJSONRequest=null,this._loaded=!0,b?(d&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${d}`),_&&2!==_.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new h.ErrorEvent(b))):w&&(h.extend(this,w),w.bounds&&(this.tileBounds=new ar(w.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(b)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.extend({},this._options)}loadTile(l,d){const _=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(_,h.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,l.actor&&"expired"!==l.state)"loading"===l.state?l.reloadCallback=d:l.request=l.actor.send("reloadTile",b,w.bind(this));else if(l.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",b,w.bind(this),void 0,!0);else{const M=h.loadVectorTile.call({deduped:this._deduped},b,(T,I)=>{T||!I?w.call(this,T):(b.data={cacheControl:I.cacheControl,expires:I.expires,rawData:I.rawData.slice(0)},l.actor&&l.actor.send("loadTile",b,w.bind(this),void 0,!0))},!0);l.request={cancel:M}}function w(M,T){return delete l.request,l.aborted?d(null):M&&404!==M.status?d(M):(T&&T.resourceTiming&&(l.resourceTiming=T.resourceTiming),this.map._refreshExpiredTiles&&T&&l.setExpiryData(T),l.loadVectorData(T,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class H extends h.Evented{constructor(l,d,_,b){super(),this.id=l,this.dispatcher=_,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},d),h.extend(this,h.pick(d,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rn(this._options,this.map._requestManager,null,null,(d,_)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new h.ErrorEvent(d)):_&&(h.extend(this,_),_.bounds&&(this.tileBounds=new ar(_.bounds,this.minzoom,this.maxzoom)),h.postTurnstileEvent(_.tiles),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(d)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return h.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,d){const _=h.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);l.request=h.getImage(this.map._requestManager.transformRequest(b,h.ResourceType.Tile),(w,M,T,I)=>(delete l.request,l.aborted?(l.state="unloaded",d(null)):w?(l.state="errored",d(w)):M?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:T,expires:I}),l.setTexture(M,this.map.painter),l.state="loaded",h.cacheEntryPossiblyAdded(this.dispatcher),void d(null)):d(null)))}static loadTileData(l,d,_){l.setTexture(d,_)}static unloadTileData(l,d){l.texture&&d.saveTileTexture(l.texture)}abortTile(l,d){l.request&&(l.request.cancel(),delete l.request),d()}unloadTile(l,d){l.texture&&this.map.painter.saveTileTexture(l.texture),d()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let ee;function ue(m,l,d,_,b,w,M,T){const I=[m,d,b,l,_,w,1,1,1],N=[M,T,1],L=h.adjoint([],I),[U,W,X]=h.transformMat3(N,N,h.transpose(L,L));return h.multiply$1(I,[U,0,0,0,W,0,0,0,X],I)}class be extends h.Evented{constructor(l,d,_,b){super(),this.id=l,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=d,this._dirty=!1}load(l,d){this._loaded=d||!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),(_,b)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new h.ErrorEvent(_));else if(b){const{HTMLImageElement:w}=h.window;this.image=b instanceof w?h.exported.getImageData(b):b,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;const d=l.map(h.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let b=1/0,w=1/0,M=-1/0,T=-1/0;for(const U of _)b=Math.min(b,U.x),w=Math.min(w,U.y),M=Math.max(M,U.x),T=Math.max(T,U.y);const I=Math.max(M-b,T-w),N=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),L=Math.pow(2,N);return new h.CanonicalTileID(N,Math.floor((b+M)/2*L),Math.floor((w+T)/2*L))}(d),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(const I in this.tiles){const N=this.tiles[I];"loaded"!==N.state&&(N.state="loaded",N.texture=this.texture)}if(this._boundsArray)return;const d=h.tileTransform(this.tileID,this.map.transform.projection),[_,b,w,M]=this.coordinates.map(I=>{const N=d.projection.project(I[0],I[1]);return h.getTilePoint(d,N)._round()});this.perspectiveTransform=function(I,N,L,U,W,X,K,J,Y,q){const se=ue(0,0,I,0,0,N,I,N),re=ue(L,U,W,X,K,J,Y,q);return h.multiply$1(re,h.adjoint(se,se),re),[re[6]/re[8]*I/h.EXTENT,re[7]/re[8]*N/h.EXTENT]}(this.width,this.height,_.x,_.y,b.x,b.y,M.x,M.y,w.x,w.y);const T=this._boundsArray=new h.StructArrayLayout4i8;T.emplaceBack(_.x,_.y,0,0),T.emplaceBack(b.x,b.y,h.EXTENT,0),T.emplaceBack(M.x,M.y,0,h.EXTENT),T.emplaceBack(w.x,w.y,h.EXTENT,h.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(T,h.boundsAttributes.members),this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const l=this.map.painter.context,d=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new h.Texture(l,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,d){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},d(null)):(l.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ae={vector:j,raster:H,"raster-dem":class extends H{constructor(m,l,d,_){super(m,l,d,_),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){const d=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(b,w){b&&(m.state="errored",l(b)),w&&(m.dem=w,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=h.getImage(this.map._requestManager.transformRequest(d,h.ResourceType.Tile),function(b,w,M,T){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(b)m.state="errored",l(b);else if(w){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:M,expires:T});const I=h.window.ImageBitmap&&w instanceof h.window.ImageBitmap&&(null==ee&&(ee=h.window.OffscreenCanvas&&new h.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof h.window.createImageBitmap),ee),N=1-(w.width-h.prevPowerOfTwo(w.width))/2;N<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const L=I?w:h.exported.getImageData(w,N),U={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:L,encoding:this.encoding,padding:N};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",U,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const l=m.canonical,d=Math.pow(2,l.z),_=(l.x-1+d)%d,b=0===l.x?m.wrap-1:m.wrap,w=(l.x+1+d)%d,M=l.x+1===d?m.wrap+1:m.wrap,T={};return T[new h.OverscaledTileID(m.overscaledZ,b,l.z,_,l.y).key]={backfilled:!1},T[new h.OverscaledTileID(m.overscaledZ,M,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(T[new h.OverscaledTileID(m.overscaledZ,b,l.z,_,l.y-1).key]={backfilled:!1},T[new h.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},T[new h.OverscaledTileID(m.overscaledZ,M,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<d&&(T[new h.OverscaledTileID(m.overscaledZ,b,l.z,_,l.y+1).key]={backfilled:!1},T[new h.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},T[new h.OverscaledTileID(m.overscaledZ,M,l.z,w,l.y+1).key]={backfilled:!1}),T}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends h.Evented{constructor(m,l,d,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=d.getActor(),this.setEventedParent(_),this._data=l.data,this._options=h.extend({},l),this._collectResourceTiming=l.collectResourceTiming,void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const b=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*b,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*b,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:h.EXTENT,radius:(void 0!==l.clusterRadius?l.clusterRadius:50)*b,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},l),this}getClusterLeaves(m,l,d,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:l,offset:d},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new h.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=h.extend({},this.workerOptions),l=this._data;"string"==typeof l?(m.request=this.map._requestManager.transformRequest(h.exported.resolveURL(l),h.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(d,_)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new h.ErrorEvent(d));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(b.resourceTiming=_.resourceTiming[this.id]),this.fire(new h.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){const d=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(d,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,b)=>(delete m.request,m.unloadVectorData(),m.aborted?l(null):_?l(_):(m.loadVectorData(b,this.map.painter,"reloadTile"===d),l(null))),void 0,"loadTile"===d)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return h.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends be{constructor(m,l,d,_){super(m,l,d,_),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,h.ResourceType.Source).url);h.getVideo(this.urls,(l,d)=>{this._loaded=!0,l?this.fire(new h.ErrorEvent(l)):d&&(this.video=d,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:be,canvas:class extends be{constructor(m,l,d,_){super(m,l,d,_),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(b=>!Array.isArray(b)||2!==b.length||b.some(w=>"number"!=typeof w))||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const l=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends h.Evented{constructor(m,l,d,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=d,this._implementation=l,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new h.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new h.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ar(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),h.extend(this,h.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return h.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:l,y:d,z:_}=m.canonical;return this._implementation.hasTile({x:l,y:d,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){const{x:d,y:_,z:b}=m.tileID.canonical,w=new h.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:d,y:_,z:b},{signal:w.signal})).then(function(M){return delete m.request,m.aborted?(m.state="unloaded",l(null)):void 0===M?(m.state="errored",l(null)):null===M?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):(T=M)instanceof h.window.ImageData||T instanceof h.window.HTMLCanvasElement||T instanceof h.window.ImageBitmap||T instanceof h.window.HTMLImageElement?(this.loadTileData(m,M),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var T}.bind(this)).catch(M=>{20!==M.code&&(m.state="errored",l(M))}),m.request.cancel=()=>w.abort()}loadTileData(m,l){H.loadTileData(m,l,this._map.painter)}unloadTileData(m){H.unloadTileData(m,this._map.painter)}unloadTile(m,l){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:d,y:_,z:b}=m.tileID.canonical;this._implementation.unloadTile({x:d,y:_,z:b})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Te=function(m,l,d,_){const b=new Ae[l.type](m,l,d,_);if(b.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${b.id}`);return h.bindAll(["load","abort","unload","serialize","prepare"],b),b};function Ce(m,l){const d=h.identity([]);return h.scale(d,d,[.5*m.width,.5*-m.height,1]),h.translate(d,d,[1,-1,0]),h.multiply(d,d,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(d)}function Re(m,l,d,_,b,w,M,T=!1){const I=m.tilesIn(_,M,T);I.sort(Tt);const N=[];for(const U of I)N.push({wrappedTileID:U.tile.tileID.wrapped().key,queryResults:U.tile.queryRenderedFeatures(l,d,m._state,U,b,w,Ce(m.transform,U.tile.tileID),T)});const L=function(U){const W={},X={};for(const K of U){const J=K.queryResults,Y=K.wrappedTileID,q=X[Y]=X[Y]||{};for(const se in J){const re=J[se],le=q[se]=q[se]||{},ye=W[se]=W[se]||[];for(const ge of re)le[ge.featureIndex]||(le[ge.featureIndex]=!0,ye.push(ge))}}return W}(N);for(const U in L)L[U].forEach(W=>{const X=W.feature,K=X.layer;K&&"background"!==K.type&&"sky"!==K.type&&(X.source=K.source,K["source-layer"]&&(X.sourceLayer=K["source-layer"]),X.state=void 0!==X.id?m.getFeatureState(K["source-layer"],X.id):{})});return L}function tt(m,l){const d=m.getRenderableIds().map(w=>m.getTileByID(w)),_=[],b={};for(let w=0;w<d.length;w++){const M=d[w],T=M.tileID.canonical.key;b[T]||(b[T]=!0,M.querySourceFeatures(_,l))}return _}function Tt(m,l){const d=m.tileID,_=l.tileID;return d.overscaledZ-_.overscaledZ||d.canonical.y-_.canonical.y||d.wrap-_.wrap||d.canonical.x-_.canonical.x}function Je(){return null!=fd.workerClass?new fd.workerClass:new h.window.Worker(fd.workerUrl)}const zt="mapboxgl_preloaded_worker_pool";class Ft{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Ft.workerCount;)this.workers.push(new Je);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[zt]}numActive(){return Object.keys(this.active).length}}let Gt;function Ut(){return Gt||(Gt=new Ft),Gt}function Mn(m,l){const d={};for(const _ in m)"ref"!==_&&(d[_]=m[_]);return h.refProperties.forEach(_=>{_ in l&&(d[_]=l[_])}),d}function Qn(m){m=m.slice();const l=Object.create(null);for(let d=0;d<m.length;d++)l[m[d].id]=m[d];for(let d=0;d<m.length;d++)"ref"in m[d]&&(m[d]=Mn(m[d],l[m[d].ref]));return m}Ft.workerCount=2;const rn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ti(m,l,d){d.push({command:rn.addSource,args:[m,l[m]]})}function Ei(m,l,d){l.push({command:rn.removeSource,args:[m]}),d[m]=!0}function Js(m,l,d,_){Ei(m,d,_),ti(m,l,d)}function Ns(m,l,d){let _;for(_ in m[d])if(m[d].hasOwnProperty(_)&&"data"!==_&&!Ie(m[d][_],l[d][_]))return!1;for(_ in l[d])if(l[d].hasOwnProperty(_)&&"data"!==_&&!Ie(m[d][_],l[d][_]))return!1;return!0}function qe(m,l,d,_,b,w){let M;for(M in l=l||{},m=m||{})m.hasOwnProperty(M)&&(Ie(m[M],l[M])||d.push({command:w,args:[_,M,l[M],b]}));for(M in l)l.hasOwnProperty(M)&&!m.hasOwnProperty(M)&&(Ie(m[M],l[M])||d.push({command:w,args:[_,M,l[M],b]}))}function ea(m){return m.id}function rr(m,l){return m[l.id]=l,m}class Ca{constructor(l,d){this.reset(l,d)}reset(l,d){this.points=l||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(1===this.points.length)return this.points[0];l=h.clamp(l,0,1);let d=1,_=this._distances[d];const b=l*this.paddedLength+this.padding;for(;_<b&&d<this._distances.length;)_=this._distances[++d];const w=d-1,M=this._distances[w],T=_-M,I=T>0?(b-M)/T:0;return this.points[w].mult(1-I).add(this.points[d].mult(I))}}class Ju{constructor(l,d,_){const b=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(l/_),this.yCellCount=Math.ceil(d/_);for(let M=0;M<this.xCellCount*this.yCellCount;M++)b.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=d,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,d,_,b,w){this._forEachCell(d,_,b,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(d),this.bboxes.push(_),this.bboxes.push(b),this.bboxes.push(w)}insertCircle(l,d,_,b){this._forEachCell(d-b,_-b,d+b,_+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(d),this.circles.push(_),this.circles.push(b)}_insertBoxCell(l,d,_,b,w,M){this.boxCells[w].push(M)}_insertCircleCell(l,d,_,b,w,M){this.circleCells[w].push(M)}_query(l,d,_,b,w,M){if(_<0||l>this.width||b<0||d>this.height)return!w&&[];const T=[];if(l<=0&&d<=0&&this.width<=_&&this.height<=b){if(w)return!0;for(let I=0;I<this.boxKeys.length;I++)T.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const N=this.circles[3*I],L=this.circles[3*I+1],U=this.circles[3*I+2];T.push({key:this.circleKeys[I],x1:N-U,y1:L-U,x2:N+U,y2:L+U})}return M?T.filter(M):T}return this._forEachCell(l,d,_,b,this._queryCell,T,{hitTest:w,seenUids:{box:{},circle:{}}},M),w?T.length>0:T}_queryCircle(l,d,_,b,w){const M=l-_,T=l+_,I=d-_,N=d+_;if(T<0||M>this.width||N<0||I>this.height)return!b&&[];const L=[];return this._forEachCell(M,I,T,N,this._queryCellCircle,L,{hitTest:b,circle:{x:l,y:d,radius:_},seenUids:{box:{},circle:{}}},w),b?L.length>0:L}query(l,d,_,b,w){return this._query(l,d,_,b,!1,w)}hitTest(l,d,_,b,w){return this._query(l,d,_,b,!0,w)}hitTestCircle(l,d,_,b){return this._queryCircle(l,d,_,!0,b)}_queryCell(l,d,_,b,w,M,T,I){const N=T.seenUids,L=this.boxCells[w];if(null!==L){const W=this.bboxes;for(const X of L)if(!N.box[X]){N.box[X]=!0;const K=4*X;if(l<=W[K+2]&&d<=W[K+3]&&_>=W[K+0]&&b>=W[K+1]&&(!I||I(this.boxKeys[X]))){if(T.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[X],x1:W[K],y1:W[K+1],x2:W[K+2],y2:W[K+3]})}}}const U=this.circleCells[w];if(null!==U){const W=this.circles;for(const X of U)if(!N.circle[X]){N.circle[X]=!0;const K=3*X;if(this._circleAndRectCollide(W[K],W[K+1],W[K+2],l,d,_,b)&&(!I||I(this.circleKeys[X]))){if(T.hitTest)return M.push(!0),!0;{const J=W[K],Y=W[K+1],q=W[K+2];M.push({key:this.circleKeys[X],x1:J-q,y1:Y-q,x2:J+q,y2:Y+q})}}}}}_queryCellCircle(l,d,_,b,w,M,T,I){const N=T.circle,L=T.seenUids,U=this.boxCells[w];if(null!==U){const X=this.bboxes;for(const K of U)if(!L.box[K]){L.box[K]=!0;const J=4*K;if(this._circleAndRectCollide(N.x,N.y,N.radius,X[J+0],X[J+1],X[J+2],X[J+3])&&(!I||I(this.boxKeys[K])))return M.push(!0),!0}}const W=this.circleCells[w];if(null!==W){const X=this.circles;for(const K of W)if(!L.circle[K]){L.circle[K]=!0;const J=3*K;if(this._circlesCollide(X[J],X[J+1],X[J+2],N.x,N.y,N.radius)&&(!I||I(this.circleKeys[K])))return M.push(!0),!0}}}_forEachCell(l,d,_,b,w,M,T,I){const N=this._convertToXCellCoord(l),L=this._convertToYCellCoord(d),U=this._convertToXCellCoord(_),W=this._convertToYCellCoord(b);for(let X=N;X<=U;X++)for(let K=L;K<=W;K++)if(w.call(this,l,d,_,b,this.xCellCount*K+X,M,T,I))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,d,_,b,w,M){const T=b-l,I=w-d,N=_+M;return N*N>T*T+I*I}_circleAndRectCollide(l,d,_,b,w,M,T){const I=(M-b)/2,N=Math.abs(l-(b+I));if(N>I+_)return!1;const L=(T-w)/2,U=Math.abs(d-(w+L));if(U>L+_)return!1;if(N<=I||U<=L)return!0;const W=N-I,X=U-L;return W*W+X*X<=_*_}}const Bs=Math.tan(85*Math.PI/180);function Ll(m,l,d,_,b,w,M){const T=h.create();if(d)if("globe"===w.name){const I=h.calculateGlobeLabelMatrix(b,l);h.multiply(T,T,I)}else{const I=gt([],M);T[0]=I[0],T[1]=I[1],T[4]=I[2],T[5]=I[3],_||h.rotateZ(T,T,b.angle)}else h.multiply(T,b.labelPlaneMatrix,m);return T}function lr(m,l,d,_,b,w,M){const T=Ll(m,l,d,_,b,w,M);return"globe"===w.name&&d||(T[2]=T[6]=T[10]=T[14]=0),T}function qr(m,l,d,_,b,w,M){if(d){if("globe"===w.name){const T=Ll(m,l,d,_,b,w,M);return h.invert(T,T),h.multiply(T,m,T),T}{const T=h.clone(m),I=h.identity([]);return I[0]=M[0],I[1]=M[1],I[4]=M[2],I[5]=M[3],h.multiply(T,T,I),_||h.rotateZ(T,T,-b.angle),T}}return b.glCoordMatrix}function bt(m,l,d,_){const b=[m,l,d,1];d?h.transformMat4$1(b,b,_):sp(b,b,_);const w=b[3];return b[0]/=w,b[1]/=w,b[2]/=w,b}function In(m,l){return Math.min(.5+m/l*.5,1.5)}function Ht(m,l){const d=m[0]/m[3],_=m[1]/m[3];return d>=-l[0]&&d<=l[0]&&_>=-l[1]&&_<=l[1]}function es(m,l,d,_,b,w,M,T,I,N){const L=d.transform,U=_?m.textSizeData:m.iconSizeData,W=h.evaluateSizeForZoom(U,d.transform.zoom),X="globe"===L.projection.name,K=[256/d.width*2+1,256/d.height*2+1],J=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;J.clear();let Y=null;X&&(Y=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const q=m.lineVertexArray,se=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,re=d.transform.width/d.transform.height;let le,ye=!1;for(let ge=0;ge<se.length;ge++){const we=se.get(ge),{numGlyphs:Se,writingMode:Fe}=we;if(Fe!==h.WritingMode.vertical||ye||le===h.WritingMode.horizontal||(ye=!0),le=Fe,(we.hidden||Fe===h.WritingMode.vertical)&&!ye){bi(Se,J);continue}ye=!1;const Le=new h.pointGeometry(we.tileAnchorX,we.tileAnchorY);let{x:mt,y:ke,z:Ke}=L.projection.projectTilePoint(Le.x,Le.y,N.canonical);if(I){const[Fn,Rt,At]=I(Le);mt+=Fn,ke+=Rt,Ke+=At}const je=[mt,ke,Ke,1];if(h.transformMat4$1(je,je,l),!Ht(je,K)){bi(Se,J);continue}const ct=In(d.transform.cameraToCenterDistance,je[3]),Ne=h.evaluateSizeForFeature(U,W,we),Me=M?Ne/ct:Ne*ct,Ve=bt(mt,ke,Ke,b);if(Ve[3]<=0){bi(Se,J);continue}let st={};const ut=M?null:I,qt=Nl(we,Me,!1,T,l,b,w,m.glyphOffsetArray,q,J,Y,Ve,Le,st,re,ut,L.projection,N,M);ye=qt.useVertical,ut&&qt.needsFlipping&&(st={}),(qt.notEnoughRoom||ye||qt.needsFlipping&&Nl(we,Me,!0,T,l,b,w,m.glyphOffsetArray,q,J,Y,Ve,Le,st,re,ut,L.projection,N,M).notEnoughRoom)&&bi(Se,J)}_?(m.text.dynamicLayoutVertexBuffer.updateData(J),Y&&m.text.globeExtVertexBuffer.updateData(Y)):(m.icon.dynamicLayoutVertexBuffer.updateData(J),Y&&m.icon.globeExtVertexBuffer.updateData(Y))}function vi(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J){const{lineStartIndex:Y,glyphStartIndex:q,segment:se}=T,re=q+T.numGlyphs,le=Y+T.lineLength,ye=l.getoffsetX(q),ge=l.getoffsetX(re-1),we=or(m*ye,d,_,b,w,M,se,Y,le,I,N,L,U,W,!0,X,K,J);if(!we)return null;const Se=or(m*ge,d,_,b,w,M,se,Y,le,I,N,L,U,W,!0,X,K,J);return Se?{first:we,last:Se}:null}function Tn(m,l,d,_){return m===h.WritingMode.horizontal&&Math.abs(_)>Math.abs(d)?{useVertical:!0}:m===h.WritingMode.vertical?_>0?{needsFlipping:!0}:null:0!==l&&(0===(b=d)||Math.abs(_/b)>Bs)?1===l?{needsFlipping:!0}:null:d<0?{needsFlipping:!0}:null;var b}function Nl(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J,Y,q,se){const re=l/24,le=m.lineOffsetX*re,ye=m.lineOffsetY*re,{lineStartIndex:ge,glyphStartIndex:we,numGlyphs:Se,segment:Fe,writingMode:Le,flipState:mt}=m,ke=ge+m.lineLength,Ke=je=>{if(L){const[Ve,st,ut]=je.up,qt=N.length;h.updateGlobeVertexNormal(L,qt+0,Ve,st,ut),h.updateGlobeVertexNormal(L,qt+1,Ve,st,ut),h.updateGlobeVertexNormal(L,qt+2,Ve,st,ut),h.updateGlobeVertexNormal(L,qt+3,Ve,st,ut)}const[ct,Ne,Me]=je.point;h.addDynamicAttributes(N,ct,Ne,Me,je.angle)};if(Se>1){const je=vi(re,T,le,ye,d,U,W,m,I,w,X,J,!1,Y,q,se);if(!je)return{notEnoughRoom:!0};if(_&&!d){let[ct,Ne,Me]=je.first.point,[Ve,st,ut]=je.last.point;[ct,Ne]=bt(ct,Ne,Me,M),[Ve,st]=bt(Ve,st,ut,M);const qt=Tn(Le,mt,(Ve-ct)*K,st-Ne);if(m.flipState=qt&&qt.needsFlipping?1:2,qt)return qt}Ke(je.first);for(let ct=we+1;ct<we+Se-1;ct++){const Ne=or(re*T.getoffsetX(ct),le,ye,d,U,W,Fe,ge,ke,I,w,X,J,!1,!1,Y,q,se);if(!Ne)return N.length-=4*(ct-we),{notEnoughRoom:!0};Ke(Ne)}Ke(je.last)}else{if(_&&!d){const ct=bt(W.x,W.y,0,b),Ne=ge+Fe+1,Me=new h.pointGeometry(I.getx(Ne),I.gety(Ne)),Ve=bt(Me.x,Me.y,0,b),st=Ve[3]>0?Ve:pn(W,Me,ct,1,b,void 0,Y,q.canonical),ut=Tn(Le,mt,(st[0]-ct[0])*K,st[1]-ct[1]);if(m.flipState=ut&&ut.needsFlipping?1:2,ut)return ut}const je=or(re*T.getoffsetX(we),le,ye,d,U,W,Fe,ge,ke,I,w,X,J,!1,!1,Y,q,se);if(!je)return{notEnoughRoom:!0};Ke(je)}return{}}function ci(m,l,d,_,b){const{x:w,y:M,z:T}=_.projectTilePoint(m.x,m.y,l);if(!b)return bt(w,M,T,d);const[I,N,L]=b(m);return bt(w+I,M+N,T+L,d)}function pn(m,l,d,_,b,w,M,T){const I=ci(m.sub(l)._unit()._add(m),T,b,M,w);return h.sub(I,d,I),h.normalize(I,I),h.scaleAndAdd(I,d,I,_)}function or(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J,Y,q){const se=_?m-l:m+l;let re=se>0?1:-1,le=0;_&&(re*=-1,le=Math.PI),re<0&&(le+=Math.PI);let ye=T+M+(re>0?0:1)|0,ge=b,we=b,Se=0,Fe=0;const Le=Math.abs(se),mt=[],ke=[];let Ke=w,je=Ke;const ct=()=>pn(je,Ke,we,Le-Se+1,L,W,J,Y.canonical);for(;Se+Fe<=Le;){if(ye+=re,ye<T||ye>=I)return null;if(we=ge,je=Ke,mt.push(we),X&&ke.push(je),Ke=new h.pointGeometry(N.getx(ye),N.gety(ye)),ge=U[ye],!ge){const At=ci(Ke,Y.canonical,L,J,W);ge=At[3]>0?U[ye]=At:ct()}Se+=Fe,Fe=h.distance(we,ge)}K&&W&&(U[ye]&&(ge=ct(),Fe=h.distance(we,ge)),U[ye]=ge);const Ne=(Le-Se)/Fe,Me=Ke.sub(je)._mult(Ne)._add(je),Ve=h.sub([],ge,we),st=h.scaleAndAdd([],we,Ve,Ne);let ut=[0,0,1],qt=Ve[0],Fn=Ve[1];if(q&&(ut=J.upVector(Y.canonical,Me.x,Me.y),0!==ut[0]||0!==ut[1]||1!==ut[2])){const At=[ut[2],0,-ut[0]],Wt=h.cross([],ut,At);h.normalize(At,At),h.normalize(Wt,Wt),qt=h.dot(Ve,At),Fn=h.dot(Ve,Wt)}if(d){const At=h.cross([],ut,Ve);h.normalize(At,At),h.scaleAndAdd(st,st,At,d*re)}const Rt=le+Math.atan2(Fn,qt);return mt.push(st),X&&ke.push(Me),{point:st,angle:Rt,path:mt,tilePath:ke,up:ut}}function bi(m,l){const d=l.length,_=d+4*m;l.resize(_),l.float32.fill(-1/0,4*d,4*_)}function sp(m,l,d){const _=l[0],b=l[1];return m[0]=d[0]*_+d[4]*b+d[12],m[1]=d[1]*_+d[5]*b+d[13],m[3]=d[3]*_+d[7]*b+d[15],m}const Cr=100;class nt{constructor(l,d,_=new Ju(l.width+200,l.height+200,25),b=new Ju(l.width+200,l.height+200,25)){this.transform=l,this.grid=_,this.ignoredGrid=b,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Cr,this.screenBottomBoundary=l.height+Cr,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=d}placeCollisionBox(l,d,_,b,w,M,T,I){let N=_.projectedAnchorX,L=_.projectedAnchorY,U=_.projectedAnchorZ;const W=_.elevation,X=_.tileID,K=l.getProjection();if(W&&X){const[ge,we,Se]=K.upVector(X.canonical,_.tileAnchorX,_.tileAnchorY),Fe=K.upVectorScale(X.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=ge*W*Fe,L+=we*W*Fe,U+=Se*W*Fe}const J=this.projectAndGetPerspectiveRatio(T,N,L,U,_.tileID,"globe"===K.name||!!W||this.transform.pitch>0,K),Y=M*J.perspectiveRatio,q=(_.x1*d+b.x-_.padding)*Y+J.point.x,se=(_.y1*d+b.y-_.padding)*Y+J.point.y,re=(_.x2*d+b.x+_.padding)*Y+J.point.x,le=(_.y2*d+b.y+_.padding)*Y+J.point.y,ye=J.perspectiveRatio<=.55||J.occluded;return!this.isInsideGrid(q,se,re,le)||!w&&this.grid.hitTest(q,se,re,le,I)||ye?{box:[],offscreen:!1,occluded:J.occluded}:{box:[q,se,re,le],offscreen:this.isOffscreen(q,se,re,le),occluded:!1}}placeCollisionCircles(l,d,_,b,w,M,T,I,N,L,U,W,X,K,J){const Y=[],q=this.transform.elevation,se=l.getProjection(),re=q?q.getAtTileOffsetFunc(J,this.transform.center.lat,this.transform.worldSize,se):null,le=new h.pointGeometry(_.tileAnchorX,_.tileAnchorY);let{x:ye,y:ge,z:we}=se.projectTilePoint(le.x,le.y,J.canonical);if(re){const[Me,Ve,st]=re(le);ye+=Me,ge+=Ve,we+=st}const Se="globe"===se.name,Fe=this.projectAndGetPerspectiveRatio(T,ye,ge,we,J,Se||!!q||this.transform.pitch>0,se),{perspectiveRatio:Le}=Fe,mt=(U?M/Le:M*Le)/h.ONE_EM,ke=bt(ye,ge,we,I),Ke=Fe.signedDistanceFromCamera>0?vi(mt,w,_.lineOffsetX*mt,_.lineOffsetY*mt,!1,ke,le,_,b,I,{},q&&!U?re:null,U&&!!q,se,J,U):null;let je=!1,ct=!1,Ne=!0;if(Ke&&!Fe.occluded){const Me=.5*X*Le+K,Ve=new h.pointGeometry(-100,-100),st=new h.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ut=new Ca,{first:qt,last:Fn}=Ke,Rt=qt.path.length;let At=[];for(let Kt=Rt-1;Kt>=1;Kt--)At.push(qt.path[Kt]);for(let Kt=1;Kt<Fn.path.length;Kt++)At.push(Fn.path[Kt]);const Wt=2.5*Me;N&&(At=At.map(([Kt,gi,di],$i)=>(re&&!Se&&(di=re($i<Rt-1?qt.tilePath[Rt-1-$i]:Fn.tilePath[$i-Rt+2])[2]),bt(Kt,gi,di,N))),At.some(Kt=>Kt[3]<=0)&&(At=[]));let kn=[];if(At.length>0){let Kt=1/0,gi=-1/0,di=1/0,$i=-1/0;for(const Di of At)Kt=Math.min(Kt,Di[0]),di=Math.min(di,Di[1]),gi=Math.max(gi,Di[0]),$i=Math.max($i,Di[1]);gi>=Ve.x&&Kt<=st.x&&$i>=Ve.y&&di<=st.y&&(kn=[At.map(Di=>new h.pointGeometry(Di[0],Di[1]))],(Kt<Ve.x||gi>st.x||di<Ve.y||$i>st.y)&&(kn=h.clipLine(kn,Ve.x,Ve.y,st.x,st.y)))}for(const Kt of kn){ut.reset(Kt,.25*Me);let gi=0;gi=ut.length<=.5*Me?1:Math.ceil(ut.paddedLength/Wt)+1;for(let di=0;di<gi;di++){const $i=di/Math.max(gi-1,1),Di=ut.lerp($i),dr=Di.x+Cr,ho=Di.y+Cr;Y.push(dr,ho,Me,0);const La=dr-Me,Na=ho-Me,Yi=dr+Me,Ni=ho+Me;if(Ne=Ne&&this.isOffscreen(La,Na,Yi,Ni),ct=ct||this.isInsideGrid(La,Na,Yi,Ni),!d&&this.grid.hitTestCircle(dr,ho,Me,W)&&(je=!0,!L))return{circles:[],offscreen:!1,collisionDetected:je,occluded:!1}}}}return{circles:!L&&je||!ct?[]:Y,offscreen:Ne,collisionDetected:je,occluded:Fe.occluded}}queryRenderedSymbols(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let _=1/0,b=1/0,w=-1/0,M=-1/0;for(const L of l){const U=new h.pointGeometry(L.x+Cr,L.y+Cr);_=Math.min(_,U.x),b=Math.min(b,U.y),w=Math.max(w,U.x),M=Math.max(M,U.y),d.push(U)}const T=this.grid.query(_,b,w,M).concat(this.ignoredGrid.query(_,b,w,M)),I={},N={};for(const L of T){const U=L.key;if(void 0===I[U.bucketInstanceId]&&(I[U.bucketInstanceId]={}),I[U.bucketInstanceId][U.featureIndex])continue;const W=[new h.pointGeometry(L.x1,L.y1),new h.pointGeometry(L.x2,L.y1),new h.pointGeometry(L.x2,L.y2),new h.pointGeometry(L.x1,L.y2)];h.polygonIntersectsPolygon(d,W)&&(I[U.bucketInstanceId][U.featureIndex]=!0,void 0===N[U.bucketInstanceId]&&(N[U.bucketInstanceId]=[]),N[U.bucketInstanceId].push(U.featureIndex))}return N}insertCollisionBox(l,d,_,b,w){(d?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:b,collisionGroupID:w},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,d,_,b,w){const M=d?this.ignoredGrid:this.grid,T={bucketInstanceId:_,featureIndex:b,collisionGroupID:w};for(let I=0;I<l.length;I+=4)M.insertCircle(T,l[I],l[I+1],l[I+2])}projectAndGetPerspectiveRatio(l,d,_,b,w,M,T){const I=[d,_,b,1];let N=!1;b||this.transform.pitch>0?(h.transformMat4$1(I,I,l),this.fogState&&w&&"globe"!==T.name&&(N=function(X,K,J,Y,q,se){const re=se.calculateFogTileMatrix(q),le=[K,J,Y];return h.transformMat4(le,le,re),vo(X,le,se.pitch,se._fov)}(this.fogState,d,_,b,w.toUnwrapped(),this.transform)>.9)):sp(I,I,l);const L=I[3];return{point:new h.pointGeometry((I[0]/L+1)/2*this.transform.width+Cr,(-I[1]/L+1)/2*this.transform.height+Cr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(T)/L*.5,1.5),signedDistanceFromCamera:L,occluded:M&&I[2]>L||N}}isOffscreen(l,d,_,b){return _<Cr||l>=this.screenRightBoundary||b<Cr||d>this.screenBottomBoundary}isInsideGrid(l,d,_,b){return _>=0&&l<this.gridRightBoundary&&b>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const l=h.identity([]);return h.translate(l,l,[-100,-100,0]),l}}function zs(m,l,d){const _=l.createTileMatrix(m,m.worldSize,d.toUnwrapped());return h.multiply(new Float32Array(16),m.projMatrix,_)}function Sn(m,l,d){if(l.projection.name===d.projection.name)return m.projMatrix;const _=d.clone();return _.setProjection(l.projection),zs(_,l.getProjection(),m)}function fi(m,l,d){return l.name===d.projection.name?m.projMatrix:zs(d,l,m)}class Mc{constructor(l,d,_,b){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?d:-d))):b&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class Bl{constructor(l,d,_,b,w,M=!1){this.text=new Mc(l?l.text:null,d,_,w),this.icon=new Mc(l?l.icon:null,d,b,w),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zl{constructor(l,d,_,b=!1){this.text=l,this.icon=d,this.skipFade=_,this.clipped=b}}class Vs{constructor(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]}}class Zi{constructor(l,d,_,b,w){this.bucketInstanceId=l,this.featureIndex=d,this.sourceLayerIndex=_,this.bucketIndex=b,this.tileID=w}}class sr{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const d=++this.maxGroupID;this.collisionGroups[l]={ID:d,predicate:_=>_.collisionGroupID===d}}return this.collisionGroups[l]}}function yu(m,l,d,_,b){const{horizontalAlign:w,verticalAlign:M}=h.getAnchorAlignment(m),T=-(w-.5)*l,I=-(M-.5)*d,N=h.evaluateVariableOffset(m,_);return new h.pointGeometry(T+N[0]*b,I+N[1]*b)}function vu(m,l,d,_,b){const w=new h.pointGeometry(m,l);return d&&w._rotate(_?b:-b),w}class cr{constructor(l,d,_,b,w){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new nt(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new sr(_),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,d,_,b){const w=_.getBucket(d),M=_.latestFeatureIndex;if(!w||!M||d.id!==w.layerIds[0])return;const T=w.layers[0].layout,I=_.collisionBoxArray,N=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),L=_.tileSize/h.EXTENT,U=_.tileID.toUnwrapped();this.transform.setProjection(w.projection);const W=(X=_.tileID,K=w.getProjection(),J=this.transform,K.name===this.projection?J.calculateProjMatrix(X.toUnwrapped()):zs(J,K,X));var X,K,J;const Y="map"===T.get("text-pitch-alignment"),q="map"===T.get("text-rotation-alignment");d.compileFilter();const se=d.dynamicFilter(),re=d.dynamicFilterNeedsFeature(),le=this.transform.calculatePixelsToTileUnitsMatrix(_),ye=lr(W,_.tileID.canonical,Y,q,this.transform,w.getProjection(),le);let ge=null;if(Y){const Fe=qr(W,_.tileID.canonical,Y,q,this.transform,w.getProjection(),le);ge=h.multiply([],this.transform.labelPlaneMatrix,Fe)}let we=null;se&&_.latestFeatureIndex&&(we={unwrappedTileID:U,dynamicFilter:se,dynamicFilterNeedsFeature:re,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new Zi(w.bucketInstanceId,M,w.sourceLayerIndex,w.index,_.tileID);const Se={bucket:w,layout:T,posMatrix:W,textLabelPlaneMatrix:ye,labelToScreenMatrix:ge,clippingData:we,scale:N,textPixelRatio:L,holdingForFade:_.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:h.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(b)for(const Fe of w.sortKeyRanges){const{sortKey:Le,symbolInstanceStart:mt,symbolInstanceEnd:ke}=Fe;l.push({sortKey:Le,symbolInstanceStart:mt,symbolInstanceEnd:ke,parameters:Se})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Se})}attemptAnchorPlacement(l,d,_,b,w,M,T,I,N,L,U,W,X,K,J,Y,q,se){const{textOffset0:re,textOffset1:le,crossTileID:ye}=W,ge=[re,le],we=yu(l,_,b,ge,w),Se=this.collisionIndex.placeCollisionBox(K,w,d,vu(we.x,we.y,M,T,this.transform.angle),U,I,N,L.predicate);if(Y){const Fe=K.getSymbolInstanceIconSize(se,this.transform.zoom,W.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(K,Fe,Y,vu(we.x,we.y,M,T,this.transform.angle),U,I,N,L.predicate).box.length)return}if(Se.box.length>0){let Fe;return this.prevPlacement&&this.prevPlacement.variableOffsets[ye]&&this.prevPlacement.placements[ye]&&this.prevPlacement.placements[ye].text&&(Fe=this.prevPlacement.variableOffsets[ye].anchor),this.variableOffsets[ye]={textOffset:ge,width:_,height:b,anchor:l,textScale:w,prevAnchor:Fe},this.markUsedJustification(K,l,W,J),K.allowVerticalPlacement&&(this.markUsedOrientation(K,J,W),this.placedOrientations[ye]=J),{shift:we,placedGlyphBoxes:Se}}}placeLayerBucketPart(l,d,_,b){const{bucket:w,layout:M,posMatrix:T,textLabelPlaneMatrix:I,labelToScreenMatrix:N,clippingData:L,textPixelRatio:U,holdingForFade:W,collisionBoxArray:X,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:J,collisionGroup:Y}=l.parameters,q=M.get("text-optional"),se=M.get("icon-optional"),re=M.get("text-allow-overlap"),le=M.get("icon-allow-overlap"),ye="map"===M.get("text-rotation-alignment"),ge="map"===M.get("text-pitch-alignment"),we="none"!==M.get("icon-text-fit"),Se="viewport-y"===M.get("symbol-z-order");this.transform.setProjection(w.projection);let Fe=re&&(le||!w.hasIconData()||se),Le=le&&(re||!w.hasTextData()||q);!w.collisionArrays&&X&&w.deserializeCollisionBoxes(X),_&&b&&w.updateCollisionDebugBuffers(this.transform.zoom,X);const mt=(ke,Ke,je)=>{const{crossTileID:ct,numVerticalGlyphVertices:Ne}=ke;if(L){const Yi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ni=null;if(L.dynamicFilterNeedsFeature){const On=this.retainedQueryData[w.bucketInstanceId];Ni=L.featureIndex.loadFeature({featureIndex:ke.featureIndex,bucketIndex:On.bucketIndex,sourceLayerIndex:On.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,L.dynamicFilter)(Yi,Ni,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new h.pointGeometry(ke.tileAnchorX,ke.tileAnchorY),this.transform.calculateDistanceTileData(L.unwrappedTileID)))return this.placements[ct]=new zl(!1,!1,!1,!0),void(d[ct]=!0)}if(d[ct])return;if(W)return void(this.placements[ct]=new zl(!1,!1,!1));let Me=!1,Ve=!1,st=!0,ut=!1,qt=!1,Fn=null,Rt={box:null,offscreen:null,occluded:null},At={box:null,offscreen:null,occluded:null},Wt=null,kn=null,Kt=null,gi=0,di=0,$i=0;je.textFeatureIndex?gi=je.textFeatureIndex:ke.useRuntimeCollisionCircles&&(gi=ke.featureIndex),je.verticalTextFeatureIndex&&(di=je.verticalTextFeatureIndex);const Di=Yi=>{Yi.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const Ni=this.transform.elevation;(Ni||Yi.elevation)&&(Yi.elevation=Ni?Ni.getAtTileOffset(Yi.tileID,Yi.tileAnchorX,Yi.tileAnchorY):0)},dr=je.textBox;if(dr){Di(dr);const Yi=On=>{let hr=h.WritingMode.horizontal;if(w.allowVerticalPlacement&&!On&&this.prevPlacement){const Br=this.prevPlacement.placedOrientations[ct];Br&&(this.placedOrientations[ct]=Br,hr=Br,this.markUsedOrientation(w,hr,ke))}return hr},Ni=(On,hr)=>{if(w.allowVerticalPlacement&&Ne>0&&je.verticalTextBox){for(const Br of w.writingModes)if(Br===h.WritingMode.vertical?(Rt=hr(),At=Rt):Rt=On(),Rt&&Rt.box&&Rt.box.length)break}else Rt=On()};if(M.get("text-variable-anchor")){let On=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ct]){const Bi=this.prevPlacement.variableOffsets[ct];On.indexOf(Bi.anchor)>0&&(On=On.filter(po=>po!==Bi.anchor),On.unshift(Bi.anchor))}const hr=(Bi,po,Qr)=>{const Ba=w.getSymbolInstanceTextSize(K,ke,this.transform.zoom,Ke),Iu=(Bi.x2-Bi.x1)*Ba+2*Bi.padding,cs=(Bi.y2-Bi.y1)*Ba+2*Bi.padding,Ds=we&&!le?po:null;Ds&&Di(Ds);let za={box:[],offscreen:!1,occluded:!1};const yl=re?2*On.length:On.length;for(let Ql=0;Ql<yl;++Ql){const vl=this.attemptAnchorPlacement(On[Ql%On.length],Bi,Iu,cs,Ba,ye,ge,U,T,Y,Ql>=On.length,ke,Ke,w,Qr,Ds,K,J);if(vl&&(za=vl.placedGlyphBoxes,za&&za.box&&za.box.length)){Me=!0,Fn=vl.shift;break}}return za};Ni(()=>hr(dr,je.iconBox,h.WritingMode.horizontal),()=>{const Bi=je.verticalTextBox;return Bi&&Di(Bi),w.allowVerticalPlacement&&!(Rt&&Rt.box&&Rt.box.length)&&Ne>0&&Bi?hr(Bi,je.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Rt&&(Me=Rt.box,st=Rt.offscreen,ut=Rt.occluded);const Br=Yi(Rt&&Rt.box);if(!Me&&this.prevPlacement){const Bi=this.prevPlacement.variableOffsets[ct];Bi&&(this.variableOffsets[ct]=Bi,this.markUsedJustification(w,Bi.anchor,ke,Br))}}else{const On=(hr,Br)=>{const Bi=w.getSymbolInstanceTextSize(K,ke,this.transform.zoom,Ke),po=this.collisionIndex.placeCollisionBox(w,Bi,hr,new h.pointGeometry(0,0),re,U,T,Y.predicate);return po&&po.box&&po.box.length&&(this.markUsedOrientation(w,Br,ke),this.placedOrientations[ct]=Br),po};Ni(()=>On(dr,h.WritingMode.horizontal),()=>{const hr=je.verticalTextBox;return w.allowVerticalPlacement&&Ne>0&&hr?(Di(hr),On(hr,h.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Yi(Rt&&Rt.box&&Rt.box.length)}}if(Wt=Rt,Me=Wt&&Wt.box&&Wt.box.length>0,st=Wt&&Wt.offscreen,ut=Wt&&Wt.occluded,ke.useRuntimeCollisionCircles){const Yi=w.text.placedSymbolArray.get(ke.centerJustifiedTextSymbolIndex>=0?ke.centerJustifiedTextSymbolIndex:ke.verticalPlacedTextSymbolIndex),Ni=h.evaluateSizeForFeature(w.textSizeData,K,Yi),On=M.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(w,re,Yi,w.lineVertexArray,w.glyphOffsetArray,Ni,T,I,N,_,ge,Y.predicate,ke.collisionCircleDiameter*Ni/h.ONE_EM,On,this.retainedQueryData[w.bucketInstanceId].tileID),Me=re||kn.circles.length>0&&!kn.collisionDetected,st=st&&kn.offscreen,ut=kn.occluded}if(je.iconFeatureIndex&&($i=je.iconFeatureIndex),je.iconBox){const Yi=Ni=>{Di(Ni);const On=we&&Fn?vu(Fn.x,Fn.y,ye,ge,this.transform.angle):new h.pointGeometry(0,0),hr=w.getSymbolInstanceIconSize(J,this.transform.zoom,ke.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,hr,Ni,On,le,U,T,Y.predicate)};At&&At.box&&At.box.length&&je.verticalIconBox?(Kt=Yi(je.verticalIconBox),Ve=Kt.box.length>0):(Kt=Yi(je.iconBox),Ve=Kt.box.length>0),st=st&&Kt.offscreen,qt=Kt.occluded}const ho=q||0===ke.numHorizontalGlyphVertices&&0===Ne,La=se||0===ke.numIconVertices;if(ho||La?La?ho||(Ve=Ve&&Me):Me=Ve&&Me:Ve=Me=Ve&&Me,Me&&Wt&&Wt.box&&this.collisionIndex.insertCollisionBox(Wt.box,M.get("text-ignore-placement"),w.bucketInstanceId,At&&At.box&&di?di:gi,Y.ID),Ve&&Kt&&this.collisionIndex.insertCollisionBox(Kt.box,M.get("icon-ignore-placement"),w.bucketInstanceId,$i,Y.ID),kn&&(Me&&this.collisionIndex.insertCollisionCircles(kn.circles,M.get("text-ignore-placement"),w.bucketInstanceId,gi,Y.ID),_)){const Yi=w.bucketInstanceId;let Ni=this.collisionCircleArrays[Yi];void 0===Ni&&(Ni=this.collisionCircleArrays[Yi]=new Vs);for(let On=0;On<kn.circles.length;On+=4)Ni.circles.push(kn.circles[On+0]),Ni.circles.push(kn.circles[On+1]),Ni.circles.push(kn.circles[On+2]),Ni.circles.push(kn.collisionDetected?1:0)}const Na="globe"!==w.projection.name;Fe=Fe&&(Na||!ut),Le=Le&&(Na||!qt),this.placements[ct]=new zl(Me||Fe,Ve||Le,st||w.justReloaded),d[ct]=!0};if(Se){const ke=w.getSortedSymbolIndexes(this.transform.angle);for(let Ke=ke.length-1;Ke>=0;--Ke){const je=ke[Ke];mt(w.symbolInstances.get(je),je,w.collisionArrays[je])}}else for(let ke=l.symbolInstanceStart;ke<l.symbolInstanceEnd;ke++)mt(w.symbolInstances.get(ke),ke,w.collisionArrays[ke]);if(_&&w.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[w.bucketInstanceId];h.invert(ke.invProjMatrix,T),ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(l,d,_,b){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:T,verticalPlacedTextSymbolIndex:I,crossTileID:N}=_,L=h.getAnchorJustification(d),U=b===h.WritingMode.vertical?I:"left"===L?w:"center"===L?M:"right"===L?T:-1;w>=0&&(l.text.placedSymbolArray.get(w).crossTileID=U>=0&&w!==U?0:N),M>=0&&(l.text.placedSymbolArray.get(M).crossTileID=U>=0&&M!==U?0:N),T>=0&&(l.text.placedSymbolArray.get(T).crossTileID=U>=0&&T!==U?0:N),I>=0&&(l.text.placedSymbolArray.get(I).crossTileID=U>=0&&I!==U?0:N)}markUsedOrientation(l,d,_){const b=d===h.WritingMode.horizontal||d===h.WritingMode.horizontalOnly?d:0,w=d===h.WritingMode.vertical?d:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:N}=_,L=l.text.placedSymbolArray;M>=0&&(L.get(M).placedOrientation=b),T>=0&&(L.get(T).placedOrientation=b),I>=0&&(L.get(I).placedOrientation=b),N>=0&&(L.get(N).placedOrientation=w)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let _=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const b=d?d.symbolFadeChange(l):1,w=d?d.opacities:{},M=d?d.variableOffsets:{},T=d?d.placedOrientations:{};for(const I in this.placements){const N=this.placements[I],L=w[I];L?(this.opacities[I]=new Bl(L,b,N.text,N.icon,null,N.clipped),_=_||N.text!==L.text.placed||N.icon!==L.icon.placed):(this.opacities[I]=new Bl(null,b,N.text,N.icon,N.skipFade,N.clipped),_=_||N.text||N.icon)}for(const I in w){const N=w[I];if(!this.opacities[I]){const L=new Bl(N,b,!1,!1);L.isHidden()||(this.opacities[I]=L,_=_||N.text.placed||N.icon.placed)}}for(const I in M)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=M[I]);for(const I in T)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=T[I]);_?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:l)}updateLayerOpacities(l,d){const _={};for(const b of d){const w=b.getBucket(l);w&&b.latestFeatureIndex&&l.id===w.layerIds[0]&&this.updateBucketOpacities(w,_,b.collisionBoxArray)}}updateBucketOpacities(l,d,_){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const b=l.layers[0].layout,w=!!l.layers[0].dynamicFilter(),M=new Bl(null,0,!1,!1,!0),T=b.get("text-allow-overlap"),I=b.get("icon-allow-overlap"),N=b.get("text-variable-anchor"),L="map"===b.get("text-rotation-alignment"),U="map"===b.get("text-pitch-alignment"),W="none"!==b.get("icon-text-fit"),X=new Bl(null,0,T&&(I||!l.hasIconData()||b.get("icon-optional")),I&&(T||!l.hasTextData()||b.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);const K=(Y,q,se)=>{for(let re=0;re<q/4;re++)Y.opacityVertexArray.emplaceBack(se)};let J=0;for(let Y=0;Y<l.symbolInstances.length;Y++){const q=l.symbolInstances.get(Y),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:re,crossTileID:le,numIconVertices:ye}=q;let ge=this.opacities[le];d[le]?ge=M:ge||(ge=X,this.opacities[le]=ge),d[le]=!0;const we=se>0||re>0,Se=ye>0,Fe=this.placedOrientations[le],Le=Fe===h.WritingMode.vertical,mt=Fe===h.WritingMode.horizontal||Fe===h.WritingMode.horizontalOnly;if(!we&&!Se||ge.isHidden()||J++,we){const ke=Ar(ge.text);K(l.text,se,Le?oi:ke),K(l.text,re,mt?oi:ke);const Ke=ge.text.isHidden(),{leftJustifiedTextSymbolIndex:je,centerJustifiedTextSymbolIndex:ct,rightJustifiedTextSymbolIndex:Ne,verticalPlacedTextSymbolIndex:Me}=q,Ve=l.text.placedSymbolArray,st=Ke||Le?1:0;je>=0&&(Ve.get(je).hidden=st),ct>=0&&(Ve.get(ct).hidden=st),Ne>=0&&(Ve.get(Ne).hidden=st),Me>=0&&(Ve.get(Me).hidden=Ke||mt?1:0);const ut=this.variableOffsets[le];ut&&this.markUsedJustification(l,ut.anchor,q,Fe);const qt=this.placedOrientations[le];qt&&(this.markUsedJustification(l,"left",q,qt),this.markUsedOrientation(l,qt,q))}if(Se){const ke=Ar(ge.icon),{placedIconSymbolIndex:Ke,verticalPlacedIconSymbolIndex:je}=q,ct=l.icon.placedSymbolArray,Ne=ge.icon.isHidden()?1:0;Ke>=0&&(K(l.icon,ye,Le?oi:ke),ct.get(Ke).hidden=Ne),je>=0&&(K(l.icon,q.numVerticalIconVertices,mt?oi:ke),ct.get(je).hidden=Ne)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const ke=l.collisionArrays[Y];if(ke){let Ke=new h.pointGeometry(0,0),je=!0;if(ke.textBox||ke.verticalTextBox){if(N){const Ne=this.variableOffsets[le];Ne?(Ke=yu(Ne.anchor,Ne.width,Ne.height,Ne.textOffset,Ne.textScale),L&&Ke._rotate(U?this.transform.angle:-this.transform.angle)):je=!1}w&&(je=!ge.clipped),ke.textBox&&xo(l.textCollisionBox.collisionVertexArray,ge.text.placed,!je||Le,Ke.x,Ke.y),ke.verticalTextBox&&xo(l.textCollisionBox.collisionVertexArray,ge.text.placed,!je||mt,Ke.x,Ke.y)}const ct=je&&Boolean(!mt&&ke.verticalIconBox);ke.iconBox&&xo(l.iconCollisionBox.collisionVertexArray,ge.icon.placed,ct,W?Ke.x:0,W?Ke.y:0),ke.verticalIconBox&&xo(l.iconCollisionBox.collisionVertexArray,ge.icon.placed,!ct,W?Ke.x:0,W?Ke.y:0)}}}if(l.fullyClipped=0===J,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const Y=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Y.invProjMatrix,l.placementViewportMatrix=Y.viewportMatrix,l.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,d){const _=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*_>l}setStale(){this.stale=!0}}function xo(m,l,d,_,b){m.emplaceBack(l?1:0,d?1:0,_||0,b||0),m.emplaceBack(l?1:0,d?1:0,_||0,b||0),m.emplaceBack(l?1:0,d?1:0,_||0,b||0),m.emplaceBack(l?1:0,d?1:0,_||0,b||0)}const ap=Math.pow(2,25),ed=Math.pow(2,24),Er=Math.pow(2,17),Sc=Math.pow(2,16),$d=Math.pow(2,9),Vl=Math.pow(2,8),Wr=Math.pow(2,1);function Ar(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const l=m.placed?1:0,d=Math.floor(127*m.opacity);return d*ap+l*ed+d*Er+l*Sc+d*$d+l*Vl+d*Wr+l}const oi=0;class Ea{constructor(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&void 0!==l.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,d,_,b,w){const M=this._bucketParts;for(;this._currentTileIndex<l.length;)if(d.getBucketParts(M,b,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((T,I)=>T.sortKey-I.sortKey));this._currentPartIndex<M.length;){const T=M[this._currentPartIndex];if(d.placeLayerBucketPart(T,this._seenCrossTileIDs,_,0===T.symbolInstanceStart),this._currentPartIndex++,w())return!0}return!1}}class bu{constructor(l,d,_,b,w,M,T,I){this.placement=new cr(l,w,M,T,I),this._currentPlacementIndex=d.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(l,d,_){const b=h.exported.now(),w=()=>{const M=h.exported.now()-b;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=d[l[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if("symbol"===M.type&&(!M.minzoom||M.minzoom<=T)&&(!M.maxzoom||M.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Ea(M)),this._inProgressLayer.continuePlacement(_[M.source],this.placement,this._showCollisionBoxes,M,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const ll=512/h.EXTENT/2;class Mt{constructor(l,d,_){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let b=0;b<d.length;b++){const w=d.get(b),M=w.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,l)})}}getScaledCoordinates(l,d){const _=ll/Math.pow(2,d.canonical.z-this.tileID.canonical.z);return{x:Math.floor((d.canonical.x*h.EXTENT+l.tileAnchorX)*_),y:Math.floor((d.canonical.y*h.EXTENT+l.tileAnchorY)*_)}}findMatches(l,d,_){const b=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let w=0;w<l.length;w++){const M=l.get(w);if(M.crossTileID)continue;const T=this.indexedSymbolInstances[M.key];if(!T)continue;const I=this.getScaledCoordinates(M,d);for(const N of T)if(Math.abs(N.coord.x-I.x)<=b&&Math.abs(N.coord.y-I.y)<=b&&!_[N.crossTileID]){_[N.crossTileID]=!0,M.crossTileID=N.crossTileID;break}}}}class Hd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const d=Math.round((l-this.lng)/360);if(0!==d)for(const _ in this.indexes){const b=this.indexes[_],w={};for(const M in b){const T=b[M];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+d),w[T.tileID.key]=T}this.indexes[_]=w}this.lng=l}addBucket(l,d,_){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let w=0;w<d.symbolInstances.length;w++)d.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const b=this.usedCrossTileIDs[l.overscaledZ];for(const w in this.indexes){const M=this.indexes[w];if(Number(w)>l.overscaledZ)for(const T in M){const I=M[T];I.tileID.isChildOf(l)&&I.findMatches(d.symbolInstances,l,b)}else{const T=M[l.scaledTo(Number(w)).key];T&&T.findMatches(d.symbolInstances,l,b)}}for(let w=0;w<d.symbolInstances.length;w++){const M=d.symbolInstances.get(w);M.crossTileID||(M.crossTileID=_.generate(),b[M.crossTileID]=!0)}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Mt(l,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(l,d){for(const _ in d.indexedSymbolInstances)for(const b of d.indexedSymbolInstances[_])delete this.usedCrossTileIDs[l][b.crossTileID]}removeStaleBuckets(l){let d=!1;for(const _ in this.indexes){const b=this.indexes[_];for(const w in b)l[b[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,b[w]),delete b[w],d=!0)}return d}}class Ul{constructor(){this.layerIndexes={},this.crossTileIDs=new Hd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,d,_,b){let w=this.layerIndexes[l.id];void 0===w&&(w=this.layerIndexes[l.id]=new qn);let M=!1;const T={};"globe"!==b.name&&w.handleWrapJump(_);for(const I of d){const N=I.getBucket(l);N&&l.id===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(I.tileID,N,this.crossTileIDs)&&(M=!0),T[N.bucketInstanceId]=!0)}return w.removeStaleBuckets(T)&&(M=!0),M}pruneUnusedLayers(l){const d={};l.forEach(_=>{d[_]=!0});for(const _ in this.layerIndexes)d[_]||delete this.layerIndexes[_]}}const jl=(m,l)=>h.emitValidationErrors(m,l&&l.filter(d=>"source.canvas"!==d.identifier)),Da=h.pick(rn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Ma=h.pick(rn,["setCenter","setZoom","setBearing","setPitch"]),Tc={version:8,layers:[],sources:{}},xs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class wo extends h.Evented{constructor(l,d={}){super(),this.map=l,this.dispatcher=new Fs(Ut(),this),this.imageManager=new Ti,this.imageManager.setEventedParent(this),this.glyphManager=new h.GlyphManager(l._requestManager,d.localFontFamily?h.LocalGlyphMode.all:d.localIdeographFontFamily?h.LocalGlyphMode.ideographs:h.LocalGlyphMode.none,d.localFontFamily||d.localIdeographFontFamily),this.crossTileSymbolIndex=new Ul,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());const _=this;this._rtlTextPluginCallback=wo.registerForPluginStateChange(b=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(w,M)=>{if(h.triggerPluginCompletionEvent(w),M&&M.every(T=>T))for(const T in _._sourceCaches){const I=_._sourceCaches[T],N=I.getSource().type;"vector"!==N&&"geojson"!==N||I.reload()}})}),this.on("data",b=>{if("source"!==b.dataType||"metadata"!==b.sourceDataType)return;const w=this.getSource(b.sourceId);if(w&&w.vectorLayerIds)for(const M in this._layers){const T=this._layers[M];T.source===w.id&&this._validateLayer(T)}})}loadURL(l,d={}){this.fire(new h.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof d.validate?d.validate:!h.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,d.accessToken);const b=this.map._requestManager.transformRequest(l,h.ResourceType.Style);this._request=h.getJSON(b,(w,M)=>{this._request=null,w?this.fire(new h.ErrorEvent(w)):M&&this._load(M,_)})}loadJSON(l,d={}){this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.exported.frame(()=>{this._request=null,this._load(l,!1!==d.validate)})}loadEmpty(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(Tc,!1)}_updateLayerCount(l,d){const _=d?1:-1;l.is3D()&&(this._num3DLayers+=_),"circle"===l.type&&(this._numCircleLayers+=_),"symbol"===l.type&&(this._numSymbolLayers+=_)}_load(l,d){if(d&&jl(this,h.validateStyle(l)))return;this._loaded=!0,this.stylesheet=h.clone$1(l),this._updateMapProjection();for(const b in l.sources)this.addSource(b,l.sources[b],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const _=Qn(this.stylesheet.layers);this._order=_.map(b=>b.id),this._layers={},this._serializedLayers={};for(const b of _){const w=h.createStyleLayer(b);w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new fr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=function(d,_,b){let w,M,T;const I=h.exported.devicePixelRatio>1?"@2x":"";let N=h.getJSON(_.transformRequest(_.normalizeSpriteURL(d,I,".json"),h.ResourceType.SpriteJSON),(W,X)=>{N=null,T||(T=W,w=X,U())}),L=h.getImage(_.transformRequest(_.normalizeSpriteURL(d,I,".png"),h.ResourceType.SpriteImage),(W,X)=>{L=null,T||(T=W,M=X,U())});function U(){if(T)b(T);else if(w&&M){const W=h.exported.getImageData(M),X={};for(const K in w){const{width:J,height:Y,x:q,y:se,sdf:re,pixelRatio:le,stretchX:ye,stretchY:ge,content:we}=w[K],Se=new h.RGBAImage({width:J,height:Y});h.RGBAImage.copy(W,Se,{x:q,y:se},{x:0,y:0},{width:J,height:Y}),X[K]={data:Se,pixelRatio:le,sdf:re,stretchX:ye,stretchY:ge,content:we}}b(null,X)}}return{cancel(){N&&(N.cancel(),N=null),L&&(L.cancel(),L=null)}}}(l,this.map._requestManager,(d,_)=>{if(this._spriteRequest=null,d)this.fire(new h.ErrorEvent(d));else if(_)for(const b in _)this.imageManager.addImage(b,_[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new h.Event("data",{dataType:"style"}))})}_validateLayer(l){const d=this.getSource(l.source);if(!d)return;const _=l.sourceLayer;_&&("geojson"===d.type||d.vectorLayerIds&&-1===d.vectorLayerIds.indexOf(_))&&this.fire(new h.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${d.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const d=[];for(const _ of l){const b=this._layers[_];"custom"!==b.type&&d.push(b.serialize())}return d}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&("function"==typeof l.isLayerDraped?l.isLayerDraped():xs[l.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const d=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(b.length||w.length)&&this._updateWorkerLayers(b,w);for(const M in this._updatedSources){const T=this._updatedSources[M];"reload"===T?this._reloadSource(M):"clear"===T&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const _={};for(const b in this._sourceCaches){const w=this._sourceCaches[b];_[b]=w.used,w.used=!1}for(const b of this._order){const w=this._layers[b];if(w.recalculate(l,this._availableImages),!w.isHidden(l.zoom)){const T=this._getLayerSourceCache(w);T&&(T.used=!0)}const M=this.map.painter;if(M){const T=w.getProgramIds();if(!T)continue;const I=w.getProgramConfiguration(l.zoom);for(const N of T)M.useProgram(N,I)}}for(const b in _){const w=this._sourceCaches[b];_[b]!==w.used&&w.getSource().fire(new h.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),d&&this.fire(new h.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const d in this._sourceCaches)this._sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),jl(this,h.validateStyle(l)))return!1;(l=h.clone$1(l)).layers=Qn(l.layers);const d=function(b,w){if(!b)return[{command:rn.setStyle,args:[w]}];let M=[];try{if(!Ie(b.version,w.version))return[{command:rn.setStyle,args:[w]}];Ie(b.center,w.center)||M.push({command:rn.setCenter,args:[w.center]}),Ie(b.zoom,w.zoom)||M.push({command:rn.setZoom,args:[w.zoom]}),Ie(b.bearing,w.bearing)||M.push({command:rn.setBearing,args:[w.bearing]}),Ie(b.pitch,w.pitch)||M.push({command:rn.setPitch,args:[w.pitch]}),Ie(b.sprite,w.sprite)||M.push({command:rn.setSprite,args:[w.sprite]}),Ie(b.glyphs,w.glyphs)||M.push({command:rn.setGlyphs,args:[w.glyphs]}),Ie(b.transition,w.transition)||M.push({command:rn.setTransition,args:[w.transition]}),Ie(b.light,w.light)||M.push({command:rn.setLight,args:[w.light]}),Ie(b.fog,w.fog)||M.push({command:rn.setFog,args:[w.fog]}),Ie(b.projection,w.projection)||M.push({command:rn.setProjection,args:[w.projection]});const T={},I=[];!function(U,W,X,K){let J;for(J in W=W||{},U=U||{})U.hasOwnProperty(J)&&(W.hasOwnProperty(J)||Ei(J,X,K));for(J in W){if(!W.hasOwnProperty(J))continue;const Y=W[J];U.hasOwnProperty(J)?Ie(U[J],Y)||("geojson"===U[J].type&&"geojson"===Y.type&&Ns(U,W,J)?X.push({command:rn.setGeoJSONSourceData,args:[J,Y.data]}):Js(J,W,X,K)):ti(J,W,X)}}(b.sources,w.sources,I,T);const N=[];b.layers&&b.layers.forEach(U=>{U.source&&T[U.source]?M.push({command:rn.removeLayer,args:[U.id]}):N.push(U)});let L=b.terrain;L&&T[L.source]&&(M.push({command:rn.setTerrain,args:[void 0]}),L=void 0),M=M.concat(I),Ie(L,w.terrain)||M.push({command:rn.setTerrain,args:[w.terrain]}),function(U,W,X){W=W||[];const K=(U=U||[]).map(ea),J=W.map(ea),Y=U.reduce(rr,{}),q=W.reduce(rr,{}),se=K.slice(),re=Object.create(null);let le,ye,ge,we,Se,Fe,Le;for(le=0,ye=0;le<K.length;le++)ge=K[le],q.hasOwnProperty(ge)?ye++:(X.push({command:rn.removeLayer,args:[ge]}),se.splice(se.indexOf(ge,ye),1));for(le=0,ye=0;le<J.length;le++)ge=J[J.length-1-le],se[se.length-1-le]!==ge&&(Y.hasOwnProperty(ge)?(X.push({command:rn.removeLayer,args:[ge]}),se.splice(se.lastIndexOf(ge,se.length-ye),1)):ye++,Fe=se[se.length-le],X.push({command:rn.addLayer,args:[q[ge],Fe]}),se.splice(se.length-le,0,ge),re[ge]=!0);for(le=0;le<J.length;le++)if(ge=J[le],we=Y[ge],Se=q[ge],!re[ge]&&!Ie(we,Se))if(Ie(we.source,Se.source)&&Ie(we["source-layer"],Se["source-layer"])&&Ie(we.type,Se.type)){for(Le in qe(we.layout,Se.layout,X,ge,null,rn.setLayoutProperty),qe(we.paint,Se.paint,X,ge,null,rn.setPaintProperty),Ie(we.filter,Se.filter)||X.push({command:rn.setFilter,args:[ge,Se.filter]}),Ie(we.minzoom,Se.minzoom)&&Ie(we.maxzoom,Se.maxzoom)||X.push({command:rn.setLayerZoomRange,args:[ge,Se.minzoom,Se.maxzoom]}),we)we.hasOwnProperty(Le)&&"layout"!==Le&&"paint"!==Le&&"filter"!==Le&&"metadata"!==Le&&"minzoom"!==Le&&"maxzoom"!==Le&&(0===Le.indexOf("paint.")?qe(we[Le],Se[Le],X,ge,Le.slice(6),rn.setPaintProperty):Ie(we[Le],Se[Le])||X.push({command:rn.setLayerProperty,args:[ge,Le,Se[Le]]}));for(Le in Se)Se.hasOwnProperty(Le)&&!we.hasOwnProperty(Le)&&"layout"!==Le&&"paint"!==Le&&"filter"!==Le&&"metadata"!==Le&&"minzoom"!==Le&&"maxzoom"!==Le&&(0===Le.indexOf("paint.")?qe(we[Le],Se[Le],X,ge,Le.slice(6),rn.setPaintProperty):Ie(we[Le],Se[Le])||X.push({command:rn.setLayerProperty,args:[ge,Le,Se[Le]]}))}else X.push({command:rn.removeLayer,args:[ge]}),Fe=se[se.lastIndexOf(ge)+1],X.push({command:rn.addLayer,args:[Se,Fe]})}(N,w.layers,M)}catch(T){console.warn("Unable to compute style diff:",T),M=[{command:rn.setStyle,args:[w]}]}return M}(this.serialize(),l).filter(b=>!(b.command in Ma));if(0===d.length)return!1;const _=d.filter(b=>!(b.command in Da));if(_.length>0)throw new Error(`Unimplemented: ${_.map(b=>b.command).join(", ")}.`);return d.forEach(b=>{"setTransition"!==b.command&&"setProjection"!==b.command&&this[b.command].apply(this,b.args)}),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,d){return this.getImage(l)?this.fire(new h.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,d),this._afterImageUpdated(l),this)}updateImage(l,d){this.imageManager.updateImage(l,d)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new h.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,d,_={}){if(this._checkLoaded(),void 0!==this.getSource(l))throw new Error("There is already a source with this ID");if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(h.validateSource,`sources.${l}`,d,null,_))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const b=Te(l,d,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:b.serialize(),sourceId:l}));const w=M=>{const T=(M?"symbol:":"other:")+l,I=this._sourceCaches[T]=new h.SourceCache(T,b,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[l]=I,I.style=this,I.onAdd(this.map)};w(!1),"vector"!==d.type&&"geojson"!==d.type||w(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const d=this.getSource(l);if(!d)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===l)return this.fire(new h.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new h.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(l);for(const b of _)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],d.setEventedParent(null),d.onRemove&&d.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,d){this._checkLoaded(),this.getSource(l).setData(d),this._changed=!0}getSource(l){const d=this._getSourceCache(l);return d&&d.getSource()}_getSources(){const l=[];for(const d in this._otherSourceCaches){const _=this._getSourceCache(d);_&&l.push(_.getSource())}return l}addLayer(l,d,_={}){this._checkLoaded();const b=l.id;if(this.getLayer(b))return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let w;if("custom"===l.type){if(jl(this,h.validateCustomStyleLayer(l)))return;w=h.createStyleLayer(l)}else{if("object"==typeof l.source&&(this.addSource(b,l.source),l=h.clone$1(l),l=h.extend(l,{source:b})),this._validate(h.validateLayer,`layers.${b}`,l,{arrayIndex:-1},_))return;w=h.createStyleLayer(l),this._validateLayer(w),w.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const M=d?this._order.indexOf(d):this._order.length;if(d&&-1===M)return void this.fire(new h.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`)));this._order.splice(M,0,b),this._layerOrderChanged=!0,this._layers[b]=w;const T=this._getLayerSourceCache(w);if(this._removedLayers[b]&&w.source&&T&&"custom"!==w.type){const I=this._removedLayers[b];delete this._removedLayers[b],I.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",T.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,d){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===d)return;const _=this._order.indexOf(l);this._order.splice(_,1);const b=d?this._order.indexOf(d):this._order.length;d&&-1===b?this.fire(new h.ErrorEvent(new Error(`Layer with id "${d}" does not exist on this map.`))):(this._order.splice(b,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const d=this._layers[l];if(!d)return void this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));d.setEventedParent(null),this._updateLayerCount(d,!1);const _=this._order.indexOf(l);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=d,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],d.onRemove&&d.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const d in this._layers)if(this._layers[d].type===l)return!0;return!1}setLayerZoomRange(l,d,_){this._checkLoaded();const b=this.getLayer(l);b?b.minzoom===d&&b.maxzoom===_||(null!=d&&(b.minzoom=d),null!=_&&(b.maxzoom=_),this._updateLayer(b)):this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,d,_={}){this._checkLoaded();const b=this.getLayer(l);if(b){if(!Ie(b.filter,d))return null==d?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(h.validateFilter,`layers.${b.id}.filter`,d,{layerType:b.type},_)||(b.filter=h.clone$1(d),this._updateLayer(b)))}else this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){const d=this.getLayer(l);return d&&h.clone$1(d.filter)}setLayoutProperty(l,d,_,b={}){this._checkLoaded();const w=this.getLayer(l);w?Ie(w.getLayoutProperty(d),_)||(w.setLayoutProperty(d,_,b),this._updateLayer(w)):this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,d){const _=this.getLayer(l);if(_)return _.getLayoutProperty(d);this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,d,_,b={}){this._checkLoaded();const w=this.getLayer(l);w?Ie(w.getPaintProperty(d),_)||(w.setPaintProperty(d,_,b)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new h.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,d){const _=this.getLayer(l);return _&&_.getPaintProperty(d)}setFeatureState(l,d){this._checkLoaded();const _=l.source,b=l.sourceLayer,w=this.getSource(_);if(!w)return void this.fire(new h.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const M=w.type;if("geojson"===M&&b)return void this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!b)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===l.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided.")));const T=this._getSourceCaches(_);for(const I of T)I.setFeatureState(b,l.id,d)}removeFeatureState(l,d){this._checkLoaded();const _=l.source,b=this.getSource(_);if(!b)return void this.fire(new h.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const w=b.type,M="vector"===w?l.sourceLayer:void 0;if("vector"===w&&!M)return void this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(d&&"string"!=typeof l.id&&"number"!=typeof l.id)return void this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const T=this._getSourceCaches(_);for(const I of T)I.removeFeatureState(M,l.id,d)}getFeatureState(l){this._checkLoaded();const d=l.source,_=l.sourceLayer,b=this.getSource(d);if(b){if("vector"!==b.type||_)return void 0===l.id&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(d)[0].getFeatureState(_,l.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const d in this._sourceCaches){const _=this._sourceCaches[d].getSource();l[_.id]||(l[_.id]=_.serialize())}return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},d=>void 0!==d)}_updateLayer(l){this._updatedLayers[l.id]=!0;const d=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&d&&"raster"!==d.getSource().type&&(this._updatedSources[l.source]="reload",d.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const d=M=>"fill-extrusion"===this._layers[M].type,_={},b=[];for(let M=this._order.length-1;M>=0;M--){const T=this._order[M];if(d(T)){_[T]=M;for(const I of l){const N=I[T];if(N)for(const L of N)b.push(L)}}}b.sort((M,T)=>T.intersectionZ-M.intersectionZ);const w=[];for(let M=this._order.length-1;M>=0;M--){const T=this._order[M];if(d(T))for(let I=b.length-1;I>=0;I--){const N=b[I].feature;if(_[N.layer.id]<M)break;w.push(N),b.pop()}else for(const I of l){const N=I[T];if(N)for(const L of N)w.push(L.feature)}}return w}queryRenderedFeatures(l,d,_){d&&d.filter&&this._validate(h.validateFilter,"queryRenderedFeatures.filter",d.filter,null,d);const b={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const I of d.layers){const N=this._layers[I];if(!N)return this.fire(new h.ErrorEvent(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];b[N.source]=!0}}const w=[];d.availableImages=this._availableImages;const M=d&&d.layers?d.layers.some(I=>{const N=this.getLayer(I);return N&&N.is3D()}):this.has3DLayers(),T=yn.createFromScreenPoints(l,_);for(const I in this._sourceCaches){const N=this._sourceCaches[I].getSource().id;d.layers&&!b[N]||w.push(Re(this._sourceCaches[I],this._layers,this._serializedLayers,T,d,_,M,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(I,N,L,U,W,X,K){const J={},Y=X.queryRenderedSymbols(U),q=[];for(const se of Object.keys(Y).map(Number))q.push(K[se]);q.sort(Tt);for(const se of q){const re=se.featureIndex.lookupSymbolFeatures(Y[se.bucketInstanceId],N,se.bucketIndex,se.sourceLayerIndex,W.filter,W.layers,W.availableImages,I);for(const le in re){const ye=J[le]=J[le]||[],ge=re[le];ge.sort((we,Se)=>{const Fe=se.featureSortOrder;if(Fe){const Le=Fe.indexOf(we.featureIndex);return Fe.indexOf(Se.featureIndex)-Le}return Se.featureIndex-we.featureIndex});for(const we of ge)ye.push(we)}}for(const se in J)J[se].forEach(re=>{const le=re.feature,ye=L(I[se]);if(!ye)return;const ge=ye.getFeatureState(le.layer["source-layer"],le.id);le.source=le.layer.source,le.layer["source-layer"]&&(le.sourceLayer=le.layer["source-layer"]),le.state=ge});return J}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),T.screenGeometry,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(l,d){d&&d.filter&&this._validate(h.validateFilter,"querySourceFeatures.filter",d.filter,null,d);const _=this._getSourceCaches(l);let b=[];for(const w of _)b=b.concat(tt(w,d));return b}addSourceType(l,d,_){return wo.getSourceType(l)?_(new Error(`A source type called "${l}" already exists.`)):(wo.setSourceType(l,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:d.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(l,d={}){this._checkLoaded();const _=this.light.getLight();let b=!1;for(const M in l)if(!Ie(l[M],_[M])){b=!0;break}if(!b)return;const w=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,d),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,d=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=l;if(1===d){if("object"==typeof _.source){const b="terrain-dem-src";this.addSource(b,_.source),_=h.clone$1(_),_=h.extend(_,{source:b})}if(this._validate(h.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&d!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,d)}else{const b=this.terrain,w=b.get();for(const M of Object.keys(h.spec.terrain))!_.hasOwnProperty(M)&&h.spec.terrain[M].default&&(_[M]=h.spec.terrain[M].default);for(const M in _)if(!Ie(_[M],w[M])){b.set(_),this.stylesheet.terrain=_;const T=this._setTransitionParameters({duration:0});b.updateTransitions(T);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const d=this.fog=new _a(l,this.map.transform);this.stylesheet.fog=l;const _=this._setTransitionParameters({duration:0});d.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const d=this.fog,_=d.get();0===Object.keys(l).length&&d.set(l);for(const b in l)if(!Ie(l[b],_[b])){d.set(l),this.stylesheet.fog=l;const w=this._setTransitionParameters({duration:0});d.updateTransitions(w);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:h.exported.now(),transition:h.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter(_=>this.isLayerDraped(this._layers[_])),d=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...d)}_createTerrain(l,d){const _=this.terrain=new wr(l,d);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});_.updateTransitions(b)}_force3DLayerUpdate(){for(const l in this._layers){const d=this._layers[l];"fill-extrusion"===d.type&&this._updateLayer(d)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const d=this._layers[l];"symbol"===d.type&&this._updateLayer(d)}}_validate(l,d,_,b,w={}){return(!w||!1!==w.validate)&&jl(this,l.call(h.validateStyle,h.extend({key:d,style:this.serialize(),value:_,styleSpec:h.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const d=this._getSourceCaches(l);for(const _ of d)_.clearTiles()}_reloadSource(l){const d=this._getSourceCaches(l);for(const _ of d)_.resume(),_.reload()}_reloadSources(){for(const l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(const d in this._sourceCaches)this._sourceCaches[d].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const d=this._sourceCaches[l];d.resume(),d.reload()}}_updatePlacement(l,d,_,b,w=!1){let M=!1,T=!1;const I={};for(const N of this._order){const L=this._layers[N];if("symbol"!==L.type)continue;if(!I[L.source]){const W=this._getLayerSourceCache(L);if(!W)continue;I[L.source]=W.getRenderableIds(!0).map(X=>W.getTileByID(X)).sort((X,K)=>K.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(K.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(L,I[L.source],l.center.lng,l.projection);M=M||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new h.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.exported.now(),l.zoom))&&(this.pauseablePlacement=new bu(l,this._order,w,d,_,b,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.exported.now()),T=!0),M&&this.pauseablePlacement.placement.setStale()),T||M)for(const N of this._order){const L=this._layers[N];"symbol"===L.type&&this.placement.updateLayerOpacities(L,I[L.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,d,_){this.imageManager.getImages(d.icons,_),this._updateTilesForChangedImages();const b=w=>{w&&w.setDependencies(d.tileID.key,d.type,d.icons)};b(this._otherSourceCaches[d.source]),b(this._symbolSourceCaches[d.source])}getGlyphs(l,d,_){this.glyphManager.getGlyphs(d.stacks,_)}getResource(l,d,_){return h.makeRequest(d,_)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return"symbol"===l.type?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const d=[];return this._otherSourceCaches[l]&&d.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&d.push(this._symbolSourceCaches[l]),d}_isSourceCacheLoaded(l){const d=this._getSourceCaches(l);return 0===d.length?(this.fire(new h.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):d.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}wo.getSourceType=function(m){return Ae[m]},wo.setSourceType=function(m,l){Ae[m]=l},wo.registerForPluginStateChange=h.registerForPluginStateChange;var $l="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Gd="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",dn="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Hl="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",qd="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Co={},Ac={};const Gl=[];ws($l,Gl),ws(dn,Gl),ws(Hl,Gl),ws(qd,Gl),Co=ni("",dn),Ac=ni(qd,Hl);const Oi=ni("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),td=$l,nd="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Wd={background:ni("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ni("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ni("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ni("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ni("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ni("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ni("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ni("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ni("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ni("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ni("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ni("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ni("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ni("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ni("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ni("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ni("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ni("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ni("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ni("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ni("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ni("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ni("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ni("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ni("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ni("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Gd),skyboxGradient:ni("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Gd),skyboxCapture:ni("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ni("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ni("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ws(m,l){const d=m.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let _ of d)if(_=_.trim(),"#"===_[0]&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=_.split(" ");for(const w of b)l.includes(w)||l.push(w)}}function ni(m,l){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b={},w=[...Gl];return ws(m,w),ws(l,w),{fragmentSource:m=m.replace(d,(M,T,I,N,L)=>(b[L]=!0,"define"===T?`\n#ifndef HAS_UNIFORM_u_${L}\nvarying ${I} ${N} ${L};\n#else\nuniform ${I} ${N} u_${L};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${L}\n    ${I} ${N} ${L} = u_${L};\n#endif\n`)),vertexSource:l=l.replace(d,(M,T,I,N,L)=>{const U="float"===N?"vec2":"vec4",W=L.match(/color/)?"color":U;return b[L]?"define"===T?`\n#ifndef HAS_UNIFORM_u_${L}\nuniform lowp float u_${L}_t;\nattribute ${I} ${U} a_${L};\nvarying ${I} ${N} ${L};\n#else\nuniform ${I} ${N} u_${L};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${L}\n    ${L} = a_${L};\n#else\n    ${I} ${N} ${L} = u_${L};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${L}\n    ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);\n#else\n    ${I} ${N} ${L} = u_${L};\n#endif\n`:"define"===T?`\n#ifndef HAS_UNIFORM_u_${L}\nuniform lowp float u_${L}_t;\nattribute ${I} ${U} a_${L};\n#else\nuniform ${I} ${N} u_${L};\n#endif\n`:"vec4"===W?`\n#ifndef HAS_UNIFORM_u_${L}\n    ${I} ${N} ${L} = a_${L};\n#else\n    ${I} ${N} ${L} = u_${L};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${L}\n    ${I} ${N} ${L} = unpack_mix_${W}(a_${L}, u_${L}_t);\n#else\n    ${I} ${N} ${L} = u_${L};\n#endif\n`}),staticAttributes:_,usedDefines:w}}class Sa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,d,_,b,w,M,T){this.context=l;let I=this.boundPaintVertexBuffers.length!==b.length;for(let L=0;!I&&L<b.length;L++)this.boundPaintVertexBuffers[L]!==b[L]&&(I=!0);let N=this.boundDynamicVertexBuffers.length!==T.length;for(let L=0;!N&&L<T.length;L++)this.boundDynamicVertexBuffers[L]!==T[L]&&(N=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==_||I||N||this.boundIndexBuffer!==w||this.boundVertexOffset!==M)this.freshBind(d,_,b,w,M,T);else{l.bindVertexArrayOES.set(this.vao);for(const L of T)L&&L.bind();w&&w.dynamicDraw&&w.bind()}}freshBind(l,d,_,b,w,M){let T;const I=l.numAttributes,N=this.context,L=N.gl;if(N.extVertexArrayObject)this.vao&&this.destroy(),this.vao=N.extVertexArrayObject.createVertexArrayOES(),N.bindVertexArrayOES.set(this.vao),T=0,this.boundProgram=l,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=b,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=M;else{T=N.currentNumAttributes||0;for(let U=I;U<T;U++)L.disableVertexAttribArray(U)}d.enableAttributes(L,l),d.bind(),d.setVertexAttribPointers(L,l,w);for(const U of _)U.enableAttributes(L,l),U.bind(),U.setVertexAttribPointers(L,l,w);for(const U of M)U&&(U.enableAttributes(L,l),U.bind(),U.setVertexAttribPointers(L,l,w));b&&b.bind(),N.currentNumAttributes=I}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function id(m,l){const d=Math.pow(2,l.canonical.z),_=l.canonical.y;return[new h.MercatorCoordinate(0,_/d).toLngLat().lat,new h.MercatorCoordinate(0,(_+1)/d).toLngLat().lat]}function Ic(m,l,d,_,b,w,M){const T=m.context,I=T.gl,N=d.fbo;if(!N)return;m.prepareDrawTile();const L=m.useProgram("hillshade");T.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,N.colorAttachment.get());const U=((J,Y,q,se)=>{const re=q.paint.get("hillshade-shadow-color"),le=q.paint.get("hillshade-highlight-color"),ye=q.paint.get("hillshade-accent-color");let ge=q.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===q.paint.get("hillshade-illumination-anchor")&&(ge-=J.transform.angle);const we=!J.options.moving;return{u_matrix:se||J.transform.calculateProjMatrix(Y.tileID.toUnwrapped(),we),u_image:0,u_latrange:id(0,Y.tileID),u_light:[q.paint.get("hillshade-exaggeration"),ge],u_shadow:re,u_highlight:le,u_accent:ye}})(m,d,_,m.terrain?l.projMatrix:null);m.prepareDrawProgram(T,L,l.toUnwrapped());const{tileBoundsBuffer:W,tileBoundsIndexBuffer:X,tileBoundsSegments:K}=m.getTileBoundsBuffers(d);L.draw(T,I.TRIANGLES,b,w,M,h.CullFaceMode.disabled,U,_.id,W,X,K)}function ql(m,l,d){if(!l.needsDEMTextureUpload)return;const _=m.context,b=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(d.stride);const w=d.getPixels();l.demTexture?l.demTexture.update(w,{premultiply:!1}):l.demTexture=new h.Texture(_,w,b.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function cl(m,l,d,_,b,w){const M=m.context,T=M.gl;if(!l.dem)return;const I=l.dem;if(M.activeTexture.set(T.TEXTURE1),ql(m,l,I),!l.demTexture)return;l.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);const N=I.dim;M.activeTexture.set(T.TEXTURE0);let L=l.fbo;if(!L){const K=new h.Texture(M,{width:N,height:N,data:null},T.RGBA);K.bind(T.LINEAR,T.CLAMP_TO_EDGE),L=l.fbo=M.createFramebuffer(N,N,!0),L.colorAttachment.set(K.texture)}M.bindFramebuffer.set(L.framebuffer),M.viewport.set([0,0,N,N]);const{tileBoundsBuffer:U,tileBoundsIndexBuffer:W,tileBoundsSegments:X}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(M,T.TRIANGLES,_,b,w,h.CullFaceMode.disabled,((K,J)=>{const Y=J.stride,q=h.create();return h.ortho(q,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(q,q,[0,-h.EXTENT,0]),{u_matrix:q,u_image:1,u_dimension:[Y,Y],u_zoom:K.overscaledZ,u_unpack:J.unpackVector}})(l.tileID,I),d.id,U,W,X),l.needsHillshadePrepare=!1}const ta=m=>({u_matrix:new h.UniformMatrix4f(m),u_image0:new h.Uniform1i(m),u_skirt_height:new h.Uniform1f(m)}),Lo=(m,l)=>({u_matrix:m,u_image0:0,u_skirt_height:l}),xu=(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:d,u_zoom_transition:b,u_merc_center:w,u_image0:0,u_frustum_tl:M,u_frustum_tr:T,u_frustum_br:I,u_frustum_bl:N,u_globe_pos:L,u_globe_radius:U,u_viewport:W,u_grid_matrix:K?Float32Array.from(K):new Float32Array(9),u_skirt_height:X});function We(m,l){return null!=m&&null!=l&&!(!m.hasData()||!l.hasData())&&null!=m.demTexture&&null!=l.demTexture&&m.tileID.key!==l.tileID.key}const na=new class{constructor(){this.operations={}}newMorphing(m,l,d,_,b){if(m in this.operations){const w=this.operations[m];w.to.tileID.key!==d.tileID.key&&(w.queued=d)}else this.operations[m]={startTime:_,phase:0,duration:b,from:l,to:d,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(const l in this.operations){const d=this.operations[l];for(d.phase=(m-d.startTime)/d.duration;d.phase>=1||!this._validOp(d);)if(!this._nextOp(d,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},bn={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ul(m){return 6*Math.pow(1.5,22-m)}function kc(m,l){const d=1<<m.z;return!l&&(0===m.x||m.x===d-1)||0===m.y||m.y===d-1}const zn=m=>({u_matrix:m});function Pc(m,l,d,_,b){if(b>0){const w=h.exported.now(),M=(w-m.timeAdded)/b,T=l?(w-l.timeAdded)/b:-1,I=d.getSource(),N=_.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),L=!l||Math.abs(l.tileID.overscaledZ-N)>Math.abs(m.tileID.overscaledZ-N),U=L&&m.refreshedUponExpiration?1:h.clamp(L?M:1-T,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}class Zd extends h.SourceCache{constructor(l){const d={type:"raster-dem",maxzoom:l.transform.maxZoom},_=new Fs(Ut(),null),b=Te("mock-dem",d,_,l.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,d){l.state="loaded",d(null)}}class wu extends h.SourceCache{constructor(l){const d=Te("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new Fs(Ut(),null),l.style);super("proxy",d,!1),d.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,d,_){if(l.freezeTileCoverage)return;this.transform=l;const b=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,M)=>{if(w[M.key]="",!this._tiles[M.key]){const T=new h.Tile(M,this._source.tileSize*M.overscaleFactor(),l.tileZoom);T.state="loaded",this._tiles[M.key]=T}return w},{});for(const w in this._tiles)w in b||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(l){const d=this.proxyCachedFBO[l];if(void 0!==d){const _=Object.values(d);this.renderCachePool.push(..._),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ts extends h.OverscaledTileID{constructor(l,d,_){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=d,this.projMatrix=_}}class ns extends h.Elevation{constructor(l,d){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,b,w]=function(I){const N=new h.StructArrayLayout2i4,L=new h.StructArrayLayout3ui6,U=131;N.reserve(17161),L.reserve(33800);const W=h.EXTENT/128,X=h.EXTENT+W/2,K=X+W;for(let Y=-W;Y<K;Y+=W)for(let q=-W;q<K;q+=W){const se=q<0||q>X||Y<0||Y>X?24575:0,re=h.clamp(Math.round(q),0,h.EXTENT),le=h.clamp(Math.round(Y),0,h.EXTENT);N.emplaceBack(re+se,le)}const J=(Y,q)=>{const se=q*U+Y;L.emplaceBack(se+1,se,se+U),L.emplaceBack(se+U,se+U+1,se+1)};for(let Y=1;Y<129;Y++)for(let q=1;q<129;q++)J(q,Y);return[0,129].forEach(Y=>{for(let q=0;q<130;q++)J(q,Y),J(Y,q)}),[N,L,32768]}(),M=l.context;this.gridBuffer=M.createVertexBuffer(_,h.posAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(b),this.gridSegments=h.SegmentVector.simpleSegment(0,0,_.length,b.length),this.gridNoSkirtSegments=h.SegmentVector.simpleSegment(0,0,_.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new wu(d.map),this.orthoMatrix=h.create(),h.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,h.EXTENT,0,h.EXTENT,0,1);const T=M.gl;this._overlapStencilMode=new h.StencilMode({func:T.GEQUAL,mask:255},0,255,T.KEEP,T.KEEP,T.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=d,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Zd(d.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,d,_){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const b=l.terrain.properties;this.sourceCache=0===l.terrain.drapeRenderMode?this._mockSourceCache:l._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const w=()=>{this.sourceCache.used&&h.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(d,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),d.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(d),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==l.efficiency&&h.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&"source"===l.dataType?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):"style"===l.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const d=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=d.getIds().map(I=>{const N=d.getTileByID(I).tileID;return N.projMatrix=_.calculateProjMatrix(N.toUnwrapped()),N});(function(I,N){const L=N.transform.pointCoordinate(N.transform.getCameraPoint()),U=new h.pointGeometry(L.x,L.y);I.sort((W,X)=>{if(X.overscaledZ-W.overscaledZ)return X.overscaledZ-W.overscaledZ;const K=new h.pointGeometry(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),J=new h.pointGeometry(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),Y=U.mult(1<<W.canonical.z);return Y.x-=.5,Y.y-=.5,Y.distSqr(K)-Y.distSqr(J)})})(b,this.painter),this._previousZoom=_.zoom;const w=this.proxyToSource||{};this.proxyToSource={},b.forEach(I=>{this.proxyToSource[I.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const I in M){const N=M[I];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,l[I],w),N.usedForTerrain))continue;const L=l[I];N.getSource().reparseOverscaled&&this._assignTerrainTiles(L)}this.proxiedCoords[d.id]=b.map(I=>new ts(I,I.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=h.exported.now();const T={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const N=this.terrainTileForTile[I.key];if(!N)continue;const L=N.tileID.key;L in T||(this._visibleDemTiles.push(N),T[L]=L)}}_assignTerrainTiles(l){this._initializing||l.forEach(d=>{if(this.terrainTileForTile[d.key])return;const _=this._findTileCoveringTileID(d,this.sourceCache);_&&(this.terrainTileForTile[d.key]=_)})}_prepareDEMTextures(){const l=this.painter.context,d=l.gl;for(const _ in this.terrainTileForTile){const b=this.terrainTileForTile[_],w=b.dem;!w||b.demTexture&&!b.needsDEMTextureUpload||(l.activeTexture.set(d.TEXTURE1),ql(this.painter,b,w))}}_prepareDemTileUniforms(l,d,_,b){if(!d||null==d.demTexture)return!1;const w=l.tileID.canonical,M=Math.pow(2,d.tileID.canonical.z-w.z),T=b||"";return _[`u_dem_tl${T}`]=[w.x*M%1,w.y*M%1],_[`u_dem_scale${T}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,d=l.gl;if(!this._emptyDepthBufferTexture){const _=new h.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new h.Texture(l,_,d.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const d=this._visibleDemTiles.reduce((_,b)=>{if(!b.dem)return _;const w=b.dem.tree.minimums[0];return w>0&&l++,_+w},0);return l?d/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,d=l.gl;l.activeTexture.set(d.TEXTURE2);const _=this._getLoadedAreaMinimum(),b=new h.RGBAImage({width:1,height:1},new Uint8Array(h.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(b,{premultiply:!1}):w=this._emptyDEMTexture=new h.Texture(l,b,d.RGBA,{premultiply:!1}),w}setupElevationDraw(l,d,_){const b=this.painter.context,w=b.gl,M=(T=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:h.DEMData.getUnpackVector(T),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var T;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let I=null,N=null,L=1;if(_&&_.morphing&&this._useVertexMorphing){const U=_.morphing.srcDemTile,W=_.morphing.dstDemTile;L=_.morphing.phase,U&&W&&(this._prepareDemTileUniforms(l,U,M,"_prev")&&(N=U),this._prepareDemTileUniforms(l,W,M)&&(I=W))}if(N&&I?(b.activeTexture.set(w.TEXTURE2),I.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),b.activeTexture.set(w.TEXTURE4),N.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),M.u_dem_lerp=L):(I=this.terrainTileForTile[l.tileID.key],b.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(l,I,M)?I.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),b.activeTexture.set(w.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&I){const U=(1<<I.tileID.canonical.z)*h.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=U}if(_&&_.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),d.setTerrainUniformValues(b,M),"globe"===this.painter.transform.projection.name){const U=this.globeUniformValues(this.painter.transform,l.tileID.canonical,_&&_.useDenormalizedUpVectorScale);d.setGlobeUniformValues(b,U)}}globeUniformValues(l,d,_){const b=l.projection;return{u_tile_tl_up:b.upVector(d,0,0),u_tile_tr_up:b.upVector(d,h.EXTENT,0),u_tile_br_up:b.upVector(d,h.EXTENT,h.EXTENT),u_tile_bl_up:b.upVector(d,0,h.EXTENT),u_tile_up_scale:_?h.globeMetersToEcef(1):b.upVectorScale(d,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const d=this.painter,_=this.painter.context;0!==l.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),d.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,w,M,T,I){if("globe"===b.transform.projection.name)!function(N,L,U,W,X){const K=N.context,J=K.gl;let Y,q;const se=N.options.showTerrainWireframe?2:0,re=N.transform,le=h.globeUseCustomAntiAliasing(N,K,re),ye=(ct,Ne)=>{if(q===ct)return;const Me=[bn[ct],"PROJECTION_GLOBE_VIEW"];le&&Me.push("CUSTOM_ANTIALIASING"),Ne&&Me.push(bn[se]),Y=N.useProgram("globeRaster",null,Me),q=ct},ge=N.colorModeForRenderPass(),we=new h.DepthMode(J.LEQUAL,h.DepthMode.ReadWrite,N.depthRangeFor3D);na.update(X);const Se=h.calculateGlobeMercatorMatrix(re),Fe=[h.mercatorXfromLng(re.center.lng),h.mercatorYfromLat(re.center.lat)],Le=se?[!1,!0]:[!1],mt=N.globeSharedBuffers,ke=[re.width*h.exported.devicePixelRatio,re.height*h.exported.devicePixelRatio],Ke=Float32Array.from(re.globeMatrix),je={useDenormalizedUpVectorScale:!0};if(Le.forEach(ct=>{const Ne=N.transform,Me=ul(Ne.zoom)*L.exaggeration();q=-1;const Ve=ct?J.LINES:J.TRIANGLES;for(const st of W){const ut=U.getTile(st),qt=h.StencilMode.disabled,Fn=L.prevTerrainTileForTile[st.key],Rt=L.terrainTileForTile[st.key];We(Fn,Rt)&&na.newMorphing(st.key,Fn,Rt,X,250),K.activeTexture.set(J.TEXTURE0),ut.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const At=na.getMorphValuesForProxy(st.key),Wt=At?1:0;At&&h.extend$1(je,{morphing:{srcDemTile:At.from,dstDemTile:At.to,phase:h.easeCubicInOut(At.phase)}});const kn=h.tileCornersToBounds(st.canonical),Kt=h.getLatitudinalLod(kn.getCenter().lat),gi=h.getGridMatrix(st.canonical,kn,Kt,Ne.worldSize/Ne._pixelsPerMercatorPixel),di=h.globeNormalizeECEF(h.globeTileBounds(st.canonical)),$i=xu(Ne.projMatrix,Ke,Se,di,h.globeToMercatorTransition(Ne.zoom),Fe,Ne.frustumCorners.TL,Ne.frustumCorners.TR,Ne.frustumCorners.BR,Ne.frustumCorners.BL,Ne.globeCenterInViewSpace,Ne.globeRadius,ke,Me,gi);if(ye(Wt,ct),L.setupElevationDraw(ut,Y,je),N.prepareDrawProgram(K,Y,st.toUnwrapped()),mt){const[Di,dr,ho]=ct?mt.getWirefameBuffers(N.context,Kt):mt.getGridBuffers(Kt,0!==Me);Y.draw(K,Ve,we,qt,ge,h.CullFaceMode.backCCW,$i,"globe_raster",Di,dr,ho)}}}),mt){const ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];le&&ct.push("CUSTOM_ANTIALIASING"),Y=N.useProgram("globeRaster",null,ct);for(const Ne of W){const{x:Me,y:Ve,z:st}=Ne.canonical,ut=0===Ve,qt=Ve===(1<<st)-1,[Fn,Rt,At,Wt]=mt.getPoleBuffers(st);if(Wt&&(ut||qt)){const kn=U.getTile(Ne);K.activeTexture.set(J.TEXTURE0),kn.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);let Kt=h.globePoleMatrixForTile(st,Me,re);const gi=h.globeNormalizeECEF(h.globeTileBounds(Ne.canonical)),di=($i,Di)=>$i.draw(K,J.TRIANGLES,we,h.StencilMode.disabled,ge,h.CullFaceMode.disabled,xu(re.projMatrix,Kt,Kt,gi,0,Fe,re.frustumCorners.TL,re.frustumCorners.TR,re.frustumCorners.BR,re.frustumCorners.BL,re.globeCenterInViewSpace,re.globeRadius,ke,0),"globe_pole_raster",Di,At,Wt);L.setupElevationDraw(kn,Y,je),N.prepareDrawProgram(K,Y,Ne.toUnwrapped()),ut&&di(Y,Fn),qt&&(Kt=h.scale(h.create(),Kt,[1,-1,1]),di(Y,Rt))}}}}(b,w,M,T,I);else{const N=b.context,L=N.gl;let U,W;const X=b.options.showTerrainWireframe?2:0,K=(re,le)=>{if(W===re)return;const ye=[bn[re]];le&&ye.push(bn[X]),U=b.useProgram("terrainRaster",null,ye),W=re},J=b.colorModeForRenderPass(),Y=new h.DepthMode(L.LEQUAL,h.DepthMode.ReadWrite,b.depthRangeFor3D);na.update(I);const q=b.transform,se=ul(q.zoom)*w.exaggeration();(X?[!1,!0]:[!1]).forEach(re=>{W=-1;const le=re?L.LINES:L.TRIANGLES,[ye,ge]=re?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const we of T){const Se=M.getTile(we),Fe=h.StencilMode.disabled,Le=w.prevTerrainTileForTile[we.key],mt=w.terrainTileForTile[we.key];We(Le,mt)&&na.newMorphing(we.key,Le,mt,I,250),N.activeTexture.set(L.TEXTURE0),Se.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE,L.LINEAR_MIPMAP_NEAREST);const ke=na.getMorphValuesForProxy(we.key),Ke=ke?1:0;let je;ke&&(je={morphing:{srcDemTile:ke.from,dstDemTile:ke.to,phase:h.easeCubicInOut(ke.phase)}});const ct=Lo(we.projMatrix,kc(we.canonical,q.renderWorldCopies)?se/10:se);K(Ke,re),w.setupElevationDraw(Se,U,je),b.prepareDrawProgram(N,U,we.toUnwrapped()),U.draw(N,le,Y,Fe,J,h.CullFaceMode.backCCW,ct,"terrain_raster",w.gridBuffer,ye,ge)}})}}(d,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,d.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(0===this._drapedRenderBatches.length)return l+1;this.renderingToTexture=!0;const d=this.painter,_=this.painter.context,b=this.proxySourceCache,w=this.proxiedCoords[b.id],M=this._drapedRenderBatches.shift(),T=[],I=d.style.order;let N=0;for(const L of w){const U=b.getTileByID(L.proxyTileKey),W=b.proxyCachedFBO[L.key]?b.proxyCachedFBO[L.key][l]:void 0,X=void 0!==W?b.renderCache[W]:this.pool[N++],K=void 0!==W;if(U.texture=X.tex,K&&!X.dirty){T.push(U.tileID);continue}let J;_.bindFramebuffer.set(X.fb.framebuffer),this.renderedToTile=!1,X.dirty&&(_.clear({color:h.Color.transparent,stencil:0}),X.dirty=!1);for(let Y=M.start;Y<=M.end;++Y){const q=d.style._layers[I[Y]];if(q.isHidden(d.transform.zoom))continue;const se=d.style._getLayerSourceCache(q),re=se?this.proxyToSource[L.key][se.id]:[L];if(!re)continue;const le=re;_.viewport.set([0,0,X.fb.width,X.fb.height]),J!==(se?se.id:null)&&(this._setupStencil(X,re,q,se),J=se?se.id:null),d.renderLayer(d,se,q,le)}this.renderedToTile?(X.dirty=!0,T.push(U.tileID)):K||--N,5===N&&(N=0,this.renderToBackBuffer(T))}return this.renderToBackBuffer(T),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,d.width,d.height]),M.end+1}postRender(){}renderCacheEfficiency(l){const d=l.order.length;if(0===d)return{efficiency:100};let _,b=0,w=0,M=!1;for(let T=0;T<d;++T){const I=l._layers[l.order[T]];this._style.isLayerDraped(I)?(M&&++b,++w):M||(M=!0,_=I.id)}return 0===w?{efficiency:100}:{efficiency:100*(1-b/w),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(d=>d.dem).forEach(d=>{l=Math.min(l,d.dem.tree.minimums[0])}),0===l?l:(l-30)*this._exaggeration}raycast(l,d,_){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const M=w.tileID,T=1<<M.overscaledZ,{x:I,y:N}=M.canonical,L=I/T,U=(I+1)/T,W=N/T,X=(N+1)/T;return{minx:L,miny:W,maxx:U,maxy:X,t:w.dem.tree.raycastRoot(L,W,U,X,l,d,_),tile:w}});b.sort((w,M)=>(null!==w.t?w.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const w of b){if(null==w.t)return null;const M=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,l,d,_);if(null!=M)return M}return null}_createFBO(){const l=this.painter.context,d=l.gl,_=this.drapeBufferSize;l.activeTexture.set(d.TEXTURE0);const b=new h.Texture(l,{width:_[0],height:_[1],data:null},d.RGBA);b.bind(d.LINEAR,d.CLAMP_TO_EDGE);const w=l.createFramebuffer(_[0],_[1],!1);return w.colorAttachment.set(b.texture),w.depthAttachment=new Dc(l,w.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&d.texParameterf(d.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:w,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const d=this._style._layers[l],_=d.isHidden(this.painter.transform.zoom);return"custom"===d.type?!_&&d.shouldRedrape():!_&&d.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const _ of this._style._getSources())if(_ instanceof j){l=!0;break}if(!l)return;const d={};for(let _=0;_<this._style.order.length;++_){const b=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(b);if(w&&!d[w.id]&&!b.isHidden(this.painter.transform.zoom)&&"line"===b.type&&b.widthExpression()instanceof h.ZoomDependentExpression){d[w.id]=!0;for(const M of this.proxyCoords){const T=this.proxyToSource[M.key][w.id];if(T)for(const I of T)this._clearRenderCacheForTile(w.id,I)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof H){l=!0;break}if(!l)return;const d={};for(let _=0;_<this._style.order.length;++_){const b=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(b);if(!w||d[w.id]||b.isHidden(this.painter.transform.zoom)||"raster"!==b.type)continue;const M=b.paint.get("raster-fade-duration");for(const T of this.proxyCoords){const I=this.proxyToSource[T.key][w.id];if(I)for(const N of I){const L=Pc(w.getTile(N),w.findLoadedParent(N,0),w,this.painter.transform,M);(1!==L.opacity||0!==L.mix)&&this._clearRenderCacheForTile(w.id,N)}}}}_setupDrapedRenderBatches(){const l=this._style.order,d=l.length;if(0===d)return;const _=[];let b,w=0,M=this._style._layers[l[w]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++w<d;)M=this._style._layers[l[w]];for(;w<d;++w){const T=this._style._layers[l[w]];T.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(T)?void 0===b&&(b=w):void 0!==b&&(_.push({start:b,end:w-1}),b=void 0))}void 0!==b&&_.push({start:b,end:w-1}),this._drapedRenderBatches=_}_setupRenderCache(l){const d=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,d.renderCache.length>d.renderCachePool.length){const M=Object.values(d.proxyCachedFBO);d.proxyCachedFBO={};for(let T=0;T<M.length;++T){const I=Object.values(M[T]);d.renderCachePool.push(...I)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,b=this._tilesDirty;for(let M=_.length-1;M>=0;M--){const T=_[M];if(d.getTileByID(T.key),void 0!==d.proxyCachedFBO[T.key]){const I=l[T.key],N=this.proxyToSource[T.key];let L=0;for(const U in N){const W=N[U],X=I[U];if(!X||X.length!==W.length||W.some((K,J)=>K!==X[J]||b[U]&&b[U].hasOwnProperty(K.key))){L=-1;break}++L}for(const U in d.proxyCachedFBO[T.key])d.renderCache[d.proxyCachedFBO[T.key][U]].dirty=L<0||L!==Object.values(I).length}}const w=[...this._drapedRenderBatches];w.sort((M,T)=>T.end-T.start-(M.end-M.start));for(const M of w)for(const T of _){if(d.proxyCachedFBO[T.key])continue;let I=d.renderCachePool.pop();void 0===I&&d.renderCache.length<50&&(I=d.renderCache.length,d.renderCache.push(this._createFBO())),void 0!==I&&(d.proxyCachedFBO[T.key]={},d.proxyCachedFBO[T.key][M.start]=I,d.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(l,d,_,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,M=w.gl;if(d.length<=1)return void(this._overlapStencilType=!1);let T;if(_.isTileClipped())T=d.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(d[0].overscaledZ>d[d.length-1].overscaledZ))return void(this._overlapStencilType=!1);T=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+T>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=T,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(d,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):h.StencilMode.disabled}_renderTileClippingMasks(l,d){const _=this.painter,b=this.painter.context,w=b.gl;_._tileClippingMaskIDs={},b.setColorMode(h.ColorMode.disabled),b.setDepthMode(h.DepthMode.disabled);const M=_.useProgram("clippingMask");for(const T of l){const I=_._tileClippingMaskIDs[T.key]=--d;M.draw(b,w.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:w.ALWAYS,mask:0},I,255,w.KEEP,w.KEEP,w.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,zn(T.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(l){const d=this.painter.transform;if(l.x<0||l.x>d.width||l.y<0||l.y>d.height)return null;const _=[l.x,l.y,1,1];h.transformMat4$1(_,_,d.pixelMatrixInverse),h.scale$1(_,_,1/_[3]),_[0]/=d.worldSize,_[1]/=d.worldSize;const b=d._camera.position,w=h.mercatorZfromAltitude(1,d.center.lat),M=[b[0],b[1],b[2]/w,0],T=h.subtract([],_.slice(0,3),M);h.normalize(T,T);const I=this.raycast(M,T,this._exaggeration);return null!==I&&I?(h.scaleAndAdd(M,M,T,I),M[3]=M[2],M[2]*=w,M):null}drawDepth(){const l=this.painter,d=l.context,_=this.proxySourceCache,b=Math.ceil(l.width),w=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=d.gl,T=d.createFramebuffer(b,w,!0);d.activeTexture.set(M.TEXTURE0);const I=new h.Texture(d,{width:b,height:w,data:null},M.RGBA);I.bind(M.NEAREST,M.CLAMP_TO_EDGE),T.colorAttachment.set(I.texture);const N=d.createRenderbuffer(d.gl.DEPTH_COMPONENT16,b,w);T.depthAttachment.set(N),this._depthFBO=T,this._depthTexture=I}d.bindFramebuffer.set(this._depthFBO.framebuffer),d.viewport.set([0,0,b,w]),function(M,T,I,N){if("globe"===M.transform.projection.name)return;const L=M.context,U=L.gl;L.clear({depth:1});const W=M.useProgram("terrainDepth"),X=new h.DepthMode(U.LESS,h.DepthMode.ReadWrite,M.depthRangeFor3D);for(const K of N){const J=I.getTile(K),Y=Lo(K.projMatrix,0);T.setupElevationDraw(J,W),W.draw(L,U.TRIANGLES,X,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.backCCW,Y,"terrain_depth",T.gridBuffer,T.gridIndexBuffer,T.gridNoSkirtSegments)}}(l,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,d,_){if(l.getSource()instanceof be)return this._setupProxiedCoordsForImageSource(l,d,_);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const b=this.proxiedCoords[l.id]=[],w=this.proxyCoords;for(let T=0;T<w.length;T++){const I=w[T],N=this._findTileCoveringTileID(I,l);if(N){const L=this._createProxiedId(I,N,_[I.key]&&_[I.key][l.id]);b.push(L),this.proxyToSource[I.key][l.id]=[L]}}let M=!1;for(let T=0;T<d.length;T++){const I=l.getTile(d[T]);if(!I||!I.hasData())continue;const N=this._findTileCoveringTileID(I.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==I.tileID.canonical.z){const L=this.proxyToSource[N.tileID.key][l.id],U=this._createProxiedId(N.tileID,I,_[N.tileID.key]&&_[N.tileID.key][l.id]);L?L.splice(L.length-1,0,U):this.proxyToSource[N.tileID.key][l.id]=[U],b.push(U),M=!0}}this._sourceTilesOverlap[l.id]=M}_setupProxiedCoordsForImageSource(l,d,_){if(!l.getSource().loaded())return;const b=this.proxiedCoords[l.id]=[],w=this.proxyCoords,M=l.getSource(),T=new h.pointGeometry(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),I=M.coordinates.map(h.MercatorCoordinate.fromLngLat).reduce((L,U)=>(L.min.x=Math.min(L.min.x,U.x-T.x),L.min.y=Math.min(L.min.y,U.y-T.y),L.max.x=Math.max(L.max.x,U.x-T.x),L.max.y=Math.max(L.max.y,U.y-T.y),L),{min:new h.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new h.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(L,U)=>{const W=L.wrap+L.canonical.x/(1<<L.canonical.z),X=L.canonical.y/(1<<L.canonical.z),K=h.EXTENT/(1<<L.canonical.z),J=U.wrap+U.canonical.x/(1<<U.canonical.z),Y=U.canonical.y/(1<<U.canonical.z);return W+K<J+I.min.x||W>J+I.max.x||X+K<Y+I.min.y||X>Y+I.max.y};for(let L=0;L<w.length;L++){const U=w[L];for(let W=0;W<d.length;W++){const X=l.getTile(d[W]);if(!X||!X.hasData()||N(U,X.tileID))continue;const K=this._createProxiedId(U,X,_[U.key]&&_[U.key][l.id]),J=this.proxyToSource[U.key][l.id];J?J.push(K):this.proxyToSource[U.key][l.id]=[K],b.push(K)}}}_createProxiedId(l,d,_){let b=this.orthoMatrix;if(_){const w=_.find(M=>M.key===d.tileID.key);if(w)return w}if(d.tileID.key!==l.key){const w=l.canonical.z-d.tileID.canonical.z;let M,T,I;b=h.create();const N=d.tileID.wrap-l.wrap<<l.overscaledZ;w>0?(M=h.EXTENT>>w,T=M*((d.tileID.canonical.x<<w)-l.canonical.x+N),I=M*((d.tileID.canonical.y<<w)-l.canonical.y)):(M=h.EXTENT<<-w,T=h.EXTENT*(d.tileID.canonical.x-(l.canonical.x+N<<-w)),I=h.EXTENT*(d.tileID.canonical.y-(l.canonical.y<<-w))),h.ortho(b,0,M,0,M,0,1),h.translate(b,b,[T,I,0])}return new ts(d.tileID,l.key,b)}_findTileCoveringTileID(l,d){let _=d.getTile(l);if(_&&_.hasData())return _;const b=this._findCoveringTileCache[d.id],w=b[l.key];if(_=w?d.getTileByID(w):null,_&&_.hasData()||null===w)return _;let M=_?_.tileID:l,T=M.overscaledZ;const I=d.getSource().minzoom,N=[];if(!w){const U=d.getSource().maxzoom;if(l.canonical.z>=U){const W=l.canonical.z-U;d.getSource().reparseOverscaled?(T=Math.max(l.canonical.z+2,d.transform.tileZoom),M=new h.OverscaledTileID(T,l.wrap,U,l.canonical.x>>W,l.canonical.y>>W)):0!==W&&(T=U,M=new h.OverscaledTileID(T,l.wrap,U,l.canonical.x>>W,l.canonical.y>>W))}M.key!==l.key&&(N.push(M.key),_=d.getTile(M))}const L=U=>{N.forEach(W=>{b[W]=U}),N.length=0};for(T-=1;T>=I&&(!_||!_.hasData());T--){_&&L(_.tileID.key);const U=M.calculateScaledKey(T);if(_=d.getTileByID(U),_&&_.hasData())break;const W=b[U];if(null===W)break;void 0===W?N.push(U):_=d.getTileByID(W)}return L(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,d){let _=this._tilesDirty[l];_||(_=this._tilesDirty[l]={}),_[d.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=function(d){let _=0;const b=new h.StructArrayLayout2ui4,w=131;for(let M=1;M<129;M++){for(let T=1;T<129;T++)_=M*w+T,b.emplaceBack(_,_+1),b.emplaceBack(_,_+w),b.emplaceBack(_+1,_+w),128===M&&b.emplaceBack(_+w,_+w+1);b.emplaceBack(_+1,_+1+w)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=h.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class No{static cacheKey(l,d,_,b){let w=`${d}${b?b.cacheKey:""}`;for(const M of _)l.usedDefines.includes(M)&&(w+=`/${M}`);return w}constructor(l,d,_,b,w,M){const T=l.gl;this.program=T.createProgram();const I=function(q){const se=[];for(let re=0;re<q.length;re++){if(null===q[re])continue;const le=q[re].split(" ");se.push(le.pop())}return se}(_.staticAttributes),N=b?b.getBinderAttributes():[],L=I.concat(N);let U=b?b.defines():[];U=U.concat(M.map(q=>`#define ${q}`));const W=l.isWebGL2?"#version 300 es\n":"",X=W+U.concat(l.extStandardDerivatives&&0===W.length?"#extension GL_OES_standard_derivatives : enable\n".concat(nd):nd,nd,td,Oi.fragmentSource,Ac.fragmentSource,_.fragmentSource).join("\n"),K=W+U.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",td,Oi.vertexSource,Ac.vertexSource,Co.vertexSource,_.vertexSource).join("\n"),J=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);T.shaderSource(J,X),T.compileShader(J),T.attachShader(this.program,J);const Y=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())this.failedToCreate=!0;else{T.shaderSource(Y,K),T.compileShader(Y),T.attachShader(this.program,Y),this.attributes={},this.numAttributes=L.length;for(let q=0;q<this.numAttributes;q++)L[q]&&(T.bindAttribLocation(this.program,q,L[q]),this.attributes[L[q]]=q);T.linkProgram(this.program),T.deleteShader(Y),T.deleteShader(J),this.fixedUniforms=w(l),this.binderUniforms=b?b.getUniforms(l):[],M.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new h.Uniform1i(q=l),u_dem_prev:new h.Uniform1i(q),u_dem_unpack:new h.Uniform4f(q),u_dem_tl:new h.Uniform2f(q),u_dem_scale:new h.Uniform1f(q),u_dem_tl_prev:new h.Uniform2f(q),u_dem_scale_prev:new h.Uniform1f(q),u_dem_size:new h.Uniform1f(q),u_dem_lerp:new h.Uniform1f(q),u_exaggeration:new h.Uniform1f(q),u_depth:new h.Uniform1i(q),u_depth_size_inv:new h.Uniform2f(q),u_meter_to_dem:new h.Uniform1f(q),u_label_plane_matrix_inv:new h.UniformMatrix4f(q)}),M.includes("GLOBE")&&(this.globeUniforms=(q=>({u_tile_tl_up:new h.Uniform3f(q),u_tile_tr_up:new h.Uniform3f(q),u_tile_br_up:new h.Uniform3f(q),u_tile_bl_up:new h.Uniform3f(q),u_tile_up_scale:new h.Uniform1f(q)}))(l)),M.includes("FOG")&&(this.fogUniforms=(q=>({u_fog_matrix:new h.UniformMatrix4f(q),u_fog_range:new h.Uniform2f(q),u_fog_color:new h.Uniform4f(q),u_fog_horizon_blend:new h.Uniform1f(q),u_fog_temporal_offset:new h.Uniform1f(q),u_frustum_tl:new h.Uniform3f(q),u_frustum_tr:new h.Uniform3f(q),u_frustum_br:new h.Uniform3f(q),u_frustum_bl:new h.Uniform3f(q),u_globe_pos:new h.Uniform3f(q),u_globe_radius:new h.Uniform1f(q),u_globe_transition:new h.Uniform1f(q),u_is_globe:new h.Uniform1i(q),u_viewport:new h.Uniform2f(q)}))(l))}var q}setTerrainUniformValues(l,d){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in d)_[b]&&_[b].set(this.program,b,d[b])}}setGlobeUniformValues(l,d){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in d)_[b]&&_[b].set(this.program,b,d[b])}}setFogUniformValues(l,d){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const b in d)_[b].set(this.program,b,d[b])}}draw(l,d,_,b,w,M,T,I,N,L,U,W,X,K,J){const Y=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(_),l.setStencilMode(b),l.setColorMode(w),l.setCullFace(M);for(const se of Object.keys(this.fixedUniforms))this.fixedUniforms[se].set(this.program,se,T[se]);K&&K.setUniforms(this.program,l,this.binderUniforms,W,{zoom:X});const q={[Y.LINES]:2,[Y.TRIANGLES]:3,[Y.LINE_STRIP]:1}[d];for(const se of U.get()){const re=se.vaos||(se.vaos={});(re[I]||(re[I]=new Sa)).bind(l,this,N,K?K.getPaintVertexBuffers():[],L,se.vertexOffset,J||[]),Y.drawElements(d,se.primitiveLength*q,Y.UNSIGNED_SHORT,se.primitiveOffset*q*2)}}}function Us(m,l){const d=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,m.transform.tileZoom)/d,b=_*(l.tileID.canonical.x+l.tileID.wrap*d),w=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/Yo(l,1,m.transform.tileZoom),u_pixel_coord_upper:[b>>16,w>>16],u_pixel_coord_lower:[65535&b,65535&w]}}const xi=h.create(),dl=(m,l,d,_,b,w,M,T,I,N,L)=>{const U=l.style.light,W=U.properties.get("position"),X=[W.x,W.y,W.z],K=h.create$1();"viewport"===U.properties.get("anchor")&&(h.fromRotation(K,-l.transform.angle),h.transformMat3(X,X,K));const J=U.properties.get("color"),Y=l.transform,q={u_matrix:m,u_lightpos:X,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+d,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xi,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:w};return"globe"===Y.projection.name&&(q.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],q.u_zoom_transition=I,q.u_inv_rot_matrix=L,q.u_merc_center=N,q.u_up_dir=Y.projection.upVector(new h.CanonicalTileID(0,0,0),N[0]*h.EXTENT,N[1]*h.EXTENT),q.u_height_lift=T),q},hl=(m,l,d,_,b,w,M,T,I,N,L,U)=>{const W=dl(m,l,d,_,b,w,M,I,N,L,U),X={u_height_factor:-Math.pow(2,M.overscaledZ)/T.tileSize/8};return h.extend(W,Us(l,T),X)},pl=m=>({u_matrix:m}),Wl=(m,l,d)=>h.extend(pl(m),Us(l,d)),is=(m,l)=>({u_matrix:m,u_world:l}),Zl=(m,l,d,_)=>h.extend(Wl(m,l,d),{u_world:_}),lp=h.create(),mi=(m,l,d,_,b,w)=>{const M=m.transform,T="globe"===M.projection.name;let I;if("map"===w.paint.get("circle-pitch-alignment"))if(T){const L=h.globePixelsToTileUnits(M.zoom,l.canonical)*M._pixelsPerMercatorPixel;I=Float32Array.from([L,0,0,L])}else I=M.calculatePixelsToTileUnitsMatrix(d);else I=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const N={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:m.translatePosMatrix(l.projMatrix,d,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:h.exported.devicePixelRatio,u_extrude_scale:I,u_inv_rot_matrix:lp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(T){N.u_inv_rot_matrix=_,N.u_merc_center=b,N.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],N.u_zoom_transition=h.globeToMercatorTransition(M.zoom);const L=b[0]*h.EXTENT,U=b[1]*h.EXTENT;N.u_up_dir=M.projection.upVector(new h.CanonicalTileID(0,0,0),L,U)}return N},Ta=m=>{const l=[];return"map"===m.paint.get("circle-pitch-alignment")&&l.push("PITCH_WITH_MAP"),"map"===m.paint.get("circle-pitch-scale")&&l.push("SCALE_WITH_MAP"),l},Yd=(m,l,d,_)=>{const b=h.EXTENT/d.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(_),u_extrude_scale:[l.pixelsToGLUnits[0]/b,l.pixelsToGLUnits[1]/b]}},Rc=(m,l,d=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:d}),ii=h.create(),js=(m,l,d,_,b,w,M)=>{const T=m.transform,I="globe"===T.projection.name,N=I?h.globePixelsToTileUnits(T.zoom,l.canonical)*T._pixelsPerMercatorPixel:Yo(d,1,w),L={u_matrix:l.projMatrix,u_extrude_scale:N,u_intensity:M,u_inv_rot_matrix:ii,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){L.u_inv_rot_matrix=_,L.u_merc_center=b,L.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],L.u_zoom_transition=h.globeToMercatorTransition(T.zoom);const U=b[0]*h.EXTENT,W=b[1]*h.EXTENT;L.u_up_dir=T.projection.upVector(new h.CanonicalTileID(0,0,0),U,W)}return L},Fc=(m,l,d,_,b,w,M)=>{const T=m.transform,I=T.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:wi(m,l,d,_),u_pixels_to_tile_units:I,u_device_pixel_ratio:w,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:Dr(d)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ir(l,m.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},Vt=(m,l,d,_,b)=>{const w=m.transform;return{u_matrix:wi(m,l,d,_),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:w.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:b,u_image:0,u_tile_units_to_pixels:Ir(l,w),u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ir(m,l){return 1/Yo(m,1,l.tileZoom)}function wi(m,l,d,_){return m.translatePosMatrix(_||l.tileID.projMatrix,l,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}function Dr(m){const l=m.paint.get("line-dasharray").value;return l.value||"constant"!==l.kind}const ao=(m,l,d,_,b,w)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:d,u_fade_t:_.mix,u_opacity:_.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(T=b.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(M=b.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ia(b.paint.get("raster-hue-rotate")),u_perspective_transform:w};var M,T};function ia(m){m*=Math.PI/180;const l=Math.sin(m),d=Math.cos(m);return[(2*d+1)/3,(-Math.sqrt(3)*l-d+1)/3,(Math.sqrt(3)*l-d+1)/3]}const Eo=h.create(),Yl=(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J)=>{const Y=b.transform,q={u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:Y.cameraToCenterDistance,u_rotate_symbol:+d,u_aspect_ratio:Y.width/Y.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:M,u_coord_matrix:T,u_is_text:+I,u_pitch_with_map:+_,u_texsize:N,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Eo,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Eo,u_up_vector:[0,-1,0]};return"globe"===J.name&&(q.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],q.u_zoom_transition=U,q.u_inv_rot_matrix=X,q.u_merc_center=W,q.u_camera_forward=Y._camera.forward(),q.u_ecef_origin=h.globeECEFOrigin(Y.globeMatrix,L.toUnwrapped()),q.u_tile_matrix=Float32Array.from(Y.globeMatrix),q.u_up_vector=K),q},rd=(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J,Y)=>h.extend(Yl(m,l,d,_,b,w,M,T,I,N,U,W,X,K,J,Y),{u_gamma_scale:_?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:h.exported.devicePixelRatio,u_is_halo:+L}),fl=(m,l,d,_,b,w,M,T,I,N,L,U,W,X,K,J)=>h.extend(rd(m,l,d,_,b,w,M,T,!0,I,!0,L,U,W,X,K,J),{u_texsize_icon:N,u_texture_icon:1}),Cs=(m,l,d)=>({u_matrix:m,u_opacity:l,u_color:d}),jt=(m,l,d,_,b)=>h.extend(function(w,M,T){const I=M.imageManager.getPattern(w.toString()),{width:N,height:L}=M.imageManager.getPixelSize(),U=Math.pow(2,T.tileID.overscaledZ),W=T.tileSize*Math.pow(2,M.transform.tileZoom)/U,X=W*(T.tileID.canonical.x+T.tileID.wrap*U),K=W*T.tileID.canonical.y;return{u_image:0,u_pattern_tl:I.tl,u_pattern_br:I.br,u_texsize:[N,L],u_pattern_size:I.displaySize,u_tile_units_to_pixels:1/Yo(T,1,M.transform.tileZoom),u_pixel_coord_upper:[X>>16,K>>16],u_pixel_coord_lower:[65535&X,65535&K]}}(_,d,b),{u_matrix:m,u_opacity:l}),Un={fillExtrusion:m=>({u_matrix:new h.UniformMatrix4f(m),u_lightpos:new h.Uniform3f(m),u_lightintensity:new h.Uniform1f(m),u_lightcolor:new h.Uniform3f(m),u_vertical_gradient:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_edge_radius:new h.Uniform1f(m),u_ao:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_up_dir:new h.Uniform3f(m),u_height_lift:new h.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_lightpos:new h.Uniform3f(m),u_lightintensity:new h.Uniform1f(m),u_lightcolor:new h.Uniform3f(m),u_vertical_gradient:new h.Uniform1f(m),u_height_factor:new h.Uniform1f(m),u_edge_radius:new h.Uniform1f(m),u_ao:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_up_dir:new h.Uniform3f(m),u_height_lift:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m)}),fill:m=>({u_matrix:new h.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m)}),fillOutline:m=>({u_matrix:new h.UniformMatrix4f(m),u_world:new h.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_world:new h.Uniform2f(m),u_image:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new h.Uniform1f(m),u_extrude_scale:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_up_dir:new h.Uniform3f(m)}),collisionBox:m=>({u_matrix:new h.UniformMatrix4f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_extrude_scale:new h.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new h.UniformMatrix4f(m),u_inv_matrix:new h.UniformMatrix4f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_viewport_size:new h.Uniform2f(m)}),debug:m=>({u_color:new h.UniformColor(m),u_matrix:new h.UniformMatrix4f(m),u_overlay:new h.Uniform1i(m),u_overlay_scale:new h.Uniform1f(m)}),clippingMask:m=>({u_matrix:new h.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new h.Uniform1f(m),u_intensity:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_up_dir:new h.Uniform3f(m)}),heatmapTexture:m=>({u_image:new h.Uniform1i(m),u_color_ramp:new h.Uniform1i(m),u_opacity:new h.Uniform1f(m)}),hillshade:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_latrange:new h.Uniform2f(m),u_light:new h.Uniform2f(m),u_shadow:new h.UniformColor(m),u_highlight:new h.UniformColor(m),u_accent:new h.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new h.UniformMatrix4f(m),u_image:new h.Uniform1i(m),u_dimension:new h.Uniform2f(m),u_zoom:new h.Uniform1f(m),u_unpack:new h.Uniform4f(m)}),line:m=>({u_matrix:new h.UniformMatrix4f(m),u_pixels_to_tile_units:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_units_to_pixels:new h.Uniform2f(m),u_dash_image:new h.Uniform1i(m),u_gradient_image:new h.Uniform1i(m),u_image_height:new h.Uniform1f(m),u_texsize:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m),u_alpha_discard_threshold:new h.Uniform1f(m),u_trim_offset:new h.Uniform2f(m)}),linePattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_texsize:new h.Uniform2f(m),u_pixels_to_tile_units:new h.UniformMatrix2f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_units_to_pixels:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m),u_alpha_discard_threshold:new h.Uniform1f(m)}),raster:m=>({u_matrix:new h.UniformMatrix4f(m),u_tl_parent:new h.Uniform2f(m),u_scale_parent:new h.Uniform1f(m),u_fade_t:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_image0:new h.Uniform1i(m),u_image1:new h.Uniform1i(m),u_brightness_low:new h.Uniform1f(m),u_brightness_high:new h.Uniform1f(m),u_saturation_factor:new h.Uniform1f(m),u_contrast_factor:new h.Uniform1f(m),u_spin_weights:new h.Uniform3f(m),u_perspective_transform:new h.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_camera_forward:new h.Uniform3f(m),u_tile_matrix:new h.UniformMatrix4f(m),u_up_vector:new h.Uniform3f(m),u_ecef_origin:new h.Uniform3f(m),u_texture:new h.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_texture:new h.Uniform1i(m),u_gamma_scale:new h.Uniform1f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_tile_id:new h.Uniform3f(m),u_zoom_transition:new h.Uniform1f(m),u_inv_rot_matrix:new h.UniformMatrix4f(m),u_merc_center:new h.Uniform2f(m),u_camera_forward:new h.Uniform3f(m),u_tile_matrix:new h.UniformMatrix4f(m),u_up_vector:new h.Uniform3f(m),u_ecef_origin:new h.Uniform3f(m),u_is_halo:new h.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new h.Uniform1i(m),u_is_size_feature_constant:new h.Uniform1i(m),u_size_t:new h.Uniform1f(m),u_size:new h.Uniform1f(m),u_camera_to_center_distance:new h.Uniform1f(m),u_rotate_symbol:new h.Uniform1i(m),u_aspect_ratio:new h.Uniform1f(m),u_fade_change:new h.Uniform1f(m),u_matrix:new h.UniformMatrix4f(m),u_label_plane_matrix:new h.UniformMatrix4f(m),u_coord_matrix:new h.UniformMatrix4f(m),u_is_text:new h.Uniform1i(m),u_pitch_with_map:new h.Uniform1i(m),u_texsize:new h.Uniform2f(m),u_texsize_icon:new h.Uniform2f(m),u_texture:new h.Uniform1i(m),u_texture_icon:new h.Uniform1i(m),u_gamma_scale:new h.Uniform1f(m),u_device_pixel_ratio:new h.Uniform1f(m),u_is_halo:new h.Uniform1i(m)}),background:m=>({u_matrix:new h.UniformMatrix4f(m),u_opacity:new h.Uniform1f(m),u_color:new h.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new h.UniformMatrix4f(m),u_opacity:new h.Uniform1f(m),u_image:new h.Uniform1i(m),u_pattern_tl:new h.Uniform2f(m),u_pattern_br:new h.Uniform2f(m),u_texsize:new h.Uniform2f(m),u_pattern_size:new h.Uniform2f(m),u_pixel_coord_upper:new h.Uniform2f(m),u_pixel_coord_lower:new h.Uniform2f(m),u_tile_units_to_pixels:new h.Uniform1f(m)}),terrainRaster:ta,terrainDepth:ta,skybox:m=>({u_matrix:new h.UniformMatrix4f(m),u_sun_direction:new h.Uniform3f(m),u_cubemap:new h.Uniform1i(m),u_opacity:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new h.UniformMatrix4f(m),u_color_ramp:new h.Uniform1i(m),u_center_direction:new h.Uniform3f(m),u_radius:new h.Uniform1f(m),u_opacity:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new h.UniformMatrix3f(m),u_sun_direction:new h.Uniform3f(m),u_sun_intensity:new h.Uniform1f(m),u_color_tint_r:new h.Uniform4f(m),u_color_tint_m:new h.Uniform4f(m),u_luminance:new h.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new h.UniformMatrix4f(m),u_globe_matrix:new h.UniformMatrix4f(m),u_normalize_matrix:new h.UniformMatrix4f(m),u_merc_matrix:new h.UniformMatrix4f(m),u_zoom_transition:new h.Uniform1f(m),u_merc_center:new h.Uniform2f(m),u_image0:new h.Uniform1i(m),u_grid_matrix:new h.UniformMatrix3f(m),u_skirt_height:new h.Uniform1f(m),u_frustum_tl:new h.Uniform3f(m),u_frustum_tr:new h.Uniform3f(m),u_frustum_br:new h.Uniform3f(m),u_frustum_bl:new h.Uniform3f(m),u_globe_pos:new h.Uniform3f(m),u_globe_radius:new h.Uniform1f(m),u_viewport:new h.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new h.Uniform3f(m),u_frustum_tr:new h.Uniform3f(m),u_frustum_br:new h.Uniform3f(m),u_frustum_bl:new h.Uniform3f(m),u_horizon:new h.Uniform1f(m),u_transition:new h.Uniform1f(m),u_fadeout_range:new h.Uniform1f(m),u_color:new h.Uniform4f(m),u_high_color:new h.Uniform4f(m),u_space_color:new h.Uniform4f(m),u_star_intensity:new h.Uniform1f(m),u_star_density:new h.Uniform1f(m),u_star_size:new h.Uniform1f(m),u_temporal_offset:new h.Uniform1f(m),u_horizon_angle:new h.Uniform1f(m),u_rotation_matrix:new h.UniformMatrix4f(m)})};let Li;function rs(m,l,d,_,b,w,M){const T=m.context,I=T.gl,N=m.transform,L=m.useProgram("collisionBox"),U=[];let W=0,X=0;for(let le=0;le<_.length;le++){const ye=_[le],ge=l.getTile(ye),we=ge.getBucket(d);if(!we)continue;const Se=Sn(ye,we,N);let Fe=Se;0===b[0]&&0===b[1]||(Fe=m.translatePosMatrix(Se,ge,b,w));const Le=M?we.textCollisionBox:we.iconCollisionBox,mt=we.collisionCircleArray;if(mt.length>0){const ke=h.create(),Ke=Fe;h.mul(ke,we.placementInvProjMatrix,N.glCoordMatrix),h.mul(ke,ke,we.placementViewportMatrix),U.push({circleArray:mt,circleOffset:X,transform:Ke,invTransform:ke,projection:we.getProjection()}),W+=mt.length/4,X=W}Le&&(m.terrain&&m.terrain.setupElevationDraw(ge,L),L.draw(T,I.LINES,h.DepthMode.disabled,h.StencilMode.disabled,m.colorModeForRenderPass(),h.CullFaceMode.disabled,Yd(Fe,N,ge,we.getProjection()),d.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,null,N.zoom,null,[Le.collisionVertexBuffer,Le.collisionVertexBufferExt]))}if(!M||!U.length)return;const K=m.useProgram("collisionCircle"),J=new h.StructArrayLayout2f1f2i16;J.resize(4*W),J._trim();let Y=0;for(const le of U)for(let ye=0;ye<le.circleArray.length/4;ye++){const ge=4*ye,we=le.circleArray[ge+0],Se=le.circleArray[ge+1],Fe=le.circleArray[ge+2],Le=le.circleArray[ge+3];J.emplace(Y++,we,Se,Fe,Le,0),J.emplace(Y++,we,Se,Fe,Le,1),J.emplace(Y++,we,Se,Fe,Le,2),J.emplace(Y++,we,Se,Fe,Le,3)}(!Li||Li.length<2*W)&&(Li=function(le){const ye=2*le,ge=new h.StructArrayLayout3ui6;ge.resize(ye),ge._trim();for(let we=0;we<ye;we++){const Se=6*we;ge.uint16[Se+0]=4*we+0,ge.uint16[Se+1]=4*we+1,ge.uint16[Se+2]=4*we+2,ge.uint16[Se+3]=4*we+2,ge.uint16[Se+4]=4*we+3,ge.uint16[Se+5]=4*we+0}return ge}(W));const q=T.createIndexBuffer(Li,!0),se=T.createVertexBuffer(J,h.collisionCircleLayout.members,!0);for(const le of U){const ye={u_matrix:le.transform,u_inv_matrix:le.invTransform,u_camera_to_center_distance:(re=N).getCameraToCenterDistance(le.projection),u_viewport_size:[re.width,re.height]};K.draw(T,I.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,m.colorModeForRenderPass(),h.CullFaceMode.disabled,ye,d.id,se,q,h.SegmentVector.simpleSegment(0,2*le.circleOffset,le.circleArray.length,le.circleArray.length/2),null,N.zoom)}var re;se.destroy(),q.destroy()}const $s=h.create();function Or({width:m,height:l,anchor:d,textOffset:_,textScale:b},w){const{horizontalAlign:M,verticalAlign:T}=h.getAnchorAlignment(d),I=-(M-.5)*m,N=-(T-.5)*l,L=h.evaluateVariableOffset(d,_);return new h.pointGeometry((I/b+L[0])*w,(N/b+L[1])*w)}function Es(m,l,d,_,b,w,M,T,I,N,L){const U=m.text.placedSymbolArray,W=m.text.dynamicLayoutVertexArray,X=m.icon.dynamicLayoutVertexArray,K={},J=m.getProjection(),Y=fi(T,J,w),q=w.elevation,se=J.upVectorScale(T.canonical,w.center.lat,w.worldSize).metersToTile;W.clear();for(let re=0;re<U.length;re++){const le=U.get(re),{tileAnchorX:ye,tileAnchorY:ge,numGlyphs:we}=le,Fe=le.hidden||!le.crossTileID||m.allowVerticalPlacement&&!le.placedOrientation?null:_[le.crossTileID];if(Fe){let Le=0,mt=0,ke=0;if(q){const qt=q?q.getAtTileOffset(T,ye,ge):0,[Fn,Rt,At]=J.upVector(T.canonical,ye,ge);Le=qt*Fn*se,mt=qt*Rt*se,ke=qt*At*se}let[Ke,je,ct,Ne]=bt(le.projectedAnchorX+Le,le.projectedAnchorY+mt,le.projectedAnchorZ+ke,d?Y:M);const Me=In(w.getCameraToCenterDistance(J),Ne);let Ve=b.evaluateSizeForFeature(m.textSizeData,N,le)*Me/h.ONE_EM;d&&(Ve*=m.tilePixelRatio/I);const st=Or(Fe,Ve);d?(({x:Ke,y:je,z:ct}=J.projectTilePoint(ye+st.x,ge+st.y,T.canonical)),[Ke,je,ct]=bt(Ke+Le,je+mt,ct+ke,M)):(l&&st._rotate(-w.angle),Ke+=st.x,je+=st.y,ct=0);const ut=m.allowVerticalPlacement&&le.placedOrientation===h.WritingMode.vertical?Math.PI/2:0;for(let qt=0;qt<we;qt++)h.addDynamicAttributes(W,Ke,je,ct,ut);L&&le.associatedIconIndex>=0&&(K[le.associatedIconIndex]={x:Ke,y:je,z:ct,angle:ut})}else bi(we,W)}if(L){X.clear();const re=m.icon.placedSymbolArray;for(let le=0;le<re.length;le++){const ye=re.get(le),{numGlyphs:ge}=ye,we=K[le];if(ye.hidden||!we)bi(ge,X);else{const{x:Se,y:Fe,z:Le,angle:mt}=we;for(let ke=0;ke<ge;ke++)h.addDynamicAttributes(X,Se,Fe,Le,mt)}}m.icon.dynamicLayoutVertexBuffer.updateData(X)}m.text.dynamicLayoutVertexBuffer.updateData(W)}function ur(m,l,d){return d.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function Oc(m,l,d,_,b,w,M,T,I,N,L,U){const W=m.context,X=W.gl,K=m.transform,J="map"===T,Y="map"===I,q=J&&"point"!==d.layout.get("symbol-placement"),se=J&&!Y&&!q,re=void 0!==d.layout.get("symbol-sort-key").constantOr(1);let le=!1;const ye=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),ge=[h.mercatorXfromLng(K.center.lng),h.mercatorYfromLat(K.center.lat)],we=d.layout.get("text-variable-anchor"),Se="globe"===K.projection.name,Fe=[],Le=[0,-1,0];let mt=Le;!Se&&!K.mercatorFromTransition||J||(mt=function(ke){const Ke=ke._camera.getWorldToCamera(ke.worldSize,1),je=h.multiply([],Ke,ke.globeMatrix);h.invert(je,je);const ct=[0,0,0],Ne=[0,1,0,0];return h.transformMat4$1(Ne,Ne,je),ct[0]=Ne[0],ct[1]=Ne[1],ct[2]=Ne[2],h.normalize(ct,ct),ct}(K));for(const ke of _){const Ke=l.getTile(ke),je=Ke.getBucket(d);if(!je||"mercator"===je.projection.name&&Se)continue;const ct=b?je.text:je.icon;if(!ct||je.fullyClipped||!ct.segments.get().length)continue;const Ne=ct.programConfigurations.get(d.id),Me=b||je.sdfIcons,Ve=b?je.textSizeData:je.iconSizeData,st=Y||0!==K.pitch,ut=h.evaluateSizeForZoom(Ve,K.zoom);let qt,Fn,Rt,At,Wt=[0,0],kn=null;if(b)Fn=Ke.glyphAtlasTexture,Rt=X.LINEAR,qt=Ke.glyphAtlasTexture.size,je.iconsInText&&(Wt=Ke.imageAtlasTexture.size,kn=Ke.imageAtlasTexture,At=st||m.options.rotating||m.options.zooming||"composite"===Ve.kind||"camera"===Ve.kind?X.LINEAR:X.NEAREST);else{const cs=1!==d.layout.get("icon-size").constantOr(0)||je.iconsNeedLinear;Fn=Ke.imageAtlasTexture,Rt=Me||m.options.rotating||m.options.zooming||cs||st?X.LINEAR:X.NEAREST,qt=Ke.imageAtlasTexture.size}const Kt="globe"===je.projection.name,gi=Kt?mt:Le,di=Kt?h.globeToMercatorTransition(K.zoom):0,$i=fi(ke,je.getProjection(),K),Di=K.calculatePixelsToTileUnitsMatrix(Ke),dr=Ll($i,Ke.tileID.canonical,Y,J,K,je.getProjection(),Di),ho=m.terrain&&Y&&q?h.invert(h.create(),dr):$s,La=qr($i,Ke.tileID.canonical,Y,J,K,je.getProjection(),Di),Na=we&&je.hasTextData(),Yi="none"!==d.layout.get("icon-text-fit")&&Na&&je.hasIconData();if(q){const cs=K.elevation,Ds=cs?cs.getAtTileOffsetFunc(ke,K.center.lat,K.worldSize,je.getProjection()):null,za=lr($i,Ke.tileID.canonical,Y,J,K,je.getProjection(),Di);es(je,$i,m,b,za,La,Y,N,Ds,ke)}const Ni=q||b&&we||Yi,On=m.translatePosMatrix($i,Ke,w,M),hr=Ni?$s:dr,Br=m.translatePosMatrix(La,Ke,w,M,!0),Bi=je.getProjection().createInversionMatrix(K,ke.canonical),po=[];m.terrainRenderModeElevated()&&Y&&po.push("PITCH_WITH_MAP_TERRAIN"),Kt&&po.push("PROJECTION_GLOBE_VIEW"),Ni&&po.push("PROJECTED_POS_ON_VIEWPORT");const Qr=Me&&0!==d.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1);let Ba;Ba=Me?je.iconsInText?fl(Ve.kind,ut,se,Y,m,On,hr,Br,qt,Wt,ke,di,ge,Bi,gi,je.getProjection()):rd(Ve.kind,ut,se,Y,m,On,hr,Br,b,qt,!0,ke,di,ge,Bi,gi,je.getProjection()):Yl(Ve.kind,ut,se,Y,m,On,hr,Br,b,qt,ke,di,ge,Bi,gi,je.getProjection());const Iu={program:m.useProgram(ur(Me,b,je),Ne,po),buffers:ct,uniformValues:Ba,atlasTexture:Fn,atlasTextureIcon:kn,atlasInterpolation:Rt,atlasInterpolationIcon:At,isSDF:Me,hasHalo:Qr,tile:Ke,labelPlaneMatrixInv:ho};if(re&&je.canOverlap){le=!0;const cs=ct.segments.get();for(const Ds of cs)Fe.push({segments:new h.SegmentVector([Ds]),sortKey:Ds.sortKey,state:Iu})}else Fe.push({segments:ct.segments,sortKey:0,state:Iu})}le&&Fe.sort((ke,Ke)=>ke.sortKey-Ke.sortKey);for(const ke of Fe){const Ke=ke.state;if(m.terrain&&m.terrain.setupElevationDraw(Ke.tile,Ke.program,{useDepthForOcclusion:!Se,labelPlaneMatrixInv:Ke.labelPlaneMatrixInv}),W.activeTexture.set(X.TEXTURE0),Ke.atlasTexture.bind(Ke.atlasInterpolation,X.CLAMP_TO_EDGE),Ke.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),Ke.atlasTextureIcon&&Ke.atlasTextureIcon.bind(Ke.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),Ke.isSDF){const je=Ke.uniformValues;Ke.hasHalo&&(je.u_is_halo=1,Lc(Ke.buffers,ke.segments,d,m,Ke.program,ye,L,U,je)),je.u_is_halo=0}Lc(Ke.buffers,ke.segments,d,m,Ke.program,ye,L,U,Ke.uniformValues)}}function Lc(m,l,d,_,b,w,M,T,I){const N=_.context,L=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];b.draw(N,N.gl.TRIANGLES,w,M,T,h.CullFaceMode.disabled,I,d.id,m.layoutVertexBuffer,m.indexBuffer,l,d.paint,_.transform.zoom,m.programConfigurations.get(d.id),L)}function jn(m,l,d,_,b,w,M){const T=m.context.gl,I=d.paint.get("fill-pattern"),N=I&&I.constantOr(1);let L,U,W,X,K;M?(U=N&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",L=T.LINES):(U=N?"fillPattern":"fill",L=T.TRIANGLES);for(const J of _){const Y=l.getTile(J);if(N&&!Y.patternsLoaded())continue;const q=Y.getBucket(d);if(!q)continue;m.prepareDrawTile();const se=q.programConfigurations.get(d.id),re=m.useProgram(U,se);N&&(m.context.activeTexture.set(T.TEXTURE0),Y.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),se.updatePaintBuffers());const le=I.constantOr(null);if(le&&Y.imageAtlas){const ge=Y.imageAtlas.patternPositions[le.toString()];ge&&se.setConstantPatternPositions(ge)}const ye=m.translatePosMatrix(J.projMatrix,Y,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(M){X=q.indexBuffer2,K=q.segments2;const ge=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[T.drawingBufferWidth,T.drawingBufferHeight];W="fillOutlinePattern"===U&&N?Zl(ye,m,Y,ge):is(ye,ge)}else X=q.indexBuffer,K=q.segments,W=N?Wl(ye,m,Y):pl(ye);m.prepareDrawProgram(m.context,re,J.toUnwrapped()),re.draw(m.context,L,b,m.stencilModeForClipping(J),w,h.CullFaceMode.disabled,W,d.id,q.layoutVertexBuffer,X,K,d.paint,m.transform.zoom,se)}}function Nc(m,l,d,_,b,w,M){const T=m.context,I=T.gl,N=m.transform,L=d.paint.get("fill-extrusion-pattern"),U=L.constantOr(1),W=d.paint.get("fill-extrusion-opacity"),X=[d.paint.get("fill-extrusion-ambient-occlusion-intensity"),d.paint.get("fill-extrusion-ambient-occlusion-radius")],K=d.layout.get("fill-extrusion-edge-radius"),J="globe"===N.projection.name?h.fillExtrusionHeightLift():0,Y="globe"===N.projection.name,q=Y?h.globeToMercatorTransition(N.zoom):0,se=[h.mercatorXfromLng(N.center.lng),h.mercatorYfromLat(N.center.lat)],re=[];Y&&re.push("PROJECTION_GLOBE_VIEW"),X[0]>0&&re.push("FAUX_AO");for(const le of _){const ye=l.getTile(le),ge=ye.getBucket(d);if(!ge||ge.projection.name!==N.projection.name)continue;const we=ge.programConfigurations.get(d.id),Se=m.useProgram(U?"fillExtrusionPattern":"fillExtrusion",we,re);if(m.terrain){const ct=m.terrain;if(m.style.terrainSetForDrapingOnly())ct.setupElevationDraw(ye,Se,{useMeterToDem:!0});else{if(!ge.enableTerrain)continue;if(ct.setupElevationDraw(ye,Se,{useMeterToDem:!0}),Bc(T,l,le,ge,d,ct),!ge.centroidVertexBuffer){const Ne=Se.attributes.a_centroid_pos;void 0!==Ne&&I.vertexAttrib2f(Ne,0,0)}}}U&&(m.context.activeTexture.set(I.TEXTURE0),ye.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),we.updatePaintBuffers());const Fe=L.constantOr(null);if(Fe&&ye.imageAtlas){const ct=ye.imageAtlas.patternPositions[Fe.toString()];ct&&we.setConstantPatternPositions(ct)}const Le=m.translatePosMatrix(le.projMatrix,ye,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),mt=N.projection.createInversionMatrix(N,le.canonical),ke=d.paint.get("fill-extrusion-vertical-gradient"),Ke=U?hl(Le,m,ke,W,X,K,le,ye,J,q,se,mt):dl(Le,m,ke,W,X,K,le,J,q,se,mt);m.prepareDrawProgram(T,Se,le.toUnwrapped());const je=[];m.terrain&&je.push(ge.centroidVertexBuffer),Y&&je.push(ge.layoutVertexExtBuffer),Se.draw(T,T.gl.TRIANGLES,b,w,M,h.CullFaceMode.backCCW,Ke,d.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,d.paint,m.transform.zoom,we,je)}}function Bc(m,l,d,_,b,w){const M=[q=>{let se=q.canonical.x-1,re=q.wrap;return se<0&&(se=(1<<q.canonical.z)-1,re--),new h.OverscaledTileID(q.overscaledZ,re,q.canonical.z,se,q.canonical.y)},q=>{let se=q.canonical.x+1,re=q.wrap;return se===1<<q.canonical.z&&(se=0,re++),new h.OverscaledTileID(q.overscaledZ,re,q.canonical.z,se,q.canonical.y)},q=>new h.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,(0===q.canonical.y?1<<q.canonical.z:q.canonical.y)-1),q=>new h.OverscaledTileID(q.overscaledZ,q.wrap,q.canonical.z,q.canonical.x,q.canonical.y===(1<<q.canonical.z)-1?0:q.canonical.y+1)],T=q=>{const se=l.getSource().minzoom,re=ye=>{const ge=l.getTileByID(ye);if(ge&&ge.hasData())return ge.getBucket(b)},le=[0,-1,1];for(const ye of le){if(q.overscaledZ+ye<se)continue;const ge=re(q.calculateScaledKey(q.overscaledZ+ye));if(ge)return ge}},I=[0,0,0],N=(q,se)=>(I[0]=Math.min(q.min.y,se.min.y),I[1]=Math.max(q.max.y,se.max.y),I[2]=h.EXTENT-se.min.x>q.max.x?se.min.x-h.EXTENT:q.max.x,I),L=(q,se)=>(I[0]=Math.min(q.min.x,se.min.x),I[1]=Math.max(q.max.x,se.max.x),I[2]=h.EXTENT-se.min.y>q.max.y?se.min.y-h.EXTENT:q.max.y,I),U=[(q,se)=>N(q,se),(q,se)=>N(se,q),(q,se)=>L(q,se),(q,se)=>L(se,q)],W=new h.pointGeometry(0,0);let X,K,J;const Y=(q,se,re,le,ye)=>{const ge=[[le?re:q,le?q:re,0],[le?re:se,le?se:re,0]],we=ye<0?h.EXTENT+ye:ye,Se=[le?we:(q+se)/2,le?(q+se)/2:we,0];return 0===re&&ye<0||0!==re&&ye>0?w.getForTilePoints(J,[Se],!0,K):ge.push(Se),w.getForTilePoints(d,ge,!0,X),Math.max(ge[0][2],ge[1][2],Se[2])/w.exaggeration()};for(let q=0;q<4;q++){const se=(q<2?1:5)-q,re=_.borders[q];if(0===re.length)continue;const le=J=M[q](d),ye=T(le);if(!(ye&&ye instanceof h.FillExtrusionBucket&&ye.enableTerrain)||_.borderDoneWithNeighborZ[q]===ye.canonical.z&&ye.borderDoneWithNeighborZ[se]===_.canonical.z||(K=w.findDEMTileFor(le),!K||!K.dem))continue;if(!X){const Fe=w.findDEMTileFor(d);if(!Fe||!Fe.dem)return;X=Fe}const ge=ye.borders[se];let we=0;const Se=ye.borderDoneWithNeighborZ[se]!==_.canonical.z;if(_.canonical.z===ye.canonical.z){for(let Fe=0;Fe<re.length;Fe++){const Le=_.featuresOnBorder[re[Fe]],mt=Le.borders[q];let ke;for(;we<ge.length&&(ke=ye.featuresOnBorder[ge[we]],!(ke.borders[se][1]>mt[0]+3));)Se&&ye.encodeCentroid(void 0,ke,!1),we++;if(ke&&we<ge.length){const Ke=we;let je=0;for(;!(ke.borders[se][0]>mt[1]-3)&&(je++,++we!==ge.length);)ke=ye.featuresOnBorder[ge[we]];if(ke=ye.featuresOnBorder[ge[Ke]],Le.intersectsCount()>1||ke.intersectsCount()>1||1!==je){1!==je&&(we=Ke),_.encodeCentroid(void 0,Le,!1),Se&&ye.encodeCentroid(void 0,ke,!1);continue}const ct=U[q](Le,ke),Ne=q%2?h.EXTENT-1:0;W.x=Y(ct[0],Math.min(h.EXTENT-1,ct[1]),Ne,q<2,ct[2]),W.y=0,_.encodeCentroid(W,Le,!1),Se&&ye.encodeCentroid(W,ke,!1)}else _.encodeCentroid(void 0,Le,!1)}_.borderDoneWithNeighborZ[q]=ye.canonical.z,_.needsCentroidUpdate=!0,Se&&(ye.borderDoneWithNeighborZ[se]=_.canonical.z,ye.needsCentroidUpdate=!0)}else{for(const Fe of re)_.encodeCentroid(void 0,_.featuresOnBorder[Fe],!1);if(Se){for(const Fe of ge)ye.encodeCentroid(void 0,ye.featuresOnBorder[Fe],!1);ye.borderDoneWithNeighborZ[se]=_.canonical.z,ye.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[q]=ye.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(m)}const Cu=new h.Color(1,0,0,1),Do=new h.Color(0,1,0,1),kr=new h.Color(0,0,1,1),Xl=new h.Color(1,0,1,1),Aa=new h.Color(0,1,1,1);function os(m,l,d){const _=m.context,b=m.transform,w=_.gl,M="globe"===b.projection.name,T=M?["PROJECTION_GLOBE_VIEW"]:null;let I=d.projMatrix;if(M&&h.globeToMercatorTransition(b.zoom)>0){const Le=h.transitionTileAABBinECEF(d.canonical,b),mt=h.globeDenormalizeECEF(Le);I=h.multiply(new Float32Array(16),b.globeMatrix,mt),h.multiply(I,b.projMatrix,I)}const N=m.useProgram("debug",null,T),L=l.getTileByID(d.key);m.terrain&&m.terrain.setupElevationDraw(L,N);const U=h.DepthMode.disabled,W=h.StencilMode.disabled,X=m.colorModeForRenderPass(),K="$debug";_.activeTexture.set(w.TEXTURE0),m.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),M?L._makeGlobeTileDebugBuffers(m.context,b):L._makeDebugTileBoundsBuffers(m.context,b.projection);const J=L._tileDebugBuffer||m.debugBuffer,Y=L._tileDebugIndexBuffer||m.debugIndexBuffer,q=L._tileDebugSegments||m.debugSegments;N.draw(_,w.LINE_STRIP,U,W,X,h.CullFaceMode.disabled,Rc(I,h.Color.red),K,J,Y,q,null,null,null,[L._globeTileDebugBorderBuffer]);const se=L.latestRawTileData,re=Math.floor((se&&se.byteLength||0)/1024),le=l.getTile(d).tileSize,ye=512/Math.min(le,512)*(d.overscaledZ/b.zoom)*.5;let ge=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(ge+=` => ${d.overscaledZ}`),ge+=` ${re}kb`,function(Le,mt){Le.initDebugOverlayCanvas();const ke=Le.debugOverlayCanvas,Ke=Le.context.gl,je=Le.debugOverlayCanvas.getContext("2d");je.clearRect(0,0,ke.width,ke.height),je.shadowColor="white",je.shadowBlur=2,je.lineWidth=1.5,je.strokeStyle="white",je.textBaseline="top",je.font="bold 36px Open Sans, sans-serif",je.fillText(mt,5,5),je.strokeText(mt,5,5),Le.debugOverlayTexture.update(ke),Le.debugOverlayTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE)}(m,ge);const we=L._tileDebugTextBuffer||m.debugBuffer,Se=L._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Fe=L._tileDebugTextSegments||m.debugSegments;N.draw(_,w.TRIANGLES,U,W,h.ColorMode.alphaBlended,h.CullFaceMode.disabled,Rc(I,h.Color.transparent,ye),K,we,Se,Fe,null,null,null,[L._globeTileDebugTextBuffer])}function ss(m,l,d,_){Ai(m,0,l+d/2,m.transform.width,d,_)}function ml(m,l,d,_){Ai(m,l-d/2,0,d,m.transform.height,_)}function Ai(m,l,d,_,b,w){const M=m.context,T=M.gl;T.enable(T.SCISSOR_TEST),T.scissor(l*h.exported.devicePixelRatio,d*h.exported.devicePixelRatio,_*h.exported.devicePixelRatio,b*h.exported.devicePixelRatio),M.clear({color:w}),T.disable(T.SCISSOR_TEST)}const zc=h.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ia}=zc;function Hs(m,l,d,_){m.emplaceBack(l,d,_)}class Zr{constructor(l){this.vertexArray=new h.StructArrayLayout3f12,this.indices=new h.StructArrayLayout3ui6,Hs(this.vertexArray,-1,-1,1),Hs(this.vertexArray,1,-1,1),Hs(this.vertexArray,-1,1,1),Hs(this.vertexArray,1,1,1),Hs(this.vertexArray,-1,-1,-1),Hs(this.vertexArray,1,-1,-1),Hs(this.vertexArray,-1,1,-1),Hs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Ia),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=h.SegmentVector.simpleSegment(0,0,36,12)}}function Cn(m,l,d,_,b,w){const M=m.gl,T=l.paint.get("sky-atmosphere-color"),I=l.paint.get("sky-atmosphere-halo-color"),N=l.paint.get("sky-atmosphere-sun-intensity"),L={u_matrix_3f:h.fromMat4(h.create$1(),_),u_sun_direction:b,u_sun_intensity:N,u_color_tint_r:[(K=T).r,K.g,K.b,K.a],u_color_tint_m:[(J=I).r,J.g,J.b,J.a],u_luminance:5e-5};var K,J;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+w,l.skyboxTexture,0),d.draw(m,M.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,h.ColorMode.unblended,h.CullFaceMode.frontCW,L,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const ra=h.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class lo{constructor(l){const d=new h.StructArrayLayout5f20;d.emplaceBack(-1,1,1,0,0),d.emplaceBack(1,1,1,1,0),d.emplaceBack(1,-1,1,1,1),d.emplaceBack(-1,-1,1,0,1);const _=new h.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(d,ra.members),this.indexBuffer=l.createIndexBuffer(_),this.segments=h.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Xd={symbol:function(m,l,d,_,b){if("translucent"!==m.renderPass)return;const w=h.StencilMode.disabled,M=m.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(T,I,N,L,U,W,X){const K=I.transform,J="map"===U,Y="map"===W;for(const q of T){const se=L.getTile(q),re=se.getBucket(N);if(!re||!re.text||!re.text.segments.get().length)continue;const le=h.evaluateSizeForZoom(re.textSizeData,K.zoom),ye=fi(q,re.getProjection(),K),ge=K.calculatePixelsToTileUnitsMatrix(se),we=Ll(ye,se.tileID.canonical,Y,J,K,re.getProjection(),ge),Se="none"!==N.layout.get("icon-text-fit")&&re.hasIconData();if(le){const Fe=Math.pow(2,K.zoom-se.tileID.overscaledZ);Es(re,J,Y,X,h.symbolSize,K,we,q,Fe,le,Se)}}}(_,m,d,l,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),b),0!==d.paint.get("icon-opacity").constantOr(1)&&Oc(m,l,d,_,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),w,M),0!==d.paint.get("text-opacity").constantOr(1)&&Oc(m,l,d,_,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),w,M),l.map.showCollisionBoxes&&(rs(m,l,d,_,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),rs(m,l,d,_,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,d,_){if("translucent"!==m.renderPass)return;const b=d.paint.get("circle-opacity"),w=d.paint.get("circle-stroke-width"),M=d.paint.get("circle-stroke-opacity"),T=void 0!==d.layout.get("circle-sort-key").constantOr(1);if(0===b.constantOr(1)&&(0===w.constantOr(1)||0===M.constantOr(1)))return;const I=m.context,N=I.gl,L=m.transform,U=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),W=h.StencilMode.disabled,X=m.colorModeForRenderPass(),K="globe"===L.projection.name,J=[h.mercatorXfromLng(L.center.lng),h.mercatorYfromLat(L.center.lat)],Y=[];for(let se=0;se<_.length;se++){const re=_[se],le=l.getTile(re),ye=le.getBucket(d);if(!ye||ye.projection.name!==L.projection.name)continue;const ge=ye.programConfigurations.get(d.id),we=Ta(d);K&&we.push("PROJECTION_GLOBE_VIEW");const Se=m.useProgram("circle",ge,we),Fe=ye.layoutVertexBuffer,Le=ye.globeExtVertexBuffer,mt=ye.indexBuffer,ke=L.projection.createInversionMatrix(L,re.canonical),Ke={programConfiguration:ge,program:Se,layoutVertexBuffer:Fe,globeExtVertexBuffer:Le,indexBuffer:mt,uniformValues:mi(m,re,le,ke,J,d),tile:le};if(T){const je=ye.segments.get();for(const ct of je)Y.push({segments:new h.SegmentVector([ct]),sortKey:ct.sortKey,state:Ke})}else Y.push({segments:ye.segments,sortKey:0,state:Ke})}T&&Y.sort((se,re)=>se.sortKey-re.sortKey);const q={useDepthForOcclusion:!K};for(const se of Y){const{programConfiguration:re,program:le,layoutVertexBuffer:ye,globeExtVertexBuffer:ge,indexBuffer:we,uniformValues:Se,tile:Fe}=se.state,Le=se.segments;m.terrain&&m.terrain.setupElevationDraw(Fe,le,q),m.prepareDrawProgram(I,le,Fe.tileID.toUnwrapped()),le.draw(I,N.TRIANGLES,U,W,X,h.CullFaceMode.disabled,Se,d.id,ye,we,Le,d.paint,L.zoom,re,[ge])}},heatmap:function(m,l,d,_){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const b=m.context,w=b.gl,M=h.StencilMode.disabled,T=new h.ColorMode([w.ONE,w.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(X,K,J,Y){const q=X.gl,se=K.width*Y,re=K.height*Y;X.activeTexture.set(q.TEXTURE1),X.viewport.set([0,0,se,re]);let le=J.heatmapFbo;if(!le||le&&(le.width!==se||le.height!==re)){le&&le.destroy();const ye=q.createTexture();q.bindTexture(q.TEXTURE_2D,ye),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),le=J.heatmapFbo=X.createFramebuffer(se,re,!1),function(ge,we,Se,Fe,Le,mt){const ke=ge.gl;ke.texImage2D(ke.TEXTURE_2D,0,ge.isWebGL2&&ge.extRenderToTextureHalfFloat?ke.RGBA16F:ke.RGBA,Le,mt,0,ke.RGBA,ge.extRenderToTextureHalfFloat?ge.isWebGL2?ke.HALF_FLOAT:ge.extTextureHalfFloat.HALF_FLOAT_OES:ke.UNSIGNED_BYTE,null),Fe.colorAttachment.set(Se)}(X,0,ye,le,se,re)}else q.bindTexture(q.TEXTURE_2D,le.colorAttachment.get()),X.bindFramebuffer.set(le.framebuffer)})(b,m,d,"globe"===m.transform.projection.name?.5:.25),b.clear({color:h.Color.transparent});const I=m.transform,N="globe"===I.projection.name,L=N?["PROJECTION_GLOBE_VIEW"]:null,U=N?h.CullFaceMode.frontCCW:h.CullFaceMode.disabled,W=[h.mercatorXfromLng(I.center.lng),h.mercatorYfromLat(I.center.lat)];for(let X=0;X<_.length;X++){const K=_[X];if(l.hasRenderableParent(K))continue;const J=l.getTile(K),Y=J.getBucket(d);if(!Y||Y.projection.name!==I.projection.name)continue;const q=Y.programConfigurations.get(d.id),se=m.useProgram("heatmap",q,L),{zoom:re}=m.transform;m.terrain&&m.terrain.setupElevationDraw(J,se),m.prepareDrawProgram(b,se,K.toUnwrapped());const le=I.projection.createInversionMatrix(I,K.canonical);se.draw(b,w.TRIANGLES,h.DepthMode.disabled,M,T,U,js(m,K,J,le,W,re,d.paint.get("heatmap-intensity")),d.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,d.paint,m.transform.zoom,q,N?[Y.globeExtVertexBuffer]:null)}b.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(b,w){const M=b.context,T=M.gl,I=w.heatmapFbo;if(!I)return;M.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,I.colorAttachment.get()),M.activeTexture.set(T.TEXTURE1);let N=w.colorRampTexture;N||(N=w.colorRampTexture=new h.Texture(M,w.colorRamp,T.RGBA)),N.bind(T.LINEAR,T.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(M,T.TRIANGLES,h.DepthMode.disabled,h.StencilMode.disabled,b.colorModeForRenderPass(),h.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:w.paint.get("heatmap-opacity")},w.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,w.paint,b.transform.zoom)}(m,d))},line:function(m,l,d,_){if("translucent"!==m.renderPass)return;const b=d.paint.get("line-opacity"),w=d.paint.get("line-width");if(0===b.constantOr(1)||0===w.constantOr(1))return;const M=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),T=m.colorModeForRenderPass(),I=m.terrain&&m.terrain.renderingToTexture?1:h.exported.devicePixelRatio,N=d.paint.get("line-dasharray"),L=N.constantOr(1),U=d.layout.get("line-cap"),W=d.paint.get("line-pattern"),X=W.constantOr(1),K=d.paint.get("line-gradient"),J=X?"linePattern":"line",Y=m.context,q=Y.gl,se=(le=>{const ye=[];Dr(le)&&ye.push("RENDER_LINE_DASH"),le.paint.get("line-gradient")&&ye.push("RENDER_LINE_GRADIENT");const ge=le.paint.get("line-trim-offset");0===ge[0]&&0===ge[1]||ye.push("RENDER_LINE_TRIM_OFFSET");const we=le.paint.get("line-pattern").constantOr(1),Se=1!==le.paint.get("line-opacity").constantOr(1);return!we&&Se&&ye.push("RENDER_LINE_ALPHA_DISCARD"),ye})(d);let re=se.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(re=!1);for(const le of _){const ye=l.getTile(le);if(X&&!ye.patternsLoaded())continue;const ge=ye.getBucket(d);if(!ge)continue;m.prepareDrawTile();const we=ge.programConfigurations.get(d.id),Se=m.useProgram(J,we,se),Fe=W.constantOr(null);if(Fe&&ye.imageAtlas){const Me=ye.imageAtlas.patternPositions[Fe.toString()];Me&&we.setConstantPatternPositions(Me)}const Le=N.constantOr(null),mt=U.constantOr(null);if(!X&&Le&&mt&&ye.lineAtlas){const Me=ye.lineAtlas.getDash(Le,mt);Me&&we.setConstantPatternPositions(Me)}let[ke,Ke]=d.paint.get("line-trim-offset");("round"===mt||"square"===mt)&&ke!==Ke&&(0===ke&&(ke-=1),1===Ke&&(Ke+=1));const je=m.terrain?le.projMatrix:null,ct=X?Vt(m,ye,d,je,I):Fc(m,ye,d,je,ge.lineClipsArray.length,I,[ke,Ke]);if(K){const Me=ge.gradients[d.id];let Ve=Me.texture;if(d.gradientVersion!==Me.version){let st=256;if(d.stepInterpolant){const ut=l.getSource().maxzoom,qt=le.canonical.z===ut?Math.ceil(1<<m.transform.maxZoom-le.canonical.z):1;st=h.clamp(h.nextPowerOfTwo(ge.maxLineLength/h.EXTENT*1024*qt),256,Y.maxTextureSize)}Me.gradient=h.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:st,image:Me.gradient||void 0,clips:ge.lineClipsArray}),Me.texture?Me.texture.update(Me.gradient):Me.texture=new h.Texture(Y,Me.gradient,q.RGBA),Me.version=d.gradientVersion,Ve=Me.texture}Y.activeTexture.set(q.TEXTURE1),Ve.bind(d.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}L&&(Y.activeTexture.set(q.TEXTURE0),ye.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),we.updatePaintBuffers()),X&&(Y.activeTexture.set(q.TEXTURE0),ye.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),we.updatePaintBuffers()),m.prepareDrawProgram(Y,Se,le.toUnwrapped());const Ne=Me=>{Se.draw(Y,q.TRIANGLES,M,Me,T,h.CullFaceMode.disabled,ct,d.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,d.paint,m.transform.zoom,we,[ge.layoutVertexBuffer2])};if(re){const Me=m.stencilModeForClipping(le).ref;0===Me&&m.terrain&&Y.clear({stencil:0});const Ve={func:q.EQUAL,mask:255};ct.u_alpha_discard_threshold=.8,Ne(new h.StencilMode(Ve,Me,255,q.KEEP,q.KEEP,q.INVERT)),ct.u_alpha_discard_threshold=0,Ne(new h.StencilMode(Ve,Me,255,q.KEEP,q.KEEP,q.KEEP))}else Ne(m.stencilModeForClipping(le))}re&&(m.resetStencilClippingMasks(),m.terrain&&Y.clear({stencil:0}))},fill:function(m,l,d,_){const b=d.paint.get("fill-color"),w=d.paint.get("fill-opacity");if(0===w.constantOr(1))return;const M=m.colorModeForRenderPass(),T=d.paint.get("fill-pattern"),I=m.opaquePassEnabledForLayer()&&!T.constantOr(1)&&1===b.constantOr(h.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(m.renderPass===I){const N=m.depthModeForSublayer(1,"opaque"===m.renderPass?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly);jn(m,l,d,_,N,M,!1)}if("translucent"===m.renderPass&&d.paint.get("fill-antialias")){const N=m.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,h.DepthMode.ReadOnly);jn(m,l,d,_,N,M,!0)}},"fill-extrusion":function(m,l,d,_){const b=d.paint.get("fill-extrusion-opacity");if(0!==b&&"translucent"===m.renderPass){const w=new h.DepthMode(m.context.gl.LEQUAL,h.DepthMode.ReadWrite,m.depthRangeFor3D);if(1!==b||d.paint.get("fill-extrusion-pattern").constantOr(1))Nc(m,l,d,_,w,h.StencilMode.disabled,h.ColorMode.disabled),Nc(m,l,d,_,w,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const M=m.colorModeForRenderPass();Nc(m,l,d,_,w,h.StencilMode.disabled,M)}}},hillshade:function(m,l,d,_){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const b=m.context,w=m.depthModeForSublayer(0,h.DepthMode.ReadOnly),M=m.colorModeForRenderPass(),T=m.terrain&&m.terrain.renderingToTexture,[I,N]="translucent"!==m.renderPass||T?[{},_]:m.stencilConfigForOverlap(_);for(const L of N){const U=l.getTile(L);if(U.needsHillshadePrepare&&"offscreen"===m.renderPass)cl(m,U,d,w,h.StencilMode.disabled,M);else if("translucent"===m.renderPass){const W=T&&m.terrain?m.terrain.stencilModeForRTTOverlap(L):I[L.overscaledZ];Ic(m,L,U,d,w,W,M)}}b.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,d,_,b,w){if("translucent"!==m.renderPass||0===d.paint.get("raster-opacity")||!_.length)return;const M=m.context,T=M.gl,I=l.getSource(),N=m.useProgram("raster"),L=m.colorModeForRenderPass(),U=m.terrain&&m.terrain.renderingToTexture,[W,X]=I instanceof be||U?[{},_]:m.stencilConfigForOverlap(_),K=X[X.length-1].overscaledZ,J=!m.options.moving;for(const Y of X){const q=U?h.DepthMode.disabled:m.depthModeForSublayer(Y.overscaledZ-K,1===d.paint.get("raster-opacity")?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly,T.LESS),se=Y.toUnwrapped(),re=l.getTile(Y);if(U&&(!re||!re.hasData()))continue;const le=U?Y.projMatrix:m.transform.calculateProjMatrix(se,J),ye=m.terrain&&U?m.terrain.stencilModeForRTTOverlap(Y):W[Y.overscaledZ],ge=w?0:d.paint.get("raster-fade-duration");re.registerFadeDuration(ge);const we=l.findLoadedParent(Y,0),Se=Pc(re,we,l,m.transform,ge);let Fe,Le;m.terrain&&m.terrain.prepareDrawTile();const mt="nearest"===d.paint.get("raster-resampling")?T.NEAREST:T.LINEAR;M.activeTexture.set(T.TEXTURE0),re.texture.bind(mt,T.CLAMP_TO_EDGE),M.activeTexture.set(T.TEXTURE1),we?(we.texture.bind(mt,T.CLAMP_TO_EDGE),Fe=Math.pow(2,we.tileID.overscaledZ-re.tileID.overscaledZ),Le=[re.tileID.canonical.x*Fe%1,re.tileID.canonical.y*Fe%1]):re.texture.bind(mt,T.CLAMP_TO_EDGE),re.texture.useMipmap&&M.extTextureFilterAnisotropic&&m.transform.pitch>20&&T.texParameterf(T.TEXTURE_2D,M.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,M.extTextureFilterAnisotropicMax);const ke=ao(le,Le||[0,0],Fe||1,Se,d,I instanceof be?I.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(M,N,se),I instanceof be)I.boundsBuffer&&I.boundsSegments&&N.draw(M,T.TRIANGLES,q,h.StencilMode.disabled,L,h.CullFaceMode.disabled,ke,d.id,I.boundsBuffer,m.quadTriangleIndexBuffer,I.boundsSegments);else{const{tileBoundsBuffer:Ke,tileBoundsIndexBuffer:je,tileBoundsSegments:ct}=m.getTileBoundsBuffers(re);N.draw(M,T.TRIANGLES,q,ye,L,h.CullFaceMode.disabled,ke,d.id,Ke,je,ct)}}m.resetStencilClippingMasks()},background:function(m,l,d,_){const b=d.paint.get("background-color"),w=d.paint.get("background-opacity");if(0===w)return;const M=m.context,T=M.gl,I=m.transform,N=I.tileSize,L=d.paint.get("background-pattern");if(m.isPatternMissing(L))return;const U=!L&&1===b.a&&1===w&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==U)return;const W=h.StencilMode.disabled,X=m.depthModeForSublayer(0,"opaque"===U?h.DepthMode.ReadWrite:h.DepthMode.ReadOnly),K=m.colorModeForRenderPass(),J=m.useProgram(L?"backgroundPattern":"background");let Y,q=_;q||(Y=m.getBackgroundTiles(),q=Object.values(Y).map(se=>se.tileID)),L&&(M.activeTexture.set(T.TEXTURE0),m.imageManager.bind(m.context));for(const se of q){const re=se.toUnwrapped(),le=_?se.projMatrix:m.transform.calculateProjMatrix(re);m.prepareDrawTile();const ye=l?l.getTile(se):Y?Y[se.key]:new h.Tile(se,N,I.zoom,m),ge=L?jt(le,w,m,L,{tileID:se,tileSize:N}):Cs(le,w,b);m.prepareDrawProgram(M,J,re);const{tileBoundsBuffer:we,tileBoundsIndexBuffer:Se,tileBoundsSegments:Fe}=m.getTileBoundsBuffers(ye);J.draw(M,T.TRIANGLES,X,W,K,h.CullFaceMode.disabled,ge,d.id,we,Se,Fe)}},sky:function(m,l,d){const _=m.transform,b="mercator"===_.projection.name||"globe"===_.projection.name?1:h.smoothstep(7,8,_.zoom),w=d.paint.get("sky-opacity")*b;if(0===w)return;const M=m.context,T=d.paint.get("sky-type"),I=new h.DepthMode(M.gl.LEQUAL,h.DepthMode.ReadOnly,[0,1]),N=m.frameCounter/1e3%1;"atmosphere"===T?"offscreen"===m.renderPass?d.needsSkyboxCapture(m)&&(function(L,U,W,X){const K=L.context,J=K.gl;let Y=U.skyboxFbo;if(!Y){Y=U.skyboxFbo=K.createFramebuffer(32,32,!1),U.skyboxGeometry=new Zr(K),U.skyboxTexture=K.gl.createTexture(),J.bindTexture(J.TEXTURE_CUBE_MAP,U.skyboxTexture),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR);for(let le=0;le<6;++le)J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,J.RGBA,32,32,0,J.RGBA,J.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(Y.framebuffer),K.viewport.set([0,0,32,32]);const q=U.getCenter(L,!0),se=L.useProgram("skyboxCapture"),re=new Float64Array(16);h.identity(re),h.rotateY(re,re,.5*-Math.PI),Cn(K,U,se,re,q,0),h.identity(re),h.rotateY(re,re,.5*Math.PI),Cn(K,U,se,re,q,1),h.identity(re),h.rotateX(re,re,.5*-Math.PI),Cn(K,U,se,re,q,2),h.identity(re),h.rotateX(re,re,.5*Math.PI),Cn(K,U,se,re,q,3),h.identity(re),Cn(K,U,se,re,q,4),h.identity(re),h.rotateY(re,re,Math.PI),Cn(K,U,se,re,q,5),K.viewport.set([0,0,L.width,L.height])}(m,d),d.markSkyboxValid(m)):"sky"===m.renderPass&&function(L,U,W,X,K){const J=L.context,Y=J.gl,q=L.transform,se=L.useProgram("skybox");J.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_CUBE_MAP,U.skyboxTexture);const re={u_matrix:q.skyboxMatrix,u_sun_direction:U.getCenter(L,!1),u_cubemap:0,u_opacity:X,u_temporal_offset:K};L.prepareDrawProgram(J,se),se.draw(J,Y.TRIANGLES,W,h.StencilMode.disabled,L.colorModeForRenderPass(),h.CullFaceMode.backCW,re,"skybox",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(m,d,I,w,N):"gradient"===T&&"sky"===m.renderPass&&function(L,U,W,X,K){const J=L.context,Y=J.gl,q=L.transform,se=L.useProgram("skyboxGradient");U.skyboxGeometry||(U.skyboxGeometry=new Zr(J)),J.activeTexture.set(Y.TEXTURE0);let re=U.colorRampTexture;re||(re=U.colorRampTexture=new h.Texture(J,U.colorRamp,Y.RGBA)),re.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const le=(ye=q.skyboxMatrix,ge=U.getCenter(L,!1),we=U.paint.get("sky-gradient-radius"),Se=X,Fe=K,{u_matrix:ye,u_color_ramp:0,u_center_direction:ge,u_radius:h.degToRad(we),u_opacity:Se,u_temporal_offset:Fe});var ye,ge,we,Se,Fe;L.prepareDrawProgram(J,se),se.draw(J,Y.TRIANGLES,W,h.StencilMode.disabled,L.colorModeForRenderPass(),h.CullFaceMode.backCW,le,"skyboxGradient",U.skyboxGeometry.vertexBuffer,U.skyboxGeometry.indexBuffer,U.skyboxGeometry.segment)}(m,d,I,w,N)},debug:function(m,l,d){for(let _=0;_<d.length;_++)os(m,l,d[_])},custom:function(m,l,d,_){const b=m.context,w=d.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||"offscreen"===m.renderPass)&&d.isLayerDraped()){if("offscreen"===m.renderPass){const M=w.prerender;if(M){if(m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),"globe"===m.transform.projection.name){const T=m.transform.pointMerc;M.call(w,b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),h.globeToMercatorTransition(m.transform.zoom),[T.x,T.y],m.transform.pixelsPerMeterRatio)}else M.call(w,b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState()}}else if("translucent"===m.renderPass){if(m.terrain&&m.terrain.renderingToTexture){const T=w.renderToTile;if(T){const I=_[0].canonical,N=new h.MercatorCoordinate(I.x+_[0].wrap*(1<<I.z),I.y,I.z);b.setDepthMode(h.DepthMode.disabled),b.setStencilMode(h.StencilMode.disabled),b.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),T.call(w,b.gl,N),b.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),b.setStencilMode(h.StencilMode.disabled);const M="3d"===w.renderingMode?new h.DepthMode(m.context.gl.LEQUAL,h.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,h.DepthMode.ReadOnly);if(b.setDepthMode(M),"globe"===m.transform.projection.name){const T=m.transform.pointMerc;w.render(b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),h.globeToMercatorTransition(m.transform.zoom),[T.x,T.y],m.transform.pixelsPerMeterRatio)}else w.render(b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState(),b.bindFramebuffer.set(null)}}else h.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Lr{constructor(l,d,_=!1){this.context=new te(l,_),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=h.SourceCache.maxUnderzooming+h.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ul,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,d){const _=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ns(this,l));const b=this._terrain;this.transform.elevation=_?b:null,b.update(l,this.transform,d)}_updateFog(l){const d=l.fog;if(!d||"globe"===this.transform.projection.name||d.getOpacity(this.transform.pitch)<1||d.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,b]=d.getFovAdjustedRange(this.transform._fov);if(_>b)return void(this.transform.fogCullDistSq=null);const w=_+.78*(b-_);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,d){if(this.width=l*h.exported.devicePixelRatio,this.height=d*h.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const l=this.context,d=new h.StructArrayLayout2i4;d.emplaceBack(0,0),d.emplaceBack(h.EXTENT,0),d.emplaceBack(0,h.EXTENT),d.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(d,h.posAttributes.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);const _=new h.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(h.EXTENT,0),_.emplaceBack(0,h.EXTENT),_.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=l.createVertexBuffer(_,h.posAttributes.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);const b=new h.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(b,h.posAttributes.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);const w=new h.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(h.EXTENT,0,h.EXTENT,0),w.emplaceBack(0,h.EXTENT,0,h.EXTENT),w.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(w,h.boundsAttributes.members),this.mercatorBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);const M=new h.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(M);const T=new h.StructArrayLayout1ui2;for(const N of[0,1,3,2,0])T.emplaceBack(N);this.debugIndexBuffer=l.createIndexBuffer(T),this.emptyTexture=new h.Texture(l,new h.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=h.create();const I=this.context.gl;this.stencilClearMode=new h.StencilMode({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(h.window.performance.now()),this.atmosphereBuffer=new lo(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,d=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,d.TRIANGLES,h.DepthMode.disabled,this.stencilClearMode,h.ColorMode.disabled,h.CullFaceMode.disabled,zn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,d,_){if(!d||this.currentStencilSource===d.id||!l.isTileClipped()||!_||0===_.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let T=!1;for(const I of _)if(void 0===this._tileClippingMaskIDs[I.key]){T=!0;break}if(!T)return}this.currentStencilSource=d.id;const b=this.context,w=b.gl;this.nextStencilID+_.length>256&&this.clearStencil(),b.setColorMode(h.ColorMode.disabled),b.setDepthMode(h.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of _){const I=d.getTile(T),N=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,{tileBoundsBuffer:L,tileBoundsIndexBuffer:U,tileBoundsSegments:W}=this.getTileBoundsBuffers(I);M.draw(b,w.TRIANGLES,h.DepthMode.disabled,new h.StencilMode({func:w.ALWAYS,mask:0},N,255,w.KEEP,w.KEEP,w.REPLACE),h.ColorMode.disabled,h.CullFaceMode.disabled,zn(T.projMatrix),"$clipping",L,U,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,d=this.context.gl;return new h.StencilMode({func:d.NOTEQUAL,mask:255},l,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const d=this.context.gl;return new h.StencilMode({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(l){const d=this.context.gl,_=l.sort((M,T)=>T.overscaledZ-M.overscaledZ),b=_[_.length-1].overscaledZ,w=_[0].overscaledZ-b+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const M={};for(let T=0;T<w;T++)M[T+b]=new h.StencilMode({func:d.GEQUAL,mask:255},T+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=w,[M,_]}return[{[b]:h.StencilMode.disabled},_]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new h.ColorMode([l.CONSTANT_COLOR,l.ONE],new h.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?h.ColorMode.unblended:h.ColorMode.alphaBlended}depthModeForSublayer(l,d,_){if(!this.opaquePassEnabledForLayer())return h.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new h.DepthMode(_||this.context.gl.LEQUAL,d,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,d){this.style=l,this.options=d,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(h.exported.now()),this.imageManager.beginFrame();const _=this.style.order,b=this.style._sourceCaches;for(const N in b){const L=b[N];L.used&&L.prepare(this.context)}const w={},M={},T={};for(const N in b){const L=b[N];w[N]=L.getVisibleCoordinates(),M[N]=w[N].slice().reverse(),T[N]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let N=0;N<_.length;N++)if(this.style._layers[_[N]].is3D()){this.opaquePassCutoff=N;break}if(this.terrain&&(this.terrain.updateTileBinding(T),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new h.GlobeSharedBuffers(this.context)),!h.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const N of _){const L=this.style._layers[N],U=l._getLayerSourceCache(L);if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const W=U?M[U.id]:void 0;("custom"===L.type||L.isSky()||W&&W.length)&&this.renderLayer(this,U,L,W)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon];const I=this.terrain;if(I&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&I.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:d.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const N=this.style._layers[_[this.currentLayer]],L=l._getLayerSourceCache(N);if(N.isSky())continue;const U=L?M[L.id]:void 0;this._renderTileClippingMasks(N,L,U),this.renderLayer(this,L,N,U)}if(this.style.fog&&this.transform.projection.supportsFog&&function(N,L){const U=N.context,W=U.gl,X=N.transform,K=new h.DepthMode(W.LEQUAL,h.DepthMode.ReadOnly,[0,1]),J=N.useProgram("globeAtmosphere",null,"globe"===X.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Y=h.globeToMercatorTransition(X.zoom),q=L.properties.get("color").toArray01(),se=L.properties.get("high-color").toArray01(),re=L.properties.get("space-color").toArray01PremultipliedAlpha(),le=h.identity$1([]);h.rotateY$1(le,le,-h.degToRad(X._center.lng)),h.rotateX$1(le,le,h.degToRad(X._center.lat)),h.rotateZ$1(le,le,X.angle),h.rotateX$1(le,le,-X._pitch);const ye=h.fromQuat(new Float32Array(16),le),ge=h.mapValue(L.properties.get("star-intensity"),0,1,0,.25),Se=h.mapValue(L.properties.get("horizon-blend"),0,1,5e-4,.25),Fe=h.globeUseCustomAntiAliasing(N,U,X)&&5e-4===Se?X.worldSize/(2*Math.PI*1.025)-1:X.globeRadius,Le=N.frameCounter/1e3%1,mt=h.length(X.globeCenterInViewSpace),ke=Math.sqrt(Math.pow(mt,2)-Math.pow(Fe,2)),Ke=Math.acos(ke/mt),je={u_frustum_tl:X.frustumCorners.TL,u_frustum_tr:X.frustumCorners.TR,u_frustum_br:X.frustumCorners.BR,u_frustum_bl:X.frustumCorners.BL,u_horizon:X.frustumCorners.horizon,u_transition:Y,u_fadeout_range:Se,u_color:q,u_high_color:se,u_space_color:re,u_star_intensity:ge,u_star_size:5*h.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Le,u_horizon_angle:Ke,u_rotation_matrix:ye};N.prepareDrawProgram(U,J);const ct=N.atmosphereBuffer;ct&&J.draw(U,W.TRIANGLES,K,h.StencilMode.disabled,h.ColorMode.alphaBlended,h.CullFaceMode.backCW,je,"skybox",ct.vertexBuffer,ct.indexBuffer,ct.segments)}(this,this.style.fog),this.renderPass="sky",(h.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const N=this.style._layers[_[this.currentLayer]],L=l._getLayerSourceCache(N);N.isSky()&&this.renderLayer(this,L,N,L?M[L.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const N=this.style._layers[_[this.currentLayer]],L=l._getLayerSourceCache(N);if(N.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(N)){if(N.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const U=L?("symbol"===N.type?T:M)[L.id]:void 0;this._renderTileClippingMasks(N,L,L?w[L.id]:void 0),this.renderLayer(this,L,N,U),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let N=null;h.values(this.style._layers).forEach(L=>{const U=l._getLayerSourceCache(L);U&&!L.isHidden(this.transform.zoom)&&(!N||N.getSource().maxzoom<U.getSource().maxzoom)&&(N=U)}),N&&this.options.showTileBoundaries&&Xd.debug(this,N,N.getVisibleCoordinates())}this.options.showPadding&&function(N){const L=N.transform.padding;ss(N,N.transform.height-(L.top||0),3,Cu),ss(N,L.bottom||0,3,Do),ml(N,L.left||0,3,kr),ml(N,N.transform.width-(L.right||0),3,Xl);const U=N.transform.centerPoint;var W,X,K,J;Ai(W=N,(X=U.x)-1,(K=N.transform.height-U.y)-10,2,20,J=Aa),Ai(W,X-10,K-1,20,2,J)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(h.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,d,_,b){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||b&&b.length)&&(this.id=_.id,this.gpuTimingStart(_),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(_.type)||l.terrain&&"custom"===_.type)&&Xd[_.type](l,d,_,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const d=this.context.extTimerQuery;let _=this.gpuTimers[l.id];_||(_=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:d.createQueryEXT()}),_.calls++,d.beginQueryEXT(d.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,d=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(d),l.beginQueryEXT(l.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const d={};for(const _ in l){const b=l[_],w=this.context.extTimerQuery,M=w.getQueryObjectEXT(b.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(b.query),d[_]=M}return d}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const d=this.context.extTimerQuery;let _=0;for(const b of l)_+=d.getQueryObjectEXT(b,d.QUERY_RESULT_EXT)/1e6,d.deleteQueryEXT(b);return _}translatePosMatrix(l,d,_,b,w){if(!_[0]&&!_[1])return l;const M=w?"map"===b?this.transform.angle:0:"viewport"===b?-this.transform.angle:0;if(M){const N=Math.sin(M),L=Math.cos(M);_=[_[0]*L-_[1]*N,_[0]*N+_[1]*L]}const T=[w?_[0]:Yo(d,_[0],this.transform.zoom),w?_[1]:Yo(d,_[1],this.transform.zoom),0],I=new Float32Array(16);return h.translate(I,l,T),I}saveTileTexture(l){const d=this._tileTextures[l.size[0]];d?d.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const d=this._tileTextures[l];return d&&d.length>0?d.pop():null}isPatternMissing(l){return null===l||void 0!==l&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,d=this.terrain&&0===this.terrain.exaggeration(),_=this.style&&this.style.fog,b=[];return this.terrainRenderModeElevated()&&b.push("TERRAIN"),"globe"===this.transform.projection.name&&b.push("GLOBE"),d&&b.push("ZERO_EXAGGERATION"),_&&!l&&0!==_.getOpacity(this.transform.pitch)&&b.push("FOG"),l&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}useProgram(l,d,_){this.cache=this.cache||{};const b=_||[],w=this.currentGlobalDefines().concat(b),M=No.cacheKey(Wd[l],l,w,d);return this.cache[M]||(this.cache[M]=new No(this.context,l,Wd[l],d,Un[l],w)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,d,_){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const w=b.getOpacity(this.transform.pitch),M=((T,I,N,L,U,W,X,K,J,Y,q)=>{const se=T.transform,re=I.properties.get("color").toArray01();re[3]=L;const le=T.frameCounter/1e3%1;return{u_fog_matrix:N?se.calculateFogTileMatrix(N):T.identityMat,u_fog_range:I.getFovAdjustedRange(se._fov),u_fog_color:re,u_fog_horizon_blend:I.properties.get("horizon-blend"),u_fog_temporal_offset:le,u_frustum_tl:U,u_frustum_tr:W,u_frustum_br:X,u_frustum_bl:K,u_globe_pos:J,u_globe_radius:Y,u_viewport:q,u_globe_transition:h.globeToMercatorTransition(se.zoom),u_is_globe:+("globe"===se.projection.name)}})(this,b,_,w,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*h.exported.devicePixelRatio,this.transform.height*h.exported.devicePixelRatio]);d.setFogUniformValues(l,M)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,d=l.createTexture();return l.bindTexture(l.TEXTURE_2D,d),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),d}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&0!==l.getOpacity(this.transform.pitch)}getBackgroundTiles(){const l=this._backgroundTiles,d=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const b of _)d[b.key]=l[b.key]||new h.Tile(b,512,this.transform.tileZoom,this);return d}clearBackgroundTiles(){this._backgroundTiles={}}}class Bo{constructor(l=0,d=0,_=0,b=0){if(isNaN(l)||l<0||isNaN(d)||d<0||isNaN(_)||_<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=d,this.left=_,this.right=b}interpolate(l,d,_){return null!=d.top&&null!=l.top&&(this.top=h.number(l.top,d.top,_)),null!=d.bottom&&null!=l.bottom&&(this.bottom=h.number(l.bottom,d.bottom,_)),null!=d.left&&null!=l.left&&(this.left=h.number(l.left,d.left,_)),null!=d.right&&null!=l.right&&(this.right=h.number(l.right,d.right,_)),this}getCenter(l,d){const _=h.clamp((this.left+l-this.right)/2,0,l),b=h.clamp((this.top+d-this.bottom)/2,0,d);return new h.pointGeometry(_,b)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Bo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Eu(m,l){const d=h.getColumn(m,3);h.fromQuat(m,l),h.setColumn(m,3,d)}function ka(m,l){const d=h.identity$1([]);return h.rotateZ$1(d,d,-l),h.rotateX$1(d,d,-m),d}function Pa(m,l){const d=[m[0],m[1],0],_=[l[0],l[1],0];if(h.length(d)>=1e-15){const M=h.normalize([],d);h.scale$2(_,M,h.dot(_,M)),l[0]=_[0],l[1]=_[1]}const b=h.cross([],l,m);if(h.len(b)<1e-15)return null;const w=Math.atan2(-b[1],b[0]);return ka(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),w)}class k{constructor(l,d){this.position=l,this.orientation=d}get position(){return this._position}set position(l){if(l){const d=l instanceof h.MercatorCoordinate?l:new h.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(d.x=h.wrap(d.x,0,1)),this._position=d}else this._position=null}lookAtPoint(l,d){if(this.orientation=null,!this.position)return;const _=this.position,b=this._elevation?this._elevation.getAtPointOrZero(h.MercatorCoordinate.fromLngLat(l)):0,w=h.MercatorCoordinate.fromLngLat(l,b),M=[w.x-_.x,w.y-_.y,w.z-_.z];d||(d=[0,0,1]),d[2]=Math.abs(d[2]),this.orientation=Pa(M,d)}setPitchBearing(l,d){this.orientation=ka(h.degToRad(l),h.degToRad(-d))}}class F{constructor(l,d){this._transform=h.identity([]),this.orientation=d,this.position=l}get mercatorPosition(){const l=this.position;return new h.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=h.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var d;l&&h.setColumn(this._transform,3,[(d=l)[0],d[1],d[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||h.identity$1([]),l&&Eu(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),d=this.right();return{bearing:Math.atan2(-d[1],d[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,d){this._orientation=ka(l,d),Eu(this._transform,this._orientation)}forward(){const l=h.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=h.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=h.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,d){const _=new Float64Array(16);return h.invert(_,this.getWorldToCamera(l,d)),_}getWorldToCameraPosition(l,d,_){const b=this.position;h.scale$2(b,b,-l);const w=new Float64Array(16);return h.fromScaling(w,[_,_,_]),h.translate(w,w,b),w[10]*=d,w}getWorldToCamera(l,d){const _=new Float64Array(16),b=new Float64Array(4),w=this.position;return h.conjugate(b,this._orientation),h.scale$2(w,w,-l),h.fromQuat(_,b),h.translate(_,_,w),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=d,_[9]*=d,_[10]*=d,_[11]*=d,_}getCameraToClipPerspective(l,d,_,b){const w=new Float64Array(16);return h.perspective(w,l,d,_,b),w}getDistanceToElevation(l,d=!1){const _=0===l?0:h.mercatorZfromAltitude(l,d?h.latFromMercatorY(this.position[1]):this.position[1]),b=this.forward();return(_-this.position[2])/b[2]}clone(){return new F([...this.position],[...this.orientation])}}function G(m,l){const d=Xe(m.projection,m.zoom,m.width,m.height),_=function(w,M,T,I,N){const L=new h.LngLat(T.lng-180*an,T.lat),U=new h.LngLat(T.lng+180*an,T.lat),W=w.project(L.lng,L.lat),X=w.project(U.lng,U.lat),K=-Math.atan2(X.y-W.y,X.x-W.x),J=h.MercatorCoordinate.fromLngLat(T);J.y=h.clamp(J.y,-.999975,.999975);const Y=J.toLngLat(),q=w.project(Y.lng,Y.lat),se=h.MercatorCoordinate.fromLngLat(Y);se.x+=an;const re=se.toLngLat(),le=w.project(re.lng,re.lat),ye=Yr(le.x-q.x,le.y-q.y,K),ge=h.MercatorCoordinate.fromLngLat(Y);ge.y+=an;const we=ge.toLngLat(),Se=w.project(we.lng,we.lat),Fe=Yr(Se.x-q.x,Se.y-q.y,K),Le=Math.abs(ye.x)/Math.abs(Fe.y),mt=h.identity([]);h.rotateZ(mt,mt,-K*(1-(N?0:I)));const ke=h.identity([]);return h.scale(ke,ke,[1,1-(1-Le)*I,1]),ke[4]=-Fe.x/Fe.y*I,h.rotateZ(ke,ke,K),h.multiply(ke,mt,ke),ke}(m.projection,0,m.center,d,l),b=fe(m);return h.scale(_,_,[b,b,1]),_}function fe(m){const l=m.projection,d=Xe(m.projection,m.zoom,m.width,m.height),_=Pi(l,m.center),b=Pi(l,h.LngLat.convert(l.center));return Math.pow(2,_*d+(1-d)*b)}function Xe(m,l,d,_,b=1/0){const w=m.range;if(!w)return 0;const M=Math.min(b,Math.max(d,_)),T=Math.log(M/1024)/Math.LN2;return h.smoothstep(w[0]+T,w[1]+T,l)}const an=1/4e4;function Pi(m,l){const d=h.clamp(l.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),_=new h.LngLat(l.lng-180*an,d),b=new h.LngLat(l.lng+180*an,d),w=m.project(_.lng,d),M=m.project(b.lng,d),T=h.MercatorCoordinate.fromLngLat(_),I=h.MercatorCoordinate.fromLngLat(b),N=M.x-w.x,L=M.y-w.y,U=I.x-T.x,W=I.y-T.y,X=Math.sqrt((U*U+W*W)/(N*N+L*L));return Math.log(X)/Math.LN2}function Yr(m,l,d){const _=Math.cos(d),b=Math.sin(d);return{x:m*_-l*b,y:m*b+l*_}}class _t{constructor(l,d,_,b,w,M,T){this.tileSize=512,this._renderWorldCopies=void 0===w||w,this._minZoom=l||0,this._maxZoom=d||22,this._minPitch=_??0,this._maxPitch=b??60,this.setProjection(M),this.setMaxBounds(T),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Bo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new F,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const l=new _t(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,d=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||_)&&this._updateCameraOnTerrain(),(l||_)&&this._constrainCamera(d),this._calcMatrices()}getProjection(){return h.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const d=this.projection?this.getProjection():void 0;this.projection=h.getProjection(this.projectionOptions);const _=!Ie(d,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=h.getProjection({name:"mercator"});const d=l!==this.projection.name;return d&&this._calcMatrices(),d}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return h.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.pointGeometry(this.width,this.height)}get bearing(){return h.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const d=-l*Math.PI/180;var _,b,w,M,T,I,N,L,U,W;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(_=new h.ARRAY_TYPE(4),h.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),b=this.rotationMatrix,M=this.angle,T=(w=this.rotationMatrix)[0],I=w[1],N=w[2],L=w[3],U=Math.sin(M),W=Math.cos(M),b[0]=T*W+N*U,b[1]=I*W+L*U,b[2]=T*-U+N*W,b[3]=I*-U+L*W)}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const d=h.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=h.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const d=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._setZoom(d),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,d=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let b=0,w=0;for(let M=0;M<d.length;M++){const T=new h.pointGeometry(d[M][0]*this.width,_+d[M][1]*(this.height-_)),I=l.pointCoordinate(T);if(!I)continue;const N=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);b+=I[3]*N,w+=N}return 0===w?NaN:b/w}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const l=this._seaLevelZoom,d=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*d,b=this._mercatorZfromZoom(l),w=this._mercatorZfromZoom(this._maxZoom),M=Math.max(b-_,w);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const d=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let _;_=l.z<this._camera.position[2]?[d.x,d.y,d.z]:[l.x,l.y,l.z];const b=h.length(h.sub([],this._camera.position,_));return h.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let d=!1;if(l.orientation&&!h.exactEquals(l.orientation,this._camera.orientation)&&(d=this._setCameraOrientation(l.orientation)),l.position){const _=[l.position.x,l.position.y,l.position.z];h.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),d=!0)}d&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,d=new k;return d.position=new h.MercatorCoordinate(l[0],l[1],l[2]),d.orientation=this._camera.orientation,d._elevation=this.elevation,d._renderWorldCopies=this.renderWorldCopies,d}_setCameraOrientation(l){if(!h.length$1(l))return!1;h.normalize$1(l,l);const d=h.transformQuat([],[0,0,-1],l),_=h.transformQuat([],[0,-1,0],l);if(_[2]<0)return!1;const b=Pa(d,_);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(l){const d=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;l[2]=h.clamp(l[2],b/_,b/d),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,d,_){this._unmodified=!1,this._edgeInsets.interpolate(l,d,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const d=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(l){const d=[new h.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const _=this.pointCoordinate(new h.pointGeometry(0,0)),b=this.pointCoordinate(new h.pointGeometry(this.width,0)),w=this.pointCoordinate(new h.pointGeometry(this.width,this.height)),M=this.pointCoordinate(new h.pointGeometry(0,this.height)),T=Math.floor(Math.min(_.x,b.x,w.x,M.x)),I=Math.floor(Math.max(_.x,b.x,w.x,M.x)),N=1;for(let L=T-N;L<=I+N;L++)0!==L&&d.push(new h.UnwrappedTileID(L,l))}return d}coveringTiles(l){let d=this.coveringZoomLevel(l);const _=d,b=this.elevation&&!l.isTerrainDEM,w="mercator"===this.projection.name;if(void 0!==l.minzoom&&d<l.minzoom)return[];void 0!==l.maxzoom&&d>l.maxzoom&&(d=l.maxzoom);const M=this.locationCoordinate(this.center),T=this.center.lat,I=1<<d,N=[I*M.x,I*M.y,0],L="globe"===this.projection.name,U=!L,W=h.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d,U),X=L?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=I*h.mercatorZfromAltitude(1,this.center.lat),J=this._camera.position[2]/h.mercatorZfromAltitude(1,this.center.lat),Y=[I*X.x,I*X.y,J*(U?1:K)],q=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),se=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?d:0,re=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,le=l.isTerrainDEM?-re:this._elevation?this._elevation.getMinElevationBelowMSL():0,ye=this.projection.isReprojectedInTileSpace?fe(this):1,ge=Ne=>{const Ve=new h.MercatorCoordinate(Ne.x+25e-6,Ne.y,Ne.z),st=new h.MercatorCoordinate(Ne.x,Ne.y+25e-6,Ne.z),ut=Ne.toLngLat(),qt=Ve.toLngLat(),Fn=st.toLngLat(),Rt=this.locationCoordinate(ut),At=this.locationCoordinate(qt),Wt=this.locationCoordinate(Fn),kn=Math.hypot(At.x-Rt.x,At.y-Rt.y),Kt=Math.hypot(Wt.x-Rt.x,Wt.y-Rt.y);return Math.sqrt(kn*Kt)*ye/25e-6},we=Ne=>{const Me=re,Ve=le;return{aabb:h.tileAABB(this,I,0,0,0,Ne,Ve,Me,this.projection),zoom:0,x:0,y:0,minZ:Ve,maxZ:Me,wrap:Ne,fullyVisible:!1}},Se=[];let Fe=[];const Le=d,mt=l.reparseOverscaled?_:d,ke=Ne=>Ne*Ne,Ke=ke((J-this._centerAltitude)*K),je=Ne=>{if(!this._elevation||!Ne.tileID||!w)return;const Me=this._elevation.getMinMaxForTile(Ne.tileID),Ve=Ne.aabb;Me?(Ve.min[2]=Me.min,Ve.max[2]=Me.max,Ve.center[2]=(Ve.min[2]+Ve.max[2])/2):(Ne.shouldSplit=ct(Ne),Ne.shouldSplit||(Ve.min[2]=Ve.max[2]=Ve.center[2]=this._centerAltitude))},ct=Ne=>{if(Ne.zoom<se)return!0;if(Ne.zoom===Le)return!1;if(null!=Ne.shouldSplit)return Ne.shouldSplit;const Me=Ne.aabb.distanceX(Y),Ve=Ne.aabb.distanceY(Y);let st=Ke,ut=1;if(L){st=ke(Ne.aabb.distanceZ(Y));const Rt=Math.pow(2,Ne.zoom),At=h.latFromMercatorY((Ne.y+1)/Rt),Wt=h.latFromMercatorY(Ne.y/Rt),kn=Math.min(Math.max(T,At),Wt),Kt=h.circumferenceAtLatitude(kn)/h.circumferenceAtLatitude(T);if(ut=kn===T?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Kt/this._mercatorScaleRatio),this.zoom<=h.GLOBE_ZOOM_THRESHOLD_MIN&&Ne.zoom===Le-1&&Kt>=.9)return!0}else if(b&&(st=ke(Ne.aabb.distanceZ(Y)*K)),this.projection.isReprojectedInTileSpace&&_<=5){const Rt=Math.pow(2,Ne.zoom),At=ge(new h.MercatorCoordinate((Ne.x+.5)/Rt,(Ne.y+.5)/Rt));ut=At>.85?1:At}const qt=Me*Me+Ve*Ve+st;return qt<ke((1<<Le-Ne.zoom)*q*ut*((Rt,At)=>{if(At*ke(.707)<Rt)return 1;const Wt=Math.sqrt(At/Rt);return Wt/(1.4144271570014144+(Math.pow(1.1,Wt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(st,Ke),qt))};if(this.renderWorldCopies)for(let Ne=1;Ne<=3;Ne++)Se.push(we(-Ne)),Se.push(we(Ne));for(Se.push(we(0));Se.length>0;){const Ne=Se.pop(),Me=Ne.x,Ve=Ne.y;let st=Ne.fullyVisible;if(!st){const ut=Ne.aabb.intersects(W);if(0===ut)continue;st=2===ut}if(Ne.zoom!==Le&&ct(Ne))for(let ut=0;ut<4;ut++){const qt=(Me<<1)+ut%2,Fn=(Ve<<1)+(ut>>1),Rt={aabb:w?Ne.aabb.quadrant(ut):h.tileAABB(this,I,Ne.zoom+1,qt,Fn,Ne.wrap,Ne.minZ,Ne.maxZ,this.projection),zoom:Ne.zoom+1,x:qt,y:Fn,wrap:Ne.wrap,fullyVisible:st,tileID:void 0,shouldSplit:void 0,minZ:Ne.minZ,maxZ:Ne.maxZ};b&&!L&&(Rt.tileID=new h.OverscaledTileID(Ne.zoom+1===Le?mt:Ne.zoom+1,Ne.wrap,Ne.zoom+1,qt,Fn),je(Rt)),Se.push(Rt)}else{const ut=Ne.zoom===Le?mt:Ne.zoom;if(l.minzoom&&l.minzoom>ut)continue;const qt=N[0]-(.5+Me+(Ne.wrap<<Ne.zoom))*(1<<d-Ne.zoom),Fn=N[1]-.5-Ve,Rt=Ne.tileID?Ne.tileID:new h.OverscaledTileID(ut,Ne.wrap,Ne.zoom,Me,Ve);Fe.push({tileID:Rt,distanceSq:qt*qt+Fn*Fn})}}if(this.fogCullDistSq){const Ne=this.fogCullDistSq,Me=this.horizonLineFromTop();Fe=Fe.filter(Ve=>{const st=[0,0,0,1],ut=[h.EXTENT,h.EXTENT,0,1],qt=this.calculateFogTileMatrix(Ve.tileID.toUnwrapped());h.transformMat4$1(st,st,qt),h.transformMat4$1(ut,ut,qt);const Fn=h.getAABBPointSquareDist(st,ut);if(0===Fn)return!0;let Rt=!1;const At=this._elevation;if(At&&Fn>Ne&&0!==Me){const Wt=this.calculateProjMatrix(Ve.tileID.toUnwrapped());let kn;l.isTerrainDEM||(kn=At.getMinMaxForTile(Ve.tileID)),kn||(kn={min:le,max:re});const Kt=h.furthestTileCorner(this.rotation),gi=[Kt[0]*h.EXTENT,Kt[1]*h.EXTENT,kn.max];h.transformMat4(gi,gi,Wt),Rt=(1-gi[1])*this.height*.5<Me}return Fn<Ne||Rt})}return Fe.sort((Ne,Me)=>Ne.distanceSq-Me.distanceSq).map(Ne=>Ne.tileID)}resize(l,d){this.width=l,this.height=d,this.pixelsToGLUnits=[2/l,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const d=h.clamp(l.lat,-h.MAX_MERCATOR_LATITUDE,h.MAX_MERCATOR_LATITUDE),_=this.projection.project(l.lng,d);return new h.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/h.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,d){let _,b;const w=this.centerPoint;if("globe"===this.projection.name){const T=this.worldSize;_=(d.x-w.x)/T,b=(d.y-w.y)/T}else{const T=this.pointCoordinate(d),I=this.pointCoordinate(w);_=T.x-I.x,b=T.y-I.y}const M=this.locationCoordinate(l);this.setLocation(new h.MercatorCoordinate(M.x-_,M.y-b))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,d){const _=d?h.mercatorZfromAltitude(d,l.lat):void 0,b=this.projection.project(l.lng,l.lat);return new h.MercatorCoordinate(b.x,b.y,_)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,d){const _=d??this._centerAltitude,b=[l.x,l.y,0,1],w=[l.x,l.y,1,1];h.transformMat4$1(b,b,this.pixelMatrixInverse),h.transformMat4$1(w,w,this.pixelMatrixInverse);const M=w[3];h.scale$1(b,b,1/b[3]),h.scale$1(w,w,1/M);const T=b[2],I=w[2];return{p0:b,p1:w,t:T===I?0:(_-T)/(I-T)}}screenPointToMercatorRay(l){const d=[l.x,l.y,0,1],_=[l.x,l.y,1,1];return h.transformMat4$1(d,d,this.pixelMatrixInverse),h.transformMat4$1(_,_,this.pixelMatrixInverse),h.scale$1(d,d,1/d[3]),h.scale$1(_,_,1/_[3]),d[2]=h.mercatorZfromAltitude(d[2],this._center.lat)*this.worldSize,_[2]=h.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,h.scale$1(d,d,1/this.worldSize),h.scale$1(_,_,1/this.worldSize),new h.Ray([d[0],d[1],d[2]],h.normalize([],h.sub([],_,d)))}rayIntersectionCoordinate(l){const{p0:d,p1:_,t:b}=l,w=h.mercatorZfromAltitude(d[2],this._center.lat),M=h.mercatorZfromAltitude(_[2],this._center.lat);return new h.MercatorCoordinate(h.number(d[0],_[0],b)/this.worldSize,h.number(d[1],_[1],b)/this.worldSize,h.number(w,M,b))}pointCoordinate(l,d=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,d)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let d=this.projection.pointCoordinate3D(this,l.x,l.y);if(d)return new h.MercatorCoordinate(d[0],d[1],d[2]);let _=0,b=this.horizonLineFromTop();if(l.y>b)return this.pointCoordinate(l);const w=.02*b,M=l.clone();for(let T=0;T<10&&b-_>w;T++){M.y=h.number(_,b,.66);const I=this.projection.pointCoordinate3D(this,M.x,M.y);I?(b=M.y,d=I):_=M.y}return d?new h.MercatorCoordinate(d[0],d[1],d[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}_coordinatePoint(l,d){const _=d&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,b=[l.x*this.worldSize,l.y*this.worldSize,_+l.toAltitude(),1];return h.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new h.pointGeometry(b[0]/b[3],b[1]/b[3]):new h.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:d}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,w=this.pointLocation3D(new h.pointGeometry(d,l)),M=this.pointLocation3D(new h.pointGeometry(b,l)),T=this.pointLocation3D(new h.pointGeometry(b,_)),I=this.pointLocation3D(new h.pointGeometry(d,_));let N=Math.min(w.lng,M.lng,T.lng,I.lng),L=Math.max(w.lng,M.lng,T.lng,I.lng),U=Math.min(w.lat,M.lat,T.lat,I.lat),W=Math.max(w.lat,M.lat,T.lat,I.lat);const X=Math.pow(2,-this.zoom)/16*270,K="globe"===this.projection.name?1:4,J=(Y,q,se,re,le)=>{const ye=(Y+se)/2,ge=(q+re)/2,we=new h.pointGeometry(ye,ge),{lng:Se,lat:Fe}=this.pointLocation3D(we),Le=Math.max(0,N-Se,U-Fe,Se-L,Fe-W);N=Math.min(N,Se),L=Math.max(L,Se),U=Math.min(U,Fe),W=Math.max(W,Fe),(le<K||Le>X)&&(J(Y,q,ye,ge,le+1),J(ye,ge,se,re,le+1))};if(J(d,l,b,l,1),J(b,l,b,_,1),J(b,_,d,_,1),J(d,_,d,l,1),"globe"===this.projection.name){const[Y,q]=h.polesInViewport(this);Y?(W=90,L=180,N=-180):q&&(U=-90,L=180,N=-180)}return new h.LngLatBounds(new h.LngLat(N,U),new h.LngLat(L,W))}_getBoundsRectangular(l,d){const{top:_,left:b}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,T=new h.pointGeometry(b,_),I=new h.pointGeometry(M,_),N=new h.pointGeometry(M,w),L=new h.pointGeometry(b,w);let U=this.pointCoordinate(T,l),W=this.pointCoordinate(I,l);const X=this.pointCoordinate(N,d),K=this.pointCoordinate(L,d),J=(Y,q)=>(q.y-Y.y)/(q.x-Y.x);return U.y>1&&W.y>=0?U=new h.MercatorCoordinate((1-K.y)/J(K,U)+K.x,1):U.y<0&&W.y<=1&&(U=new h.MercatorCoordinate(-K.y/J(K,U)+K.x,0)),W.y>1&&U.y>=0?W=new h.MercatorCoordinate((1-X.y)/J(X,W)+X.x,1):W.y<0&&U.y<=1&&(W=new h.MercatorCoordinate(-X.y/J(X,W)+X.x,0)),(new h.LngLatBounds).extend(this.coordinateLocation(U)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(X))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const d=l.visibleDemTiles.reduce((_,b)=>{if(b.dem){const w=b.dem.tree;_.min=Math.min(_.min,w.minimums[0]),_.max=Math.max(_.max,w.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(d.min*l.exaggeration(),d.max*l.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const d=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-d*(1-this._horizonShift);return l?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-h.MAX_MERCATOR_LATITUDE,this.maxLat=h.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=h.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=h.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=h.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=h.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,d){return this.projection.createTileMatrix(this,d,l)}calculateDistanceTileData(l){const d=l.key,_=this._distanceTileDataCache;if(_[d])return _[d];const b=l.canonical,w=1/this.height,M=this.cameraWorldSize,T=M/this.zoomScale(b.z),I=(b.x+Math.pow(2,b.z)*l.wrap)*T,N=b.y*T,L=this.point;L.x*=M/this.worldSize,L.y*=M/this.worldSize;const U=this.angle,W=Math.sin(-U),X=-Math.cos(-U);return _[d]={bearing:[W,X],center:[(L.x-I)*w,(L.y-N)*w],scale:T/h.EXTENT*w},_[d]}calculateFogTileMatrix(l){const d=l.key,_=this._fogTileMatrixCache;if(_[d])return _[d];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return h.multiply(b,this.worldToFogMatrix,b),_[d]=new Float32Array(b),_[d]}calculateProjMatrix(l,d=!1){const _=l.key,b=d?this._alignedProjMatrixCache:this._projMatrixCache;if(b[_])return b[_];const w=this.calculatePosMatrix(l,this.worldSize);return h.multiply(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.alignedProjMatrix:this.projMatrix,w),b[_]=new Float32Array(w),b[_]}calculatePixelsToTileUnitsMatrix(l){const d=l.tileID.key,_=this._pixelsToTileUnitsCache;if(_[d])return _[d];const b=function(w,M){const{scale:T}=w.tileTransform,I=T*h.EXTENT/(w.tileSize*Math.pow(2,M.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return N=new Float32Array(4),W=(L=M.inverseAdjustmentMatrix)[1],X=L[2],K=L[3],Y=(U=[I,I])[1],N[0]=L[0]*(J=U[0]),N[1]=W*J,N[2]=X*Y,N[3]=K*Y,N;var N,L,U,W,X,K,J,Y}(l,this);return _[d]=b,_[d]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const l=1/this.worldSize,d=h.fromScaling([],[l,l,l]);return h.multiply(d,d,this.globeMatrix),d}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const l=this._elevation;this._updateCameraState();const d=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(d),b=this._camera.forward(),w=h.mercatorZfromAltitude(1,this._center.lat);_[2]/=w,b[2]/=w,h.normalize(b,b);const M=l.raycast(_,b,l.exaggeration());if(M){const T=h.scaleAndAdd([],_,b,M),I=new h.MercatorCoordinate(T[0],T[1],h.mercatorZfromAltitude(T[2],h.latFromMercatorY(T[1]))),N=(I.z+h.length([I.x-_[0],I.y-_[1],I.z-_[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const d=this._elevation,_=h.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(_),w=d.getAtPointOrZero(new h.MercatorCoordinate(...b)),M=this.pixelsPerMeter/this.worldSize*w,T=this._minimumHeightOverTerrain(),I=b[2]-M;if(I<=T)if(I<0||l){const N=this.locationCoordinate(this._center,this._centerAltitude),L=[b[0],b[1],N.z-b[2]],U=h.length(L);L[2]-=(T-I)/this._pixelsPerMercatorPixel;const W=h.length(L);if(0===W)return;h.scale$2(L,L,U/W*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],N.z*this._pixelsPerMercatorPixel-L[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const W=this.center;return W.lat=h.clamp(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(W.lng=h.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const d=this._unmodified,{x:_,y:b}=this.point;let w=0,M=_,T=b;const I=this.width/2,N=this.height/2,L=this.worldMinY*this.scale,U=this.worldMaxY*this.scale;if(b-N<L&&(T=L+N),b+N>U&&(T=U-N),U-L<this.height&&(w=Math.max(w,this.height/(U-L)),T=(U+L)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,X=this.worldMaxX*this.scale,K=this.worldSize/2-(W+X)/2;M=(_+K+this.worldSize)%this.worldSize-K,M-I<W&&(M=W+I),M+I>X&&(M=X-I),X-W<this.width&&(w=Math.max(w,this.width/(X-W)),M=(X+W)/2)}M===_&&T===b||(this.center=this.unproject(new h.pointGeometry(M,T))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=d,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,d=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=h.mercatorZfromAltitude(1,this.center.lat)/h.mercatorZfromAltitude(1,h.GLOBE_SCALE_MATCH_LATITUDE));const _=Xe(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b="meters"===this.projection.zAxisUnit?d:1,w=this._camera.getWorldToCamera(this.worldSize,b),M=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);M[8]=2*-l.x/this.width,M[9]=2*l.y/this.height;let T=h.mul([],M,w);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),we=h.identity([]);h.translate(we,we,[ge.x*this.worldSize,ge.y*this.worldSize,0]),h.multiply(we,we,G(this)),h.translate(we,we,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),h.multiply(T,T,we),this.inverseAdjustmentMatrix=function(Se){const Fe=G(Se,!0);return gt([],[Fe[0],Fe[1],Fe[4],Fe[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=h.scale([],T,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=T,this.invProjMatrix=h.invert(new Float64Array(16),this.projMatrix);const I=h.invert([],M);this.frustumCorners=h.FrustumCorners.fromInvProjectionMatrix(I,this.horizonLineFromTop(),this.height);const N=new Float32Array(16);h.identity(N),h.scale(N,N,[1,-1,1]),h.rotateX(N,N,this._pitch),h.rotateZ(N,N,this.angle);const L=h.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),U=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;L[8]=2*-l.x/this.width,L[9]=2*(l.y+U)/this.height,this.skyboxMatrix=h.multiply(N,L,N);const W=this.point,X=W.x,K=W.y,J=this.width%2/2,Y=this.height%2/2,q=Math.cos(this.angle),se=Math.sin(this.angle),re=X-Math.round(X)+q*J+se*Y,le=K-Math.round(K)+q*Y+se*J,ye=new Float64Array(T);if(h.translate(ye,ye,[re>.5?re-1:re,le>.5?le-1:le,0]),this.alignedProjMatrix=ye,T=h.create(),h.scale(T,T,[this.width/2,-this.height/2,1]),h.translate(T,T,[1,-1,0]),this.labelPlaneMatrix=T,T=h.create(),h.scale(T,T,[1,-1,1]),h.translate(T,T,[-1,-1,0]),h.scale(T,T,[2/this.width,2/this.height,1]),this.glCoordMatrix=T,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},T=h.invert(new Float64Array(16),this.pixelMatrix),!T)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=T,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=h.calculateGlobeMatrix(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=h.transformMat4(ge,ge,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=T;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,d=this.cameraPixelsPerMeter,_=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,w=[l,l,d];h.scale$2(w,w,b),h.scale$2(_,_,-1),h.multiply$2(_,_,w);const M=h.create();h.translate(M,M,_),h.scale(M,M,w),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,d,b)}_computeCameraPosition(l){const d=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),b=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*d-l/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-_[0]*w,b.y/this.worldSize-_[1]*w,l/this.worldSize*this._centerAltitude-_[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const d=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],b=l[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(w=Math.min((d-_)/b,1)),this._camera.position=h.scaleAndAdd([],this._camera.position,l,w),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,d=this._camera.forward(),{pitch:_,bearing:b}=this._camera.getPitchBearing(),w=h.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(h.degToRad(this._maxPitch)),T=Math.max((l[2]-w)/Math.cos(_),M),I=this._zoomFromMercatorZ(T);h.scaleAndAdd(l,l,d,T),this._pitch=h.clamp(_,h.degToRad(this.minPitch),h.degToRad(this.maxPitch)),this.angle=h.wrap(b,-Math.PI,Math.PI),this._setZoom(h.clamp(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new h.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let d=0,_=h.GLOBE_ZOOM_THRESHOLD_MAX,b=0,w=1/0;for(;_-d>1e-6&&_>d;){const M=d+.5*(_-d),T=this.tileSize*Math.pow(2,M),I=this.getCameraToCenterDistance(this.projection,M,T),N=this.scaleZoom(I/(l*this.tileSize)),L=Math.abs(M-N);L<w&&(w=L,b=M),M<N?d=M:_=M}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(h.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,d){const _=Math.min(l.x,d.x),b=Math.max(l.x,d.x),w=Math.min(l.y,d.y),M=Math.max(l.y,d.y);if(w<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const T=[new h.pointGeometry(_,w),new h.pointGeometry(b,M),new h.pointGeometry(_,M),new h.pointGeometry(b,w)],I=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const L of T){const U=this.pointRayIntersection(L);if(U.t<0)return!0;const W=this.rayIntersectionCoordinate(U);if(W.x<I||W.y<0||W.x>N||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+h.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new h.pointGeometry(0,0),new h.pointGeometry(this.width,this.height))}zoomDeltaToMovement(l,d){const _=h.length(h.sub([],this._camera.position,l)),b=this._zoomFromMercatorZ(_)+d;return _-this._mercatorZfromZoom(b)}getCameraPoint(){if("globe"===this.projection.name){const l=function([d,_,b],w){const M=[d,_,b,1];h.transformMat4$1(M,M,w);const T=M[3]=Math.max(M[3],1e-6);return M[0]/=T,M[1]/=T,M[2]/=T,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new h.pointGeometry(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.pointGeometry(0,l))}}getCameraToCenterDistance(l,d=this.zoom,_=this.worldSize){const b=Xe(l,d,this.width,this.height,1024),w=l.pixelSpaceConversion(this.center.lat,_,b);return.5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&h.multiply(l,l,this.globeMatrix),l}}function Xr(m,l){let d=!1,_=null;const b=()=>{_=null,d&&(m(),_=setTimeout(b,l),d=!1)};return()=>(d=!0,_||b(),_)}class od{constructor(l){this._hashName=l&&encodeURIComponent(l),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Xr(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,h.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),h.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const d=Ef(l);if(this._hashName){const _=this._hashName;let b=!1;const w=h.window.location.hash.slice(1).split("&").map(M=>{const T=M.split("=")[0];return T===_?(b=!0,`${T}=${d}`):M}).filter(M=>M);return b||w.push(`${_}=${d}`),`#${w.join("&")}`}return`#${d}`}_getCurrentHash(){const l=h.window.location.hash.replace("#","");if(this._hashName){let d;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(d=_)}),(d&&d[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const d=this._getCurrentHash();if(d.length>=3&&!d.some(_=>isNaN(_))){const _=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(d[3]||0):l.getBearing();return l.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:_,pitch:+(d[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=h.window.location.href.replace(/(#.+)?$/,this.getHashString());h.window.history.replaceState(h.window.history.state,null,l)}}function Ef(m,l){const d=m.getCenter(),_=Math.round(100*m.getZoom())/100,b=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,b),M=Math.round(d.lng*w)/w,T=Math.round(d.lat*w)/w,I=m.getBearing(),N=m.getPitch();let L=l?`/${M}/${T}/${_}`:`${_}/${T}/${M}`;return(I||N)&&(L+="/"+Math.round(10*I)/10),N&&(L+=`/${Math.round(N)}`),L}const Kd={linearity:.3,easing:h.bezier(0,0,.3,1)},sd=h.extend({deceleration:2500,maxSpeed:1400},Kd),dg=h.extend({deceleration:20,maxSpeed:1400},Kd),cp=h.extend({deceleration:1e3,maxSpeed:360},Kd),Df=h.extend({deceleration:1e3,maxSpeed:90},Kd);class ad{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,d=h.exported.now();for(;l.length>0&&d-l[0].time>160;)l.shift()}_onMoveEnd(l){if(h.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const d={zoom:0,bearing:0,pitch:0,pan:new h.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)d.zoom+=w.zoomDelta||0,d.bearing+=w.bearingDelta||0,d.pitch+=w.pitchDelta||0,w.panDelta&&d.pan._add(w.panDelta),w.around&&(d.around=w.around),w.pinchAround&&(d.pinchAround=w.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(d.pan.mag()){const w=Qd(d.pan.mag(),_,h.extend({},sd,l||{}));b.offset=d.pan.mult(w.amount/d.pan.mag()),b.center=this._map.transform.center,Du(b,w)}if(d.zoom){const w=Qd(d.zoom,_,dg);b.zoom=this._map.transform.zoom+w.amount,Du(b,w)}if(d.bearing){const w=Qd(d.bearing,_,cp);b.bearing=this._map.transform.bearing+h.clamp(w.amount,-179,179),Du(b,w)}if(d.pitch){const w=Qd(d.pitch,_,Df);b.pitch=this._map.transform.pitch+w.amount,Du(b,w)}if(b.zoom||b.bearing){const w=void 0===d.pinchAround?d.around:d.pinchAround;b.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function Du(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function Qd(m,l,d){const{maxSpeed:_,linearity:b,deceleration:w}=d,M=h.clamp(m*b/(l/1e3),-_,_),T=Math.abs(M)/(w*b);return{easing:d.easing,duration:1e3*T,amount:M*(T/2)}}class co extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_,b={}){const w=it(d.getCanvasContainer(),_),M=d.unproject(w);super(l,h.extend({point:w,lngLat:M,originalEvent:_},b)),this._defaultPrevented=!1,this.target=d}}class up extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_){const b="touchend"===l?_.changedTouches:_.touches,w=ae(d.getCanvasContainer(),b),M=w.map(I=>d.unproject(I)),T=w.reduce((I,N,L,U)=>I.add(N.div(U.length)),new h.pointGeometry(0,0));super(l,{points:w,point:T,lngLats:M,lngLat:d.unproject(T),originalEvent:_}),this._defaultPrevented=!1}}class Vc extends h.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,d,_){super(l,{originalEvent:_}),this._defaultPrevented=!1}}class Mf{constructor(l,d){this._map=l,this._clickTolerance=d.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new Vc(l.type,this._map,l))}mousedown(l,d){return this._mousedownPos=d,this._firePreventable(new co(l.type,this._map,l))}mouseup(l){this._map.fire(new co(l.type,this._map,l))}preclick(l){const d=h.extend({},l);d.type="preclick",this._map.fire(new co(d.type,this._map,d))}click(l,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||(this.preclick(l),this._map.fire(new co(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new co(l.type,this._map,l))}mouseover(l){this._map.fire(new co(l.type,this._map,l))}mouseout(l){this._map.fire(new co(l.type,this._map,l))}touchstart(l){return this._firePreventable(new up(l.type,this._map,l))}touchmove(l){this._map.fire(new up(l.type,this._map,l))}touchend(l){this._map.fire(new up(l.type,this._map,l))}touchcancel(l){this._map.fire(new up(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tr{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new co(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new co("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new co(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jd{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,d){this.isEnabled()&&l.shiftKey&&0===l.button&&(Pt(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(l,d){if(!this._active)return;const _=d,b=this._startPos,w=this._lastPos;if(!b||!w||w.equals(_)||!this._box&&_.dist(b)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=He("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const M=Math.min(b.x,_.x),T=Math.max(b.x,_.x),I=Math.min(b.y,_.y),N=Math.max(b.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${I}px)`,this._box.style.width=T-M+"px",this._box.style.height=N-I+"px")})}mouseupWindow(l,d){if(!this._active)return;const _=this._startPos,b=d;if(_&&0===l.button){if(this.reset(),en(),_.x!==b.x||_.y!==b.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:w=>w.fitScreenCoordinates(_,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),pt(),delete this._startPos,delete this._lastPos}_fireEvent(l,d){return this._map.fire(new h.Event(l,{originalEvent:d}))}}function eh(m,l){const d={};for(let _=0;_<m.length;_++)d[m[_].identifier]=l[_];return d}class Sf{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,d,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=l.timeStamp),_.length===this.numTouches&&(this.centroid=function(b){const w=new h.pointGeometry(0,0);for(const M of b)w._add(M);return w.div(b.length)}(d),this.touches=eh(_,d)))}touchmove(l,d,_){if(this.aborted||!this.centroid)return;const b=eh(_,d);for(const w in this.touches){const T=b[w];(!T||T.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(l,d,_){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class Uc{constructor(l){this.singleTap=new Sf(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,d,_){this.singleTap.touchstart(l,d,_)}touchmove(l,d,_){this.singleTap.touchmove(l,d,_)}touchend(l,d,_){const b=this.singleTap.touchend(l,d,_);if(b){const w=l.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(b)<30;if(w&&M||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class th{constructor(){this._zoomIn=new Uc({numTouches:1,numTaps:2}),this._zoomOut=new Uc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,d,_){this._zoomIn.touchstart(l,d,_),this._zoomOut.touchstart(l,d,_)}touchmove(l,d,_){this._zoomIn.touchmove(l,d,_),this._zoomOut.touchmove(l,d,_)}touchend(l,d,_){const b=this._zoomIn.touchend(l,d,_),w=this._zoomOut.touchend(l,d,_);return b?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(b)},{originalEvent:l})}):w?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(w)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Tf={0:1,2:2};class Mu{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,d){return!1}_move(l,d){return{}}mousedown(l,d){if(this._lastPoint)return;const _=De(l);this._correctButton(l,_)&&(this._lastPoint=d,this._eventButton=_)}mousemoveWindow(l,d){const _=this._lastPoint;if(_)if(l.preventDefault(),null!=this._eventButton&&function(b,w){const M=Tf[w];return void 0===b.buttons||(b.buttons&M)!==M}(l,this._eventButton))this.reset();else if(this._moved||!(d.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=d,this._move(_,d)}mouseupWindow(l){this._lastPoint&&De(l)===this._eventButton&&(this._moved&&en(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Af extends Mu{mousedown(l,d){super.mousedown(l,d),this._lastPoint&&(this._active=!0)}_correctButton(l,d){return 0===d&&!l.ctrlKey}_move(l,d){return{around:d,panDelta:d.sub(l)}}}class as extends Mu{_correctButton(l,d){return 0===d&&l.ctrlKey||2===d}_move(l,d){const _=.8*(d.x-l.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(l){l.preventDefault()}}class nh extends Mu{_correctButton(l,d){return 0===d&&l.ctrlKey||2===d}_move(l,d){const _=-.5*(d.y-l.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(l){l.preventDefault()}}class jc{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=d.clickTolerance||1,this.reset(),h.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new h.pointGeometry(0,0)}touchstart(l,d,_){return this._calculateTransform(l,d,_)}touchmove(l,d,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===_.length&&!h.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,d,_)}}touchend(l,d,_){this._calculateTransform(l,d,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,d,_){_.length>0&&(this._active=!0);const b=eh(_,d),w=new h.pointGeometry(0,0),M=new h.pointGeometry(0,0);let T=0;for(const N in b){const L=b[N],U=this._touches[N];U&&(w._add(L),M._add(L.sub(U)),T++,b[N]=L)}if(this._touches=b,T<this._minTouches||!M.mag())return;const I=M.div(T);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(T),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=He("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Pr{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,d,_){return{}}touchstart(l,d,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([d[0],d[1]]))}touchmove(l,d,_){const b=this._firstTwoTouches;if(!b)return;l.preventDefault();const[w,M]=b,T=ld(_,d,w),I=ld(_,d,M);if(!T||!I)return;const N=this._aroundCenter?null:T.add(I).div(2);return this._move([T,I],N,l)}touchend(l,d,_){if(!this._firstTwoTouches)return;const[b,w]=this._firstTwoTouches,M=ld(_,d,b),T=ld(_,d,w);M&&T||(this._active&&en(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ld(m,l,d){for(let _=0;_<m.length;_++)if(m[_].identifier===d)return l[_]}function cd(m,l){return Math.log(m/l)/Math.LN2}class ls extends Pr{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,d){const _=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(cd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cd(this._distance,_),pinchAround:d}}}function dp(m,l){return 180*m.angleWith(l)/Math.PI}class hp extends Pr{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,d){const _=this._vector;if(this._vector=l[0].sub(l[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:dp(this._vector,_),pinchAround:d}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const d=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const b=dp(l,_);return Math.abs(b)<d}}function gl(m){return Math.abs(m.y)>Math.abs(m.x)}class ji extends Pr{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,gl(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,d,_){const b=this._lastPoints;if(!b)return;const w=l[0].sub(b[0]),M=l[1].sub(b[1]);return this._map._cooperativeGestures&&!h.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(w,M,_.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(w.y+M.y)/2*-.5})}gestureBeginsVertically(l,d,_){if(void 0!==this._valid)return this._valid;const b=l.mag()>=2,w=d.mag()>=2;if(!b&&!w)return;if(!b||!w)return null==this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const M=l.y>0==d.y>0;return gl(l)&&gl(d)&&M}}const hg={panStep:100,bearingStep:15,pitchStep:10};class ud{constructor(){const l=hg;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let d=0,_=0,b=0,w=0,M=0;switch(l.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:l.shiftKey?_=-1:(l.preventDefault(),w=-1);break;case 39:l.shiftKey?_=1:(l.preventDefault(),w=1);break;case 38:l.shiftKey?b=1:(l.preventDefault(),M=-1);break;case 40:l.shiftKey?b=-1:(l.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(_=0,b=0),{cameraAnimation:T=>{const I=T.getZoom();T.easeTo({duration:300,easeId:"keyboardHandler",easing:pg,zoom:d?Math.round(I)+d*(l.shiftKey?2:1):I,bearing:T.getBearing()+_*this._bearingStep,pitch:T.getPitch()+b*this._pitchStep,offset:[-w*this._panStep,-M*this._panStep],center:T.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function pg(m){return m*(2-m)}const _l=4.000244140625;class Ra{constructor(l,d){this._map=l,this._el=l.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,h.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||h.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let d=l.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const _=h.exported.now(),b=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==d&&d%_l==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(b*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),l.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=l,this._delta-=d,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=it(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:d,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;"wheel"===this._type&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const d=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(0!==this._delta){const I="wheel"===this._type&&Math.abs(this._delta)>_l?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&0!==N&&(N=1/N);const L=d(),U=Math.pow(2,L),W="number"==typeof this._targetZoom?l.zoomScale(this._targetZoom):U;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(W*N))),"wheel"===this._type&&(this._startZoom=L,this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:d(),b=this._startZoom,w=this._easing;let M,T=!1;if("wheel"===this._type&&b&&w){const I=Math.min((h.exported.now()-this._lastWheelEventTime)/200,1),N=w(I);M=h.number(b,_,N),I<1?this._frameId||(this._frameId=!0):T=!0}else M=_,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:M-d(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let d=h.ease;if(this._prevEase){const _=this._prevEase,b=(h.exported.now()-_.start)/_.duration,w=_.easing(b+.01)-_.easing(b),M=.27/Math.sqrt(w*w+1e-4)*.01,T=Math.sqrt(.0729-M*M);d=h.bezier(M,T,.25,1)}return this._prevEase={start:h.exported.now(),duration:l,easing:d},d}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=He("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(h.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ih{constructor(l,d){this._clickZoom=l,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class En{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,d){return l.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(l.shiftKey?-1:1),around:_.unproject(d)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oa{constructor(){this._tap=new Uc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,d,_){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=d[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(l,d,_))}touchmove(l,d,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const b=d[0],w=b.y-this._swipePoint.y;return this._swipePoint=b,l.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(l,d,_)}touchend(l,d,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(l,d,_)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pp{constructor(l,d,_){this._el=l,this._mousePan=d,this._touchPan=_}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ot{constructor(l,d,_){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=d,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class If{constructor(l,d,_,b){this._el=l,this._touchZoom=d,this._touchRotate=_,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const dd=m=>m.zoom||m.drag||m.pitch||m.rotate;class Su extends h.Event{}class hd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,d){const _=h.sub([],d,l);this.radius=h.length(_[2]<0?h.div([],_,this.constants):[_[0],_[1],0])}projectRay(l){h.div(l,l,this.constants),h.normalize(l,l),h.mul$1(l,l,this.constants);const d=h.scale$2([],l,this.radius);if(d[2]>0){const _=h.scale$2([],[0,0,1],h.dot(d,[0,0,1])),b=h.scale$2([],h.normalize([],[d[0],d[1],0]),this.radius),w=h.add([],d,h.scale$2([],h.sub([],h.add([],b,_),d),2));d[0]=w[0],d[1]=w[1]}return d}}function pd(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class ft{constructor(l,d){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ad(l),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new hd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(d),h.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[h.window,"blur",void 0]];for(const[b,w,M]of this._listeners)b.addEventListener(w,b===h.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[l,d,_]of this._listeners)l.removeEventListener(d,l===h.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(l){const d=this._map,_=d.getCanvasContainer();this._add("mapEvent",new Mf(d,l));const b=d.boxZoom=new Jd(d,l);this._add("boxZoom",b);const w=new th,M=new En;d.doubleClickZoom=new ih(M,w),this._add("tapZoom",w),this._add("clickZoom",M);const T=new oa;this._add("tapDragZoom",T);const I=d.touchPitch=new ji(d);this._add("touchPitch",I);const N=new as(l),L=new nh(l);d.dragRotate=new Ot(l,N,L),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",L,["mouseRotate"]);const U=new Af(l),W=new jc(d,l);d.dragPan=new pp(_,U,W),this._add("mousePan",U),this._add("touchPan",W,["touchZoom","touchRotate"]);const X=new hp,K=new ls;d.touchZoomRotate=new If(_,K,X,T),this._add("touchRotate",X,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new tr(d));const J=d.scrollZoom=new Ra(d,this);this._add("scrollZoom",J,["mousePan"]);const Y=d.keyboard=new ud;this._add("keyboard",Y);for(const q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[q]&&d[q].enable(l[q])}_add(l,d,_){this._handlers.push({handlerName:l,handler:d,allowed:_}),this._handlersById[l]=d}stop(l){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!dd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,d,_){for(const b in l)if(b!==_&&(!d||d.indexOf(b)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const d=[];for(const _ of l)this._el.contains(_.target)&&d.push(_);return d}handleEvent(l,d){this._updatingCamera=!0;const _="renderFrame"===l.type,b=_?void 0:l,w={needsRenderFrame:!1},M={},T={},I=l.touches?this._getMapTouches(l.touches):void 0,N=I?ae(this._el,I):_?void 0:it(this._el,l);for(const{handlerName:W,handler:X,allowed:K}of this._handlers){if(!X.isEnabled())continue;let J;this._blockedByActive(T,K,W)?X.reset():X[d||l.type]&&(J=X[d||l.type](l,N,I),this.mergeHandlerResult(w,M,J,W,b),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||X.isActive())&&(T[W]=X)}const L={};for(const W in this._previousActiveHandlers)T[W]||(L[W]=b);this._previousActiveHandlers=T,(Object.keys(L).length||pd(w))&&(this._changes.push([w,M,L]),this._triggerRenderFrame()),(Object.keys(T).length||pd(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=w;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))}mergeHandlerResult(l,d,_,b,w){if(!_)return;h.extend(l,_);const M={handlerName:b,originalEvent:_.originalEvent||w};void 0!==_.zoomDelta&&(d.zoom=M),void 0!==_.panDelta&&(d.drag=M),void 0!==_.pitchDelta&&(d.pitch=M),void 0!==_.bearingDelta&&(d.rotate=M)}_applyChanges(){const l={},d={},_={};for(const[b,w,M]of this._changes)b.panDelta&&(l.panDelta=(l.panDelta||new h.pointGeometry(0,0))._add(b.panDelta)),b.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+b.pitchDelta),void 0!==b.around&&(l.around=b.around),void 0!==b.aroundCoord&&(l.aroundCoord=b.aroundCoord),void 0!==b.pinchAround&&(l.pinchAround=b.pinchAround),b.noInertia&&(l.noInertia=b.noInertia),h.extend(d,w),h.extend(_,M);this._updateMapTransform(l,d,_),this._changes=[]}_updateMapTransform(l,d,_){const b=this._map,w=b.transform,M=se=>[se.x,se.y,se.z];if((se=>{const re=this._eventsInProgress.drag;return re&&!this._handlersById[re.handlerName].isActive()})()&&!pd(l)){const se=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",se!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&b._stop(!0),!pd(l))return void this._fireEvents(d,_,!0);let{panDelta:T,zoomDelta:I,bearingDelta:N,pitchDelta:L,around:U,aroundCoord:W,pinchAround:X}=l;w._isCameraConstrained&&(I>0&&(I=0),w._isCameraConstrained=!1),void 0!==X&&(U=X),(I||(se=>d.drag&&!this._eventsInProgress.drag)())&&U&&(this._dragOrigin=M(w.pointCoordinate3D(U)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",b._stop(!0),U=U||b.transform.centerPoint,N&&(w.bearing+=N),L&&(w.pitch+=L),w._updateCameraState();const K=[0,0,0];if(T)if("mercator"===w.projection.name){const se=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(U).dir),re=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(U.sub(T)).dir);K[0]=re[0]-se[0],K[1]=re[1]-se[1]}else{const se=w.pointCoordinate(U);if("globe"===w.projection.name){T=T.rotate(-w.angle);const re=w._pixelsPerMercatorPixel/w.worldSize;K[0]=-T.x*h.mercatorScale(h.latFromMercatorY(se.y))*re,K[1]=-T.y*h.mercatorScale(w.center.lat)*re}else{const re=w.pointCoordinate(U.sub(T));se&&re&&(K[0]=re.x-se.x,K[1]=re.y-se.y)}}const J=w.zoom,Y=[0,0,0];if(I){const se=M(W||w.pointCoordinate3D(U)),re={dir:h.normalize([],h.sub([],se,w._camera.position))};if(re.dir[2]<0){const le=w.zoomDeltaToMovement(se,I);h.scale$2(Y,re.dir,le)}}const q=h.add(K,K,Y);w._translateCameraConstrained(q),I&&Math.abs(w.zoom-J)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(d,_,!0)}_fireEvents(l,d,_){const b=dd(this._eventsInProgress),w=dd(l),M={};for(const L in l){const{originalEvent:U}=l[L];this._eventsInProgress[L]||(M[`${L}start`]=U),this._eventsInProgress[L]=l[L]}!b&&w&&this._fireEvent("movestart",w.originalEvent);for(const L in M)this._fireEvent(L,M[L]);w&&this._fireEvent("move",w.originalEvent);for(const L in l){const{originalEvent:U}=l[L];this._fireEvent(L,U)}const T={};let I;for(const L in this._eventsInProgress){const{handlerName:U,originalEvent:W}=this._eventsInProgress[L];this._handlersById[U].isActive()||(delete this._eventsInProgress[L],I=d[U]||W,T[`${L}end`]=I)}for(const L in T)this._fireEvent(L,T[L]);const N=dd(this._eventsInProgress);if(_&&(b||w)&&!N){this._updatingCamera=!0;const L=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),U=W=>0!==W&&-this._bearingSnap<W&&W<this._bearingSnap;L?(U(L.bearing||this._map.getBearing())&&(L.bearing=0),this._map.easeTo(L,{originalEvent:I})):(this._map.fire(new h.Event("moveend",{originalEvent:I})),U(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,d){this._map.fire(new h.Event(l,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new Su("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ui="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class uo extends h.Evented{constructor(l,d){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=d.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}getCenter(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,d){return this.jumpTo({center:l},d)}panBy(l,d,_){return l=h.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,h.extend({offset:l},d),_)}panTo(l,d,_){return this.easeTo(h.extend({center:l},d),_)}getZoom(){return this.transform.zoom}setZoom(l,d){return this.jumpTo({zoom:l},d),this}zoomTo(l,d,_){return this.easeTo(h.extend({zoom:l},d),_)}zoomIn(l,d){return this.zoomTo(this.getZoom()+1,l,d),this}zoomOut(l,d){return this.zoomTo(this.getZoom()-1,l,d),this}getBearing(){return this.transform.bearing}setBearing(l,d){return this.jumpTo({bearing:l},d),this}getPadding(){return this.transform.padding}setPadding(l,d){return this.jumpTo({padding:l},d),this}rotateTo(l,d,_){return this.easeTo(h.extend({bearing:l},d),_)}resetNorth(l,d){return this.rotateTo(0,h.extend({duration:1e3},l),d),this}resetNorthPitch(l,d){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},l),d),this}snapToNorth(l,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,d):this}getPitch(){return this.transform.pitch}setPitch(l,d){return this.jumpTo({pitch:l},d),this}cameraForBounds(l,d){l=h.LngLatBounds.convert(l);const _=d&&d.bearing||0,b=d&&d.pitch||0,w=l.getNorthWest(),M=l.getSouthEast();return this._cameraForBounds(this.transform,w,M,_,b,d)}_extendCameraOptions(l){const d={top:0,bottom:0,right:0,left:0};if("number"==typeof(l=h.extend({padding:d,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding){const _=l.padding;l.padding={top:_,bottom:_,right:_,left:_}}return l.padding=h.extend(d,l.padding),l}_minimumAABBFrustumDistance(l,d){const _=d.max[0]-d.min[0],b=d.max[1]-d.min[1];return _/b>l.aspect?_/(2*Math.tan(.5*l.fovX)*l.aspect):b/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,d,_,b,w,M){const T=l.clone(),I=this._extendCameraOptions(M);T.bearing=b,T.pitch=w;const N=h.LngLat.convert(d),L=h.LngLat.convert(_),U=.5*(N.lat+L.lat),W=.5*(N.lng+L.lng),X=h.latLngToECEF(U,W),K=h.normalize([],X),J=h.normalize([],h.cross([],K,[0,1,0])),Y=h.cross([],J,K),q=[J[0],J[1],J[2],0,Y[0],Y[1],Y[2],0,K[0],K[1],K[2],0,0,0,0,1],se=[X,h.latLngToECEF(N.lat,N.lng),h.latLngToECEF(L.lat,N.lng),h.latLngToECEF(L.lat,L.lng),h.latLngToECEF(N.lat,L.lng),h.latLngToECEF(U,N.lng),h.latLngToECEF(U,L.lng),h.latLngToECEF(N.lat,W),h.latLngToECEF(L.lat,W)];let re=h.Aabb.fromPoints(se.map(st=>[h.dot(J,st),h.dot(Y,st),h.dot(K,st)]));const le=h.transformMat4([],re.center,q);0===h.squaredLength(le)&&h.set(le,0,0,1),h.normalize(le,le),h.scale$2(le,le,h.GLOBE_RADIUS),T.center=h.ecefToLatLng(le);const ye=T.getWorldToCameraMatrix(),ge=h.invert(new Float64Array(16),ye);re=h.Aabb.applyTransform(re,h.multiply([],ye,q)),h.transformMat4(le,le,ye);const we=.5*(re.max[2]-re.min[2]),Se=this._minimumAABBFrustumDistance(T,re),Fe=h.scale$2([],[0,0,1],we),Le=h.add(Fe,le,Fe),mt=Se+(0===T.pitch?0:h.distance(le,Le)),ke=T.globeCenterInViewSpace,Ke=h.sub([],le,[ke[0],ke[1],ke[2]]);h.normalize(Ke,Ke),h.scale$2(Ke,Ke,mt);const je=h.add([],le,Ke);h.transformMat4(je,je,ge);const ct=h.earthRadius/h.GLOBE_RADIUS,Ne=h.length(je),Me=h.mercatorZfromAltitude(Math.max(Ne*ct-h.earthRadius,Number.EPSILON),0),Ve=Math.min(T.zoomFromMercatorZAdjusted(Me),I.maxZoom);return Ve>.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(T.setProjection({name:"mercator"}),T.zoom=Ve,this._cameraForBounds(T,d,_,b,w,M)):{center:T.center,zoom:Ve,bearing:b,pitch:w}}queryTerrainElevation(l,d){const _=this.transform.elevation;return _?(d=h.extend({},{exaggerated:!0},d),_.getAtPoint(h.MercatorCoordinate.fromLngLat(l),null,d.exaggerated)):null}_cameraForBounds(l,d,_,b,w,M){if("globe"===l.projection.name)return this._cameraForBoundsOnGlobe(l,d,_,b,w,M);const T=l.clone(),I=this._extendCameraOptions(M),N=T.padding;T.bearing=b,T.pitch=w;const L=h.LngLat.convert(d),U=h.LngLat.convert(_),W=new h.LngLat(L.lng,U.lat),X=new h.LngLat(U.lng,L.lat),K=T.project(L),J=T.project(U),Y=this.queryTerrainElevation(L),q=this.queryTerrainElevation(U),se=this.queryTerrainElevation(W),re=this.queryTerrainElevation(X),le=[[K.x,K.y,Math.min(Y||0,q||0,se||0,re||0)],[J.x,J.y,Math.max(Y||0,q||0,se||0,re||0)]];let ye=h.Aabb.fromPoints(le);const ge=T.getWorldToCameraMatrix(),we=h.invert(new Float64Array(16),ge);ye=h.Aabb.applyTransform(ye,ge);const Se=h.sub([],ye.max,ye.min),Fe=N.left||0,Le=N.right||0,mt=N.bottom||0,ke=N.top||0,{left:Ke,right:je,top:ct,bottom:Ne}=I.padding,Me=.5*(Fe+Le),Ve=.5*(ke+mt),st=Math.min(T.scaleZoom(T.scale*Math.min((T.width-(Fe+Le+Ke+je))/Se[0],(T.height-(mt+ke+Ne+ct))/Se[1])),I.maxZoom),ut=T.scale/T.zoomScale(st);ye=new h.Aabb([ye.min[0]-(Ke+Me)*ut,ye.min[1]-(Ne+Ve)*ut,ye.min[2]],[ye.max[0]+(je+Me)*ut,ye.max[1]+(ct+Ve)*ut,ye.max[2]]);const qt=.5*Se[2],Fn=this._minimumAABBFrustumDistance(T,ye),Rt=[0,0,1,0];h.transformMat4$1(Rt,Rt,ge),h.normalize$2(Rt,Rt);const At=h.scale$2([],Rt,Fn+qt),Wt=h.add([],ye.center,At),kn=("number"==typeof I.offset.x&&"number"==typeof I.offset.y?new h.pointGeometry(I.offset.x,I.offset.y):h.pointGeometry.convert(I.offset)).rotate(-h.degToRad(b));ye.center[0]-=kn.x*ut,ye.center[1]+=kn.y*ut,h.transformMat4(ye.center,ye.center,we),h.transformMat4(Wt,Wt,we);const Kt=[ye.center[0],ye.center[1],Wt[2]*T.pixelsPerMeter];h.scale$2(Kt,Kt,1/T.worldSize);const gi=h.lngFromMercatorX(Kt[0]),di=h.latFromMercatorY(Kt[1]),$i=Math.min(T._zoomFromMercatorZ(Kt[2]),I.maxZoom),Di=new h.LngLat(gi,di);return T.mercatorFromTransition&&$i<.5*(h.GLOBE_ZOOM_THRESHOLD_MIN+h.GLOBE_ZOOM_THRESHOLD_MAX)?(T.setProjection({name:"globe"}),T.zoom=$i,this._cameraForBounds(T,d,_,b,w,M)):{center:Di,zoom:$i,bearing:b,pitch:w}}fitBounds(l,d,_){const b=this.cameraForBounds(l,d);return this._fitInternal(b,d,_)}fitScreenCoordinates(l,d,_,b,w){const M=h.pointGeometry.convert(l),T=h.pointGeometry.convert(d),I=new h.pointGeometry(Math.min(M.x,T.x),Math.min(M.y,T.y)),N=new h.pointGeometry(Math.max(M.x,T.x),Math.max(M.y,T.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(M,T))return this;const L=this.transform.pointLocation3D(I),U=this.transform.pointLocation3D(N),W=this.transform.pointLocation3D(new h.pointGeometry(I.x,N.y)),X=this.transform.pointLocation3D(new h.pointGeometry(N.x,I.y)),K=[Math.min(L.lng,U.lng,W.lng,X.lng),Math.min(L.lat,U.lat,W.lat,X.lat)],J=[Math.max(L.lng,U.lng,W.lng,X.lng),Math.max(L.lat,U.lat,W.lat,X.lat)],Y=b&&b.pitch?b.pitch:this.getPitch(),q=this._cameraForBounds(this.transform,K,J,_,Y,b);return this._fitInternal(q,b,w)}_fitInternal(l,d,_){return l?(delete(d=h.extend(l,d)).padding,d.linear?this.easeTo(d,_):this.flyTo(d,_)):this}jumpTo(l,d){this.stop();const _=l.preloadOnly?this.transform.clone():this.transform;let b=!1,w=!1,M=!1;return"zoom"in l&&_.zoom!==+l.zoom&&(b=!0,_.zoom=+l.zoom),void 0!==l.center&&(_.center=h.LngLat.convert(l.center)),"bearing"in l&&_.bearing!==+l.bearing&&(w=!0,_.bearing=+l.bearing),"pitch"in l&&_.pitch!==+l.pitch&&(M=!0,_.pitch=+l.pitch),null==l.padding||_.isPaddingEqual(l.padding)||(_.padding=l.padding),l.preloadOnly?(this._preloadTiles(_),this):(this.fire(new h.Event("movestart",d)).fire(new h.Event("move",d)),b&&this.fire(new h.Event("zoomstart",d)).fire(new h.Event("zoom",d)).fire(new h.Event("zoomend",d)),w&&this.fire(new h.Event("rotatestart",d)).fire(new h.Event("rotate",d)).fire(new h.Event("rotateend",d)),M&&this.fire(new h.Event("pitchstart",d)).fire(new h.Event("pitch",d)).fire(new h.Event("pitchend",d)),this.fire(new h.Event("moveend",d)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||h.warnOnce(ui),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,d){const _=this.transform;if(!_.projection.supportsFreeCamera)return h.warnOnce(ui),this;this.stop();const b=_.zoom,w=_.pitch,M=_.bearing;_.setFreeCameraOptions(l);const T=b!==_.zoom,I=w!==_.pitch,N=M!==_.bearing;return this.fire(new h.Event("movestart",d)).fire(new h.Event("move",d)),T&&this.fire(new h.Event("zoomstart",d)).fire(new h.Event("zoom",d)).fire(new h.Event("zoomend",d)),N&&this.fire(new h.Event("rotatestart",d)).fire(new h.Event("rotate",d)).fire(new h.Event("rotateend",d)),I&&this.fire(new h.Event("pitchstart",d)).fire(new h.Event("pitch",d)).fire(new h.Event("pitchend",d)),this.fire(new h.Event("moveend",d)),this}easeTo(l,d){this._stop(!1,l.easeId),(!1===(l=h.extend({offset:[0,0],duration:500,easing:h.ease},l)).animate||!l.essential&&h.exported.prefersReducedMotion)&&(l.duration=0);const _=this.transform,b=this.getZoom(),w=this.getBearing(),M=this.getPitch(),T=this.getPadding(),I="zoom"in l?+l.zoom:b,N="bearing"in l?this._normalizeBearing(l.bearing,w):w,L="pitch"in l?+l.pitch:M,U="padding"in l?l.padding:_.padding,W=h.pointGeometry.convert(l.offset);let X,K,J;if("globe"===_.projection.name){const Fe=h.MercatorCoordinate.fromLngLat(_.center),Le=W.rotate(-_.angle);Fe.x+=Le.x/_.worldSize,Fe.y+=Le.y/_.worldSize;const mt=Fe.toLngLat(),ke=h.LngLat.convert(l.center||mt);this._normalizeCenter(ke),X=_.centerPoint.add(Le),K=new h.pointGeometry(Fe.x,Fe.y).mult(_.worldSize),J=new h.pointGeometry(h.mercatorXfromLng(ke.lng),h.mercatorYfromLat(ke.lat)).mult(_.worldSize).sub(K)}else{X=_.centerPoint.add(W);const Fe=_.pointLocation(X),Le=h.LngLat.convert(l.center||Fe);this._normalizeCenter(Le),K=_.project(Fe),J=_.project(Le).sub(K)}const Y=_.zoomScale(I-b);let q,se;l.around&&(q=h.LngLat.convert(l.around),se=_.locationPoint(q));const re=this._zooming||I!==b,le=this._rotating||w!==N,ye=this._pitching||L!==M,ge=!_.isPaddingEqual(U),we=Fe=>Le=>{if(re&&(Fe.zoom=h.number(b,I,Le)),le&&(Fe.bearing=h.number(w,N,Le)),ye&&(Fe.pitch=h.number(M,L,Le)),ge&&(Fe.interpolatePadding(T,U,Le),X=Fe.centerPoint.add(W)),q)Fe.setLocationAtPoint(q,se);else{const mt=Fe.zoomScale(Fe.zoom-b),ke=I>b?Math.min(2,Y):Math.max(.5,Y),Ke=Math.pow(ke,1-Le),je=Fe.unproject(K.add(J.mult(Le*Ke)).mult(mt));Fe.setLocationAtPoint(Fe.renderWorldCopies?je.wrap():je,X)}return l.preloadOnly||this._fireMoveEvents(d),Fe};if(l.preloadOnly){const Fe=this._emulate(we,l.duration,_);return this._preloadTiles(Fe),this}const Se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=re,this._rotating=le,this._pitching=ye,this._padding=ge,this._easeId=l.easeId,this._prepareEase(d,l.noMoveStart,Se),this._ease(we(_),Fe=>{_.recenterOnTerrain(),this._afterEase(d,Fe)},l),this}_prepareEase(l,d,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",d||_.moving||this.fire(new h.Event("movestart",l)),this._zooming&&!_.zooming&&this.fire(new h.Event("zoomstart",l)),this._rotating&&!_.rotating&&this.fire(new h.Event("rotatestart",l)),this._pitching&&!_.pitching&&this.fire(new h.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new h.Event("move",l)),this._zooming&&this.fire(new h.Event("zoom",l)),this._rotating&&this.fire(new h.Event("rotate",l)),this._pitching&&this.fire(new h.Event("pitch",l))}_afterEase(l,d){if(this._easeId&&d&&this._easeId===d)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,b=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new h.Event("zoomend",l)),b&&this.fire(new h.Event("rotateend",l)),w&&this.fire(new h.Event("pitchend",l)),this.fire(new h.Event("moveend",l))}flyTo(l,d){if(!l.essential&&h.exported.prefersReducedMotion){const st=h.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(st,d)}this.stop(),l=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},l);const _=this.transform,b=this.getZoom(),w=this.getBearing(),M=this.getPitch(),T=this.getPadding(),I="zoom"in l?h.clamp(+l.zoom,_.minZoom,_.maxZoom):b,N="bearing"in l?this._normalizeBearing(l.bearing,w):w,L="pitch"in l?+l.pitch:M,U="padding"in l?l.padding:_.padding,W=_.zoomScale(I-b),X=h.pointGeometry.convert(l.offset);let K=_.centerPoint.add(X);const J=_.pointLocation(K),Y=h.LngLat.convert(l.center||J);this._normalizeCenter(Y);const q=_.project(J),se=_.project(Y).sub(q);let re=l.curve;const le=Math.max(_.width,_.height),ye=le/W,ge=se.mag();if("minZoom"in l){const st=h.clamp(Math.min(l.minZoom,b,I),_.minZoom,_.maxZoom),ut=le/_.zoomScale(st-b);re=Math.sqrt(ut/ge*2)}const we=re*re;function Se(st){const ut=(ye*ye-le*le+(st?-1:1)*we*we*ge*ge)/(2*(st?ye:le)*we*ge);return Math.log(Math.sqrt(ut*ut+1)-ut)}function Fe(st){return(Math.exp(st)-Math.exp(-st))/2}function Le(st){return(Math.exp(st)+Math.exp(-st))/2}const mt=Se(0);let ke=function(st){return Le(mt)/Le(mt+re*st)},Ke=function(st){return le*((Le(mt)*(Fe(ut=mt+re*st)/Le(ut))-Fe(mt))/we)/ge;var ut},je=(Se(1)-mt)/re;if(Math.abs(ge)<1e-6||!isFinite(je)){if(Math.abs(le-ye)<1e-6)return this.easeTo(l,d);const st=ye<le?-1:1;je=Math.abs(Math.log(ye/le))/re,Ke=function(){return 0},ke=function(ut){return Math.exp(st*re*ut)}}l.duration="duration"in l?+l.duration:1e3*je/("screenSpeed"in l?+l.screenSpeed/re:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const ct=w!==N,Ne=L!==M,Me=!_.isPaddingEqual(U),Ve=st=>ut=>{const qt=ut*je,Fn=1/ke(qt);st.zoom=1===ut?I:b+st.scaleZoom(Fn),ct&&(st.bearing=h.number(w,N,ut)),Ne&&(st.pitch=h.number(M,L,ut)),Me&&(st.interpolatePadding(T,U,ut),K=st.centerPoint.add(X));const Rt=1===ut?Y:st.unproject(q.add(se.mult(Ke(qt))).mult(Fn));return st.setLocationAtPoint(st.renderWorldCopies?Rt.wrap():Rt,K),st._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(d),st};if(l.preloadOnly){const st=this._emulate(Ve,l.duration,_);return this._preloadTiles(st),this}return this._zooming=!0,this._rotating=ct,this._pitching=Ne,this._padding=Me,this._prepareEase(d,!1),this._ease(Ve(_),()=>this._afterEase(d),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,d)}if(!l){const _=this.handlers;_&&_.stop(!1)}return this}_ease(l,d,_){!1===_.animate||0===_.duration?(l(1),d()):(this._easeStart=h.exported.now(),this._easeOptions=_,this._onEaseFrame=l,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((h.exported.now()-this._easeStart)/this._easeOptions.duration,1),d=this._onEaseFrame;d&&d(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,d){l=h.wrap(l,-180,180);const _=Math.abs(l-d);return Math.abs(l-360-d)<_&&(l-=360),Math.abs(l+360-d)<_&&(l+=360),l}_normalizeCenter(l){const d=this.transform;if(!d.renderWorldCopies||d.maxBounds)return;const _=l.lng-d.center.lng;l.lng+=_>180?-360:_<-180?360:0}_emulate(l,d,_){const b=Math.ceil(15*d/1e3),w=[],M=l(_.clone());for(let T=0;T<=b;T++){const I=M(T/b);w.push(I.clone())}return w}}class Kr{constructor(l={}){this.options=l,h.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const d=this.options&&this.options.compact;return this._map=l,this._container=He("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=He("button","mapboxgl-ctrl-attrib-button",this._container),He("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=He("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),d&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===d&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,d){const _=this._map._getUIString(`AttributionControl.${d}`);l.setAttribute("aria-label",_),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const d=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(l){const _=d.reduce((b,w,M)=>(w.value&&(b+=`${w.key}=${w.value}${M<d.length-1?"&":""}`),b),"?");l.href=`${h.config.FEEDBACK_URL}/${_}#${Ef(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const d=this._map.style._sourceCaches;for(const b in d){const w=d[b];if(w.used){const M=w.getSource();M.attribution&&l.indexOf(M.attribution)<0&&l.push(M.attribution)}}l.sort((b,w)=>b.length-w.length),l=l.filter((b,w)=>{for(let M=w+1;M<l.length;M++)if(l[M].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const _=l.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,l.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Nr{constructor(){h.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=He("div","mapboxgl-ctrl");const d=He("a","mapboxgl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://www.mapbox.com/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(0===Object.entries(l).length)return!0;for(const d in l){const _=l[d].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const d=l[0];this._map.getCanvasContainer().offsetWidth<250?d.classList.add("mapboxgl-compact"):d.classList.remove("mapboxgl-compact")}}}class Tu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const d=++this._id;return this._queue.push({callback:l,id:d,cancelled:!1}),d}remove(l){const d=this._currentlyRunning,_=d?this._queue.concat(d):this._queue;for(const b of _)if(b.id===l)return void(b.cancelled=!0)}run(l=0){const d=this._currentlyRunning=this._queue;this._queue=[];for(const _ of d)if(!_.cancelled&&(_.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Kl(m,l,d){if(m=new h.LngLat(m.lng,m.lat),l){const _=new h.LngLat(m.lng-360,m.lat),b=new h.LngLat(m.lng+360,m.lat),w=360*Math.ceil(Math.abs(m.lng-d.center.lng)/360),M=d.locationPoint(m).distSqr(l),T=l.x<0||l.y<0||l.x>d.width||l.y>d.height;d.locationPoint(_).distSqr(l)<M&&(T||Math.abs(_.lng-d.center.lng)<w)?m=_:d.locationPoint(b).distSqr(l)<M&&(T||Math.abs(b.lng-d.center.lng)<w)&&(m=b)}for(;Math.abs(m.lng-d.center.lng)>180;){const _=d.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;m.lng>d.center.lng?m.lng-=360:m.lng+=360}return m}const zo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Au extends h.Evented{constructor(l,d){if(super(),(l instanceof h.window.HTMLElement||d)&&(l=h.extend({element:l},d)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=h.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=He("div");const b=41,w=27,M=yt("svg",{display:"block",height:b*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${b}`},this._element),T=yt("radialGradient",{id:"shadowGradient"},yt("defs",{},M));yt("stop",{offset:"10%","stop-opacity":.4},T),yt("stop",{offset:"100%","stop-opacity":.05},T),yt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),yt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),yt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),yt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=h.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const _=this._element.classList;for(const b in zo)_.remove(`mapboxgl-marker-anchor-${b}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=h.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const d=l.code,_=l.charCode||l.keyCode;"Space"!==d&&"Enter"!==d&&32!==_&&13!==_||this.togglePopup()}_onMapClick(l){const d=l.originalEvent.target,_=this._element;this._popup&&(d===_||_.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,d=this._pos;if(!l||!d)return!1;const _=l.unproject(d),b=l.getFreeCameraOptions();if(!b.position)return!1;const w=b.position.toLngLat();return w.distanceTo(_)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const d=this._pos;if(!d||d.x<0||d.x>l.transform.width||d.y<0||d.y>l.transform.height)return void this._clearFadeTimer();const _=l.unproject(d);let b;l._showingGlobe()&&h.isLngLatBehindGlobe(l.transform,this._lngLat)?b=0:(b=1-l._queryFogOpacity(_),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const d=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${l.x}px,${l.y}px)\n            ${zo[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${d.x}px,${d.y}px)\n        `}_calculateXYTransform(){const l=this._pos,d=this._map,_=this.getPitchAlignment();if(!d||!l||"map"!==_)return"";if(!d._showingGlobe()){const I=d.getPitch();return I?`rotateX(${I}deg)`:""}const b=h.radToDeg(h.globeTiltAtLngLat(d.transform,this._lngLat)),w=l.sub(h.globeCenterToScreenPoint(d.transform)),M=Math.abs(w.x)+Math.abs(w.y);if(0===M)return"";const T=b/M;return`rotateX(${-w.y*T}deg) rotateY(${w.x*T}deg)`}_calculateZTransform(){const l=this._pos,d=this._map;if(!d||!l)return"";let _=0;const b=this.getRotationAlignment();if("map"===b)if(d._showingGlobe()){const w=d.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=d.project(new h.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);_=h.radToDeg(Math.atan2(M.y,M.x))-90}else _=-d.getBearing();else if("horizon"===b){const w=h.smoothstep(4,6,d.getZoom()),M=h.globeCenterToScreenPoint(d.transform);M.y+=w*d.transform.height;const T=l.sub(M),I=h.radToDeg(Math.atan2(T.y,T.x));_=(I>90?I-270:I+90)*(1-w)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(l){h.window.cancelAnimationFrame(this._updateFrameId);const d=this._map;d&&(d.transform.renderWorldCopies&&(this._lngLat=Kl(this._lngLat,this._pos,d.transform)),this._pos=d.project(this._lngLat),!0===l?this._updateFrameId=h.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),d._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(d._showingGlobe()||d.getTerrain()||d.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=h.pointGeometry.convert(l),this._update(),this}_onMove(l){const d=this._map;if(!d)return;const _=this._pointerdownPos,b=this._positionDelta;if(_&&b){if(!this._isDragging){const w=this._clickTolerance||d._clickTolerance;if(l.point.dist(_)<w)return;this._isDragging=!0}this._pos=l.point.sub(b),this._lngLat=d.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new h.Event("dragend")),this._state="inactive"}_addDragHandler(l){const d=this._map,_=this._pos;d&&_&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(_),this._pointerdownPos=l.point,this._state="pending",d.on("mousemove",this._onMove),d.on("touchmove",this._onMove),d.once("mouseup",this._onUp),d.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const d=this._map;return d&&(l?(d.on("mousedown",this._addDragHandler),d.on("touchstart",this._addDragHandler)):(d.off("mousedown",this._addDragHandler),d.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const rh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},kf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pf(m=new h.pointGeometry(0,0),l="bottom"){if("number"==typeof m){const d=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new h.pointGeometry(0,m);case"top-left":return new h.pointGeometry(d,d);case"top-right":return new h.pointGeometry(-d,d);case"bottom":return new h.pointGeometry(0,-m);case"bottom-left":return new h.pointGeometry(d,-d);case"bottom-right":return new h.pointGeometry(-d,-d);case"left":return new h.pointGeometry(m,0);case"right":return new h.pointGeometry(-m,0)}return new h.pointGeometry(0,0)}return m instanceof h.pointGeometry||Array.isArray(m)?h.pointGeometry.convert(m):h.pointGeometry.convert(m[l]||[0,0])}class fp{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const d=h.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-d)+this._end*d}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,d,_){this._start=this.getValue(d),this._end=l,this._startTime=d,this._endTime=d+_}}const Mo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Fa={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},oh={showCompass:!0,showZoom:!0,visualizePitch:!1};class $c{constructor(l,d,_=!1){this._clickTolerance=10,this.element=d,this.mouseRotate=new as({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,_&&(this.mousePitch=new nh({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),d.addEventListener("mousedown",this.mousedown),d.addEventListener("touchstart",this.touchstart,{passive:!1}),d.addEventListener("touchmove",this.touchmove),d.addEventListener("touchend",this.touchend),d.addEventListener("touchcancel",this.reset)}down(l,d){this.mouseRotate.mousedown(l,d),this.mousePitch&&this.mousePitch.mousedown(l,d),Pt()}move(l,d){const _=this.map,b=this.mouseRotate.mousemoveWindow(l,d),w=b&&b.bearingDelta;if(w&&_.setBearing(_.getBearing()+w),this.mousePitch){const M=this.mousePitch.mousemoveWindow(l,d),T=M&&M.pitchDelta;T&&_.setPitch(_.getPitch()+T)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){pt(),h.window.removeEventListener("mousemove",this.mousemove),h.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(h.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),it(this.element,l)),h.window.addEventListener("mousemove",this.mousemove),h.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,it(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=ae(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){1!==l.targetTouches.length?this.reset():(this._lastPos=ae(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Oa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Rf={maxWidth:100,unit:"metric"};function mp(m,l,d){const _=sh(l),b=_/l,w={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[d];this._map._requestDomTask(()=>{this._container.style.width=m*b+"px",this._container.innerHTML=`${_}&nbsp;${w}`})}function sh(m){const l=Math.pow(10,`${Math.floor(m)}`.length-1);let d=m/l;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:d>=1?1:function(_){const b=Math.pow(10,Math.ceil(-Math.log(_)/Math.LN10));return Math.round(_*b)/b}(d),l*d}const fd={version:h.version,supported:Xt,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:class extends uo{constructor(m){if(h.LivePerformanceUtils.mark(h.PerformanceMarkers.create),null!=(m=h.extend({},Fa,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&h.isSafariWithAntialiasingBug(h.window)&&(m.antialias=!1,h.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _t(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Tu,this._domRenderTaskQueue=new Tu,this._controls=[],this._markers=[],this._popups=[],this._mapId=h.uniqueId(),this._locale=h.extend({},Mo,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new fp(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new h.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,"string"==typeof m.container){if(this._container=h.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof h.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&h.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==h.window&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1),h.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ft(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new od("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,h.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Kr({customAttribution:m.customAttribution})),this._logoControl=new Nr,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update("style"===l.dataType),this.fire(new h.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new h.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(m,l){if(void 0===l&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[l];return-1!==l.indexOf("bottom")?_.insertBefore(d,_.firstChild):_.appendChild(d),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new h.Event("movestart",m)).fire(new h.Event("move",m)),this.fire(new h.Event("resize",m)),l&&this.fire(new h.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(h.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new h.Event("zoomstart")).fire(new h.Event("zoom")).fire(new h.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new h.Event("pitchstart")).fire(new h.Event("pitch")).fire(new h.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return"auto"===m?h.window.navigator.language:Array.isArray(m)?0===m.length?void 0:m.map(l=>"auto"===l?h.window.navigator.language:l):m}setLanguage(m){const l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(const d of this._controls)d._setLanguage&&d._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(m){return this._lazyInitEmptyStyle(),m?"string"==typeof m&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const m=this.transform,l=m.projection.name;let d;"globe"===l&&m.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),d=!0):"mercator"===l&&m.zoom<h.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),d=!0),d&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;if(l="globe"===m.name&&this.transform.zoom>=h.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(const d in this.style._sourceCaches)this.style._sourceCaches[d].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(h.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(h.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,d){if("mouseenter"===m||"mouseover"===m){let _=!1;const b=M=>{const T=l.filter(N=>this.getLayer(N)),I=T.length?this.queryRenderedFeatures(M.point,{layers:T}):[];I.length?_||(_=!0,d.call(this,new co(m,this,M.originalEvent,{features:I}))):_=!1},w=()=>{_=!1};return{layers:new Set(l),listener:d,delegates:{mousemove:b,mouseout:w}}}if("mouseleave"===m||"mouseout"===m){let _=!1;const b=M=>{const T=l.filter(I=>this.getLayer(I));(T.length?this.queryRenderedFeatures(M.point,{layers:T}):[]).length?_=!0:_&&(_=!1,d.call(this,new co(m,this,M.originalEvent)))},w=M=>{_&&(_=!1,d.call(this,new co(m,this,M.originalEvent)))};return{layers:new Set(l),listener:d,delegates:{mousemove:b,mouseout:w}}}{const _=b=>{const w=l.filter(T=>this.getLayer(T)),M=w.length?this.queryRenderedFeatures(b.point,{layers:w}):[];M.length&&(b.features=M,d.call(this,b),delete b.features)};return{layers:new Set(l),listener:d,delegates:{[m]:_}}}}on(m,l,d){if(void 0===d)return super.on(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const b in _.delegates)this.on(b,_.delegates[b]);return this}once(m,l,d){if(void 0===d)return super.once(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,d);for(const b in _.delegates)this.once(b,_.delegates[b]);return this}off(m,l,d){if(void 0===d)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);const _=(w,M)=>{if(w.size!==M.size)return!1;for(const T of w)if(!M.has(T))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[m]:void 0;return b&&(w=>{for(let M=0;M<w.length;M++){const T=w[M];if(T.listener===d&&_(T.layers,l)){for(const I in T.delegates)this.off(I,T.delegates[I]);return w.splice(M,1),this}}})(b),this}queryRenderedFeatures(m,l){return this.style?(void 0!==l||void 0===m||m instanceof h.pointGeometry||Array.isArray(m)||(l=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}setStyle(m,l){return!1!==(l=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){const l=this._locale[m];if(null==l)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new wo(this,l||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new wo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if("string"==typeof m){const d=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(d,h.ResourceType.Style);h.getJSON(_,(b,w)=>{b?this.fire(new h.ErrorEvent(b)):w&&this._updateDiff(w,l)})}else"object"==typeof m&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(d){h.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(h.warnOnce("There is no style added to the map."),!1)}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const l in m){const d=m[l]._tiles;for(const _ in d){const b=d[_];if("loaded"!==b.state&&"errored"!==b.state)return!1}}return!0}addSourceType(m,l,d){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,d)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l,{pixelRatio:d=1,sdf:_=!1,stretchX:b,stretchY:w,content:M}={}){if(this._lazyInitEmptyStyle(),l instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&l instanceof h.window.ImageBitmap){const{width:T,height:I,data:N}=h.exported.getImageData(l);this.style.addImage(m,{data:new h.RGBAImage({width:T,height:I},N),pixelRatio:d,stretchX:b,stretchY:w,content:M,sdf:_,version:0})}else if(void 0===l.width||void 0===l.height)this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:T,height:I}=l,N=l;this.style.addImage(m,{data:new h.RGBAImage({width:T,height:I},new Uint8Array(N.data)),pixelRatio:d,stretchX:b,stretchY:w,content:M,sdf:_,version:0,userImage:N}),N.onAdd&&N.onAdd(this,m)}}updateImage(m,l){const d=this.style.getImage(m);if(!d)return void this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=l instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&l instanceof h.window.ImageBitmap?h.exported.getImageData(l):l,{width:b,height:w}=_;void 0!==b&&void 0!==w?b===d.data.width&&w===d.data.height?(d.data.replace(_.data,!(l instanceof h.window.HTMLImageElement||h.window.ImageBitmap&&l instanceof h.window.ImageBitmap)),this.style.updateImage(m,d)):this.fire(new h.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${w})\n                must be that same as the previous version of the image\n                (${d.data.width}, ${d.data.height})`))):this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){h.getImage(this._requestManager.transformRequest(m,h.ResourceType.Image),(d,_)=>{l(d,_ instanceof h.window.HTMLImageElement?h.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,l,d){return this.style.setLayerZoomRange(m,l,d),this._update(!0)}setFilter(m,l,d={}){return this.style.setFilter(m,l,d),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,d,_={}){return this.style.setPaintProperty(m,l,d,_),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,d,_={}){return this.style.setLayoutProperty(m,l,d,_),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setLight(m,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(h.LngLat.convert(m),this.transform):0}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let d,_,b,w=this._container;for(;w&&(!_||!b);){const M=h.window.getComputedStyle(w).transform;M&&"none"!==M&&(d=M.match(/matrix.*\((.+)\)/)[1].split(", "),d[0]&&"0"!==d[0]&&"1"!==d[0]&&(_=d[0]),d[3]&&"0"!==d[3]&&"1"!==d[3]&&(b=d[3])),w=w.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=b?Math.abs(l/b):l}_detectMissingCSS(){"rgb(250, 128, 114)"!==h.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&h.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=He("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=He("div","mapboxgl-canvas-container",m);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=He("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const d=this._controlContainer=He("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{_[b]=He("div",`mapboxgl-ctrl-${b}`,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){const d=h.exported.devicePixelRatio||1;this._canvas.width=d*Math.ceil(m),this._canvas.height=d*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const l=this._markers.indexOf(m);-1!==l&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const l=this._popups.indexOf(m);-1!==l&&this._popups.splice(l,1)}_setupPainter(){const m=h.extend({},Xt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._useWebGL2&&this._canvas.getContext("webgl2",m),d=l||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);d?(this._useWebGL2&&!l&&h.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),h.storeAuthState(d,!0),this.painter=new Lr(d,this.transform,!!l),this.on("data",_=>{"source"===_.dataType&&this.painter.setTileLoadedFlag(!0)}),h.exported$1.testSupport(d)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l;const d=this.painter.context.extTimerQuery,_=h.exported.now();if(this.listens("gpu-timing-frame")&&(l=d.createQueryEXT(),d.beginQueryEXT(d.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],h.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],h.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const T=this.transform.zoom,I=this.transform.pitch,N=h.exported.now(),L=new h.EvaluationParameters(T,{now:N,fadeDuration:b,pitch:I,transition:this.style.getTransition()});this.style.update(L)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const T=h.exported.now()-_;d.endQueryEXT(d.TIME_ELAPSED_EXT,l),setTimeout(()=>{const I=d.getQueryObjectEXT(l,d.QUERY_RESULT_EXT)/1e6;d.deleteQueryEXT(l),this.fire(new h.Event("gpu-timing-frame",{cpuTime:T,gpuTime:I})),h.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:I}})},50)}if(this.listens("gpu-timing-layer")){const T=this.painter.collectGpuTimers();setTimeout(()=>{const I=this.painter.queryGpuTimers(T);this.fire(new h.Event("gpu-timing-layer",{layerTimes:I}))},50)}if(this.listens("gpu-timing-deferred-render")){const T=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const I=this.painter.queryGpuTimeDeferredRender(T);this.fire(new h.Event("gpu-timing-deferred-render",{gpuTime:I}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(M||this._repaint)this.triggerRepaint();else{const T=!this.isMoving()&&this.loaded();if(T&&(w=this._updateAverageElevation(_,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),T&&(this.fire(new h.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const I=this._calculateSpeedIndex();this.fire(new h.Event("speedindexcompleted",{speedIndex:I})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,h.LivePerformanceUtils.mark(h.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&h.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){const d=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&d(0);if((l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=m;const M=Math.abs(_-b);if(M>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(b),d(b);this._averageElevation.easeTo(b,m,300)}else if(M>1e-4)return this._averageElevation.jumpTo(b),d(b)}return!!this._averageElevation.isEasing(m)&&d(this._averageElevation.getValue(m))}_authenticate(){h.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===h.AUTH_ERR_MSG||401===m.status)){const l=this.painter.context.gl;h.storeAuthState(l,!1),this._logoControl instanceof Nr&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new h.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),h.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const d=this.painter.context.gl,_=d.createFramebuffer();function b(w){d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,w,0);const M=new Uint8Array(d.drawingBufferWidth*d.drawingBufferHeight*4);return d.readPixels(0,0,d.drawingBufferWidth,d.drawingBufferHeight,d.RGBA,d.UNSIGNED_BYTE,M),M}return d.bindFramebuffer(d.FRAMEBUFFER,_),this._canvasPixelComparison(b(m),l.canvasCopies.map(b),l.timeStamps)}_canvasPixelComparison(m,l,d){let _=d[1]-d[0];const b=m.length/4;for(let w=0;w<l.length;w++){const M=l[w];let T=0;for(let I=0;I<M.length;I+=4)M[I]===m[I]&&M[I+1]===m[I+1]&&M[I+2]===m[I+2]&&M[I+3]===m[I+3]&&(T+=1);_+=(d[w+2]-d[w+1])*(1-T/b)}return _}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==h.window&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1),h.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),h.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new h.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=h.exported.frame(l=>{const d=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,d&&this._render(l)}))}_preloadTiles(m){const l=this.style?Object.values(this.style._sourceCaches):[];return h.asyncAll(l,(d,_)=>d._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){"hidden"===h.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){h.setCacheLimits(m,l)}get version(){return h.version}},NavigationControl:class{constructor(m){this.options=h.extend({},oh,m),this._container=He("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),He("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),He("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const d=this._map;d&&(this.options.visualizePitch?d.resetNorthPitch({},{originalEvent:l}):d.resetNorth({},{originalEvent:l}))}),this._compassIcon=He("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const l=m.getZoom(),d=l===m.getMaxZoom(),_=l===m.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $c(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){const d=He("button",m,this._container);return d.type="button",d.addEventListener("click",l),d}_setButtonTitle(m,l){if(!this._map)return;const d=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",d),m.firstElementChild&&m.firstElementChild.setAttribute("title",d)}},GeolocateControl:class extends h.Evented{constructor(m){super(),this.options=h.extend({geolocation:h.window.navigator.geolocation},Oa,m),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Xr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=He("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const l=(d=!!this.options.geolocation)=>{this._supportsGeolocation=d,m(d)};void 0!==this._supportsGeolocation?m(this._supportsGeolocation):void 0!==h.window.navigator.permissions?h.window.navigator.permissions.query({name:"geolocation"}).then(d=>l("denied"!==d.state)).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),d=m.coords;return!!l&&(d.longitude<l.getWest()||d.longitude>l.getEast()||d.latitude<l.getSouth()||d.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",m)),this._finish()}}_updateCamera(m){const l=new h.LngLat(m.coords.longitude,m.coords.latitude),d=m.coords.accuracy,_=this._map.getBearing(),b=h.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(d),b,{geolocateSource:!0})}_updateMarker(m){if(m){const l=new h.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,l=h.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,d=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=He("button","mapboxgl-ctrl-geolocate",this._container),He("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=He("div","mapboxgl-user-location"),this._dotElement.appendChild(He("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(He("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Au({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=He("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Au({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||"ACTIVE_LOCK"!==this._watchState||l.originalEvent&&"resize"===l.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new h.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{h.window.addEventListener("ondeviceorientationabsolute"in h.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==h.window.DeviceMotionEvent&&"function"==typeof h.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(l=>{"granted"===l&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),h.window.removeEventListener("deviceorientation",this._onDeviceOrientation),h.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Kr,ScaleControl:class{constructor(m){this.options=h.extend({},Rf,m),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=mp.bind(this)),h.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,l=this._map,d=l._containerHeight/2,_=l._containerWidth/2-m/2,b=l.unproject([_,d]),w=l.unproject([_+m,d]),M=b.distanceTo(w);if("imperial"===this.options.unit){const T=3.2808*M;T>5280?this._setScale(m,T/5280,"mile"):this._setScale(m,T,"foot")}else"nautical"===this.options.unit?this._setScale(m,M/1852,"nautical-mile"):M>=1e3?this._setScale(m,M/1e3,"kilometer"):this._setScale(m,M,"meter")}_setScale(m,l,d){const _=sh(l),b=_/l;this._map._requestDomTask(()=>{this._container.style.width=m*b+"px",this._container.innerHTML="nautical-mile"!==d?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:d}).format(_):`${_}&nbsp;nm`})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=He("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof h.window.HTMLElement?this._container=m.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in h.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=He("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!h.window.document.fullscreenEnabled&&!h.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=He("button","mapboxgl-ctrl-fullscreen",this._controlContainer);He("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(h.window.document.fullscreenElement||h.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends h.Evented{constructor(m){super(),this.options=h.extend(Object.create(rh),m),h.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new h.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new h.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=h.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(h.window.document.createTextNode(m))}setHTML(m){const l=h.window.document.createDocumentFragment(),d=h.window.document.createElement("body");let _;for(d.innerHTML=m;_=d.firstChild,_;)l.appendChild(_);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=He("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){const d=this._closeButton=He("button","mapboxgl-popup-close-button",l);d.type="button",d.setAttribute("aria-label","Close popup"),d.setAttribute("aria-hidden","true"),d.innerHTML="&#215;",d.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const l=this._map,d=this._container,_=this._pos;if(!l||!d||!_)return"bottom";const b=d.offsetWidth,w=d.offsetHeight,M=_.x<b/2,T=_.x>l.transform.width-b/2;if(_.y+m<w)return M?"top-left":T?"top-right":"top";if(_.y>l.transform.height-w){if(M)return"bottom-left";if(T)return"bottom-right"}return M?"left":T?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){const l=this._map,d=this._content;if(!l||!this._lngLat&&!this._trackPointer||!d)return;let _=this._container;if(_||(_=this._container=He("div","mapboxgl-popup",l.getContainer()),this._tip=He("div","mapboxgl-popup-tip",_),_.appendChild(d)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Kl(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){const b=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),w=Pf(this.options.offset),M=this._anchor=this._getAnchor(w.y),T=Pf(this.options.offset,M),I=b.add(T).round();l._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${zo[M]} translate(${I.x}px,${I.y}px)`)})}if(!this._marker&&l._showingGlobe()){const b=h.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(kf);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Au,Style:wo,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.pointGeometry,MercatorCoordinate:h.MercatorCoordinate,FreeCameraOptions:k,Evented:h.Evented,config:h.config,prewarm:function(){Ut().acquire(zt)},clearPrewarmedResources:function(){const m=Gt;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(zt),Gt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(m){h.config.ACCESS_TOKEN=m},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(m){h.config.API_URL=m},get workerCount(){return Ft.workerCount},set workerCount(m){Ft.workerCount=m},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){h.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){h.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:h.exported.setNow,restoreNow:h.exported.restoreNow};return fd}),Nt}()},893:(Tr,Jt,pi)=>{var Nt,ze,Vi;window,ze=[pi(328),pi(390)],void 0!==(Vi="function"==typeof(Nt=function(Ie,Xt){"use strict";var kt=Ie.create("masonry");kt.compatOptions.fitWidth="isFitWidth";var xt=kt.prototype;return xt._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var He=0;He<this.cols;He++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},xt.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var He=this.items[0],yt=He&&He.element;this.columnWidth=yt&&Xt(yt).outerWidth||this.containerWidth}var Lt=this.columnWidth+=this.gutter,un=this.containerWidth+this.gutter,Yn=un/Lt,Pt=Lt-un%Lt;Yn=Math[Pt&&Pt<1?"round":"floor"](Yn),this.cols=Math.max(Yn,1)},xt.getContainerWidth=function(){var He=this._getOption("fitWidth"),Lt=Xt(He?this.element.parentNode:this.element);this.containerWidth=Lt&&Lt.innerWidth},xt._getItemLayoutPosition=function(He){He.getSize();var yt=He.size.outerWidth%this.columnWidth,un=Math[yt&&yt<1?"round":"ceil"](He.size.outerWidth/this.columnWidth);un=Math.min(un,this.cols);for(var Pt=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](un,He),pt={x:this.columnWidth*Pt.col,y:Pt.y},tn=Pt.y+He.size.outerHeight,en=un+Pt.col,it=Pt.col;it<en;it++)this.colYs[it]=tn;return pt},xt._getTopColPosition=function(He){var yt=this._getTopColGroup(He),Lt=Math.min.apply(Math,yt);return{col:yt.indexOf(Lt),y:Lt}},xt._getTopColGroup=function(He){if(He<2)return this.colYs;for(var yt=[],Lt=this.cols+1-He,un=0;un<Lt;un++)yt[un]=this._getColGroupY(un,He);return yt},xt._getColGroupY=function(He,yt){if(yt<2)return this.colYs[He];var Lt=this.colYs.slice(He,He+yt);return Math.max.apply(Math,Lt)},xt._getHorizontalColPosition=function(He,yt){var Lt=this.horizontalColIndex%this.cols;return Lt=He>1&&Lt+He>this.cols?0:Lt,this.horizontalColIndex=yt.size.outerWidth&&yt.size.outerHeight?Lt+He:this.horizontalColIndex,{col:Lt,y:this._getColGroupY(Lt,He)}},xt._manageStamp=function(He){var yt=Xt(He),Lt=this._getElementOffset(He),Yn=this._getOption("originLeft")?Lt.left:Lt.right,Pt=Yn+yt.outerWidth,pt=Math.floor(Yn/this.columnWidth);pt=Math.max(0,pt);var tn=Math.floor(Pt/this.columnWidth);tn-=Pt%this.columnWidth?0:1,tn=Math.min(this.cols-1,tn);for(var it=(this._getOption("originTop")?Lt.top:Lt.bottom)+yt.outerHeight,ae=pt;ae<=tn;ae++)this.colYs[ae]=Math.max(it,this.colYs[ae])},xt._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var He={height:this.maxY};return this._getOption("fitWidth")&&(He.width=this._getContainerFitWidth()),He},xt._getContainerFitWidth=function(){for(var He=0,yt=this.cols;--yt&&0===this.colYs[yt];)He++;return(this.cols-He)*this.columnWidth-this.gutter},xt.needsResizeLayout=function(){var He=this.containerWidth;return this.getContainerWidth(),He!=this.containerWidth},kt})?Nt.apply(Jt,ze):Nt)&&(Tr.exports=Vi)},544:(Tr,Jt,pi)=>{var Nt,ze,Vi;window,ze=[pi(665),pi(390)],void 0!==(Vi="function"==typeof(Nt=function(Ie,Xt){"use strict";var xt=document.documentElement.style,He="string"==typeof xt.transition?"transition":"WebkitTransition",yt="string"==typeof xt.transform?"transform":"WebkitTransform",Lt={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[He],un={transform:yt,transition:He,transitionDuration:He+"Duration",transitionProperty:He+"Property",transitionDelay:He+"Delay"};function Yn(ae,De){ae&&(this.element=ae,this.layout=De,this.position={x:0,y:0},this._create())}var Pt=Yn.prototype=Object.create(Ie.prototype);Pt.constructor=Yn,Pt._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},Pt.handleEvent=function(ae){var De="on"+ae.type;this[De]&&this[De](ae)},Pt.getSize=function(){this.size=Xt(this.element)},Pt.css=function(ae){var De=this.element.style;for(var ot in ae)De[un[ot]||ot]=ae[ot]},Pt.getPosition=function(){var ae=getComputedStyle(this.element),De=this.layout._getOption("originLeft"),ot=this.layout._getOption("originTop"),gt=ae[De?"left":"right"],_n=ae[ot?"top":"bottom"],Ti=parseFloat(gt),Ui=parseFloat(_n),er=this.layout.size;-1!=gt.indexOf("%")&&(Ti=Ti/100*er.width),-1!=_n.indexOf("%")&&(Ui=Ui/100*er.height),Ti=isNaN(Ti)?0:Ti,Ui=isNaN(Ui)?0:Ui,Ui-=ot?er.paddingTop:er.paddingBottom,this.position.x=Ti-=De?er.paddingLeft:er.paddingRight,this.position.y=Ui},Pt.layoutPosition=function(){var ae=this.layout.size,De={},ot=this.layout._getOption("originLeft"),gt=this.layout._getOption("originTop"),Ui=ot?"right":"left";De[ot?"left":"right"]=this.getXValue(this.position.x+ae[ot?"paddingLeft":"paddingRight"]),De[Ui]="";var mr=gt?"bottom":"top";De[gt?"top":"bottom"]=this.getYValue(this.position.y+ae[gt?"paddingTop":"paddingBottom"]),De[mr]="",this.css(De),this.emitEvent("layout",[this])},Pt.getXValue=function(ae){var De=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!De?ae/this.layout.size.width*100+"%":ae+"px"},Pt.getYValue=function(ae){var De=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&De?ae/this.layout.size.height*100+"%":ae+"px"},Pt._transitionTo=function(ae,De){this.getPosition();var ot=this.position.x,gt=this.position.y,_n=ae==this.position.x&&De==this.position.y;if(this.setPosition(ae,De),!_n||this.isTransitioning){var er={};er.transform=this.getTranslate(ae-ot,De-gt),this.transition({to:er,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},Pt.getTranslate=function(ae,De){return"translate3d("+(ae=this.layout._getOption("originLeft")?ae:-ae)+"px, "+(De=this.layout._getOption("originTop")?De:-De)+"px, 0)"},Pt.goTo=function(ae,De){this.setPosition(ae,De),this.layoutPosition()},Pt.moveTo=Pt._transitionTo,Pt.setPosition=function(ae,De){this.position.x=parseFloat(ae),this.position.y=parseFloat(De)},Pt._nonTransition=function(ae){for(var De in this.css(ae.to),ae.isCleaning&&this._removeStyles(ae.to),ae.onTransitionEnd)ae.onTransitionEnd[De].call(this)},Pt.transition=function(ae){if(parseFloat(this.layout.options.transitionDuration)){var De=this._transn;for(var ot in ae.onTransitionEnd)De.onEnd[ot]=ae.onTransitionEnd[ot];for(ot in ae.to)De.ingProperties[ot]=!0,ae.isCleaning&&(De.clean[ot]=!0);ae.from&&this.css(ae.from),this.enableTransition(ae.to),this.css(ae.to),this.isTransitioning=!0}else this._nonTransition(ae)};var tn="opacity,"+function pt(ae){return ae.replace(/([A-Z])/g,function(De){return"-"+De.toLowerCase()})}(yt);Pt.enableTransition=function(){if(!this.isTransitioning){var ae=this.layout.options.transitionDuration;this.css({transitionProperty:tn,transitionDuration:ae="number"==typeof ae?ae+"ms":ae,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(Lt,this,!1)}},Pt.onwebkitTransitionEnd=function(ae){this.ontransitionend(ae)},Pt.onotransitionend=function(ae){this.ontransitionend(ae)};var en={"-webkit-transform":"transform"};Pt.ontransitionend=function(ae){if(ae.target===this.element){var De=this._transn,ot=en[ae.propertyName]||ae.propertyName;delete De.ingProperties[ot],function kt(ae){for(var De in ae)return!1;return!0}(De.ingProperties)&&this.disableTransition(),ot in De.clean&&(this.element.style[ae.propertyName]="",delete De.clean[ot]),ot in De.onEnd&&(De.onEnd[ot].call(this),delete De.onEnd[ot]),this.emitEvent("transitionEnd",[this])}},Pt.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(Lt,this,!1),this.isTransitioning=!1},Pt._removeStyles=function(ae){var De={};for(var ot in ae)De[ot]="";this.css(De)};var it={transitionProperty:"",transitionDuration:"",transitionDelay:""};return Pt.removeTransitionStyles=function(){this.css(it)},Pt.stagger=function(ae){ae=isNaN(ae)?0:ae,this.staggerDelay=ae+"ms"},Pt.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},Pt.remove=function(){He&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),this.hide()):this.removeElem()},Pt.reveal=function(){delete this.isHidden,this.css({display:""});var ae=this.layout.options,De={};De[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:ae.hiddenStyle,to:ae.visibleStyle,isCleaning:!0,onTransitionEnd:De})},Pt.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},Pt.getHideRevealTransitionEndProperty=function(ae){var De=this.layout.options[ae];if(De.opacity)return"opacity";for(var ot in De)return ot},Pt.hide=function(){this.isHidden=!0,this.css({display:""});var ae=this.layout.options,De={};De[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:ae.visibleStyle,to:ae.hiddenStyle,isCleaning:!0,onTransitionEnd:De})},Pt.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},Pt.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},Yn})?Nt.apply(Jt,ze):Nt)&&(Tr.exports=Vi)},328:(Tr,Jt,pi)=>{var Nt,ze;!function(Vi,h){"use strict";Nt=[pi(665),pi(390),pi(777),pi(544)],ze=function(Ie,Xt,kt,xt){return function(h,Ie,Xt,kt,xt){var He=h.console,yt=h.jQuery,Lt=function(){},un=0,Yn={};function Pt(ae,De){var ot=kt.getQueryElement(ae);if(ot){this.element=ot,yt&&(this.$element=yt(this.element)),this.options=kt.extend({},this.constructor.defaults),this.option(De);var gt=++un;this.element.outlayerGUID=gt,Yn[gt]=this,this._create(),this._getOption("initLayout")&&this.layout()}else He&&He.error("Bad element for "+this.constructor.namespace+": "+(ot||ae))}Pt.namespace="outlayer",Pt.Item=xt,Pt.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var pt=Pt.prototype;function tn(ae){function De(){ae.apply(this,arguments)}return(De.prototype=Object.create(ae.prototype)).constructor=De,De}kt.extend(pt,Ie.prototype),pt.option=function(ae){kt.extend(this.options,ae)},pt._getOption=function(ae){var De=this.constructor.compatOptions[ae];return De&&void 0!==this.options[De]?this.options[De]:this.options[ae]},Pt.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},pt._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),kt.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},pt.reloadItems=function(){this.items=this._itemize(this.element.children)},pt._itemize=function(ae){for(var De=this._filterFindItemElements(ae),ot=this.constructor.Item,gt=[],_n=0;_n<De.length;_n++){var Ui=new ot(De[_n],this);gt.push(Ui)}return gt},pt._filterFindItemElements=function(ae){return kt.filterFindElements(ae,this.options.itemSelector)},pt.getItemElements=function(){return this.items.map(function(ae){return ae.element})},pt.layout=function(){this._resetLayout(),this._manageStamps();var ae=this._getOption("layoutInstant");this.layoutItems(this.items,void 0!==ae?ae:!this._isLayoutInited),this._isLayoutInited=!0},pt._init=pt.layout,pt._resetLayout=function(){this.getSize()},pt.getSize=function(){this.size=Xt(this.element)},pt._getMeasurement=function(ae,De){var gt,ot=this.options[ae];ot?("string"==typeof ot?gt=this.element.querySelector(ot):ot instanceof HTMLElement&&(gt=ot),this[ae]=gt?Xt(gt)[De]:ot):this[ae]=0},pt.layoutItems=function(ae,De){ae=this._getItemsForLayout(ae),this._layoutItems(ae,De),this._postLayout()},pt._getItemsForLayout=function(ae){return ae.filter(function(De){return!De.isIgnored})},pt._layoutItems=function(ae,De){if(this._emitCompleteOnItems("layout",ae),ae&&ae.length){var ot=[];ae.forEach(function(gt){var _n=this._getItemLayoutPosition(gt);_n.item=gt,_n.isInstant=De||gt.isLayoutInstant,ot.push(_n)},this),this._processLayoutQueue(ot)}},pt._getItemLayoutPosition=function(){return{x:0,y:0}},pt._processLayoutQueue=function(ae){this.updateStagger(),ae.forEach(function(De,ot){this._positionItem(De.item,De.x,De.y,De.isInstant,ot)},this)},pt.updateStagger=function(){var ae=this.options.stagger;if(null!=ae)return this.stagger=function it(ae){if("number"==typeof ae)return ae;var De=ae.match(/(^\d*\.?\d*)(\w*)/),ot=De&&De[1],gt=De&&De[2];return ot.length?(ot=parseFloat(ot))*(en[gt]||1):0}(ae),this.stagger;this.stagger=0},pt._positionItem=function(ae,De,ot,gt,_n){gt?ae.goTo(De,ot):(ae.stagger(_n*this.stagger),ae.moveTo(De,ot))},pt._postLayout=function(){this.resizeContainer()},pt.resizeContainer=function(){if(this._getOption("resizeContainer")){var De=this._getContainerSize();De&&(this._setContainerMeasure(De.width,!0),this._setContainerMeasure(De.height,!1))}},pt._getContainerSize=Lt,pt._setContainerMeasure=function(ae,De){if(void 0!==ae){var ot=this.size;ot.isBorderBox&&(ae+=De?ot.paddingLeft+ot.paddingRight+ot.borderLeftWidth+ot.borderRightWidth:ot.paddingBottom+ot.paddingTop+ot.borderTopWidth+ot.borderBottomWidth),ae=Math.max(ae,0),this.element.style[De?"width":"height"]=ae+"px"}},pt._emitCompleteOnItems=function(ae,De){var ot=this;function gt(){ot.dispatchEvent(ae+"Complete",null,[De])}var _n=De.length;if(De&&_n){var Ti=0;De.forEach(function(er){er.once(ae,Ui)})}else gt();function Ui(){++Ti==_n&&gt()}},pt.dispatchEvent=function(ae,De,ot){var gt=De?[De].concat(ot):ot;if(this.emitEvent(ae,gt),yt)if(this.$element=this.$element||yt(this.element),De){var _n=yt.Event(De);_n.type=ae,this.$element.trigger(_n,ot)}else this.$element.trigger(ae,ot)},pt.ignore=function(ae){var De=this.getItem(ae);De&&(De.isIgnored=!0)},pt.unignore=function(ae){var De=this.getItem(ae);De&&delete De.isIgnored},pt.stamp=function(ae){(ae=this._find(ae))&&(this.stamps=this.stamps.concat(ae),ae.forEach(this.ignore,this))},pt.unstamp=function(ae){(ae=this._find(ae))&&ae.forEach(function(De){kt.removeFrom(this.stamps,De),this.unignore(De)},this)},pt._find=function(ae){if(ae)return"string"==typeof ae&&(ae=this.element.querySelectorAll(ae)),kt.makeArray(ae)},pt._manageStamps=function(){!this.stamps||!this.stamps.length||(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},pt._getBoundingRect=function(){var ae=this.element.getBoundingClientRect(),De=this.size;this._boundingRect={left:ae.left+De.paddingLeft+De.borderLeftWidth,top:ae.top+De.paddingTop+De.borderTopWidth,right:ae.right-(De.paddingRight+De.borderRightWidth),bottom:ae.bottom-(De.paddingBottom+De.borderBottomWidth)}},pt._manageStamp=Lt,pt._getElementOffset=function(ae){var De=ae.getBoundingClientRect(),ot=this._boundingRect,gt=Xt(ae);return{left:De.left-ot.left-gt.marginLeft,top:De.top-ot.top-gt.marginTop,right:ot.right-De.right-gt.marginRight,bottom:ot.bottom-De.bottom-gt.marginBottom}},pt.handleEvent=kt.handleEvent,pt.bindResize=function(){h.addEventListener("resize",this),this.isResizeBound=!0},pt.unbindResize=function(){h.removeEventListener("resize",this),this.isResizeBound=!1},pt.onresize=function(){this.resize()},kt.debounceMethod(Pt,"onresize",100),pt.resize=function(){!this.isResizeBound||!this.needsResizeLayout()||this.layout()},pt.needsResizeLayout=function(){var ae=Xt(this.element);return this.size&&ae&&ae.innerWidth!==this.size.innerWidth},pt.addItems=function(ae){var De=this._itemize(ae);return De.length&&(this.items=this.items.concat(De)),De},pt.appended=function(ae){var De=this.addItems(ae);De.length&&(this.layoutItems(De,!0),this.reveal(De))},pt.prepended=function(ae){var De=this._itemize(ae);if(De.length){var ot=this.items.slice(0);this.items=De.concat(ot),this._resetLayout(),this._manageStamps(),this.layoutItems(De,!0),this.reveal(De),this.layoutItems(ot)}},pt.reveal=function(ae){if(this._emitCompleteOnItems("reveal",ae),ae&&ae.length){var De=this.updateStagger();ae.forEach(function(ot,gt){ot.stagger(gt*De),ot.reveal()})}},pt.hide=function(ae){if(this._emitCompleteOnItems("hide",ae),ae&&ae.length){var De=this.updateStagger();ae.forEach(function(ot,gt){ot.stagger(gt*De),ot.hide()})}},pt.revealItemElements=function(ae){var De=this.getItems(ae);this.reveal(De)},pt.hideItemElements=function(ae){var De=this.getItems(ae);this.hide(De)},pt.getItem=function(ae){for(var De=0;De<this.items.length;De++){var ot=this.items[De];if(ot.element==ae)return ot}},pt.getItems=function(ae){ae=kt.makeArray(ae);var De=[];return ae.forEach(function(ot){var gt=this.getItem(ot);gt&&De.push(gt)},this),De},pt.remove=function(ae){var De=this.getItems(ae);this._emitCompleteOnItems("remove",De),De&&De.length&&De.forEach(function(ot){ot.remove(),kt.removeFrom(this.items,ot)},this)},pt.destroy=function(){var ae=this.element.style;ae.height="",ae.position="",ae.width="",this.items.forEach(function(ot){ot.destroy()}),this.unbindResize(),delete Yn[this.element.outlayerGUID],delete this.element.outlayerGUID,yt&&yt.removeData(this.element,this.constructor.namespace)},Pt.data=function(ae){var De=(ae=kt.getQueryElement(ae))&&ae.outlayerGUID;return De&&Yn[De]},Pt.create=function(ae,De){var ot=tn(Pt);return ot.defaults=kt.extend({},Pt.defaults),kt.extend(ot.defaults,De),ot.compatOptions=kt.extend({},Pt.compatOptions),ot.namespace=ae,ot.data=Pt.data,ot.Item=tn(xt),kt.htmlInit(ot,ae),yt&&yt.bridget&&yt.bridget(ae,ot),ot};var en={ms:1,s:1e3};return Pt.Item=xt,Pt}(Vi,Ie,Xt,kt,xt)}.apply(Jt,Nt),void 0!==ze&&(Tr.exports=ze)}(window)},226:function(Tr){Tr.exports=function(){"use strict";var Jt={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const Nt=k=>{const F={};for(const G in k)F[k[G]]="swal2-"+k[G];return F},ze=Nt(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),Vi=Nt(["success","warning","info","question","error"]),h="SweetAlert2:",Xt=k=>k.charAt(0).toUpperCase()+k.slice(1),kt=k=>{console.warn(`${h} ${"object"==typeof k?k.join(" "):k}`)},xt=k=>{console.error(`${h} ${k}`)},He=[],Lt=(k,F)=>{(k=>{He.includes(k)||(He.push(k),kt(k))})(`"${k}" is deprecated and will be removed in the next major release. Please use "${F}" instead.`)},un=k=>"function"==typeof k?k():k,Yn=k=>k&&"function"==typeof k.toPromise,Pt=k=>Yn(k)?k.toPromise():Promise.resolve(k),pt=k=>k&&Promise.resolve(k)===k,tn=()=>document.body.querySelector(`.${ze.container}`),en=k=>{const F=tn();return F?F.querySelector(k):null},it=k=>en(`.${k}`),ae=()=>it(ze.popup),De=()=>it(ze.icon),gt=()=>it(ze.title),_n=()=>it(ze["html-container"]),Ti=()=>it(ze.image),Ui=()=>it(ze["progress-steps"]),er=()=>it(ze["validation-message"]),fr=()=>en(`.${ze.actions} .${ze.confirm}`),gn=()=>en(`.${ze.actions} .${ze.cancel}`),mr=()=>en(`.${ze.actions} .${ze.deny}`),vo=()=>en(`.${ze.loader}`),Ro=()=>it(ze.actions),xn=()=>it(ze.footer),Zo=()=>it(ze["timer-progress-bar"]),_a=()=>it(ze.close),Yo=()=>{const k=Array.from(ae().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((G,fe)=>{const Xe=parseInt(G.getAttribute("tabindex")),an=parseInt(fe.getAttribute("tabindex"));return Xe>an?1:Xe<an?-1:0}),F=Array.from(ae().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(G=>"-1"!==G.getAttribute("tabindex"));return(k=>{const F=[];for(let G=0;G<k.length;G++)-1===F.indexOf(k[G])&&F.push(k[G]);return F})(k.concat(F)).filter(G=>Fr(G))},yn=()=>ar(document.body,ze.shown)&&!ar(document.body,ze["toast-shown"])&&!ar(document.body,ze["no-backdrop"]),Xo=()=>ae()&&ar(ae(),ze.toast),Xn={previousBodyPadding:null},Rn=(k,F)=>{if(k.textContent="",F){const fe=(new DOMParser).parseFromString(F,"text/html");Array.from(fe.querySelector("head").childNodes).forEach(Xe=>{k.appendChild(Xe)}),Array.from(fe.querySelector("body").childNodes).forEach(Xe=>{Xe instanceof HTMLVideoElement||Xe instanceof HTMLAudioElement?k.appendChild(Xe.cloneNode(!0)):k.appendChild(Xe)})}},ar=(k,F)=>{if(!F)return!1;const G=F.split(/\s+/);for(let fe=0;fe<G.length;fe++)if(!k.classList.contains(G[fe]))return!1;return!0},ei=(k,F,G)=>{if(((k,F)=>{Array.from(k.classList).forEach(G=>{!Object.values(ze).includes(G)&&!Object.values(Vi).includes(G)&&!Object.values(F.showClass).includes(G)&&k.classList.remove(G)})})(k,F),F.customClass&&F.customClass[G]){if("string"!=typeof F.customClass[G]&&!F.customClass[G].forEach)return void kt(`Invalid type of customClass.${G}! Expected string or iterable object, got "${typeof F.customClass[G]}"`);Gn(k,F.customClass[G])}},Ko=(k,F)=>{if(!F)return null;switch(F){case"select":case"textarea":case"file":return k.querySelector(`.${ze.popup} > .${ze[F]}`);case"checkbox":return k.querySelector(`.${ze.popup} > .${ze.checkbox} input`);case"radio":return k.querySelector(`.${ze.popup} > .${ze.radio} input:checked`)||k.querySelector(`.${ze.popup} > .${ze.radio} input:first-child`);case"range":return k.querySelector(`.${ze.popup} > .${ze.range} input`);default:return k.querySelector(`.${ze.popup} > .${ze.input}`)}},Kn=k=>{if(k.focus(),"file"!==k.type){const F=k.value;k.value="",k.value=F}},ys=(k,F,G)=>{!k||!F||("string"==typeof F&&(F=F.split(/\s+/).filter(Boolean)),F.forEach(fe=>{Array.isArray(k)?k.forEach(Xe=>{G?Xe.classList.add(fe):Xe.classList.remove(fe)}):G?k.classList.add(fe):k.classList.remove(fe)}))},Gn=(k,F)=>{ys(k,F,!0)},Fo=(k,F)=>{ys(k,F,!1)},so=(k,F)=>{const G=Array.from(k.children);for(let fe=0;fe<G.length;fe++){const Xe=G[fe];if(Xe instanceof HTMLElement&&ar(Xe,F))return Xe}},Qs=(k,F,G)=>{G===`${parseInt(G)}`&&(G=parseInt(G)),G||0===parseInt(G)?k.style[F]="number"==typeof G?`${G}px`:G:k.style.removeProperty(F)},ir=function(k){k.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},gr=k=>{k.style.display="none"},vs=(k,F,G,fe)=>{const Xe=k.querySelector(F);Xe&&(Xe.style[G]=fe)},Oo=function(k,F){F?ir(k,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):gr(k)},Fr=k=>!(!k||!(k.offsetWidth||k.offsetHeight||k.getClientRects().length)),vc=k=>k.scrollHeight>k.clientHeight,Os=k=>{const F=window.getComputedStyle(k),G=parseFloat(F.getPropertyValue("animation-duration")||"0"),fe=parseFloat(F.getPropertyValue("transition-duration")||"0");return G>0||fe>0},ya=function(k){let F=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const G=Zo();Fr(G)&&(F&&(G.style.transition="none",G.style.width="100%"),setTimeout(()=>{G.style.transition=`width ${k/1e3}s linear`,G.style.width="0%"},10))},wn={},va=k=>new Promise(F=>{if(!k)return F();const G=window.scrollX,fe=window.scrollY;wn.restoreFocusTimeout=setTimeout(()=>{wn.previousActiveElement instanceof HTMLElement?(wn.previousActiveElement.focus(),wn.previousActiveElement=null):document.body&&document.body.focus(),F()},100),window.scrollTo(G,fe)}),sl=()=>typeof window>"u"||typeof document>"u",wc=`\n <div aria-labelledby="${ze.title}" aria-describedby="${ze["html-container"]}" class="${ze.popup}" tabindex="-1">\n   <button type="button" class="${ze.close}"></button>\n   <ul class="${ze["progress-steps"]}"></ul>\n   <div class="${ze.icon}"></div>\n   <img class="${ze.image}" />\n   <h2 class="${ze.title}" id="${ze.title}"></h2>\n   <div class="${ze["html-container"]}" id="${ze["html-container"]}"></div>\n   <input class="${ze.input}" />\n   <input type="file" class="${ze.file}" />\n   <div class="${ze.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${ze.select}"></select>\n   <div class="${ze.radio}"></div>\n   <label for="${ze.checkbox}" class="${ze.checkbox}">\n     <input type="checkbox" />\n     <span class="${ze.label}"></span>\n   </label>\n   <textarea class="${ze.textarea}"></textarea>\n   <div class="${ze["validation-message"]}" id="${ze["validation-message"]}"></div>\n   <div class="${ze.actions}">\n     <div class="${ze.loader}"></div>\n     <button type="button" class="${ze.confirm}"></button>\n     <button type="button" class="${ze.deny}"></button>\n     <button type="button" class="${ze.cancel}"></button>\n   </div>\n   <div class="${ze.footer}"></div>\n   <div class="${ze["timer-progress-bar-container"]}">\n     <div class="${ze["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),Qo=()=>{wn.currentInstance.resetValidationMessage()},Ol=k=>{const F=(()=>{const k=tn();return!!k&&(k.remove(),Fo([document.documentElement,document.body],[ze["no-backdrop"],ze["toast-shown"],ze["has-column"]]),!0)})();if(sl())return void xt("SweetAlert2 requires document to initialize");const G=document.createElement("div");G.className=ze.container,F&&Gn(G,ze["no-transition"]),Rn(G,wc);const fe=(k=>"string"==typeof k?document.querySelector(k):k)(k.target);fe.appendChild(G),(k=>{const F=ae();F.setAttribute("role",k.toast?"alert":"dialog"),F.setAttribute("aria-live",k.toast?"polite":"assertive"),k.toast||F.setAttribute("aria-modal","true")})(k),(k=>{"rtl"===window.getComputedStyle(k).direction&&Gn(tn(),ze.rtl)})(fe),(()=>{const k=ae(),F=so(k,ze.input),G=so(k,ze.file),fe=k.querySelector(`.${ze.range} input`),Xe=k.querySelector(`.${ze.range} output`),an=so(k,ze.select),Pi=k.querySelector(`.${ze.checkbox} input`),Yr=so(k,ze.textarea);F.oninput=Qo,G.onchange=Qo,an.onchange=Qo,Pi.onchange=Qo,Yr.oninput=Qo,fe.oninput=()=>{Qo(),Xe.value=fe.value},fe.onchange=()=>{Qo(),Xe.value=fe.value}})()},ba=(k,F)=>{k instanceof HTMLElement?F.appendChild(k):"object"==typeof k?Ec(k,F):k&&Rn(F,k)},Ec=(k,F)=>{k.jquery?al(F,k):Rn(F,k.toString())},al=(k,F)=>{if(k.textContent="",0 in F)for(let G=0;G in F;G++)k.appendChild(F[G].cloneNode(!0));else k.appendChild(F.cloneNode(!0))},Jo=(()=>{if(sl())return!1;const k=document.createElement("div"),F={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const G in F)if(Object.prototype.hasOwnProperty.call(F,G)&&typeof k.style[G]<"u")return F[G];return!1})(),xa=(k,F)=>{const G=Ro(),fe=vo();F.showConfirmButton||F.showDenyButton||F.showCancelButton?ir(G):gr(G),ei(G,F,"actions"),function Dc(k,F,G){const fe=fr(),Xe=mr(),an=gn();te(fe,"confirm",G),te(Xe,"deny",G),te(an,"cancel",G),function wa(k,F,G,fe){fe.buttonsStyling?(Gn([k,F,G],ze.styled),fe.confirmButtonColor&&(k.style.backgroundColor=fe.confirmButtonColor,Gn(k,ze["default-outline"])),fe.denyButtonColor&&(F.style.backgroundColor=fe.denyButtonColor,Gn(F,ze["default-outline"])),fe.cancelButtonColor&&(G.style.backgroundColor=fe.cancelButtonColor,Gn(G,ze["default-outline"]))):Fo([k,F,G],ze.styled)}(fe,Xe,an,G),G.reverseButtons&&(G.toast?(k.insertBefore(an,fe),k.insertBefore(Xe,fe)):(k.insertBefore(an,F),k.insertBefore(Xe,F),k.insertBefore(fe,F)))}(G,fe,F),Rn(fe,F.loaderHtml),ei(fe,F,"loader")};function te(k,F,G){Oo(k,G[`show${Xt(F)}Button`],"inline-block"),Rn(k,G[`${F}ButtonText`]),k.setAttribute("aria-label",G[`${F}ButtonAriaLabel`]),k.className=ze[F],ei(k,G,`${F}Button`),Gn(k,G[`${F}ButtonClass`])}const H=(k,F)=>{const G=tn();G&&(function ee(k,F){"string"==typeof F?k.style.background=F:F||Gn([document.documentElement,document.body],ze["no-backdrop"])}(G,F.backdrop),function ue(k,F){F in ze?Gn(k,ze[F]):(kt('The "position" parameter is not valid, defaulting to "center"'),Gn(k,ze.center))}(G,F.position),function be(k,F){if(F&&"string"==typeof F){const G=`grow-${F}`;G in ze&&Gn(k,ze[G])}}(G,F.grow),ei(G,F,"container"))};const Ae=["input","file","range","select","radio","checkbox","textarea"],Ce=k=>{if(!Ut[k.input])return void xt(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${k.input}"`);const F=Ft(k.input),G=Ut[k.input](F,k);ir(F),k.inputAutoFocus&&setTimeout(()=>{Kn(G)})},tt=(k,F)=>{const G=Ko(ae(),k);if(G){(k=>{for(let F=0;F<k.attributes.length;F++){const G=k.attributes[F].name;["type","value","style"].includes(G)||k.removeAttribute(G)}})(G);for(const fe in F)G.setAttribute(fe,F[fe])}},Tt=k=>{const F=Ft(k.input);"object"==typeof k.customClass&&Gn(F,k.customClass.input)},Je=(k,F)=>{(!k.placeholder||F.inputPlaceholder)&&(k.placeholder=F.inputPlaceholder)},zt=(k,F,G)=>{if(G.inputLabel){k.id=ze.input;const fe=document.createElement("label"),Xe=ze["input-label"];fe.setAttribute("for",k.id),fe.className=Xe,"object"==typeof G.customClass&&Gn(fe,G.customClass.inputLabel),fe.innerText=G.inputLabel,F.insertAdjacentElement("beforebegin",fe)}},Ft=k=>so(ae(),ze[k]||ze.input),Gt=(k,F)=>{["string","number"].includes(typeof F)?k.value=`${F}`:pt(F)||kt(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof F}"`)},Ut={};Ut.text=Ut.email=Ut.password=Ut.number=Ut.tel=Ut.url=(k,F)=>(Gt(k,F.inputValue),zt(k,k,F),Je(k,F),k.type=F.input,k),Ut.file=(k,F)=>(zt(k,k,F),Je(k,F),k),Ut.range=(k,F)=>{const G=k.querySelector("input"),fe=k.querySelector("output");return Gt(G,F.inputValue),G.type=F.input,Gt(fe,F.inputValue),zt(G,k,F),k},Ut.select=(k,F)=>{if(k.textContent="",F.inputPlaceholder){const G=document.createElement("option");Rn(G,F.inputPlaceholder),G.value="",G.disabled=!0,G.selected=!0,k.appendChild(G)}return zt(k,k,F),k},Ut.radio=k=>(k.textContent="",k),Ut.checkbox=(k,F)=>{const G=Ko(ae(),"checkbox");G.value="1",G.id=ze.checkbox,G.checked=Boolean(F.inputValue);const fe=k.querySelector("span");return Rn(fe,F.inputPlaceholder),G},Ut.textarea=(k,F)=>{Gt(k,F.inputValue),Je(k,F),zt(k,k,F);return setTimeout(()=>{if("MutationObserver"in window){const fe=parseInt(window.getComputedStyle(ae()).width);new MutationObserver(()=>{const an=k.offsetWidth+(fe=>parseInt(window.getComputedStyle(fe).marginLeft)+parseInt(window.getComputedStyle(fe).marginRight))(k);ae().style.width=an>fe?`${an}px`:null}).observe(k,{attributes:!0,attributeFilter:["style"]})}}),k};const Mn=(k,F)=>{const G=_n();ei(G,F,"htmlContainer"),F.html?(ba(F.html,G),ir(G,"block")):F.text?(G.textContent=F.text,ir(G,"block")):gr(G),((k,F)=>{const G=ae(),fe=Jt.innerParams.get(k),Xe=!fe||F.input!==fe.input;Ae.forEach(an=>{const Pi=so(G,ze[an]);tt(an,F.inputAttributes),Pi.className=ze[an],Xe&&gr(Pi)}),F.input&&(Xe&&Ce(F),Tt(F))})(k,F)},ti=(k,F)=>{for(const G in Vi)F.icon!==G&&Fo(k,Vi[G]);Gn(k,Vi[F.icon]),ea(k,F),Ei(),ei(k,F,"icon")},Ei=()=>{const k=ae(),F=window.getComputedStyle(k).getPropertyValue("background-color"),G=k.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let fe=0;fe<G.length;fe++)G[fe].style.backgroundColor=F},qe=(k,F)=>{let fe,G=k.innerHTML;F.iconHtml?fe=rr(F.iconHtml):"success"===F.icon?(fe='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',G=G.replace(/ style=".*?"/g,"")):fe="error"===F.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':rr({question:"?",warning:"!",info:"i"}[F.icon]),G.trim()!==fe.trim()&&Rn(k,fe)},ea=(k,F)=>{if(F.iconColor){k.style.color=F.iconColor,k.style.borderColor=F.iconColor;for(const G of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])vs(k,G,"backgroundColor",F.iconColor);vs(k,".swal2-success-ring","borderColor",F.iconColor)}},rr=k=>`<div class="${ze["icon-content"]}">${k}</div>`,Bs=(k,F)=>{k.className=`${ze.popup} ${Fr(k)?F.showClass.popup:""}`,F.toast?(Gn([document.documentElement,document.body],ze["toast-shown"]),Gn(k,ze.toast)):Gn(k,ze.modal),ei(k,F,"popup"),"string"==typeof F.customClass&&Gn(k,F.customClass),F.icon&&Gn(k,ze[`icon-${F.icon}`])},lr=k=>{const F=document.createElement("li");return Gn(F,ze["progress-step"]),Rn(F,k),F},qr=k=>{const F=document.createElement("li");return Gn(F,ze["progress-step-line"]),k.progressStepsDistance&&Qs(F,"width",k.progressStepsDistance),F},In=(k,F)=>{((k,F)=>{const G=tn(),fe=ae();F.toast?(Qs(G,"width",F.width),fe.style.width="100%",fe.insertBefore(vo(),De())):Qs(fe,"width",F.width),Qs(fe,"padding",F.padding),F.color&&(fe.style.color=F.color),F.background&&(fe.style.background=F.background),gr(er()),Bs(fe,F)})(0,F),H(0,F),((k,F)=>{const G=Ui();F.progressSteps&&0!==F.progressSteps.length?(ir(G),G.textContent="",F.currentProgressStep>=F.progressSteps.length&&kt("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),F.progressSteps.forEach((fe,Xe)=>{const an=lr(fe);if(G.appendChild(an),Xe===F.currentProgressStep&&Gn(an,ze["active-progress-step"]),Xe!==F.progressSteps.length-1){const Pi=qr(F);G.appendChild(Pi)}})):gr(G)})(0,F),((k,F)=>{const G=Jt.innerParams.get(k),fe=De();G&&F.icon===G.icon?(qe(fe,F),ti(fe,F)):F.icon||F.iconHtml?F.icon&&-1===Object.keys(Vi).indexOf(F.icon)?(xt(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${F.icon}"`),gr(fe)):(ir(fe),qe(fe,F),ti(fe,F),Gn(fe,F.showClass.icon)):gr(fe)})(k,F),((k,F)=>{const G=Ti();F.imageUrl?(ir(G,""),G.setAttribute("src",F.imageUrl),G.setAttribute("alt",F.imageAlt),Qs(G,"width",F.imageWidth),Qs(G,"height",F.imageHeight),G.className=ze.image,ei(G,F,"image")):gr(G)})(0,F),((k,F)=>{const G=gt();Oo(G,F.title||F.titleText,"block"),F.title&&ba(F.title,G),F.titleText&&(G.innerText=F.titleText),ei(G,F,"title")})(0,F),((k,F)=>{const G=_a();Rn(G,F.closeButtonHtml),ei(G,F,"closeButton"),Oo(G,F.showCloseButton),G.setAttribute("aria-label",F.closeButtonAriaLabel)})(0,F),Mn(k,F),xa(0,F),((k,F)=>{const G=xn();Oo(G,F.footer),F.footer&&ba(F.footer,G),ei(G,F,"footer")})(0,F),"function"==typeof F.didRender&&F.didRender(ae())};function Ht(){const k=Jt.innerParams.get(this);if(!k)return;const F=Jt.domCache.get(this);gr(F.loader),Xo()?k.icon&&ir(De()):es(F),Fo([F.popup,F.actions],ze.loading),F.popup.removeAttribute("aria-busy"),F.popup.removeAttribute("data-loading"),F.confirmButton.disabled=!1,F.denyButton.disabled=!1,F.cancelButton.disabled=!1}const es=k=>{const F=k.popup.getElementsByClassName(k.loader.getAttribute("data-button-to-replace"));F.length?ir(F[0],"inline-block"):!Fr(fr())&&!Fr(mr())&&!Fr(gn())&&gr(k.actions)};const Nl=()=>fr()&&fr().click(),or=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),bi=k=>{k.keydownTarget&&k.keydownHandlerAdded&&(k.keydownTarget.removeEventListener("keydown",k.keydownHandler,{capture:k.keydownListenerCapture}),k.keydownHandlerAdded=!1)},Cr=(k,F)=>{const G=Yo();if(G.length)return(k+=F)===G.length?k=0:-1===k&&(k=G.length-1),void G[k].focus();ae().focus()},nt=["ArrowRight","ArrowDown"],zs=["ArrowLeft","ArrowUp"],Sn=(k,F,G)=>{const fe=Jt.innerParams.get(k);fe&&(F.isComposing||229===F.keyCode||(fe.stopKeydownPropagation&&F.stopPropagation(),"Enter"===F.key?fi(k,F,fe):"Tab"===F.key?Mc(F):[...nt,...zs].includes(F.key)?Bl(F.key):"Escape"===F.key&&zl(F,fe,G)))},fi=(k,F,G)=>{if(un(G.allowEnterKey)&&F.target&&k.getInput()&&F.target instanceof HTMLElement&&F.target.outerHTML===k.getInput().outerHTML){if(["textarea","file"].includes(G.input))return;Nl(),F.preventDefault()}},Mc=k=>{const F=k.target,G=Yo();let fe=-1;for(let Xe=0;Xe<G.length;Xe++)if(F===G[Xe]){fe=Xe;break}Cr(fe,k.shiftKey?-1:1),k.stopPropagation(),k.preventDefault()},Bl=k=>{const F=fr(),G=mr(),fe=gn();if(document.activeElement instanceof HTMLElement&&![F,G,fe].includes(document.activeElement))return;const an=nt.includes(k)?"nextElementSibling":"previousElementSibling";let Pi=document.activeElement;for(let Yr=0;Yr<Ro().children.length;Yr++){if(Pi=Pi[an],!Pi)return;if(Pi instanceof HTMLButtonElement&&Fr(Pi))break}Pi instanceof HTMLButtonElement&&Pi.focus()},zl=(k,F,G)=>{un(F.allowEscapeKey)&&(k.preventDefault(),G(or.esc))};var Vs={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const sr=()=>{Array.from(document.body.children).forEach(F=>{F.hasAttribute("data-previous-aria-hidden")?(F.setAttribute("aria-hidden",F.getAttribute("data-previous-aria-hidden")),F.removeAttribute("data-previous-aria-hidden")):F.removeAttribute("aria-hidden")})},vu=()=>{const k=navigator.userAgent,F=!!k.match(/iPad/i)||!!k.match(/iPhone/i),G=!!k.match(/WebKit/i);F&&G&&!k.match(/CriOS/i)&&ae().scrollHeight>window.innerHeight-44&&(tn().style.paddingBottom="44px")},cr=()=>{const k=tn();let F;k.ontouchstart=G=>{F=xo(G)},k.ontouchmove=G=>{F&&(G.preventDefault(),G.stopPropagation())}},xo=k=>{const F=k.target,G=tn();return!ap(k)&&!ed(k)&&(F===G||!vc(G)&&F instanceof HTMLElement&&"INPUT"!==F.tagName&&"TEXTAREA"!==F.tagName&&!(vc(_n())&&_n().contains(F)))},ap=k=>k.touches&&k.touches.length&&"stylus"===k.touches[0].touchType,ed=k=>k.touches&&k.touches.length>1,Er=()=>{if(ar(document.body,ze.iosfix)){const k=parseInt(document.body.style.top,10);Fo(document.body,ze.iosfix),document.body.style.top="",document.body.scrollTop=-1*k}},Sc=()=>{null===Xn.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(Xn.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${Xn.previousBodyPadding+(()=>{const k=document.createElement("div");k.className=ze["scrollbar-measure"],document.body.appendChild(k);const F=k.getBoundingClientRect().width-k.clientWidth;return document.body.removeChild(k),F})()}px`)},$d=()=>{null!==Xn.previousBodyPadding&&(document.body.style.paddingRight=`${Xn.previousBodyPadding}px`,Xn.previousBodyPadding=null)};function Vl(k,F,G,fe){Xo()?Ul(k,fe):(va(G).then(()=>Ul(k,fe)),bi(wn)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(F.setAttribute("style","display:none !important"),F.removeAttribute("class"),F.innerHTML=""):F.remove(),yn()&&($d(),Er(),sr()),function Wr(){Fo([document.documentElement,document.body],[ze.shown,ze["height-auto"],ze["no-backdrop"],ze["toast-shown"]])}()}function Ar(k){k=Mt(k);const F=Vs.swalPromiseResolve.get(this),G=Ea(this);this.isAwaitingPromise()?k.isDismissed||(ll(this),F(k)):G&&F(k)}const Ea=k=>{const F=ae();if(!F)return!1;const G=Jt.innerParams.get(k);if(!G||ar(F,G.hideClass.popup))return!1;Fo(F,G.showClass.popup),Gn(F,G.hideClass.popup);const fe=tn();return Fo(fe,G.showClass.backdrop),Gn(fe,G.hideClass.backdrop),Hd(k,F,G),!0};const ll=k=>{k.isAwaitingPromise()&&(Jt.awaitingPromise.delete(k),Jt.innerParams.get(k)||k._destroy())},Mt=k=>typeof k>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},k),Hd=(k,F,G)=>{const fe=tn(),Xe=Jo&&Os(F);"function"==typeof G.willClose&&G.willClose(F),Xe?qn(k,F,fe,G.returnFocus,G.didClose):Vl(k,fe,G.returnFocus,G.didClose)},qn=(k,F,G,fe,Xe)=>{wn.swalCloseEventFinishedCallback=Vl.bind(null,k,G,fe,Xe),F.addEventListener(Jo,function(an){an.target===F&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback)})},Ul=(k,F)=>{setTimeout(()=>{"function"==typeof F&&F.bind(k.params)(),k._destroy()})};function jl(k,F,G){const fe=Jt.domCache.get(k);F.forEach(Xe=>{fe[Xe].disabled=G})}function Da(k,F){if(k)if("radio"===k.type){const fe=k.parentNode.parentNode.querySelectorAll("input");for(let Xe=0;Xe<fe.length;Xe++)fe[Xe].disabled=F}else k.disabled=F}const dn={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},Hl=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],qd={},Co=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Ac=k=>Object.prototype.hasOwnProperty.call(dn,k),Gl=k=>-1!==Hl.indexOf(k),Oi=k=>qd[k],td=k=>{Ac(k)||kt(`Unknown parameter "${k}"`)},nd=k=>{Co.includes(k)&&kt(`The parameter "${k}" is incompatible with toasts`)},Wd=k=>{Oi(k)&&Lt(k,Oi(k))};const Sa=k=>{const F={};return Object.keys(k).forEach(G=>{Gl(G)?F[G]=k[G]:kt(`Invalid parameter to update: ${G}`)}),F};const Ic=k=>{ql(k),delete k.params,delete wn.keydownHandler,delete wn.keydownTarget,delete wn.currentInstance},ql=k=>{k.isAwaitingPromise()?(cl(Jt,k),Jt.awaitingPromise.set(k,!0)):(cl(Vs,k),cl(Jt,k))},cl=(k,F)=>{for(const G in k)k[G].delete(F)};var ta=Object.freeze({__proto__:null,_destroy:function id(){const k=Jt.domCache.get(this),F=Jt.innerParams.get(this);F?(k.popup&&wn.swalCloseEventFinishedCallback&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback),"function"==typeof F.didDestroy&&F.didDestroy(),Ic(this)):ql(this)},close:Ar,closeModal:Ar,closePopup:Ar,closeToast:Ar,disableButtons:function Tc(){jl(this,["confirmButton","denyButton","cancelButton"],!0)},disableInput:function wo(){Da(this.getInput(),!0)},disableLoading:Ht,enableButtons:function Ma(){jl(this,["confirmButton","denyButton","cancelButton"],!1)},enableInput:function xs(){Da(this.getInput(),!1)},getInput:function vi(k){const F=Jt.innerParams.get(k||this),G=Jt.domCache.get(k||this);return G?Ko(G.popup,F.input):null},handleAwaitingPromise:ll,hideLoading:Ht,isAwaitingPromise:function oi(){return!!Jt.awaitingPromise.get(this)},rejectPromise:function bu(k){const F=Vs.swalPromiseReject.get(this);ll(this),F&&F(k)},resetValidationMessage:function Gd(){const k=Jt.domCache.get(this);k.validationMessage&&gr(k.validationMessage);const F=this.getInput();F&&(F.removeAttribute("aria-invalid"),F.removeAttribute("aria-describedby"),Fo(F,ze.inputerror))},showValidationMessage:function $l(k){const F=Jt.domCache.get(this),G=Jt.innerParams.get(this);Rn(F.validationMessage,k),F.validationMessage.className=ze["validation-message"],G.customClass&&G.customClass.validationMessage&&Gn(F.validationMessage,G.customClass.validationMessage),ir(F.validationMessage);const fe=this.getInput();fe&&(fe.setAttribute("aria-invalid",!0),fe.setAttribute("aria-describedby",ze["validation-message"]),Kn(fe),Gn(fe,ze.inputerror))},update:function ni(k){const F=ae(),G=Jt.innerParams.get(this);if(!F||ar(F,G.hideClass.popup))return void kt("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const fe=Sa(k),Xe=Object.assign({},G,fe);In(this,Xe),Jt.innerParams.set(this,Xe),Object.defineProperties(this,{params:{value:Object.assign({},this.params,k),writable:!1,enumerable:!0}})}});const Lo=k=>{let F=ae();F||new Pa,F=ae();const G=vo();Xo()?gr(De()):xu(F,k),ir(G),F.setAttribute("data-loading","true"),F.setAttribute("aria-busy","true"),F.focus()},xu=(k,F)=>{const G=Ro(),fe=vo();!F&&Fr(fr())&&(F=fr()),ir(G),F&&(gr(F),fe.setAttribute("data-button-to-replace",F.className)),fe.parentNode.insertBefore(fe,F),Gn([k,G],ze.loading)},bn=k=>k.checked?1:0,ul=k=>k.checked?k.value:null,kc=k=>k.files.length?null!==k.getAttribute("multiple")?k.files:k.files[0]:null,zn=(k,F)=>{const G=ae(),fe=Xe=>{Zd[F.input](G,wu(Xe),F)};Yn(F.inputOptions)||pt(F.inputOptions)?(Lo(fr()),Pt(F.inputOptions).then(Xe=>{k.hideLoading(),fe(Xe)})):"object"==typeof F.inputOptions?fe(F.inputOptions):xt("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof F.inputOptions)},Pc=(k,F)=>{const G=k.getInput();gr(G),Pt(F.inputValue).then(fe=>{G.value="number"===F.input?`${parseFloat(fe)||0}`:`${fe}`,ir(G),G.focus(),k.hideLoading()}).catch(fe=>{xt(`Error in inputValue promise: ${fe}`),G.value="",ir(G),G.focus(),k.hideLoading()})},Zd={select:(k,F,G)=>{const fe=so(k,ze.select),Xe=(an,Pi,Yr)=>{const _t=document.createElement("option");_t.value=Yr,Rn(_t,Pi),_t.selected=ts(Yr,G.inputValue),an.appendChild(_t)};F.forEach(an=>{const Pi=an[0],Yr=an[1];if(Array.isArray(Yr)){const _t=document.createElement("optgroup");_t.label=Pi,_t.disabled=!1,fe.appendChild(_t),Yr.forEach(Xr=>Xe(_t,Xr[1],Xr[0]))}else Xe(fe,Yr,Pi)}),fe.focus()},radio:(k,F,G)=>{const fe=so(k,ze.radio);F.forEach(an=>{const Pi=an[0],Yr=an[1],_t=document.createElement("input"),Xr=document.createElement("label");_t.type="radio",_t.name=ze.radio,_t.value=Pi,ts(Pi,G.inputValue)&&(_t.checked=!0);const od=document.createElement("span");Rn(od,Yr),od.className=ze.label,Xr.appendChild(_t),Xr.appendChild(od),fe.appendChild(Xr)});const Xe=fe.querySelectorAll("input");Xe.length&&Xe[0].focus()}},wu=k=>{const F=[];return typeof Map<"u"&&k instanceof Map?k.forEach((G,fe)=>{let Xe=G;"object"==typeof Xe&&(Xe=wu(Xe)),F.push([fe,Xe])}):Object.keys(k).forEach(G=>{let fe=k[G];"object"==typeof fe&&(fe=wu(fe)),F.push([G,fe])}),F},ts=(k,F)=>F&&F.toString()===k.toString(),xi=(k,F)=>{const G=Jt.innerParams.get(k);if(!G.input)return void xt(`The "input" parameter is needed to be set when using returnInputValueOn${Xt(F)}`);const fe=((k,F)=>{const G=k.getInput();if(!G)return null;switch(F.input){case"checkbox":return bn(G);case"radio":return ul(G);case"file":return kc(G);default:return F.inputAutoTrim?G.value.trim():G.value}})(k,G);G.inputValidator?dl(k,fe,F):k.getInput().checkValidity()?"deny"===F?hl(k,fe):is(k,fe):(k.enableButtons(),k.showValidationMessage(G.validationMessage))},dl=(k,F,G)=>{const fe=Jt.innerParams.get(k);k.disableInput(),Promise.resolve().then(()=>Pt(fe.inputValidator(F,fe.validationMessage))).then(an=>{k.enableButtons(),k.enableInput(),an?k.showValidationMessage(an):"deny"===G?hl(k,F):is(k,F)})},hl=(k,F)=>{const G=Jt.innerParams.get(k||void 0);G.showLoaderOnDeny&&Lo(mr()),G.preDeny?(Jt.awaitingPromise.set(k||void 0,!0),Promise.resolve().then(()=>Pt(G.preDeny(F,G.validationMessage))).then(Xe=>{!1===Xe?(k.hideLoading(),ll(k)):k.close({isDenied:!0,value:typeof Xe>"u"?F:Xe})}).catch(Xe=>Wl(k||void 0,Xe))):k.close({isDenied:!0,value:F})},pl=(k,F)=>{k.close({isConfirmed:!0,value:F})},Wl=(k,F)=>{k.rejectPromise(F)},is=(k,F)=>{const G=Jt.innerParams.get(k||void 0);G.showLoaderOnConfirm&&Lo(),G.preConfirm?(k.resetValidationMessage(),Jt.awaitingPromise.set(k||void 0,!0),Promise.resolve().then(()=>Pt(G.preConfirm(F,G.validationMessage))).then(Xe=>{Fr(er())||!1===Xe?(k.hideLoading(),ll(k)):pl(k,typeof Xe>"u"?F:Xe)}).catch(Xe=>Wl(k||void 0,Xe))):pl(k,F)},lp=(k,F,G)=>{F.popup.onclick=()=>{const fe=Jt.innerParams.get(k);fe&&(mi(fe)||fe.timer||fe.input)||G(or.close)}},mi=k=>k.showConfirmButton||k.showDenyButton||k.showCancelButton||k.showCloseButton;let Ta=!1;const Yd=k=>{k.popup.onmousedown=()=>{k.container.onmouseup=function(F){k.container.onmouseup=void 0,F.target===k.container&&(Ta=!0)}}},Rc=k=>{k.container.onmousedown=()=>{k.popup.onmouseup=function(F){k.popup.onmouseup=void 0,(F.target===k.popup||k.popup.contains(F.target))&&(Ta=!0)}}},ii=(k,F,G)=>{F.container.onclick=fe=>{const Xe=Jt.innerParams.get(k);Ta?Ta=!1:fe.target===F.container&&un(Xe.allowOutsideClick)&&G(or.backdrop)}},Fc=k=>k instanceof Element||(k=>"object"==typeof k&&k.jquery)(k);const ao=()=>{if(wn.timeout)return(()=>{const k=Zo(),F=parseInt(window.getComputedStyle(k).width);k.style.removeProperty("transition"),k.style.width="100%";const G=parseInt(window.getComputedStyle(k).width);k.style.width=F/G*100+"%"})(),wn.timeout.stop()},ia=()=>{if(wn.timeout){const k=wn.timeout.start();return ya(k),k}};let fl=!1;const Cs={};const Un=k=>{for(let F=k.target;F&&F!==document;F=F.parentNode)for(const G in Cs){const fe=F.getAttribute(G);if(fe)return void Cs[G].fire({template:fe})}};var Li=Object.freeze({__proto__:null,argsToParams:k=>{const F={};return"object"!=typeof k[0]||Fc(k[0])?["title","html","icon"].forEach((G,fe)=>{const Xe=k[fe];"string"==typeof Xe||Fc(Xe)?F[G]=Xe:void 0!==Xe&&xt(`Unexpected type of ${G}! Expected "string" or "Element", got ${typeof Xe}`)}):Object.assign(F,k[0]),F},bindClickHandler:function jt(){Cs[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,fl||(document.body.addEventListener("click",Un),fl=!0)},clickCancel:()=>gn()&&gn().click(),clickConfirm:Nl,clickDeny:()=>mr()&&mr().click(),enableLoading:Lo,fire:function Ir(){for(var F=arguments.length,G=new Array(F),fe=0;fe<F;fe++)G[fe]=arguments[fe];return new this(...G)},getActions:Ro,getCancelButton:gn,getCloseButton:_a,getConfirmButton:fr,getContainer:tn,getDenyButton:mr,getFocusableElements:Yo,getFooter:xn,getHtmlContainer:_n,getIcon:De,getIconContent:()=>it(ze["icon-content"]),getImage:Ti,getInputLabel:()=>it(ze["input-label"]),getLoader:vo,getPopup:ae,getProgressSteps:Ui,getTimerLeft:()=>wn.timeout&&wn.timeout.getTimerLeft(),getTimerProgressBar:Zo,getTitle:gt,getValidationMessage:er,increaseTimer:k=>{if(wn.timeout){const F=wn.timeout.increase(k);return ya(F,!0),F}},isDeprecatedParameter:Oi,isLoading:()=>ae().hasAttribute("data-loading"),isTimerRunning:()=>wn.timeout&&wn.timeout.isRunning(),isUpdatableParameter:Gl,isValidParameter:Ac,isVisible:()=>Fr(ae()),mixin:function wi(k){return class F extends(this){_main(fe,Xe){return super._main(fe,Object.assign({},k,Xe))}}},resumeTimer:ia,showLoading:Lo,stopTimer:ao,toggleTimer:()=>{const k=wn.timeout;return k&&(k.running?ao():ia())}});class rs{constructor(F,G){this.callback=F,this.remaining=G,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(F){const G=this.running;return G&&this.stop(),this.remaining+=F,G&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const $s=["swal-title","swal-html","swal-footer"],Es=k=>{const F={};return Array.from(k.querySelectorAll("swal-param")).forEach(fe=>{Do(fe,["name","value"]);const Xe=fe.getAttribute("name"),an=fe.getAttribute("value");F[Xe]="boolean"==typeof dn[Xe]?"false"!==an:"object"==typeof dn[Xe]?JSON.parse(an):an}),F},ur=k=>{const F={};return Array.from(k.querySelectorAll("swal-function-param")).forEach(fe=>{const Xe=fe.getAttribute("name"),an=fe.getAttribute("value");F[Xe]=new Function(`return ${an}`)()}),F},Oc=k=>{const F={};return Array.from(k.querySelectorAll("swal-button")).forEach(fe=>{Do(fe,["type","color","aria-label"]);const Xe=fe.getAttribute("type");F[`${Xe}ButtonText`]=fe.innerHTML,F[`show${Xt(Xe)}Button`]=!0,fe.hasAttribute("color")&&(F[`${Xe}ButtonColor`]=fe.getAttribute("color")),fe.hasAttribute("aria-label")&&(F[`${Xe}ButtonAriaLabel`]=fe.getAttribute("aria-label"))}),F},Lc=k=>{const F={},G=k.querySelector("swal-image");return G&&(Do(G,["src","width","height","alt"]),G.hasAttribute("src")&&(F.imageUrl=G.getAttribute("src")),G.hasAttribute("width")&&(F.imageWidth=G.getAttribute("width")),G.hasAttribute("height")&&(F.imageHeight=G.getAttribute("height")),G.hasAttribute("alt")&&(F.imageAlt=G.getAttribute("alt"))),F},jn=k=>{const F={},G=k.querySelector("swal-icon");return G&&(Do(G,["type","color"]),G.hasAttribute("type")&&(F.icon=G.getAttribute("type")),G.hasAttribute("color")&&(F.iconColor=G.getAttribute("color")),F.iconHtml=G.innerHTML),F},Nc=k=>{const F={},G=k.querySelector("swal-input");G&&(Do(G,["type","label","placeholder","value"]),F.input=G.getAttribute("type")||"text",G.hasAttribute("label")&&(F.inputLabel=G.getAttribute("label")),G.hasAttribute("placeholder")&&(F.inputPlaceholder=G.getAttribute("placeholder")),G.hasAttribute("value")&&(F.inputValue=G.getAttribute("value")));const fe=Array.from(k.querySelectorAll("swal-input-option"));return fe.length&&(F.inputOptions={},fe.forEach(Xe=>{Do(Xe,["value"]);const an=Xe.getAttribute("value");F.inputOptions[an]=Xe.innerHTML})),F},Bc=(k,F)=>{const G={};for(const fe in F){const Xe=F[fe],an=k.querySelector(Xe);an&&(Do(an,[]),G[Xe.replace(/^swal-/,"")]=an.innerHTML.trim())}return G},Cu=k=>{const F=$s.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(k.children).forEach(G=>{const fe=G.tagName.toLowerCase();F.includes(fe)||kt(`Unrecognized element <${fe}>`)})},Do=(k,F)=>{Array.from(k.attributes).forEach(G=>{-1===F.indexOf(G.name)&&kt([`Unrecognized attribute "${G.name}" on <${k.tagName.toLowerCase()}>.`,F.length?`Allowed attributes are: ${F.join(", ")}`:"To set the value, use HTML within the element."])})},Xl=k=>{const F=tn(),G=ae();"function"==typeof k.willOpen&&k.willOpen(G);const Xe=window.getComputedStyle(document.body).overflowY;ml(F,G,k),setTimeout(()=>{os(F,G)},10),yn()&&(ss(F,k.scrollbarPadding,Xe),Array.from(document.body.children).forEach(F=>{F===tn()||F.contains(tn())||(F.hasAttribute("aria-hidden")&&F.setAttribute("data-previous-aria-hidden",F.getAttribute("aria-hidden")),F.setAttribute("aria-hidden","true"))})),!Xo()&&!wn.previousActiveElement&&(wn.previousActiveElement=document.activeElement),"function"==typeof k.didOpen&&setTimeout(()=>k.didOpen(G)),Fo(F,ze["no-transition"])},Aa=k=>{const F=ae();if(k.target!==F)return;const G=tn();F.removeEventListener(Jo,Aa),G.style.overflowY="auto"},os=(k,F)=>{Jo&&Os(F)?(k.style.overflowY="hidden",F.addEventListener(Jo,Aa)):k.style.overflowY="auto"},ss=(k,F,G)=>{(()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!ar(document.body,ze.iosfix)){const F=document.body.scrollTop;document.body.style.top=-1*F+"px",Gn(document.body,ze.iosfix),cr(),vu()}})(),F&&"hidden"!==G&&Sc(),setTimeout(()=>{k.scrollTop=0})},ml=(k,F,G)=>{Gn(k,G.showClass.backdrop),F.style.setProperty("opacity","0","important"),ir(F,"grid"),setTimeout(()=>{Gn(F,G.showClass.popup),F.style.removeProperty("opacity")},10),Gn([document.documentElement,document.body],ze.shown),G.heightAuto&&G.backdrop&&!G.toast&&Gn([document.documentElement,document.body],ze["height-auto"])};var Ai={email:(k,F)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(k)?Promise.resolve():Promise.resolve(F||"Invalid email address"),url:(k,F)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(k)?Promise.resolve():Promise.resolve(F||"Invalid URL")};function Hs(k){(function zc(k){k.inputValidator||Object.keys(Ai).forEach(F=>{k.input===F&&(k.inputValidator=Ai[F])})})(k),k.showLoaderOnConfirm&&!k.preConfirm&&kt("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function Ia(k){(!k.target||"string"==typeof k.target&&!document.querySelector(k.target)||"string"!=typeof k.target&&!k.target.appendChild)&&(kt('Target parameter is not valid, defaulting to "body"'),k.target="body")}(k),"string"==typeof k.title&&(k.title=k.title.split("\n").join("<br />")),Ol(k)}let Zr;class Cn{constructor(){if(typeof window>"u")return;Zr=this;for(var F=arguments.length,G=new Array(F),fe=0;fe<F;fe++)G[fe]=arguments[fe];const Xe=Object.freeze(this.constructor.argsToParams(G));Object.defineProperties(this,{params:{value:Xe,writable:!1,enumerable:!0,configurable:!0}});const an=Zr._main(Zr.params);Jt.promise.set(this,an)}_main(F){let G=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(k=>{!1===k.backdrop&&k.allowOutsideClick&&kt('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const F in k)td(F),k.toast&&nd(F),Wd(F)})(Object.assign({},G,F)),wn.currentInstance&&(wn.currentInstance._destroy(),yn()&&sr()),wn.currentInstance=Zr;const fe=lo(F,G);Hs(fe),Object.freeze(fe),wn.timeout&&(wn.timeout.stop(),delete wn.timeout),clearTimeout(wn.restoreFocusTimeout);const Xe=Xd(Zr);return In(Zr,fe),Jt.innerParams.set(Zr,fe),ra(Zr,Xe,fe)}then(F){return Jt.promise.get(this).then(F)}finally(F){return Jt.promise.get(this).finally(F)}}const ra=(k,F,G)=>new Promise((fe,Xe)=>{const an=Pi=>{k.close({isDismissed:!0,dismiss:Pi})};Vs.swalPromiseResolve.set(k,fe),Vs.swalPromiseReject.set(k,Xe),F.confirmButton.onclick=()=>{(k=>{const F=Jt.innerParams.get(k);k.disableButtons(),F.input?xi(k,"confirm"):is(k,!0)})(k)},F.denyButton.onclick=()=>{(k=>{const F=Jt.innerParams.get(k);k.disableButtons(),F.returnInputValueOnDeny?xi(k,"deny"):hl(k,!1)})(k)},F.cancelButton.onclick=()=>{((k,F)=>{k.disableButtons(),F(or.cancel)})(k,an)},F.closeButton.onclick=()=>{an(or.close)},((k,F,G)=>{Jt.innerParams.get(k).toast?lp(k,F,G):(Yd(F),Rc(F),ii(k,F,G))})(k,F,an),((k,F,G,fe)=>{bi(F),G.toast||(F.keydownHandler=Xe=>Sn(k,Xe,fe),F.keydownTarget=G.keydownListenerCapture?window:ae(),F.keydownListenerCapture=G.keydownListenerCapture,F.keydownTarget.addEventListener("keydown",F.keydownHandler,{capture:F.keydownListenerCapture}),F.keydownHandlerAdded=!0)})(k,wn,G,an),((k,F)=>{"select"===F.input||"radio"===F.input?zn(k,F):["text","email","number","tel","textarea"].includes(F.input)&&(Yn(F.inputValue)||pt(F.inputValue))&&(Lo(fr()),Pc(k,F))})(k,G),Xl(G),Lr(wn,G,an),Bo(F,G),setTimeout(()=>{F.container.scrollTop=0})}),lo=(k,F)=>{const G=(k=>{const F="string"==typeof k.template?document.querySelector(k.template):k.template;if(!F)return{};const G=F.content;return Cu(G),Object.assign(Es(G),ur(G),Oc(G),Lc(G),jn(G),Nc(G),Bc(G,$s))})(k),fe=Object.assign({},dn,F,G,k);return fe.showClass=Object.assign({},dn.showClass,fe.showClass),fe.hideClass=Object.assign({},dn.hideClass,fe.hideClass),fe},Xd=k=>{const F={popup:ae(),container:tn(),actions:Ro(),confirmButton:fr(),denyButton:mr(),cancelButton:gn(),loader:vo(),closeButton:_a(),validationMessage:er(),progressSteps:Ui()};return Jt.domCache.set(k,F),F},Lr=(k,F,G)=>{const fe=Zo();gr(fe),F.timer&&(k.timeout=new rs(()=>{G("timer"),delete k.timeout},F.timer),F.timerProgressBar&&(ir(fe),ei(fe,F,"timerProgressBar"),setTimeout(()=>{k.timeout&&k.timeout.running&&ya(F.timer)})))},Bo=(k,F)=>{if(!F.toast){if(!un(F.allowEnterKey))return void ka();Eu(k,F)||Cr(-1,1)}},Eu=(k,F)=>F.focusDeny&&Fr(k.denyButton)?(k.denyButton.focus(),!0):F.focusCancel&&Fr(k.cancelButton)?(k.cancelButton.focus(),!0):!(!F.focusConfirm||!Fr(k.confirmButton)||(k.confirmButton.focus(),0)),ka=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)){const k=new Date,F=localStorage.getItem("swal-initiation");F?(k.getTime()-Date.parse(F))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const G=document.createElement("audio");G.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",G.loop=!0,document.body.appendChild(G),setTimeout(()=>{G.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${k}`)}Object.assign(Cn.prototype,ta),Object.assign(Cn,Li),Object.keys(ta).forEach(k=>{Cn[k]=function(){if(Zr)return Zr[k](...arguments)}}),Cn.DismissReason=or,Cn.version="11.7.5";const Pa=Cn;return Pa.default=Pa,Pa}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(Jt,pi){var Nt=Jt.createElement("style");if(Jt.getElementsByTagName("head")[0].appendChild(Nt),Nt.styleSheet)Nt.styleSheet.disabled||(Nt.styleSheet.cssText=pi);else try{Nt.innerHTML=pi}catch{Nt.innerText=pi}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')}},Tr=>{Tr(Tr.s=121)}]);