(self.webpackChunkReservaciones=self.webpackChunkReservaciones||[]).push([[179],{811:(Fr,tn,pi)=>{"use strict";function Vt(n){return"function"==typeof n}function $e(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Hi=$e(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function f(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ze{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Vt(i))try{i()}catch(s){e=s instanceof Hi?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Tt(s)}catch(u){e=e??[],u instanceof Hi?e=[...e,...u.errors]:e.push(u)}}if(e)throw new Hi(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Tt(e);else{if(e instanceof ze){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&f(t,e)}remove(e){const{_finalizers:t}=this;t&&f(t,e),e instanceof ze&&e._removeParent(this)}}ze.EMPTY=(()=>{const n=new ze;return n.closed=!0,n})();const Qt=ze.EMPTY;function Pt(n){return n instanceof ze||n&&"closed"in n&&Vt(n.remove)&&Vt(n.add)&&Vt(n.unsubscribe)}function Tt(n){Vt(n)?n():n.unsubscribe()}const qe={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},xt={setTimeout(n,e,...t){const{delegate:i}=xt;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=xt;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Bt(n){xt.setTimeout(()=>{const{onUnhandledError:e}=qe;if(!e)throw n;e(n)})}function dn(){}const Kn=rn("C",void 0,void 0);function rn(n,e,t){return{kind:n,value:e,error:t}}let nn=null;function st(n){if(qe.useDeprecatedSynchronousErrorHandling){const e=!nn;if(e&&(nn={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=nn;if(nn=null,t)throw i}}else n()}class De extends ze{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Pt(e)&&e.add(this)):this.destination=_n}static create(e,t,i){return new ki(e,t,i)}next(e){this.isStopped?xr(function mt(n){return rn("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?xr(function Ot(n){return rn("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?xr(Kn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const at=Function.prototype.bind;function vt(n,e){return at.call(n,e)}class yn{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){Gi(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){Gi(i)}else Gi(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Gi(t)}}}class ki extends De{constructor(e,t,i){let r;if(super(),Vt(e)||!e)r={next:e??void 0,error:t??void 0,complete:i??void 0};else{let s;this&&qe.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&vt(e.next,s),error:e.error&&vt(e.error,s),complete:e.complete&&vt(e.complete,s)}):r=e}this.destination=new yn(r)}}function Gi(n){qe.useDeprecatedSynchronousErrorHandling?function ue(n){qe.useDeprecatedSynchronousErrorHandling&&nn&&(nn.errorThrown=!0,nn.error=n)}(n):Bt(n)}function xr(n,e){const{onStoppedNotification:t}=qe;t&&xt.setTimeout(()=>t(n,e))}const _n={closed:!0,next:dn,error:function ir(n){throw n},complete:dn},wr="function"==typeof Symbol&&Symbol.observable||"@@observable";function Lr(n){return n}function qo(n){return 0===n.length?Lr:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let xn=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function ta(n){return n&&n instanceof De||function za(n){return n&&Vt(n.next)&&Vt(n.error)&&Vt(n.complete)}(n)&&Pt(n)}(t)?t:new ki(t,i,r);return st(()=>{const{operator:u,source:m}=this;s.add(u?u.call(s,m):m?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=cs(i))((r,s)=>{const u=new ki({next:m=>{try{t(m)}catch(v){s(v),u.unsubscribe()}},error:s,complete:r});this.subscribe(u)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[wr](){return this}pipe(...t){return qo(t)(this)}toPromise(t){return new(t=cs(t))((i,r)=>{let s;this.subscribe(u=>s=u,u=>r(u),()=>i(s))})}}return n.create=e=>new n(e),n})();function cs(n){var e;return null!==(e=n??qe.Promise)&&void 0!==e?e:Promise}const us=$e(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let si=(()=>{class n extends xn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new ds(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new us}next(t){st(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){st(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){st(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?Qt:(this.currentObservers=null,s.push(t),new ze(()=>{this.currentObservers=null,f(s,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new xn;return t.source=this,t}}return n.create=(e,t)=>new ds(e,t),n})();class ds extends si{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Qt}}function Ns(n){return Vt(n?.lift)}function ti(n){return e=>{if(Ns(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function zn(n,e,t,i,r){return new dr(n,e,t,i,r)}class dr extends De{constructor(e,t,i,r,s,u){super(e),this.onFinalize=s,this.shouldUnsubscribe=u,this._next=t?function(m){try{t(m)}catch(v){e.error(v)}}:super._next,this._error=r?function(m){try{r(m)}catch(v){e.error(v)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(m){e.error(m)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function cn(n,e){return ti((t,i)=>{let r=0;t.subscribe(zn(i,s=>{i.next(n.call(e,s,r++))}))})}function So(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]])}return t}function zs(n){return this instanceof zs?(this.v=n,this):new zs(n)}function Zc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function na(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(u){return new Promise(function(m,v){!function r(s,u,m,v){Promise.resolve(v).then(function(C){s({value:C,done:m})},u)}(m,v,(u=n[s](u)).done,u.value)})}}}const ja=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Kc(n){return Vt(n?.then)}function kl(n){return Vt(n[wr])}function ps(n){return Symbol.asyncIterator&&Vt(n?.[Symbol.asyncIterator])}function Ao(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Xc=function $a(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ha(n){return Vt(n?.[Xc])}function oe(n){return function Ua(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(j){i[j]&&(r[j]=function(K){return new Promise(function(ie,we){s.push([j,K,ie,we])>1||m(j,K)})})}function m(j,K){try{!function v(j){j.value instanceof zs?Promise.resolve(j.value.v).then(C,S):R(s[0][2],j)}(i[j](K))}catch(ie){R(s[0][3],ie)}}function C(j){m("next",j)}function S(j){m("throw",j)}function R(j,K){j(K),s.shift(),s.length&&m(s[0][0],s[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield zs(t.read());if(r)return yield zs(void 0);yield yield zs(i)}}finally{t.releaseLock()}})}function H(n){return Vt(n?.getReader)}function W(n){if(n instanceof xn)return n;if(null!=n){if(kl(n))return function re(n){return new xn(e=>{const t=n[wr]();if(Vt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(ja(n))return function fe(n){return new xn(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Kc(n))return function Ee(n){return new xn(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Bt)})}(n);if(ps(n))return Me(n);if(Ha(n))return function ke(n){return new xn(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(H(n))return function Te(n){return Me(oe(n))}(n)}throw Ao(n)}function Me(n){return new xn(e=>{(function Le(n,e){var t,i,r,s;return function Yo(n,e,t,i){return new(t||(t=Promise))(function(s,u){function m(S){try{C(i.next(S))}catch(R){u(R)}}function v(S){try{C(i.throw(S))}catch(R){u(R)}}function C(S){S.done?s(S.value):function r(s){return s instanceof t?s:new t(function(u){u(s)})}(S.value).then(m,v)}C((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Zc(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(u){r={error:u}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function rt(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function tt(n,e,t=1/0){return Vt(e)?tt((i,r)=>cn((s,u)=>e(i,s,r,u))(W(n(i,r))),t):("number"==typeof e&&(t=e),ti((i,r)=>function At(n,e,t,i,r,s,u,m){const v=[];let C=0,S=0,R=!1;const j=()=>{R&&!v.length&&!C&&e.complete()},K=we=>C<i?ie(we):v.push(we),ie=we=>{s&&e.next(we),C++;let Oe=!1;W(t(we,S++)).subscribe(zn(e,Ke=>{r?.(Ke),s?K(Ke):e.next(Ke)},()=>{Oe=!0},void 0,()=>{if(Oe)try{for(C--;v.length&&C<i;){const Ke=v.shift();u?rt(e,u,()=>ie(Ke)):ie(Ke)}j()}catch(Ke){e.error(Ke)}}))};return n.subscribe(zn(e,K,()=>{R=!0,j()})),()=>{m?.()}}(i,r,n,t)))}function jt(n=1/0){return tt(Lr,n)}const zt=new xn(n=>n.complete());function Dn(n){return n&&Vt(n.schedule)}function Qn(n){return n[n.length-1]}function on(n){return Vt(Qn(n))?n.pop():void 0}function ii(n){return Dn(Qn(n))?n.pop():void 0}function Vs(n,e=0){return ti((t,i)=>{t.subscribe(zn(i,r=>rt(i,n,()=>i.next(r),e),()=>rt(i,n,()=>i.complete(),e),r=>rt(i,n,()=>i.error(r),e)))})}function ms(n,e=0){return ti((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function Nd(n,e){if(!n)throw new Error("Iterable cannot be null");return new xn(t=>{rt(t,e,()=>{const i=n[Symbol.asyncIterator]();rt(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function hr(n,e){return e?function sc(n,e){if(null!=n){if(kl(n))return function Ye(n,e){return W(n).pipe(ms(e),Vs(e))}(n,e);if(ja(n))return function lr(n,e){return new xn(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Kc(n))return function ba(n,e){return W(n).pipe(ms(e),Vs(e))}(n,e);if(ps(n))return Nd(n,e);if(Ha(n))return function Ga(n,e){return new xn(t=>{let i;return rt(t,e,()=>{i=n[Xc](),rt(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(u){return void t.error(u)}s?t.complete():t.next(r)},0,!0)}),()=>Vt(i?.return)&&i.return()})}(n,e);if(H(n))return function ra(n,e){return Nd(oe(n),e)}(n,e)}throw Ao(n)}(n,e):W(n)}function xa(...n){const e=ii(n),t=function Di(n,e){return"number"==typeof Qn(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?W(i[0]):jt(t)(hr(i,e)):zt}function kn(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new ki({next:()=>{i.unsubscribe(),n()}});return W(e(...t)).subscribe(i)}function qt(n){for(let e in n)if(n[e]===qt)return e;throw Error("Could not find renamed property on target object.")}function gs(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function xi(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(xi).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function An(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const ac=qt({__forward_ref__:qt});function mi(n){return n.__forward_ref__=mi,n.toString=function(){return xi(this())},n}function mn(n){return cr(n)?n():n}function cr(n){return"function"==typeof n&&n.hasOwnProperty(ac)&&n.__forward_ref__===mi}function wi(n){return n&&!!n.\u0275providers}const Mr="https://g.co/ng/security#xss";class ot extends Error{constructor(e,t){super(oa(e,t)),this.code=e}}function oa(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function Sn(n){return"string"==typeof n?n:null==n?"":String(n)}function sa(n,e){throw new ot(-201,!1)}function Nr(n,e){null==n&&function ai(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function Mt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Pn(n){return{providers:n.providers||[],imports:n.imports||[]}}function dc(n){return qa(n,Us)||qa(n,fc)}function qa(n,e){return n.hasOwnProperty(e)?n[e]:null}function eu(n){return n&&(n.hasOwnProperty(ko)||n.hasOwnProperty(zh))?n[ko]:null}const Us=qt({\u0275prov:qt}),ko=qt({\u0275inj:qt}),fc=qt({ngInjectableDef:qt}),zh=qt({ngInjectorDef:qt});var hn=(()=>((hn=hn||{})[hn.Default=0]="Default",hn[hn.Host=1]="Host",hn[hn.Self=2]="Self",hn[hn.SkipSelf=4]="SkipSelf",hn[hn.Optional=8]="Optional",hn))();let pc;function Ro(n){const e=pc;return pc=n,e}function tu(n,e,t){const i=dc(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&hn.Optional?null:void 0!==e?e:void sa(xi(n))}const zi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),js={},ri="__NG_DI_FLAG__",Ya="ngTempTokenPath",Ud="ngTokenPath",nu=/\n/gm,gc="\u0275",Pl="__source";let wa;function Ko(n){const e=wa;return wa=n,e}function Xu(n,e=hn.Default){if(void 0===wa)throw new ot(-203,!1);return null===wa?tu(n,void 0,e):wa.get(n,e&hn.Optional?null:void 0,e)}function lt(n,e=hn.Default){return(function Vh(){return pc}()||Xu)(mn(n),e)}function En(n,e=hn.Default){return lt(n,Ol(e))}function Ol(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function iu(n){const e=[];for(let t=0;t<n.length;t++){const i=mn(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ot(900,!1);let r,s=hn.Default;for(let u=0;u<i.length;u++){const m=i[u],v=ru(m);"number"==typeof v?-1===v?r=m.token:s|=v:r=m}e.push(lt(r,s))}else e.push(lt(i))}return e}function Vn(n,e){return n[ri]=e,n.prototype[ri]=e,n}function ru(n){return n[ri]}function _s(n){return{toString:n}.toString()}var ys=(()=>((ys=ys||{})[ys.OnPush=0]="OnPush",ys[ys.Default=1]="Default",ys))(),Xo=(()=>{return(n=Xo||(Xo={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Xo;var n})();const aa={},Ei=[],Fl=qt({\u0275cmp:qt}),Ll=qt({\u0275dir:qt}),Nl=qt({\u0275pipe:qt}),_c=qt({\u0275mod:qt}),vs=qt({\u0275fac:qt}),yc=qt({__NG_ELEMENT_ID__:qt});let gp=0;function pr(n){return _s(()=>{const e=vc(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ys.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||Xo.Emulated,id:"c"+gp++,styles:n.styles||Ei,_:null,schemas:n.schemas||null,tView:null};jd(t);const i=n.dependencies;return t.directiveDefs=Bl(i,!1),t.pipeDefs=Bl(i,!0),t})}function $h(n){return Ci(n)||Rr(n)}function ou(n){return null!==n}function Yn(n){return _s(()=>({type:n.type,bootstrap:n.bootstrap||Ei,declarations:n.declarations||Ei,imports:n.imports||Ei,exports:n.exports||Ei,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function su(n,e){if(null==n)return aa;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}function vn(n){return _s(()=>{const e=vc(n);return jd(e),e})}function Br(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Ci(n){return n[Fl]||null}function Rr(n){return n[Ll]||null}function yo(n){return n[Nl]||null}function Po(n,e){const t=n[_c]||null;if(!t&&!0===e)throw new Error(`Type ${xi(n)} does not have '\u0275mod' property.`);return t}function vc(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||Ei,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:su(n.inputs,e),outputs:su(n.outputs)}}function jd(n){n.features?.forEach(e=>e(n))}function Bl(n,e){if(!n)return null;const t=e?yo:$h;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(ou)}const $s=0,Wt=1,jn=2,Vi=3,bs=4,ca=5,Hr=6,Hs=7,mr=8,au=9,lu=10,$n=11,cu=12,uu=13,Ju=14,Oo=15,zr=16,bc=17,Xa=18,xs=19,ws=20,zl=21,Ri=22,Qa=1,ua=2,ro=7,Cn=8,Ta=9,vo=10;function Gr(n){return Array.isArray(n)&&"object"==typeof n[Qa]}function Qo(n){return Array.isArray(n)&&!0===n[Qa]}function ed(n){return 0!=(4&n.flags)}function Ja(n){return n.componentOffset>-1}function el(n){return 1==(1&n.flags)}function O(n){return!!n.template}function L(n){return 0!=(256&n[jn])}function hu(n,e){return n.hasOwnProperty(vs)?n[vs]:null}class og{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Fo(){return qh}function qh(n){return n.type.prototype.ngOnChanges&&(n.setInput=sg),Zh}function Zh(){const n=Yh(this),e=n?.current;if(e){const t=n.previous;if(t===aa)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function sg(n,e,t,i){const r=this.declaredInputs[t],s=Yh(n)||function ag(n,e){return n[fu]=e}(n,{previous:aa,current:null}),u=s.current||(s.current={}),m=s.previous,v=m[r];u[r]=new og(v&&v.currentValue,e,m===aa),n[i]=e}Fo.ngInherit=!0;const fu="__ngSimpleChanges__";function Yh(n){return n[fu]||null}const Es=function(n,e,t){};function Vr(n){for(;Array.isArray(n);)n=n[$s];return n}function qd(n,e){return Vr(e[n])}function Cs(n,e){return Vr(e[n.index])}function bp(n,e){return n.data[e]}function Wi(n,e){const t=e[n];return Gr(t)?t:t[$s]}function Zd(n){return 64==(64&n[jn])}function Ul(n,e){return null==e?null:n[e]}function tl(n){n[Xa]=0}function Xh(n,e){n[ca]+=e;let t=n,i=n[Vi];for(;null!==i&&(1===e&&1===t[ca]||-1===e&&0===t[ca]);)i[ca]+=e,t=i,i=i[Vi]}const Tn={lFrame:P(null),bindingsEnabled:!0};function id(){return Tn.bindingsEnabled}function gt(){return Tn.lFrame.lView}function di(){return Tn.lFrame.tView}function Wr(){let n=rd();for(;null!==n&&64===n.type;)n=n.parent;return n}function rd(){return Tn.lFrame.currentTNode}function Jo(n,e){const t=Tn.lFrame;t.currentTNode=n,t.isParent=e}function od(){return Tn.lFrame.isParent}function Jh(){Tn.lFrame.isParent=!1}function Lo(){const n=Tn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function mu(){return Tn.lFrame.bindingIndex++}function tf(n,e){const t=Tn.lFrame;t.bindingIndex=t.bindingRootIndex=n,g(e)}function g(n){Tn.lFrame.currentDirectiveIndex=n}function h(){return Tn.lFrame.currentQueryIndex}function y(n){Tn.lFrame.currentQueryIndex=n}function x(n){const e=n[Wt];return 2===e.type?e.declTNode:1===e.type?n[Hr]:null}function E(n,e,t){if(t&hn.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&hn.Host||(r=x(s),null===r||(s=s[Oo],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Tn.lFrame=M();return i.currentTNode=e,i.lView=n,!0}function D(n){const e=M(),t=n[Wt];Tn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function M(){const n=Tn.lFrame,e=null===n?null:n.child;return null===e?P(n):e}function P(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function z(){const n=Tn.lFrame;return Tn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const B=z;function $(){const n=z();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function te(){return Tn.lFrame.selectedIndex}function ne(n){Tn.lFrame.selectedIndex=n}function J(){const n=Tn.lFrame;return bp(n.tView,n.selectedIndex)}function Ce(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:u,ngAfterContentChecked:m,ngAfterViewInit:v,ngAfterViewChecked:C,ngOnDestroy:S}=s;u&&(n.contentHooks??(n.contentHooks=[])).push(-t,u),m&&((n.contentHooks??(n.contentHooks=[])).push(t,m),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(t,m)),v&&(n.viewHooks??(n.viewHooks=[])).push(-t,v),C&&((n.viewHooks??(n.viewHooks=[])).push(t,C),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(t,C)),null!=S&&(n.destroyHooks??(n.destroyHooks=[])).push(t,S)}}function Ae(n,e,t){yt(n,e,3,t)}function Ne(n,e,t,i){(3&n[jn])===t&&yt(n,e,t,i)}function Ve(n,e){let t=n[jn];(3&t)===e&&(t&=2047,t+=1,n[jn]=t)}function yt(n,e,t,i){const s=i??-1,u=e.length-1;let m=0;for(let v=void 0!==i?65535&n[Xa]:0;v<u;v++)if("number"==typeof e[v+1]){if(m=e[v],null!=i&&m>=i)break}else e[v]<0&&(n[Xa]+=65536),(m<s||-1==s)&&(Pe(n,t,e,v),n[Xa]=(4294901760&n[Xa])+v+2),v++}function Pe(n,e,t,i){const r=t[i]<0,s=t[i+1],m=n[r?-t[i]:t[i]];if(r){if(n[jn]>>11<n[Xa]>>16&&(3&n[jn])===e){n[jn]+=2048,Es(4,m,s);try{s.call(m)}finally{Es(5,m,s)}}}else{Es(4,m,s);try{s.call(m)}finally{Es(5,m,s)}}}const et=-1;class We{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Ft(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const s=t[i++],u=t[i++],m=t[i++];n.setAttribute(e,u,m,s)}else{const s=r,u=t[++i];Kt(s)?n.setProperty(e,s,u):n.setAttribute(e,s,u),i++}}return i}function kt(n){return 3===n||4===n||6===n}function Kt(n){return 64===n.charCodeAt(0)}function Rn(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||Jt(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function Jt(n,e,t,i,r){let s=0,u=n.length;if(-1===e)u=-1;else for(;s<n.length;){const m=n[s++];if("number"==typeof m){if(m===e){u=-1;break}if(m>e){u=s-1;break}}}for(;s<n.length;){const m=n[s];if("number"==typeof m)break;if(m===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==u&&(n.splice(u,0,e),s=u+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function _i(n){return n!==et}function hi(n){return 32767&n}function Si(n,e){let t=function qi(n){return n>>16}(n),i=e;for(;t>0;)i=i[Oo],t--;return i}let gr=!0;function xo(n){const e=gr;return gr=n,e}const ol=255,Qi=5;let Ui=0;const Fn={};function qr(n,e){const t=wo(n,e);if(-1!==t)return t;const i=e[Wt];i.firstCreatePass&&(n.injectorIndex=e.length,ji(i.data,n),ji(e,null),ji(i.blueprint,null));const r=ao(n,e),s=n.injectorIndex;if(_i(r)){const u=hi(r),m=Si(r,e),v=m[Wt].data;for(let C=0;C<8;C++)e[s+C]=m[u+C]|v[u+C]}return e[s+8]=r,s}function ji(n,e){n.push(0,0,0,0,0,0,0,0,e)}function wo(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function ao(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=xy(r),null===i)return et;if(t++,r=r[Oo],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return et}function sl(n,e,t){!function _r(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(yc)&&(i=t[yc]),null==i&&(i=t[yc]=Ui++);const r=i&ol;e.data[n+(r>>Qi)]|=1<<r}(n,e,t)}function Ts(n,e,t){if(t&hn.Optional||void 0!==n)return n;sa()}function Gs(n,e,t,i){if(t&hn.Optional&&void 0===i&&(i=null),!(t&(hn.Self|hn.Host))){const r=n[au],s=Ro(void 0);try{return r?r.get(e,i,t&hn.Optional):tu(e,i,t&hn.Optional)}finally{Ro(s)}}return Ts(i,0,t)}function al(n,e,t,i=hn.Default,r){if(null!==n){if(1024&e[jn]){const u=function ox(n,e,t,i,r){let s=n,u=e;for(;null!==s&&null!==u&&1024&u[jn]&&!(256&u[jn]);){const m=jl(s,u,t,i|hn.Self,Fn);if(m!==Fn)return m;let v=s.parent;if(!v){const C=u[zl];if(C){const S=C.get(t,Fn,i);if(S!==Fn)return S}v=xy(u),u=u[Oo]}s=v}return r}(n,e,t,i,Fn);if(u!==Fn)return u}const s=jl(n,e,t,i,Fn);if(s!==Fn)return s}return Gs(e,t,i,r)}function jl(n,e,t,i,r){const s=function yy(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(yc)?n[yc]:void 0;return"number"==typeof e?e>=0?e&ol:rx:e}(t);if("function"==typeof s){if(!E(e,n,i))return i&hn.Host?Ts(r,0,i):Gs(e,t,i,r);try{const u=s(i);if(null!=u||i&hn.Optional)return u;sa()}finally{B()}}else if("number"==typeof s){let u=null,m=wo(n,e),v=et,C=i&hn.Host?e[zr][Hr]:null;for((-1===m||i&hn.SkipSelf)&&(v=-1===m?ao(n,e):e[m+8],v!==et&&by(i,!1)?(u=e[Wt],m=hi(v),e=Si(v,e)):m=-1);-1!==m;){const S=e[Wt];if(vy(s,m,S.data)){const R=wc(m,e,t,u,i,C);if(R!==Fn)return R}v=e[m+8],v!==et&&by(i,e[Wt].data[m+8]===C)&&vy(s,m,e)?(u=S,m=hi(v),e=Si(v,e)):m=-1}}return r}function wc(n,e,t,i,r,s){const u=e[Wt],m=u.data[n+8],S=$l(m,u,t,null==i?Ja(m)&&gr:i!=u&&0!=(3&m.type),r&hn.Host&&s===m);return null!==S?ad(e,u,S,m):Fn}function $l(n,e,t,i,r){const s=n.providerIndexes,u=e.data,m=1048575&s,v=n.directiveStart,S=s>>20,j=r?m+S:n.directiveEnd;for(let K=i?m:m+S;K<j;K++){const ie=u[K];if(K<v&&t===ie||K>=v&&ie.type===t)return K}if(r){const K=u[v];if(K&&O(K)&&K.type===t)return v}return null}function ad(n,e,t,i){let r=n[t];const s=e.data;if(function ht(n){return n instanceof We}(r)){const u=r;u.resolving&&function Qc(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ot(-200,`Circular dependency in DI detected for ${n}${t}`)}(function gi(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Sn(n)}(s[t]));const m=xo(u.canSeeViewProviders);u.resolving=!0;const v=u.injectImpl?Ro(u.injectImpl):null;E(n,i,hn.Default);try{r=n[t]=u.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function ye(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const u=qh(e);(t.preOrderHooks??(t.preOrderHooks=[])).push(n,u),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,u)}r&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks??(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==v&&Ro(v),xo(m),u.resolving=!1,B()}}return r}function vy(n,e,t){return!!(t[e+(n>>Qi)]&1<<n)}function by(n,e){return!(n&hn.Self||n&hn.Host&&e)}class Jd{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return al(this._tNode,this._lView,e,Ol(i),t)}}function rx(){return new Jd(Wr(),gt())}function No(n){return _s(()=>{const e=n.prototype.constructor,t=e[vs]||fg(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[vs]||fg(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function fg(n){return cr(n)?()=>{const e=fg(mn(n));return e&&e()}:hu(n)}function xy(n){const e=n[Wt],t=e.type;return 2===t?e.declTNode:1===t?n[Hr]:null}const rf="__parameters__";function ld(n,e,t){return _s(()=>{const i=function Ip(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const u=new r(...s);return m.annotation=u,m;function m(v,C,S){const R=v.hasOwnProperty(rf)?v[rf]:Object.defineProperty(v,rf,{value:[]})[rf];for(;R.length<=S;)R.push(null);return(R[S]=R[S]||[]).push(u),v}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Ct{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Mt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function da(n,e){n.forEach(t=>Array.isArray(t)?da(t,e):e(t))}function _u(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Cc(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Sp(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Is(n,e,t){let i=sf(n,e);return i>=0?n[1|i]=t:(i=~i,function vT(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Da(n,e){const t=sf(n,e);if(t>=0)return n[1|t]}function sf(n,e){return function Cr(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),u=n[s<<t];if(e===u)return s<<t;u>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const Tc=Vn(ld("Inject",n=>({token:n})),-1),or=Vn(ld("Optional"),8),Hl=Vn(ld("SkipSelf"),4);var lo=(()=>((lo=lo||{})[lo.Important=1]="Important",lo[lo.DashCase=2]="DashCase",lo))();const hf=new Map;let gx=0;const Lp="__ngContext__";function Yr(n,e){Gr(e)?(n[Lp]=e[ws],function Iy(n){hf.set(n[ws],n)}(e)):n[Lp]=e}let Ry;function Py(n,e){return Ry(n,e)}function gf(n){const e=n[Vi];return Qo(e)?e[Vi]:e}function fl(n){return ml(n[uu])}function pl(n){return ml(n[bs])}function ml(n){for(;null!==n&&!Qo(n);)n=n[bs];return n}function Bo(n,e,t,i,r){if(null!=i){let s,u=!1;Qo(i)?s=i:Gr(i)&&(u=!0,i=i[$s]);const m=Vr(i);0===n&&null!==t?null==r?jy(e,t,m):nh(e,t,m,r||null,!0):1===n&&null!==t?nh(e,t,m,r||null,!0):2===n?function Yy(n,e,t){const i=yf(n,e);i&&function $y(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,m,u):3===n&&e.destroyNode(m),null!=s&&function AT(n,e,t,i,r){const s=t[ro];s!==Vr(t)&&Bo(e,n,i,s,r);for(let m=vo;m<t.length;m++){const v=t[m];Vp(v[Wt],v,n,e,i,s)}}(e,n,s,t,r)}}function xg(n,e,t){return n.createElement(e,t)}function zy(n,e){const t=n[Ta],i=t.indexOf(e),r=e[Vi];512&e[jn]&&(e[jn]&=-513,Xh(r,-1)),t.splice(i,1)}function Vy(n,e){if(n.length<=vo)return;const t=vo+e,i=n[t];if(i){const r=i[bc];null!==r&&r!==n&&zy(r,i),e>0&&(n[t-1][bs]=i[bs]);const s=Cc(n,vo+e);!function _f(n,e){Vp(n,e,e[$n],2,null,null),e[$s]=null,e[Hr]=null}(i[Wt],i);const u=s[xs];null!==u&&u.detachView(s[Wt]),i[Vi]=null,i[bs]=null,i[jn]&=-65}return i}function Sc(n,e){if(!(128&e[jn])){const t=e[$n];t.destroyNode&&Vp(n,e,t,3,null,null),function Ny(n){let e=n[uu];if(!e)return vu(n[Wt],n);for(;e;){let t=null;if(Gr(e))t=e[uu];else{const i=e[vo];i&&(t=i)}if(!t){for(;e&&!e[bs]&&e!==n;)Gr(e)&&vu(e[Wt],e),e=e[Vi];null===e&&(e=n),Gr(e)&&vu(e[Wt],e),t=e&&e[bs]}e=t}}(e)}}function vu(n,e){if(!(128&e[jn])){e[jn]&=-65,e[jn]|=128,function Eg(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof We)){const s=t[i+1];if(Array.isArray(s))for(let u=0;u<s.length;u+=2){const m=r[s[u]],v=s[u+1];Es(4,m,v);try{v.call(m)}finally{Es(5,m,v)}}else{Es(4,r,s);try{s.call(r)}finally{Es(5,r,s)}}}}}(n,e),function wg(n,e){const t=n.cleanup,i=e[Hs];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const u=t[s+3];u>=0?i[r=u]():i[r=-u].unsubscribe(),s+=2}else{const u=i[r=t[s+1]];t[s].call(u)}if(null!==i){for(let s=r+1;s<i.length;s++)(0,i[s])();e[Hs]=null}}(n,e),1===e[Wt].type&&e[$n].destroy();const t=e[bc];if(null!==t&&Qo(e[Vi])){t!==e[Vi]&&zy(t,e);const i=e[xs];null!==i&&i.detachView(n)}!function th(n){hf.delete(n[ws])}(e)}}function Cg(n,e,t){return function Uy(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[$s];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:s}=n.data[i.directiveStart+r];if(s===Xo.None||s===Xo.Emulated)return null}return Cs(i,t)}}(n,e.parent,t)}function nh(n,e,t,i,r){n.insertBefore(e,t,i,r)}function jy(n,e,t){n.appendChild(e,t)}function xx(n,e,t,i,r){null!==i?nh(n,e,t,i,r):jy(n,e,t)}function yf(n,e){return n.parentNode(e)}function Hy(n,e,t){return Gy(n,e,t)}let Wy,gl,fd,Ac,Gy=function hd(n,e,t){return 40&n.type?Cs(n,t):null};function rh(n,e,t,i){const r=Cg(n,i,e),s=e[$n],m=Hy(i.parent||e[Hr],i,e);if(null!=r)if(Array.isArray(t))for(let v=0;v<t.length;v++)xx(s,r,t[v],m,!1);else xx(s,r,t,m,!1);void 0!==Wy&&Wy(s,i,e,t,r)}function zp(n,e){if(null!==e){const t=e.type;if(3&t)return Cs(e,n);if(4&t)return Zy(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return zp(n,i);{const r=n[e.index];return Qo(r)?Zy(-1,r):Vr(r)}}if(32&t)return Py(e,n)()||Vr(n[e.index]);{const i=qy(n,e);return null!==i?Array.isArray(i)?i[0]:zp(gf(n[zr]),i):zp(n,e.next)}}return null}function qy(n,e){return null!==e?n[zr][Hr].projection[e.projection]:null}function Zy(n,e){const t=vo+n+1;if(t<e.length){const i=e[t],r=i[Wt].firstChild;if(null!==r)return zp(i,r)}return e[ro]}function Tg(n,e,t,i,r,s,u){for(;null!=t;){const m=i[t.index],v=t.type;if(u&&0===e&&(m&&Yr(Vr(m),i),t.flags|=2),32!=(32&t.flags))if(8&v)Tg(n,e,t.child,i,r,s,!1),Bo(e,n,r,m,s);else if(32&v){const C=Py(t,i);let S;for(;S=C();)Bo(e,n,r,S,s);Bo(e,n,r,m,s)}else 16&v?Cx(n,e,i,t,r,s):Bo(e,n,r,m,s);t=u?t.projectionNext:t.next}}function Vp(n,e,t,i,r,s){Tg(t,i,n.firstChild,e,r,s,!1)}function Cx(n,e,t,i,r,s){const u=t[zr],v=u[Hr].projection[i.projection];if(Array.isArray(v))for(let C=0;C<v.length;C++)Bo(e,n,r,v[C],s);else Tg(n,e,v,u[Vi],r,s,!0)}function Ky(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Ig(n,e,t){const{mergedAttrs:i,classes:r,styles:s}=t;null!==i&&Ft(n,e,i),null!==r&&Ky(n,e,r),null!==s&&function Ix(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function vf(n){return function Ss(){if(void 0===gl&&(gl=null,zi.trustedTypes))try{gl=zi.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return gl}()?.createHTML(n)||n}function Ax(n){return function oh(){if(void 0===Ac&&(Ac=null,zi.trustedTypes))try{Ac=zi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Ac}()?.createScriptURL(n)||n}class sh{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Mr})`}}class RT extends sh{getTypeName(){return"HTML"}}class PT extends sh{getTypeName(){return"Style"}}class OT extends sh{getTypeName(){return"Script"}}class Jy extends sh{getTypeName(){return"URL"}}class FT extends sh{getTypeName(){return"ResourceURL"}}function Vo(n){return n instanceof sh?n.changingThisBreaksApplicationSecurity:n}function Mc(n,e){const t=function Pr(n){return n instanceof sh&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Mr})`)}return t===e}class kx{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(vf(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch{return null}}}class jp{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){const t=this.inertDocument.createElement("template");return t.innerHTML=vf(e),t}}const nv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function kg(n){return(n=String(n)).match(nv)?n:"unsafe:"+n}function kc(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function bu(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const Rx=kc("area,br,col,hr,img,wbr"),Rg=kc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Px=kc("rp,rt"),rv=bu(Rx,bu(Rg,kc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),bu(Px,kc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),bu(Px,Rg)),ov=kc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Lx=bu(ov,kc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),kc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),LT=kc("script,style,template");class Pg{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!rv.hasOwnProperty(t))return this.sanitizedSomething=!0,!LT.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),u=s.name,m=u.toLowerCase();if(!Lx.hasOwnProperty(m)){this.sanitizedSomething=!0;continue}let v=s.value;ov[m]&&(v=kg(v)),this.buf.push(" ",u,'="',ah(v),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();rv.hasOwnProperty(t)&&!Rx.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(ah(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const NT=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Nx=/([^\#-~ |!])/g;function ah(n){return n.replace(/&/g,"&amp;").replace(NT,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Nx,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Og;function Bx(n,e){let t=null;try{Og=Og||function ev(n){const e=new jp(n);return function tv(){try{return!!(new window.DOMParser).parseFromString(vf(""),"text/html")}catch{return!1}}()?new kx(e):e}(n);let i=e?String(e):"";t=Og.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=Og.getInertBodyElement(i)}while(i!==s);return vf((new Pg).sanitizeChildren(sv(t)||t))}finally{if(t){const i=sv(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function sv(n){return"content"in n&&function zx(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var $i=(()=>(($i=$i||{})[$i.NONE=0]="NONE",$i[$i.HTML=1]="HTML",$i[$i.STYLE=2]="STYLE",$i[$i.SCRIPT=3]="SCRIPT",$i[$i.URL=4]="URL",$i[$i.RESOURCE_URL=5]="RESOURCE_URL",$i))();function av(n){const e=xu();return e?e.sanitize($i.URL,n)||"":Mc(n,"URL")?Vo(n):kg(Sn(n))}function $p(n){const e=xu();if(e)return Ax(e.sanitize($i.RESOURCE_URL,n)||"");if(Mc(n,"ResourceURL"))return Ax(Vo(n));throw new ot(904,!1)}function xu(){const n=gt();return n&&n[cu]}const Hp=new Ct("ENVIRONMENT_INITIALIZER"),Vx=new Ct("INJECTOR",-1),lv=new Ct("INJECTOR_DEF_TYPES");class cv{get(e,t=js){if(t===js){const i=new Error(`NullInjectorError: No provider for ${xi(e)}!`);throw i.name="NullInjectorError",i}return t}}function Ux(...n){return{\u0275providers:uv(0,n),\u0275fromNgModule:!0}}function uv(n,...e){const t=[],i=new Set;let r;return da(e,s=>{const u=s;hv(u,t,[],i)&&(r||(r=[]),r.push(u))}),void 0!==r&&dv(r,t),t}function dv(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];Bg(r,s=>{e.push(s)})}}function hv(n,e,t,i){if(!(n=mn(n)))return!1;let r=null,s=eu(n);const u=!s&&Ci(n);if(s||u){if(u&&!u.standalone)return!1;r=n}else{const v=n.ngModule;if(s=eu(v),!s)return!1;r=v}const m=i.has(r);if(u){if(m)return!1;if(i.add(r),u.dependencies){const v="function"==typeof u.dependencies?u.dependencies():u.dependencies;for(const C of v)hv(C,e,t,i)}}else{if(!s)return!1;{if(null!=s.imports&&!m){let C;i.add(r);try{da(s.imports,S=>{hv(S,e,t,i)&&(C||(C=[]),C.push(S))})}finally{}void 0!==C&&dv(C,e)}if(!m){const C=hu(r)||(()=>new r);e.push({provide:r,useFactory:C,deps:Ei},{provide:lv,useValue:r,multi:!0},{provide:Hp,useValue:()=>lt(r),multi:!0})}const v=s.providers;null==v||m||Bg(v,S=>{e.push(S)})}}return r!==n&&void 0!==n.providers}function Bg(n,e){for(let t of n)wi(t)&&(t=t.\u0275providers),Array.isArray(t)?Bg(t,e):e(t)}const zg=qt({provide:String,useValue:qt});function Vg(n){return null!==n&&"object"==typeof n&&zg in n}function _l(n){return"function"==typeof n}const Ug=new Ct("Set Injector scope."),Wp={},HT={};let fv;function jg(){return void 0===fv&&(fv=new cv),fv}class wu{}class jx extends wu{get destroyed(){return this._destroyed}constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,gv(e,u=>this.processProvider(u)),this.records.set(Vx,lh(void 0,this)),r.has("environment")&&this.records.set(wu,lh(void 0,this));const s=this.records.get(Ug);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(lv.multi,Ei,hn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Ko(this),i=Ro(void 0);try{return e()}finally{Ko(t),Ro(i)}}get(e,t=js,i=hn.Default){this.assertNotDestroyed(),i=Ol(i);const r=Ko(this),s=Ro(void 0);try{if(!(i&hn.SkipSelf)){let m=this.records.get(e);if(void 0===m){const v=function qT(n){return"function"==typeof n||"object"==typeof n&&n instanceof Ct}(e)&&dc(e);m=v&&this.injectableDefInScope(v)?lh(pv(e),Wp):null,this.records.set(e,m)}if(null!=m)return this.hydrate(e,m)}return(i&hn.Self?jg():this.parent).get(e,t=i&hn.Optional&&t===js?null:t)}catch(u){if("NullInjectorError"===u.name){if((u[Ya]=u[Ya]||[]).unshift(xi(e)),r)throw u;return function jh(n,e,t,i){const r=n[Ya];throw e[Pl]&&r.unshift(e[Pl]),n.message=function Qu(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==gc?n.slice(2):n;let r=xi(e);if(Array.isArray(e))r=e.map(xi).join(" -> ");else if("object"==typeof e){let s=[];for(let u in e)if(e.hasOwnProperty(u)){let m=e[u];s.push(u+":"+("string"==typeof m?JSON.stringify(m):xi(m)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(nu,"\n  ")}`}("\n"+n.message,r,t,i),n[Ud]=r,n[Ya]=null,n}(u,e,"R3InjectorError",this.source)}throw u}finally{Ro(s),Ko(r)}}resolveInjectorInitializers(){const e=Ko(this),t=Ro(void 0);try{const i=this.get(Hp.multi,Ei,hn.Self);for(const r of i)r()}finally{Ko(e),Ro(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(xi(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ot(205,!1)}processProvider(e){let t=_l(e=mn(e))?e:mn(e&&e.provide);const i=function GT(n){return Vg(n)?lh(void 0,n.useValue):lh(mv(n),Wp)}(e);if(_l(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=lh(void 0,Wp,!0),r.factory=()=>iu(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Wp&&(t.value=HT,t.value=t.factory()),"object"==typeof t.value&&t.value&&function WT(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=mn(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function pv(n){const e=dc(n),t=null!==e?e.factory:hu(n);if(null!==t)return t;if(n instanceof Ct)throw new ot(204,!1);if(n instanceof Function)return function $g(n){const e=n.length;if(e>0)throw Sp(e,"?"),new ot(204,!1);const t=function Za(n){return n&&(n[Us]||n[fc])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ot(204,!1)}function mv(n,e,t){let i;if(_l(n)){const r=mn(n);return hu(r)||pv(r)}if(Vg(n))i=()=>mn(n.useValue);else if(function xf(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...iu(n.deps||[]));else if(function ts(n){return!(!n||!n.useExisting)}(n))i=()=>lt(mn(n.useExisting));else{const r=mn(n&&(n.useClass||n.provide));if(!function $x(n){return!!n.deps}(n))return hu(r)||pv(r);i=()=>new r(...iu(n.deps))}return i}function lh(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function gv(n,e){for(const t of n)Array.isArray(t)?gv(t,e):t&&wi(t)?gv(t.\u0275providers,e):e(t)}class ZT{}class Hx{}class Rc{resolveComponentFactory(e){throw function Gx(n){const e=Error(`No component factory found for ${xi(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let pd=(()=>{class n{}return n.NULL=new Rc,n})();function Hg(){return Zl(Wr(),gt())}function Zl(n,e){return new Kr(Cs(n,e))}let Kr=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=Hg,n})();function YT(n){return n instanceof Kr?n.nativeElement:n}class Eu{}let Cu=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function KT(){const n=gt(),t=Wi(Wr().index,n);return(Gr(t)?t:n)[$n]}(),n})(),qp=(()=>{class n{}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:()=>null}),n})();class Tu{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const _v=new Tu("15.2.9"),Li={},Zp="ngOriginalError";function Gg(n){return n[Zp]}class As{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Gg(e);for(;t&&Gg(t);)t=Gg(t);return t||null}}function Iu(n){return n instanceof Function?n():n}function Yx(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const Kx="ng-template";function bv(n,e,t){let i=0,r=!0;for(;i<n.length;){let s=n[i++];if("string"==typeof s&&r){const u=n[i++];if(t&&"class"===s&&-1!==Yx(u.toLowerCase(),e,0))return!0}else{if(1===s){for(;i<n.length&&"string"==typeof(s=n[i++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(r=!1)}}return!1}function Wg(n){return 4===n.type&&n.value!==Kx}function Xx(n,e,t){return e===(4!==n.type||t?n.value:Kx)}function Ma(n,e,t){let i=4;const r=n.attrs||[],s=function rI(n){for(let e=0;e<n.length;e++)if(kt(n[e]))return e;return n.length}(r);let u=!1;for(let m=0;m<e.length;m++){const v=e[m];if("number"!=typeof v){if(!u)if(4&i){if(i=2|1&i,""!==v&&!Xx(n,v,t)||""===v&&1===e.length){if(qs(i))return!1;u=!0}}else{const C=8&i?v:e[++m];if(8&i&&null!==n.attrs){if(!bv(n.attrs,C,t)){if(qs(i))return!1;u=!0}continue}const R=Cf(8&i?"class":v,r,Wg(n),t);if(-1===R){if(qs(i))return!1;u=!0;continue}if(""!==C){let j;j=R>s?"":r[R+1].toLowerCase();const K=8&i?j:null;if(K&&-1!==Yx(K,C,0)||2&i&&C!==j){if(qs(i))return!1;u=!0}}}}else{if(!u&&!qs(i)&&!qs(v))return!1;if(u&&qs(v))continue;u=!1,i=v|1&i}}return qs(i)||u}function qs(n){return 0==(1&n)}function Cf(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const u=e[r];if(u===n)return r;if(3===u||6===u)s=!0;else{if(1===u||2===u){let m=e[++r];for(;"string"==typeof m;)m=e[++r];continue}if(4===u)break;if(0===u){r+=4;continue}}r+=s?1:2}return-1}return function Qx(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function qg(n,e,t=!1){for(let i=0;i<e.length;i++)if(Ma(n,e[i],t))return!0;return!1}function Jx(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function ew(n,e){return n?":not("+e.trim()+")":e}function tw(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let u=n[t];if("string"==typeof u)if(2&i){const m=n[++t];r+="["+u+(m.length>0?'="'+m+'"':"")+"]"}else 8&i?r+="."+u:4&i&&(r+=" "+u);else""!==r&&!qs(u)&&(e+=ew(s,r),r=""),i=u,s=s||!qs(i);t++}return""!==r&&(e+=ew(s,r)),e}const Hn={};function oi(n){wv(di(),gt(),te()+n,!1)}function wv(n,e,t,i){if(!i)if(3==(3&e[jn])){const s=n.preOrderCheckHooks;null!==s&&Ae(e,s,t)}else{const s=n.preOrderHooks;null!==s&&Ne(e,s,0,t)}ne(t)}function Tf(n,e=null,t=null,i){const r=Cv(n,e,t,i);return r.resolveInjectorInitializers(),r}function Cv(n,e=null,t=null,i,r=new Set){const s=[t||Ei,Ux(n)];return i=i||("object"==typeof n?void 0:xi(n)),new jx(s,e||jg(),i||null,r)}let Uo=(()=>{class n{static create(t,i){if(Array.isArray(t))return Tf({name:""},i,t,"");{const r=t.name??"";return Tf({name:r},t.parent,t.providers,r)}}}return n.THROW_IF_NOT_FOUND=js,n.NULL=new cv,n.\u0275prov=Mt({token:n,providedIn:"any",factory:()=>lt(Vx)}),n.__NG_ELEMENT_ID__=-1,n})();function nt(n,e=hn.Default){const t=gt();return null===t?lt(n,e):al(Wr(),t,mn(n),e)}function Qp(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const s=t[i+1];if(-1!==s){const u=n.data[s];y(t[i]),u.contentQueries(2,e[s],s)}}}function Su(n,e,t,i,r,s,u,m,v,C,S){const R=e.blueprint.slice();return R[$s]=r,R[jn]=76|i,(null!==S||n&&1024&n[jn])&&(R[jn]|=1024),tl(R),R[Vi]=R[Oo]=n,R[mr]=t,R[lu]=u||n&&n[lu],R[$n]=m||n&&n[$n],R[cu]=v||n&&n[cu]||null,R[au]=C||n&&n[au]||null,R[Hr]=s,R[ws]=function DT(){return gx++}(),R[zl]=S,R[zr]=2==e.type?n[zr]:R,R}function Au(n,e,t,i,r){let s=n.data[e];if(null===s)s=function kv(n,e,t,i,r){const s=rd(),u=od(),v=n.data[e]=function r_(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,u?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=v),null!==s&&(u?null==s.child&&null!==v.parent&&(s.child=v):null===s.next&&(s.next=v,v.prev=s)),v}(n,e,t,i,r),function hg(){return Tn.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const u=function xc(){const n=Tn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===u?-1:u.injectorIndex}return Jo(s,!0),s}function Sf(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function e_(n,e,t){D(e);try{const i=n.viewQuery;null!==i&&a_(1,i,t);const r=n.template;null!==r&&Rv(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Qp(n,e),n.staticViewQueries&&a_(2,n.viewQuery,t);const s=n.components;null!==s&&function fI(n,e){for(let t=0;t<e.length;t++)ww(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[jn]&=-5,$()}}function t_(n,e,t,i){const r=e[jn];if(128!=(128&r)){D(e);try{tl(e),function ef(n){return Tn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Rv(n,e,t,2,i);const u=3==(3&r);if(u){const C=n.preOrderCheckHooks;null!==C&&Ae(e,C,null)}else{const C=n.preOrderHooks;null!==C&&Ne(e,C,0,null),Ve(e,0)}if(function xw(n){for(let e=fl(n);null!==e;e=pl(e)){if(!e[ua])continue;const t=e[Ta];for(let i=0;i<t.length;i++){const r=t[i];512&r[jn]||Xh(r[Vi],1),r[jn]|=512}}}(e),function bw(n){for(let e=fl(n);null!==e;e=pl(e))for(let t=vo;t<e.length;t++){const i=e[t],r=i[Wt];Zd(i)&&t_(r,i,r.template,i[mr])}}(e),null!==n.contentQueries&&Qp(n,e),u){const C=n.contentCheckHooks;null!==C&&Ae(e,C)}else{const C=n.contentHooks;null!==C&&Ne(e,C,1),Ve(e,1)}!function Xp(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)ne(~r);else{const s=r,u=t[++i],m=t[++i];tf(u,s),m(2,e[s])}}}finally{ne(-1)}}(n,e);const m=n.components;null!==m&&function hI(n,e){for(let t=0;t<e.length;t++)Hv(n,e[t])}(e,m);const v=n.viewQuery;if(null!==v&&a_(2,v,i),u){const C=n.viewCheckHooks;null!==C&&Ae(e,C)}else{const C=n.viewHooks;null!==C&&Ne(e,C,2),Ve(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[jn]&=-41,512&e[jn]&&(e[jn]&=-513,Xh(e[Vi],-1))}finally{$()}}}function Rv(n,e,t,i,r){const s=te(),u=2&i;try{ne(-1),u&&e.length>Ri&&wv(n,e,Ri,!1),Es(u?2:0,r),t(i,r)}finally{ne(s),Es(u?3:1,r)}}function Pv(n,e,t){if(ed(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const u=n.data[s];u.contentQueries&&u.contentQueries(1,t[s],s)}}}function n_(n,e,t){id()&&(function Uv(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;Ja(t)&&function Fc(n,e,t){const i=Cs(e,n),r=Fv(t),s=n[lu],u=tm(n,Su(n,r,null,t.onPush?32:16,i,e,s,s.createRenderer(i,t),null,null,null));n[e.index]=u}(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||qr(t,e),Yr(i,e);const u=t.initialInputs;for(let m=r;m<s;m++){const v=n.data[m],C=ad(e,n,m,t);Yr(C,e),null!==u&&yd(0,m-r,C,v,0,u),O(v)&&(Wi(t.index,e)[mr]=ad(e,n,m,t))}}(n,e,t,Cs(t,e)),64==(64&t.flags)&&_w(n,e,t))}function Ov(n,e,t=Cs){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const u=i[s+1],m=-1===u?t(e,n):n[u];n[r++]=m}}}function Fv(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=Lv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function Lv(n,e,t,i,r,s,u,m,v,C){const S=Ri+i,R=S+r,j=function pI(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:Hn);return t}(S,R),K="function"==typeof C?C():C;return j[Wt]={type:n,blueprint:j,template:t,queries:null,viewQuery:m,declTNode:e,data:j.slice().fill(null,S),bindingStartIndex:S,expandoStartIndex:R,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof u?u():u,firstChild:null,schemas:v,consts:K,incompleteFirstPass:!1}}function Jp(n,e,t,i){const r=Wv(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Cw(n).push(i,r.length-1))}function pw(n,e,t,i){for(let r in n)if(n.hasOwnProperty(r)){t=null===t?{}:t;const s=n[r];null===i?o_(t,e,r,s):i.hasOwnProperty(r)&&o_(t,e,i[r],s)}return t}function o_(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function ka(n,e,t,i,r,s,u,m){const v=Cs(e,t);let S,C=e.inputs;!m&&null!=C&&(S=C[i])?(qv(n,t,S,i,r),Ja(e)&&function Bv(n,e){const t=Wi(e,n);16&t[jn]||(t[jn]|=32)}(t,e.index)):3&e.type&&(i=function _d(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=u?u(r,e.value||"",i):r,s.setProperty(v,i,r))}function Vv(n,e,t,i){if(id()){const r=null===i?null:{"":-1},s=function _I(n,e){const t=n.directiveRegistry;let i=null,r=null;if(t)for(let s=0;s<t.length;s++){const u=t[s];if(qg(e,u.selectors,!1))if(i||(i=[]),O(u))if(null!==u.findHostDirectiveDefs){const m=[];r=r||new Map,u.findHostDirectiveDefs(u,m,r),i.unshift(...m,u),jv(n,e,m.length)}else i.unshift(u),jv(n,e,0);else r=r||new Map,u.findHostDirectiveDefs?.(u,i,r),i.push(u)}return null===i?null:[i,r]}(n,t);let u,m;null===s?u=m=null:[u,m]=s,null!==u&&gw(n,e,t,u,r,m),r&&function yw(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new ot(-301,!1);i.push(e[r],s)}}}(t,i,r)}t.mergedAttrs=Rn(t.mergedAttrs,t.attrs)}function gw(n,e,t,i,r,s){for(let C=0;C<i.length;C++)sl(qr(t,e),n,i[C].type);!function vw(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let C=0;C<i.length;C++){const S=i[C];S.providersResolver&&S.providersResolver(S)}let u=!1,m=!1,v=Sf(n,e,i.length,null);for(let C=0;C<i.length;C++){const S=i[C];t.mergedAttrs=Rn(t.mergedAttrs,S.hostAttrs),yl(n,t,e,v,S),yI(v,S,r),null!==S.contentQueries&&(t.flags|=4),(null!==S.hostBindings||null!==S.hostAttrs||0!==S.hostVars)&&(t.flags|=64);const R=S.type.prototype;!u&&(R.ngOnChanges||R.ngOnInit||R.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(t.index),u=!0),!m&&(R.ngOnChanges||R.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(t.index),m=!0),v++}!function Nv(n,e,t){const r=e.directiveEnd,s=n.data,u=e.attrs,m=[];let v=null,C=null;for(let S=e.directiveStart;S<r;S++){const R=s[S],j=t?t.get(R):null,ie=j?j.outputs:null;v=pw(R.inputs,S,v,j?j.inputs:null),C=pw(R.outputs,S,C,ie);const we=null===v||null===u||Wg(e)?null:s_(v,S,u);m.push(we)}null!==v&&(v.hasOwnProperty("class")&&(e.flags|=8),v.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=m,e.inputs=v,e.outputs=C}(n,t,s)}function _w(n,e,t){const i=t.directiveStart,r=t.directiveEnd,s=t.index,u=function Qd(){return Tn.lFrame.currentDirectiveIndex}();try{ne(s);for(let m=i;m<r;m++){const v=n.data[m],C=e[m];g(m),(null!==v.hostBindings||0!==v.hostVars||null!==v.hostAttrs)&&em(v,C)}}finally{ne(-1),g(u)}}function em(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function jv(n,e,t){e.componentOffset=t,(n.components??(n.components=[])).push(e.index)}function yI(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;O(e)&&(t[""]=n)}}function yl(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=hu(r.type)),u=new We(s,O(r),nt);n.blueprint[i]=u,t[i]=u,function mI(n,e,t,i,r){const s=r.hostBindings;if(s){let u=n.hostBindingOpCodes;null===u&&(u=n.hostBindingOpCodes=[]);const m=~e.index;(function gI(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(u)!=m&&u.push(m),u.push(t,i,s)}}(n,e,i,Sf(n,t,r.hostVars,Hn),r)}function is(n,e,t,i,r,s){const u=Cs(n,e);!function vl(n,e,t,i,r,s,u){if(null==s)n.removeAttribute(e,r,t);else{const m=null==u?Sn(s):u(s,i||"",r);n.setAttribute(e,r,m,t)}}(e[$n],u,s,n.value,t,i,r)}function yd(n,e,t,i,r,s){const u=s[e];if(null!==u){const m=i.setInput;for(let v=0;v<u.length;){const C=u[v++],S=u[v++],R=u[v++];null!==m?i.setInput(t,R,C,S):t[S]=R}}}function s_(n,e,t){let i=null,r=0;for(;r<t.length;){const s=t[r];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===i&&(i=[]);const u=n[s];for(let m=0;m<u.length;m+=2)if(u[m]===e){i.push(s,u[m+1],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function $v(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}function Hv(n,e){const t=Wi(e,n);if(Zd(t)){const i=t[Wt];48&t[jn]?t_(i,t,i.template,t[mr]):t[ca]>0&&Gv(t)}}function Gv(n){for(let i=fl(n);null!==i;i=pl(i))for(let r=vo;r<i.length;r++){const s=i[r];if(Zd(s))if(512&s[jn]){const u=s[Wt];t_(u,s,u.template,s[mr])}else s[ca]>0&&Gv(s)}const t=n[Wt].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Wi(t[i],n);Zd(r)&&r[ca]>0&&Gv(r)}}function ww(n,e){const t=Wi(e,n),i=t[Wt];(function Ew(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),e_(i,t,t[mr])}function tm(n,e){return n[uu]?n[Ju][bs]=e:n[uu]=e,n[Ju]=e,e}function nm(n){for(;n;){n[jn]|=32;const e=gf(n);if(L(n)&&!e)return n;n=e}return null}function im(n,e,t,i=!0){const r=e[lu];r.begin&&r.begin();try{t_(n,e,n.template,t)}catch(u){throw i&&rm(e,u),u}finally{r.end&&r.end()}}function a_(n,e,t){y(0),e(n,t)}function Wv(n){return n[Hs]||(n[Hs]=[])}function Cw(n){return n.cleanup||(n.cleanup=[])}function rm(n,e){const t=n[au],i=t?t.get(As,null):null;i&&i.handleError(e)}function qv(n,e,t,i,r){for(let s=0;s<t.length;){const u=t[s++],m=t[s++],v=e[u],C=n.data[u];null!==C.setInput?C.setInput(v,r,i,m):v[m]=r}}function Af(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let u=0;u<e.length;u++){const m=e[u];"number"==typeof m?s=m:1==s?r=An(r,m):2==s&&(i=An(i,m+": "+e[++u]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function Mf(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(Vr(s)),Qo(s))for(let m=vo;m<s.length;m++){const v=s[m],C=v[Wt].firstChild;null!==C&&Mf(v[Wt],v,C,i)}const u=t.type;if(8&u)Mf(n,e,t.child,i);else if(32&u){const m=Py(t,e);let v;for(;v=m();)i.push(v)}else if(16&u){const m=qy(e,t);if(Array.isArray(m))i.push(...m);else{const v=gf(e[zr]);Mf(v[Wt],v,m,i,!0)}}t=r?t.projectionNext:t.next}return i}class pa{get rootNodes(){const e=this._lView,t=e[Wt];return Mf(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[mr]}set context(e){this._lView[mr]=e}get destroyed(){return 128==(128&this._lView[jn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Vi];if(Qo(e)){const t=e[Cn],i=t?t.indexOf(this):-1;i>-1&&(Vy(e,i),Cc(t,i))}this._attachedToViewContainer=!1}Sc(this._lView[Wt],this._lView)}onDestroy(e){Jp(this._lView[Wt],this._lView,null,e)}markForCheck(){nm(this._cdRefInjectingView||this._lView)}detach(){this._lView[jn]&=-65}reattach(){this._lView[jn]|=64}detectChanges(){im(this._lView[Wt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ot(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function bx(n,e){Vp(n,e,e[$n],2,null,null)}(this._lView[Wt],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ot(902,!1);this._appRef=e}}class Zv extends pa{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;im(e[Wt],e,e[mr],!1)}checkNoChanges(){}get context(){return null}}class l_ extends pd{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Ci(e);return new kf(t,this.ngModule)}}function bl(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Iw{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=Ol(i);const r=this.injector.get(e,Li,i);return r!==Li||t===Li?r:this.parentInjector.get(e,t,i)}}class kf extends Hx{get inputs(){return bl(this.componentDef.inputs)}get outputs(){return bl(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function nw(n){return n.map(tw).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,r){let s=(r=r||this.ngModule)instanceof wu?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const u=s?new Iw(e,s):e,m=u.get(Eu,null);if(null===m)throw new ot(407,!1);const v=u.get(qp,null),C=m.createRenderer(null,this.componentDef),S=this.componentDef.selectors[0][0]||"div",R=i?function i_(n,e,t){return n.selectRootElement(e,t===Xo.ShadowDom)}(C,i,this.componentDef.encapsulation):xg(C,S,function dh(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(S)),j=this.componentDef.onPush?288:272,K=Lv(0,null,null,1,0,null,null,null,null,null),ie=Su(null,K,null,j,null,null,m,C,v,u,null);let we,Oe;D(ie);try{const Ke=this.componentDef;let _t,Qe=null;Ke.findHostDirectiveDefs?(_t=[],Qe=new Map,Ke.findHostDirectiveDefs(Ke,_t,Qe),_t.push(Ke)):_t=[Ke];const Ht=function Dw(n,e){const t=n[Wt],i=Ri;return n[i]=e,Au(t,i,2,"#host",null)}(ie,R),ui=function Sw(n,e,t,i,r,s,u,m){const v=r[Wt];!function bI(n,e,t,i){for(const r of n)e.mergedAttrs=Rn(e.mergedAttrs,r.hostAttrs);null!==e.mergedAttrs&&(Af(e,e.mergedAttrs,!0),null!==t&&Ig(i,t,e))}(i,n,e,u);const C=s.createRenderer(e,t),S=Su(r,Fv(t),null,t.onPush?32:16,r[n.index],n,s,C,m||null,null,null);return v.firstCreatePass&&jv(v,n,i.length-1),tm(r,S),r[n.index]=S}(Ht,R,Ke,_t,ie,m,C);Oe=bp(K,Ri),R&&function Mw(n,e,t,i){if(i)Ft(n,t,["ng-version",_v.full]);else{const{attrs:r,classes:s}=function xv(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!qs(r))break;r=s}i++}return{attrs:e,classes:t}}(e.selectors[0]);r&&Ft(n,t,r),s&&s.length>0&&Ky(n,t,s.join(" "))}}(C,Ke,R,i),void 0!==t&&function xI(n,e,t){const i=n.projection=[];for(let r=0;r<e.length;r++){const s=t[r];i.push(null!=s?Array.from(s):null)}}(Oe,this.ngContentSelectors,t),we=function Aw(n,e,t,i,r,s){const u=Wr(),m=r[Wt],v=Cs(u,r);gw(m,r,u,t,null,i);for(let S=0;S<t.length;S++)Yr(ad(r,m,u.directiveStart+S,u),r);_w(m,r,u),v&&Yr(v,r);const C=ad(r,m,u.directiveStart+u.componentOffset,u);if(n[mr]=r[mr]=C,null!==s)for(const S of s)S(C,e);return Pv(m,u,n),C}(ui,Ke,_t,Qe,ie,[Kv]),e_(K,ie,null)}finally{$()}return new om(this.componentType,we,Zl(Oe,ie),ie,Oe)}}class om extends ZT{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new Zv(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const s=this._rootLView;qv(s[Wt],s,r,e,t),nm(Wi(this._tNode.index,s))}}get injector(){return new Jd(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function Kv(){const n=Wr();Ce(gt()[Wt],n)}function Ni(n){let e=function Xv(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(O(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ot(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const u=n;u.inputs=o(n.inputs),u.declaredInputs=o(n.declaredInputs),u.outputs=o(n.outputs);const m=r.hostBindings;m&&p(n,m);const v=r.viewQuery,C=r.contentQueries;if(v&&l(n,v),C&&d(n,C),gs(n.inputs,r.inputs),gs(n.declaredInputs,r.declaredInputs),gs(n.outputs,r.outputs),O(r)&&r.data.animation){const S=n.data;S.animation=(S.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let u=0;u<s.length;u++){const m=s[u];m&&m.ngInherit&&m(n),m===Ni&&(t=!1)}}e=Object.getPrototypeOf(e)}!function a(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Rn(r.hostAttrs,t=Rn(t,r.hostAttrs))}}(i)}function o(n){return n===aa?{}:n===Ei?[]:n}function l(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function d(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function p(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}function G(n){return!!ge(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function ge(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function he(n,e,t){return n[e]=t}function me(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function dt(n,e,t,i){const r=gt();return me(r,mu(),e)&&(di(),is(J(),r,n,e,t,i)),dt}function Xe(n,e,t,i){return me(n,mu(),t)?e+Sn(t)+i:Hn}function Zn(n,e,t,i,r,s,u,m){const v=gt(),C=di(),S=n+Ri,R=C.firstCreatePass?function Bi(n,e,t,i,r,s,u,m,v){const C=e.consts,S=Au(e,n,4,u||null,Ul(C,m));Vv(e,t,S,Ul(C,v)),Ce(e,S);const R=S.tView=Lv(2,S,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,C);return null!==e.queries&&(e.queries.template(e,S),R.queries=e.queries.embeddedTView(S)),S}(S,C,v,e,t,i,r,s,u):C.data[S];Jo(R,!1);const j=v[$n].createComment("");rh(C,v,j,R),Yr(j,v),tm(v,v[S]=$v(j,v,j,R)),el(R)&&n_(C,v,R),null!=u&&Ov(v,R,m)}function sn(n,e,t){const i=gt();return me(i,mu(),e)&&ka(di(),J(),i,n,e,i[$n],t,!1),sn}function sr(n,e,t,i,r){const u=r?"class":"style";qv(n,t,e.inputs[u],u,i)}function pe(n,e,t,i){const r=gt(),s=di(),u=Ri+n,m=r[$n],v=s.firstCreatePass?function Eo(n,e,t,i,r,s){const u=e.consts,v=Au(e,n,2,i,Ul(u,r));return Vv(e,t,v,Ul(u,s)),null!==v.attrs&&Af(v,v.attrs,!1),null!==v.mergedAttrs&&Af(v,v.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,v),v}(u,s,r,e,t,i):s.data[u],C=r[u]=xg(m,e,function xe(){return Tn.lFrame.currentNamespace}()),S=el(v);return Jo(v,!0),Ig(m,C,v),32!=(32&v.flags)&&rh(s,r,C,v),0===function Nt(){return Tn.lFrame.elementDepthCount}()&&Yr(C,r),function cg(){Tn.lFrame.elementDepthCount++}(),S&&(n_(s,r,v),Pv(s,v,r)),null!==i&&Ov(r,v),pe}function be(){let n=Wr();od()?Jh():(n=n.parent,Jo(n,!1));const e=n;!function Yd(){Tn.lFrame.elementDepthCount--}();const t=di();return t.firstCreatePass&&(Ce(t,n),ed(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function ct(n){return 0!=(8&n.flags)}(e)&&sr(t,e,gt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function ft(n){return 0!=(16&n.flags)}(e)&&sr(t,e,gt(),e.stylesWithoutHost,!1),be}function St(n,e,t,i){return pe(n,e,t,i),be(),St}function Xr(n){return!!n&&"function"==typeof n.then}const Qr=function uo(n){return!!n&&"function"==typeof n.subscribe};function $t(n,e,t,i){const r=gt(),s=di(),u=Wr();return function hh(n,e,t,i,r,s,u){const m=el(i),C=n.firstCreatePass&&Cw(n),S=e[mr],R=Wv(e);let j=!0;if(3&i.type||u){const we=Cs(i,e),Oe=u?u(we):we,Ke=R.length,_t=u?Ht=>u(Vr(Ht[i.index])):i.index;let Qe=null;if(!u&&m&&(Qe=function Mu(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const u=r[s];if(u===t&&r[s+1]===i){const m=e[Hs],v=r[s+2];return m.length>v?m[v]:null}"string"==typeof u&&(s+=2)}return null}(n,e,r,i.index)),null!==Qe)(Qe.__ngLastListenerFn__||Qe).__ngNextListenerFn__=s,Qe.__ngLastListenerFn__=s,j=!1;else{s=Pf(i,e,S,s,!1);const Ht=t.listen(Oe,r,s);R.push(s,Ht),C&&C.push(r,_t,Ke,Ke+1)}}else s=Pf(i,e,S,s,!1);const K=i.outputs;let ie;if(j&&null!==K&&(ie=K[r])){const we=ie.length;if(we)for(let Oe=0;Oe<we;Oe+=2){const ui=e[ie[Oe]][ie[Oe+1]].subscribe(s),Oi=R.length;R.push(s,ui),C&&C.push(r,i.index,Oi,-(Oi+1))}}}(s,r,r[$n],u,n,e,i),$t}function Rf(n,e,t,i){try{return Es(6,e,t),!1!==t(i)}catch(r){return rm(n,r),!1}finally{Es(7,e,t)}}function Pf(n,e,t,i,r){return function s(u){if(u===Function)return i;nm(n.componentOffset>-1?Wi(n.index,e):e);let v=Rf(e,t,i,u),C=s.__ngNextListenerFn__;for(;C;)v=Rf(e,t,C,u)&&v,C=C.__ngNextListenerFn__;return r&&!1===v&&(u.preventDefault(),u.returnValue=!1),v}}function Qv(n=1){return function X(n){return(Tn.lFrame.contextLView=function ee(n,e){for(;n>0;)e=e[Oo],n--;return e}(n,Tn.lFrame.contextLView))[mr]}(n)}function kw(n,e){let t=null;const i=function Zg(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?qg(n,s,!0):Jx(i,s))return r}else t=r}return t}function Of(n,e,t){return xl(n,"",e,"",t),Of}function xl(n,e,t,i,r){const s=gt(),u=Xe(s,e,t,i);return u!==Hn&&ka(di(),J(),s,n,u,s[$n],r,!1),xl}function rs(n,e){return n<<17|e<<2}function wl(n){return n>>17&32767}function Ru(n){return 2|n}function sm(n){return(131068&n)>>2}function wI(n,e){return-131069&n|e<<2}function EI(n){return 1|n}function YO(n,e,t,i,r){const s=n[t+1],u=null===e;let m=i?wl(s):sm(s),v=!1;for(;0!==m&&(!1===v||u);){const S=n[m+1];GH(n[m],e)&&(v=!0,n[m+1]=i?EI(S):Ru(S)),m=i?wl(S):sm(S)}v&&(n[t+1]=i?Ru(s):EI(s))}function GH(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&sf(n,e)>=0}function CI(n,e,t){return Pu(n,e,t,!1),CI}function nb(n,e){return Pu(n,e,null,!0),nb}function Pu(n,e,t,i){const r=gt(),s=di(),u=function il(n){const e=Tn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function iF(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[te()],u=function nF(n,e){return e>=n.expandoStartIndex}(n,t);(function aF(n,e){return 0!=(n.flags&(e?8:16))})(s,i)&&null===e&&!u&&(e=!1),e=function e6(n,e,t,i){const r=function c(n){const e=Tn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ib(t=TI(null,n,e,t,i),e.attrs,i),s=null);else{const u=e.directiveStylingLast;if(-1===u||n[u]!==r)if(t=TI(r,n,e,t,i),null===s){let v=function t6(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==sm(i))return n[wl(i)]}(n,e,i);void 0!==v&&Array.isArray(v)&&(v=TI(null,n,e,v[1],i),v=ib(v,e.attrs,i),function n6(n,e,t,i){n[wl(t?e.classBindings:e.styleBindings)]=i}(n,e,i,v))}else s=function r6(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ib(i,n[s].hostAttrs,t);return ib(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function $H(n,e,t,i,r,s){let u=s?e.classBindings:e.styleBindings,m=wl(u),v=sm(u);n[i]=t;let S,C=!1;if(Array.isArray(t)?(S=t[1],(null===S||sf(t,S)>0)&&(C=!0)):S=t,r)if(0!==v){const j=wl(n[m+1]);n[i+1]=rs(j,m),0!==j&&(n[j+1]=wI(n[j+1],i)),n[m+1]=function Pw(n,e){return 131071&n|e<<17}(n[m+1],i)}else n[i+1]=rs(m,0),0!==m&&(n[m+1]=wI(n[m+1],i)),m=i;else n[i+1]=rs(v,0),0===m?m=i:n[v+1]=wI(n[v+1],i),v=i;C&&(n[i+1]=Ru(n[i+1])),YO(n,S,i,!0),YO(n,S,i,!1),function HH(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&sf(s,e)>=0&&(t[i+1]=EI(t[i+1]))}(e,S,n,i,s),u=rs(m,v),s?e.classBindings=u:e.styleBindings=u}(r,s,e,t,u,i)}}(s,n,u,i),e!==Hn&&me(r,u,e)&&function oF(n,e,t,i,r,s,u,m){if(!(3&e.type))return;const v=n.data,C=v[m+1],S=function jH(n){return 1==(1&n)}(C)?sF(v,e,t,r,sm(C),u):void 0;Ow(S)||(Ow(s)||function tb(n){return 2==(2&n)}(C)&&(s=sF(v,null,t,r,m,u)),function Tx(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let s=-1===i.indexOf("-")?void 0:lo.DashCase;null==r?n.removeStyle(t,i,s):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=lo.Important),n.setStyle(t,i,r,s))}}(i,u,qd(te(),t),r,s))}(s,s.data[te()],r,r[$n],n,r[u+1]=function l6(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=xi(Vo(n)))),n}(e,t),i,u)}function TI(n,e,t,i,r){let s=null;const u=t.directiveEnd;let m=t.directiveStylingLast;for(-1===m?m=t.directiveStart:m++;m<u&&(s=e[m],i=ib(i,s.hostAttrs,r),s!==n);)m++;return null!==n&&(t.directiveStylingLast=m),i}function ib(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const u=e[s];"number"==typeof u?r=u:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Is(n,u,!!t||e[++s]))}return void 0===n?null:n}function sF(n,e,t,i,r,s){const u=null===e;let m;for(;r>0;){const v=n[r],C=Array.isArray(v),S=C?v[1]:v,R=null===S;let j=t[r+1];j===Hn&&(j=R?Ei:void 0);let K=R?Da(j,i):S===i?j:void 0;if(C&&!Ow(K)&&(K=Da(v,i)),Ow(K)&&(m=K,u))return m;const ie=n[r+1];r=u?wl(ie):sm(ie)}if(null!==e){let v=s?e.residualClasses:e.residualStyles;null!=v&&(m=Da(v,i))}return m}function Ow(n){return void 0!==n}function Re(n,e=""){const t=gt(),i=di(),r=n+Ri,s=i.firstCreatePass?Au(i,r,1,e,null):i.data[r],u=t[r]=function co(n,e){return n.createText(e)}(t[$n],e);rh(i,t,u,s),Jo(s,!1)}function fh(n){return rb("",n,""),fh}function rb(n,e,t){const i=gt(),r=Xe(i,n,e,t);return r!==Hn&&function fa(n,e,t){const i=qd(e,n);!function Fy(n,e,t){n.setValue(e,t)}(n[$n],i,t)}(i,te(),r),rb}const m_="en-US";let SF=m_;function AI(n,e,t,i,r){if(n=mn(n),Array.isArray(n))for(let s=0;s<n.length;s++)AI(n[s],e,t,i,r);else{const s=di(),u=gt();let m=_l(n)?n:mn(n.provide),v=mv(n);const C=Wr(),S=1048575&C.providerIndexes,R=C.directiveStart,j=C.providerIndexes>>20;if(_l(n)||!n.multi){const K=new We(v,r,nt),ie=kI(m,e,r?S:S+j,R);-1===ie?(sl(qr(C,u),s,m),MI(s,n,e.length),e.push(m),C.directiveStart++,C.directiveEnd++,r&&(C.providerIndexes+=1048576),t.push(K),u.push(K)):(t[ie]=K,u[ie]=K)}else{const K=kI(m,e,S+j,R),ie=kI(m,e,S,S+j),Oe=ie>=0&&t[ie];if(r&&!Oe||!r&&!(K>=0&&t[K])){sl(qr(C,u),s,m);const Ke=function IG(n,e,t,i,r){const s=new We(n,t,nt);return s.multi=[],s.index=e,s.componentProviders=0,JF(s,r,i&&!t),s}(r?TG:CG,t.length,r,i,v);!r&&Oe&&(t[ie].providerFactory=Ke),MI(s,n,e.length,0),e.push(m),C.directiveStart++,C.directiveEnd++,r&&(C.providerIndexes+=1048576),t.push(Ke),u.push(Ke)}else MI(s,n,K>-1?K:ie,JF(t[r?ie:K],v,!r&&i));!r&&i&&Oe&&t[ie].componentProviders++}}}function MI(n,e,t,i){const r=_l(e),s=function Gp(n){return!!n.useClass}(e);if(r||s){const v=(s?mn(e.useClass):e).prototype.ngOnDestroy;if(v){const C=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const S=C.indexOf(t);-1===S?C.push(t,[i,v]):C[S+1].push(i,v)}else C.push(t,v)}}}function JF(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function kI(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function CG(n,e,t,i){return RI(this.multi,[])}function TG(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const u=this.providerFactory.componentProviders,m=ad(t,t[Wt],this.providerFactory.index,i);s=m.slice(0,u),RI(r,s);for(let v=u;v<m.length;v++)s.push(m[v])}else s=[],RI(r,s);return s}function RI(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Tr(n,e=[]){return t=>{t.providersResolver=(i,r)=>function EG(n,e,t){const i=di();if(i.firstCreatePass){const r=O(n);AI(t,i.data,i.blueprint,r,!0),AI(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class g_{}class eL{}class tL extends g_{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new l_(this);const i=Po(e);this._bootstrapComponents=Iu(i.bootstrap),this._r3Injector=Cv(e,t,[{provide:g_,useValue:this},{provide:pd,useValue:this.componentFactoryResolver}],xi(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class PI extends eL{constructor(e){super(),this.moduleType=e}create(e){return new tL(this.moduleType,e)}}class SG extends g_{constructor(e,t,i){super(),this.componentFactoryResolver=new l_(this),this.instance=null;const r=new jx([...e,{provide:g_,useValue:this},{provide:pd,useValue:this.componentFactoryResolver}],t||jg(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function zw(n,e,t=null){return new SG(n,e,t).injector}let AG=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=uv(0,t.type),r=i.length>0?zw([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,r)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Mt({token:n,providedIn:"environment",factory:()=>new n(lt(wu))}),n})();function OI(n){n.getStandaloneInjector=e=>e.get(AG).getOrCreateStandaloneInjector(n)}function Vw(n,e,t,i){return function lL(n,e,t,i,r,s){const u=e+t;return me(n,u,r)?he(n,u+1,s?i.call(s,r):i(r)):ub(n,u+1)}(gt(),Lo(),n,e,t,i)}function ub(n,e){const t=n[e];return t===Hn?void 0:t}function cL(n,e,t,i,r,s,u){const m=e+t;return function Be(n,e,t,i){const r=me(n,e,t);return me(n,e+1,i)||r}(n,m,r,s)?he(n,m+2,u?i.call(u,r,s):i(r,s)):ub(n,m+2)}function pL(n,e,t,i){const r=n+Ri,s=gt(),u=function Vl(n,e){return n[e]}(s,r);return function db(n,e){return n[Wt].data[e].pure}(s,r)?cL(s,Lo(),e,u.transform,t,i,u):u.transform(t,i)}function LI(n){return e=>{setTimeout(n,void 0,e)}}const Ir=class QG extends si{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let r=e,s=t||(()=>null),u=i;if(e&&"object"==typeof e){const v=e;r=v.next?.bind(v),s=v.error?.bind(v),u=v.complete?.bind(v)}this.__isAsync&&(s=LI(s),r&&(r=LI(r)),u&&(u=LI(u)));const m=super.subscribe({next:r,error:s,complete:u});return e instanceof ze&&e.add(m),m}};function JG(){return this._results[Symbol.iterator]()}class NI{get changes(){return this._changes||(this._changes=new Ir)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=NI.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=JG)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=function Ur(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function gu(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let ph=(()=>{class n{}return n.__NG_ELEMENT_ID__=n8,n})();const e8=ph,t8=class extends e8{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tView,r=Su(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[bc]=this._declarationLView[this._declarationTContainer.index];const u=this._declarationLView[xs];return null!==u&&(r[xs]=u.createEmbeddedView(i)),e_(i,r,e),new pa(r)}};function n8(){return Uw(Wr(),gt())}function Uw(n,e){return 4&n.type?new t8(e,n,Zl(n,e)):null}let Fu=(()=>{class n{}return n.__NG_ELEMENT_ID__=r8,n})();function r8(){return _L(Wr(),gt())}const o8=Fu,mL=class extends o8{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Zl(this._hostTNode,this._hostLView)}get injector(){return new Jd(this._hostTNode,this._hostLView)}get parentInjector(){const e=ao(this._hostTNode,this._hostLView);if(_i(e)){const t=Si(e,this._hostLView),i=hi(e);return new Jd(t[Wt].data[i+8],t)}return new Jd(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=gL(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-vo}createEmbeddedView(e,t,i){let r,s;"number"==typeof i?r=i:null!=i&&(r=i.index,s=i.injector);const u=e.createEmbeddedView(t||{},s);return this.insert(u,r),u}createComponent(e,t,i,r,s){const u=e&&!function Ec(n){return"function"==typeof n}(e);let m;if(u)m=t;else{const R=t||{};m=R.index,i=R.injector,r=R.projectableNodes,s=R.environmentInjector||R.ngModuleRef}const v=u?e:new kf(Ci(e)),C=i||this.parentInjector;if(!s&&null==v.ngModule){const j=(u?C:this.parentInjector).get(wu,null);j&&(s=j)}const S=v.create(C,r,void 0,s);return this.insert(S.hostView,m),S}insert(e,t){const i=e._lView,r=i[Wt];if(function _y(n){return Qo(n[Vi])}(i)){const S=this.indexOf(e);if(-1!==S)this.detach(S);else{const R=i[Vi],j=new mL(R,R[Hr],R[Vi]);j.detach(j.indexOf(e))}}const s=this._adjustIndex(t),u=this._lContainer;!function ST(n,e,t,i){const r=vo+i,s=t.length;i>0&&(t[r-1][bs]=e),i<s-vo?(e[bs]=t[r],_u(t,vo+i,e)):(t.push(e),e[bs]=null),e[Vi]=t;const u=e[bc];null!==u&&t!==u&&function By(n,e){const t=n[Ta];e[zr]!==e[Vi][Vi][zr]&&(n[ua]=!0),null===t?n[Ta]=[e]:t.push(e)}(u,e);const m=e[xs];null!==m&&m.insertView(n),e[jn]|=64}(r,i,u,s);const m=Zy(s,u),v=i[$n],C=yf(v,u[ro]);return null!==C&&function Ly(n,e,t,i,r,s){i[$s]=r,i[Hr]=e,Vp(n,i,t,1,r,s)}(r,u[Hr],v,i,C,m),e.attachToViewContainerRef(),_u(BI(u),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=gL(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Vy(this._lContainer,t);i&&(Cc(BI(this._lContainer),t),Sc(i[Wt],i))}detach(e){const t=this._adjustIndex(e,-1),i=Vy(this._lContainer,t);return i&&null!=Cc(BI(this._lContainer),t)?new pa(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function gL(n){return n[Cn]}function BI(n){return n[Cn]||(n[Cn]=[])}function _L(n,e){let t;const i=e[n.index];if(Qo(i))t=i;else{let r;if(8&n.type)r=Vr(i);else{const s=e[$n];r=s.createComment("");const u=Cs(n,e);nh(s,yf(s,u),r,function wx(n,e){return n.nextSibling(e)}(s,u),!1)}e[n.index]=t=$v(i,e,r,n),tm(e,t)}return new mL(t,n,e)}class zI{constructor(e){this.queryList=e,this.matches=null}clone(){return new zI(this.queryList)}setDirty(){this.queryList.setDirty()}}class VI{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const u=t.getByIndex(s);r.push(this.queries[u.indexInDeclarationView].clone())}return new VI(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==CL(e,t).matches&&this.queries[t].setDirty()}}class yL{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class UI{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new UI(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class jI{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new jI(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,s8(t,s)),this.matchTNodeWithReadOption(e,t,$l(t,e,s,!1,!1))}else i===ph?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,$l(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Kr||r===Fu||r===ph&&4&t.type)this.addMatch(t.index,-2);else{const s=$l(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function s8(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function l8(n,e,t,i){return-1===t?function a8(n,e){return 11&n.type?Zl(n,e):4&n.type?Uw(n,e):null}(e,n):-2===t?function c8(n,e,t){return t===Kr?Zl(e,n):t===ph?Uw(e,n):t===Fu?_L(e,n):void 0}(n,e,i):ad(n,n[Wt],t,e)}function vL(n,e,t,i){const r=e[xs].queries[i];if(null===r.matches){const s=n.data,u=t.matches,m=[];for(let v=0;v<u.length;v+=2){const C=u[v];m.push(C<0?null:l8(e,s[C],u[v+1],t.metadata.read))}r.matches=m}return r.matches}function $I(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const u=vL(n,e,r,t);for(let m=0;m<s.length;m+=2){const v=s[m];if(v>0)i.push(u[m/2]);else{const C=s[m+1],S=e[-v];for(let R=vo;R<S.length;R++){const j=S[R];j[bc]===j[Vi]&&$I(j[Wt],j,C,i)}if(null!==S[Ta]){const R=S[Ta];for(let j=0;j<R.length;j++){const K=R[j];$I(K[Wt],K,C,i)}}}}}return i}function HI(n){const e=gt(),t=di(),i=h();y(i+1);const r=CL(t,i);if(n.dirty&&function gy(n){return 4==(4&n[jn])}(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?$I(t,e,i,[]):vL(t,e,r,i);n.reset(s,YT),n.notifyOnChanges()}return!0}return!1}function bL(n,e,t){const i=di();i.firstCreatePass&&(function EL(n,e,t){null===n.queries&&(n.queries=new UI),n.queries.track(new jI(e,t))}(i,new yL(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function wL(n,e,t){const i=new NI(4==(4&t));Jp(n,e,i,i.destroy),null===e[xs]&&(e[xs]=new VI),e[xs].queries.push(new zI(i))}(i,gt(),e)}function CL(n,e){return n.queries.getByIndex(e)}function $w(...n){}const fb=new Ct("Application Initializer");let Hw=(()=>{class n{constructor(t){this.appInits=t,this.resolve=$w,this.reject=$w,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Xr(s))t.push(s);else if(Qr(s)){const u=new Promise((m,v)=>{s.subscribe({complete:m,error:v})});t.push(u)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(lt(fb,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const pb=new Ct("AppId",{providedIn:"root",factory:function jL(){return`${XI()}${XI()}${XI()}`}});function XI(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const $L=new Ct("Platform Initializer"),lm=new Ct("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),QI=new Ct("AnimationModuleType");let R8=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const wd=new Ct("LocaleId",{providedIn:"root",factory:()=>En(wd,hn.Optional|hn.SkipSelf)||function P8(){return typeof $localize<"u"&&$localize.locale||m_}()});class F8{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let HL=(()=>{class n{compileModuleSync(t){return new PI(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Iu(Po(t).declarations).reduce((u,m)=>{const v=Ci(m);return v&&u.push(new kf(v)),u},[]);return new F8(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const B8=(()=>Promise.resolve(0))();function JI(n){typeof Zone>"u"?B8.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class Ti{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ir(!1),this.onMicrotaskEmpty=new Ir(!1),this.onStable=new Ir(!1),this.onError=new Ir(!1),typeof Zone>"u")throw new ot(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function z8(){let n=zi.requestAnimationFrame,e=zi.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function j8(n){const e=()=>{!function U8(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(zi,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,tD(n),n.isCheckStableRunning=!0,eD(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),tD(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,u,m)=>{try{return qL(n),t.invokeTask(r,s,u,m)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),ZL(n)}},onInvoke:(t,i,r,s,u,m,v)=>{try{return qL(n),t.invoke(r,s,u,m,v)}finally{n.shouldCoalesceRunChangeDetection&&e(),ZL(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,tD(n),eD(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ti.isInAngularZone())throw new ot(909,!1)}static assertNotInAngularZone(){if(Ti.isInAngularZone())throw new ot(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,u=s.scheduleEventTask("NgZoneEvent: "+r,e,V8,$w,$w);try{return s.runTask(u,t,i)}finally{s.cancelTask(u)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const V8={};function eD(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function tD(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function qL(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function ZL(n){n._nesting--,eD(n)}class $8{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ir,this.onMicrotaskEmpty=new Ir,this.onStable=new Ir,this.onError=new Ir}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const YL=new Ct(""),Gw=new Ct("");let rD,nD=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,rD||(function H8(n){rD=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ti.assertNotInAngularZone(),JI(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())JI(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(u=>u.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(lt(Ti),lt(iD),lt(Gw))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),iD=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return rD?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const mh=!1;let Ff=null;const KL=new Ct("AllowMultipleToken"),oD=new Ct("PlatformDestroyListeners"),XL=new Ct("appBootstrapListener");class QL{constructor(e,t){this.name=e,this.token=t}}function eN(n,e,t=[]){const i=`Platform: ${e}`,r=new Ct(i);return(s=[])=>{let u=sD();if(!u||u.injector.get(KL,!1)){const m=[...t,...s,{provide:r,useValue:!0}];n?n(m):function q8(n){if(Ff&&!Ff.get(KL,!1))throw new ot(400,!1);Ff=n;const e=n.get(nN);(function JL(n){const e=n.get($L,null);e&&e.forEach(t=>t())})(n)}(function tN(n=[],e){return Uo.create({name:e,providers:[{provide:Ug,useValue:"platform"},{provide:oD,useValue:new Set([()=>Ff=null])},...n]})}(m,i))}return function Y8(n){const e=sD();if(!e)throw new ot(401,!1);return e}()}}function sD(){return Ff?.get(nN)??null}let nN=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function rN(n,e){let t;return t="noop"===n?new $8:("zone.js"===n?void 0:n)||new Ti(e),t}(i?.ngZone,function iN(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),s=[{provide:Ti,useValue:r}];return r.run(()=>{const u=Uo.create({providers:s,parent:this.injector,name:t.moduleType.name}),m=t.create(u),v=m.injector.get(As,null);if(!v)throw new ot(402,!1);return r.runOutsideAngular(()=>{const C=r.onError.subscribe({next:S=>{v.handleError(S)}});m.onDestroy(()=>{Ww(this._modules,m),C.unsubscribe()})}),function oN(n,e,t){try{const i=t();return Xr(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(v,r,()=>{const C=m.injector.get(Hw);return C.runInitializers(),C.donePromise.then(()=>(function AF(n){Nr(n,"Expected localeId to be defined"),"string"==typeof n&&(SF=n.toLowerCase().replace(/_/g,"-"))}(m.injector.get(wd,m_)||m_),this._moduleDoBootstrap(m),m))})})}bootstrapModule(t,i=[]){const r=sN({},i);return function G8(n,e,t){const i=new PI(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(cm);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new ot(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ot(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(oD,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(lt(Uo))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function sN(n,e){return Array.isArray(e)?e.reduce(sN,n):{...n,...e}}let cm=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new xn(m=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{m.next(this._stable),m.complete()})}),u=new xn(m=>{let v;this._zone.runOutsideAngular(()=>{v=this._zone.onStable.subscribe(()=>{Ti.assertNotInAngularZone(),JI(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,m.next(!0))})})});const C=this._zone.onUnstable.subscribe(()=>{Ti.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{m.next(!1)}))});return()=>{v.unsubscribe(),C.unsubscribe()}});this.isStable=xa(s,u.pipe(function Et(n={}){const{connector:e=(()=>new si),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let u,m,v,C=0,S=!1,R=!1;const j=()=>{m?.unsubscribe(),m=void 0},K=()=>{j(),u=v=void 0,S=R=!1},ie=()=>{const we=u;K(),we?.unsubscribe()};return ti((we,Oe)=>{C++,!R&&!S&&j();const Ke=v=v??e();Oe.add(()=>{C--,0===C&&!R&&!S&&(m=kn(ie,r))}),Ke.subscribe(Oe),!u&&C>0&&(u=new ki({next:_t=>Ke.next(_t),error:_t=>{R=!0,j(),m=kn(K,t,_t),Ke.error(_t)},complete:()=>{S=!0,j(),m=kn(K,i),Ke.complete()}}),W(we).subscribe(u))})(s)}}()))}bootstrap(t,i){const r=t instanceof Hx;if(!this._injector.get(Hw).done){!r&&function Ca(n){const e=Ci(n)||Rr(n)||yo(n);return null!==e&&e.standalone}(t);throw new ot(405,mh)}let u;u=r?t:this._injector.get(pd).resolveComponentFactory(t),this.componentTypes.push(u.componentType);const m=function W8(n){return n.isBoundToModule}(u)?void 0:this._injector.get(g_),C=u.create(Uo.NULL,[],i||u.selector,m),S=C.location.nativeElement,R=C.injector.get(YL,null);return R?.registerApplication(S),C.onDestroy(()=>{this.detachView(C.hostView),Ww(this.components,C),R?.unregisterApplication(S)}),this._loadComponent(C),C}tick(){if(this._runningTick)throw new ot(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;Ww(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(XL,[]);i.push(...this._bootstrapListeners),i.forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Ww(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ot(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(lt(Ti),lt(wu),lt(As))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Ww(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let mb=(()=>{class n{}return n.__NG_ELEMENT_ID__=Q8,n})();function Q8(n){return function J8(n,e,t){if(Ja(n)&&!t){const i=Wi(n.index,e);return new pa(i,i)}return 47&n.type?new pa(e[zr],e):null}(Wr(),gt(),16==(16&n))}class dN{constructor(){}supports(e){return G(e)}create(e){return new oW(e)}}const rW=(n,e)=>e;class oW{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||rW}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const u=!i||t&&t.currentIndex<fN(i,r,s)?t:i,m=fN(u,r,s),v=u.currentIndex;if(u===i)r--,i=i._nextRemoved;else if(t=t._next,null==u.previousIndex)r++;else{s||(s=[]);const C=m-r,S=v-r;if(C!=S){for(let j=0;j<C;j++){const K=j<s.length?s[j]:s[j]=0,ie=K+j;S<=ie&&ie<C&&(s[j]=K+1)}s[u.previousIndex]=S-C}}m!==v&&e(u,m,v)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!G(e))throw new ot(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,u,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let m=0;m<this.length;m++)s=e[m],u=this._trackByFn(m,s),null!==t&&Object.is(t.trackById,u)?(i&&(t=this._verifyReinsertion(t,s,u,m)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,u,m),i=!0),t=t._next}else r=0,function ae(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,m=>{u=this._trackByFn(r,m),null!==t&&Object.is(t.trackById,u)?(i&&(t=this._verifyReinsertion(t,m,u,r)),Object.is(t.item,m)||this._addIdentityChange(t,m)):(t=this._mismatch(t,m,u,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new sW(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new hN),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new hN),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class sW{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class aW{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class hN{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new aW,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function fN(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class pN{constructor(){}supports(e){return e instanceof Map||ge(e)}create(){return new lW}}class lW{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||ge(e)))throw new ot(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,u=r._next;return s&&(s._next=u),u&&(u._prev=s),r._next=null,r._prev=null,r}const i=new cW(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class cW{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function mN(){return new Yw([new dN])}let Yw=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||mN()),deps:[[n,new Hl,new or]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new ot(901,!1)}}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:mN}),n})();function gN(){return new gb([new pN])}let gb=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||gN()),deps:[[n,new Hl,new or]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new ot(901,!1)}}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:gN}),n})();const hW=eN(null,"core",[]);let fW=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(lt(cm))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();function v_(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let dD=null;function gh(){return dD}class gW{}const Yi=new Ct("DocumentToken");let hD=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return function _W(){return lt(_N)}()},providedIn:"platform"}),n})();const yW=new Ct("Location Initialized");let _N=(()=>{class n extends hD{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return gh().getBaseHref(this._doc)}onPopState(t){const i=gh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=gh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){yN()?this._history.pushState(t,i,r):this._location.hash=r}replaceState(t,i,r){yN()?this._history.replaceState(t,i,r):this._location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:function(){return function vW(){return new _N(lt(Yi))}()},providedIn:"platform"}),n})();function yN(){return!!window.history.pushState}function fD(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function vN(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function _h(n){return n&&"?"!==n[0]?"?"+n:n}let dm=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return En(xN)},providedIn:"root"}),n})();const bN=new Ct("appBaseHref");let xN=(()=>{class n extends dm{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??En(Yi).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return fD(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+_h(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const u=this.prepareExternalUrl(r+_h(s));this._platformLocation.pushState(t,i,u)}replaceState(t,i,r,s){const u=this.prepareExternalUrl(r+_h(s));this._platformLocation.replaceState(t,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(lt(hD),lt(bN,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),bW=(()=>{class n extends dm{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=fD(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let u=this.prepareExternalUrl(r+_h(s));0==u.length&&(u=this._platformLocation.pathname),this._platformLocation.pushState(t,i,u)}replaceState(t,i,r,s){let u=this.prepareExternalUrl(r+_h(s));0==u.length&&(u=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,u)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(lt(hD),lt(bN,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),Kw=(()=>{class n{constructor(t){this._subject=new Ir,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function EW(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(vN(wN(i))),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+_h(i))}normalize(t){return n.stripTrailingSlash(function wW(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,wN(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_h(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+_h(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=_h,n.joinWithSlash=fD,n.stripTrailingSlash=vN,n.\u0275fac=function(t){return new(t||n)(lt(dm))},n.\u0275prov=Mt({token:n,factory:function(){return function xW(){return new Kw(lt(dm))}()},providedIn:"root"}),n})();function wN(n){return n.replace(/\/index.html$/,"")}const ED=/\s+/,kN=[];let CD=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this.initialClasses=kN,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(ED):kN}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(ED):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,Boolean(t[i]));this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(ED).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(nt(Yw),nt(gb),nt(Kr),nt(Cu))},n.\u0275dir=vn({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),n})();class lq{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let a1=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,u)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new lq(r.item,this._ngForOf,-1,-1),null===u?void 0:u);else if(null==u)i.remove(null===s?void 0:s);else if(null!==s){const m=i.get(s);i.move(m,u),ON(m,r)}});for(let r=0,s=i.length;r<s;r++){const m=i.get(r).context;m.index=r,m.count=s,m.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{ON(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(nt(Fu),nt(ph),nt(Yw))},n.\u0275dir=vn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function ON(n,e){n.context.$implicit=e.item}let TD=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new uq,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){FN("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){FN("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(nt(Fu),nt(ph))},n.\u0275dir=vn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class uq{constructor(){this.$implicit=null,this.ngIf=null}}function FN(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${xi(e)}'.`)}class ID{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let l1=(()=>{class n{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews.length>0&&t!==this._defaultUsed){this._defaultUsed=t;for(const i of this._defaultViews)i.enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=vn({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),n})(),LN=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new ID(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(nt(Fu),nt(ph),nt(l1,9))},n.\u0275dir=vn({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),n})(),BN=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split("."),u=-1===r.indexOf("-")?void 0:lo.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,s?`${i}${s}`:i,u):this._renderer.removeStyle(this._ngEl.nativeElement,r,u)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(gb),nt(Cu))},n.\u0275dir=vn({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})(),b_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();const VN="browser";function AD(n){return n===VN}let Bq=(()=>{class n{}return n.\u0275prov=Mt({token:n,providedIn:"root",factory:()=>new zq(lt(Yi),window)}),n})();class zq{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Vq(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const u=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(u)return u}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=UN(this.window.history)||UN(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function UN(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class m7 extends gW{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class RD extends m7{static makeCurrent(){!function mW(n){dD||(dD=n)}(new RD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function g7(){return bb=bb||document.querySelector("base"),bb?bb.getAttribute("href"):null}();return null==t?null:function _7(n){d1=d1||document.createElement("a"),d1.setAttribute("href",n);const e=d1.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){bb=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function sq(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let d1,bb=null;const WN=new Ct("TRANSITION_ID"),v7=[{provide:fb,useFactory:function y7(n,e,t){return()=>{t.get(Hw).donePromise.then(()=>{const i=gh(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[WN,Yi,Uo],multi:!0}];let x7=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const h1=new Ct("EventManagerPlugins");let f1=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const u=r[s];if(u.supports(t))return this._eventNameToPlugin.set(t,u),u}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(lt(h1),lt(Ti))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class qN{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=gh().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let ZN=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const r=this.usageCount;let s=r.get(t)??0;return s+=i,s>0?r.set(t,s):r.delete(t),s}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),xb=(()=>{class n extends ZN{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(s=>s.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const r=this.doc.createElement("style");r.textContent=i,t.appendChild(r);const s=this.styleRef.get(i);s?s.push(r):this.styleRef.set(i,[r])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const PD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},OD=/%COMP%/g,XN=new Ct("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function QN(n,e){return e.flat(100).map(t=>t.replace(OD,n))}function JN(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let p1=(()=>{class n{constructor(t,i,r,s){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestory=s,this.rendererByCompId=new Map,this.defaultRenderer=new FD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const r=this.getOrCreateRenderer(t,i);return r instanceof nB?r.applyToHost(t):r instanceof LD&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let s=r.get(i.id);if(!s){const u=this.eventManager,m=this.sharedStylesHost,v=this.removeStylesOnCompDestory;switch(i.encapsulation){case Xo.Emulated:s=new nB(u,m,i,this.appId,v);break;case Xo.ShadowDom:return new S7(u,m,t,i);default:s=new LD(u,m,i,v)}s.onDestroy=()=>r.delete(i.id),r.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(lt(f1),lt(xb),lt(pb),lt(XN))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class FD{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(PD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(tB(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(tB(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=PD[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=PD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(lo.DashCase|lo.Important)?e.style.setProperty(t,i,r&lo.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&lo.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,JN(i)):this.eventManager.addEventListener(e,t,JN(i))}}function tB(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class S7 extends FD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=QN(r.id,r.styles);for(const u of s){const m=document.createElement("style");m.textContent=u,this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class LD extends FD{constructor(e,t,i,r,s=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=r,this.rendererUsageCount=0,this.styles=QN(s,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class nB extends LD{constructor(e,t,i,r,s){const u=r+"-"+i.id;super(e,t,i,s,u),this.contentAttr=function T7(n){return"_ngcontent-%COMP%".replace(OD,n)}(u),this.hostAttr=function I7(n){return"_nghost-%COMP%".replace(OD,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let A7=(()=>{class n extends qN{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const iB=["alt","control","meta","shift"],M7={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},k7={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let R7=(()=>{class n extends qN{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),u=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gh().onAndCancel(t,s.domEventName,u))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let u="",m=i.indexOf("code");if(m>-1&&(i.splice(m,1),u="code."),iB.forEach(C=>{const S=i.indexOf(C);S>-1&&(i.splice(S,1),u+=C+".")}),u+=s,0!=i.length||0===s.length)return null;const v={};return v.domEventName=r,v.fullKey=u,v}static matchEventFullKeyCode(t,i){let r=M7[t.key]||t.key,s="";return i.indexOf("code.")>-1&&(r=t.code,s="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),iB.forEach(u=>{u!==r&&(0,k7[u])(t)&&(s+=u+".")}),s+=r,s===i)}static eventCallback(t,i,r){return s=>{n.matchEventFullKeyCode(s,t)&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const L7=eN(hW,"browser",[{provide:lm,useValue:VN},{provide:$L,useValue:function P7(){RD.makeCurrent()},multi:!0},{provide:Yi,useFactory:function F7(){return function Dg(n){fd=n}(document),document},deps:[]}]),sB=new Ct(""),aB=[{provide:Gw,useClass:class b7{addToWindow(e){zi.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},zi.getAllAngularTestabilities=()=>e.getAllTestabilities(),zi.getAllAngularRootElements=()=>e.getAllRootElements(),zi.frameworkStabilizers||(zi.frameworkStabilizers=[]),zi.frameworkStabilizers.push(i=>{const r=zi.getAllAngularTestabilities();let s=r.length,u=!1;const m=function(v){u=u||v,s--,0==s&&i(u)};r.forEach(function(v){v.whenStable(m)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?gh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:YL,useClass:nD,deps:[Ti,iD,Gw]},{provide:nD,useClass:nD,deps:[Ti,iD,Gw]}],lB=[{provide:Ug,useValue:"root"},{provide:As,useFactory:function O7(){return new As},deps:[]},{provide:h1,useClass:A7,multi:!0,deps:[Yi,Ti,lm]},{provide:h1,useClass:R7,multi:!0,deps:[Yi]},{provide:p1,useClass:p1,deps:[f1,xb,pb,XN]},{provide:Eu,useExisting:p1},{provide:ZN,useExisting:xb},{provide:xb,useClass:xb,deps:[Yi]},{provide:f1,useClass:f1,deps:[h1,Ti]},{provide:class Uq{},useClass:x7,deps:[]},[]];let cB=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:pb,useValue:t.appId},{provide:WN,useExisting:pb},v7]}}}return n.\u0275fac=function(t){return new(t||n)(lt(sB,12))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[...lB,...aB],imports:[b_,fW]}),n})(),uB=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:function(t){let i=null;return i=t?new t:function B7(){return new uB(lt(Yi))}(),i},providedIn:"root"}),n})();typeof window<"u"&&window;let m1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(t){let i=null;return i=t?new(t||n):lt(fB),i},providedIn:"root"}),n})(),fB=(()=>{class n extends m1{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case $i.NONE:return i;case $i.HTML:return Mc(i,"HTML")?Vo(i):Bx(this._doc,String(i)).toString();case $i.STYLE:return Mc(i,"Style")?Vo(i):i;case $i.SCRIPT:if(Mc(i,"Script"))return Vo(i);throw new Error("unsafe value used in a script context");case $i.URL:return Mc(i,"URL")?Vo(i):kg(String(i));case $i.RESOURCE_URL:if(Mc(i,"ResourceURL"))return Vo(i);throw new Error(`unsafe value used in a resource URL context (see ${Mr})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${Mr})`)}}bypassSecurityTrustHtml(t){return function Sg(n){return new RT(n)}(t)}bypassSecurityTrustStyle(t){return function Mx(n){return new PT(n)}(t)}bypassSecurityTrustScript(t){return function Ag(n){return new OT(n)}(t)}bypassSecurityTrustUrl(t){return function Mg(n){return new Jy(n)}(t)}bypassSecurityTrustResourceUrl(t){return function Up(n){return new FT(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:function(t){let i=null;return i=t?new t:function $7(n){return new fB(n.get(Yi))}(lt(Uo)),i},providedIn:"root"}),n})();var H7=pi(903),g1=pi.n(H7);const pB_mapbox_accessToken="pk.eyJ1IjoiY2RhbmllbGlyYSIsImEiOiJjbGhuMWJmcDYxaDN3M2twYmp0M2xtb25rIn0.tWzZ68XZxhcQTfilWWdf9g";function mB(n,e,t,i,r,s,u){try{var m=n[s](u),v=m.value}catch(C){return void t(C)}m.done?e(v):Promise.resolve(v).then(i,r)}function Ie(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function u(v){mB(s,i,r,u,m,"next",v)}function m(v){mB(s,i,r,u,m,"throw",v)}u(void 0)})}}const zD={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Rt=function(n,e){if(!n)throw x_(e)},x_=function(n){return new Error("Firebase Database ("+zD.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)},gB=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=63&r|128):55296==(64512&r)&&i+1<n.length&&56320==(64512&n.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&n.charCodeAt(++i)),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=63&r|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=63&r|128)}return e},_1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],u=r+1<n.length,m=u?n[r+1]:0,v=r+2<n.length,C=v?n[r+2]:0;let j=(15&m)<<2|C>>6,K=63&C;v||(K=64,u||(j=64)),i.push(t[s>>2],t[(3&s)<<4|m>>4],t[j],t[K])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(gB(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const v=((7&r)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[i++]=String.fromCharCode(55296+(v>>10)),e[i++]=String.fromCharCode(56320+(1023&v))}else{const s=n[t++],u=n[t++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&u)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],m=r<n.length?t[n.charAt(r)]:0;++r;const C=r<n.length?t[n.charAt(r)]:64;++r;const R=r<n.length?t[n.charAt(r)]:64;if(++r,null==s||null==m||null==C||null==R)throw new W7;i.push(s<<2|m>>4),64!==C&&(i.push(m<<4&240|C>>2),64!==R&&i.push(C<<6&192|R))}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class W7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _B=function(n){const e=gB(n);return _1.encodeByteArray(e,!0)},y1=function(n){return _B(n).replace(/\./g,"")},v1=function(n){try{return _1.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function q7(n){return yB(void 0,n)}function yB(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Z7(t)||(n[t]=yB(n[t],e[t]));return n}function Z7(n){return"__proto__"!==n}const b1=()=>{try{return function Y7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&v1(n[1]);return e&&JSON.parse(e)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},vB=n=>{var e,t;return null===(t=null===(e=b1())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[n]},J7=n=>{const e=vB(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),i]:[e.substring(0,t),i]},bB=()=>{var n;return null===(n=b1())||void 0===n?void 0:n.config},xB=n=>{var e;return null===(e=b1())||void 0===e?void 0:e[`_${n}`]};class hm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,i))}}}function Ms(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function VD(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ms())}function UD(){const n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof n&&void 0!==n.id}function wB(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function vh(){return!0===zD.NODE_CLIENT||!0===zD.NODE_ADMIN}function fm(){try{return"object"==typeof indexedDB}catch{return!1}}function wb(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e((null===(s=r.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}function jD(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class zu extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name="FirebaseError",Object.setPrototypeOf(this,zu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ed.prototype.create)}}class Ed{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],u=s?function o9(n,e){return n.replace(s9,(t,i)=>{const r=e[i];return null!=r?String(r):`<${i}?>`})}(s,i):"Error";return new zu(r,`${this.serviceName}: ${u} (${r}).`,i)}}const s9=/\{\$([^}]+)}/g;function Eb(n){return JSON.parse(n)}function as(n){return JSON.stringify(n)}const x1=function(n){let e={},t={},i={},r="";try{const s=n.split(".");e=Eb(v1(s[0])||""),t=Eb(v1(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}};function Cd(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function w_(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function $D(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function w1(n,e,t){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function E1(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],u=e[r];if(EB(s)&&EB(u)){if(!E1(s,u))return!1}else if(s!==u)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function EB(n){return null!==n&&"object"==typeof n}function pm(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Cb(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function Tb(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}class c9{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if("string"==typeof e)for(let R=0;R<16;R++)i[R]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let R=0;R<16;R++)i[R]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let R=16;R<80;R++){const j=i[R-3]^i[R-8]^i[R-14]^i[R-16];i[R]=4294967295&(j<<1|j>>>31)}let C,S,r=this.chain_[0],s=this.chain_[1],u=this.chain_[2],m=this.chain_[3],v=this.chain_[4];for(let R=0;R<80;R++){R<40?R<20?(C=m^s&(u^m),S=1518500249):(C=s^u^m,S=1859775393):R<60?(C=s&u|m&(s|u),S=2400959708):(C=s^u^m,S=3395469782);const j=(r<<5|r>>>27)+C+v+S+i[R]&4294967295;v=m,m=u,u=4294967295&(s<<30|s>>>2),s=r,r=j}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+m&4294967295,this.chain_[4]=this.chain_[4]+v&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const i=t-this.blockSize;let r=0;const s=this.buf_;let u=this.inbuf_;for(;r<t;){if(0===u)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(s[u]=e.charCodeAt(r),++u,++r,u===this.blockSize){this.compress_(s),u=0;break}}else for(;r<t;)if(s[u]=e[r],++u,++r,u===this.blockSize){this.compress_(s),u=0;break}}this.inbuf_=u,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}}class d9{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(void 0===e&&void 0===t&&void 0===i)throw new Error("Missing Observer.");r=function h9(n,e){if("object"!=typeof n||null===n)return!1;for(const t of e)if(t in n&&"function"==typeof n[t])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:i},void 0===r.next&&(r.next=HD),void 0===r.error&&(r.error=HD),void 0===r.complete&&(r.complete=HD);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){void 0===this.observers||void 0===this.observers[e]||(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HD(){}function mm(n,e){return`${n} failed: ${e} argument `}const C1=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e},p9=1e3,m9=2,g9=144e5,_9=.5;function GD(n,e=p9,t=m9){const i=e*Math.pow(t,n),r=Math.round(_9*i*(Math.random()-.5)*2);return Math.min(g9,i+r)}function Ho(n){return n&&n._delegate?n._delegate:n}class ma{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const gm="[DEFAULT]";class v9{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new hm;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e?.identifier),r=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(i)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function x9(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:gm})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=gm){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return Ie(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(i=>"INTERNAL"in i).map(i=>i.INTERNAL.delete()),...t.filter(i=>"_delete"in i).map(i=>i._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=gm){return this.instances.has(e)}getOptions(e=gm){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,u]of this.instancesDeferred.entries())i===this.normalizeInstanceIdentifier(s)&&u.resolve(r);return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=null!==(i=this.onInitCallbacks.get(r))&&void 0!==i?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const u=this.instances.get(r);return u&&e(u,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e,n===gm?void 0:n),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}var n;return i||null}normalizeInstanceIdentifier(e=gm){return this.component?this.component.multipleInstances?e:gm:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class w9{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new v9(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const WD=[];var nr=(()=>{return(n=nr||(nr={}))[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",nr;var n})();const CB={debug:nr.DEBUG,verbose:nr.VERBOSE,info:nr.INFO,warn:nr.WARN,error:nr.ERROR,silent:nr.SILENT},E9=nr.INFO,C9={[nr.DEBUG]:"log",[nr.VERBOSE]:"log",[nr.INFO]:"info",[nr.WARN]:"warn",[nr.ERROR]:"error"},T9=(n,e,...t)=>{if(e<n.logLevel)return;const i=(new Date).toISOString(),r=C9[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${n.name}:`,...t)};class E_{constructor(e){this.name=e,this._logLevel=E9,this._logHandler=T9,this._userLogHandler=null,WD.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?CB[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,nr.DEBUG,...e),this._logHandler(this,nr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,nr.VERBOSE,...e),this._logHandler(this,nr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,nr.INFO,...e),this._logHandler(this,nr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,nr.WARN,...e),this._logHandler(this,nr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,nr.ERROR,...e),this._logHandler(this,nr.ERROR,...e)}}const I9=(n,e)=>e.some(t=>n instanceof t);let TB,IB;const DB=new WeakMap,qD=new WeakMap,SB=new WeakMap,ZD=new WeakMap,YD=new WeakMap;let KD={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return qD.get(n);if("objectStoreNames"===e)return n.objectStoreNames||SB.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Nf(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function P9(n){return"function"==typeof n?function R9(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function S9(){return IB||(IB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply(XD(this),e),Nf(DB.get(this))}:function(...e){return Nf(n.apply(XD(this),e))}:function(e,...t){const i=n.call(XD(this),e,...t);return SB.set(i,e.sort?e.sort():[e]),Nf(i)}}(n):(n instanceof IDBTransaction&&function M9(n){if(qD.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",u),n.removeEventListener("abort",u)},s=()=>{t(),r()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",u),n.addEventListener("abort",u)});qD.set(n,e)}(n),I9(n,function D9(){return TB||(TB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,KD):n)}function Nf(n){if(n instanceof IDBRequest)return function A9(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",u)},s=()=>{t(Nf(n.result)),r()},u=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&DB.set(t,n)}).catch(()=>{}),YD.set(e,n),e}(n);if(ZD.has(n))return ZD.get(n);const e=P9(n);return e!==n&&(ZD.set(n,e),YD.set(e,n)),e}const XD=n=>YD.get(n),F9=["get","getKey","getAll","getAllKeys","count"],L9=["put","add","delete","clear"],QD=new Map;function AB(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(QD.get(e))return QD.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=L9.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!F9.includes(t))return;const s=function(){var u=Ie(function*(m,...v){const C=this.transaction(m,r?"readwrite":"readonly");let S=C.store;return i&&(S=S.index(v.shift())),(yield Promise.all([S[t](...v),r&&C.done]))[0]});return function(v){return u.apply(this,arguments)}}();return QD.set(e,s),s}!function k9(n){KD=n(KD)}(n=>({...n,get:(e,t,i)=>AB(e,t)||n.get(e,t,i),has:(e,t)=>!!AB(e,t)||n.has(e,t)}));class N9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function B9(n){return"VERSION"===n.getComponent()?.type}(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}return null}).filter(t=>t).join(" ")}}const JD="@firebase/app",_m=new E_("@firebase/app"),T1="[DEFAULT]",uZ={[JD]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ym=new Map,I1=new Map;function dZ(n,e){try{n.container.addComponent(e)}catch(t){_m.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Oa(n){const e=n.name;if(I1.has(e))return _m.debug(`There were multiple attempts to register component ${e}.`),!1;I1.set(e,n);for(const t of ym.values())dZ(t,n);return!0}function C_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}const bh=new Ed("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class fZ{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ma("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bh.create("app-deleted",{appName:this._name})}}const vm="9.22.2";function kB(n,e={}){let t=n;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:T1,automaticDataCollectionEnabled:!1},e),r=i.name;if("string"!=typeof r||!r)throw bh.create("bad-app-name",{appName:String(r)});if(t||(t=bB()),!t)throw bh.create("no-options");const s=ym.get(r);if(s){if(E1(t,s.options)&&E1(i,s.config))return s;throw bh.create("duplicate-app",{appName:r})}const u=new w9(r);for(const v of I1.values())u.addComponent(v);const m=new fZ(t,i,u);return ym.set(r,m),m}function eS(n=T1){const e=ym.get(n);if(!e&&n===T1&&bB())return kB();if(!e)throw bh.create("no-app",{appName:n});return e}function RB(){return Array.from(ym.values())}function po(n,e,t){var i;let r=null!==(i=uZ[n])&&void 0!==i?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),u=e.match(/\s|\//);if(s||u){const m=[`Unable to register library "${r}" with version "${e}":`];return s&&m.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&u&&m.push("and"),u&&m.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void _m.warn(m.join(" "))}Oa(new ma(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const pZ="firebase-heartbeat-database",mZ=1,Ib="firebase-heartbeat-store";let nS=null;function PB(){return nS||(nS=function O9(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const u=indexedDB.open(n,e),m=Nf(u);return i&&u.addEventListener("upgradeneeded",v=>{i(Nf(u.result),v.oldVersion,v.newVersion,Nf(u.transaction),v)}),t&&u.addEventListener("blocked",v=>t(v.oldVersion,v.newVersion,v)),m.then(v=>{s&&v.addEventListener("close",()=>s()),r&&v.addEventListener("versionchange",C=>r(C.oldVersion,C.newVersion,C))}).catch(()=>{}),m}(pZ,mZ,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Ib)}}).catch(n=>{throw bh.create("idb-open",{originalErrorMessage:n.message})})),nS}function iS(){return(iS=Ie(function*(n){try{return yield(yield PB()).transaction(Ib).objectStore(Ib).get(FB(n))}catch(e){if(e instanceof zu)_m.warn(e.message);else{const t=bh.create("idb-get",{originalErrorMessage:e?.message});_m.warn(t.message)}}})).apply(this,arguments)}function OB(n,e){return rS.apply(this,arguments)}function rS(){return(rS=Ie(function*(n,e){try{const i=(yield PB()).transaction(Ib,"readwrite");yield i.objectStore(Ib).put(e,FB(n)),yield i.done}catch(t){if(t instanceof zu)_m.warn(t.message);else{const i=bh.create("idb-set",{originalErrorMessage:t?.message});_m.warn(i.message)}}})).apply(this,arguments)}function FB(n){return`${n.name}!${n.options.appId}`}class vZ{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xZ(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}triggerHeartbeat(){var e=this;return Ie(function*(){const i=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=LB();if(null===e._heartbeatsCache&&(e._heartbeatsCache=yield e._heartbeatsCachePromise),e._heartbeatsCache.lastSentHeartbeatDate!==r&&!e._heartbeatsCache.heartbeats.some(s=>s.date===r))return e._heartbeatsCache.heartbeats.push({date:r,agent:i}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(s=>{const u=new Date(s.date).valueOf();return Date.now()-u<=2592e6}),e._storage.overwrite(e._heartbeatsCache)})()}getHeartbeatsHeader(){var e=this;return Ie(function*(){if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null===e._heartbeatsCache||0===e._heartbeatsCache.heartbeats.length)return"";const t=LB(),{heartbeatsToSend:i,unsentEntries:r}=function bZ(n,e=1024){const t=[];let i=n.slice();for(const r of n){const s=t.find(u=>u.agent===r.agent);if(s){if(s.dates.push(r.date),NB(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),NB(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}(e._heartbeatsCache.heartbeats),s=y1(JSON.stringify({version:2,heartbeats:i}));return e._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(e._heartbeatsCache.heartbeats=r,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),s})()}}function LB(){return(new Date).toISOString().substring(0,10)}class xZ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Ie(function*(){return!!fm()&&wb().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return Ie(function*(){return(yield e._canUseIndexedDBPromise)&&(yield function gZ(n){return iS.apply(this,arguments)}(e.app))||{heartbeats:[]}})()}overwrite(e){var t=this;return Ie(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return OB(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return Ie(function*(){var i;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return OB(t.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function NB(n){return y1(JSON.stringify({version:2,heartbeats:n})).length}!function wZ(n){Oa(new ma("platform-logger",e=>new N9(e),"PRIVATE")),Oa(new ma("heartbeat",e=>new vZ(e),"PRIVATE")),po(JD,"0.9.12",n),po(JD,"0.9.12","esm2017"),po("fire-js","")}(""),po("firebase","9.22.2","app");const TZ=(n,e)=>e.some(t=>n instanceof t);let BB,zB;const VB=new WeakMap,oS=new WeakMap,UB=new WeakMap,sS=new WeakMap,aS=new WeakMap;let lS={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return oS.get(n);if("objectStoreNames"===e)return n.objectStoreNames||UB.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Bf(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function RZ(n){return"function"==typeof n?function kZ(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function DZ(){return zB||(zB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply(cS(this),e),Bf(VB.get(this))}:function(...e){return Bf(n.apply(cS(this),e))}:function(e,...t){const i=n.call(cS(this),e,...t);return UB.set(i,e.sort?e.sort():[e]),Bf(i)}}(n):(n instanceof IDBTransaction&&function AZ(n){if(oS.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",u),n.removeEventListener("abort",u)},s=()=>{t(),r()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",u),n.addEventListener("abort",u)});oS.set(n,e)}(n),TZ(n,function IZ(){return BB||(BB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,lS):n)}function Bf(n){if(n instanceof IDBRequest)return function SZ(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",u)},s=()=>{t(Bf(n.result)),r()},u=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&VB.set(t,n)}).catch(()=>{}),aS.set(e,n),e}(n);if(sS.has(n))return sS.get(n);const e=RZ(n);return e!==n&&(sS.set(n,e),aS.set(e,n)),e}const cS=n=>aS.get(n),OZ=["get","getKey","getAll","getAllKeys","count"],FZ=["put","add","delete","clear"],uS=new Map;function jB(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(uS.get(e))return uS.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=FZ.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!OZ.includes(t))return;const s=function(){var u=Ie(function*(m,...v){const C=this.transaction(m,r?"readwrite":"readonly");let S=C.store;return i&&(S=S.index(v.shift())),(yield Promise.all([S[t](...v),r&&C.done]))[0]});return function(v){return u.apply(this,arguments)}}();return uS.set(e,s),s}!function MZ(n){lS=n(lS)}(n=>({...n,get:(e,t,i)=>jB(e,t)||n.get(e,t,i),has:(e,t)=>!!jB(e,t)||n.has(e,t)}));const $B="@firebase/installations",dS="0.6.4",HB=1e4,GB=`w:${dS}`,WB="FIS_v2",LZ="https://firebaseinstallations.googleapis.com/v1",NZ=36e5,xh=new Ed("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qB(n){return n instanceof zu&&n.code.includes("request-failed")}function hS({projectId:n}){return`${LZ}/projects/${n}/installations`}function ZB(n){return{token:n.token,requestStatus:2,expiresIn:UZ(n.expiresIn),creationTime:Date.now()}}function fS(n,e){return pS.apply(this,arguments)}function pS(){return(pS=Ie(function*(n,e){const i=(yield e.json()).error;return xh.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})})).apply(this,arguments)}function YB({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function mS(n){return gS.apply(this,arguments)}function gS(){return(gS=Ie(function*(n){const e=yield n();return e.status>=500&&e.status<600?n():e})).apply(this,arguments)}function UZ(n){return Number(n.replace("s","000"))}function _S(){return(_S=Ie(function*({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=hS(n),r=YB(n),s=e.getImmediate({optional:!0});if(s){const C=yield s.getHeartbeatsHeader();C&&r.append("x-firebase-client",C)}const m={method:"POST",headers:r,body:JSON.stringify({fid:t,authVersion:WB,appId:n.appId,sdkVersion:GB})},v=yield mS(()=>fetch(i,m));if(v.ok){const C=yield v.json();return{fid:C.fid||t,registrationStatus:2,refreshToken:C.refreshToken,authToken:ZB(C.authToken)}}throw yield fS("Create Installation",v)})).apply(this,arguments)}function XB(n){return new Promise(e=>{setTimeout(e,n)})}const GZ=/^[cdef][\w-]{21}$/,yS="";function WZ(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=function qZ(n){return function HZ(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}(n).substr(0,22)}(n);return GZ.test(t)?t:yS}catch{return yS}}function T_(n){return`${n.appName}!${n.appId}`}const I_=new Map;function QB(n,e){const t=T_(n);JB(t,e),function KZ(n,e){const t=function ez(){return!bm&&"BroadcastChannel"in self&&(bm=new BroadcastChannel("[Firebase] FID Change"),bm.onmessage=n=>{JB(n.data.key,n.data.fid)}),bm}();t&&t.postMessage({key:n,fid:e}),function tz(){0===I_.size&&bm&&(bm.close(),bm=null)}()}(t,e)}function JB(n,e){const t=I_.get(n);if(t)for(const i of t)i(e)}let bm=null;const XZ="firebase-installations-database",QZ=1,xm="firebase-installations-store";let vS=null;function bS(){return vS||(vS=function PZ(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const u=indexedDB.open(n,e),m=Bf(u);return i&&u.addEventListener("upgradeneeded",v=>{i(Bf(u.result),v.oldVersion,v.newVersion,Bf(u.transaction))}),t&&u.addEventListener("blocked",()=>t()),m.then(v=>{s&&v.addEventListener("close",()=>s()),r&&v.addEventListener("versionchange",()=>r())}).catch(()=>{}),m}(XZ,QZ,{upgrade:(n,e)=>{0===e&&n.createObjectStore(xm)}})),vS}function D1(n,e){return xS.apply(this,arguments)}function xS(){return(xS=Ie(function*(n,e){const t=T_(n),r=(yield bS()).transaction(xm,"readwrite"),s=r.objectStore(xm),u=yield s.get(t);return yield s.put(e,t),yield r.done,(!u||u.fid!==e.fid)&&QB(n,e.fid),e})).apply(this,arguments)}function wS(n){return ES.apply(this,arguments)}function ES(){return(ES=Ie(function*(n){const e=T_(n),i=(yield bS()).transaction(xm,"readwrite");yield i.objectStore(xm).delete(e),yield i.done})).apply(this,arguments)}function Db(n,e){return CS.apply(this,arguments)}function CS(){return(CS=Ie(function*(n,e){const t=T_(n),r=(yield bS()).transaction(xm,"readwrite"),s=r.objectStore(xm),u=yield s.get(t),m=e(u);return void 0===m?yield s.delete(t):yield s.put(m,t),yield r.done,m&&(!u||u.fid!==m.fid)&&QB(n,m.fid),m})).apply(this,arguments)}function TS(n){return IS.apply(this,arguments)}function IS(){return IS=Ie(function*(n){let e;const t=yield Db(n.appConfig,i=>{const r=function JZ(n){return iz(n||{fid:WZ(),registrationStatus:0})}(i),s=function eY(n,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(xh.create("app-offline"))};const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function tY(n,e){return DS.apply(this,arguments)}(n,t);return{installationEntry:t,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:nY(n)}:{installationEntry:e}}(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===yS?{installationEntry:yield e}:{installationEntry:t,registrationPromise:e}}),IS.apply(this,arguments)}function DS(){return DS=Ie(function*(n,e){try{const t=yield function $Z(n,e){return _S.apply(this,arguments)}(n,e);return D1(n.appConfig,t)}catch(t){throw qB(t)&&409===t.customData.serverCode?yield wS(n.appConfig):yield D1(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}),DS.apply(this,arguments)}function nY(n){return SS.apply(this,arguments)}function SS(){return(SS=Ie(function*(n){let e=yield nz(n.appConfig);for(;1===e.registrationStatus;)yield XB(100),e=yield nz(n.appConfig);if(0===e.registrationStatus){const{installationEntry:t,registrationPromise:i}=yield TS(n);return i||t}return e})).apply(this,arguments)}function nz(n){return Db(n,e=>{if(!e)throw xh.create("installation-not-found");return iz(e)})}function iz(n){return function iY(n){return 1===n.registrationStatus&&n.registrationTime+HB<Date.now()}(n)?{fid:n.fid,registrationStatus:0}:n}function AS(){return(AS=Ie(function*({appConfig:n,heartbeatServiceProvider:e},t){const i=function oY(n,{fid:e}){return`${hS(n)}/${e}/authTokens:generate`}(n,t),r=function KB(n,{refreshToken:e}){const t=YB(n);return t.append("Authorization",function jZ(n){return`${WB} ${n}`}(e)),t}(n,t),s=e.getImmediate({optional:!0});if(s){const C=yield s.getHeartbeatsHeader();C&&r.append("x-firebase-client",C)}const m={method:"POST",headers:r,body:JSON.stringify({installation:{sdkVersion:GB,appId:n.appId}})},v=yield mS(()=>fetch(i,m));if(v.ok)return ZB(yield v.json());throw yield fS("Generate Auth Token",v)})).apply(this,arguments)}function MS(n){return kS.apply(this,arguments)}function kS(){return kS=Ie(function*(n,e=!1){let t;const i=yield Db(n.appConfig,s=>{if(!oz(s))throw xh.create("not-registered");const u=s.authToken;if(!e&&function lY(n){return 2===n.requestStatus&&!function cY(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+NZ}(n)}(u))return s;if(1===u.requestStatus)return t=function sY(n,e){return RS.apply(this,arguments)}(n,e),s;{if(!navigator.onLine)throw xh.create("app-offline");const m=function uY(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}(s);return t=function aY(n,e){return PS.apply(this,arguments)}(n,m),m}});return t?yield t:i.authToken}),kS.apply(this,arguments)}function RS(){return(RS=Ie(function*(n,e){let t=yield rz(n.appConfig);for(;1===t.authToken.requestStatus;)yield XB(100),t=yield rz(n.appConfig);const i=t.authToken;return 0===i.requestStatus?MS(n,e):i})).apply(this,arguments)}function rz(n){return Db(n,e=>{if(!oz(e))throw xh.create("not-registered");return function dY(n){return 1===n.requestStatus&&n.requestTime+HB<Date.now()}(e.authToken)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}function PS(){return PS=Ie(function*(n,e){try{const t=yield function rY(n,e){return AS.apply(this,arguments)}(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return yield D1(n.appConfig,i),t}catch(t){if(!qB(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode){const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});yield D1(n.appConfig,i)}else yield wS(n.appConfig);throw t}}),PS.apply(this,arguments)}function oz(n){return void 0!==n&&2===n.registrationStatus}function OS(){return(OS=Ie(function*(n){const e=n,{installationEntry:t,registrationPromise:i}=yield TS(e);return i?i.catch(console.error):MS(e).catch(console.error),t.fid})).apply(this,arguments)}function FS(){return FS=Ie(function*(n,e=!1){const t=n;return yield function pY(n){return LS.apply(this,arguments)}(t),(yield MS(t,e)).token}),FS.apply(this,arguments)}function LS(){return(LS=Ie(function*(n){const{registrationPromise:e}=yield TS(n);e&&(yield e)})).apply(this,arguments)}function zS(n){return xh.create("missing-app-config-values",{valueName:n})}const sz="installations",vY=n=>{const e=n.getProvider("app").getImmediate(),t=function _Y(n){if(!n||!n.options)throw zS("App Configuration");if(!n.name)throw zS("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw zS(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}(e);return{app:e,appConfig:t,heartbeatServiceProvider:C_(e,"heartbeat"),_delete:()=>Promise.resolve()}},bY=n=>{const t=C_(n.getProvider("app").getImmediate(),sz).getImmediate();return{getId:()=>function hY(n){return OS.apply(this,arguments)}(t),getToken:r=>function fY(n){return FS.apply(this,arguments)}(t,r)}};(function xY(){Oa(new ma(sz,vY,"PUBLIC")),Oa(new ma("installations-internal",bY,"PRIVATE"))})(),po($B,dS),po($B,dS,"esm2017");const VS="@firebase/remote-config",Cl=new Ed("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class RY{constructor(e,t,i,r){this.client=e,this.storage=t,this.storageCache=i,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const i=Date.now()-t,r=i<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${i}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}fetch(e){var t=this;return Ie(function*(){const[i,r]=yield Promise.all([t.storage.getLastSuccessfulFetchTimestampMillis(),t.storage.getLastSuccessfulFetchResponse()]);if(r&&t.isCachedDataFresh(e.cacheMaxAgeMillis,i))return r;e.eTag=r&&r.eTag;const s=yield t.client.fetch(e),u=[t.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===s.status&&u.push(t.storage.setLastSuccessfulFetchResponse(s)),yield Promise.all(u),s})()}}function PY(n=navigator){return n.languages&&n.languages[0]||n.language}class OY{constructor(e,t,i,r,s,u){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=i,this.projectId=r,this.apiKey=s,this.appId=u}fetch(e){var t=this;return Ie(function*(){const[i,r]=yield Promise.all([t.firebaseInstallations.getId(),t.firebaseInstallations.getToken()]),u=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${t.projectId}/namespaces/${t.namespace}:fetch?key=${t.apiKey}`,m={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},v={sdk_version:t.sdkVersion,app_instance_id:i,app_instance_id_token:r,app_id:t.appId,language_code:PY()},C={method:"POST",headers:m,body:JSON.stringify(v)},S=fetch(u,C),R=new Promise((Ke,_t)=>{e.signal.addEventListener(()=>{const Qe=new Error("The operation was aborted.");Qe.name="AbortError",_t(Qe)})});let j;try{yield Promise.race([S,R]),j=yield S}catch(Ke){let _t="fetch-client-network";throw"AbortError"===Ke?.name&&(_t="fetch-timeout"),Cl.create(_t,{originalErrorMessage:Ke?.message})}let K=j.status;const ie=j.headers.get("ETag")||void 0;let we,Oe;if(200===j.status){let Ke;try{Ke=yield j.json()}catch(_t){throw Cl.create("fetch-client-parse",{originalErrorMessage:_t?.message})}we=Ke.entries,Oe=Ke.state}if("INSTANCE_STATE_UNSPECIFIED"===Oe?K=500:"NO_CHANGE"===Oe?K=304:("NO_TEMPLATE"===Oe||"EMPTY_CONFIG"===Oe)&&(we={}),304!==K&&200!==K)throw Cl.create("fetch-status",{httpStatus:K});return{status:K,eTag:ie,config:we}})()}}class NY{constructor(e,t){this.client=e,this.storage=t}fetch(e){var t=this;return Ie(function*(){const i=(yield t.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return t.attemptFetch(e,i)})()}attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:i}){var r=this;return Ie(function*(){yield function FY(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(Cl.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(e.signal,t);try{const s=yield r.client.fetch(e);return yield r.storage.deleteThrottleMetadata(),s}catch(s){if(!function LY(n){if(!(n instanceof zu&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(s))throw s;const u={throttleEndTimeMillis:Date.now()+GD(i),backoffCount:i+1};return yield r.storage.setThrottleMetadata(u),r.attemptFetch(e,u)}})()}}class VY{constructor(e,t,i,r,s){this.app=e,this._client=t,this._storageCache=i,this._storage=r,this._logger=s,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function A1(n,e){const t=n.target.error||void 0;return Cl.create(e,{originalErrorMessage:t&&t?.message})}const wm="app_namespace_store";class HY{constructor(e,t,i,r=function $Y(){return new Promise((n,e)=>{try{const t=indexedDB.open("firebase_remote_config",1);t.onerror=i=>{e(A1(i,"storage-open"))},t.onsuccess=i=>{n(i.target.result)},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(wm,{keyPath:"compositeKey"})}}catch(t){e(Cl.create("storage-open",{originalErrorMessage:t?.message}))}})}()){this.appId=e,this.appName=t,this.namespace=i,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(e){var t=this;return Ie(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const m=i.transaction([wm],"readonly").objectStore(wm),v=t.createCompositeKey(e);try{const C=m.get(v);C.onerror=S=>{s(A1(S,"storage-get"))},C.onsuccess=S=>{const R=S.target.result;r(R?R.value:void 0)}}catch(C){s(Cl.create("storage-get",{originalErrorMessage:C?.message}))}})})()}set(e,t){var i=this;return Ie(function*(){const r=yield i.openDbPromise;return new Promise((s,u)=>{const v=r.transaction([wm],"readwrite").objectStore(wm),C=i.createCompositeKey(e);try{const S=v.put({compositeKey:C,value:t});S.onerror=R=>{u(A1(R,"storage-set"))},S.onsuccess=()=>{s()}}catch(S){u(Cl.create("storage-set",{originalErrorMessage:S?.message}))}})})()}delete(e){var t=this;return Ie(function*(){const i=yield t.openDbPromise;return new Promise((r,s)=>{const m=i.transaction([wm],"readwrite").objectStore(wm),v=t.createCompositeKey(e);try{const C=m.delete(v);C.onerror=S=>{s(A1(S,"storage-delete"))},C.onsuccess=()=>{r()}}catch(C){s(Cl.create("storage-delete",{originalErrorMessage:C?.message}))}})})()}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class GY{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var e=this;return Ie(function*(){const t=e.storage.getLastFetchStatus(),i=e.storage.getLastSuccessfulFetchTimestampMillis(),r=e.storage.getActiveConfig(),s=yield t;s&&(e.lastFetchStatus=s);const u=yield i;u&&(e.lastSuccessfulFetchTimestampMillis=u);const m=yield r;m&&(e.activeConfig=m)})()}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}function qY(){return GS.apply(this,arguments)}function GS(){return(GS=Ie(function*(){if(!fm())return!1;try{return yield wb()}catch{return!1}})).apply(this,arguments)}!function WY(){Oa(new ma("remote-config",function n(e,{instanceIdentifier:t}){const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Cl.create("registration-window");if(!fm())throw Cl.create("indexed-db-unavailable");const{projectId:s,apiKey:u,appId:m}=i.options;if(!s)throw Cl.create("registration-project-id");if(!u)throw Cl.create("registration-api-key");if(!m)throw Cl.create("registration-app-id");const v=new HY(m,i.name,t=t||"firebase"),C=new GY(v),S=new E_(VS);S.logLevel=nr.ERROR;const R=new OY(r,vm,t,s,u,m),j=new NY(R,v),K=new RY(j,v,C,S),ie=new VY(i,K,C,v,S);return function AY(n){const e=Ho(n);e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0}))}(ie),ie},"PUBLIC").setMultipleInstances(!0)),po(VS,"0.4.4"),po(VS,"0.4.4","esm2017")}();const ZY=(n,e)=>e.some(t=>n instanceof t);let uz,dz;const hz=new WeakMap,WS=new WeakMap,fz=new WeakMap,qS=new WeakMap,ZS=new WeakMap;let YS={get(n,e,t){if(n instanceof IDBTransaction){if("done"===e)return WS.get(n);if("objectStoreNames"===e)return n.objectStoreNames||fz.get(n);if("store"===e)return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wh(n[e])},set:(n,e,t)=>(n[e]=t,!0),has:(n,e)=>n instanceof IDBTransaction&&("done"===e||"store"===e)||e in n};function tK(n){return"function"==typeof n?function eK(n){return n!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function KY(){return dz||(dz=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(n)?function(...e){return n.apply(KS(this),e),wh(hz.get(this))}:function(...e){return wh(n.apply(KS(this),e))}:function(e,...t){const i=n.call(KS(this),e,...t);return fz.set(i,e.sort?e.sort():[e]),wh(i)}}(n):(n instanceof IDBTransaction&&function QY(n){if(WS.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",u),n.removeEventListener("abort",u)},s=()=>{t(),r()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",u),n.addEventListener("abort",u)});WS.set(n,e)}(n),ZY(n,function YY(){return uz||(uz=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(n,YS):n)}function wh(n){if(n instanceof IDBRequest)return function XY(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",u)},s=()=>{t(wh(n.result)),r()},u=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&hz.set(t,n)}).catch(()=>{}),ZS.set(e,n),e}(n);if(qS.has(n))return qS.get(n);const e=tK(n);return e!==n&&(qS.set(n,e),ZS.set(e,n)),e}const KS=n=>ZS.get(n);function pz(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const u=indexedDB.open(n,e),m=wh(u);return i&&u.addEventListener("upgradeneeded",v=>{i(wh(u.result),v.oldVersion,v.newVersion,wh(u.transaction))}),t&&u.addEventListener("blocked",()=>t()),m.then(v=>{s&&v.addEventListener("close",()=>s()),r&&v.addEventListener("versionchange",()=>r())}).catch(()=>{}),m}function XS(n,{blocked:e}={}){const t=indexedDB.deleteDatabase(n);return e&&t.addEventListener("blocked",()=>e()),wh(t).then(()=>{})}const nK=["get","getKey","getAll","getAllKeys","count"],iK=["put","add","delete","clear"],QS=new Map;function mz(n,e){if(!(n instanceof IDBDatabase)||e in n||"string"!=typeof e)return;if(QS.get(e))return QS.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=iK.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!nK.includes(t))return;const s=function(){var u=Ie(function*(m,...v){const C=this.transaction(m,r?"readwrite":"readonly");let S=C.store;return i&&(S=S.index(v.shift())),(yield Promise.all([S[t](...v),r&&C.done]))[0]});return function(v){return u.apply(this,arguments)}}();return QS.set(e,s),s}!function JY(n){YS=n(YS)}(n=>({...n,get:(e,t,i)=>mz(e,t)||n.get(e,t,i),has:(e,t)=>!!mz(e,t)||n.has(e,t)}));const rK="/firebase-messaging-sw.js",oK="/firebase-cloud-messaging-push-scope",gz="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",sK="https://fcmregistrations.googleapis.com/v1",_z="google.c.a.c_id",aK="google.c.a.c_l",lK="google.c.a.ts",cK="google.c.a.e";var D_=(()=>{return(n=D_||(D_={})).PUSH_RECEIVED="push-received",n.NOTIFICATION_CLICKED="notification-clicked",D_;var n})();function Eh(n){const e=new Uint8Array(n);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function uK(n){const t=(n+"=".repeat((4-n.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(t),r=new Uint8Array(i.length);for(let s=0;s<i.length;++s)r[s]=i.charCodeAt(s);return r}const JS="fcm_token_details_db",dK=5,yz="fcm_token_object_Store";function eA(){return eA=Ie(function*(n){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(s=>s.name).includes(JS))return null;let e=null;return(yield pz(JS,dK,{upgrade:(i=Ie(function*(r,s,u,m){var v;if(s<2||!r.objectStoreNames.contains(yz))return;const C=m.objectStore(yz),S=yield C.index("fcmSenderId").get(n);if(yield C.clear(),S)if(2===s){const R=S;if(!R.auth||!R.p256dh||!R.endpoint)return;e={token:R.fcmToken,createTime:null!==(v=R.createTime)&&void 0!==v?v:Date.now(),subscriptionOptions:{auth:R.auth,p256dh:R.p256dh,endpoint:R.endpoint,swScope:R.swScope,vapidKey:"string"==typeof R.vapidKey?R.vapidKey:Eh(R.vapidKey)}}}else if(3===s){const R=S;e={token:R.fcmToken,createTime:R.createTime,subscriptionOptions:{auth:Eh(R.auth),p256dh:Eh(R.p256dh),endpoint:R.endpoint,swScope:R.swScope,vapidKey:Eh(R.vapidKey)}}}else if(4===s){const R=S;e={token:R.fcmToken,createTime:R.createTime,subscriptionOptions:{auth:Eh(R.auth),p256dh:Eh(R.p256dh),endpoint:R.endpoint,swScope:R.swScope,vapidKey:Eh(R.vapidKey)}}}}),function(s,u,m,v){return i.apply(this,arguments)})})).close(),yield XS(JS),yield XS("fcm_vapid_details_db"),yield XS("undefined"),function fK(n){if(!n||!n.subscriptionOptions)return!1;const{subscriptionOptions:e}=n;return"number"==typeof n.createTime&&n.createTime>0&&"string"==typeof n.token&&n.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}(e)?e:null;var i}),eA.apply(this,arguments)}const pK="firebase-messaging-database",mK=1,Em="firebase-messaging-store";let tA=null;function nA(){return tA||(tA=pz(pK,mK,{upgrade:(n,e)=>{0===e&&n.createObjectStore(Em)}})),tA}function vz(n){return iA.apply(this,arguments)}function iA(){return iA=Ie(function*(n){const e=aA(n),i=yield(yield nA()).transaction(Em).objectStore(Em).get(e);if(i)return i;{const r=yield function hK(n){return eA.apply(this,arguments)}(n.appConfig.senderId);if(r)return yield rA(n,r),r}}),iA.apply(this,arguments)}function rA(n,e){return oA.apply(this,arguments)}function oA(){return(oA=Ie(function*(n,e){const t=aA(n),r=(yield nA()).transaction(Em,"readwrite");return yield r.objectStore(Em).put(e,t),yield r.done,e})).apply(this,arguments)}function sA(){return(sA=Ie(function*(n){const e=aA(n),i=(yield nA()).transaction(Em,"readwrite");yield i.objectStore(Em).delete(e),yield i.done})).apply(this,arguments)}function aA({appConfig:n}){return n.appId}const Ys=new Ed("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function yK(n,e){return lA.apply(this,arguments)}function lA(){return(lA=Ie(function*(n,e){const t=yield hA(n),i=xz(e),r={method:"POST",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(dA(n.appConfig),r)).json()}catch(u){throw Ys.create("token-subscribe-failed",{errorInfo:u?.toString()})}if(s.error)throw Ys.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw Ys.create("token-subscribe-no-token");return s.token})).apply(this,arguments)}function cA(){return(cA=Ie(function*(n,e){const t=yield hA(n),i=xz(e.subscriptionOptions),r={method:"PATCH",headers:t,body:JSON.stringify(i)};let s;try{s=yield(yield fetch(`${dA(n.appConfig)}/${e.token}`,r)).json()}catch(u){throw Ys.create("token-update-failed",{errorInfo:u?.toString()})}if(s.error)throw Ys.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw Ys.create("token-update-no-token");return s.token})).apply(this,arguments)}function bz(n,e){return uA.apply(this,arguments)}function uA(){return(uA=Ie(function*(n,e){const i={method:"DELETE",headers:yield hA(n)};try{const s=yield(yield fetch(`${dA(n.appConfig)}/${e}`,i)).json();if(s.error)throw Ys.create("token-unsubscribe-failed",{errorInfo:s.error.message})}catch(r){throw Ys.create("token-unsubscribe-failed",{errorInfo:r?.toString()})}})).apply(this,arguments)}function dA({projectId:n}){return`${sK}/projects/${n}/registrations`}function hA(n){return fA.apply(this,arguments)}function fA(){return(fA=Ie(function*({appConfig:n,installations:e}){const t=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":`FIS ${t}`})})).apply(this,arguments)}function xz({p256dh:n,auth:e,endpoint:t,vapidKey:i}){const r={web:{endpoint:t,auth:e,p256dh:n}};return i!==gz&&(r.web.applicationPubKey=i),r}const bK=6048e5;function pA(){return pA=Ie(function*(n){const e=yield function EK(n,e){return yA.apply(this,arguments)}(n.swRegistration,n.vapidKey),t={vapidKey:n.vapidKey,swScope:n.swRegistration.scope,endpoint:e.endpoint,auth:Eh(e.getKey("auth")),p256dh:Eh(e.getKey("p256dh"))},i=yield vz(n.firebaseDependencies);if(i){if(function CK(n,e){return e.vapidKey===n.vapidKey&&e.endpoint===n.endpoint&&e.auth===n.auth&&e.p256dh===n.p256dh}(i.subscriptionOptions,t))return Date.now()>=i.createTime+bK?function wK(n,e){return gA.apply(this,arguments)}(n,{token:i.token,createTime:Date.now(),subscriptionOptions:t}):i.token;try{yield bz(n.firebaseDependencies,i.token)}catch(r){console.warn(r)}return Ez(n.firebaseDependencies,t)}return Ez(n.firebaseDependencies,t)}),pA.apply(this,arguments)}function mA(){return mA=Ie(function*(n){const e=yield vz(n.firebaseDependencies);e&&(yield bz(n.firebaseDependencies,e.token),yield function gK(n){return sA.apply(this,arguments)}(n.firebaseDependencies));const t=yield n.swRegistration.pushManager.getSubscription();return!t||t.unsubscribe()}),mA.apply(this,arguments)}function gA(){return gA=Ie(function*(n,e){try{const t=yield function vK(n,e){return cA.apply(this,arguments)}(n.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:t,createTime:Date.now()});return yield rA(n.firebaseDependencies,i),t}catch(t){throw yield function wz(n){return mA.apply(this,arguments)}(n),t}}),gA.apply(this,arguments)}function Ez(n,e){return _A.apply(this,arguments)}function _A(){return(_A=Ie(function*(n,e){const i={token:yield yK(n,e),createTime:Date.now(),subscriptionOptions:e};return yield rA(n,i),i.token})).apply(this,arguments)}function yA(){return(yA=Ie(function*(n,e){return(yield n.pushManager.getSubscription())||n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:uK(e)})})).apply(this,arguments)}function Cz(n){const e={from:n.from,collapseKey:n.collapse_key,messageId:n.fcmMessageId};return function TK(n,e){if(!e.notification)return;n.notification={};const t=e.notification.title;t&&(n.notification.title=t);const i=e.notification.body;i&&(n.notification.body=i);const r=e.notification.image;r&&(n.notification.image=r);const s=e.notification.icon;s&&(n.notification.icon=s)}(e,n),function IK(n,e){e.data&&(n.data=e.data)}(e,n),function DK(n,e){var t,i,r,s,u;if(!(e.fcmOptions||null!==(t=e.notification)&&void 0!==t&&t.click_action))return;n.fcmOptions={};const m=null!==(r=null===(i=e.fcmOptions)||void 0===i?void 0:i.link)&&void 0!==r?r:null===(s=e.notification)||void 0===s?void 0:s.click_action;m&&(n.fcmOptions.link=m);const v=null===(u=e.fcmOptions)||void 0===u?void 0:u.analytics_label;v&&(n.fcmOptions.analyticsLabel=v)}(e,n),e}function Tz(n,e){const t=[];for(let i=0;i<n.length;i++)t.push(n.charAt(i)),i<e.length&&t.push(e.charAt(i));return t.join("")}function vA(n){return Ys.create("missing-app-config-values",{valueName:n})}Tz("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Tz("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class MK{constructor(e,t,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function AK(n){if(!n||!n.options)throw vA("App Configuration Object");if(!n.name)throw vA("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:t}=n;for(const i of e)if(!t[i])throw vA(i);return{appName:n.name,projectId:t.projectId,apiKey:t.apiKey,appId:t.appId,senderId:t.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:i}}_delete(){return Promise.resolve()}}function Iz(n){return bA.apply(this,arguments)}function bA(){return(bA=Ie(function*(n){try{n.swRegistration=yield navigator.serviceWorker.register(rK,{scope:oK}),n.swRegistration.update().catch(()=>{})}catch(e){throw Ys.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})).apply(this,arguments)}function xA(){return(xA=Ie(function*(n,e){if(!e&&!n.swRegistration&&(yield Iz(n)),e||!n.swRegistration){if(!(e instanceof ServiceWorkerRegistration))throw Ys.create("invalid-sw-registration");n.swRegistration=e}})).apply(this,arguments)}function wA(){return(wA=Ie(function*(n,e){e?n.vapidKey=e:n.vapidKey||(n.vapidKey=gz)})).apply(this,arguments)}function EA(){return EA=Ie(function*(n,e){if(!navigator)throw Ys.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Ys.create("permission-blocked");return yield function RK(n,e){return wA.apply(this,arguments)}(n,e?.vapidKey),yield function kK(n,e){return xA.apply(this,arguments)}(n,e?.serviceWorkerRegistration),function xK(n){return pA.apply(this,arguments)}(n)}),EA.apply(this,arguments)}function CA(){return(CA=Ie(function*(n,e,t){const i=function OK(n){switch(n){case D_.NOTIFICATION_CLICKED:return"notification_open";case D_.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e);(yield n.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:t[_z],message_name:t[aK],message_time:t[lK],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function TA(){return TA=Ie(function*(n,e){const t=e.data;if(!t.isFirebaseMessaging)return;n.onMessageHandler&&t.messageType===D_.PUSH_RECEIVED&&("function"==typeof n.onMessageHandler?n.onMessageHandler(Cz(t)):n.onMessageHandler.next(Cz(t)));const i=t.data;(function SK(n){return"object"==typeof n&&!!n&&_z in n})(i)&&"1"===i[cK]&&(yield function PK(n,e,t){return CA.apply(this,arguments)}(n,t.messageType,i))}),TA.apply(this,arguments)}const Sz="@firebase/messaging",LK=n=>{const e=new MK(n.getProvider("app").getImmediate(),n.getProvider("installations-internal").getImmediate(),n.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",t=>function FK(n,e){return TA.apply(this,arguments)}(e,t)),e},NK=n=>{const e=n.getProvider("messaging").getImmediate();return{getToken:i=>function Dz(n,e){return EA.apply(this,arguments)}(e,i)}};function Mz(){return IA.apply(this,arguments)}function IA(){return(IA=Ie(function*(){try{yield wb()}catch{return!1}return typeof window<"u"&&fm()&&jD()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function BK(){Oa(new ma("messaging",LK,"PUBLIC")),Oa(new ma("messaging-internal",NK,"PRIVATE")),po(Sz,"0.12.4"),po(Sz,"0.12.4","esm2017")}();const M1="analytics",UK="firebase_id",jK="origin",$K=6e4,HK="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",AA="https://www.googletagmanager.com/gtag/js",ks=new E_("@firebase/analytics"),Fa=new Ed("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function WK(n){if(!n.startsWith(AA)){const e=Fa.create("invalid-gtag-resource",{gtagURL:n});return ks.warn(e.message),""}return n}function kz(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function MA(){return(MA=Ie(function*(n,e,t,i,r,s){const u=i[r];try{if(u)yield e[u];else{const v=(yield kz(t)).find(C=>C.measurementId===r);v&&(yield e[v.appId])}}catch(m){ks.error(m)}n("config",r,s)})).apply(this,arguments)}function kA(){return(kA=Ie(function*(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let u=r.send_to;Array.isArray(u)||(u=[u]);const m=yield kz(t);for(const v of u){const C=m.find(R=>R.measurementId===v),S=C&&e[C.appId];if(!S){s=[];break}s.push(S)}}0===s.length&&(s=Object.values(e)),yield Promise.all(s),n("event",i,r||{})}catch(s){ks.error(s)}})).apply(this,arguments)}const tX=30,Rz=new class iX{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function rX(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}function RA(){return(RA=Ie(function*(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:rX(i)},s=HK.replace("{app-id}",t),u=yield fetch(s,r);if(200!==u.status&&304!==u.status){let m="";try{const v=yield u.json();null!==(e=v.error)&&void 0!==e&&e.message&&(m=v.error.message)}catch{}throw Fa.create("config-fetch-failed",{httpStatus:u.status,responseMessage:m})}return u.json()})).apply(this,arguments)}function PA(){return(PA=Ie(function*(n,e=Rz,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw Fa.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Fa.create("no-api-key")}const u=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},m=new cX;return setTimeout(Ie(function*(){m.abort()}),void 0!==t?t:$K),Pz({appId:i,apiKey:r,measurementId:s},u,m,e)})).apply(this,arguments)}function Pz(n,e,t){return OA.apply(this,arguments)}function OA(){return OA=Ie(function*(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=Rz){var s;const{appId:u,measurementId:m}=n;try{yield function aX(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(Fa.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(i,e)}catch(v){if(m)return ks.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${v?.message}]`),{appId:u,measurementId:m};throw v}try{const v=yield function oX(n){return RA.apply(this,arguments)}(n);return r.deleteThrottleMetadata(u),v}catch(v){const C=v;if(!function lX(n){if(!(n instanceof zu&&n.customData))return!1;const e=Number(n.customData.httpStatus);return 429===e||500===e||503===e||504===e}(C)){if(r.deleteThrottleMetadata(u),m)return ks.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${m} provided in the "measurementId" field in the local Firebase config. [${C?.message}]`),{appId:u,measurementId:m};throw v}const S=503===Number(null===(s=C?.customData)||void 0===s?void 0:s.httpStatus)?GD(t,r.intervalMillis,tX):GD(t,r.intervalMillis),R={throttleEndTimeMillis:Date.now()+S,backoffCount:t+1};return r.setThrottleMetadata(u,R),ks.debug(`Calling attemptFetch again in ${S} millis`),Pz(n,R,i,r)}}),OA.apply(this,arguments)}class cX{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let FA,jA;function LA(){return(LA=Ie(function*(n,e,t,i,r){if(r&&r.global)n("event",t,i);else{const s=yield e;n("event",t,Object.assign(Object.assign({},i),{send_to:s}))}})).apply(this,arguments)}function $A(){return($A=Ie(function*(){if(!fm())return ks.warn(Fa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield wb()}catch(n){return ks.warn(Fa.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}return!0})).apply(this,arguments)}function HA(){return HA=Ie(function*(n,e,t,i,r,s,u){var m;const v=function sX(n){return PA.apply(this,arguments)}(n);v.then(K=>{t[K.measurementId]=K.appId,n.options.measurementId&&K.measurementId!==n.options.measurementId&&ks.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${K.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(K=>ks.error(K)),e.push(v);const C=function gX(){return $A.apply(this,arguments)}().then(K=>{if(K)return i.getId()}),[S,R]=yield Promise.all([v,C]);(function eX(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(AA)&&t.src.includes(n))return t;return null})(s)||function ZK(n,e){const t=function qK(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}("firebase-js-sdk-policy",{createScriptURL:WK}),i=document.createElement("script"),r=`${AA}?l=${n}&id=${e}`;i.src=t?t?.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}(s,S.measurementId),jA&&(r("consent","default",jA),function Oz(n){jA=n}(void 0)),r("js",new Date);const j=null!==(m=u?.config)&&void 0!==m?m:{};return j[jK]="firebase",j.update=!0,null!=R&&(j[UK]=R),r("config",S.measurementId,j),FA&&(r("set",FA),function Fz(n){FA=n}(void 0)),S.measurementId}),HA.apply(this,arguments)}class yX{constructor(e){this.app=e}_delete(){return delete Td[this.app.options.appId],Promise.resolve()}}let Td={},Lz=[];const Nz={};let zz,Id,k1="dataLayer",Bz="gtag",GA=!1;function bX(n,e,t){!function vX(){const n=[];if(UD()&&n.push("This is a browser extension environment."),jD()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=Fa.create("invalid-analytics-context",{errorInfo:e});ks.warn(t.message)}}();const i=n.options.appId;if(!i)throw Fa.create("no-app-id");if(!n.options.apiKey){if(!n.options.measurementId)throw Fa.create("no-api-key");ks.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Td[i])throw Fa.create("already-exists",{id:i});if(!GA){!function YK(n){let e=[];Array.isArray(window[n])?e=window[n]:window[n]=e}(k1);const{wrappedGtag:s,gtagCore:u}=function JK(n,e,t,i,r){let s=function(...u){window[i].push(arguments)};return window[r]&&"function"==typeof window[r]&&(s=window[r]),window[r]=function QK(n,e,t,i){function s(){return s=Ie(function*(u,...m){try{if("event"===u){const[v,C]=m;yield function XK(n,e,t,i,r){return kA.apply(this,arguments)}(n,e,t,v,C)}else if("config"===u){const[v,C]=m;yield function KK(n,e,t,i,r,s){return MA.apply(this,arguments)}(n,e,t,i,v,C)}else if("consent"===u){const[v]=m;n("consent","update",v)}else if("get"===u){const[v,C,S]=m;n("get",v,C,S)}else if("set"===u){const[v]=m;n("set",v)}else n(u,...m)}catch(v){ks.error(v)}}),s.apply(this,arguments)}return function r(u){return s.apply(this,arguments)}}(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}(Td,Lz,Nz,k1,Bz);Id=s,zz=u,GA=!0}return Td[i]=function _X(n,e,t,i,r,s,u){return HA.apply(this,arguments)}(n,Lz,Nz,e,zz,k1,t),new yX(n)}function wX(){return WA.apply(this,arguments)}function WA(){return(WA=Ie(function*(){if(UD()||!jD()||!fm())return!1;try{return yield wb()}catch{return!1}})).apply(this,arguments)}const Vz="@firebase/analytics";!function CX(){Oa(new ma(M1,(e,{options:t})=>bX(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t),"PUBLIC")),Oa(new ma("analytics-internal",function n(e){try{const t=e.getProvider(M1).getImmediate();return{logEvent:(i,r,s)=>function EX(n,e,t,i){n=Ho(n),function uX(n,e,t,i,r){return LA.apply(this,arguments)}(Id,Td[n.app.options.appId],e,t,i).catch(r=>ks.error(r))}(t,i,r,s)}}catch(t){throw Fa.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),po(Vz,"0.10.0"),po(Vz,"0.10.0","esm2017")}();class TX extends ze{constructor(e,t){super()}schedule(e,t=0){return this}}const R1={setInterval(n,e,...t){const{delegate:i}=R1;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=R1;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class P1 extends TX{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,i=0){return R1.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&R1.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,f(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const jz={now:()=>(jz.delegate||Date).now(),delegate:void 0};class Sb{constructor(e,t=Sb.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}Sb.now=jz.now;class O1 extends Sb{constructor(e,t=Sb.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const SX=new class DX extends O1{}(class IX extends P1{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,i=0){return null!=i&&i>0||null==i&&this.delay>0?super.requestAsyncId(e,t,i):(e.flush(this),0)}}),Ab=new O1(P1),AX=Ab;function Io(n,e,t){const i=Vt(n)||e||t?{next:n,error:e,complete:t}:n;return i?ti((r,s)=>{var u;null===(u=i.subscribe)||void 0===u||u.call(i);let m=!0;r.subscribe(zn(s,v=>{var C;null===(C=i.next)||void 0===C||C.call(i,v),s.next(v)},()=>{var v;m=!1,null===(v=i.complete)||void 0===v||v.call(i),s.complete()},v=>{var C;m=!1,null===(C=i.error)||void 0===C||C.call(i,v),s.error(v)},()=>{var v,C;m&&(null===(v=i.unsubscribe)||void 0===v||v.call(i)),null===(C=i.finalize)||void 0===C||C.call(i)}))}):Lr}const F1=new Tu("7.6.1"),ZA="__angularfire_symbol__analyticsIsSupportedValue",YA="__angularfire_symbol__analyticsIsSupported",KA="__angularfire_symbol__remoteConfigIsSupportedValue",XA="__angularfire_symbol__remoteConfigIsSupported",QA="__angularfire_symbol__messagingIsSupportedValue",JA="__angularfire_symbol__messagingIsSupported";function tM(n,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(u=>u.app===t);if(1===s.length)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}globalThis[YA]||(globalThis[YA]=wX().then(n=>globalThis[ZA]=n).catch(()=>globalThis[ZA]=!1)),globalThis[JA]||(globalThis[JA]=Mz().then(n=>globalThis[QA]=n).catch(()=>globalThis[QA]=!1)),globalThis[XA]||(globalThis[XA]=qY().then(n=>globalThis[KA]=n).catch(()=>globalThis[KA]=!1));const nM=(n,e)=>{const t=e?[e]:RB(),i=[];return t.forEach(r=>{r.container.getProvider(n).instances.forEach(u=>{i.includes(u)||i.push(u)})}),i};function S_(){}class $z{constructor(e,t=SX){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,i){const r=this.zone;return this.delegate.schedule(function(u){r.runGuarded(()=>{e.apply(this,[u])})},t,i)}}class MX{constructor(e){this.zone=e,this.task=null}call(e,t){const i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",S_,{},S_,S_)),t.pipe(Io({next:i,complete:i,error:i})).subscribe(e).add(i)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let iM=(()=>{class n{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new $z(Zone.current)),this.insideAngular=t.run(()=>new $z(Zone.current,Ab)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return n.\u0275fac=function(t){return new(t||n)(lt(Ti))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Cm(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function Tm(n){return Cm().ngZone.run(()=>n())}function RX(n){return Cm(),function PX(n){return function(t){return(t=t.lift(new MX(n.ngZone))).pipe(ms(n.outsideAngular),Vs(n.insideAngular))}}(Cm())(n)}const OX=(n,e)=>function(){const i=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),Tm(()=>n.apply(void 0,i))},Ch=(n,e)=>function(){let t;const i=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof i[s]&&(e&&(t||(t=Tm(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",S_,{},S_,S_)))),i[s]=OX(i[s],t));const r=function kX(n){return Cm().ngZone.runOutsideAngular(()=>n())}(()=>n.apply(this,i));if(!e){if(r instanceof xn){const s=Cm();return r.pipe(ms(s.outsideAngular),Vs(s.insideAngular))}return Tm(()=>r)}return r instanceof xn?r.pipe(RX):r instanceof Promise?Tm(()=>new Promise((s,u)=>r.then(m=>Tm(()=>s(m)),m=>Tm(()=>u(m))))):"function"==typeof r&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),r.apply(this,arguments)}:Tm(()=>r)};class A_{constructor(e){return e}}class rM{constructor(){return RB()}}const oM=new Ct("angularfire2._apps"),LX={provide:A_,useFactory:function FX(n){return n&&1===n.length?n[0]:new A_(eS())},deps:[[new or,oM]]},NX={provide:rM,deps:[[new or,oM]]};function BX(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new A_(i)}}let zX=(()=>{class n{constructor(t){po("angularfire",F1.full,"core"),po("angularfire",F1.full,"app"),po("angular",_v.full,t.toString())}}return n.\u0275fac=function(t){return new(t||n)(lt(lm))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[LX,NX]}),n})();function VX(n,...e){return{ngModule:zX,providers:[{provide:oM,useFactory:BX(n),multi:!0,deps:[Ti,Uo,iM,...e]}]}}const UX=Ch(kB,!0),sM=new Map,Hz={activated:!1,tokenObservers:[]},jX={initialized:!1,enabled:!1};function mo(n){return sM.get(n)||Object.assign({},Hz)}function L1(){return jX}const aM="https://content-firebaseappcheck.googleapis.com/v1",WX="exchangeDebugToken",Gz={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class ZX{constructor(e,t,i,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return Ie(function*(){t.stop();try{t.pending=new hm,yield function YX(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new hm,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(i){t.retryPolicy(i)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Ks=new Ed("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function lM(n){if(!mo(n).activated)throw Ks.create("use-before-activation",{appName:n.name})}function z1(n,e){return uM.apply(this,arguments)}function uM(){return(uM=Ie(function*({url:n,body:e},t){const i={"Content-Type":"application/json"},r=t.getImmediate({optional:!0});if(r){const R=yield r.getHeartbeatsHeader();R&&(i["X-Firebase-Client"]=R)}const s={method:"POST",body:JSON.stringify(e),headers:i};let u,m;try{u=yield fetch(n,s)}catch(R){throw Ks.create("fetch-network-error",{originalErrorMessage:R?.message})}if(200!==u.status)throw Ks.create("fetch-status-error",{httpStatus:u.status});try{m=yield u.json()}catch(R){throw Ks.create("fetch-parse-error",{originalErrorMessage:R?.message})}const v=m.ttl.match(/^([\d.]+)(s)$/);if(!v||!v[2]||isNaN(Number(v[1])))throw Ks.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${m.ttl}`});const C=1e3*Number(v[1]),S=Date.now();return{token:m.token,expireTimeMillis:S+C,issuedAtTimeMillis:S}})).apply(this,arguments)}function Wz(n,e){const{projectId:t,appId:i,apiKey:r}=n.options;return{url:`${aM}/projects/${t}/apps/${i}:${WX}?key=${r}`,body:{debug_token:e}}}const JX="firebase-app-check-database",eQ=1,Mb="firebase-app-check-store";let V1=null;function Yz(n,e){return dM.apply(this,arguments)}function dM(){return(dM=Ie(function*(n,e){const i=(yield function Zz(){return V1||(V1=new Promise((n,e)=>{try{const t=indexedDB.open(JX,eQ);t.onsuccess=i=>{n(i.target.result)},t.onerror=i=>{var r;e(Ks.create("storage-open",{originalErrorMessage:null===(r=i.target.error)||void 0===r?void 0:r.message}))},t.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(Mb,{keyPath:"compositeKey"})}}catch(t){e(Ks.create("storage-open",{originalErrorMessage:t?.message}))}}),V1)}()).transaction(Mb,"readwrite"),s=i.objectStore(Mb).put({compositeKey:n,value:e});return new Promise((u,m)=>{s.onsuccess=v=>{u()},i.onerror=v=>{var C;m(Ks.create("storage-set",{originalErrorMessage:null===(C=v.target.error)||void 0===C?void 0:C.message}))}})})).apply(this,arguments)}const kb=new E_("@firebase/app-check");function pM(n,e){return fm()?function nQ(n,e){return Yz(function Xz(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{kb.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function gM(){return L1().enabled}function _M(){return yM.apply(this,arguments)}function yM(){return(yM=Ie(function*(){const n=L1();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const lQ={error:"UNKNOWN_ERROR"};function cQ(n){return _1.encodeString(JSON.stringify(n),!1)}function U1(n){return vM.apply(this,arguments)}function vM(){return(vM=Ie(function*(n,e=!1){const t=n.app;lM(t);const i=mo(t);let s,r=i.token;if(r&&!M_(r)&&(i.token=void 0,r=void 0),!r){const v=yield i.cachedTokenPromise;v&&(M_(v)?r=v:yield pM(t,void 0))}if(!e&&r&&M_(r))return{token:r.token};let m,u=!1;if(gM()){i.exchangeTokenPromise||(i.exchangeTokenPromise=z1(Wz(t,yield _M()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),u=!0);const v=yield i.exchangeTokenPromise;return yield pM(t,v),i.token=v,{token:v.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),u=!0),r=yield mo(t).exchangeTokenPromise}catch(v){"appCheck/throttled"===v.code?kb.warn(v.message):kb.error(v),s=v}return r?s?m=M_(r)?{token:r.token,internalError:s}:tV(s):(m={token:r.token},i.token=r,yield pM(t,r)):m=tV(s),u&&function eV(n,e){const t=mo(n).tokenObservers;for(const i of t)try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch{}}(t,m),m})).apply(this,arguments)}function Qz(n){return bM.apply(this,arguments)}function bM(){return(bM=Ie(function*(n){const e=n.app;lM(e);const{provider:t}=mo(e);if(gM()){const i=yield _M(),{token:r}=yield z1(Wz(e,i),n.heartbeatServiceProvider);return{token:r}}{const{token:i}=yield t.getToken();return{token:i}}})).apply(this,arguments)}function wM(n,e){const t=mo(n),i=t.tokenObservers.filter(r=>r.next!==e);0===i.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=i}function Jz(n){const{app:e}=n,t=mo(e);let i=t.tokenRefresher;i||(i=function uQ(n){const{app:e}=n;return new ZX(Ie(function*(){let i;if(i=mo(e).token?yield U1(n,!0):yield U1(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{const t=mo(e);if(t.token){let i=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return i=Math.min(i,t.token.expireTimeMillis-3e5),Math.max(0,i-Date.now())}return 0},Gz.RETRIAL_MIN_WAIT,Gz.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=i),!i.isRunning()&&t.isTokenAutoRefreshEnabled&&i.start()}function M_(n){return n.expireTimeMillis-Date.now()>0}function tV(n){return{token:cQ(lQ),error:n}}class dQ{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=mo(this.app);for(const t of e)wM(this.app,t.next);return Promise.resolve()}}const cV="app-check-internal";!function TQ(){Oa(new ma("app-check",n=>function hQ(n,e){return new dQ(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(cV).initialize()})),Oa(new ma(cV,n=>function fQ(n){return{getToken:e=>U1(n,e),getLimitedUseToken:()=>Qz(n),addTokenListener:e=>function xM(n,e,t,i){const{app:r}=n,s=mo(r);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:i,type:e}],s.token&&M_(s.token)){const m=s.token;Promise.resolve().then(()=>{t({token:m.token}),Jz(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Jz(n))}(n,"INTERNAL",e),removeTokenListener:e=>wM(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),po("@firebase/app-check","0.8.0")}();class IM{constructor(){return nM("app-check")}}typeof window<"u"&&window;const MQ=function dV(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},hV=new Ed("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),$1=new E_("@firebase/auth");function H1(n,...e){$1.logLevel<=nr.ERROR&&$1.error(`Auth (${vm}): ${n}`,...e)}function Tl(n,...e){throw SM(n,...e)}function Yl(n,...e){return SM(n,...e)}function fV(n,e,t){const i=Object.assign(Object.assign({},MQ()),{[e]:t});return new Ed("auth","Firebase",i).create(e,{appName:n.name})}function SM(n,...e){if("string"!=typeof n){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return hV.create(n,...e)}function Lt(n,e,...t){if(!n)throw SM(e,...t)}function Dd(n){const e="INTERNAL ASSERTION FAILED: "+n;throw H1(e),new Error(e)}function Th(n,e){n||Dd(e)}function Rb(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.href)||""}function AM(){return"http:"===pV()||"https:"===pV()}function pV(){var n;return typeof self<"u"&&(null===(n=self.location)||void 0===n?void 0:n.protocol)||null}class Pb{constructor(e,t){this.shortDelay=e,this.longDelay=t,Th(t>e,"Short delay should be less than long delay!"),this.isMobile=VD()||wB()}get(){return function RQ(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(AM()||UD()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function MM(n,e){Th(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class mV{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void Dd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void Dd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void Dd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const OQ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},FQ=new Pb(3e4,6e4);function eo(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function go(n,e,t,i){return kM.apply(this,arguments)}function kM(){return(kM=Ie(function*(n,e,t,i,r={}){return gV(n,r,Ie(function*(){let s={},u={};i&&("GET"===e?u=i:s={body:JSON.stringify(i)});const m=pm(Object.assign({key:n.config.apiKey},u)).slice(1),v=yield n._getAdditionalHeaders();return v["Content-Type"]="application/json",n.languageCode&&(v["X-Firebase-Locale"]=n.languageCode),mV.fetch()(_V(n,n.config.apiHost,t,m),Object.assign({method:e,headers:v,referrerPolicy:"no-referrer"},s))}))})).apply(this,arguments)}function gV(n,e,t){return RM.apply(this,arguments)}function RM(){return(RM=Ie(function*(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},OQ),e);try{const r=new LQ(n),s=yield Promise.race([t(),r.promise]);r.clearNetworkTimeout();const u=yield s.json();if("needConfirmation"in u)throw Ob(n,"account-exists-with-different-credential",u);if(s.ok&&!("errorMessage"in u))return u;{const m=s.ok?u.errorMessage:u.error.message,[v,C]=m.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===v)throw Ob(n,"credential-already-in-use",u);if("EMAIL_EXISTS"===v)throw Ob(n,"email-already-in-use",u);if("USER_DISABLED"===v)throw Ob(n,"user-disabled",u);const S=i[v]||v.toLowerCase().replace(/[_\s]+/g,"-");if(C)throw fV(n,S,C);Tl(n,S)}}catch(r){if(r instanceof zu)throw r;Tl(n,"network-request-failed",{message:String(r)})}})).apply(this,arguments)}function Ih(n,e,t,i){return PM.apply(this,arguments)}function PM(){return(PM=Ie(function*(n,e,t,i,r={}){const s=yield go(n,e,t,i,r);return"mfaPendingCredential"in s&&Tl(n,"multi-factor-auth-required",{_serverResponse:s}),s})).apply(this,arguments)}function _V(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?MM(n.config,r):`${n.config.apiScheme}://${r}`}class LQ{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Yl(this.auth,"network-request-failed")),FQ.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ob(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Yl(n,e,i);return r.customData._tokenResponse=t,r}function OM(){return(OM=Ie(function*(n,e){return go(n,"POST","/v1/accounts:delete",e)})).apply(this,arguments)}function LM(){return(LM=Ie(function*(n,e){return go(n,"POST","/v1/accounts:lookup",e)})).apply(this,arguments)}function Fb(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function NM(){return(NM=Ie(function*(n,e=!1){const t=Ho(n),i=yield t.getIdToken(e),r=G1(i);Lt(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s="object"==typeof r.firebase?r.firebase:void 0,u=s?.sign_in_provider;return{claims:r,token:i,authTime:Fb(BM(r.auth_time)),issuedAtTime:Fb(BM(r.iat)),expirationTime:Fb(BM(r.exp)),signInProvider:u||null,signInSecondFactor:s?.sign_in_second_factor||null}})).apply(this,arguments)}function BM(n){return 1e3*Number(n)}function G1(n){const[e,t,i]=n.split(".");if(void 0===e||void 0===t||void 0===i)return H1("JWT malformed, contained fewer than 3 sections"),null;try{const r=v1(t);return r?JSON.parse(r):(H1("Failed to decode base64 JWT payload"),null)}catch(r){return H1("Caught error parsing JWT payload as JSON",r?.toString()),null}}function Dh(n,e){return zM.apply(this,arguments)}function zM(){return(zM=Ie(function*(n,e,t=!1){if(t)return e;try{return yield e}catch(i){throw i instanceof zu&&function jQ({code:n}){return"auth/user-disabled"===n||"auth/user-token-expired"===n}(i)&&n.auth.currentUser===n&&(yield n.auth.signOut()),i}})).apply(this,arguments)}class $Q{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),i}{this.errorBackoff=3e4;const r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const i=this.getInterval(e);this.timerId=setTimeout(Ie(function*(){yield t.iteration()}),i)}iteration(){var e=this;return Ie(function*(){try{yield e.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===t?.code&&e.schedule(!0))}e.schedule()})()}}class yV{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fb(this.lastLoginAt),this.creationTime=Fb(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Lb(n){return VM.apply(this,arguments)}function VM(){return VM=Ie(function*(n){var e;const t=n.auth,i=yield n.getIdToken(),r=yield Dh(n,function zQ(n,e){return LM.apply(this,arguments)}(t,{idToken:i}));Lt(r?.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const u=null!==(e=s.providerUserInfo)&&void 0!==e&&e.length?function WQ(n){return n.map(e=>{var{providerId:t}=e,i=So(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}(s.providerUserInfo):[],m=function GQ(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}(n.providerData,u),S=!!n.isAnonymous&&!(n.email&&s.passwordHash||m?.length),R={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:m,metadata:new yV(s.createdAt,s.lastLoginAt),isAnonymous:S};Object.assign(n,R)}),VM.apply(this,arguments)}function UM(){return(UM=Ie(function*(n){const e=Ho(n);yield Lb(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})).apply(this,arguments)}function jM(){return(jM=Ie(function*(n,e){const t=yield gV(n,{},Ie(function*(){const i=pm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,u=_V(n,r,"/v1/token",`key=${s}`),m=yield n._getAdditionalHeaders();return m["Content-Type"]="application/x-www-form-urlencoded",mV.fetch()(u,{method:"POST",headers:m,body:i})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})).apply(this,arguments)}class Nb{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Lt(e.idToken,"internal-error"),Lt(typeof e.idToken<"u","internal-error"),Lt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):function UQ(n){const e=G1(n);return Lt(e,"internal-error"),Lt(typeof e.exp<"u","internal-error"),Lt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}getToken(e,t=!1){var i=this;return Ie(function*(){return Lt(!i.accessToken||i.refreshToken,e,"user-token-expired"),t||!i.accessToken||i.isExpired?i.refreshToken?(yield i.refresh(e,i.refreshToken),i.accessToken):null:i.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(e,t){var i=this;return Ie(function*(){const{accessToken:r,refreshToken:s,expiresIn:u}=yield function qQ(n,e){return jM.apply(this,arguments)}(e,t);i.updateTokensAndExpiration(r,s,Number(u))})()}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*i}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,u=new Nb;return i&&(Lt("string"==typeof i,"internal-error",{appName:e}),u.refreshToken=i),r&&(Lt("string"==typeof r,"internal-error",{appName:e}),u.accessToken=r),s&&(Lt("number"==typeof s,"internal-error",{appName:e}),u.expirationTime=s),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nb,this.toJSON())}_performRefresh(){return Dd("not implemented")}}function zf(n,e){Lt("string"==typeof n||typeof n>"u","internal-error",{appName:e})}class Im{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=So(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $Q(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new yV(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){var t=this;return Ie(function*(){const i=yield Dh(t,t.stsTokenManager.getToken(t.auth,e));return Lt(i,t.auth,"internal-error"),t.accessToken!==i&&(t.accessToken=i,yield t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)),i})()}getIdTokenResult(e){return function VQ(n){return NM.apply(this,arguments)}(this,e)}reload(){return function HQ(n){return UM.apply(this,arguments)}(this)}_assign(e){this!==e&&(Lt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Im(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Lt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){var i=this;return Ie(function*(){let r=!1;e.idToken&&e.idToken!==i.stsTokenManager.accessToken&&(i.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Lb(i)),yield i.auth._persistUserIfCurrent(i),r&&i.auth._notifyListenersIfCurrent(i)})()}delete(){var e=this;return Ie(function*(){const t=yield e.getIdToken();return yield Dh(e,function NQ(n,e){return OM.apply(this,arguments)}(e.auth,{idToken:t})),e.stsTokenManager.clearRefreshToken(),e.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,u,m,v,C,S;const R=null!==(i=t.displayName)&&void 0!==i?i:void 0,j=null!==(r=t.email)&&void 0!==r?r:void 0,K=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,ie=null!==(u=t.photoURL)&&void 0!==u?u:void 0,we=null!==(m=t.tenantId)&&void 0!==m?m:void 0,Oe=null!==(v=t._redirectEventId)&&void 0!==v?v:void 0,Ke=null!==(C=t.createdAt)&&void 0!==C?C:void 0,_t=null!==(S=t.lastLoginAt)&&void 0!==S?S:void 0,{uid:Qe,emailVerified:Ht,isAnonymous:ui,providerData:Oi,stsTokenManager:ls}=t;Lt(Qe&&ls,e,"internal-error");const Gu=Nb.fromJSON(this.name,ls);Lt("string"==typeof Qe,e,"internal-error"),zf(R,e.name),zf(j,e.name),Lt("boolean"==typeof Ht,e,"internal-error"),Lt("boolean"==typeof ui,e,"internal-error"),zf(K,e.name),zf(ie,e.name),zf(we,e.name),zf(Oe,e.name),zf(Ke,e.name),zf(_t,e.name);const tc=new Im({uid:Qe,auth:e,email:j,emailVerified:Ht,displayName:R,isAnonymous:ui,photoURL:ie,phoneNumber:K,tenantId:we,stsTokenManager:Gu,createdAt:Ke,lastLoginAt:_t});return Oi&&Array.isArray(Oi)&&(tc.providerData=Oi.map(Wu=>Object.assign({},Wu))),Oe&&(tc._redirectEventId=Oe),tc}static _fromIdTokenResponse(e,t,i=!1){return Ie(function*(){const r=new Nb;r.updateFromServerResponse(t);const s=new Im({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return yield Lb(s),s})()}}const vV=new Map;function Sh(n){Th(n instanceof Function,"Expected a class definition");let e=vV.get(n);return e?(Th(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vV.set(n,e),e)}const bV=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Ie(function*(){return!0})()}_set(t,i){var r=this;return Ie(function*(){r.storage[t]=i})()}_get(t){var i=this;return Ie(function*(){const r=i.storage[t];return void 0===r?null:r})()}_remove(t){var i=this;return Ie(function*(){delete i.storage[t]})()}_addListener(t,i){}_removeListener(t,i){}}return n.type="NONE",n})();function W1(n,e,t){return`firebase:${n}:${e}:${t}`}class R_{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=W1(this.userKey,r.apiKey,s),this.fullPersistenceKey=W1("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){var e=this;return Ie(function*(){const t=yield e.persistence._get(e.fullUserKey);return t?Im._fromJSON(e.auth,t):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){var t=this;return Ie(function*(){if(t.persistence===e)return;const i=yield t.getCurrentUser();return yield t.removeCurrentUser(),t.persistence=e,i?t.setCurrentUser(i):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,i="authUser"){return Ie(function*(){if(!t.length)return new R_(Sh(bV),e,i);const r=(yield Promise.all(t.map(function(){var C=Ie(function*(S){if(yield S._isAvailable())return S});return function(S){return C.apply(this,arguments)}}()))).filter(C=>C);let s=r[0]||Sh(bV);const u=W1(i,e.config.apiKey,e.name);let m=null;for(const C of t)try{const S=yield C._get(u);if(S){const R=Im._fromJSON(e,S);C!==s&&(m=R),s=C;break}}catch{}const v=r.filter(C=>C._shouldAllowMigration);return s._shouldAllowMigration&&v.length?(s=v[0],m&&(yield s._set(u,m.toJSON())),yield Promise.all(t.map(function(){var C=Ie(function*(S){if(S!==s)try{yield S._remove(u)}catch{}});return function(S){return C.apply(this,arguments)}}())),new R_(s,e,i)):new R_(s,e,i)})()}}function xV(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CV(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(wV(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IV(e))return"Blackberry";if(DV(e))return"Webos";if($M(e))return"Safari";if((e.includes("chrome/")||EV(e))&&!e.includes("edge/"))return"Chrome";if(TV(e))return"Android";{const i=n.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===i?.length)return i[1]}return"Other"}function wV(n=Ms()){return/firefox\//i.test(n)}function $M(n=Ms()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function EV(n=Ms()){return/crios\//i.test(n)}function CV(n=Ms()){return/iemobile/i.test(n)}function TV(n=Ms()){return/android/i.test(n)}function IV(n=Ms()){return/blackberry/i.test(n)}function DV(n=Ms()){return/webos/i.test(n)}function q1(n=Ms()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function SV(n=Ms()){return q1(n)||TV(n)||DV(n)||IV(n)||/windows phone/i.test(n)||CV(n)}function AV(n,e=[]){let t;switch(n){case"Browser":t=xV(Ms());break;case"Worker":t=`${xV(Ms())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${vm}/${i}`}function HM(){return(HM=Ie(function*(n){return(yield go(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function MV(n,e){return GM.apply(this,arguments)}function GM(){return(GM=Ie(function*(n,e){return go(n,"GET","/v2/recaptchaConfig",eo(n,e))})).apply(this,arguments)}function kV(n){return void 0!==n&&void 0!==n.getResponse}function RV(n){return void 0!==n&&void 0!==n.enterprise}class PV{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>"EMAIL_PASSWORD_PROVIDER"===t.provider&&"OFF"!==t.enforcementState)}}function WM(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=Yl("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",function QQ(){var n,e;return null!==(e=null===(n=document.getElementsByTagName("head"))||void 0===n?void 0:n[0])&&void 0!==e?e:document}().appendChild(i)})}function OV(n){return`__${n}${Math.floor(1e6*Math.random())}`}const tJ="NO_RECAPTCHA";class FV{constructor(e){this.type="recaptcha-enterprise",this.auth=Rs(e)}verify(e="verify",t=!1){var i=this;return Ie(function*(){function s(){return s=Ie(function*(m){if(!t){if(null==m.tenantId&&null!=m._agentRecaptchaConfig)return m._agentRecaptchaConfig.siteKey;if(null!=m.tenantId&&void 0!==m._tenantRecaptchaConfigs[m.tenantId])return m._tenantRecaptchaConfigs[m.tenantId].siteKey}return new Promise(function(){var v=Ie(function*(C,S){MV(m,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(R=>{if(void 0!==R.recaptchaKey){const j=new PV(R);return null==m.tenantId?m._agentRecaptchaConfig=j:m._tenantRecaptchaConfigs[m.tenantId]=j,C(j.siteKey)}S(new Error("recaptcha Enterprise site key undefined"))}).catch(R=>{S(R)})});return function(C,S){return v.apply(this,arguments)}}())}),s.apply(this,arguments)}function u(m,v,C){const S=window.grecaptcha;RV(S)?S.enterprise.ready(()=>{S.enterprise.execute(m,{action:e}).then(R=>{v(R)}).catch(()=>{v(tJ)})}):C(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((m,v)=>{(function r(m){return s.apply(this,arguments)})(i.auth).then(C=>{if(!t&&RV(window.grecaptcha))u(C,m,v);else{if(typeof window>"u")return void v(new Error("RecaptchaVerifier is only supported in browser"));WM("https://www.google.com/recaptcha/enterprise.js?render="+C).then(()=>{u(C,m,v)}).catch(S=>{v(S)})}}).catch(C=>{v(C)})})})()}}function Vf(n,e,t){return qM.apply(this,arguments)}function qM(){return(qM=Ie(function*(n,e,t,i=!1){const r=new FV(n);let s;try{s=yield r.verify(t)}catch{s=yield r.verify(t,!0)}const u=Object.assign({},e);return Object.assign(u,i?{captchaResp:s}:{captchaResponse:s}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u})).apply(this,arguments)}class nJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((u,m)=>{try{u(e(s))}catch(v){m(v)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}runMiddleware(e){var t=this;return Ie(function*(){if(t.auth.currentUser===e)return;const i=[];try{for(const r of t.queue)yield r(e),r.onAbort&&i.push(r.onAbort)}catch(r){i.reverse();for(const s of i)try{s()}catch{}throw t.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})()}}class iJ{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LV(this),this.idTokenSubscription=new LV(this),this.beforeStateQueue=new nJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hV,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){var i=this;return t&&(this._popupRedirectResolver=Sh(t)),this._initializationPromise=this.queue(Ie(function*(){var r,s;if(!i._deleted&&(i.persistenceManager=yield R_.create(i,e),!i._deleted)){if(null!==(r=i._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{yield i._popupRedirectResolver._initialize(i)}catch{}yield i.initializeCurrentUser(t),i.lastNotifiedUid=(null===(s=i.currentUser)||void 0===s?void 0:s.uid)||null,!i._deleted&&(i._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var e=this;return Ie(function*(){if(e._deleted)return;const t=yield e.assertedPersistence.getCurrentUser();if(e.currentUser||t){if(e.currentUser&&t&&e.currentUser.uid===t.uid)return e._currentUser._assign(t),void(yield e.currentUser.getIdToken());yield e._updateCurrentUser(t,!0)}})()}initializeCurrentUser(e){var t=this;return Ie(function*(){var i;const r=yield t.assertedPersistence.getCurrentUser();let s=r,u=!1;if(e&&t.config.authDomain){yield t.getOrInitRedirectPersistenceManager();const m=null===(i=t.redirectUser)||void 0===i?void 0:i._redirectEventId,v=s?._redirectEventId,C=yield t.tryRedirectSignIn(e);(!m||m===v)&&C?.user&&(s=C.user,u=!0)}if(!s)return t.directlySetCurrentUser(null);if(!s._redirectEventId){if(u)try{yield t.beforeStateQueue.runMiddleware(s)}catch(m){s=r,t._popupRedirectResolver._overrideRedirectResult(t,()=>Promise.reject(m))}return s?t.reloadAndSetCurrentUserOrClear(s):t.directlySetCurrentUser(null)}return Lt(t._popupRedirectResolver,t,"argument-error"),yield t.getOrInitRedirectPersistenceManager(),t.redirectUser&&t.redirectUser._redirectEventId===s._redirectEventId?t.directlySetCurrentUser(s):t.reloadAndSetCurrentUserOrClear(s)})()}tryRedirectSignIn(e){var t=this;return Ie(function*(){let i=null;try{i=yield t._popupRedirectResolver._completeRedirectFn(t,e,!0)}catch{yield t._setRedirectUser(null)}return i})()}reloadAndSetCurrentUserOrClear(e){var t=this;return Ie(function*(){try{yield Lb(e)}catch(i){if("auth/network-request-failed"!==i?.code)return t.directlySetCurrentUser(null)}return t.directlySetCurrentUser(e)})()}useDeviceLanguage(){this.languageCode=function PQ(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}()}_delete(){var e=this;return Ie(function*(){e._deleted=!0})()}updateCurrentUser(e){var t=this;return Ie(function*(){const i=e?Ho(e):null;return i&&Lt(i.auth.config.apiKey===t.config.apiKey,t,"invalid-user-token"),t._updateCurrentUser(i&&i._clone(t))})()}_updateCurrentUser(e,t=!1){var i=this;return Ie(function*(){if(!i._deleted)return e&&Lt(i.tenantId===e.tenantId,i,"tenant-id-mismatch"),t||(yield i.beforeStateQueue.runMiddleware(e)),i.queue(Ie(function*(){yield i.directlySetCurrentUser(e),i.notifyAuthListeners()}))})()}signOut(){var e=this;return Ie(function*(){return yield e.beforeStateQueue.runMiddleware(null),(e.redirectPersistenceManager||e._popupRedirectResolver)&&(yield e._setRedirectUser(null)),e._updateCurrentUser(null,!0)})()}setPersistence(e){var t=this;return this.queue(Ie(function*(){yield t.assertedPersistence.setPersistence(Sh(e))}))}initializeRecaptchaConfig(){var e=this;return Ie(function*(){const t=yield MV(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new PV(t);null==e.tenantId?e._agentRecaptchaConfig=i:e._tenantRecaptchaConfigs[e.tenantId]=i,i.emailPasswordEnabled&&new FV(e).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ed("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}_setRedirectUser(e,t){var i=this;return Ie(function*(){const r=yield i.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)})()}getOrInitRedirectPersistenceManager(e){var t=this;return Ie(function*(){if(!t.redirectPersistenceManager){const i=e&&Sh(e)||t._popupRedirectResolver;Lt(i,t,"argument-error"),t.redirectPersistenceManager=yield R_.create(t,[Sh(i._redirectPersistence)],"redirectUser"),t.redirectUser=yield t.redirectPersistenceManager.getCurrentUser()}return t.redirectPersistenceManager})()}_redirectUserForId(e){var t=this;return Ie(function*(){var i,r;return t._isInitialized&&(yield t.queue(Ie(function*(){}))),(null===(i=t._currentUser)||void 0===i?void 0:i._redirectEventId)===e?t._currentUser:(null===(r=t.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?t.redirectUser:null})()}_persistUserIfCurrent(e){var t=this;return Ie(function*(){if(e===t.currentUser)return t.queue(Ie(function*(){return t.directlySetCurrentUser(e)}))})()}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t),u=this._isInitialized?Promise.resolve():this._initializationPromise;return Lt(u,this,"internal-error"),u.then(()=>s(this.currentUser)),"function"==typeof t?e.addObserver(t,i,r):e.addObserver(t)}directlySetCurrentUser(e){var t=this;return Ie(function*(){t.currentUser&&t.currentUser!==e&&t._currentUser._stopProactiveRefresh(),e&&t.isProactiveRefreshEnabled&&e._startProactiveRefresh(),t.currentUser=e,e?yield t.assertedPersistence.setCurrentUser(e):yield t.assertedPersistence.removeCurrentUser()})()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Lt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=AV(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var e=this;return Ie(function*(){var t;const i={"X-Client-Version":e.clientVersion};e.app.options.appId&&(i["X-Firebase-gmpid"]=e.app.options.appId);const r=yield null===(t=e.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();r&&(i["X-Firebase-Client"]=r);const s=yield e._getAppCheckToken();return s&&(i["X-Firebase-AppCheck"]=s),i})()}_getAppCheckToken(){var e=this;return Ie(function*(){var t;const i=yield null===(t=e.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();return i?.error&&function kQ(n,...e){$1.logLevel<=nr.WARN&&$1.warn(`Auth (${vm}): ${n}`,...e)}(`Error while retrieving App Check token: ${i.error}`),i?.token})()}}function Rs(n){return Ho(n)}class LV{constructor(e){this.auth=e,this.observer=null,this.addObserver=function u9(n,e){const t=new d9(n,e);return t.subscribe.bind(t)}(t=>this.observer=t)}get next(){return Lt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function NV(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function BV(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}class Z1{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Dd("not implemented")}_getIdTokenResponse(e){return Dd("not implemented")}_linkToIdToken(e,t){return Dd("not implemented")}_getReauthenticationResolver(e){return Dd("not implemented")}}function VV(n,e){return YM.apply(this,arguments)}function YM(){return(YM=Ie(function*(n,e){return go(n,"POST","/v1/accounts:update",e)})).apply(this,arguments)}function XM(n,e){return QM.apply(this,arguments)}function QM(){return(QM=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithPassword",eo(n,e))})).apply(this,arguments)}function sk(){return(sk=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithEmailLink",eo(n,e))})).apply(this,arguments)}function ak(){return(ak=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithEmailLink",eo(n,e))})).apply(this,arguments)}class Bb extends Z1{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Bb(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Bb(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){var t=this;return Ie(function*(){var i;switch(t.signInMethod){case"password":const r={returnSecureToken:!0,email:t._email,password:t._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.emailPasswordEnabled){const s=yield Vf(e,r,"signInWithPassword");return XM(e,s)}return XM(e,r).catch(function(){var s=Ie(function*(u){if("auth/missing-recaptcha-token"===u.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const m=yield Vf(e,r,"signInWithPassword");return XM(e,m)}return Promise.reject(u)});return function(u){return s.apply(this,arguments)}}());case"emailLink":return function hJ(n,e){return sk.apply(this,arguments)}(e,{email:t._email,oobCode:t._password});default:Tl(e,"internal-error")}})()}_linkToIdToken(e,t){var i=this;return Ie(function*(){switch(i.signInMethod){case"password":return VV(e,{idToken:t,returnSecureToken:!0,email:i._email,password:i._password});case"emailLink":return function fJ(n,e){return ak.apply(this,arguments)}(e,{idToken:t,email:i._email,oobCode:i._password});default:Tl(e,"internal-error")}})()}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}function Ah(n,e){return lk.apply(this,arguments)}function lk(){return(lk=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithIdp",eo(n,e))})).apply(this,arguments)}class P_ extends Z1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new P_(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=So(t,["providerId","signInMethod"]);if(!i||!r)return null;const u=new P_(i,r);return u.idToken=s.idToken||void 0,u.accessToken=s.accessToken||void 0,u.secret=s.secret,u.nonce=s.nonce,u.pendingToken=s.pendingToken||null,u}_getIdTokenResponse(e){return Ah(e,this.buildRequest())}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Ah(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ah(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=pm(t)}return e}}function ck(){return(ck=Ie(function*(n,e){return go(n,"POST","/v1/accounts:sendVerificationCode",eo(n,e))})).apply(this,arguments)}function uk(){return(uk=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithPhoneNumber",eo(n,e))})).apply(this,arguments)}function dk(){return(dk=Ie(function*(n,e){const t=yield Ih(n,"POST","/v1/accounts:signInWithPhoneNumber",eo(n,e));if(t.temporaryProof)throw Ob(n,"account-exists-with-different-credential",t);return t})).apply(this,arguments)}const yJ={USER_NOT_FOUND:"user-not-found"};function hk(){return(hk=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signInWithPhoneNumber",eo(n,Object.assign(Object.assign({},e),{operation:"REAUTH"})),yJ)})).apply(this,arguments)}class zb extends Z1{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new zb({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new zb({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return function gJ(n,e){return uk.apply(this,arguments)}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return function _J(n,e){return dk.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return function vJ(n,e){return hk.apply(this,arguments)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:i,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:i,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:i,phoneNumber:r,temporaryProof:s}=e;return i||t||r||s?new zb({verificationId:t,verificationCode:i,phoneNumber:r,temporaryProof:s}):null}}class Vb{constructor(e){var t,i,r,s,u,m;const v=Cb(Tb(e)),C=null!==(t=v.apiKey)&&void 0!==t?t:null,S=null!==(i=v.oobCode)&&void 0!==i?i:null,R=function bJ(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=v.mode)&&void 0!==r?r:null);Lt(C&&S&&R,"argument-error"),this.apiKey=C,this.operation=R,this.code=S,this.continueUrl=null!==(s=v.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(u=v.languageCode)&&void 0!==u?u:null,this.tenantId=null!==(m=v.tenantId)&&void 0!==m?m:null}static parseLink(e){const t=function xJ(n){const e=Cb(Tb(n)).link,t=e?Cb(Tb(e)).deep_link_id:null,i=Cb(Tb(n)).deep_link_id;return(i?Cb(Tb(i)).link:null)||i||t||e||n}(e);try{return new Vb(t)}catch{return null}}}let UV=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,i){return Bb._fromEmailAndPassword(t,i)}static credentialWithLink(t,i){const r=Vb.parseLink(i);return Lt(r,"argument-error"),Bb._fromEmailAndCode(t,r.code,r.tenantId)}}return n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink",n})();class Uf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class jV extends Uf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}let wJ=(()=>{class n extends jV{constructor(){super("google.com"),this.addScope("profile")}static credential(t,i){return P_._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:i})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:i,oauthAccessToken:r}=t;if(!i&&!r)return null;try{return n.credential(i,r)}catch{return null}}}return n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com",n})();function X1(n,e){return pk.apply(this,arguments)}function pk(){return(pk=Ie(function*(n,e){return Ih(n,"POST","/v1/accounts:signUp",eo(n,e))})).apply(this,arguments)}class Bc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,i,r=!1){return Ie(function*(){const s=yield Im._fromIdTokenResponse(e,i,r),u=$V(i);return new Bc({user:s,providerId:u,_tokenResponse:i,operationType:t})})()}static _forOperation(e,t,i){return Ie(function*(){yield e._updateTokensIfNecessary(i,!0);const r=$V(i);return new Bc({user:e,providerId:r,_tokenResponse:i,operationType:t})})()}}function $V(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Q1 extends zu{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Q1.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Q1(e,t,i,r)}}function HV(n,e,t,i){return("reauthenticate"===e?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw"auth/multi-factor-auth-required"===s.code?Q1._fromErrorAndOperation(n,s,e,i):s})}function _k(n,e){return yk.apply(this,arguments)}function yk(){return(yk=Ie(function*(n,e,t=!1){const i=yield Dh(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Bc._forOperation(n,"link",i)})).apply(this,arguments)}function WV(n,e){return bk.apply(this,arguments)}function bk(){return(bk=Ie(function*(n,e,t=!1){const{auth:i}=n,r="reauthenticate";try{const s=yield Dh(n,HV(i,r,e,n),t);Lt(s.idToken,i,"internal-error");const u=G1(s.idToken);Lt(u,i,"internal-error");const{sub:m}=u;return Lt(n.uid===m,i,"user-mismatch"),Bc._forOperation(n,r,s)}catch(s){throw"auth/user-not-found"===s?.code&&Tl(i,"user-mismatch"),s}})).apply(this,arguments)}function qV(n,e){return xk.apply(this,arguments)}function xk(){return(xk=Ie(function*(n,e,t=!1){const i="signIn",r=yield HV(n,i,e),s=yield Bc._fromIdTokenResponse(n,i,r);return t||(yield n._updateCurrentUser(s.user)),s})).apply(this,arguments)}function wk(n,e){return Ek.apply(this,arguments)}function Ek(){return(Ek=Ie(function*(n,e){return qV(Rs(n),e)})).apply(this,arguments)}function AJ(n,e,t){return Lk.apply(this,arguments)}function Lk(){return Lk=Ie(function*(n,e,t){var i;const r=Rs(n),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"};let u;if(null!==(i=r._getRecaptchaConfig())&&void 0!==i&&i.emailPasswordEnabled){const C=yield Vf(r,s,"signUpPassword");u=X1(r,C)}else u=X1(r,s).catch(function(){var C=Ie(function*(S){if("auth/missing-recaptcha-token"===S.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const R=yield Vf(r,s,"signUpPassword");return X1(r,R)}return Promise.reject(S)});return function(S){return C.apply(this,arguments)}}());const m=yield u.catch(C=>Promise.reject(C)),v=yield Bc._fromIdTokenResponse(r,"signIn",m);return yield r._updateCurrentUser(v.user),v}),Lk.apply(this,arguments)}function MJ(n,e,t){return wk(Ho(n),UV.credential(e,t))}function VJ(n,e,t,i){return Ho(n).onAuthStateChanged(e,t,i)}function UJ(n){return Ho(n).signOut()}const eE="__sak";class YV{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(eE,"1"),this.storage.removeItem(eE),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const YJ=(()=>{class n extends YV{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,i)=>this.onStorageEvent(t,i),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function WJ(){const n=Ms();return $M(n)||q1(n)}()&&function KQ(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=SV(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const i of Object.keys(this.listeners)){const r=this.storage.getItem(i),s=this.localCache[i];r!==s&&t(i,s,r)}}onStorageEvent(t,i=!1){if(!t.key)return void this.forAllChangedKeys((m,v,C)=>{this.notifyListeners(m,C)});const r=t.key;if(i?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const m=this.storage.getItem(r);if(t.newValue!==m)null!==t.newValue?this.storage.setItem(r,t.newValue):this.storage.removeItem(r);else if(this.localCache[r]===t.newValue&&!i)return}const s=()=>{const m=this.storage.getItem(r);!i&&this.localCache[r]===m||this.notifyListeners(r,m)},u=this.storage.getItem(r);!function YQ(){return function n9(){const n=Ms();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}()&&10===document.documentMode}()||u===t.newValue||t.newValue===t.oldValue?s():setTimeout(s,10)}notifyListeners(t,i){this.localCache[t]=i;const r=this.listeners[t];if(r)for(const s of Array.from(r))s(i&&JSON.parse(i))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,i,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:i,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,i){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(t,i){var r=()=>super._set,s=this;return Ie(function*(){yield r().call(s,t,i),s.localCache[t]=JSON.stringify(i)})()}_get(t){var i=()=>super._get,r=this;return Ie(function*(){const s=yield i().call(r,t);return r.localCache[t]=JSON.stringify(s),s})()}_remove(t){var i=()=>super._remove,r=this;return Ie(function*(){yield i().call(r,t),delete r.localCache[t]})()}}return n.type="LOCAL",n})(),KV=(()=>{class n extends YV{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,i){}_removeListener(t,i){}}return n.type="SESSION",n})();let XJ=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const i=this.receivers.find(s=>s.isListeningto(t));if(i)return i;const r=new n(t);return this.receivers.push(r),r}isListeningto(t){return this.eventTarget===t}handleEvent(t){var i=this;return Ie(function*(){const r=t,{eventId:s,eventType:u,data:m}=r.data,v=i.handlersMap[u];if(!v?.size)return;r.ports[0].postMessage({status:"ack",eventId:s,eventType:u});const C=Array.from(v).map(function(){var R=Ie(function*(j){return j(r.origin,m)});return function(j){return R.apply(this,arguments)}}()),S=yield function KJ(n){return Promise.all(n.map(function(){var e=Ie(function*(t){try{return{fulfilled:!0,value:yield t}}catch(i){return{fulfilled:!1,reason:i}}});return function(t){return e.apply(this,arguments)}}()))}(C);r.ports[0].postMessage({status:"done",eventId:s,eventType:u,response:S})})()}_subscribe(t,i){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(i)}_unsubscribe(t,i){this.handlersMap[t]&&i&&this.handlersMap[t].delete(i),(!i||0===this.handlersMap[t].size)&&delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return n.receivers=[],n})();function tE(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(10*Math.random());return n+t}class QJ{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,i=50){var r=this;return Ie(function*(){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let u,m;return new Promise((v,C)=>{const S=tE("",20);s.port1.start();const R=setTimeout(()=>{C(new Error("unsupported_event"))},i);m={messageChannel:s,onMessage(j){const K=j;if(K.data.eventId===S)switch(K.data.status){case"ack":clearTimeout(R),u=setTimeout(()=>{C(new Error("timeout"))},3e3);break;case"done":clearTimeout(u),v(K.data.response);break;default:clearTimeout(R),clearTimeout(u),C(new Error("invalid_response"))}}},r.handlers.add(m),s.port1.addEventListener("message",m.onMessage),r.target.postMessage({eventType:e,eventId:S,data:t},[s.port2])}).finally(()=>{m&&r.removeMessageHandler(m)})})()}}function Go(){return window}function Xk(){return typeof Go().WorkerGlobalScope<"u"&&"function"==typeof Go().importScripts}function Qk(){return(Qk=Ie(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const XV="firebaseLocalStorageDb",iee=1,nE="firebaseLocalStorage",QV="fbase_key";class jb{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function iE(n,e){return n.transaction([nE],e?"readwrite":"readonly").objectStore(nE)}function Jk(){const n=indexedDB.open(XV,iee);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(nE,{keyPath:QV})}catch(r){t(r)}}),n.addEventListener("success",Ie(function*(){const i=n.result;i.objectStoreNames.contains(nE)?e(i):(i.close(),yield function ree(){const n=indexedDB.deleteDatabase(XV);return new jb(n).toPromise()}(),e(yield Jk()))}))})}function JV(n,e,t){return eR.apply(this,arguments)}function eR(){return(eR=Ie(function*(n,e,t){const i=iE(n,!0).put({[QV]:e,value:t});return new jb(i).toPromise()})).apply(this,arguments)}function tR(){return(tR=Ie(function*(n,e){const t=iE(n,!1).get(e),i=yield new jb(t).toPromise();return void 0===i?null:i.value})).apply(this,arguments)}function e3(n,e){const t=iE(n,!0).delete(e);return new jb(t).toPromise()}const lee=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var t=this;return Ie(function*(){return t.db||(t.db=yield Jk()),t.db})()}_withRetries(t){var i=this;return Ie(function*(){let r=0;for(;;)try{const s=yield i._openDb();return yield t(s)}catch(s){if(r++>3)throw s;i.db&&(i.db.close(),i.db=void 0)}})()}initializeServiceWorkerMessaging(){var t=this;return Ie(function*(){return Xk()?t.initializeReceiver():t.initializeSender()})()}initializeReceiver(){var t=this;return Ie(function*(){t.receiver=XJ._getInstance(function nee(){return Xk()?self:null}()),t.receiver._subscribe("keyChanged",function(){var i=Ie(function*(r,s){return{keyProcessed:(yield t._poll()).includes(s.key)}});return function(r,s){return i.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var i=Ie(function*(r,s){return["keyChanged"]});return function(r,s){return i.apply(this,arguments)}}())})()}initializeSender(){var t=this;return Ie(function*(){var i,r;if(t.activeServiceWorker=yield function eee(){return Qk.apply(this,arguments)}(),!t.activeServiceWorker)return;t.sender=new QJ(t.activeServiceWorker);const s=yield t.sender._send("ping",{},800);s&&null!==(i=s[0])&&void 0!==i&&i.fulfilled&&null!==(r=s[0])&&void 0!==r&&r.value.includes("keyChanged")&&(t.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(t){var i=this;return Ie(function*(){if(i.sender&&i.activeServiceWorker&&function tee(){var n;return(null===(n=navigator?.serviceWorker)||void 0===n?void 0:n.controller)||null}()===i.activeServiceWorker)try{yield i.sender._send("keyChanged",{key:t},i.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return Ie(function*(){try{if(!indexedDB)return!1;const t=yield Jk();return yield JV(t,eE,"1"),yield e3(t,eE),!0}catch{}return!1})()}_withPendingWrite(t){var i=this;return Ie(function*(){i.pendingWrites++;try{yield t()}finally{i.pendingWrites--}})()}_set(t,i){var r=this;return Ie(function*(){return r._withPendingWrite(Ie(function*(){return yield r._withRetries(s=>JV(s,t,i)),r.localCache[t]=i,r.notifyServiceWorker(t)}))})()}_get(t){var i=this;return Ie(function*(){const r=yield i._withRetries(s=>function oee(n,e){return tR.apply(this,arguments)}(s,t));return i.localCache[t]=r,r})()}_remove(t){var i=this;return Ie(function*(){return i._withPendingWrite(Ie(function*(){return yield i._withRetries(r=>e3(r,t)),delete i.localCache[t],i.notifyServiceWorker(t)}))})()}_poll(){var t=this;return Ie(function*(){const i=yield t._withRetries(u=>{const m=iE(u,!1).getAll();return new jb(m).toPromise()});if(!i)return[];if(0!==t.pendingWrites)return[];const r=[],s=new Set;for(const{fbase_key:u,value:m}of i)s.add(u),JSON.stringify(t.localCache[u])!==JSON.stringify(m)&&(t.notifyListeners(u,m),r.push(u));for(const u of Object.keys(t.localCache))t.localCache[u]&&!s.has(u)&&(t.notifyListeners(u,null),r.push(u));return r})()}notifyListeners(t,i){this.localCache[t]=i;const r=this.listeners[t];if(r)for(const s of Array.from(r))s(i)}startPolling(){var t=this;this.stopPolling(),this.pollTimer=setInterval(Ie(function*(){return t._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,i){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(i)}_removeListener(t,i){this.listeners[t]&&(this.listeners[t].delete(i),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return n.type="LOCAL",n})(),rE=1e12;class pee{constructor(e){this.auth=e,this.counter=rE,this._widgets=new Map}render(e,t){const i=this.counter;return this._widgets.set(i,new mee(e,this.auth.name,t||{})),this.counter++,i}reset(e){var t;const i=e||rE;null===(t=this._widgets.get(i))||void 0===t||t.delete(),this._widgets.delete(i)}getResponse(e){var t;return(null===(t=this._widgets.get(e||rE))||void 0===t?void 0:t.getResponse())||""}execute(e){var t=this;return Ie(function*(){var i;return null===(i=t._widgets.get(e||rE))||void 0===i||i.execute(),""})()}}class mee{constructor(e,t,i){this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;Lt(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function gee(n){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<n;i++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const nR=OV("rcb"),_ee=new Pb(3e4,6e4);class vee{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(e=Go().grecaptcha)||void 0===e||!e.render)}load(e,t=""){return Lt(function bee(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&kV(Go().grecaptcha)?Promise.resolve(Go().grecaptcha):new Promise((i,r)=>{const s=Go().setTimeout(()=>{r(Yl(e,"network-request-failed"))},_ee.get());Go()[nR]=()=>{Go().clearTimeout(s),delete Go()[nR];const m=Go().grecaptcha;if(!m||!kV(m))return void r(Yl(e,"internal-error"));const v=m.render;m.render=(C,S)=>{const R=v(C,S);return this.counter++,R},this.hostLanguage=t,i(m)},WM(`https://www.google.com/recaptcha/api.js??${pm({onload:nR,render:"explicit",hl:t})}`).catch(()=>{clearTimeout(s),r(Yl(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!(null===(t=Go().grecaptcha)||void 0===t||!t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class xee{load(e){return Ie(function*(){return new pee(e)})()}clearedOneInstance(){}}const t3="recaptcha",wee={theme:"light",type:"image"};class Eee{constructor(e,t=Object.assign({},wee),i){this.parameters=t,this.type=t3,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Rs(i),this.isInvisible="invisible"===this.parameters.size,Lt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;Lt(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new xee:new vee,this.validateStartingState()}verify(){var e=this;return Ie(function*(){e.assertNotDestroyed();const t=yield e.render(),i=e.getAssertedRecaptcha();return i.getResponse(t)||new Promise(s=>{const u=m=>{m&&(e.tokenChangeListeners.delete(u),s(m))};e.tokenChangeListeners.add(u),e.isInvisible&&i.execute(t)})})()}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Lt(!this.parameters.sitekey,this.auth,"argument-error"),Lt(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Lt(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(i=>i(t)),"function"==typeof e)e(t);else if("string"==typeof e){const i=Go()[e];"function"==typeof i&&i(t)}}}assertNotDestroyed(){Lt(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var e=this;return Ie(function*(){if(yield e.init(),!e.widgetId){let t=e.container;if(!e.isInvisible){const i=document.createElement("div");t.appendChild(i),t=i}e.widgetId=e.getAssertedRecaptcha().render(t,e.parameters)}return e.widgetId})()}init(){var e=this;return Ie(function*(){Lt(AM()&&!Xk(),e.auth,"internal-error"),yield function Cee(){let n=null;return new Promise(e=>{"complete"!==document.readyState?(n=()=>e(),window.addEventListener("load",n)):e()}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}(),e.recaptcha=yield e._recaptchaLoader.load(e.auth,e.auth.languageCode||void 0);const t=yield function XQ(n){return HM.apply(this,arguments)}(e.auth);Lt(t,e.auth,"internal-error"),e.parameters.sitekey=t})()}getAssertedRecaptcha(){return Lt(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class iR{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=zb._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}function Tee(n,e,t){return rR.apply(this,arguments)}function rR(){return(rR=Ie(function*(n,e,t){const i=Rs(n),r=yield function aR(n,e,t){return lR.apply(this,arguments)}(i,e,Ho(t));return new iR(r,s=>wk(i,s))})).apply(this,arguments)}function lR(){return lR=Ie(function*(n,e,t){var i;const r=yield t.verify();try{let s;if(Lt("string"==typeof r,n,"argument-error"),Lt(t.type===t3,n,"argument-error"),s="string"==typeof e?{phoneNumber:e}:e,"session"in s){const u=s.session;if("phoneNumber"in s)return Lt("enroll"===u.type,n,"internal-error"),(yield function jJ(n,e){return go(n,"POST","/v2/accounts/mfaEnrollment:start",eo(n,e))}(n,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{Lt("signin"===u.type,n,"internal-error");const m=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return Lt(m,n,"missing-multi-factor-info"),(yield function cee(n,e){return go(n,"POST","/v2/accounts/mfaSignIn:start",eo(n,e))}(n,{mfaPendingCredential:u.credential,mfaEnrollmentId:m,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:u}=yield function mJ(n,e){return ck.apply(this,arguments)}(n,{phoneNumber:s.phoneNumber,recaptchaToken:r});return u}}finally{t._reset()}}),lR.apply(this,arguments)}function Sm(n,e){return e?Sh(e):(Lt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class uR extends Z1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ah(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ah(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ah(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Iee(n){return qV(n.auth,new uR(n),n.bypassAuthState)}function Dee(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),WV(t,new uR(n),n.bypassAuthState)}function See(n){return dR.apply(this,arguments)}function dR(){return(dR=Ie(function*(n){const{auth:e,user:t}=n;return Lt(t,e,"internal-error"),_k(t,new uR(n),n.bypassAuthState)})).apply(this,arguments)}class n3{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise(function(){var t=Ie(function*(i,r){e.pendingPromise={resolve:i,reject:r};try{e.eventManager=yield e.resolver._initialize(e.auth),yield e.onExecution(),e.eventManager.registerConsumer(e)}catch(s){e.reject(s)}});return function(i,r){return t.apply(this,arguments)}}())}onAuthEvent(e){var t=this;return Ie(function*(){const{urlResponse:i,sessionId:r,postBody:s,tenantId:u,error:m,type:v}=e;if(m)return void t.reject(m);const C={auth:t.auth,requestUri:i,sessionId:r,tenantId:u||void 0,postBody:s||void 0,user:t.user,bypassAuthState:t.bypassAuthState};try{t.resolve(yield t.getIdpTask(v)(C))}catch(S){t.reject(S)}})()}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Iee;case"linkViaPopup":case"linkViaRedirect":return See;case"reauthViaPopup":case"reauthViaRedirect":return Dee;default:Tl(this.auth,"internal-error")}}resolve(e){Th(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Th(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Aee=new Pb(2e3,1e4);function Mee(n,e,t){return hR.apply(this,arguments)}function hR(){return(hR=Ie(function*(n,e,t){const i=Rs(n);!function k_(n,e,t){if(!(e instanceof t))throw t.name!==e.constructor.name&&Tl(n,"argument-error"),fV(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(n,e,Uf);const r=Sm(i,t);return new mR(i,"signInViaPopup",e,r).executeNotNull()})).apply(this,arguments)}let mR=(()=>{class n extends n3{constructor(t,i,r,s,u){super(t,i,s,u),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){var t=this;return Ie(function*(){const i=yield t.execute();return Lt(i,t.auth,"internal-error"),i})()}onExecution(){var t=this;return Ie(function*(){Th(1===t.filter.length,"Popup operations only handle one event");const i=tE();t.authWindow=yield t.resolver._openPopup(t.auth,t.provider,t.filter[0],i),t.authWindow.associatedEvent=i,t.resolver._originValidation(t.auth).catch(r=>{t.reject(r)}),t.resolver._isIframeWebStorageSupported(t.auth,r=>{r||t.reject(Yl(t.auth,"web-storage-unsupported"))}),t.pollUserCancellation()})()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Yl(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){const t=()=>{var i,r;this.pollId=null!==(r=null===(i=this.authWindow)||void 0===i?void 0:i.window)&&void 0!==r&&r.closed?window.setTimeout(()=>{this.pollId=null,this.reject(Yl(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(t,Aee.get())};t()}}return n.currentPopupAction=null,n})();const kee="pendingRedirect",$b=new Map;class Ree extends n3{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}execute(){var e=()=>super.execute,t=this;return Ie(function*(){let i=$b.get(t.auth._key());if(!i){try{const s=(yield function Pee(n,e){return gR.apply(this,arguments)}(t.resolver,t.auth))?yield e().call(t):null;i=()=>Promise.resolve(s)}catch(r){i=()=>Promise.reject(r)}$b.set(t.auth._key(),i)}return t.bypassAuthState||$b.set(t.auth._key(),()=>Promise.resolve(null)),i()})()}onAuthEvent(e){var t=()=>super.onAuthEvent,i=this;return Ie(function*(){if("signInViaRedirect"===e.type)return t().call(i,e);if("unknown"!==e.type){if(e.eventId){const r=yield i.auth._redirectUserForId(e.eventId);if(r)return i.user=r,t().call(i,e);i.resolve(null)}}else i.resolve(null)})()}onExecution(){return Ie(function*(){})()}cleanUp(){}}function gR(){return(gR=Ie(function*(n,e){const t=function o3(n){return W1(kee,n.config.apiKey,n.name)}(e),i=function r3(n){return Sh(n._redirectPersistence)}(n);if(!(yield i._isAvailable()))return!1;const r="true"===(yield i._get(t));return yield i._remove(t),r})).apply(this,arguments)}function Oee(n,e){$b.set(n._key(),e)}function s3(n,e){return ER.apply(this,arguments)}function ER(){return(ER=Ie(function*(n,e,t=!1){const i=Rs(n),r=Sm(i,e),u=yield new Ree(i,r,t).execute();return u&&!t&&(delete u.user._redirectEventId,yield i._persistUserIfCurrent(u.user),yield i._setRedirectUser(null,e)),u})).apply(this,arguments)}class zee{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function Vee(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c3(n);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!c3(e)){const r=(null===(i=e.error.code)||void 0===i?void 0:i.split("auth/")[1])||"internal-error";t.onError(Yl(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(l3(e))}saveEventToCache(e){this.cachedEventUids.add(l3(e)),this.lastProcessedEventTime=Date.now()}}function l3(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function c3({type:n,error:e}){return"unknown"===n&&"auth/no-auth-event"===e?.code}function TR(){return(TR=Ie(function*(n,e={}){return go(n,"GET","/v1/projects",e)})).apply(this,arguments)}const jee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,$ee=/^https?/;function IR(){return IR=Ie(function*(n){if(n.config.emulator)return;const{authorizedDomains:e}=yield function Uee(n){return TR.apply(this,arguments)}(n);for(const t of e)try{if(Gee(t))return}catch{}Tl(n,"unauthorized-domain")}),IR.apply(this,arguments)}function Gee(n){const e=Rb(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return""===u.hostname&&""===i?"chrome-extension:"===t&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===t&&u.hostname===i}if(!$ee.test(t))return!1;if(jee.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const Wee=new Pb(3e4,6e4);function u3(){const n=Go().___jsl;if(n?.H)for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}let oE=null;const Yee=new Pb(5e3,15e3),Kee="__/auth/iframe",Xee="emulator/auth/iframe",Qee={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Jee=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ete(n){const e=n.config;Lt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?MM(e,Xee):`https://${n.config.authDomain}/${Kee}`,i={apiKey:e.apiKey,appName:n.name,v:vm},r=Jee.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${pm(i).slice(1)}`}function DR(){return DR=Ie(function*(n){const e=yield function Zee(n){return oE=oE||function qee(n){return new Promise((e,t)=>{var i,r,s;function u(){u3(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{u3(),t(Yl(n,"network-request-failed"))},timeout:Wee.get()})}if(null!==(r=null===(i=Go().gapi)||void 0===i?void 0:i.iframes)&&void 0!==r&&r.Iframe)e(gapi.iframes.getContext());else{if(null===(s=Go().gapi)||void 0===s||!s.load){const m=OV("iframefcb");return Go()[m]=()=>{gapi.load?u():t(Yl(n,"network-request-failed"))},WM(`https://apis.google.com/js/api.js?onload=${m}`).catch(v=>t(v))}u()}}).catch(e=>{throw oE=null,e})}(n),oE}(n),t=Go().gapi;return Lt(t,n,"internal-error"),e.open({where:document.body,url:ete(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Qee,dontclear:!0},i=>new Promise(function(){var r=Ie(function*(s,u){yield i.restyle({setHideOnLeave:!1});const m=Yl(n,"network-request-failed"),v=Go().setTimeout(()=>{u(m)},Yee.get());function C(){Go().clearTimeout(v),s(i)}i.ping(C).then(C,()=>{u(m)})});return function(s,u){return r.apply(this,arguments)}}()))}),DR.apply(this,arguments)}const nte={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ite=500,rte=600,ote="_blank",ste="http://localhost";class d3{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const cte="__/auth/handler",ute="emulator/auth/handler",dte=encodeURIComponent("fac");function h3(n,e,t,i,r,s){return SR.apply(this,arguments)}function SR(){return(SR=Ie(function*(n,e,t,i,r,s){Lt(n.config.authDomain,n,"auth-domain-config-required"),Lt(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:vm,eventId:r};if(e instanceof Uf){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",$D(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[S,R]of Object.entries(s||{}))u[S]=R}if(e instanceof jV){const S=e.getScopes().filter(R=>""!==R);S.length>0&&(u.scopes=S.join(","))}n.tenantId&&(u.tid=n.tenantId);const m=u;for(const S of Object.keys(m))void 0===m[S]&&delete m[S];const v=yield n._getAppCheckToken(),C=v?`#${dte}=${encodeURIComponent(v)}`:"";return`${function hte({config:n}){return n.emulator?MM(n,ute):`https://${n.authDomain}/${cte}`}(n)}?${pm(m).slice(1)}${C}`})).apply(this,arguments)}const AR="webStorageSupport",pte=class fte{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=KV,this._completeRedirectFn=s3,this._overrideRedirectResult=Oee}_openPopup(e,t,i,r){var s=this;return Ie(function*(){var u;Th(null===(u=s.eventManagers[e._key()])||void 0===u?void 0:u.manager,"_initialize() not called before _openPopup()");const m=yield h3(e,t,i,Rb(),r);return function ate(n,e,t,i=ite,r=rte){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let m="";const v=Object.assign(Object.assign({},nte),{width:i.toString(),height:r.toString(),top:s,left:u}),C=Ms().toLowerCase();t&&(m=EV(C)?ote:t),wV(C)&&(e=e||ste,v.scrollbars="yes");const S=Object.entries(v).reduce((j,[K,ie])=>`${j}${K}=${ie},`,"");if(function ZQ(n=Ms()){var e;return q1(n)&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(C)&&"_self"!==m)return function lte(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}(e||"",m),new d3(null);const R=window.open(e||"",m,S);Lt(R,n,"popup-blocked");try{R.focus()}catch{}return new d3(R)}(e,m,tE())})()}_openRedirect(e,t,i,r){var s=this;return Ie(function*(){return yield s._originValidation(e),function JJ(n){Go().location.href=n}(yield h3(e,t,i,Rb(),r)),new Promise(()=>{})})()}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Th(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}initAndGetManager(e){var t=this;return Ie(function*(){const i=yield function tte(n){return DR.apply(this,arguments)}(e),r=new zee(e);return i.register("authEvent",s=>(Lt(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),t.eventManagers[e._key()]={manager:r},t.iframes[e._key()]=i,r})()}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(AR,{type:AR},r=>{var s;const u=null===(s=r?.[0])||void 0===s?void 0:s[AR];void 0!==u&&t(!!u),Tl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function Hee(n){return IR.apply(this,arguments)}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return SV()||$M()||q1()}};var m3="@firebase/auth";class mte{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}getToken(e){var t=this;return Ie(function*(){return t.assertAuthConfigured(),yield t.auth._initializationPromise,t.auth.currentUser?{accessToken:yield t.auth.currentUser.getIdToken(e)}:null})()}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Lt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const vte=xB("authIdTokenMaxAge")||300;let _3=null;const bte=n=>function(){var e=Ie(function*(t){const i=t&&(yield t.getIdTokenResult()),r=i&&((new Date).getTime()-Date.parse(i.issuedAtTime))/1e3;if(r&&r>vte)return;const s=i?.token;_3!==s&&(_3=s,yield fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))});return function(t){return e.apply(this,arguments)}}();function xte(n=eS()){const e=C_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=function rJ(n,e){const t=C_(n,"auth");if(t.isInitialized()){const r=t.getImmediate();if(E1(t.getOptions(),e??{}))return r;Tl(r,"already-initialized")}return t.initialize({options:e})}(n,{popupRedirectResolver:pte,persistence:[lee,YJ,KV]}),i=xB("authTokenSyncURL");if(i){const s=bte(i);(function zJ(n,e,t){Ho(n).beforeAuthStateChanged(e,t)})(t,s,()=>s(t.currentUser)),function BJ(n,e,t,i){Ho(n).onIdTokenChanged(e,t,i)}(t,u=>s(u))}const r=vB("auth");return r&&function sJ(n,e,t){const i=Rs(n);Lt(i._canInitEmulator,i,"emulator-config-failed"),Lt(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!!t?.disableWarnings,s=NV(e),{host:u,port:m}=function aJ(n){const e=NV(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:BV(i.substr(s.length+1))}}{const[s,u]=i.split(":");return{host:s,port:BV(u)}}}(e);i.config.emulator={url:`${s}//${u}${null===m?"":`:${m}`}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:u,port:m,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function lJ(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",n):n())}()}(t,`http://${r}`),t}!function _te(n){Oa(new ma("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:u,authDomain:m}=i.options;Lt(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const v={apiKey:u,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:AV(n)},C=new iJ(i,r,s,v);return function oJ(n,e){const t=e?.persistence||[],i=(Array.isArray(t)?t:[t]).map(Sh);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e?.popupRedirectResolver)}(C,t),C},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Oa(new ma("auth-internal",e=>{const t=Rs(e.getProvider("auth").getImmediate());return new mte(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),po(m3,"0.23.2",function gte(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(n)),po(m3,"0.23.2","esm2017")}("Browser");class aE{constructor(e){return e}}class v3{constructor(){return nM("auth")}}const kR=new Ct("angularfire2.auth-instances");function Ete(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new aE(i)}}const Cte={provide:v3,deps:[[new or,kR]]},Tte={provide:aE,useFactory:function wte(n,e){const t=tM("auth",n,e);return t&&new aE(t)},deps:[[new or,kR],A_]};let Ite=(()=>{class n{constructor(){po("angularfire",F1.full,"auth")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[Tte,Cte]}),n})();function Dte(n,...e){return{ngModule:Ite,providers:[{provide:kR,useFactory:Ete(n),multi:!0,deps:[Ti,Uo,iM,rM,[new or,IM],...e]}]}}const Ste=Ch(AJ,!0),lE=Ch(xte,!0),Ate=Ch(VJ,!0),Mte=Ch(MJ,!0),kte=Ch(Tee,!0),Rte=Ch(Mee,!0),Pte=Ch(UJ,!0),b3="@firebase/database";let RR="";class Fte{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),as(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Eb(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Lte{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return Cd(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const w3=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Fte(e)}}catch{}return new Lte},Am=w3("localStorage"),PR=w3("sessionStorage"),F_=new E_("@firebase/database"),E3=function(){let n=1;return function(){return n++}}(),C3=function(n){const e=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,Rt(i<n.length,"Surrogate pair missing trail surrogate."),r=65536+(s<<10)+(n.charCodeAt(i)-56320)}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=63&r|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=63&r|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=63&r|128)}return e}(n),t=new c9;t.update(e);const i=t.digest();return _1.encodeByteArray(i)},Hb=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=Hb.apply(null,i):e+="object"==typeof i?as(i):i,e+=" "}return e};let Mm=null,T3=!0;const Ps=function(...n){if(!0===T3&&(T3=!1,null===Mm&&!0===PR.get("logging_enabled")&&function(n,e){Rt(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(F_.logLevel=nr.VERBOSE,Mm=F_.log.bind(F_),e&&PR.set("logging_enabled",!0)):"function"==typeof n?Mm=n:(Mm=null,PR.remove("logging_enabled"))}(!0)),Mm){const e=Hb.apply(null,n);Mm(e)}},Gb=function(n){return function(...e){Ps(n,...e)}},OR=function(...n){const e="FIREBASE INTERNAL ERROR: "+Hb(...n);F_.error(e)},Sd=function(...n){const e=`FIREBASE FATAL ERROR: ${Hb(...n)}`;throw F_.error(e),new Error(e)},ga=function(...n){const e="FIREBASE WARNING: "+Hb(...n);F_.warn(e)},cE=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},jf="[MIN_NAME]",Mh="[MAX_NAME]",km=function(n,e){if(n===e)return 0;if(n===jf||e===Mh)return-1;if(e===jf||n===Mh)return 1;{const t=A3(n),i=A3(e);return null!==t?null!==i?t-i==0?n.length-e.length:t-i:-1:null!==i?1:n<e?-1:1}},zte=function(n,e){return n===e?0:n<e?-1:1},Wb=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+as(e))},FR=function(n){if("object"!=typeof n||null===n)return as(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)0!==i&&(t+=","),t+=as(e[i]),t+=":",t+=FR(n[e[i]]);return t+="}",t},D3=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)i.push(n.substring(r,r+e>t?t:r+e));return i};function Os(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const S3=function(n){Rt(!cE(n),"Invalid JSON number");const i=1023;let r,s,u,m,v;0===n?(s=0,u=0,r=1/n==-1/0?1:0):(r=n<0,(n=Math.abs(n))>=Math.pow(2,1-i)?(m=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=m+i,u=Math.round(n*Math.pow(2,52-m)-Math.pow(2,52))):(s=0,u=Math.round(n/Math.pow(2,-1074))));const C=[];for(v=52;v;v-=1)C.push(u%2?1:0),u=Math.floor(u/2);for(v=11;v;v-=1)C.push(s%2?1:0),s=Math.floor(s/2);C.push(r?1:0),C.reverse();const S=C.join("");let R="";for(v=0;v<64;v+=8){let j=parseInt(S.substr(v,8),2).toString(16);1===j.length&&(j="0"+j),R+=j}return R.toLowerCase()},$te=new RegExp("^-?(0*)\\d{1,10}$"),A3=function(n){if($te.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},L_=function(n){try{n()}catch(e){setTimeout(()=>{throw ga("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},Wte=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},qb=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class qte{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){ga(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Zte{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ps("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ga(e)}}let Zb=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const O3=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,N3="websocket",B3="long_polling";class NR{constructor(e,t,i,r,s=!1,u="",m=!1,v=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=u,this.includeNamespaceInQueryParams=m,this.isUsingEmulator=v,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Am.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Am.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function z3(n,e,t){let i;if(Rt("string"==typeof e,"typeof type must == string"),Rt("object"==typeof t,"typeof params must == object"),e===N3)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==B3)throw new Error("Unknown connection type: "+e);i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Yte(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const r=[];return Os(t,(s,u)=>{r.push(s+"="+u)}),i+r.join("&")}class Kte{constructor(){this.counters_={}}incrementCounter(e,t=1){Cd(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return q7(this.counters_)}}const BR={},zR={};function VR(n){const e=n.toString();return BR[e]||(BR[e]=new Kte),BR[e]}class Qte{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&L_(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class $f{constructor(e,t,i,r,s,u,m){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=u,this.lastSessionId=m,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Gb(e),this.stats_=VR(t),this.urlFn=v=>(this.appCheckToken&&(v.ac=this.appCheckToken),z3(t,B3,v))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Qte(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if(vh()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new UR((...s)=>{const[u,m,v,C,S]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===u)this.id=m,this.password=v;else{if("close"!==u)throw new Error("Unrecognized command received: "+u);m?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(m,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[u,m]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(u,m)},()=>{this.onClosed_()},this.urlFn);const i={start:"t"};i.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(i.cb=this.scriptTagHolder.uniqueCallbackIdentifier),i.v="5",this.transportSessionId&&(i.s=this.transportSessionId),this.lastSessionId&&(i.ls=this.lastSessionId),this.applicationId&&(i.p=this.applicationId),this.appCheckToken&&(i.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&O3.test(location.hostname)&&(i.r="f");const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){$f.forceAllow_=!0}static forceDisallow(){$f.forceDisallow_=!0}static isAvailable(){return!(vh()||!$f.forceAllow_&&($f.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=as(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=_B(t),r=D3(i,1840);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(vh())return;this.myDisconnFrame=document.createElement("iframe");const i={dframe:"t"};i.id=e,i.pw=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=as(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class UR{constructor(e,t,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,vh())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=E3(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=UR.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const u="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(u),this.myIFrame.doc.close()}catch(m){Ps("frame writing exception"),m.stack&&Ps(m.stack),Ps(m)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ps("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+i.length<=1870;){const u=this.pendingSegs.shift();i=i+"&seg"+r+"="+u.seg+"&ts"+r+"="+u.ts+"&d"+r+"="+u.d,r++}return t+=i,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),i()})}addTag(e,t){vh()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||"loaded"===r||"complete"===r)&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Ps("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}let dE=null;typeof MozWebSocket<"u"?dE=MozWebSocket:typeof WebSocket<"u"&&(dE=WebSocket);let N_=(()=>{class n{constructor(t,i,r,s,u,m,v){this.connId=t,this.applicationId=r,this.appCheckToken=s,this.authToken=u,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Gb(this.connId),this.stats_=VR(i),this.connURL=n.connectionURL_(i,m,v,s,r),this.nodeAdmin=i.nodeAdmin}static connectionURL_(t,i,r,s,u){const m={v:"5"};return!vh()&&typeof location<"u"&&location.hostname&&O3.test(location.hostname)&&(m.r="f"),i&&(m.s=i),r&&(m.ls=r),s&&(m.ac=s),u&&(m.p=u),z3(t,N3,m)}open(t,i){this.onDisconnect=i,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Am.set("previous_websocket_failure",!0);try{let r;if(vh()){r={headers:{"User-Agent":`Firebase/5/${RR}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(r.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(r.headers["X-Firebase-AppCheck"]=this.appCheckToken);const u=process.env,m=0===this.connURL.indexOf("wss://")?u.HTTPS_PROXY||u.https_proxy:u.HTTP_PROXY||u.http_proxy;m&&(r.proxy={origin:m})}this.mySock=new dE(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const s=r.message||r.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const s=r.message||r.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==dE&&!n.forceDisallow_}static previouslyFailed(){return Am.isInMemoryStorage||!0===Am.get("previous_websocket_failure")}markConnectionHealthy(){Am.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const i=this.frames.join("");this.frames=null;const r=Eb(i);this.onMessage(r)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(Rt(null===this.frames,"We already have a frame buffer"),t.length<=6){const i=Number(t);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const i=t.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(i);else{const r=this.extractFrameCount_(i);null!==r&&this.appendFrame_(r)}}send(t){this.resetKeepAlive();const i=as(t);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);const r=D3(i,16384);r.length>1&&this.sendString_(String(r.length));for(let s=0;s<r.length;s++)this.sendString_(r[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),W3=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[$f,N_]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const i=N_&&N_.isAvailable();let r=i&&!N_.previouslyFailed();if(t.webSocketOnly&&(i||ga("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[N_];else{const s=this.transports_=[];for(const u of n.ALL_TRANSPORTS)u&&u.isAvailable()&&s.push(u);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class J3{constructor(e,t,i,r,s,u,m,v,C,S){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=u,this.onReady_=m,this.onDisconnect_=v,this.onKill_=C,this.lastSessionId=S,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Gb("c:"+this.id+":"),this.transportManager_=new W3(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=qb(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Wb("t",e),i=Wb("d",e);if("c"===t)this.onSecondaryControl_(i);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(i)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Wb("t",e),i=Wb("d",e);"c"===t?this.onControl_(i):"d"===t&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Wb("t",e);if("d"in e){const i=e.d;if("h"===t){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(i):"r"===t?this.onReset_(i):"e"===t?OR("Server Error: "+i):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):OR("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==i&&ga("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),qb(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):qb(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Am.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class eU{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}class tU{constructor(e){this.allowedEvents_=e,this.listeners_={},Rt(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context))return void r.splice(s,1)}validateEventType_(e){Rt(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class hE extends tU{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!VD()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new hE}getInitialEvent(e){return Rt("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const nU=32,iU=768;class rr{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function er(){return new rr("")}function yi(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Hf(n){return n.pieces_.length-n.pieceNum_}function br(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new rr(n.pieces_,e)}function $R(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Yb(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function rU(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new rr(e,0)}function jr(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof rr)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new rr(t,0)}function vi(n){return n.pieceNum_>=n.pieces_.length}function La(n,e){const t=yi(n),i=yi(e);if(null===t)return e;if(t===i)return La(br(n),br(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function HR(n,e){if(Hf(n)!==Hf(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function zc(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Hf(n)>Hf(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class xne{constructor(e,t){this.errorPrefix_=t,this.parts_=Yb(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=C1(this.parts_[i]);oU(this)}}function oU(n){if(n.byteLength_>iU)throw new Error(n.errorPrefix_+"has a key path longer than "+iU+" bytes ("+n.byteLength_+").");if(n.parts_.length>nU)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+nU+") or object contains a cycle "+Rm(n))}function Rm(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class GR extends tU{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new GR}getInitialEvent(e){return Rt("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Kb=1e3;let pE,Pm=(()=>{class n extends eU{constructor(t,i,r,s,u,m,v,C){if(super(),this.repoInfo_=t,this.applicationId_=i,this.onDataUpdate_=r,this.onConnectStatus_=s,this.onServerInfoUpdate_=u,this.authTokenProvider_=m,this.appCheckTokenProvider_=v,this.authOverride_=C,this.id=n.nextPersistentConnectionId_++,this.log_=Gb("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Kb,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,C&&!vh())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");GR.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&hE.getInstance().on("online",this.onOnline_,this)}sendRequest(t,i,r){const s=++this.requestNumber_,u={r:s,a:t,b:i};this.log_(as(u)),Rt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),r&&(this.requestCBHash_[s]=r)}get(t){this.initConnection_();const i=new hm,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:m=>{const v=m.d;"ok"===m.s?i.resolve(v):i.reject(v)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),i.promise}listen(t,i,r,s){this.initConnection_();const u=t._queryIdentifier,m=t._path.toString();this.log_("Listen called for "+m+" "+u),this.listens.has(m)||this.listens.set(m,new Map),Rt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Rt(!this.listens.get(m).has(u),"listen() called twice for same path/queryId.");const v={onComplete:s,hashFn:i,query:t,tag:r};this.listens.get(m).set(u,v),this.connected_&&this.sendListen_(v)}sendGet_(t){const i=this.outstandingGets_[t];this.sendRequest("g",i.request,r=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(r)})}sendListen_(t){const i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);const u={p:r};t.tag&&(u.q=i._queryObject,u.t=t.tag),u.h=t.hashFn(),this.sendRequest("q",u,v=>{const C=v.d,S=v.s;n.warnOnListenWarnings_(C,i),(this.listens.get(r)&&this.listens.get(r).get(s))===t&&(this.log_("listen response",v),"ok"!==S&&this.removeListen_(r,s),t.onComplete&&t.onComplete(S,C))})}static warnOnListenWarnings_(t,i){if(t&&"object"==typeof t&&Cd(t,"w")){const r=w_(t,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const s='".indexOn": "'+i._queryParams.getIndex().toString()+'"',u=i._path.toString();ga(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${u} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(n){const e=x1(n).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,i=function(n){const t=x1(n).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(i,r,s=>{const u=s.s,m=s.d||"error";this.authToken_===t&&("ok"===u?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(u,m))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const i=t.s,r=t.d||"error";"ok"===i?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,r)})}unlisten(t,i){const r=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+r+" "+s),Rt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,s)&&this.connected_&&this.sendUnlisten_(r,s,t._queryObject,i)}sendUnlisten_(t,i,r,s){this.log_("Unlisten on "+t+" for "+i);const u={p:t};s&&(u.q=r,u.t=s),this.sendRequest("n",u)}onDisconnectPut(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:i,onComplete:r})}onDisconnectMerge(t,i,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,i,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:i,onComplete:r})}onDisconnectCancel(t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(t,i,r,s){const u={p:i,d:r};this.log_("onDisconnect "+t,u),this.sendRequest(t,u,m=>{s&&setTimeout(()=>{s(m.s,m.d)},Math.floor(0))})}put(t,i,r,s){this.putInternal("p",t,i,r,s)}merge(t,i,r,s){this.putInternal("m",t,i,r,s)}putInternal(t,i,r,s,u){this.initConnection_();const m={p:i,d:r};void 0!==u&&(m.h=u),this.outstandingPuts_.push({action:t,request:m,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+i)}sendPut_(t){const i=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(i,r,u=>{this.log_(i+" response",u),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(u.s,u.d)})}reportStats(t){if(this.connected_){const i={c:t};this.log_("reportStats",i),this.sendRequest("s",i,r=>{"ok"!==r.s&&this.log_("reportStats","Error sending stats: "+r.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+as(t));const i=t.r,r=this.requestCBHash_[i];r&&(delete this.requestCBHash_[i],r(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,i){this.log_("handleServerMessage",t,i),"d"===t?this.onDataUpdate_(i.p,i.d,!1,i.t):"m"===t?this.onDataUpdate_(i.p,i.d,!0,i.t):"c"===t?this.onListenRevoked_(i.p,i.q):"ac"===t?this.onAuthRevoked_(i.s,i.d):"apc"===t?this.onAppCheckRevoked_(i.s,i.d):"sd"===t?this.onSecurityDebugPacket_(i):OR("Unrecognized action received from server: "+as(t)+"\nAre you using the latest client?")}onReady_(t,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){Rt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Kb),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let i=Math.max(0,this.reconnectDelay_-t);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return Ie(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const i=t.onDataMessage_.bind(t),r=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),u=t.id+":"+n.nextConnectionId_++,m=t.lastSessionId;let v=!1,C=null;const S=function(){C?C.close():(v=!0,s())};t.realtime_={close:S,sendRequest:function(K){Rt(C,"sendRequest call when we're not connected not allowed."),C.sendRequest(K)}};const j=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[K,ie]=yield Promise.all([t.authTokenProvider_.getToken(j),t.appCheckTokenProvider_.getToken(j)]);v?Ps("getToken() completed but was canceled"):(Ps("getToken() completed. Creating connection."),t.authToken_=K&&K.accessToken,t.appCheckToken_=ie&&ie.token,C=new J3(u,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,i,r,s,we=>{ga(we+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},m))}catch(K){t.log_("Failed to get token: "+K),v||(t.repoInfo_.nodeAdmin&&ga(K),S())}}})()}interrupt(t){Ps("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ps("Resuming connection for reason: "+t),delete this.interruptReasons_[t],$D(this.interruptReasons_)&&(this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const i=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const i=this.outstandingPuts_[t];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,i){let r;r=i?i.map(u=>FR(u)).join("$"):"default";const s=this.removeListen_(t,r);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,i){const r=new rr(t).toString();let s;if(this.listens.has(r)){const u=this.listens.get(r);s=u.get(i),u.delete(i),0===u.size&&this.listens.delete(r)}else s=void 0;return s}onAuthRevoked_(t,i){Ps("Auth token revoked: "+t+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,i){Ps("App check token revoked: "+t+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const i of t.values())this.sendListen_(i);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let i="js";vh()&&(i=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+i+"."+RR.replace(/\./g,"-")]=1,VD()?t["framework.cordova"]=1:wB()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=hE.getInstance().currentlyOnline();return $D(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Ii{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ii(e,t)}}class fE{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Ii(jf,e),r=new Ii(jf,t);return 0!==this.compare(i,r)}minPost(){return Ii.MIN}}class lU extends fE{static get __EMPTY_NODE(){return pE}static set __EMPTY_NODE(e){pE=e}compare(e,t){return km(e.name,t.name)}isDefinedOn(e){throw x_("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ii.MIN}maxPost(){return new Ii(Mh,pE)}makePost(e,t){return Rt("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ii(e,pE)}toString(){return".key"}}const Ad=new lU;class mE{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let u=1;for(;!e.isEmpty();)if(u=t?i(e.key,t):1,r&&(u*=-1),u<0)e=this.isReverse_?e.left:e.right;else{if(0===u){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let qR,Vu=(()=>{class n{constructor(t,i,r,s,u){this.key=t,this.value=i,this.color=r??n.RED,this.left=s??Il.EMPTY_NODE,this.right=u??Il.EMPTY_NODE}copy(t,i,r,s,u){return new n(t??this.key,i??this.value,r??this.color,s??this.left,u??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,i,r){let s=this;const u=r(t,s.key);return s=u<0?s.copy(null,null,null,s.left.insert(t,i,r),null):0===u?s.copy(null,i,null,null,null):s.copy(null,null,null,null,s.right.insert(t,i,r)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Il.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,i){let r,s;if(r=this,i(t,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(t,i),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),0===i(t,r.key)){if(r.right.isEmpty())return Il.EMPTY_NODE;s=r.right.min_(),r=r.copy(s.key,s.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(t,i))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,i)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class Il{constructor(e,t=Il.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Il(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Vu.BLACK,null,null))}remove(e){return new Il(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Vu.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),0===t){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}t<0?i=i.left:t>0&&(r=i,i=i.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new mE(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new mE(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new mE(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new mE(this.root_,null,this.comparator_,!0,e)}}function Ane(n,e){return km(n.name,e.name)}function WR(n,e){return km(n,e)}Il.EMPTY_NODE=new class Sne{copy(e,t,i,r,s){return this}insert(e,t,i){return new Vu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const cU=function(n){return"number"==typeof n?"number:"+S3(n):"string:"+n},uU=function(n){if(n.isLeafNode()){const e=n.val();Rt("string"==typeof e||"number"==typeof e||"object"==typeof e&&Cd(e,".sv"),"Priority must be a string or number.")}else Rt(n===qR||n.isEmpty(),"priority of unexpected type.");Rt(n===qR||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let dU,hU,fU,B_=(()=>{class n{constructor(t,i=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=i,this.lazyHash_=null,Rt(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),uU(this.priorityNode_)}static set __childrenNodeConstructor(t){dU=t}static get __childrenNodeConstructor(){return dU}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return vi(t)?this:".priority"===yi(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,i){return null}updateImmediateChild(t,i){return".priority"===t?this.updatePriority(i):i.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,i).updatePriority(this.priorityNode_)}updateChild(t,i){const r=yi(t);return null===r?i:i.isEmpty()&&".priority"!==r?this:(Rt(".priority"!==r||1===Hf(t),".priority must be the last token in a path"),this.updateImmediateChild(r,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(br(t),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,i){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+cU(this.priorityNode_.val())+":");const i=typeof this.value_;t+=i+":",t+="number"===i?S3(this.value_):this.value_,this.lazyHash_=C3(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(Rt(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const i=typeof t.value_,r=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(i),u=n.VALUE_TYPE_ORDER.indexOf(r);return Rt(s>=0,"Unknown leaf type: "+i),Rt(u>=0,"Unknown leaf type: "+r),s===u?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:u-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Sr=new class Pne extends fE{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return 0===s?km(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ii.MIN}maxPost(){return new Ii(Mh,new B_("[PRIORITY-POST]",fU))}makePost(e,t){const i=hU(e);return new Ii(t,new B_("[PRIORITY-POST]",i))}toString(){return".priority"}},One=Math.log(2);class Fne{constructor(e){this.count=parseInt(Math.log(e+1)/One,10),this.current_=this.count-1;const r=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const gE=function(n,e,t,i){n.sort(e);const r=function(v,C){const S=C-v;let R,j;if(0===S)return null;if(1===S)return R=n[v],j=t?t(R):R,new Vu(j,R.node,Vu.BLACK,null,null);{const K=parseInt(S/2,10)+v,ie=r(v,K),we=r(K+1,C);return R=n[K],j=t?t(R):R,new Vu(j,R.node,Vu.BLACK,ie,we)}},m=function(v){let C=null,S=null,R=n.length;const j=function(ie,we){const Oe=R-ie,Ke=R;R-=ie;const _t=r(Oe+1,Ke),Qe=n[Oe],Ht=t?t(Qe):Qe;K(new Vu(Ht,Qe.node,we,null,_t))},K=function(ie){C?(C.left=ie,C=ie):(S=ie,C=ie)};for(let ie=0;ie<v.count;++ie){const we=v.nextBitIsOne(),Oe=Math.pow(2,v.count-(ie+1));we?j(Oe,Vu.BLACK):(j(Oe,Vu.BLACK),j(Oe,Vu.RED))}return S}(new Fne(n.length));return new Il(i||e,m)};let ZR;const z_={};class kh{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Rt(z_&&Sr,"ChildrenNode.ts has not been loaded"),ZR=ZR||new kh({".priority":z_},{".priority":Sr}),ZR}get(e){const t=w_(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Il?t:null}hasIndex(e){return Cd(this.indexSet_,e.toString())}addIndex(e,t){Rt(e!==Ad,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(Ii.Wrap);let m,u=s.getNext();for(;u;)r=r||e.isDefinedOn(u.node),i.push(u),u=s.getNext();m=r?gE(i,e.getCompare()):z_;const v=e.toString(),C=Object.assign({},this.indexSet_);C[v]=e;const S=Object.assign({},this.indexes_);return S[v]=m,new kh(S,C)}addToIndexes(e,t){const i=w1(this.indexes_,(r,s)=>{const u=w_(this.indexSet_,s);if(Rt(u,"Missing index implementation for "+s),r===z_){if(u.isDefinedOn(e.node)){const m=[],v=t.getIterator(Ii.Wrap);let C=v.getNext();for(;C;)C.name!==e.name&&m.push(C),C=v.getNext();return m.push(e),gE(m,u.getCompare())}return z_}{const m=t.get(e.name);let v=r;return m&&(v=v.remove(new Ii(e.name,m))),v.insert(e,e.node)}});return new kh(i,this.indexSet_)}removeFromIndexes(e,t){const i=w1(this.indexes_,r=>{if(r===z_)return r;{const s=t.get(e.name);return s?r.remove(new Ii(e.name,s)):r}});return new kh(i,this.indexSet_)}}let Xb,Jn=(()=>{class n{constructor(t,i,r){this.children_=t,this.priorityNode_=i,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&uU(this.priorityNode_),this.children_.isEmpty()&&Rt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Xb||(Xb=new n(new Il(WR),null,kh.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Xb}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const i=this.children_.get(t);return null===i?Xb:i}}getChild(t){const i=yi(t);return null===i?this:this.getImmediateChild(i).getChild(br(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,i){if(Rt(i,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(i);{const r=new Ii(t,i);let s,u;i.isEmpty()?(s=this.children_.remove(t),u=this.indexMap_.removeFromIndexes(r,this.children_)):(s=this.children_.insert(t,i),u=this.indexMap_.addToIndexes(r,this.children_));const m=s.isEmpty()?Xb:this.priorityNode_;return new n(s,m,u)}}updateChild(t,i){const r=yi(t);if(null===r)return i;{Rt(".priority"!==yi(t)||1===Hf(t),".priority must be the last token in a path");const s=this.getImmediateChild(r).updateChild(br(t),i);return this.updateImmediateChild(r,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const i={};let r=0,s=0,u=!0;if(this.forEachChild(Sr,(m,v)=>{i[m]=v.val(t),r++,u&&n.INTEGER_REGEXP_.test(m)?s=Math.max(s,Number(m)):u=!1}),!t&&u&&s<2*r){const m=[];for(const v in i)m[v]=i[v];return m}return t&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+cU(this.getPriority().val())+":"),this.forEachChild(Sr,(i,r)=>{const s=r.hash();""!==s&&(t+=":"+i+":"+s)}),this.lazyHash_=""===t?"":C3(t)}return this.lazyHash_}getPredecessorChildName(t,i,r){const s=this.resolveIndex_(r);if(s){const u=s.getPredecessorKey(new Ii(t,i));return u?u.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.minKey();return r&&r.name}return this.children_.minKey()}getFirstChild(t){const i=this.getFirstChildName(t);return i?new Ii(i,this.children_.get(i)):null}getLastChildName(t){const i=this.resolveIndex_(t);if(i){const r=i.maxKey();return r&&r.name}return this.children_.maxKey()}getLastChild(t){const i=this.getLastChildName(t);return i?new Ii(i,this.children_.get(i)):null}forEachChild(t,i){const r=this.resolveIndex_(t);return r?r.inorderTraversal(s=>i(s.name,s.node)):this.children_.inorderTraversal(i)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,Ii.Wrap);let u=s.peek();for(;null!=u&&i.compare(u,t)<0;)s.getNext(),u=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,i){const r=this.resolveIndex_(i);if(r)return r.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,Ii.Wrap);let u=s.peek();for(;null!=u&&i.compare(u,t)>0;)s.getNext(),u=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Qb?-1:0}withIndex(t){if(t===Ad||this.indexMap_.hasIndex(t))return this;{const i=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,i)}}isIndexed(t){return t===Ad||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const i=t;if(this.getPriority().equals(i.getPriority())){if(this.children_.count()===i.children_.count()){const r=this.getIterator(Sr),s=i.getIterator(Sr);let u=r.getNext(),m=s.getNext();for(;u&&m;){if(u.name!==m.name||!u.node.equals(m.node))return!1;u=r.getNext(),m=s.getNext()}return null===u&&null===m}return!1}return!1}}resolveIndex_(t){return t===Ad?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const Qb=new class Lne extends Jn{constructor(){super(new Il(WR),Jn.EMPTY_NODE,kh.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Jn.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ii,{MIN:{value:new Ii(jf,Jn.EMPTY_NODE)},MAX:{value:new Ii(Mh,Qb)}}),lU.__EMPTY_NODE=Jn.EMPTY_NODE,B_.__childrenNodeConstructor=Jn,function Mne(n){qR=n}(Qb),function Rne(n){fU=n}(Qb);const Nne=!0;function to(n,e=null){if(null===n)return Jn.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),Rt(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new B_(n,to(e));if(n instanceof Array||!Nne){let t=Jn.EMPTY_NODE;return Os(n,(i,r)=>{if(Cd(n,i)&&"."!==i.substring(0,1)){const s=to(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(to(e))}{const t=[];let i=!1;if(Os(n,(u,m)=>{if("."!==u.substring(0,1)){const v=to(m);v.isEmpty()||(i=i||!v.getPriority().isEmpty(),t.push(new Ii(u,v)))}}),0===t.length)return Jn.EMPTY_NODE;const s=gE(t,Ane,u=>u.name,WR);if(i){const u=gE(t,Sr.getCompare());return new Jn(s,to(e),new kh({".priority":u},{".priority":Sr}))}return new Jn(s,to(e),kh.Default)}}!function kne(n){hU=n}(to);class YR extends fE{constructor(e){super(),this.indexPath_=e,Rt(!vi(e)&&".priority"!==yi(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return 0===s?km(e.name,t.name):s}makePost(e,t){const i=to(e),r=Jn.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ii(t,r)}maxPost(){const e=Jn.EMPTY_NODE.updateChild(this.indexPath_,Qb);return new Ii(Mh,e)}toString(){return Yb(this.indexPath_,0).join("/")}}const KR=new class Bne extends fE{compare(e,t){const i=e.node.compareTo(t.node);return 0===i?km(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ii.MIN}maxPost(){return Ii.MAX}makePost(e,t){const i=to(e);return new Ii(t,i)}toString(){return".value"}};function pU(n){return{type:"value",snapshotNode:n}}function V_(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function Jb(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function e0(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class XR{constructor(e){this.index_=e}updateChild(e,t,i,r,s,u){Rt(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const m=e.getImmediateChild(t);return m.getChild(r).equals(i.getChild(r))&&m.isEmpty()===i.isEmpty()||(null!=u&&(i.isEmpty()?e.hasChild(t)?u.trackChildChange(Jb(t,m)):Rt(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):m.isEmpty()?u.trackChildChange(V_(t,i)):u.trackChildChange(e0(t,i,m))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return null!=i&&(e.isLeafNode()||e.forEachChild(Sr,(r,s)=>{t.hasChild(r)||i.trackChildChange(Jb(r,s))}),t.isLeafNode()||t.forEachChild(Sr,(r,s)=>{if(e.hasChild(r)){const u=e.getImmediateChild(r);u.equals(s)||i.trackChildChange(e0(r,s,u))}else i.trackChildChange(V_(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Jn.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class t0{constructor(e){this.indexedFilter_=new XR(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t0.getStartPost_(e),this.endPost_=t0.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,u){return this.matches(new Ii(t,i))||(i=Jn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,u)}updateFullNode(e,t,i){t.isLeafNode()&&(t=Jn.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(Jn.EMPTY_NODE);const s=this;return t.forEachChild(Sr,(u,m)=>{s.matches(new Ii(u,m))||(r=r.updateImmediateChild(u,Jn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Vne{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new t0(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,u){return this.rangedFilter_.matches(new Ii(t,i))||(i=Jn.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,u):this.fullLimitUpdateChild_(e,t,i,s,u)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=Jn.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;r=Jn.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let u=0;for(;s.hasNext()&&u<this.limit_;){const m=s.getNext();if(this.withinDirectionalStart(m)){if(!this.withinDirectionalEnd(m))break;r=r.updateImmediateChild(m.name,m.node),u++}}}else{let s;r=t.withIndex(this.index_),r=r.updatePriority(Jn.EMPTY_NODE),s=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let u=0;for(;s.hasNext();){const m=s.getNext();u<this.limit_&&this.withinDirectionalStart(m)&&this.withinDirectionalEnd(m)?u++:r=r.updateImmediateChild(m.name,Jn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let u;if(this.reverse_){const R=this.index_.getCompare();u=(j,K)=>R(K,j)}else u=this.index_.getCompare();const m=e;Rt(m.numChildren()===this.limit_,"");const v=new Ii(t,i),C=this.reverse_?m.getFirstChild(this.index_):m.getLastChild(this.index_),S=this.rangedFilter_.matches(v);if(m.hasChild(t)){const R=m.getImmediateChild(t);let j=r.getChildAfterChild(this.index_,C,this.reverse_);for(;null!=j&&(j.name===t||m.hasChild(j.name));)j=r.getChildAfterChild(this.index_,j,this.reverse_);const K=null==j?1:u(j,v);if(S&&!i.isEmpty()&&K>=0)return s?.trackChildChange(e0(t,i,R)),m.updateImmediateChild(t,i);{s?.trackChildChange(Jb(t,R));const we=m.updateImmediateChild(t,Jn.EMPTY_NODE);return null!=j&&this.rangedFilter_.matches(j)?(s?.trackChildChange(V_(j.name,j.node)),we.updateImmediateChild(j.name,j.node)):we}}return i.isEmpty()?e:S&&u(C,v)>=0?(null!=s&&(s.trackChildChange(Jb(C.name,C.node)),s.trackChildChange(V_(t,i))),m.updateImmediateChild(t,i).updateImmediateChild(C.name,Jn.EMPTY_NODE)):e}}class QR{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Sr}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Rt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Rt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jf}hasEnd(){return this.endSet_}getIndexEndValue(){return Rt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Rt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Mh}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Rt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Sr}copy(){const e=new QR;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function mU(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Sr?t="$priority":n.index_===KR?t="$value":n.index_===Ad?t="$key":(Rt(n.index_ instanceof YR,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=as(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=as(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+as(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=as(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+as(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function gU(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Sr&&(e.i=n.index_.toString()),e}class yE extends eU{constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Gb("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Rt(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const u=yE.getListenId_(e,i),m={};this.listens_[u]=m;const v=mU(e._queryParams);this.restRequest_(s+".json",v,(C,S)=>{let R=S;if(404===C&&(R=null,C=null),null===C&&this.onDataUpdate_(s,R,!1,i),w_(this.listens_,u)===m){let j;j=C?401===C?"permission_denied":"rest_error:"+C:"ok",r(j,null)}})}unlisten(e,t){const i=yE.getListenId_(e,t);delete this.listens_[i]}get(e){const t=mU(e._queryParams),i=e._path.toString(),r=new hm;return this.restRequest_(i+".json",t,(s,u)=>{let m=u;404===s&&(m=null,s=null),null===s?(this.onDataUpdate_(i,m,!1,null),r.resolve(m)):r.reject(new Error(m))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const u=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+pm(t);this.log_("Sending REST request for "+u);const m=new XMLHttpRequest;m.onreadystatechange=()=>{if(i&&4===m.readyState){this.log_("REST Response for "+u+" received. status:",m.status,"response:",m.responseText);let v=null;if(m.status>=200&&m.status<300){try{v=Eb(m.responseText)}catch{ga("Failed to parse JSON response for "+u+": "+m.responseText)}i(null,v)}else 401!==m.status&&404!==m.status&&ga("Got unsuccessful REST response for "+u+" Status: "+m.status),i(m.status);i=null}},m.open("GET",u,!0),m.send()})}}class Wne{constructor(){this.rootNode_=Jn.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function vE(){return{value:null,children:new Map}}function U_(n,e,t){if(vi(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const i=yi(e);n.children.has(i)||n.children.set(i,vE()),U_(n.children.get(i),e=br(e),t)}}function nP(n,e,t){null!==n.value?t(e,n.value):function qne(n,e){n.children.forEach((t,i)=>{e(i,t)})}(n,(i,r)=>{nP(r,new rr(e.toString()+"/"+i),t)})}class Zne{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Os(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}class Xne{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Zne(e);const i=1e4+2e4*Math.random();qb(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Os(e,(r,s)=>{s>0&&Cd(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),qb(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Vc=(()=>{return(n=Vc||(Vc={}))[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",Vc;var n})();function oP(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class bE{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Vc.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(vi(this.path)){if(null!=this.affectedTree.value)return Rt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new rr(e));return new bE(er(),t,this.revert)}}return Rt(yi(this.path)===e,"operationForChild called for unrelated child."),new bE(br(this.path),this.affectedTree,this.revert)}}class n0{constructor(e,t){this.source=e,this.path=t,this.type=Vc.LISTEN_COMPLETE}operationForChild(e){return vi(this.path)?new n0(this.source,er()):new n0(this.source,br(this.path))}}class Om{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Vc.OVERWRITE}operationForChild(e){return vi(this.path)?new Om(this.source,er(),this.snap.getImmediateChild(e)):new Om(this.source,br(this.path),this.snap)}}class j_{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Vc.MERGE}operationForChild(e){if(vi(this.path)){const t=this.children.subtree(new rr(e));return t.isEmpty()?null:t.value?new Om(this.source,er(),t.value):new j_(this.source,er(),t)}return Rt(yi(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new j_(this.source,br(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Gf{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(vi(e))return this.isFullyInitialized()&&!this.filtered_;const t=yi(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Qne{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function r0(n,e,t,i,r,s){const u=i.filter(m=>m.type===t);u.sort((m,v)=>function tie(n,e,t){if(null==e.childName||null==t.childName)throw x_("Should only compare child_ events.");const i=new Ii(e.childName,e.snapshotNode),r=new Ii(t.childName,t.snapshotNode);return n.index_.compare(i,r)}(n,m,v)),u.forEach(m=>{const v=function eie(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,m,s);r.forEach(C=>{C.respondsTo(m.type)&&e.push(C.createEvent(v,n.query_))})})}function xE(n,e){return{eventCache:n,serverCache:e}}function o0(n,e,t,i){return xE(new Gf(e,t,i),n.serverCache)}function yU(n,e,t,i){return xE(n.eventCache,new Gf(e,t,i))}function wE(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Fm(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let sP;class Ar{constructor(e,t=(()=>(sP||(sP=new Il(zte)),sP))()){this.value=e,this.children=t}static fromObject(e){let t=new Ar(null);return Os(e,(i,r)=>{t=t.set(new rr(i),r)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:er(),value:this.value};if(vi(e))return null;{const i=yi(e),r=this.children.get(i);if(null!==r){const s=r.findRootMostMatchingPathAndValue(br(e),t);return null!=s?{path:jr(new rr(i),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(vi(e))return this;{const t=yi(e),i=this.children.get(t);return null!==i?i.subtree(br(e)):new Ar(null)}}set(e,t){if(vi(e))return new Ar(t,this.children);{const i=yi(e),s=(this.children.get(i)||new Ar(null)).set(br(e),t),u=this.children.insert(i,s);return new Ar(this.value,u)}}remove(e){if(vi(e))return this.children.isEmpty()?new Ar(null):new Ar(null,this.children);{const t=yi(e),i=this.children.get(t);if(i){const r=i.remove(br(e));let s;return s=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&s.isEmpty()?new Ar(null):new Ar(this.value,s)}return this}}get(e){if(vi(e))return this.value;{const t=yi(e),i=this.children.get(t);return i?i.get(br(e)):null}}setTree(e,t){if(vi(e))return t;{const i=yi(e),s=(this.children.get(i)||new Ar(null)).setTree(br(e),t);let u;return u=s.isEmpty()?this.children.remove(i):this.children.insert(i,s),new Ar(this.value,u)}}fold(e){return this.fold_(er(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(jr(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,er(),t)}findOnPath_(e,t,i){const r=!!this.value&&i(t,this.value);if(r)return r;if(vi(e))return null;{const s=yi(e),u=this.children.get(s);return u?u.findOnPath_(br(e),jr(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,er(),t)}foreachOnPath_(e,t,i){if(vi(e))return this;{this.value&&i(t,this.value);const r=yi(e),s=this.children.get(r);return s?s.foreachOnPath_(br(e),jr(t,r),i):new Ar(null)}}foreach(e){this.foreach_(er(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(jr(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}class Uu{constructor(e){this.writeTree_=e}static empty(){return new Uu(new Ar(null))}}function s0(n,e,t){if(vi(e))return new Uu(new Ar(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const u=La(r,e);return s=s.updateChild(u,t),new Uu(n.writeTree_.set(r,s))}{const r=new Ar(t),s=n.writeTree_.setTree(e,r);return new Uu(s)}}}function aP(n,e,t){let i=n;return Os(t,(r,s)=>{i=s0(i,jr(e,r),s)}),i}function vU(n,e){if(vi(e))return Uu.empty();{const t=n.writeTree_.setTree(e,new Ar(null));return new Uu(t)}}function lP(n,e){return null!=Lm(n,e)}function Lm(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(La(t.path,e)):null}function bU(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Sr,(i,r)=>{e.push(new Ii(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{null!=r.value&&e.push(new Ii(i,r.value))}),e}function Wf(n,e){if(vi(e))return n;{const t=Lm(n,e);return new Uu(null!=t?new Ar(t):n.writeTree_.subtree(e))}}function cP(n){return n.writeTree_.isEmpty()}function $_(n,e){return xU(er(),n.writeTree_,e)}function xU(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{".priority"===r?(Rt(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):t=xU(jr(n,r),s,t)}),!t.getChild(n).isEmpty()&&null!==i&&(t=t.updateChild(jr(n,".priority"),i)),t}}function EE(n,e){return IU(e,n)}function aie(n,e){if(n.snap)return zc(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&zc(jr(n.path,t),e))return!0;return!1}function cie(n){return n.visible}function wU(n,e,t){let i=Uu.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const u=s.path;let m;if(s.snap)zc(t,u)?(m=La(t,u),i=s0(i,m,s.snap)):zc(u,t)&&(m=La(u,t),i=s0(i,er(),s.snap.getChild(m)));else{if(!s.children)throw x_("WriteRecord should have .snap or .children");if(zc(t,u))m=La(t,u),i=aP(i,m,s.children);else if(zc(u,t))if(m=La(u,t),vi(m))i=aP(i,er(),s.children);else{const v=w_(s.children,yi(m));if(v){const C=v.getChild(br(m));i=s0(i,er(),C)}}}}}return i}function EU(n,e,t,i,r){if(i||r){const s=Wf(n.visibleWrites,e);return!r&&cP(s)?t:r||null!=t||lP(s,er())?$_(wU(n.allWrites,function(C){return(C.visible||r)&&(!i||!~i.indexOf(C.writeId))&&(zc(C.path,e)||zc(e,C.path))},e),t||Jn.EMPTY_NODE):null}{const s=Lm(n.visibleWrites,e);if(null!=s)return s;{const u=Wf(n.visibleWrites,e);return cP(u)?t:null!=t||lP(u,er())?$_(u,t||Jn.EMPTY_NODE):null}}}function CE(n,e,t,i){return EU(n.writeTree,n.treePath,e,t,i)}function uP(n,e){return function uie(n,e,t){let i=Jn.EMPTY_NODE;const r=Lm(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Sr,(s,u)=>{i=i.updateImmediateChild(s,u)}),i;if(t){const s=Wf(n.visibleWrites,e);return t.forEachChild(Sr,(u,m)=>{const v=$_(Wf(s,new rr(u)),m);i=i.updateImmediateChild(u,v)}),bU(s).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}return bU(Wf(n.visibleWrites,e)).forEach(u=>{i=i.updateImmediateChild(u.name,u.node)}),i}(n.writeTree,n.treePath,e)}function CU(n,e,t,i){return function die(n,e,t,i,r){Rt(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=jr(e,t);if(lP(n.visibleWrites,s))return null;{const u=Wf(n.visibleWrites,s);return cP(u)?r.getChild(t):$_(u,r.getChild(t))}}(n.writeTree,n.treePath,e,t,i)}function TE(n,e){return function fie(n,e){return Lm(n.visibleWrites,e)}(n.writeTree,jr(n.treePath,e))}function dP(n,e,t){return function hie(n,e,t,i){const r=jr(e,t),s=Lm(n.visibleWrites,r);return null!=s?s:i.isCompleteForChild(t)?$_(Wf(n.visibleWrites,r),i.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function TU(n,e){return IU(jr(n.treePath,e),n.writeTree)}function IU(n,e){return{treePath:n,writeTree:e}}class _ie{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;Rt("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Rt(".priority"!==i,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(i,e0(i,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(i);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(i,Jb(i,r.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(i,V_(i,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw x_("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(i,e0(i,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}const DU=new class yie{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}};class hP{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=null!=this.optCompleteServerCache_?new Gf(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return dP(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Fm(this.viewCache_),s=function gie(n,e,t,i,r,s){return function pie(n,e,t,i,r,s,u){let m;const v=Wf(n.visibleWrites,e),C=Lm(v,er());if(null!=C)m=C;else{if(null==t)return[];m=$_(v,t)}if(m=m.withIndex(u),m.isEmpty()||m.isLeafNode())return[];{const S=[],R=u.getCompare(),j=s?m.getReverseIteratorFrom(i,u):m.getIteratorFrom(i,u);let K=j.getNext();for(;K&&S.length<r;)0!==R(K,i)&&S.push(K),K=j.getNext();return S}}(n.writeTree,n.treePath,e,t,i,r,s)}(this.writes_,r,t,1,i,e);return 0===s.length?null:s[0]}}function SU(n,e,t,i,r,s){const u=e.eventCache;if(null!=TE(i,t))return e;{let m,v;if(vi(t))if(Rt(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const C=Fm(e),R=uP(i,C instanceof Jn?C:Jn.EMPTY_NODE);m=n.filter.updateFullNode(e.eventCache.getNode(),R,s)}else{const C=CE(i,Fm(e));m=n.filter.updateFullNode(e.eventCache.getNode(),C,s)}else{const C=yi(t);if(".priority"===C){Rt(1===Hf(t),"Can't have a priority with additional path components");const S=u.getNode();v=e.serverCache.getNode();const R=CU(i,t,S,v);m=null!=R?n.filter.updatePriority(S,R):u.getNode()}else{const S=br(t);let R;if(u.isCompleteForChild(C)){v=e.serverCache.getNode();const j=CU(i,t,u.getNode(),v);R=null!=j?u.getNode().getImmediateChild(C).updateChild(S,j):u.getNode().getImmediateChild(C)}else R=dP(i,C,e.serverCache);m=null!=R?n.filter.updateChild(u.getNode(),C,R,S,r,s):u.getNode()}}return o0(e,m,u.isFullyInitialized()||vi(t),n.filter.filtersNodes())}}function IE(n,e,t,i,r,s,u,m){const v=e.serverCache;let C;const S=u?n.filter:n.filter.getIndexedFilter();if(vi(t))C=S.updateFullNode(v.getNode(),i,null);else if(S.filtersNodes()&&!v.isFiltered()){const K=v.getNode().updateChild(t,i);C=S.updateFullNode(v.getNode(),K,null)}else{const K=yi(t);if(!v.isCompleteForPath(t)&&Hf(t)>1)return e;const ie=br(t),Oe=v.getNode().getImmediateChild(K).updateChild(ie,i);C=".priority"===K?S.updatePriority(v.getNode(),Oe):S.updateChild(v.getNode(),K,Oe,ie,DU,null)}const R=yU(e,C,v.isFullyInitialized()||vi(t),S.filtersNodes());return SU(n,R,t,r,new hP(r,R,s),m)}function fP(n,e,t,i,r,s,u){const m=e.eventCache;let v,C;const S=new hP(r,e,s);if(vi(t))C=n.filter.updateFullNode(e.eventCache.getNode(),i,u),v=o0(e,C,!0,n.filter.filtersNodes());else{const R=yi(t);if(".priority"===R)C=n.filter.updatePriority(e.eventCache.getNode(),i),v=o0(e,C,m.isFullyInitialized(),m.isFiltered());else{const j=br(t),K=m.getNode().getImmediateChild(R);let ie;if(vi(j))ie=i;else{const we=S.getCompleteChild(R);ie=null!=we?".priority"===$R(j)&&we.getChild(rU(j)).isEmpty()?we:we.updateChild(j,i):Jn.EMPTY_NODE}v=K.equals(ie)?e:o0(e,n.filter.updateChild(m.getNode(),R,ie,j,S,u),m.isFullyInitialized(),n.filter.filtersNodes())}}return v}function AU(n,e){return n.eventCache.isCompleteForChild(e)}function MU(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function pP(n,e,t,i,r,s,u,m){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let C,v=e;C=vi(t)?i:new Ar(null).setTree(t,i);const S=e.serverCache.getNode();return C.children.inorderTraversal((R,j)=>{if(S.hasChild(R)){const ie=MU(0,e.serverCache.getNode().getImmediateChild(R),j);v=IE(n,v,new rr(R),ie,r,s,u,m)}}),C.children.inorderTraversal((R,j)=>{const K=!e.serverCache.isCompleteForChild(R)&&null===j.value;if(!S.hasChild(R)&&!K){const we=MU(0,e.serverCache.getNode().getImmediateChild(R),j);v=IE(n,v,new rr(R),we,r,s,u,m)}}),v}class Die{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new XR(i.getIndex()),s=function Une(n){return n.loadsAllData()?new XR(n.getIndex()):n.hasLimit()?new Vne(n):new t0(n)}(i);this.processor_=function vie(n){return{filter:n}}(s);const u=t.serverCache,m=t.eventCache,v=r.updateFullNode(Jn.EMPTY_NODE,u.getNode(),null),C=s.updateFullNode(Jn.EMPTY_NODE,m.getNode(),null),S=new Gf(v,u.isFullyInitialized(),r.filtersNodes()),R=new Gf(C,m.isFullyInitialized(),s.filtersNodes());this.viewCache_=xE(R,S),this.eventGenerator_=new Qne(this.query_)}get query(){return this.query_}}function Mie(n,e){const t=Fm(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!vi(e)&&!t.getImmediateChild(yi(e)).isEmpty())?t.getChild(e):null}function kU(n){return 0===n.eventRegistrations_.length}function RU(n,e,t){const i=[];if(t){Rt(null==e,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(s=>{const u=s.createCancelEvent(t,r);u&&i.push(u)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){const u=n.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}else r.push(u)}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function PU(n,e,t,i){e.type===Vc.MERGE&&null!==e.source.queryId&&(Rt(Fm(n.viewCache_),"We should always have a full cache before handling merges"),Rt(wE(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=function xie(n,e,t,i,r){const s=new _ie;let u,m;if(t.type===Vc.OVERWRITE){const C=t;C.source.fromUser?u=fP(n,e,C.path,C.snap,i,r,s):(Rt(C.source.fromServer,"Unknown source."),m=C.source.tagged||e.serverCache.isFiltered()&&!vi(C.path),u=IE(n,e,C.path,C.snap,i,r,m,s))}else if(t.type===Vc.MERGE){const C=t;C.source.fromUser?u=function Eie(n,e,t,i,r,s,u){let m=e;return i.foreach((v,C)=>{const S=jr(t,v);AU(e,yi(S))&&(m=fP(n,m,S,C,r,s,u))}),i.foreach((v,C)=>{const S=jr(t,v);AU(e,yi(S))||(m=fP(n,m,S,C,r,s,u))}),m}(n,e,C.path,C.children,i,r,s):(Rt(C.source.fromServer,"Unknown source."),m=C.source.tagged||e.serverCache.isFiltered(),u=pP(n,e,C.path,C.children,i,r,m,s))}else if(t.type===Vc.ACK_USER_WRITE){const C=t;u=C.revert?function Iie(n,e,t,i,r,s){let u;if(null!=TE(i,t))return e;{const m=new hP(i,e,r),v=e.eventCache.getNode();let C;if(vi(t)||".priority"===yi(t)){let S;if(e.serverCache.isFullyInitialized())S=CE(i,Fm(e));else{const R=e.serverCache.getNode();Rt(R instanceof Jn,"serverChildren would be complete if leaf node"),S=uP(i,R)}C=n.filter.updateFullNode(v,S,s)}else{const S=yi(t);let R=dP(i,S,e.serverCache);null==R&&e.serverCache.isCompleteForChild(S)&&(R=v.getImmediateChild(S)),C=null!=R?n.filter.updateChild(v,S,R,br(t),m,s):e.eventCache.getNode().hasChild(S)?n.filter.updateChild(v,S,Jn.EMPTY_NODE,br(t),m,s):v,C.isEmpty()&&e.serverCache.isFullyInitialized()&&(u=CE(i,Fm(e)),u.isLeafNode()&&(C=n.filter.updateFullNode(C,u,s)))}return u=e.serverCache.isFullyInitialized()||null!=TE(i,er()),o0(e,C,u,n.filter.filtersNodes())}}(n,e,C.path,i,r,s):function Cie(n,e,t,i,r,s,u){if(null!=TE(r,t))return e;const m=e.serverCache.isFiltered(),v=e.serverCache;if(null!=i.value){if(vi(t)&&v.isFullyInitialized()||v.isCompleteForPath(t))return IE(n,e,t,v.getNode().getChild(t),r,s,m,u);if(vi(t)){let C=new Ar(null);return v.getNode().forEachChild(Ad,(S,R)=>{C=C.set(new rr(S),R)}),pP(n,e,t,C,r,s,m,u)}return e}{let C=new Ar(null);return i.foreach((S,R)=>{const j=jr(t,S);v.isCompleteForPath(j)&&(C=C.set(S,v.getNode().getChild(j)))}),pP(n,e,t,C,r,s,m,u)}}(n,e,C.path,C.affectedTree,i,r,s)}else{if(t.type!==Vc.LISTEN_COMPLETE)throw x_("Unknown operation type: "+t.type);u=function Tie(n,e,t,i,r){const s=e.serverCache;return SU(n,yU(e,s.getNode(),s.isFullyInitialized()||vi(t),s.isFiltered()),t,i,DU,r)}(n,e,t.path,i,s)}const v=s.getChanges();return function wie(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=wE(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(pU(wE(e)))}}(e,u,v),{viewCache:u,changes:v}}(n.processor_,r,e,t,i);return function bie(n,e){Rt(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Rt(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),Rt(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,OU(n,s.changes,s.viewCache.eventCache.getNode(),null)}function OU(n,e,t,i){return function Jne(n,e,t,i){const r=[],s=[];return e.forEach(u=>{"child_changed"===u.type&&n.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&s.push(function zne(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(u.childName,u.snapshotNode))}),r0(n,r,"child_removed",e,i,t),r0(n,r,"child_added",e,i,t),r0(n,r,"child_moved",s,i,t),r0(n,r,"child_changed",e,i,t),r0(n,r,"value",e,i,t),r}(n.eventGenerator_,e,t,i?[i]:n.eventRegistrations_)}let DE,AE;class FU{constructor(){this.views=new Map}}function mP(n,e,t,i){const r=e.source.queryId;if(null!==r){const s=n.views.get(r);return Rt(null!=s,"SyncTree gave us an op for an invalid query."),PU(s,e,t,i)}{let s=[];for(const u of n.views.values())s=s.concat(PU(u,e,t,i));return s}}function LU(n,e,t,i,r){const u=n.views.get(e._queryIdentifier);if(!u){let m=CE(t,r?i:null),v=!1;m?v=!0:i instanceof Jn?(m=uP(t,i),v=!1):(m=Jn.EMPTY_NODE,v=!1);const C=xE(new Gf(m,v,!1),new Gf(i,r,!1));return new Die(e,C)}return u}function NU(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function qf(n,e){let t=null;for(const i of n.views.values())t=t||Mie(i,e);return t}function BU(n,e){return e._queryParams.loadsAllData()?SE(n):n.views.get(e._queryIdentifier)}function zU(n,e){return null!=BU(n,e)}function Zf(n){return null!=SE(n)}function SE(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let Vie=1;class VU{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ar(null),this.pendingWriteTree_=function mie(){return{visibleWrites:Uu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function gP(n,e,t,i,r){return function iie(n,e,t,i,r){Rt(i>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=s0(n.visibleWrites,e,t)),n.lastWriteId=i}(n.pendingWriteTree_,e,t,i,r),r?H_(n,new Om({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Yf(n,e,t=!1){const i=function oie(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}(n.pendingWriteTree_,e);if(function sie(n,e){const t=n.allWrites.findIndex(m=>m.writeId===e);Rt(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,u=n.allWrites.length-1;for(;r&&u>=0;){const m=n.allWrites[u];m.visible&&(u>=t&&aie(m,i.path)?r=!1:zc(i.path,m.path)&&(s=!0)),u--}return!!r&&(s?(function lie(n){n.visibleWrites=wU(n.allWrites,cie,er()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(i.snap?n.visibleWrites=vU(n.visibleWrites,i.path):Os(i.children,v=>{n.visibleWrites=vU(n.visibleWrites,jr(i.path,v))}),!0))}(n.pendingWriteTree_,e)){let s=new Ar(null);return null!=i.snap?s=s.set(er(),!0):Os(i.children,u=>{s=s.set(new rr(u),!0)}),H_(n,new bE(i.path,s,t))}return[]}function a0(n,e,t){return H_(n,new Om({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function ME(n,e,t,i,r=!1){const s=e._path,u=n.syncPointTree_.get(s);let m=[];if(u&&("default"===e._queryIdentifier||zU(u,e))){const v=function Nie(n,e,t,i){const r=e._queryIdentifier,s=[];let u=[];const m=Zf(n);if("default"===r)for(const[v,C]of n.views.entries())u=u.concat(RU(C,t,i)),kU(C)&&(n.views.delete(v),C.query._queryParams.loadsAllData()||s.push(C.query));else{const v=n.views.get(r);v&&(u=u.concat(RU(v,t,i)),kU(v)&&(n.views.delete(r),v.query._queryParams.loadsAllData()||s.push(v.query)))}return m&&!Zf(n)&&s.push(new(function Oie(){return Rt(DE,"Reference.ts has not been loaded"),DE}())(e._repo,e._path)),{removed:s,events:u}}(u,e,t,i);(function Fie(n){return 0===n.views.size})(u)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const C=v.removed;if(m=v.events,!r){const S=-1!==C.findIndex(j=>j._queryParams.loadsAllData()),R=n.syncPointTree_.findOnPath(s,(j,K)=>Zf(K));if(S&&!R){const j=n.syncPointTree_.subtree(s);if(!j.isEmpty()){const K=function qie(n){return n.fold((e,t,i)=>{if(t&&Zf(t))return[SE(t)];{let r=[];return t&&(r=NU(t)),Os(i,(s,u)=>{r=r.concat(u)}),r}})}(j);for(let ie=0;ie<K.length;++ie){const we=K[ie],Oe=we.query,Ke=HU(n,we);n.listenProvider_.startListening(c0(Oe),l0(n,Oe),Ke.hashFn,Ke.onComplete)}}}!R&&C.length>0&&!i&&(S?n.listenProvider_.stopListening(c0(e),null):C.forEach(j=>{const K=n.queryToTagMap.get(RE(j));n.listenProvider_.stopListening(c0(j),K)}))}!function Zie(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=RE(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}(n,C)}return m}function UU(n,e,t,i){const r=yP(n,i);if(null!=r){const s=vP(r),u=s.path,m=s.queryId,v=La(u,e);return bP(n,u,new Om(oP(m),v,t))}return[]}function _P(n,e,t,i=!1){const r=e._path;let s=null,u=!1;n.syncPointTree_.foreachOnPath(r,(j,K)=>{const ie=La(j,r);s=s||qf(K,ie),u=u||Zf(K)});let v,m=n.syncPointTree_.get(r);m?(u=u||Zf(m),s=s||qf(m,er())):(m=new FU,n.syncPointTree_=n.syncPointTree_.set(r,m)),null!=s?v=!0:(v=!1,s=Jn.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((K,ie)=>{const we=qf(ie,er());we&&(s=s.updateImmediateChild(K,we))}));const C=zU(m,e);if(!C&&!e._queryParams.loadsAllData()){const j=RE(e);Rt(!n.queryToTagMap.has(j),"View does not exist, but we have a tag");const K=function Yie(){return Vie++}();n.queryToTagMap.set(j,K),n.tagToQueryMap.set(K,j)}let R=function Lie(n,e,t,i,r,s){const u=LU(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,u),function kie(n,e){n.eventRegistrations_.push(e)}(u,t),function Rie(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Sr,(s,u)=>{i.push(V_(s,u))}),t.isFullyInitialized()&&i.push(pU(t.getNode())),OU(n,i,t.getNode(),e)}(u,t)}(m,e,t,EE(n.pendingWriteTree_,r),s,v);if(!C&&!u&&!i){const j=BU(m,e);R=R.concat(function Kie(n,e,t){const i=e._path,r=l0(n,e),s=HU(n,t),u=n.listenProvider_.startListening(c0(e),r,s.hashFn,s.onComplete),m=n.syncPointTree_.subtree(i);if(r)Rt(!Zf(m.value),"If we're adding a query, it shouldn't be shadowed");else{const v=m.fold((C,S,R)=>{if(!vi(C)&&S&&Zf(S))return[SE(S).query];{let j=[];return S&&(j=j.concat(NU(S).map(K=>K.query))),Os(R,(K,ie)=>{j=j.concat(ie)}),j}});for(let C=0;C<v.length;++C){const S=v[C];n.listenProvider_.stopListening(c0(S),l0(n,S))}}return u}(n,e,j))}return R}function kE(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(u,m)=>{const C=qf(m,La(u,e));if(C)return C});return EU(r,e,s,t,!0)}function H_(n,e){return jU(e,n.syncPointTree_,null,EE(n.pendingWriteTree_,er()))}function jU(n,e,t,i){if(vi(n.path))return $U(n,e,t,i);{const r=e.get(er());null==t&&null!=r&&(t=qf(r,er()));let s=[];const u=yi(n.path),m=n.operationForChild(u),v=e.children.get(u);if(v&&m){const C=t?t.getImmediateChild(u):null,S=TU(i,u);s=s.concat(jU(m,v,C,S))}return r&&(s=s.concat(mP(r,n,i,t))),s}}function $U(n,e,t,i){const r=e.get(er());null==t&&null!=r&&(t=qf(r,er()));let s=[];return e.children.inorderTraversal((u,m)=>{const v=t?t.getImmediateChild(u):null,C=TU(i,u),S=n.operationForChild(u);S&&(s=s.concat($U(S,m,v,C)))}),r&&(s=s.concat(mP(r,n,i,t))),s}function HU(n,e){const t=e.query,i=l0(n,t);return{hashFn:()=>(function Sie(n){return n.viewCache_.serverCache.getNode()}(e)||Jn.EMPTY_NODE).hash(),onComplete:r=>{if("ok"===r)return i?function Hie(n,e,t){const i=yP(n,t);if(i){const r=vP(i),s=r.path,u=r.queryId,m=La(s,e);return bP(n,s,new n0(oP(u),m))}return[]}(n,t._path,i):function $ie(n,e){return H_(n,new n0({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function jte(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}(r,t);return ME(n,t,null,s)}}}}function l0(n,e){const t=RE(e);return n.queryToTagMap.get(t)}function RE(n){return n._path.toString()+"$"+n._queryIdentifier}function yP(n,e){return n.tagToQueryMap.get(e)}function vP(n){const e=n.indexOf("$");return Rt(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new rr(n.substr(0,e))}}function bP(n,e,t){const i=n.syncPointTree_.get(e);return Rt(i,"Missing sync point for query tag that we're tracking"),mP(i,t,EE(n.pendingWriteTree_,e),null)}function c0(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function zie(){return Rt(AE,"Reference.ts has not been loaded"),AE}())(n._repo,n._path):n}class xP{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new xP(t)}node(){return this.node_}}class wP{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=jr(this.path_,e);return new wP(this.syncTree_,t)}node(){return kE(this.syncTree_,this.path_)}}const Xie=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},GU=function(n,e,t){return n&&"object"==typeof n?(Rt(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Qie(n[".sv"],e,t):"object"==typeof n[".sv"]?Jie(n[".sv"],e):void Rt(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Qie=function(n,e,t){if("timestamp"===n)return t.timestamp;Rt(!1,"Unexpected server value: "+n)},Jie=function(n,e,t){n.hasOwnProperty("increment")||Rt(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;"number"!=typeof i&&Rt(!1,"Unexpected increment value: "+i);const r=e.node();if(Rt(null!==r&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const u=r.getValue();return"number"!=typeof u?i:u+i},WU=function(n,e,t,i){return CP(e,new wP(t,n),i)},EP=function(n,e,t){return CP(n,new xP(e),t)};function CP(n,e,t){const i=n.getPriority().val(),r=GU(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const u=n,m=GU(u.getValue(),e,t);return m!==u.getValue()||r!==u.getPriority().val()?new B_(m,to(r)):n}{const u=n;return s=u,r!==u.getPriority().val()&&(s=s.updatePriority(new B_(r))),u.forEachChild(Sr,(m,v)=>{const C=CP(v,e.getImmediateChild(m),t);C!==v&&(s=s.updateImmediateChild(m,C))}),s}}class TP{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function PE(n,e){let t=e instanceof rr?e:new rr(e),i=n,r=yi(t);for(;null!==r;){const s=w_(i.node.children,r)||{children:{},childCount:0};i=new TP(r,i,s),t=br(t),r=yi(t)}return i}function Nm(n){return n.node.value}function IP(n,e){n.node.value=e,DP(n)}function qU(n){return n.node.childCount>0}function OE(n,e){Os(n.node.children,(t,i)=>{e(new TP(t,n,i))})}function ZU(n,e,t,i){t&&!i&&e(n),OE(n,r=>{ZU(r,e,!0,i)}),t&&i&&e(n)}function u0(n){return new rr(null===n.parent?n.name:u0(n.parent)+"/"+n.name)}function DP(n){null!==n.parent&&function nre(n,e,t){const i=function ere(n){return void 0===Nm(n)&&!qU(n)}(t),r=Cd(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,DP(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,DP(n))}(n.parent,n.name,n)}const ire=/[\[\].#$\/\u0000-\u001F\u007F]/,rre=/[\[\].#$\u0000-\u001F\u007F]/,SP=10485760,FE=function(n){return"string"==typeof n&&0!==n.length&&!ire.test(n)},YU=function(n){return"string"==typeof n&&0!==n.length&&!rre.test(n)},d0=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!cE(n)||n&&"object"==typeof n&&Cd(n,".sv")},Md=function(n,e,t,i){i&&void 0===e||h0(mm(n,"value"),e,t)},h0=function(n,e,t){const i=t instanceof rr?new xne(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Rm(i));if("function"==typeof e)throw new Error(n+"contains a function "+Rm(i)+" with contents = "+e.toString());if(cE(e))throw new Error(n+"contains "+e.toString()+" "+Rm(i));if("string"==typeof e&&e.length>SP/3&&C1(e)>SP)throw new Error(n+"contains a string greater than "+SP+" utf8 bytes "+Rm(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let r=!1,s=!1;if(Os(e,(u,m)=>{if(".value"===u)r=!0;else if(".priority"!==u&&".sv"!==u&&(s=!0,!FE(u)))throw new Error(n+" contains an invalid key ("+u+") "+Rm(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function wne(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=C1(e),oU(n)})(i,u),h0(n,m,i),function Ene(n){const e=n.parts_.pop();n.byteLength_-=C1(e),n.parts_.length>0&&(n.byteLength_-=1)}(i)}),r&&s)throw new Error(n+' contains ".value" child '+Rm(i)+" in addition to actual children.")}},MP=function(n,e,t,i){if(!(i&&void 0===t||YU(t)))throw new Error(mm(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},are=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),MP(n,e,t,i)},kd=function(n,e){if(".info"===yi(e))throw new Error(n+" failed = Can't modify data under /.info/")},XU=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!FE(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),YU(n)}(t))throw new Error(mm(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class lre{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function LE(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null!==t&&!HR(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function QU(n,e,t){LE(n,t),JU(n,i=>HR(i,e))}function Kl(n,e,t){LE(n,t),JU(n,i=>zc(i,e)||zc(e,i))}function JU(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];r&&(e(r.path)?(cre(n.eventLists_[i]),n.eventLists_[i]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function cre(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const i=t.getEventRunner();Mm&&Ps("event: "+t.toString()),L_(i)}}}const e5="repo_interrupt",ure=25;class dre{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new lre,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=vE(),this.transactionQueueTree_=new TP,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function t5(n){const t=n.infoData_.getNode(new rr(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function p0(n){return Xie({timestamp:t5(n)})}function n5(n,e,t,i,r){n.dataUpdateCount++;const s=new rr(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let u=[];if(r)if(i){const v=w1(t,C=>to(C));u=function Gie(n,e,t,i){const r=yP(n,i);if(r){const s=vP(r),u=s.path,m=s.queryId,v=La(u,e),C=Ar.fromObject(t);return bP(n,u,new j_(oP(m),v,C))}return[]}(n.serverSyncTree_,s,v,r)}else{const v=to(t);u=UU(n.serverSyncTree_,s,v,r)}else if(i){const v=w1(t,C=>to(C));u=function jie(n,e,t){const i=Ar.fromObject(t);return H_(n,new j_({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,s,v)}else{const v=to(t);u=a0(n.serverSyncTree_,s,v)}let m=s;u.length>0&&(m=W_(n,s)),Kl(n.eventQueue_,m,u)}function r5(n,e){kP(n,"connected",e),!1===e&&function gre(n){G_(n,"onDisconnectEvents");const e=p0(n),t=vE();nP(n.onDisconnect_,er(),(r,s)=>{const u=WU(r,s,n.serverSyncTree_,e);U_(t,r,u)});let i=[];nP(t,er(),(r,s)=>{i=i.concat(a0(n.serverSyncTree_,r,s));const u=FP(n,r);W_(n,u)}),n.onDisconnect_=vE(),Kl(n.eventQueue_,er(),i)}(n)}function kP(n,e,t){const i=new rr("/.info/"+e),r=to(t);n.infoData_.updateSnapshot(i,r);const s=a0(n.infoSyncTree_,i,r);Kl(n.eventQueue_,i,s)}function NE(n){return n.nextWriteId_++}function RP(n,e,t,i,r){G_(n,"set",{path:e.toString(),value:t,priority:i});const s=p0(n),u=to(t,i),m=kE(n.serverSyncTree_,e),v=EP(u,m,s),C=NE(n),S=gP(n.serverSyncTree_,e,v,C,!0);LE(n.eventQueue_,S),n.server_.put(e.toString(),u.val(!0),(j,K)=>{const ie="ok"===j;ie||ga("set at "+e+" failed: "+j);const we=Yf(n.serverSyncTree_,C,!ie);Kl(n.eventQueue_,e,we),function Kf(n,e,t,i){e&&L_(()=>{if("ok"===t)e(null);else{const r=(t||"error").toUpperCase();let s=r;i&&(s+=": "+i);const u=new Error(s);u.code=r,e(u)}})}(0,r,j,K)});const R=FP(n,e);W_(n,R),Kl(n.eventQueue_,R,[])}function PP(n,e,t){let i;i=".info"===yi(e._path)?ME(n.infoSyncTree_,e,t):ME(n.serverSyncTree_,e,t),QU(n.eventQueue_,e._path,i)}function G_(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ps(t,...e)}function OP(n,e,t){return kE(n.serverSyncTree_,e,t)||Jn.EMPTY_NODE}function BE(n,e=n.transactionQueueTree_){if(e||zE(n,e),Nm(e)){const t=l5(n,e);Rt(t.length>0,"Sending zero length transaction queue"),t.every(r=>0===r.status)&&function Ere(n,e,t){const i=t.map(C=>C.currentWriteId),r=OP(n,e,i);let s=r;const u=r.hash();for(let C=0;C<t.length;C++){const S=t[C];Rt(0===S.status,"tryToSendTransactionQueue_: items in queue should all be run."),S.status=1,S.retryCount++;const R=La(e,S.path);s=s.updateChild(R,S.currentOutputSnapshotRaw)}const m=s.val(!0),v=e;n.server_.put(v.toString(),m,C=>{G_(n,"transaction put response",{path:v.toString(),status:C});let S=[];if("ok"===C){const R=[];for(let j=0;j<t.length;j++)t[j].status=2,S=S.concat(Yf(n.serverSyncTree_,t[j].currentWriteId)),t[j].onComplete&&R.push(()=>t[j].onComplete(null,!0,t[j].currentOutputSnapshotResolved)),t[j].unwatcher();zE(n,PE(n.transactionQueueTree_,e)),BE(n,n.transactionQueueTree_),Kl(n.eventQueue_,e,S);for(let j=0;j<R.length;j++)L_(R[j])}else{if("datastale"===C)for(let R=0;R<t.length;R++)t[R].status=3===t[R].status?4:0;else{ga("transaction at "+v.toString()+" failed: "+C);for(let R=0;R<t.length;R++)t[R].status=4,t[R].abortReason=C}W_(n,e)}},u)}(n,u0(e),t)}else qU(e)&&OE(e,t=>{BE(n,t)})}function W_(n,e){const t=a5(n,e),i=u0(t);return function Cre(n,e,t){if(0===e.length)return;const i=[];let r=[];const u=e.filter(m=>0===m.status).map(m=>m.currentWriteId);for(let m=0;m<e.length;m++){const v=e[m],C=La(t,v.path);let R,S=!1;if(Rt(null!==C,"rerunTransactionsUnderNode_: relativePath should not be null."),4===v.status)S=!0,R=v.abortReason,r=r.concat(Yf(n.serverSyncTree_,v.currentWriteId,!0));else if(0===v.status)if(v.retryCount>=ure)S=!0,R="maxretry",r=r.concat(Yf(n.serverSyncTree_,v.currentWriteId,!0));else{const j=OP(n,v.path,u);v.currentInputSnapshot=j;const K=e[m].update(j.val());if(void 0!==K){h0("transaction failed: Data returned ",K,v.path);let ie=to(K);"object"==typeof K&&null!=K&&Cd(K,".priority")||(ie=ie.updatePriority(j.getPriority()));const Oe=v.currentWriteId,Ke=p0(n),_t=EP(ie,j,Ke);v.currentOutputSnapshotRaw=ie,v.currentOutputSnapshotResolved=_t,v.currentWriteId=NE(n),u.splice(u.indexOf(Oe),1),r=r.concat(gP(n.serverSyncTree_,v.path,_t,v.currentWriteId,v.applyLocally)),r=r.concat(Yf(n.serverSyncTree_,Oe,!0))}else S=!0,R="nodata",r=r.concat(Yf(n.serverSyncTree_,v.currentWriteId,!0))}Kl(n.eventQueue_,t,r),r=[],S&&(e[m].status=2,setTimeout(e[m].unwatcher,Math.floor(0)),e[m].onComplete&&i.push("nodata"===R?()=>e[m].onComplete(null,!1,e[m].currentInputSnapshot):()=>e[m].onComplete(new Error(R),!1,null)))}zE(n,n.transactionQueueTree_);for(let m=0;m<i.length;m++)L_(i[m]);BE(n,n.transactionQueueTree_)}(n,l5(n,t),i),i}function a5(n,e){let t,i=n.transactionQueueTree_;for(t=yi(e);null!==t&&void 0===Nm(i);)i=PE(i,t),t=yi(e=br(e));return i}function l5(n,e){const t=[];return c5(n,e,t),t.sort((i,r)=>i.order-r.order),t}function c5(n,e,t){const i=Nm(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);OE(e,r=>{c5(n,r,t)})}function zE(n,e){const t=Nm(e);if(t){let i=0;for(let r=0;r<t.length;r++)2!==t[r].status&&(t[i]=t[r],i++);t.length=i,IP(e,t.length>0?t:void 0)}OE(e,i=>{zE(n,i)})}function FP(n,e){const t=u0(a5(n,e)),i=PE(n.transactionQueueTree_,e);return function tre(n,e,t){let i=t?n:n.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,r=>{LP(n,r)}),LP(n,i),ZU(i,r=>{LP(n,r)}),t}function LP(n,e){const t=Nm(e);if(t){const i=[];let r=[],s=-1;for(let u=0;u<t.length;u++)3===t[u].status||(1===t[u].status?(Rt(s===u-1,"All SENT items should be at beginning of queue."),s=u,t[u].status=3,t[u].abortReason="set"):(Rt(0===t[u].status,"Unexpected transaction status in abort"),t[u].unwatcher(),r=r.concat(Yf(n.serverSyncTree_,t[u].currentWriteId,!0)),t[u].onComplete&&i.push(t[u].onComplete.bind(null,new Error("set"),!1,null))));-1===s?IP(e,void 0):t.length=s+1,Kl(n.eventQueue_,u0(e),r);for(let u=0;u<i.length;u++)L_(i[u])}}const NP=function(n,e){const t=Dre(n),i=t.namespace;return"firebase.com"===t.domain&&Sd(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||"undefined"===i)&&"localhost"!==t.domain&&Sd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ga("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new NR(t.host,t.secure,i,"ws"===t.scheme||"wss"===t.scheme,e,"",i!==t.subdomain),path:new rr(t.pathString)}},Dre=function(n){let e="",t="",i="",r="",s="",u=!0,m="https",v=443;if("string"==typeof n){let C=n.indexOf("//");C>=0&&(m=n.substring(0,C-1),n=n.substring(C+2));let S=n.indexOf("/");-1===S&&(S=n.length);let R=n.indexOf("?");-1===R&&(R=n.length),e=n.substring(0,Math.min(S,R)),S<R&&(r=function Tre(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}(n.substring(S,R)));const j=function Ire(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const i=t.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ga(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,R)));C=e.indexOf(":"),C>=0?(u="https"===m||"wss"===m,v=parseInt(e.substring(C+1),10)):C=e.length;const K=e.slice(0,C);if("localhost"===K.toLowerCase())t="localhost";else if(K.split(".").length<=2)t=K;else{const ie=e.indexOf(".");i=e.substring(0,ie).toLowerCase(),t=e.substring(ie+1),s=i}"ns"in j&&(s=j.ns)}return{host:e,port:v,domain:t,subdomain:i,secure:u,scheme:m,pathString:r,namespace:s}},u5="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Sre=function(){let n=0;const e=[];return function(t){const i=t===n;let r;n=t;const s=new Array(8);for(r=7;r>=0;r--)s[r]=u5.charAt(t%64),t=Math.floor(t/64);Rt(0===t,"Cannot push at time == 0");let u=s.join("");if(i){for(r=11;r>=0&&63===e[r];r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)u+=u5.charAt(e[r]);return Rt(20===u.length,"nextPushId: Length should be 20."),u}}();class d5{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+as(this.snapshot.exportVal())}}class h5{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class BP{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Rt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Xl{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return vi(this._path)?null:$R(this._path)}get ref(){return new ju(this._repo,this._path)}get _queryIdentifier(){const e=gU(this._queryParams),t=FR(e);return"{}"===t?"default":t}get _queryObject(){return gU(this._queryParams)}isEqual(e){if(!((e=Ho(e))instanceof Xl))return!1;const t=this._repo===e._repo,i=HR(this._path,e._path);return t&&i&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function vne(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function Xf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Ad){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==jf)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(n.hasEnd()){if(n.getIndexEndName()!==Mh)throw new Error(i);if("string"!=typeof t)throw new Error(r)}}else if(n.getIndex()===Sr){if(null!=e&&!d0(e)||null!=t&&!d0(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Rt(n.getIndex()instanceof YR||n.getIndex()===KR,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function UE(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class ju extends Xl{constructor(e,t){super(e,t,new QR,!1)}get parent(){const e=rU(this._path);return null===e?null:new ju(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Bm{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new rr(e),i=q_(this.ref,e);return new Bm(this._node.getChild(t),i,Sr)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(i,r)=>e(new Bm(r,q_(this.ref,i),Sr)))}hasChild(e){const t=new rr(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function zP(n,e){return(n=Ho(n))._checkNotDeleted("ref"),void 0!==e?q_(n._root,e):n._root}function q_(n,e){return null===yi((n=Ho(n))._path)?are("child","path",e,!1):MP("child","path",e,!1),new ju(n._repo,jr(n._path,e))}function kre(n){n=Ho(n);const e=new BP(()=>{}),t=new m0(e);return function pre(n,e,t){const i=function Wie(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(C,S)=>{const R=La(C,t);i=i||qf(S,R)});let r=n.syncPointTree_.get(t);r?i=i||qf(r,er()):(r=new FU,n.syncPointTree_=n.syncPointTree_.set(t,r));const s=null!=i,u=s?new Gf(i,!0,!1):null;return function Aie(n){return wE(n.viewCache_)}(LU(r,e,EE(n.pendingWriteTree_,e._path),s?u.getNode():Jn.EMPTY_NODE,s))}(n.serverSyncTree_,e);return null!=i?Promise.resolve(i):n.server_.get(e).then(r=>{const s=to(r).withIndex(e._queryParams.getIndex());let u;if(_P(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())u=a0(n.serverSyncTree_,e._path,s);else{const m=l0(n.serverSyncTree_,e);u=UU(n.serverSyncTree_,e._path,s,m)}return Kl(n.eventQueue_,e._path,u),ME(n.serverSyncTree_,e,t,null,!0),s},r=>(G_(n,"get for query "+as(e)+" failed: "+r),Promise.reject(new Error(r))))}(n._repo,n,t).then(i=>new Bm(i,new ju(n._repo,n._path),n._queryParams.getIndex()))}class m0{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const i=t._queryParams.getIndex();return new d5("value",this,new Bm(e.snapshotNode,new ju(t._repo,t._path),i))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new h5(this,e,t):null}matches(e){return e instanceof m0&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class jE{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new h5(this,e,t):null}createEvent(e,t){Rt(null!=e.childName,"Child events should have a childName.");const i=q_(new ju(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new d5(e.type,this,new Bm(e.snapshotNode,i,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof jE&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function p5(n,e,t,i){return function g0(n,e,t,i,r){let s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){const v=t,C=(S,R)=>{PP(n._repo,n,m),v(S,R)};C.userCallback=t.userCallback,C.context=t.context,t=C}const u=new BP(t,s||void 0),m="value"===e?new m0(u):new jE(e,u);return function bre(n,e,t){let i;i=".info"===yi(e._path)?_P(n.infoSyncTree_,e,t):_P(n.serverSyncTree_,e,t),QU(n.eventQueue_,e._path,i)}(n._repo,n,m),()=>PP(n._repo,n,m)}(n,"value",e,t,i)}class $E{}class m5 extends $E{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Md("endAt",this._value,e._path,!0);const t=function eP(n,e,t){const i=n.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==t?(i.endNameSet_=!0,i.indexEndName_=t):(i.endNameSet_=!1,i.indexEndName_=""),i}(e._queryParams,this._value,this._key);if(UE(t),Xf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Xl(e._repo,e._path,t,e._orderByCalled)}}class g5 extends $E{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){Md("startAt",this._value,e._path,!0);const t=function JR(n,e,t){const i=n.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=t?(i.startNameSet_=!0,i.indexStartName_=t):(i.startNameSet_=!1,i.indexStartName_=""),i}(e._queryParams,this._value,this._key);if(UE(t),Xf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Xl(e._repo,e._path,t,e._orderByCalled)}}class Lre extends $E{constructor(e){super(),this._path=e}_apply(e){!function VE(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}(e,"orderByChild");const t=new rr(this._path);if(vi(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const i=new YR(t),r=function _E(n,e){const t=n.copy();return t.index_=e,t}(e._queryParams,i);return Xf(r),new Xl(e._repo,e._path,r,!0)}}class Ure extends $E{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(Md("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new m5(this._value,this._key)._apply(new g5(this._value,this._key)._apply(e))}}(function Pie(n){Rt(!DE,"__referenceConstructor has already been defined"),DE=n})(ju),function Bie(n){Rt(!AE,"__referenceConstructor has already been defined"),AE=n}(ju);const Hre="FIREBASE_DATABASE_EMULATOR_HOST",VP={};let _5=!1;class Kre{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function hre(n,e,t){if(n.stats_=VR(n.repoInfo_),n.forceRestClient_||Wte())n.server_=new yE(n.repoInfo_,(i,r,s,u)=>{n5(n,i,r,s,u)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>r5(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{as(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Pm(n.repoInfo_,e,(i,r,s,u)=>{n5(n,i,r,s,u)},i=>{r5(n,i)},i=>{!function fre(n,e){Os(e,(t,i)=>{kP(n,t,i)})}(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=function Xte(n,e){const t=n.toString();return zR[t]||(zR[t]=e()),zR[t]}(n.repoInfo_,()=>new Xne(n.stats_,n.server_)),n.infoData_=new Wne,n.infoSyncTree_=new VU({startListening:(i,r,s,u)=>{let m=[];const v=n.infoData_.getNode(i._path);return v.isEmpty()||(m=a0(n.infoSyncTree_,i._path,v),setTimeout(()=>{u("ok")},0)),m},stopListening:()=>{}}),kP(n,"connected",!1),n.serverSyncTree_=new VU({startListening:(i,r,s,u)=>(n.server_.listen(i,s,r,(m,v)=>{const C=u(m,v);Kl(n.eventQueue_,i._path,C)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ju(this._repo,er())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function qre(n,e){const t=VP[e];(!t||t[n.key]!==n)&&Sd(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function s5(n){n.persistentConnection_&&n.persistentConnection_.interrupt(e5)}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Sd("Cannot call "+e+" on a deleted database.")}}function UP(n=eS(),e){const t=C_(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=J7("database");i&&function Xre(n,e,t,i={}){(n=Ho(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&Sd("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&Sd('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Zb(Zb.OWNER);else if(i.mockUserToken){const u="string"==typeof i.mockUserToken?i.mockUserToken:function e9(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[y1(JSON.stringify({alg:"none",type:"JWT"})),y1(JSON.stringify(u)),""].join(".")}(i.mockUserToken,n.app.options.projectId);s=new Zb(u)}!function Gre(n,e,t,i){n.repoInfo_=new NR(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}(r,e,t,s)}(t,...i)}return t}Pm.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Pm.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Qre(n){(function Ote(n){RR=n})(vm),Oa(new ma("database",(e,{instanceIdentifier:t})=>function Wre(n,e,t,i,r){let s=i||n.options.databaseURL;void 0===s&&(n.options.projectId||Sd("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ps("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let v,C,u=NP(s,r),m=u.repoInfo;typeof process<"u"&&process.env&&(C=process.env[Hre]),C?(v=!0,s=`http://${C}?ns=${m.namespace}`,u=NP(s,r),m=u.repoInfo):v=!u.repoInfo.secure;const S=r&&v?new Zb(Zb.OWNER):new Zte(n.name,n.options,e);XU("Invalid Firebase Database URL",u),vi(u.path)||Sd("Database URL must point to the root of a Firebase Database (not including a child path).");const R=function Zre(n,e,t,i){let r=VP[e.name];r||(r={},VP[e.name]=r);let s=r[n.toURLString()];return s&&Sd("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new dre(n,_5,t,i),r[n.toURLString()]=s,s}(m,n,S,new qte(n.name,t));return new Kre(R,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),po(b3,"0.14.4",n),po(b3,"0.14.4","esm2017")}();var toe=pi(782),jP=pi.n(toe);let _0=(()=>{class n{constructor(t){this.auth=t,this.confirmationResult=null,this.db=UP(),this.confirmationResult=null}guardarCita(t){var i=this;return Ie(function*(){const r=zP(i.db,"citas");if(!t.hora)throw new Error("La cita debe tener una fecha y hora");const s=function $re(n,...e){let t=Ho(n);for(const i of e)t=i._apply(t);return t}(r,function Nre(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return MP("orderByChild","path",n,!1),new Lre(n)}("hora"),function jre(n,e){return function(n,e,t,i){if(!(i&&void 0===t||FE(t)))throw new Error(mm(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}("equalTo","key",e,!0),new Ure(n,e)}(t.hora));try{if((yield kre(s)).exists())throw jP().fire({icon:"error",title:"Error",text:"Fecha y hora no disponibles"}),new Error("La cita ya existe");return function Mre(n,e){n=Ho(n),kd("push",n._path),Md("push",e,n._path,!0);const t=t5(n._repo),i=Sre(t),r=q_(n,i),s=q_(n,i);let u;return u=null!=e?function f5(n,e){n=Ho(n),kd("set",n._path),Md("set",e,n._path,!1);const t=new hm;return RP(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}(s,e).then(()=>s):Promise.resolve(s),r.then=u.then.bind(u),r.catch=u.then.bind(u,void 0),r}(r,t)}catch(u){throw console.error("Error al guardar la cita",u),u}})()}registrar({email:t,password:i}){return Ste(this.auth,t,i)}login({email:t,password:i}){return Mte(this.auth,t,i)}loginWithGoogle(){return Rte(this.auth,new wJ)}enviarCodigoSMS(t,i){return kte(this.auth,t,i).then(r=>{this.confirmationResult=r}).catch(r=>{console.error("Error al enviar el c\xf3digo SMS",r)})}verificarCodigoSMS(t){return this.confirmationResult?this.confirmationResult.confirm(t).then(i=>i.user).catch(i=>{console.error("Error al verificar el c\xf3digo SMS",i)}):(console.error("No se ha enviado ning\xfan c\xf3digo de verificaci\xf3n SMS"),Promise.reject("No se ha enviado ning\xfan c\xf3digo de verificaci\xf3n SMS"))}logout(){return Pte(this.auth)}}return n.\u0275fac=function(t){return new(t||n)(lt(aE))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function fn(...n){return hr(n,ii(n))}class $u extends si{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const HE=$e(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:noe}=Array,{getPrototypeOf:ioe,prototype:roe,keys:ooe}=Object;function v5(n){if(1===n.length){const e=n[0];if(noe(e))return{args:e,keys:null};if(function soe(n){return n&&"object"==typeof n&&ioe(n)===roe}(e)){const t=ooe(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:aoe}=Array;function $P(n){return cn(e=>function loe(n,e){return aoe(e)?n(...e):n(e)}(n,e))}function b5(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function HP(...n){const e=ii(n),t=on(n),{args:i,keys:r}=v5(n);if(0===i.length)return hr([],e);const s=new xn(function coe(n,e,t=Lr){return i=>{x5(e,()=>{const{length:r}=n,s=new Array(r);let u=r,m=r;for(let v=0;v<r;v++)x5(e,()=>{const C=hr(n[v],e);let S=!1;C.subscribe(zn(i,R=>{s[v]=R,S||(S=!0,m--),m||i.next(t(s.slice()))},()=>{--u||i.complete()}))},i)},i)}}(i,e,r?u=>b5(r,u):Lr));return t?s.pipe($P(t)):s}function x5(n,e,t){n?rt(t,n,e):e()}function Z_(...n){return function uoe(){return jt(1)}()(hr(n,ii(n)))}function GE(n){return new xn(e=>{W(n()).subscribe(e)})}function zm(n,e){const t=Vt(n)?n:()=>n,i=r=>r.error(t());return new xn(e?r=>e.schedule(i,0,r):i)}function GP(){return ti((n,e)=>{let t=null;n._refCount++;const i=zn(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class WP extends xn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ns(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ze;const t=this.getSubject();e.add(this.source.subscribe(zn(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ze.EMPTY)}return e}refCount(){return GP()(this)}}function Dl(n,e){return ti((t,i)=>{let r=null,s=0,u=!1;const m=()=>u&&!r&&i.complete();t.subscribe(zn(i,v=>{r?.unsubscribe();let C=0;const S=s++;W(n(v,S)).subscribe(r=zn(i,R=>i.next(e?e(v,R,S,C++):R),()=>{r=null,m()}))},()=>{u=!0,m()}))})}function _a(n){return n<=0?()=>zt:ti((e,t)=>{let i=0;e.subscribe(zn(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function qP(...n){const e=ii(n);return ti((t,i)=>{(e?Z_(n,t,e):Z_(n,t)).subscribe(i)})}function Fs(n,e){return ti((t,i)=>{let r=0;t.subscribe(zn(i,s=>n.call(e,s,r++)&&i.next(s)))})}function WE(n){return ti((e,t)=>{let i=!1;e.subscribe(zn(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function w5(n=doe){return ti((e,t)=>{let i=!1;e.subscribe(zn(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function doe(){return new HE}function Qf(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Fs((r,s)=>n(r,s,i)):Lr,_a(1),t?WE(e):w5(()=>new HE))}function Jf(n,e){return Vt(e)?tt(n,e,1):tt(n,1)}function Rh(n){return ti((e,t)=>{let s,i=null,r=!1;i=e.subscribe(zn(t,void 0,void 0,u=>{s=W(n(u,Rh(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function E5(n,e){return ti(function hoe(n,e,t,i,r){return(s,u)=>{let m=t,v=e,C=0;s.subscribe(zn(u,S=>{const R=C++;v=m?n(v,S,R):(m=!0,S),i&&u.next(v)},r&&(()=>{m&&u.next(v),u.complete()})))}}(n,e,arguments.length>=2,!0))}function ZP(n){return n<=0?()=>zt:ti((e,t)=>{let i=[];e.subscribe(zn(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function C5(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Fs((r,s)=>n(r,s,i)):Lr,ZP(1),t?WE(e):w5(()=>new HE))}function T5(n){return cn(()=>n)}function qE(n){return ti((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const ei="primary",y0=Symbol("RouteTitle");class poe{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Y_(n){return new poe(n)}function moe(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const u=i[s],m=n[s];if(u.startsWith(":"))r[u.substring(1)]=m;else if(u!==m.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Rd(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!I5(n[r],e[r]))return!1;return!0}function I5(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function D5(n){return Array.prototype.concat.apply([],n)}function S5(n){return n.length>0?n[n.length-1]:null}function Xs(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function ep(n){return Qr(n)?n:Xr(n)?hr(Promise.resolve(n)):fn(n)}const ZE=!1,_oe={exact:function k5(n,e,t){if(!Vm(n.segments,e.segments)||!YE(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!k5(n.children[i],e.children[i],t))return!1;return!0},subset:R5},A5={exact:function yoe(n,e){return Rd(n,e)},subset:function voe(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>I5(n[t],e[t]))},ignored:()=>!0};function M5(n,e,t){return _oe[t.paths](n.root,e.root,t.matrixParams)&&A5[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function R5(n,e,t){return P5(n,e,e.segments,t)}function P5(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Vm(r,t)||e.hasChildren()||!YE(r,t,i))}if(n.segments.length===t.length){if(!Vm(n.segments,t)||!YE(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!R5(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Vm(n.segments,r)&&YE(n.segments,r,i)&&n.children[ei])&&P5(n.children[ei],e,s,i)}}function YE(n,e,t){return e.every((i,r)=>A5[t](n[r].parameters,i.parameters))}class tp{constructor(e=new bi([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y_(this.queryParams)),this._queryParamMap}toString(){return woe.serialize(this)}}class bi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Xs(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return KE(this)}}class v0{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Y_(this.parameters)),this._parameterMap}toString(){return L5(this)}}function Vm(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let b0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return new YP},providedIn:"root"}),n})();class YP{parse(e){const t=new koe(e);return new tp(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${x0(e.root,!0)}`,i=function Toe(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${XE(t)}=${XE(r)}`).join("&"):`${XE(t)}=${XE(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Eoe(n){return encodeURI(n)}(e.fragment)}`:""}`}}const woe=new YP;function KE(n){return n.segments.map(e=>L5(e)).join("/")}function x0(n,e){if(!n.hasChildren())return KE(n);if(e){const t=n.children[ei]?x0(n.children[ei],!1):"",i=[];return Xs(n.children,(r,s)=>{s!==ei&&i.push(`${s}:${x0(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function xoe(n,e){let t=[];return Xs(n.children,(i,r)=>{r===ei&&(t=t.concat(e(i,r)))}),Xs(n.children,(i,r)=>{r!==ei&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===ei?[x0(n.children[ei],!1)]:[`${r}:${x0(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[ei]?`${KE(n)}/${t[0]}`:`${KE(n)}/(${t.join("//")})`}}function O5(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function XE(n){return O5(n).replace(/%3B/gi,";")}function KP(n){return O5(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function QE(n){return decodeURIComponent(n)}function F5(n){return QE(n.replace(/\+/g,"%20"))}function L5(n){return`${KP(n.path)}${function Coe(n){return Object.keys(n).map(e=>`;${KP(e)}=${KP(n[e])}`).join("")}(n.parameters)}`}const Ioe=/^[^\/()?;=#]+/;function JE(n){const e=n.match(Ioe);return e?e[0]:""}const Doe=/^[^=?&#]+/,Aoe=/^[^&#]+/;class koe{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bi([],{}):new bi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[ei]=new bi(e,t)),i}parseSegment(){const e=JE(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ot(4009,ZE);return this.capture(e),new v0(QE(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=JE(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=JE(this.remaining);r&&(i=r,this.capture(i))}e[QE(t)]=QE(i)}parseQueryParam(e){const t=function Soe(n){const e=n.match(Doe);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const u=function Moe(n){const e=n.match(Aoe);return e?e[0]:""}(this.remaining);u&&(i=u,this.capture(i))}const r=F5(t),s=F5(i);if(e.hasOwnProperty(r)){let u=e[r];Array.isArray(u)||(u=[u],e[r]=u),u.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=JE(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ot(4010,ZE);let s;i.indexOf(":")>-1?(s=i.slice(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ei);const u=this.parseChildren();t[s]=1===Object.keys(u).length?u[ei]:new bi([],u),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ot(4011,ZE)}}function XP(n){return n.segments.length>0?new bi([],{[ei]:n}):n}function eC(n){const e={};for(const i of Object.keys(n.children)){const s=eC(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function Roe(n){if(1===n.numberOfChildren&&n.children[ei]){const e=n.children[ei];return new bi(n.segments.concat(e.segments),e.children)}return n}(new bi(n.segments,e))}function Um(n){return n instanceof tp}const QP=!1;function Poe(n,e,t,i,r){if(0===t.length)return K_(e.root,e.root,e.root,i,r);const s=function U5(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new V5(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,u)=>{if("object"==typeof s&&null!=s){if(s.outlets){const m={};return Xs(s.outlets,(v,C)=>{m[C]="string"==typeof v?v.split("/"):v}),[...r,{outlets:m}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===u?(s.split("/").forEach((m,v)=>{0==v&&"."===m||(0==v&&""===m?t=!0:".."===m?e++:""!=m&&r.push(m))}),r):[...r,s]},[]);return new V5(t,e,i)}(t);return s.toRoot()?K_(e.root,e.root,new bi([],{}),i,r):function u(v){const C=function Foe(n,e,t,i){if(n.isAbsolute)return new X_(e.root,!0,0);if(-1===i)return new X_(t,t===e.root,0);return function j5(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new ot(4005,QP&&"Invalid number of '../'");r=i.segments.length}return new X_(i,!1,r-s)}(t,i+(w0(n.commands[0])?0:1),n.numberOfDoubleDots)}(s,e,n.snapshot?._urlSegment,v),S=C.processChildren?Q_(C.segmentGroup,C.index,s.commands):JP(C.segmentGroup,C.index,s.commands);return K_(e.root,C.segmentGroup,S,i,r)}(n.snapshot?._lastPathIndex)}function w0(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function E0(n){return"object"==typeof n&&null!=n&&n.outlets}function K_(n,e,t,i,r){let u,s={};i&&Xs(i,(v,C)=>{s[C]=Array.isArray(v)?v.map(S=>`${S}`):`${v}`}),u=n===e?t:z5(n,e,t);const m=XP(eC(u));return new tp(m,s,r)}function z5(n,e,t){const i={};return Xs(n.children,(r,s)=>{i[s]=r===e?t:z5(r,e,t)}),new bi(n.segments,i)}class V5{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&w0(i[0]))throw new ot(4003,QP&&"Root segment cannot have matrix parameters");const r=i.find(E0);if(r&&r!==S5(i))throw new ot(4004,QP&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class X_{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function JP(n,e,t){if(n||(n=new bi([],{})),0===n.segments.length&&n.hasChildren())return Q_(n,e,t);const i=function Noe(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const u=n.segments[r],m=t[i];if(E0(m))break;const v=`${m}`,C=i<t.length-1?t[i+1]:null;if(r>0&&void 0===v)break;if(v&&C&&"object"==typeof C&&void 0===C.outlets){if(!H5(v,C,u))return s;i+=2}else{if(!H5(v,{},u))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new bi(n.segments.slice(0,i.pathIndex),{});return s.children[ei]=new bi(n.segments.slice(i.pathIndex),n.children),Q_(s,0,r)}return i.match&&0===r.length?new bi(n.segments,{}):i.match&&!n.hasChildren()?e2(n,e,t):i.match?Q_(n,0,r):e2(n,e,t)}function Q_(n,e,t){if(0===t.length)return new bi(n.segments,{});{const i=function Loe(n){return E0(n[0])?n[0].outlets:{[ei]:n}}(t),r={};if(!i[ei]&&n.children[ei]&&1===n.numberOfChildren&&0===n.children[ei].segments.length){const s=Q_(n.children[ei],e,t);return new bi(n.segments,s.children)}return Xs(i,(s,u)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[u]=JP(n.children[u],e,s))}),Xs(n.children,(s,u)=>{void 0===i[u]&&(r[u]=s)}),new bi(n.segments,r)}}function e2(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(E0(s)){const v=Boe(s.outlets);return new bi(i,v)}if(0===r&&w0(t[0])){i.push(new v0(n.segments[e].path,$5(t[0]))),r++;continue}const u=E0(s)?s.outlets[ei]:`${s}`,m=r<t.length-1?t[r+1]:null;u&&m&&w0(m)?(i.push(new v0(u,$5(m))),r+=2):(i.push(new v0(u,{})),r++)}return new bi(i,{})}function Boe(n){const e={};return Xs(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=e2(new bi([],{}),0,t))}),e}function $5(n){const e={};return Xs(n,(t,i)=>e[i]=`${t}`),e}function H5(n,e,t){return n==t.path&&Rd(e,t.parameters)}const C0="imperative";class Pd{constructor(e,t){this.id=e,this.url=t}}class t2 extends Pd{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class jm extends Pd{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class tC extends Pd{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nC extends Pd{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=16}}class n2 extends Pd{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class zoe extends Pd{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Voe extends Pd{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Uoe extends Pd{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class joe extends Pd{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $oe extends Pd{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hoe{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Goe{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Woe{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qoe{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Zoe{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yoe{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class G5{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let Qoe=(()=>{class n{createUrlTree(t,i,r,s,u,m){return Poe(t||i.root,r,s,u,m)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),ese=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(e){return Qoe.\u0275fac(e)},providedIn:"root"}),n})();class W5{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=r2(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=r2(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=o2(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return o2(e,this._root).map(t=>t.value)}}function r2(n,e){if(n===e.value)return e;for(const t of e.children){const i=r2(n,t);if(i)return i}return null}function o2(n,e){if(n===e.value)return[e];for(const t of e.children){const i=o2(n,t);if(i.length)return i.unshift(e),i}return[]}class Ph{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function J_(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class q5 extends W5{constructor(e,t){super(e),this.snapshot=t,s2(this,e)}toString(){return this.snapshot.toString()}}function Z5(n,e){const t=function tse(n,e){const u=new iC([],{},{},"",{},ei,e,null,n.root,-1,{});return new K5("",new Ph(u,[]))}(n,e),i=new $u([new v0("",{})]),r=new $u({}),s=new $u({}),u=new $u({}),m=new $u(""),v=new $m(i,r,u,m,s,ei,e,t.root);return v.snapshot=t.root,new q5(new Ph(v,[]),t)}class $m{constructor(e,t,i,r,s,u,m,v){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=u,this.component=m,this.title=this.data?.pipe(cn(C=>C[y0]))??fn(void 0),this._futureSnapshot=v}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(cn(e=>Y_(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(cn(e=>Y_(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Y5(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function nse(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class iC{get title(){return this.data?.[y0]}constructor(e,t,i,r,s,u,m,v,C,S,R){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=u,this.component=m,this.routeConfig=v,this._urlSegment=C,this._lastPathIndex=S,this._resolve=R}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Y_(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Y_(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class K5 extends W5{constructor(e,t){super(t),this.url=e,s2(this,t)}toString(){return X5(this._root)}}function s2(n,e){e.value._routerState=n,e.children.forEach(t=>s2(n,t))}function X5(n){const e=n.children.length>0?` { ${n.children.map(X5).join(", ")} } `:"";return`${n.value}${e}`}function a2(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Rd(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Rd(e.params,t.params)||n.params.next(t.params),function goe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Rd(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Rd(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function l2(n,e){const t=Rd(n.params,e.params)&&function boe(n,e){return Vm(n,e)&&n.every((t,i)=>Rd(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||l2(n.parent,e.parent))}function T0(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function rse(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return T0(n,i,r);return T0(n,i)})}(n,e,t);return new Ph(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const u=s.route;return u.value._futureSnapshot=e.value,u.children=e.children.map(m=>T0(n,m)),u}}const i=function ose(n){return new $m(new $u(n.url),new $u(n.params),new $u(n.queryParams),new $u(n.fragment),new $u(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>T0(n,s));return new Ph(i,r)}}const c2="ngNavigationCancelingError";function Q5(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Um(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=J5(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function J5(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[c2]=!0,i.cancellationCode=e,t&&(i.url=t),i}function ej(n){return tj(n)&&Um(n.url)}function tj(n){return n&&n[c2]}class sse{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new I0,this.attachRef=null}}let I0=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new sse,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rC=!1;let oC=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=ei,this.activateEvents=new Ir,this.deactivateEvents=new Ir,this.attachEvents=new Ir,this.detachEvents=new Ir,this.parentContexts=En(I0),this.location=En(Fu),this.changeDetector=En(mb),this.environmentInjector=En(wu)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ot(4012,rC);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ot(4012,rC);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ot(4012,rC);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ot(4013,rC);this._activatedRoute=t;const r=this.location,u=t.snapshot.component,m=this.parentContexts.getOrCreateContext(this.name).children,v=new ase(t,m,r.injector);if(i&&function lse(n){return!!n.resolveComponentFactory}(i)){const C=i.resolveComponentFactory(u);this.activated=r.createComponent(C,r.length,v)}else this.activated=r.createComponent(u,{index:r.length,injector:v,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=vn({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Fo]}),n})();class ase{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===$m?this.route:e===I0?this.childContexts:this.parent.get(e,t)}}let u2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["ng-component"]],standalone:!0,features:[OI],decls:1,vars:0,template:function(t,i){1&t&&St(0,"router-outlet")},dependencies:[oC],encapsulation:2}),n})();function nj(n,e){return n.providers&&!n._injector&&(n._injector=zw(n.providers,e,`Route: ${n.path}`)),n._injector??e}function h2(n){const e=n.children&&n.children.map(h2),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ei&&(t.component=u2),t}function Uc(n){return n.outlet||ei}function ij(n,e){const t=n.filter(i=>Uc(i)===e);return t.push(...n.filter(i=>Uc(i)!==e)),t}function D0(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class fse{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),a2(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=J_(t);e.children.forEach(s=>{const u=s.value.outlet;this.deactivateRoutes(s,r[u],i),delete r[u]}),Xs(r,(s,u)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const u=i.getContext(r.outlet);u&&this.deactivateChildRoutes(e,t,u.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=J_(e);for(const u of Object.keys(s))this.deactivateRouteAndItsChildren(s[u],r);if(i&&i.outlet){const u=i.outlet.detach(),m=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:u,route:e,contexts:m})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=J_(e);for(const u of Object.keys(s))this.deactivateRouteAndItsChildren(s[u],r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=J_(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new Yoe(s.value.snapshot))}),e.children.length&&this.forwardEvent(new qoe(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(a2(r),r===s)if(r.component){const u=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,u.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const u=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const m=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),u.children.onOutletReAttached(m.contexts),u.attachRef=m.componentRef,u.route=m.route.value,u.outlet&&u.outlet.attach(m.componentRef,m.route.value),a2(m.route.value),this.activateChildRoutes(e,null,u.children)}else{const m=D0(r.snapshot),v=m?.get(pd)??null;u.attachRef=null,u.route=r,u.resolver=v,u.injector=m,u.outlet&&u.outlet.activateWith(r,u.injector),this.activateChildRoutes(e,null,u.children)}}else this.activateChildRoutes(e,null,i)}}class rj{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class sC{constructor(e,t){this.component=e,this.route=t}}function pse(n,e,t){const i=n._root;return S0(i,e?e._root:null,t,[i.value])}function ey(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function hc(n){return null!==dc(n)}(n)?e.get(n):n:i}function S0(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=J_(e);return n.children.forEach(u=>{(function gse(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,u=e?e.value:null,m=t?t.getContext(n.value.outlet):null;if(u&&s.routeConfig===u.routeConfig){const v=function _se(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Vm(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Vm(n.url,e.url)||!Rd(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!l2(n,e)||!Rd(n.queryParams,e.queryParams);default:return!l2(n,e)}}(u,s,s.routeConfig.runGuardsAndResolvers);v?r.canActivateChecks.push(new rj(i)):(s.data=u.data,s._resolvedData=u._resolvedData),S0(n,e,s.component?m?m.children:null:t,i,r),v&&m&&m.outlet&&m.outlet.isActivated&&r.canDeactivateChecks.push(new sC(m.outlet.component,u))}else u&&A0(e,m,r),r.canActivateChecks.push(new rj(i)),S0(n,null,s.component?m?m.children:null:t,i,r)})(u,s[u.value.outlet],t,i.concat([u.value]),r),delete s[u.value.outlet]}),Xs(s,(u,m)=>A0(u,t.getContext(m),r)),r}function A0(n,e,t){const i=J_(n),r=n.value;Xs(i,(s,u)=>{A0(s,r.component?e?e.children.getContext(u):null:e,t)}),t.canDeactivateChecks.push(new sC(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function M0(n){return"function"==typeof n}function f2(n){return n instanceof HE||"EmptyError"===n?.name}const aC=Symbol("INITIAL_VALUE");function ty(){return Dl(n=>HP(n.map(e=>e.pipe(_a(1),qP(aC)))).pipe(cn(e=>{for(const t of e)if(!0!==t){if(t===aC)return aC;if(!1===t||t instanceof tp)return t}return!0}),Fs(e=>e!==aC),_a(1)))}function oj(n){return function Do(...n){return qo(n)}(Io(e=>{if(Um(e))throw Q5(0,e)}),cn(e=>!0===e))}const p2={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function sj(n,e,t,i,r){const s=m2(n,e,t);return s.matched?function Ose(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?fn(r.map(u=>{const m=ey(u,n);return ep(function Ese(n){return n&&M0(n.canMatch)}(m)?m.canMatch(e,t):n.runInContext(()=>m(e,t)))})).pipe(ty(),oj()):fn(!0)}(i=nj(e,i),e,t).pipe(cn(u=>!0===u?s:{...p2})):fn(s)}function m2(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...p2}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(e.matcher||moe)(t,n,e);if(!r)return{...p2};const s={};Xs(r.posParams,(m,v)=>{s[v]=m.path});const u=r.consumed.length>0?{...s,...r.consumed[r.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:u,positionalParamSegments:r.posParams??{}}}function lC(n,e,t,i){if(t.length>0&&function Nse(n,e,t){return t.some(i=>cC(n,e,i)&&Uc(i)!==ei)}(n,t,i)){const s=new bi(e,function Lse(n,e,t,i){const r={};r[ei]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Uc(s)!==ei){const u=new bi([],{});u._sourceSegment=n,u._segmentIndexShift=e.length,r[Uc(s)]=u}return r}(n,e,i,new bi(t,n.children)));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:[]}}if(0===t.length&&function Bse(n,e,t){return t.some(i=>cC(n,e,i))}(n,t,i)){const s=new bi(n.segments,function Fse(n,e,t,i,r){const s={};for(const u of i)if(cC(n,t,u)&&!r[Uc(u)]){const m=new bi([],{});m._sourceSegment=n,m._segmentIndexShift=e.length,s[Uc(u)]=m}return{...r,...s}}(n,e,t,i,n.children));return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}const r=new bi(n.segments,n.children);return r._sourceSegment=n,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:t}}function cC(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function aj(n,e,t,i){return!!(Uc(n)===i||i!==ei&&cC(e,t,n))&&("**"===n.path||m2(e,n,t).matched)}function lj(n,e,t){return 0===e.length&&!n.children[t]}const uC=!1;class dC{constructor(e){this.segmentGroup=e||null}}class cj{constructor(e){this.urlTree=e}}function k0(n){return zm(new dC(n))}function uj(n){return zm(new cj(n))}class jse{constructor(e,t,i,r,s){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0}apply(){const e=lC(this.urlTree.root,[],[],this.config).segmentGroup,t=new bi(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,ei).pipe(cn(s=>this.createUrlTree(eC(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Rh(s=>{if(s instanceof cj)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof dC?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,ei).pipe(cn(r=>this.createUrlTree(eC(r),e.queryParams,e.fragment))).pipe(Rh(r=>{throw r instanceof dC?this.noMatchError(r):r}))}noMatchError(e){return new ot(4002,uC)}createUrlTree(e,t,i){const r=XP(e);return new tp(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(cn(s=>new bi([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return hr(r).pipe(Jf(s=>{const u=i.children[s],m=ij(t,s);return this.expandSegmentGroup(e,m,u,s).pipe(cn(v=>({segment:v,outlet:s})))}),E5((s,u)=>(s[u.outlet]=u.segment,s),{}),C5())}expandSegment(e,t,i,r,s,u){return hr(i).pipe(Jf(m=>this.expandSegmentAgainstRoute(e,t,i,m,r,s,u).pipe(Rh(C=>{if(C instanceof dC)return fn(null);throw C}))),Qf(m=>!!m),Rh((m,v)=>{if(f2(m))return lj(t,r,s)?fn(new bi([],{})):k0(t);throw m}))}expandSegmentAgainstRoute(e,t,i,r,s,u,m){return aj(r,t,s,u)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,u):m&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,u):k0(t):k0(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,u){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,u):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,u)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?uj(s):this.lineralizeSegments(i,s).pipe(tt(u=>{const m=new bi(u,{});return this.expandSegment(e,m,t,u,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,u){const{matched:m,consumedSegments:v,remainingSegments:C,positionalParamSegments:S}=m2(t,r,s);if(!m)return k0(t);const R=this.applyRedirectCommands(v,r.redirectTo,S);return r.redirectTo.startsWith("/")?uj(R):this.lineralizeSegments(r,R).pipe(tt(j=>this.expandSegment(e,t,i,j.concat(C),u,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){return"**"===i.path?(e=nj(i,e),i.loadChildren?(i._loadedRoutes?fn({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(cn(m=>(i._loadedRoutes=m.routes,i._loadedInjector=m.injector,new bi(r,{})))):fn(new bi(r,{}))):sj(t,i,r,e).pipe(Dl(({matched:u,consumedSegments:m,remainingSegments:v})=>u?this.getChildConfig(e=i._injector??e,i,r).pipe(tt(S=>{const R=S.injector??e,j=S.routes,{segmentGroup:K,slicedSegments:ie}=lC(t,m,v,j),we=new bi(K.segments,K.children);if(0===ie.length&&we.hasChildren())return this.expandChildren(R,j,we).pipe(cn(Qe=>new bi(m,Qe)));if(0===j.length&&0===ie.length)return fn(new bi(m,{}));const Oe=Uc(i)===s;return this.expandSegment(R,we,j,ie,Oe?ei:s,!0).pipe(cn(_t=>new bi(m.concat(_t.segments),_t.children)))})):k0(t)))}getChildConfig(e,t,i){return t.children?fn({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?fn({routes:t._loadedRoutes,injector:t._loadedInjector}):function Pse(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?fn(!0):fn(r.map(u=>{const m=ey(u,n);return ep(function vse(n){return n&&M0(n.canLoad)}(m)?m.canLoad(e,t):n.runInContext(()=>m(e,t)))})).pipe(ty(),oj())}(e,t,i).pipe(tt(r=>r?this.configLoader.loadChildren(e,t).pipe(Io(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Vse(n){return zm(J5(uC,3))}())):fn({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return fn(i);if(r.numberOfChildren>1||!r.children[ei])return e.redirectTo,zm(new ot(4e3,uC));r=r.children[ei]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new tp(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Xs(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const m=r.substring(1);i[s]=t[m]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let u={};return Xs(t.children,(m,v)=>{u[v]=this.createSegmentGroup(e,m,i,r)}),new bi(s,u)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ot(4001,uC);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class Hse{}class qse{constructor(e,t,i,r,s,u,m){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=s,this.paramsInheritanceStrategy=u,this.urlSerializer=m}recognize(){const e=lC(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,ei).pipe(cn(t=>{if(null===t)return null;const i=new iC([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ei,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ph(i,t),s=new K5(this.url,r);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(e){const t=e.value,i=Y5(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return hr(Object.keys(i.children)).pipe(Jf(r=>{const s=i.children[r],u=ij(t,r);return this.processSegmentGroup(e,u,s,r)}),E5((r,s)=>r&&s?(r.push(...s),r):null),function foe(n,e=!1){return ti((t,i)=>{let r=0;t.subscribe(zn(i,s=>{const u=n(s,r++);(u||e)&&i.next(s),!u&&i.complete()}))})}(r=>null!==r),WE(null),C5(),cn(r=>{if(null===r)return null;const s=hj(r);return function Zse(n){n.sort((e,t)=>e.value.outlet===ei?-1:t.value.outlet===ei?1:e.value.outlet.localeCompare(t.value.outlet))}(s),s}))}processSegment(e,t,i,r,s){return hr(t).pipe(Jf(u=>this.processSegmentAgainstRoute(u._injector??e,u,i,r,s)),Qf(u=>!!u),Rh(u=>{if(f2(u))return lj(i,r,s)?fn([]):fn(null);throw u}))}processSegmentAgainstRoute(e,t,i,r,s){if(t.redirectTo||!aj(t,i,r,s))return fn(null);let u;if("**"===t.path){const m=r.length>0?S5(r).parameters:{},v=pj(i)+r.length;u=fn({snapshot:new iC(r,m,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mj(t),Uc(t),t.component??t._loadedComponent??null,t,fj(i),v,gj(t)),consumedSegments:[],remainingSegments:[]})}else u=sj(i,t,r,e).pipe(cn(({matched:m,consumedSegments:v,remainingSegments:C,parameters:S})=>{if(!m)return null;const R=pj(i)+v.length;return{snapshot:new iC(v,S,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,mj(t),Uc(t),t.component??t._loadedComponent??null,t,fj(i),R,gj(t)),consumedSegments:v,remainingSegments:C}}));return u.pipe(Dl(m=>{if(null===m)return fn(null);const{snapshot:v,consumedSegments:C,remainingSegments:S}=m;e=t._injector??e;const R=t._loadedInjector??e,j=function Yse(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:K,slicedSegments:ie}=lC(i,C,S,j.filter(Oe=>void 0===Oe.redirectTo));if(0===ie.length&&K.hasChildren())return this.processChildren(R,j,K).pipe(cn(Oe=>null===Oe?null:[new Ph(v,Oe)]));if(0===j.length&&0===ie.length)return fn([new Ph(v,[])]);const we=Uc(t)===s;return this.processSegment(R,j,K,ie,we?ei:s).pipe(cn(Oe=>null===Oe?null:[new Ph(v,Oe)]))}))}}function Kse(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function hj(n){const e=[],t=new Set;for(const i of n){if(!Kse(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=hj(i.children);e.push(new Ph(i.value,r))}return e.filter(i=>!t.has(i))}function fj(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function pj(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function mj(n){return n.data||{}}function gj(n){return n.resolve||{}}function _j(n){return"string"==typeof n.title||null===n.title}function g2(n){return Dl(e=>{const t=n(e);return t?hr(t).pipe(cn(()=>e)):fn(e)})}const ny=new Ct("ROUTES");let _2=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=En(HL)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return fn(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=ep(t.loadComponent()).pipe(cn(vj),Io(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),qE(()=>{this.componentLoaders.delete(t)})),r=new WP(i,()=>new si).pipe(GP());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return fn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const s=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(cn(m=>{this.onLoadEndListener&&this.onLoadEndListener(i);let v,C,S=!1;Array.isArray(m)?C=m:(v=m.create(t).injector,C=D5(v.get(ny,[],hn.Self|hn.Optional)));return{routes:C.map(h2),injector:v}}),qE(()=>{this.childrenLoaders.delete(i)})),u=new WP(s,()=>new si).pipe(GP());return this.childrenLoaders.set(i,u),u}loadModuleFactoryOrRoutes(t){return ep(t()).pipe(cn(vj),tt(i=>i instanceof eL||Array.isArray(i)?fn(i):hr(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function vj(n){return function rae(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let fC=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new si,this.configLoader=En(_2),this.environmentInjector=En(wu),this.urlSerializer=En(b0),this.rootContexts=En(I0),this.navigationId=0,this.afterPreactivation=()=>fn(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=r=>this.events.next(new Goe(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Hoe(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new $u({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:C0,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Fs(i=>0!==i.id),cn(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Dl(i=>{let r=!1,s=!1;return fn(i).pipe(Io(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Dl(u=>{const m=t.browserUrlTree.toString(),v=!t.navigated||u.extractedUrl.toString()!==m||m!==t.currentUrlTree.toString();if(!v&&"reload"!==(u.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const S="";return this.events.next(new nC(u.id,t.serializeUrl(i.rawUrl),S,0)),t.rawUrlTree=u.rawUrl,u.resolve(null),zt}if(t.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return bj(u.source)&&(t.browserUrlTree=u.extractedUrl),fn(u).pipe(Dl(S=>{const R=this.transitions?.getValue();return this.events.next(new t2(S.id,this.urlSerializer.serialize(S.extractedUrl),S.source,S.restoredState)),R!==this.transitions?.getValue()?zt:Promise.resolve(S)}),function $se(n,e,t,i){return Dl(r=>function Use(n,e,t,i,r){return new jse(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(cn(s=>({...r,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),Io(S=>{this.currentNavigation={...this.currentNavigation,finalUrl:S.urlAfterRedirects},i.urlAfterRedirects=S.urlAfterRedirects}),function Qse(n,e,t,i,r){return tt(s=>function Wse(n,e,t,i,r,s,u="emptyOnly"){return new qse(n,e,t,i,r,u,s).recognize().pipe(Dl(m=>null===m?function Gse(n){return new xn(e=>e.error(n))}(new Hse):fn(m)))}(n,e,t,s.urlAfterRedirects,i.serialize(s.urlAfterRedirects),i,r).pipe(cn(u=>({...s,targetSnapshot:u}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),Io(S=>{if(i.targetSnapshot=S.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!S.extras.skipLocationChange){const j=t.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl);t.setBrowserUrl(j,S)}t.browserUrlTree=S.urlAfterRedirects}const R=new zoe(S.id,this.urlSerializer.serialize(S.extractedUrl),this.urlSerializer.serialize(S.urlAfterRedirects),S.targetSnapshot);this.events.next(R)}));if(v&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:S,extractedUrl:R,source:j,restoredState:K,extras:ie}=u,we=new t2(S,this.urlSerializer.serialize(R),j,K);this.events.next(we);const Oe=Z5(R,this.rootComponentType).snapshot;return fn(i={...u,targetSnapshot:Oe,urlAfterRedirects:R,extras:{...ie,skipLocationChange:!1,replaceUrl:!1}})}{const S="";return this.events.next(new nC(u.id,t.serializeUrl(i.extractedUrl),S,1)),t.rawUrlTree=u.rawUrl,u.resolve(null),zt}}),Io(u=>{const m=new Voe(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(m)}),cn(u=>i={...u,guards:pse(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),function Tse(n,e){return tt(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:u}}=t;return 0===u.length&&0===s.length?fn({...t,guardsResult:!0}):function Ise(n,e,t,i){return hr(n).pipe(tt(r=>function Rse(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?fn(s.map(m=>{const v=D0(e)??r,C=ey(m,v);return ep(function wse(n){return n&&M0(n.canDeactivate)}(C)?C.canDeactivate(n,e,t,i):v.runInContext(()=>C(n,e,t,i))).pipe(Qf())})).pipe(ty()):fn(!0)}(r.component,r.route,t,e,i)),Qf(r=>!0!==r,!0))}(u,i,r,n).pipe(tt(m=>m&&function yse(n){return"boolean"==typeof n}(m)?function Dse(n,e,t,i){return hr(e).pipe(Jf(r=>Z_(function Ase(n,e){return null!==n&&e&&e(new Woe(n)),fn(!0)}(r.route.parent,i),function Sse(n,e){return null!==n&&e&&e(new Zoe(n)),fn(!0)}(r.route,i),function kse(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(u=>function mse(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(u)).filter(u=>null!==u).map(u=>GE(()=>fn(u.guards.map(v=>{const C=D0(u.node)??t,S=ey(v,C);return ep(function xse(n){return n&&M0(n.canActivateChild)}(S)?S.canActivateChild(i,n):C.runInContext(()=>S(i,n))).pipe(Qf())})).pipe(ty())));return fn(s).pipe(ty())}(n,r.path,t),function Mse(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return fn(!0);const r=i.map(s=>GE(()=>{const u=D0(e)??t,m=ey(s,u);return ep(function bse(n){return n&&M0(n.canActivate)}(m)?m.canActivate(e,n):u.runInContext(()=>m(e,n))).pipe(Qf())}));return fn(r).pipe(ty())}(n,r.route,t))),Qf(r=>!0!==r,!0))}(i,s,n,e):fn(m)),cn(m=>({...t,guardsResult:m})))})}(this.environmentInjector,u=>this.events.next(u)),Io(u=>{if(i.guardsResult=u.guardsResult,Um(u.guardsResult))throw Q5(0,u.guardsResult);const m=new Uoe(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(m)}),Fs(u=>!!u.guardsResult||(t.restoreHistory(u),this.cancelNavigationTransition(u,"",3),!1)),g2(u=>{if(u.guards.canActivateChecks.length)return fn(u).pipe(Io(m=>{const v=new joe(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}),Dl(m=>{let v=!1;return fn(m).pipe(function Jse(n,e){return tt(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return fn(t);let s=0;return hr(r).pipe(Jf(u=>function eae(n,e,t,i){const r=n.routeConfig,s=n._resolve;return void 0!==r?.title&&!_j(r)&&(s[y0]=r.title),function tae(n,e,t,i){const r=function nae(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return fn({});const s={};return hr(r).pipe(tt(u=>function iae(n,e,t,i){const r=D0(e)??i,s=ey(n,r);return ep(s.resolve?s.resolve(e,t):r.runInContext(()=>s(e,t)))}(n[u],e,t,i).pipe(Qf(),Io(m=>{s[u]=m}))),ZP(1),T5(s),Rh(u=>f2(u)?zt:zm(u)))}(s,n,e,i).pipe(cn(u=>(n._resolvedData=u,n.data=Y5(n,t).resolve,r&&_j(r)&&(n.data[y0]=r.title),null)))}(u.route,i,n,e)),Io(()=>s++),ZP(1),tt(u=>s===r.length?fn(t):zt))})}(t.paramsInheritanceStrategy,this.environmentInjector),Io({next:()=>v=!0,complete:()=>{v||(t.restoreHistory(m),this.cancelNavigationTransition(m,"",2))}}))}),Io(m=>{const v=new $oe(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(v)}))}),g2(u=>{const m=v=>{const C=[];v.routeConfig?.loadComponent&&!v.routeConfig._loadedComponent&&C.push(this.configLoader.loadComponent(v.routeConfig).pipe(Io(S=>{v.component=S}),cn(()=>{})));for(const S of v.children)C.push(...m(S));return C};return HP(m(u.targetSnapshot.root)).pipe(WE(),_a(1))}),g2(()=>this.afterPreactivation()),cn(u=>{const m=function ise(n,e,t){const i=T0(n,e._root,t?t._root:void 0);return new q5(i,e)}(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return i={...u,targetRouterState:m}}),Io(u=>{t.currentUrlTree=u.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(u.urlAfterRedirects,u.rawUrl),t.routerState=u.targetRouterState,"deferred"===t.urlUpdateStrategy&&(u.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,u),t.browserUrlTree=u.urlAfterRedirects)}),((n,e,t)=>cn(i=>(new fse(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u)),_a(1),Io({next:u=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new jm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{r=!0}}),qE(()=>{r||s||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Rh(u=>{if(s=!0,tj(u)){ej(u)||(t.navigated=!0,t.restoreHistory(i,!0));const m=new tC(i.id,this.urlSerializer.serialize(i.extractedUrl),u.message,u.cancellationCode);if(this.events.next(m),ej(u)){const v=t.urlHandlingStrategy.merge(u.url,t.rawUrlTree),C={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||bj(i.source)};t.scheduleNavigation(v,C0,null,C,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const m=new n2(i.id,this.urlSerializer.serialize(i.extractedUrl),u,i.targetSnapshot??void 0);this.events.next(m);try{i.resolve(t.errorHandler(u))}catch(v){i.reject(v)}}return zt}))}))}cancelNavigationTransition(t,i,r){const s=new tC(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(s),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function bj(n){return n!==C0}let xj=(()=>{class n{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(s=>s.outlet===ei);return i}getResolvedTitleForRoute(t){return t.data[y0]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return En(oae)},providedIn:"root"}),n})(),oae=(()=>{class n extends xj{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(lt(uB))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),sae=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return En(lae)},providedIn:"root"}),n})();class aae{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let lae=(()=>{class n extends aae{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=No(n)))(i||n)}}(),n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const pC=new Ct("",{providedIn:"root",factory:()=>({})});let uae=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:function(){return En(dae)},providedIn:"root"}),n})(),dae=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hae(n){throw n}function fae(n,e,t){return e.parse("/")}const pae={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mae={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Qs=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=En(R8),this.isNgZoneEnabled=!1,this.options=En(pC,{optional:!0})||{},this.errorHandler=this.options.errorHandler||hae,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||fae,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=En(uae),this.routeReuseStrategy=En(sae),this.urlCreationStrategy=En(ese),this.titleStrategy=En(xj),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=D5(En(ny,{optional:!0})??[]),this.navigationTransitions=En(fC),this.urlSerializer=En(b0),this.location=En(Kw),this.isNgZoneEnabled=En(Ti)instanceof Ti&&Ti.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new tp,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Z5(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),C0,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,r){const s={replaceUrl:!0},u=r?.navigationId?r:null;if(r){const v={...r};delete v.navigationId,delete v.\u0275routerPageId,0!==Object.keys(v).length&&(s.state=v)}const m=this.parseUrl(t);this.scheduleNavigation(m,i,u,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(h2),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:u,queryParamsHandling:m,preserveFragment:v}=i,C=v?this.currentUrlTree.fragment:u;let S=null;switch(m){case"merge":S={...this.currentUrlTree.queryParams,...s};break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=s||null}return null!==S&&(S=this.removeEmptyProps(S)),this.urlCreationStrategy.createUrlTree(r,this.routerState,this.currentUrlTree,t,S,C??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Um(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,C0,null,i)}navigate(t,i={skipLocationChange:!1}){return function gae(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new ot(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?{...pae}:!1===i?{...mae}:i,Um(t))return M5(this.currentUrlTree,t,r);const s=this.parseUrl(t);return M5(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}scheduleNavigation(t,i,r,s,u){if(this.disposed)return Promise.resolve(!1);let m,v,C,S;return u?(m=u.resolve,v=u.reject,C=u.promise):C=new Promise((R,j)=>{m=R,v=j}),S="computed"===this.canceledNavigationResolution?r&&r.\u0275routerPageId?r.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:S,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:m,reject:v,promise:C,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),C.catch(R=>Promise.reject(R))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const u={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",u)}else{const s={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.go(r,"",s)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-(this.browserPageId??this.currentPageId);0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),iy=(()=>{class n{constructor(t,i,r,s,u,m){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=s,this.el=u,this.locationStrategy=m,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new si;const v=u.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===v||"area"===v,this.isAnchorElement?this.subscription=t.events.subscribe(C=>{C instanceof jm&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=v_(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=v_(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=v_(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,r,s,u){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||r||s||u||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function bf(n,e,t){return function UT(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?$p:av}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const r=this.renderer,s=this.el.nativeElement;null!==i?r.setAttribute(s,t,i):r.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(nt(Qs),nt($m),function Tp(n){return function sd(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(kt(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Wr(),n)}("tabindex"),nt(Cu),nt(Kr),nt(dm))},n.\u0275dir=vn({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){1&t&&$t("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&t&&dt("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Fo]}),n})();class wj{}let vae=(()=>{class n{constructor(t,i,r,s,u){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=u}setUpPreloading(){this.subscription=this.router.events.pipe(Fs(t=>t instanceof jm),Jf(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i){s.providers&&!s._injector&&(s._injector=zw(s.providers,t,`Route: ${s.path}`));const u=s._injector??t,m=s._loadedInjector??u;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&r.push(this.preloadConfig(u,s)),(s.children||s._loadedRoutes)&&r.push(this.processRoutes(m,s.children??s._loadedRoutes))}return hr(r).pipe(jt())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):fn(null);const s=r.pipe(tt(u=>null===u?fn(void 0):(i._loadedRoutes=u.routes,i._loadedInjector=u.injector,this.processRoutes(u.injector??t,u.routes))));return i.loadComponent&&!i._loadedComponent?hr([s,this.loader.loadComponent(i)]).pipe(jt()):s})}}return n.\u0275fac=function(t){return new(t||n)(lt(Qs),lt(HL),lt(wu),lt(wj),lt(_2))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const v2=new Ct("");let Ej=(()=>{class n{constructor(t,i,r,s,u={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=s,this.options=u,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},u.scrollPositionRestoration=u.scrollPositionRestoration||"disabled",u.anchorScrolling=u.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof t2?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof jm&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof G5&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new G5(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){!function ch(){throw new Error("invalid")}()},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();var Ql=(()=>((Ql=Ql||{})[Ql.COMPLETE=0]="COMPLETE",Ql[Ql.FAILED=1]="FAILED",Ql[Ql.REDIRECTING=2]="REDIRECTING",Ql))();const ry=!1;function np(n,e){return{\u0275kind:n,\u0275providers:e}}const b2=new Ct("",{providedIn:"root",factory:()=>!1});function Tj(){const n=En(Uo);return e=>{const t=n.get(cm);if(e!==t.components[0])return;const i=n.get(Qs),r=n.get(Ij);1===n.get(x2)&&i.initialNavigation(),n.get(Dj,null,hn.Optional)?.setUpPreloading(),n.get(v2,null,hn.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const Ij=new Ct(ry?"bootstrap done indicator":"",{factory:()=>new si}),x2=new Ct(ry?"initial navigation":"",{providedIn:"root",factory:()=>1});function Cae(){let n=[];return n=ry?[{provide:Hp,multi:!0,useFactory:()=>{const e=En(Qs);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function Koe(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],np(1,n)}const Dj=new Ct(ry?"router preloader":"");function Tae(n){return np(0,[{provide:Dj,useExisting:vae},{provide:wj,useExisting:n}])}const R0=!1,Sj=new Ct(R0?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),Iae=[Kw,{provide:b0,useClass:YP},Qs,I0,{provide:$m,useFactory:function Cj(n){return n.routerState.root},deps:[Qs]},_2,R0?{provide:b2,useValue:!0}:[]];function Dae(){return new QL("Router",Qs)}let Aj=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[Iae,R0&&i?.enableTracing?Cae().\u0275providers:[],{provide:ny,multi:!0,useValue:t},{provide:Sj,useFactory:kae,deps:[[Qs,new or,new Hl]]},{provide:pC,useValue:i||{}},i?.useHash?{provide:dm,useClass:bW}:{provide:dm,useClass:xN},{provide:v2,useFactory:()=>{const n=En(Bq),e=En(Ti),t=En(pC),i=En(fC),r=En(b0);return t.scrollOffset&&n.setOffset(t.scrollOffset),new Ej(r,i,n,e,t)}},i?.preloadingStrategy?Tae(i.preloadingStrategy).\u0275providers:[],{provide:QL,multi:!0,useFactory:Dae},i?.initialNavigation?Rae(i):[],[{provide:Mj,useFactory:Tj},{provide:XL,multi:!0,useExisting:Mj}]]}}static forChild(t){return{ngModule:n,providers:[{provide:ny,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(lt(Sj,8))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[u2]}),n})();function kae(n){if(R0&&n)throw new ot(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Rae(n){return["disabled"===n.initialNavigation?np(3,[{provide:fb,multi:!0,useFactory:()=>{const e=En(Qs);return()=>{e.setUpLocationChangeListener()}}},{provide:x2,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?np(2,[{provide:x2,useValue:0},{provide:fb,multi:!0,deps:[Uo],useFactory:e=>{const t=e.get(yW,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=e.get(Qs),s=e.get(Ij);(function bae(n,e){n.events.pipe(Fs(t=>t instanceof jm||t instanceof tC||t instanceof n2||t instanceof nC),cn(t=>t instanceof jm||t instanceof nC?Ql.COMPLETE:t instanceof tC&&(0===t.code||1===t.code)?Ql.REDIRECTING:Ql.FAILED),Fs(t=>t!==Ql.REDIRECTING),_a(1)).subscribe(()=>{e()})})(r,()=>{i(!0)}),e.get(fC).afterPreactivation=()=>(i(!0),s.closed?fn(void 0):s),r.initialNavigation()}))}}]).\u0275providers:[]]}const Mj=new Ct(R0?"Router Initializer":"");function Oae(n,e){1&n&&(pe(0,"a",20),Re(1,"Iniciar Sesion"),be())}function Fae(n,e){if(1&n){const t=function vr(){return gt()}();pe(0,"button",21),$t("click",function(){return function wp(n){return Tn.lFrame.contextLView=n,n[mr]}(t),function Qh(n){return Tn.lFrame.contextLView=null,n}(Qv().onClick())}),Re(1,"Cerrar Sesi\xf3n"),be()}}const Lae=function(n){return{"background-color":n}};let Nae=(()=>{class n{constructor(t,i){this.UserService=t,this.router=i,this.esAdmin=!1,this.auth=lE(),this.usuario=this.auth.currentUser,this.backgroundColor="#FFF5E4",this.prevBackgroundColor="",this.color="",this.searchTerm="",this.filteredItems=[],this.items=[{name:"item 1",description:"This is item 1"},{name:"item 2",description:"This is item 2"},{name:"item 3",description:"This is item 3"},{name:"item 4",description:"This is item 4"},{name:"item 5",description:"This is item 5"}]}changeColor(){"#FFF5E4"===this.backgroundColor?(this.prevBackgroundColor=this.backgroundColor,this.backgroundColor="#850E35"):this.backgroundColor=this.prevBackgroundColor,this.color="primary"===this.color?"accent":"primary"}validarusuario(){Ate(this.auth,t=>{t&&console.log("Usuario autenticado:",this.usuario),t||console.log("Usuario no identificado")}),this.validarusuario()}ngOnInit(){const t=lE();this.usuario=t.currentUser,this.usuario?(console.log("Usuario autenticado:",this.usuario),this.esAdmin="admin"===this.usuario.uid):console.log("Usuario no autenticado")}onClick(){this.UserService.logout().then(()=>{this.router.navigate(["/login"])}).catch(t=>{console.log(t)})}}return n.\u0275fac=function(t){return new(t||n)(nt(_0),nt(Qs))},n.\u0275cmp=pr({type:n,selectors:[["app-header"]],decls:31,vars:5,consts:[[3,"ngStyle"],[1,"header"],[1,"flex"],["routerLink","/",1,"logo"],["id","menu-btn",1,"fas","fa-bars"],[1,"navbar"],["routerLink","/"],["routerLink","login",4,"ngIf"],["class","btn btn-info",3,"click",4,"ngIf"],["routerLink","about"],["routerLink","registro"],["routerLink","contact"],["routerLink","questions"],["routerLink","galeria"],["routerLink","reservaciones"],["routerLink","habitacion-list"],["href","#ACC"],["src","../../assets/icons/accesibilidad.png","width","40px","height","40px","alt",""],[1,"example-button-row"],["mat-raised-button","","type","submit",1,"btn","btn-primary",3,"click"],["routerLink","login"],[1,"btn","btn-info",3,"click"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"section",1)(2,"div",2)(3,"a",3),Re(4,"Axolotl Palace"),be(),St(5,"div",4),be(),pe(6,"nav",5)(7,"a",6),Re(8,"Axolotl"),be(),Zn(9,Oae,2,0,"a",7),Zn(10,Fae,2,0,"button",8),pe(11,"a",9),Re(12,"Sobre Nosotros"),be(),pe(13,"a",10),Re(14,"Reserva"),be(),pe(15,"a",11),Re(16,"Contactanos"),be(),pe(17,"a",12),Re(18,"Preguntas frecuentes"),be(),pe(19,"a",13),Re(20,"Galeria"),be(),pe(21,"a",14),Re(22,"Reservaciones"),be(),pe(23,"a",15),Re(24,"Habitacion"),be(),pe(25,"a",16),St(26,"img",17),be(),pe(27,"div",18)(28,"button",19),$t("click",function(){return i.changeColor()}),Re(29,"Cambiar color"),be()()()(),St(30,"router-outlet"),be()),2&t&&(sn("ngStyle",Vw(3,Lae,i.backgroundColor)),oi(9),sn("ngIf",!i.usuario),oi(1),sn("ngIf",i.usuario))},dependencies:[TD,BN,oC,iy],styles:["button.active[_ngcontent-%COMP%] {\n   -shadowcsshost-no-combinator.active {\n  background-color: green;\n}\n }\n .example-label[_ngcontent-%COMP%] {\n  display: table-cell;\n  font-size: 14px;\n  margin-left: 8px;\n  min-width: 120px;\n}\n\n.example-button-row[_ngcontent-%COMP%] {\n  display: table-cell;\n  max-width: 600px;\n}\n\n.example-button-row[_ngcontent-%COMP%]   .mat-mdc-button-base[_ngcontent-%COMP%] {\n  margin: 8px 8px 8px 0;\n}\n\n.example-flex-container[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: space-between;\n  flex-wrap: wrap;\n}\n\n.example-button-container[_ngcontent-%COMP%] {\n  display: flex;\n  justify-content: center;\n  width: 120px;\n}\n.btn-primary[_ngcontent-%COMP%] {\n\t\t\tbackground-color: #850E35;\n\t\t\tborder-color: #850E35;\n\t\t\tfont-weight: bold;\n\t\t}\n\t\t\n\t\t.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus {\n\t\t\tbackground-color: #EE6983;\n\t\t\tborder-color: #EE6983;\n\t\t}"]}),n})(),Bae=(()=>{class n{constructor(){this.title="Reservaciones",this.comments=[],this.isActive=!1}onNewCommentAdded(t){console.log("Nuevo comentario agregado:",t)}ngOnInit(){g1().accessToken=pB_mapbox_accessToken,new(g1().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-74.5,40],zoom:9})}changeBackgroundColor(){this.isActive=!this.isActive}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&St(0,"app-header")},dependencies:[Nae],encapsulation:2}),n})(),zae=(()=>{class n{Hablar(){const t=document.getElementById("Titulo")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(t));const i=document.getElementById("Contenido")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(i));const r=document.getElementById("Contenido2")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(r))}Pausar(){speechSynthesis.pause()}Resumen(){speechSynthesis.resume()}EnlacesB(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="black",t.style.color="yellow",i.style.backgroundColor="black",i.style.color="yellow",r.style.backgroundColor="black",r.style.color="yellow"}EnlacesA(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="white",t.style.color="blue",i.style.backgroundColor="white",i.style.color="blue",r.style.backgroundColor="white",r.style.color="blue"}ContrasteA(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="black",t.style.color="yellow"}ContrasteB(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="white",t.style.color="black"}ZoomMas(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[5]}ZoomMenos(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[1]}ZoomNormal(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[3]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-home"]],decls:88,vars:0,consts:[["id","home",1,"home"],[1,"swiper","home-slider"],[1,"swiper-wrapper"],[1,"box","swiper-slide"],["src","../assets/images/home-img-1.jpg","alt",""],[1,"flex"],["src","../assets/images/home-img-2.jpg","alt",""],["src","../assets/images/home-img-3.jpg","alt",""],[1,"footer"],[1,"box-container"],[1,"box"],["href",""],[1,"fas","fa-phone"],["href","mailto:axolotl@paradise.com"],[1,"fas","fa-envelope"],["href","#"],[1,"fab","fa-facebook-f"],[1,"fab","fa-twitter"],[1,"fab","fa-instagram"],[1,"fab","fa-linkedin"],["id","ACC",2,"text-align","center","color","#850E35"],["type","button",2,"width","100px","margin","2px",3,"click"],["type","button",2,"width","150px","margin","2px",3,"click"],["type","button",2,"margin","2px",3,"click"],["href","#","type","button"]],template:function(t,i){1&t&&(pe(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3),St(4,"img",4),pe(5,"div",5)(6,"h3"),Re(7,"Habitaciones de lujo"),be()()(),pe(8,"div",3),St(9,"img",6),pe(10,"div",5)(11,"h3"),Re(12,"Entretenimiento"),be()()(),pe(13,"div",3),St(14,"img",7),pe(15,"div",5)(16,"h3"),Re(17,"Lujosas instalaciones"),be()()()()()(),pe(18,"section",8)(19,"div",9)(20,"div",10)(21,"a",11),St(22,"i",12),Re(23," +123-456-7890"),be(),pe(24,"a",11),St(25,"i",12),Re(26," +111-222-3333"),be(),pe(27,"a",13),St(28,"i",14),Re(29," Axolotl@paradise.com"),be()(),pe(30,"div",10)(31,"a",15),Re(32,"facebook "),St(33,"i",16),be(),pe(34,"a",15),Re(35,"twitter "),St(36,"i",17),be(),pe(37,"a",15),Re(38,"instagram "),St(39,"i",18),be(),pe(40,"a",15),Re(41,"linkedin "),St(42,"i",19),be()()()(),St(43,"br")(44,"br"),pe(45,"h5",20)(46,"h4"),Re(47," - Accesibilidad - "),be(),St(48,"br"),pe(49,"li")(50,"h6"),Re(51,"OPCIONES DE LECTOR DE VOZ:"),be(),pe(52,"button",21),$t("click",function(){return i.Hablar()}),Re(53,"Activar"),be(),pe(54,"button",21),$t("click",function(){return i.Pausar()}),Re(55,"Pausar"),be(),pe(56,"button",21),$t("click",function(){return i.Resumen()}),Re(57,"Continuar"),be()(),St(58,"br"),pe(59,"li")(60,"h6"),Re(61,"OPCIONES DE ZOOM:"),be(),pe(62,"button",21),$t("click",function(){return i.ZoomMas()}),Re(63," Zoom (+) "),be(),pe(64,"button",21),$t("click",function(){return i.ZoomNormal()}),Re(65," Sin Zoom "),be(),pe(66,"button",21),$t("click",function(){return i.ZoomMenos()}),Re(67," Zoom (-) "),be()(),St(68,"br"),pe(69,"li")(70,"h6"),Re(71,"OPCIONES DE ENLACES:"),be(),pe(72,"button",21),$t("click",function(){return i.EnlacesB()}),Re(73," Resaltar Enlaces "),be(),pe(74,"button",21),$t("click",function(){return i.EnlacesA()}),Re(75," Enlaces Normales "),be()(),St(76,"br"),pe(77,"li")(78,"h6"),Re(79,"OPCIONES DE CONTRASTE:"),be(),pe(80,"button",22),$t("click",function(){return i.ContrasteA()}),Re(81," Contraste Alto "),be(),pe(82,"button",23),$t("click",function(){return i.ContrasteB()}),Re(83," Contraste Normal "),be()(),St(84,"br"),pe(85,"li")(86,"a",24),Re(87,"Volver a Inicio"),be()()())},encapsulation:2}),n})(),Vae=(()=>{class n{ngOnInit(){g1().accessToken=pB_mapbox_accessToken,new(g1().Map)({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-74.5,40],zoom:9})}Hablar(){const t=document.getElementById("Titulo")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(t));const i=document.getElementById("Contenido")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(i));const r=document.getElementById("Contenido2")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(r))}Pausar(){speechSynthesis.pause()}Resumen(){speechSynthesis.resume()}EnlacesB(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="black",t.style.color="yellow",i.style.backgroundColor="black",i.style.color="yellow",r.style.backgroundColor="black",r.style.color="yellow"}EnlacesA(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="white",t.style.color="blue",i.style.backgroundColor="white",i.style.color="blue",r.style.backgroundColor="white",r.style.color="blue"}ContrasteA(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="black",t.style.color="yellow"}ContrasteB(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="white",t.style.color="black"}ZoomMas(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[5]}ZoomMenos(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[1]}ZoomNormal(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[3]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-about"]],decls:134,vars:0,consts:[[2,"margin","0","padding","0","font-family","Arial, sans-serif","background-color","#FFF5E4"],[1,"services"],[1,"box-container"],[1,"box"],["src","../../assets/images/icon-1.png","alt",""],["src","../../assets/images/icon-2.png","alt",""],["src","../../assets/images/icon-3.png","alt",""],["src","../../assets/images/icon-4.png","alt",""],["src","../../assets/images/icon-5.png","alt",""],["src","../../assets/images/icon-6.png","alt",""],[2,"text-align","center","color","#850E35"],[1,"container"],[1,"imagen-container"],["src","../../assets/images/Axolotl.jpeg","alt","Logo UAA",1,"imagen"],[1,"persona"],[1,"imagen",2,"background-image","url('../../assets/images/Carlos.jpeg')","height","300px"],[1,"info"],[1,"nombre"],[1,"apellido"],[1,"grado"],[1,"grupo"],[1,"carrera"],[1,"imagen",2,"background-image","url('../../assets/images/Daniel.jpeg')","height","300px"],[1,"imagen",2,"background-image","url('../../assets/images/Leo.jpeg')","height","300px"],["id","map",2,"width","400px","height","300px","margin","auto"],["type","button",2,"width","100px","margin","2px",3,"click"],["type","button",2,"width","150px","margin","2px",3,"click"],["type","button",2,"margin","2px",3,"click"],["href","#","type","button"]],template:function(t,i){1&t&&(pe(0,"body",0)(1,"section",1)(2,"div",2)(3,"div",3),St(4,"img",4),pe(5,"h3"),Re(6,"Buffet y Barra libre"),be(),pe(7,"p"),Re(8,"Todas las noches son de barra libre y buffet"),be()(),pe(9,"div",3),St(10,"img",5),pe(11,"h3"),Re(12,"Experiencia privada"),be(),pe(13,"p"),Re(14,"Nuestro staff puede llevarte comida a donde lo solicites"),be()(),pe(15,"div",3),St(16,"img",6),pe(17,"h3"),Re(18,"Vista a la playa"),be(),pe(19,"p"),Re(20,"Nuestra posicion privilegiada porporciona las mejores vistas"),be()(),pe(21,"div",3),St(22,"img",7),pe(23,"h3"),Re(24,"Fiesta tematica"),be(),pe(25,"p"),Re(26,"Reserva para hacer tus eventos aun mas especiales "),be()(),pe(27,"div",3),St(28,"img",8),pe(29,"h3"),Re(30,"Alberca"),be(),pe(31,"p"),Re(32,"Actividades y alberca disponile las 24 hrs"),be()(),pe(33,"div",3),St(34,"img",9),pe(35,"h3"),Re(36,"Resort privado"),be(),pe(37,"p"),Re(38,"COontamos con zona exclusiva en la playa"),be()()()(),pe(39,"h1",10),Re(40,"En Axolotl Palace, nuestra prioridad eres t\xfa: Vive como la realeza"),be(),pe(41,"div",11)(42,"div",12),St(43,"img",13),be()(),pe(44,"h2",10),Re(45,"PROYECTO UNIVERITARIO DE LA UAA"),be(),pe(46,"div",11)(47,"div",14),St(48,"div",15),pe(49,"div",16)(50,"div",17),Re(51,"Carlos Alberto"),be(),pe(52,"div",18),Re(53,"Zaragoza Cano"),be(),pe(54,"div",19),Re(55,"6to"),be(),pe(56,"div",20),Re(57,"C"),be(),pe(58,"div",21),Re(59,"Ingenier\xeda en Sistemas"),be()()(),pe(60,"div",14),St(61,"div",22),pe(62,"div",16)(63,"div",17),Re(64,"Carlos Daniel"),be(),pe(65,"div",18),Re(66,"De Lira Salas"),be(),pe(67,"div",19),Re(68,"6to"),be(),pe(69,"div",20),Re(70,"C"),be(),pe(71,"div",21),Re(72,"Ingenier\xeda en Sistemas"),be()()(),pe(73,"div",14),St(74,"div",23),pe(75,"div",16)(76,"div",17),Re(77,"Leonardo"),be(),pe(78,"div",18),Re(79,"Pedroza Gonzalez"),be(),pe(80,"div",19),Re(81,"6to"),be(),pe(82,"div",20),Re(83,"C"),be(),pe(84,"div",21),Re(85,"Ingenier\xeda en Sistemas"),be()()()(),pe(86,"h2",10),Re(87,"Nos ubicamos en:"),be(),St(88,"div",24)(89,"br")(90,"br"),pe(91,"h5",10)(92,"h4"),Re(93," - Accesibilidad - "),be(),St(94,"br"),pe(95,"li")(96,"h6"),Re(97,"OPCIONES DE LECTOR DE VOZ:"),be(),pe(98,"button",25),$t("click",function(){return i.Hablar()}),Re(99,"Activar"),be(),pe(100,"button",25),$t("click",function(){return i.Pausar()}),Re(101,"Pausar"),be(),pe(102,"button",25),$t("click",function(){return i.Resumen()}),Re(103,"Continuar"),be()(),St(104,"br"),pe(105,"li")(106,"h6"),Re(107,"OPCIONES DE ZOOM:"),be(),pe(108,"button",25),$t("click",function(){return i.ZoomMas()}),Re(109," Zoom (+) "),be(),pe(110,"button",25),$t("click",function(){return i.ZoomNormal()}),Re(111," Sin Zoom "),be(),pe(112,"button",25),$t("click",function(){return i.ZoomMenos()}),Re(113," Zoom (-) "),be()(),St(114,"br"),pe(115,"li")(116,"h6"),Re(117,"OPCIONES DE ENLACES:"),be(),pe(118,"button",25),$t("click",function(){return i.EnlacesB()}),Re(119," Resaltar Enlaces "),be(),pe(120,"button",25),$t("click",function(){return i.EnlacesA()}),Re(121," Enlaces Normales "),be()(),St(122,"br"),pe(123,"li")(124,"h6"),Re(125,"OPCIONES DE CONTRASTE:"),be(),pe(126,"button",26),$t("click",function(){return i.ContrasteA()}),Re(127," Contraste Alto "),be(),pe(128,"button",27),$t("click",function(){return i.ContrasteB()}),Re(129," Contraste Normal "),be()(),St(130,"br"),pe(131,"li")(132,"a",28),Re(133,"Volver a Inicio"),be()()()())},styles:[".container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:center;padding:30px}.imagen-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.persona[_ngcontent-%COMP%]{flex-basis:calc(33.33% - 20px);margin:10px;border-radius:5px;background-size:cover;background-position:center;color:#000}.persona[_ngcontent-%COMP%]{background-color:#ffc4c4}.imagen[_ngcontent-%COMP%]{width:100%;height:200px;border-top-left-radius:5px;border-top-right-radius:5px;background-size:cover;background-position:center;align-content:center}.info[_ngcontent-%COMP%]{padding:10px;text-align:center}.nombre[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-top:10px;margin-bottom:5px}.apellido[_ngcontent-%COMP%]{font-size:16px;margin-top:5px;margin-bottom:5px}.grado[_ngcontent-%COMP%], .grupo[_ngcontent-%COMP%], .carrera[_ngcontent-%COMP%]{font-size:14px;margin-top:5px;margin-bottom:5px}"]}),n})(),Uae=(()=>{class n{constructor(t){this.domSanitizer=t}transform(t,i){return this.domSanitizer.bypassSecurityTrustResourceUrl(i+t)}}return n.\u0275fac=function(t){return new(t||n)(nt(m1,16))},n.\u0275pipe=Br({name:"video",type:n,pure:!0}),n})(),jae=(()=>{class n{constructor(){this.video="4K6Sh1tsAW4"}Hablar(){const t=document.getElementById("Titulo")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(t));const i=document.getElementById("Contenido")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(i));const r=document.getElementById("Contenido2")?.innerHTML;speechSynthesis.speak(new SpeechSynthesisUtterance(r))}Pausar(){speechSynthesis.pause()}Resumen(){speechSynthesis.resume()}EnlacesB(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="black",t.style.color="yellow",i.style.backgroundColor="black",i.style.color="yellow",r.style.backgroundColor="black",r.style.color="yellow"}EnlacesA(){const t=document.getElementById("Enlace"),i=document.getElementById("Enlace2"),r=document.getElementById("Enlace3");t.style.backgroundColor="white",t.style.color="blue",i.style.backgroundColor="white",i.style.color="blue",r.style.backgroundColor="white",r.style.color="blue"}ContrasteA(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="black",t.style.color="yellow"}ContrasteB(){const t=document.getElementById("Cuerpo");t.style.backgroundColor="white",t.style.color="black"}ZoomMas(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[5]}ZoomMenos(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[1]}ZoomNormal(){var i=new Array("xx-small","x-small","small","medium","large","x-large","xx-large");document.getElementById("Cuerpo").style.fontSize=i[3]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-galeria"]],decls:115,vars:4,consts:[[1,"container","text-center"],[2,"color","#EE6983","font-size","24px","font-weight","bold"],["id","gallery",1,"gallery"],["width","560","height","315","frameborder","0","allow","accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",1,"swiper-slide",3,"src"],["id","childern"],[1,"card-columns"],[1,"card"],["src","https://www.yavas.com/images/upload/EM_hoteles/LosCabos-hotel-barato.jpg","alt","...",1,"card-img-top"],[1,"card-body"],[1,"card-title"],["src","https://www.qhotels.es/wp-content/uploads/2022/12/pano-hotel_1500-e1672331060671.jpg","alt","...",1,"card-img-top"],["src","https://es.israel21c.org/wp-content/uploads/2022/07/setai-main-1168x657.png","alt","...",1,"card-img"],[1,"card","bg-primary","text-white","text-center","p-3"],[1,"blockquote","mb-0"],[1,"blockquote-footer","text-white"],["title","Source Title"],[1,"card","text-center"],["src","https://e00-expansion.uecdn.es/assets/multimedia/imagenes/2022/02/08/16443177167892.jpg","alt","...",1,"card-img"],["src","https://neextt.com/wp-content/uploads/2021/02/nuevos-hoteles-abriran-mexico-2021-1.jpg","alt","...",1,"card-img"],[1,"card","p-3","text-right"],["src","https://static1.eskypartners.com/travelguide/vancouver-hotels.jpg","alt","...",1,"card-img"],["src","https://www.oaxaca-mio.com/oaxaca/wp-content/uploads/2020/04/FOTO_CASADEADOBE.jpg","alt","...",1,"card-img"],[1,"card-text"],[1,"text-muted"],["src","https://booked.mx/data/Photos/380x200/7250/725056/725056252/Casa-Marlene-Hotel-Valladolid-Exterior.JPEG","alt","...",1,"card-img"],["src","https://casablancasayulita.com/wp-content/uploads/2022/04/Jacuzzi-de-asotea-en-sayulita.jpg","alt","...",1,"card-img"],["src","https://cdn1.parksmedia.wdprapps.disney.com/resize/mwImage/1/900/450/75/vision-dam/digital/parks-platform/parks-global-assets/disneyland/resorts/disneys-grand-californian-hotel-and-spa/spa/Relaxation-Lounge-16x9.jpg?2021-11-01T16:41:40+00:00","alt","...",1,"card-img"],[2,"text-align","center","color","#850E35"],["type","button",2,"width","100px","margin","2px",3,"click"],["type","button",2,"width","150px","margin","2px",3,"click"],["type","button",2,"margin","2px",3,"click"],["href","#","type","button"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"h3",1),Re(2,"Video Axolotl Palace"),be(),pe(3,"section",2),St(4,"iframe",3),function fL(n,e){const t=di();let i;const r=n+Ri;t.firstCreatePass?(i=function qG(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??(t.destroyHooks=[])).push(r,i.onDestroy)):i=t.data[r];const s=i.factory||(i.factory=hu(i.type)),u=Ro(nt);try{const m=xo(!1),v=s();return xo(m),function Zi(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,gt(),r,v),v}finally{Ro(u)}}(5,"video"),be()(),pe(6,"div",0)(7,"h3",1),Re(8,"Galeria Axolotl Palace"),be(),pe(9,"div",4)(10,"div",5)(11,"div",6),St(12,"img",7),pe(13,"div",8)(14,"h5",9),Re(15,"Una de nuestras habitaciones"),be()()(),pe(16,"div",6),St(17,"img",10),pe(18,"div",8)(19,"h5",9),Re(20,"Disfruta nuestro hotel"),be()()(),pe(21,"div",6),St(22,"img",11),be(),pe(23,"div",12)(24,"blockquote",13)(25,"footer",14)(26,"small")(27,"cite",15),Re(28,"Te vas a relajar"),be()()()()(),pe(29,"div",16)(30,"div",8)(31,"h5",9),Re(32,"Habitacion"),be(),St(33,"img",17),be()(),pe(34,"div",6),St(35,"img",18),be(),pe(36,"div",19),St(37,"img",20),be(),pe(38,"div",6)(39,"div",8),St(40,"img",21),pe(41,"h5",9),Re(42,"Uno de nuestros mejores lugares"),be(),pe(43,"p",22)(44,"small",23),Re(45,"La mas comoda"),be()()()(),pe(46,"div",6),St(47,"img",24),be(),pe(48,"div",12)(49,"blockquote",13)(50,"footer",14)(51,"small")(52,"cite",15),Re(53,"No hay problemas "),be()()()()(),pe(54,"div",6),St(55,"img",25),be(),pe(56,"div",12)(57,"blockquote",13)(58,"footer",14)(59,"small")(60,"cite",15),Re(61,"Aqui no te vas a estresar"),be()()()()(),pe(62,"div",6),St(63,"img",26),be(),pe(64,"div",12)(65,"blockquote",13)(66,"footer",14)(67,"small")(68,"cite",15),Re(69,"Te vas a relajar"),be()()()()()()()(),St(70,"br")(71,"br"),pe(72,"h5",27)(73,"h4"),Re(74," - Accesibilidad - "),be(),St(75,"br"),pe(76,"li")(77,"h6"),Re(78,"OPCIONES DE LECTOR DE VOZ:"),be(),pe(79,"button",28),$t("click",function(){return i.Hablar()}),Re(80,"Activar"),be(),pe(81,"button",28),$t("click",function(){return i.Pausar()}),Re(82,"Pausar"),be(),pe(83,"button",28),$t("click",function(){return i.Resumen()}),Re(84,"Continuar"),be()(),St(85,"br"),pe(86,"li")(87,"h6"),Re(88,"OPCIONES DE ZOOM:"),be(),pe(89,"button",28),$t("click",function(){return i.ZoomMas()}),Re(90," Zoom (+) "),be(),pe(91,"button",28),$t("click",function(){return i.ZoomNormal()}),Re(92," Sin Zoom "),be(),pe(93,"button",28),$t("click",function(){return i.ZoomMenos()}),Re(94," Zoom (-) "),be()(),St(95,"br"),pe(96,"li")(97,"h6"),Re(98,"OPCIONES DE ENLACES:"),be(),pe(99,"button",28),$t("click",function(){return i.EnlacesB()}),Re(100," Resaltar Enlaces "),be(),pe(101,"button",28),$t("click",function(){return i.EnlacesA()}),Re(102," Enlaces Normales "),be()(),St(103,"br"),pe(104,"li")(105,"h6"),Re(106,"OPCIONES DE CONTRASTE:"),be(),pe(107,"button",29),$t("click",function(){return i.ContrasteA()}),Re(108," Contraste Alto "),be(),pe(109,"button",30),$t("click",function(){return i.ContrasteB()}),Re(110," Contraste Normal "),be()(),St(111,"br"),pe(112,"li")(113,"a",31),Re(114,"Volver a Inicio"),be()()()),2&t&&(oi(4),sn("src",pL(5,1,i.video,"https://www.youtube.com/embed/"),$p))},dependencies:[Uae],styles:["@media (min-width: 576px){.card-columns[_ngcontent-%COMP%]{column-count:2}}@media (min-width: 768px){.card-columns[_ngcontent-%COMP%]{column-count:3}}@media (min-width: 992px){.card-columns[_ngcontent-%COMP%]{column-count:4}}@media (min-width: 1200px){.card-columns[_ngcontent-%COMP%]{column-count:5}}",".grid[_ngcontent-%COMP%] {\n  width: 100%;\n  display: grid;\n  grid-gap: 20px;\n\n  .custom-heading {\n      color: #EE6983;\n      font-size: 24px;\n      font-weight: bold;\n    }\n}\n\n@media (min-width: 768px) {\n  .grid[_ngcontent-%COMP%] {\n    grid-template-columns: repeat(5, 1fr);\n  }\n}"]}),n})(),kj=(()=>{class n{constructor(){this.habitaciones=[{id:1,nombre:"Habitaci\xf3n individual",tipo:"Individual",precio:500,descripcion:"Habitaci\xf3n para una persona",imagen:"https://bufondearenillashotel.es/wp-content/uploads/2015/02/habitacion-individual.jpg"},{id:2,nombre:"Habitaci\xf3n doble",tipo:"Doble",precio:800,descripcion:"Habitaci\xf3n para dos personas",imagen:"https://hotelmalinallihuamantla.com/wp-content/uploads/2019/12/habitacion-doble-malinalli-1.jpg"},{id:3,nombre:"Habitaci\xf3n triple",tipo:"Triple",precio:1100,descripcion:"Habitaci\xf3n para tres personas",imagen:"https://hotelflamingoinn.com.mx/wp-content/uploads/2021/05/habitacion-ejecuiva-triple.jpg"},{id:4,nombre:"Suite",tipo:"Suite",precio:1500,descripcion:"Habitaci\xf3n de lujo para dos personas",imagen:"https://s3.us-east-1.amazonaws.com/comercial-production-gx-cms-content-bucket/hxm/rooms/suites/ocean-front-family/ocean-front-fam-005.jpg"},{id:5,nombre:"Habitaci\xf3n familiar",tipo:"Familiar",precio:1200,descripcion:"Habitaci\xf3n para cuatro personas",imagen:"https://as01.epimg.net/diarioas/imagenes/2022/05/06/actualidad/1651826263_229801_1651826454_noticia_normal_recorte1.jpg"}]}getHabitaciones(){return fn(this.habitaciones)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let Pj=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(nt(Cu),nt(Kr))},n.\u0275dir=vn({type:n}),n})(),Hm=(()=>{class n extends Pj{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=No(n)))(i||n)}}(),n.\u0275dir=vn({type:n,features:[Ni]}),n})();const Hu=new Ct("NgValueAccessor"),Hae={provide:Hu,useExisting:mi(()=>ip),multi:!0},Wae=new Ct("CompositionEventMode");let ip=(()=>{class n extends Pj{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Gae(){const n=gh()?gh().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(nt(Cu),nt(Kr),nt(Wae,8))},n.\u0275dir=vn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&$t("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[Tr([Hae]),Ni]}),n})();const qae=!1;function rp(n){return null==n||("string"==typeof n||Array.isArray(n))&&0===n.length}function Fj(n){return null!=n&&"number"==typeof n.length}const Js=new Ct("NgValidators"),op=new Ct("NgAsyncValidators"),Zae=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class oy{static min(e){return function Lj(n){return e=>{if(rp(e.value)||rp(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}(e)}static max(e){return function Nj(n){return e=>{if(rp(e.value)||rp(n))return null;const t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}(e)}static required(e){return Bj(e)}static requiredTrue(e){return function zj(n){return!0===n.value?null:{required:!0}}(e)}static email(e){return function Vj(n){return rp(n.value)||Zae.test(n.value)?null:{email:!0}}(e)}static minLength(e){return function Uj(n){return e=>rp(e.value)||!Fj(e.value)?null:e.value.length<n?{minlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static maxLength(e){return function jj(n){return e=>Fj(e.value)&&e.value.length>n?{maxlength:{requiredLength:n,actualLength:e.value.length}}:null}(e)}static pattern(e){return function $j(n){if(!n)return mC;let e,t;return"string"==typeof n?(t="","^"!==n.charAt(0)&&(t+="^"),t+=n,"$"!==n.charAt(n.length-1)&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),i=>{if(rp(i.value))return null;const r=i.value;return e.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(e)}static nullValidator(e){return null}static compose(e){return Yj(e)}static composeAsync(e){return Kj(e)}}function Bj(n){return rp(n.value)?{required:!0}:null}function mC(n){return null}function Hj(n){return null!=n}function Gj(n){const e=Xr(n)?hr(n):n;if(qae&&!Qr(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new ot(-1101,t)}return e}function Wj(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function qj(n,e){return e.map(t=>t(n))}function Zj(n){return n.map(e=>function Yae(n){return!n.validate}(e)?e:t=>e.validate(t))}function Yj(n){if(!n)return null;const e=n.filter(Hj);return 0==e.length?null:function(t){return Wj(qj(t,e))}}function w2(n){return null!=n?Yj(Zj(n)):null}function Kj(n){if(!n)return null;const e=n.filter(Hj);return 0==e.length?null:function(t){return function Rj(...n){const e=on(n),{args:t,keys:i}=v5(n),r=new xn(s=>{const{length:u}=t;if(!u)return void s.complete();const m=new Array(u);let v=u,C=u;for(let S=0;S<u;S++){let R=!1;W(t[S]).subscribe(zn(s,j=>{R||(R=!0,C--),m[S]=j},()=>v--,void 0,()=>{(!v||!R)&&(C||s.next(i?b5(i,m):m),s.complete())}))}});return e?r.pipe($P(e)):r}(qj(t,e).map(Gj)).pipe(cn(Wj))}}function E2(n){return null!=n?Kj(Zj(n)):null}function Xj(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Qj(n){return n._rawValidators}function Jj(n){return n._rawAsyncValidators}function C2(n){return n?Array.isArray(n)?n:[n]:[]}function gC(n,e){return Array.isArray(n)?n.includes(e):n===e}function e4(n,e){const t=C2(e);return C2(n).forEach(r=>{gC(t,r)||t.push(r)}),t}function t4(n,e){return C2(e).filter(t=>!gC(n,t))}class n4{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=w2(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=E2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Na extends n4{get formDirective(){return null}get path(){return null}}class sp extends n4{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class r4{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let sy=(()=>{class n extends r4{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(nt(sp,2))},n.\u0275dir=vn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&nb("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Ni]}),n})(),_C=(()=>{class n extends r4{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(nt(Na,10))},n.\u0275dir=vn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,i){2&t&&nb("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Ni]}),n})();function o4(n,e){return n?`with name: '${e}'`:`at index: ${e}`}const D2=!1,P0="VALID",vC="INVALID",ay="PENDING",O0="DISABLED";function S2(n){return(bC(n)?n.validators:n)||null}function A2(n,e){return(bC(e)?e.asyncValidators:n)||null}function bC(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class l4{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===P0}get invalid(){return this.status===vC}get pending(){return this.status==ay}get disabled(){return this.status===O0}get enabled(){return this.status!==O0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(e4(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(e4(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(t4(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(t4(e,this._rawAsyncValidators))}hasValidator(e){return gC(this._rawValidators,e)}hasAsyncValidator(e){return gC(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ay,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=O0,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=P0,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===P0||this.status===ay)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?O0:P0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ay,this._hasOwnPendingAsyncValidator=!0;const t=Gj(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ir,this.statusChanges=new Ir}_calculateStatus(){return this._allControlsDisabled()?O0:this.errors?vC:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ay)?ay:this._anyControlsHaveStatus(vC)?vC:P0}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){bC(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function nle(n){return Array.isArray(n)?w2(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function ile(n){return Array.isArray(n)?E2(n):n||null}(this._rawAsyncValidators)}}class F0 extends l4{constructor(e,t,i){super(S2(t),A2(i,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,i={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,i={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){(function a4(n,e,t){n._forEachChild((i,r)=>{if(void 0===t[r])throw new ot(1002,D2?function tle(n,e){return`Must supply a value for form control ${o4(n,e)}`}(e,r):"")})})(this,!0,e),Object.keys(e).forEach(i=>{(function s4(n,e,t){const i=n.controls;if(!(e?Object.keys(i):i).length)throw new ot(1e3,D2?function Jae(n){return`\n    There are no form controls registered with this ${n?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(e):"");if(!i[t])throw new ot(1001,D2?function ele(n,e){return`Cannot find form control ${o4(n,e)}`}(e,t):"")})(this,!0,i),this.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(i=>{const r=this.controls[i];r&&r.patchValue(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((i,r)=>{i.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,i)=>(e[i]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&e(i,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&e(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(e,t){let i=e;return this._forEachChild((r,s)=>{i=t(i,r,s)}),i}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}const Gm=new Ct("CallSetDisabledState",{providedIn:"root",factory:()=>L0}),L0="always";function xC(n,e){return[...e.path,n]}function N0(n,e,t=L0){M2(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function sle(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&c4(n,e)})}(n,e),function lle(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function ale(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&c4(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function ole(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function wC(n,e,t=!0){const i=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(i),e.valueAccessor.registerOnTouched(i)),CC(n,e),n&&(e._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function EC(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function M2(n,e){const t=Qj(n);null!==e.validator?n.setValidators(Xj(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=Jj(n);null!==e.asyncValidator?n.setAsyncValidators(Xj(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();EC(e._rawValidators,r),EC(e._rawAsyncValidators,r)}function CC(n,e){let t=!1;if(null!==n){if(null!==e.validator){const r=Qj(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(u=>u!==e.validator);s.length!==r.length&&(t=!0,n.setValidators(s))}}if(null!==e.asyncValidator){const r=Jj(n);if(Array.isArray(r)&&r.length>0){const s=r.filter(u=>u!==e.asyncValidator);s.length!==r.length&&(t=!0,n.setAsyncValidators(s))}}}const i=()=>{};return EC(e._rawValidators,i),EC(e._rawAsyncValidators,i),t}function c4(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function u4(n,e){M2(n,e)}function R2(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}function d4(n,e){n._syncPendingControls(),e.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function P2(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(s=>{s.constructor===ip?t=s:function dle(n){return Object.getPrototypeOf(n.constructor)===Hm}(s)?i=s:r=s}),r||i||t||null}const fle={provide:Na,useExisting:mi(()=>TC)},B0=(()=>Promise.resolve())();let TC=(()=>{class n extends Na{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Ir,this.form=new F0({},w2(t),E2(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){B0.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),N0(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){B0.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){B0.then(()=>{const i=this._findContainer(t.path),r=new F0({});u4(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){B0.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){B0.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,d4(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return n.\u0275fac=function(t){return new(t||n)(nt(Js,10),nt(op,10),nt(Gm,8))},n.\u0275dir=vn({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,i){1&t&&$t("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Tr([fle]),Ni]}),n})();function h4(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function f4(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const Wm=class extends l4{constructor(e=null,t,i){super(S2(t),A2(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),bC(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=f4(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){h4(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){h4(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){f4(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},gle={provide:sp,useExisting:mi(()=>z0)},g4=(()=>Promise.resolve())();let z0=(()=>{class n extends sp{constructor(t,i,r,s,u,m){super(),this._changeDetectorRef=u,this.callSetDisabledState=m,this.control=new Wm,this._registered=!1,this.update=new Ir,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=P2(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),R2(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){N0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){g4.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&v_(i);g4.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?xC(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(nt(Na,9),nt(Js,10),nt(op,10),nt(Hu,10),nt(mb,8),nt(Gm,8))},n.\u0275dir=vn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Tr([gle]),Ni,Fo]}),n})(),IC=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=vn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})(),y4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();const O2=new Ct("NgModelWithFormControlWarning"),wle={provide:Na,useExisting:mi(()=>V0)};let V0=(()=>{class n extends Na{constructor(t,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ir,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(CC(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return N0(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){wC(t.control||null,t,!1),function hle(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this.submitted=!0,d4(this.form,this.directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(wC(i||null,t),(n=>n instanceof Wm)(r)&&(N0(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);u4(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function cle(n,e){return CC(n,e)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){M2(this.form,this),this._oldForm&&CC(this._oldForm,this)}_checkFormPresent(){}}return n.\u0275fac=function(t){return new(t||n)(nt(Js,10),nt(op,10),nt(Gm,8))},n.\u0275dir=vn({type:n,selectors:[["","formGroup",""]],hostBindings:function(t,i){1&t&&$t("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Tr([wle]),Ni,Fo]}),n})();const Tle={provide:sp,useExisting:mi(()=>DC)};let DC=(()=>{class n extends sp{set isDisabled(t){}constructor(t,i,r,s,u){super(),this._ngModelWarningConfig=u,this._added=!1,this.update=new Ir,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=P2(0,s)}ngOnChanges(t){this._added||this._setUpControl(),R2(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return xC(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return n._ngModelWarningSentOnce=!1,n.\u0275fac=function(t){return new(t||n)(nt(Na,13),nt(Js,10),nt(op,10),nt(Hu,10),nt(O2,8))},n.\u0275dir=vn({type:n,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[Tr([Tle]),Ni,Fo]}),n})();const Ile={provide:Hu,useExisting:mi(()=>SC),multi:!0};function E4(n,e){return null==n?`${e}`:(e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let SC=(()=>{class n extends Hm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const r=E4(this._getOptionId(t),t);this.setProperty("value",r)}registerOnChange(t){this.onChange=i=>{this.value=this._getOptionValue(i),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),t))return i;return null}_getOptionValue(t){const i=function Dle(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i):t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=No(n)))(i||n)}}(),n.\u0275dir=vn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,i){1&t&&$t("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Tr([Ile]),Ni]}),n})(),C4=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(E4(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(Cu),nt(SC,9))},n.\u0275dir=vn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const Sle={provide:Hu,useExisting:mi(()=>N2),multi:!0};function T4(n,e){return null==n?`${e}`:("string"==typeof e&&(e=`'${e}'`),e&&"object"==typeof e&&(e="Object"),`${n}: ${e}`.slice(0,50))}let N2=(()=>{class n extends Hm{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let i;if(this.value=t,Array.isArray(t)){const r=t.map(s=>this._getOptionId(s));i=(s,u)=>{s._setSelected(r.indexOf(u.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(t){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const u=s;for(let m=0;m<u.length;m++){const C=this._getOptionValue(u[m].value);r.push(C)}}else{const u=i.options;for(let m=0;m<u.length;m++){const v=u[m];if(v.selected){const C=this._getOptionValue(v.value);r.push(C)}}}this.value=r,t(r)}}_registerOption(t){const i=(this._idCounter++).toString();return this._optionMap.set(i,t),i}_getOptionId(t){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,t))return i;return null}_getOptionValue(t){const i=function Ale(n){return n.split(":")[0]}(t);return this._optionMap.has(i)?this._optionMap.get(i)._value:t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=No(n)))(i||n)}}(),n.\u0275dir=vn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,i){1&t&&$t("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Tr([Sle]),Ni]}),n})(),I4=(()=>{class n{constructor(t,i,r){this._element=t,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(T4(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(T4(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(Cu),nt(N2,9))},n.\u0275dir=vn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})(),qm=(()=>{class n{constructor(){this._validator=mC}ngOnChanges(t){if(this.inputName in t){const i=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):mC,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return null!=t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=vn({type:n,features:[Fo]}),n})();const Rle={provide:Js,useExisting:mi(()=>AC),multi:!0};let AC=(()=>{class n extends qm{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=v_,this.createValidator=t=>Bj}enabled(t){return t}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=No(n)))(i||n)}}(),n.\u0275dir=vn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,i){2&t&&dt("required",i._enabled?"":null)},inputs:{required:"required"},features:[Tr([Rle]),Ni]}),n})(),L4=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[y4]}),n})(),zle=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Gm,useValue:t.callSetDisabledState??L0}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[L4]}),n})(),Vle=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:O2,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Gm,useValue:t.callSetDisabledState??L0}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[L4]}),n})();function Ule(n,e){if(1&n&&(pe(0,"li"),Re(1),be()),2&n){const t=e.$implicit;oi(1),fh(t)}}let jle=(()=>{class n{constructor(){this.comments=[],this.newCommentAdded=new Ir,this.newComment=""}addComment(){this.newComment&&(this.comments.push(this.newComment),this.newCommentAdded.emit(this.newComment),this.newComment="")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-comments"]],inputs:{comments:"comments"},outputs:{newCommentAdded:"newCommentAdded"},decls:8,vars:2,consts:[[4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"btn","btn-primary",3,"click"]],template:function(t,i){1&t&&(pe(0,"div")(1,"h3"),Re(2,"Comentarios"),be(),pe(3,"ul"),Zn(4,Ule,2,1,"li",0),be(),pe(5,"textarea",1),$t("ngModelChange",function(s){return i.newComment=s}),be(),pe(6,"button",2),$t("click",function(){return i.addComment()}),Re(7,"Agregar comentario"),be()()),2&t&&(oi(4),sn("ngForOf",i.comments),oi(1),sn("ngModel",i.newComment))},dependencies:[a1,ip,sy,z0],styles:[".btn-primary[_ngcontent-%COMP%]{background-color:#850e35;border-color:#850e35;font-weight:700}.btn-primary[_ngcontent-%COMP%]:hover, .btn-primary[_ngcontent-%COMP%]:focus{background-color:#ee6983;border-color:#ee6983}"]}),n})();function $le(n,e){if(1&n&&(pe(0,"li"),St(1,"img",12),pe(2,"h5",13),Re(3),be(),pe(4,"p",14),Re(5),be(),pe(6,"p",14),Re(7),be(),pe(8,"p",14),Re(9),be()()),2&n){const t=e.$implicit;oi(1),Of("src",t.imagen,av),Of("alt",t.nombre),oi(2),fh(t.nombre),oi(2),fh(t.descripcion),oi(2),rb("Tipo: ",t.tipo,""),oi(2),rb("Precio: $",t.precio,"")}}let Hle=(()=>{class n{constructor(t){this.habitacionService=t,this.comments=[],this.habitaciones=[]}ngOnInit(){this.getHabitaciones()}getHabitaciones(){this.habitacionService.getHabitaciones().subscribe(t=>this.habitaciones=t)}onNewCommentAdded(t){this.comments.push(t)}}return n.\u0275fac=function(t){return new(t||n)(nt(kj))},n.\u0275cmp=pr({type:n,selectors:[["app-habitacion-list"]],decls:18,vars:1,consts:[["charset","utf-8"],["name","viewport","content","width=device-width, initial-scale=1"],["rel","stylesheet","href","https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"],[2,"text-align","center","width","80%","margin","0 auto"],[4,"ngFor","ngForOf"],[2,"text-align","center","width","90%","margin","0 auto","padding","5%"],[3,"newCommentAdded"],["routerLink","/habitacion/individual"],["routerLink","/habitacion/doble"],["routerLink","/habitacion/triple"],["routerLink","/habitacion/familiar"],["routerLink","/habitacion/suite"],["width","150","height","150",3,"src","alt"],[1,"card-title"],[1,"card-text"]],template:function(t,i){1&t&&(St(0,"meta",0)(1,"meta",1)(2,"link",2),pe(3,"ul",3),Zn(4,$le,10,6,"li",4),pe(5,"div",5)(6,"app-comments",6),$t("newCommentAdded",function(s){return i.onNewCommentAdded(s)}),be()(),pe(7,"button",7),Re(8,"Habitaci\xf3n Individual"),be(),pe(9,"button",8),Re(10,"Habitaci\xf3n Doble"),be(),pe(11,"button",9),Re(12,"Habitaci\xf3n Triple"),be(),pe(13,"button",10),Re(14,"Habitaci\xf3n Familiar"),be(),pe(15,"button",11),Re(16,"Habitaci\xf3n Suite"),be(),St(17,"router-outlet"),be()),2&t&&(oi(4),sn("ngForOf",i.habitaciones))},dependencies:[a1,oC,iy,jle],styles:["*[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;background-color:#ffc4c4;font-weight:700}li[_ngcontent-%COMP%]{padding:20px}img[_ngcontent-%COMP%]{border-radius:15px}h5[_ngcontent-%COMP%]{padding-top:45px}ul[_ngcontent-%COMP%]{padding:30}li[_ngcontent-%COMP%]{padding-left:90px}.room-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.room-card[_ngcontent-%COMP%]{width:300px;padding:20px;margin:10px;border:1px solid #ccc;border-radius:5px;background-color:#fff5e4;box-shadow:0 2px 4px #0000001a}.room-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:10px}.room-description[_ngcontent-%COMP%]{margin-bottom:10px}.room-price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#850e35}.individual-style[_ngcontent-%COMP%]{background-color:#fff5e4}.triple-style[_ngcontent-%COMP%]{background-color:#ffc4c4}.double-style[_ngcontent-%COMP%]{background-color:#ffc2cf}.suite-style[_ngcontent-%COMP%]{background-color:#f5a6c0}.family-style[_ngcontent-%COMP%]{background-color:#ffdbdb}"]}),n})();function Gle(n,e){1&n&&(pe(0,"div",3)(1,"h2",4),Re(2,"Habitaci\xf3n Individual"),be(),pe(3,"p",5),Re(4," Disponible por 500 pesos, es un espacio acogedor y funcional que ofrece comodidad a un precio asequible. Aunque es una habitaci\xf3n de tama\xf1o moderado, est\xe1 dise\xf1ada de manera eficiente para maximizar el espacio disponible. "),be(),pe(5,"p",6),Re(6,"$500 por noche"),be()()),2&n&&sn("ngClass","individual-style")}function Wle(n,e){1&n&&(pe(0,"div",3)(1,"h2",4),Re(2,"Habitaci\xf3n Triple"),be(),pe(3,"p",5),Re(4," La habitaci\xf3n triple es un espacio amplio y vers\xe1til que puede alojar a tres personas c\xf3modamente. Normalmente cuenta con tres camas individuales o una combinaci\xf3n de camas individuales y camas matrimoniales, todas ellas con ropa de cama de calidad. Tambi\xe9n incluye mesitas de noche, l\xe1mparas individuales y armarios o espacios de almacenamiento suficientes para cada hu\xe9sped. "),be(),pe(5,"p",6),Re(6,"$1100 por noche"),be()()),2&n&&sn("ngClass","triple-style")}function qle(n,e){1&n&&(pe(0,"div",3)(1,"h2",4),Re(2,"Habitaci\xf3n Doble"),be(),pe(3,"p",5),Re(4," La habitaci\xf3n doble es un espacio dise\xf1ado para alojar a dos personas. Por lo general, cuenta con una cama matrimonial o dos camas individuales con ropa de cama c\xf3moda y suave. Al igual que en la habitaci\xf3n triple, encontrar\xe1s mesitas de noche con l\xe1mparas, armarios o espacios de almacenamiento y, dependiendo del lugar, un ba\xf1o privado o compartido. "),be(),pe(5,"p",6),Re(6,"$800 por noche"),be()()),2&n&&sn("ngClass","double-style")}function Zle(n,e){1&n&&(pe(0,"div",3)(1,"h2",4),Re(2,"Habitaci\xf3n Suite"),be(),pe(3,"p",5),Re(4," La habitaci\xf3n suite es un espacio de alojamiento m\xe1s lujoso y amplio, dise\xf1ado para ofrecer una experiencia de hospedaje de mayor categor\xeda. Suele contar con una zona de dormitorio separada y una sala de estar o \xe1rea de estar adicional. La habitaci\xf3n suite puede incluir una cama matrimonial o una combinaci\xf3n de camas individuales y matrimoniales, todas ellas con ropa de cama de alta calidad. "),be(),pe(5,"p",6),Re(6,"$1500 por noche"),be()()),2&n&&sn("ngClass","suite-style")}function Yle(n,e){1&n&&(pe(0,"div",3)(1,"h2",4),Re(2,"Habitaci\xf3n Familiar"),be(),pe(3,"p",5),Re(4," La habitaci\xf3n familiar es una opci\xf3n ideal para familias o grupos m\xe1s grandes que desean alojarse juntos. Suele contar con camas matrimoniales y camas individuales en una combinaci\xf3n adecuada para acomodar a varios miembros de la familia o grupo. Al igual que en las otras habitaciones, se proporciona ropa de cama de calidad y comodidades b\xe1sicas como mesitas de noche, l\xe1mparas, armarios o espacios de almacenamiento y ba\xf1o privado o compartido. Adem\xe1s, la habitaci\xf3n familiar puede contar con espacio adicional, como una sala de estar o un \xe1rea de juegos, para que todos los miembros de la familia puedan disfrutar de su estancia juntos. "),be(),pe(5,"p",6),Re(6,"$1200 por noche"),be()()),2&n&&sn("ngClass","family-style")}let Kle=(()=>{class n{constructor(t){this.route=t,this.habitacion=""}ngOnInit(){this.route.paramMap.subscribe(t=>{this.habitacion=t.get("habitacion")??""})}}return n.\u0275fac=function(t){return new(t||n)(nt($m))},n.\u0275cmp=pr({type:n,selectors:[["app-habitaciones"]],decls:7,vars:6,consts:[[1,"room-container"],[1,"room-card",3,"ngSwitch"],[3,"ngClass",4,"ngSwitchCase"],[3,"ngClass"],[1,"room-title"],[1,"room-description"],[1,"room-price"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"div",1),Zn(2,Gle,7,1,"div",2),Zn(3,Wle,7,1,"div",2),Zn(4,qle,7,1,"div",2),Zn(5,Zle,7,1,"div",2),Zn(6,Yle,7,1,"div",2),be()()),2&t&&(oi(1),sn("ngSwitch",i.habitacion),oi(1),sn("ngSwitchCase","individual"),oi(1),sn("ngSwitchCase","triple"),oi(1),sn("ngSwitchCase","doble"),oi(1),sn("ngSwitchCase","suite"),oi(1),sn("ngSwitchCase","familiar"))},dependencies:[CD,l1,LN],styles:[".room-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.room-card[_ngcontent-%COMP%]{width:300px;padding:20px;margin:10px;border:1px solid #ccc;border-radius:5px;background-color:#fff5e4;box-shadow:0 2px 4px #0000001a}.room-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;margin-bottom:10px}.room-description[_ngcontent-%COMP%]{margin-bottom:10px}.room-price[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#850e35}.individual-style[_ngcontent-%COMP%]{background-color:#fff5e4}.triple-style[_ngcontent-%COMP%]{background-color:#ffc4c4}.double-style[_ngcontent-%COMP%]{background-color:#ffc2cf}.suite-style[_ngcontent-%COMP%]{background-color:#f5a6c0}.family-style[_ngcontent-%COMP%]{background-color:#ffdbdb}"]}),n})();class B2{}class ap{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),u=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(u):this.headers.set(s,[u])}})}:()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{let r;if(r="string"==typeof i?[i]:"number"==typeof i?[i.toString()]:i.map(s=>s.toString()),r.length>0){const s=t.toLowerCase();this.headers.set(s,r),this.maybeSetNormalizedName(t,s)}})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof ap?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new ap;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof ap?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let u=this.headers.get(t);if(!u)return;u=u.filter(m=>-1===s.indexOf(m)),0===u.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,u)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Xle{encodeKey(e){return B4(e)}encodeValue(e){return B4(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Jle=/%(\d[a-f0-9])/gi,ece={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function B4(n){return encodeURIComponent(n).replace(Jle,(e,t)=>ece[t]??e)}function MC(n){return`${n}`}class lp{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Xle,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Qle(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[u,m]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],v=t.get(u)||[];v.push(m),t.set(u,v)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(MC):[MC(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new lp({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(MC(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(MC(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class tce{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function z4(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function V4(n){return typeof Blob<"u"&&n instanceof Blob}function U4(n){return typeof FormData<"u"&&n instanceof FormData}class U0{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function nce(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new ap),this.context||(this.context=new tce),this.params){const u=this.params.toString();if(0===u.length)this.urlWithParams=t;else{const m=t.indexOf("?");this.urlWithParams=t+(-1===m?"?":m<t.length-1?"&":"")+u}}else this.params=new lp,this.urlWithParams=t}serializeBody(){return null===this.body?null:z4(this.body)||V4(this.body)||U4(this.body)||function ice(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof lp?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||U4(this.body)?null:V4(this.body)?this.body.type||null:z4(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof lp?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,r=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,u=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,m=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let v=e.headers||this.headers,C=e.params||this.params;const S=e.context??this.context;return void 0!==e.setHeaders&&(v=Object.keys(e.setHeaders).reduce((R,j)=>R.set(j,e.setHeaders[j]),v)),e.setParams&&(C=Object.keys(e.setParams).reduce((R,j)=>R.set(j,e.setParams[j]),C)),new U0(t,i,s,{params:C,headers:v,context:S,reportProgress:m,responseType:r,withCredentials:u})}}var ea=(()=>((ea=ea||{})[ea.Sent=0]="Sent",ea[ea.UploadProgress=1]="UploadProgress",ea[ea.ResponseHeader=2]="ResponseHeader",ea[ea.DownloadProgress=3]="DownloadProgress",ea[ea.Response=4]="Response",ea[ea.User=5]="User",ea))();class rce{constructor(e,t=200,i="OK"){this.headers=e.headers||new ap,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class z2 extends rce{constructor(e={}){super(e),this.type=ea.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new z2({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}function V2(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let kC=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof U0)s=t;else{let v,C;v=r.headers instanceof ap?r.headers:new ap(r.headers),r.params&&(C=r.params instanceof lp?r.params:new lp({fromObject:r.params})),s=new U0(t,i,void 0!==r.body?r.body:null,{headers:v,context:r.context,params:C,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const u=fn(s).pipe(Jf(v=>this.handler.handle(v)));if(t instanceof U0||"events"===r.observe)return u;const m=u.pipe(Fs(v=>v instanceof z2));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return m.pipe(cn(v=>{if(null!==v.body&&!(v.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return v.body}));case"blob":return m.pipe(cn(v=>{if(null!==v.body&&!(v.body instanceof Blob))throw new Error("Response is not a Blob.");return v.body}));case"text":return m.pipe(cn(v=>{if(null!==v.body&&"string"!=typeof v.body)throw new Error("Response is not a string.");return v.body}));default:return m.pipe(cn(v=>v.body))}case"response":return m;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new lp).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,V2(r,i))}post(t,i,r={}){return this.request("POST",t,V2(r,i))}put(t,i,r={}){return this.request("PUT",t,V2(r,i))}}return n.\u0275fac=function(t){return new(t||n)(lt(B2))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();function _ce(n,e){1&n&&(pe(0,"div",15),Re(1," El nombre es necesario "),be())}function yce(n,e){1&n&&(pe(0,"div",15),Re(1," Ingresa por lo menos 3 caracteres "),be())}function vce(n,e){1&n&&(pe(0,"div",15),Re(1," Correo obligatorio "),be())}function bce(n,e){1&n&&(pe(0,"div",15),Re(1," El correo no tiene el formato correcto "),be())}const Y4=function(n){return{"is-invalid":n}};let xce=(()=>{class n{constructor(t){this.http=t,this.usuario={nombre:"",apellido:"",correo:""},this.forma=new F0({nombre:new Wm(this.usuario.nombre,[oy.required,oy.minLength(3)]),apellido:new Wm(this.usuario.apellido,oy.required),correo:new Wm(this.usuario.correo,[oy.required,oy.email])})}guardarCambios(){console.log("metodo guardarCambios"),console.log(this.forma),console.log(this.forma.value),this.http.post("http://localhost:3000/reservaciones",{name:"FormSubmit",message:"I'm from Devro LABS"}).subscribe(i=>{console.log(i),console.log("Todo sali\xf3 bien")},i=>{console.error(i),console.log("Hubo un error en la comunicaci\xf3n")})}}return n.\u0275fac=function(t){return new(t||n)(nt(kC))},n.\u0275cmp=pr({type:n,selectors:[["app-contact"]],decls:38,vars:12,consts:[["id","contact",1,"contact"],[1,"row"],["method","post","novalidate","",1,"needs-validation",3,"formGroup","ngSubmit"],[1,"container"],[1,"form-group","row"],[1,"col-2","col-form-label"],[1,"col-8"],["type","text","placeholder","Nombre","formControlName","nombre",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","placeholder","Apellido","formControlName","apellido",1,"form-control"],["type","text","placeholder","Correo electronico","formControlName","correo",1,"form-control",3,"ngClass"],[1,"input-group","col-md-8"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],[1,"faq"],["src","../../assets/images/Ajolotecontacto.jpeg","alt","",2,"width","70%","margin-left","60px"],[1,"invalid-feedback"]],template:function(t,i){if(1&t&&(pe(0,"section",0)(1,"div",1)(2,"form",2),$t("ngSubmit",function(){return i.guardarCambios()}),pe(3,"h3"),Re(4,"Contactanos"),be(),pe(5,"div",3)(6,"div",4)(7,"label",5),Re(8,"Nombre"),be(),pe(9,"div",6),St(10,"input",7),Zn(11,_ce,2,0,"div",8),Zn(12,yce,2,0,"div",8),be()(),St(13,"br")(14,"br"),pe(15,"div",4)(16,"label",5),Re(17,"Apellido"),be(),pe(18,"div",6),St(19,"input",9),be()(),St(20,"br")(21,"br"),pe(22,"div",4)(23,"label",5),Re(24,"Correo"),be(),pe(25,"div",6),St(26,"input",10),Zn(27,vce,2,0,"div",8),Zn(28,bce,2,0,"div",8),be()(),St(29,"br"),pe(30,"div",4)(31,"label",5),Re(32,"\xa0"),be(),pe(33,"div",11)(34,"button",12),Re(35,"Enviar"),be()()()()(),pe(36,"div",13),St(37,"img",14),be()()()),2&t){let r,s;oi(2),sn("formGroup",i.forma),oi(8),sn("ngClass",Vw(8,Y4,!(null!=(r=i.forma.get("nombre"))&&r.valid))),oi(1),sn("ngIf",null==i.forma.controls.nombre.errors?null:i.forma.controls.nombre.errors.required),oi(1),sn("ngIf",null==i.forma.controls.nombre.errors?null:i.forma.controls.nombre.errors.minlength),oi(14),sn("ngClass",Vw(10,Y4,!(null!=(s=i.forma.get("correo"))&&s.valid))),oi(1),sn("ngIf",null==i.forma.controls.correo.errors?null:i.forma.controls.correo.errors.required),oi(1),sn("ngIf",null==i.forma.controls.correo.errors?null:i.forma.controls.correo.errors.email),oi(6),sn("disabled",i.forma.invalid)}},dependencies:[CD,TD,IC,ip,sy,_C,V0,DC],styles:["form[_ngcontent-%COMP%]{height:550px;font-size:18px}label[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{font-size:15px}"]}),n})(),wce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-questions"]],decls:32,vars:0,consts:[["id","contact",1,"contact"],["width","100%","src","../../assets/images/tiraAjolote.jpeg","alt",""],[1,"row"],[1,"faq"],[1,"title"],[1,"box","active"]],template:function(t,i){1&t&&(pe(0,"section",0),St(1,"img",1),pe(2,"div",2)(3,"div",3)(4,"h3",4),Re(5,"Preguntas Frecuentes"),be(),pe(6,"div",5)(7,"h3"),Re(8,"\xbfComo cancelar?"),be(),pe(9,"p"),Re(10,"Lamentablemente las cancelaciones no pueden hacerce en linea, por lo que es necesario contactarnos por telefono."),be()(),pe(11,"div",5)(12,"h3"),Re(13,"\xbfComo veo la disponibilidad?"),be(),pe(14,"p"),Re(15,"Puedes seleccionar la fecha estimada en nuestro apartado de reservas y seste indicar\xe1 si la fecha, habitacion y/o servicios estan disponibles."),be()(),pe(16,"div",5)(17,"h3"),Re(18,"\xbfCuales metodos de pago son aceptados?"),be(),pe(19,"p"),Re(20,"Aceptamos todo tipo de metodos de pago!, tarjeta, efectivo y transferencias"),be()(),pe(21,"div",5)(22,"h3"),Re(23,"\xbfComo reservo?"),be(),pe(24,"p"),Re(25,"Puede ser directamente desde nuestra pagina web o si bien lo prefieres comunicandote a nuestro numero telefonico"),be()(),pe(26,"div",5)(27,"h3"),Re(28,"\xbfCuales son los requisitos para una reservacion?"),be(),pe(29,"p"),Re(30,"Somos un hotel familiar por lo que no hay requisitos, todas las edades son bienvenidas!"),be()()()(),St(31,"img",1),be())}}),n})();function Ice(n,e){if(1&n&&(pe(0,"tr")(1,"td"),Re(2),be(),pe(3,"td"),Re(4),be(),pe(5,"td"),Re(6),be(),pe(7,"td"),Re(8),be()()),2&n){const t=e.$implicit;oi(2),fh(t.nombre),oi(2),fh(t.fecha),oi(2),fh(t.hora),oi(2),fh(t.tipoHabitacion)}}const Dce=[{path:"",component:zae},{path:"login",component:(()=>{class n{constructor(t,i){this.userService=t,this.router=i,this.formLogin=new F0({email:new Wm,password:new Wm})}ngOnInit(){}onSubmit(){this.userService.login(this.formLogin.value).then(t=>{console.log("iniciado con exito"),console.log(t),this.router.navigate(["/"])}).catch(t=>{jP().fire({icon:"error",title:"Error",text:"Usuario o contrase\xf1a invalidos"}),console.log(t)})}onClick(){this.userService.loginWithGoogle().then(t=>{console.log("iniciado con exito"),console.log(t),this.router.navigate(["/"])}).catch(t=>{jP().fire({icon:"error",title:"Error",text:"Usuario o contrase\xf1a invalidos"}),console.log("nada"),console.log(t)})}}return n.\u0275fac=function(t){return new(t||n)(nt(_0),nt(Qs))},n.\u0275cmp=pr({type:n,selectors:[["app-login"]],decls:20,vars:1,consts:[[1,"container"],[1,"form-container",3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","email",1,"form-control"],["type","password","formControlName","password",1,"form-control"],["type","submit","value","Enviar",1,"submit-btn"],[1,"btn","btn-info",3,"click"],[1,"register-link"],["routerLink","registro"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"h2"),Re(2,"Login"),be(),pe(3,"form",1),$t("ngSubmit",function(){return i.onSubmit()}),pe(4,"div",2)(5,"label",3),Re(6,"Email"),be(),St(7,"input",4),be(),pe(8,"div",2)(9,"label",3),Re(10,"Password"),be(),St(11,"input",5),be(),St(12,"input",6),be(),pe(13,"button",7),$t("click",function(){return i.onClick()}),Re(14,"Login with Google"),be(),pe(15,"div",8)(16,"p"),Re(17,"No tienes cuenta? "),pe(18,"a",9),Re(19,"Registrate aqui"),be()()()()),2&t&&(oi(3),sn("formGroup",i.formLogin))},dependencies:[iy,IC,ip,sy,_C,V0,DC],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:10vh auto;padding:20px;width:50%;background-color:#f9c;border-radius:10px;box-shadow:0 2px 4px #0000001a}h2[_ngcontent-%COMP%]{color:#333;text-align:center;margin-bottom:20px}.form-container[_ngcontent-%COMP%]{width:50%;margin-bottom:20px}.mb-3[_ngcontent-%COMP%]{margin-bottom:10px}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;color:#333}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#b8174d;color:#fff;border:none;cursor:pointer}.submit-btn[_ngcontent-%COMP%]:hover{background-color:#b8174d}.btn[_ngcontent-%COMP%]{width:50%;padding:10px;background-color:#b8174d;color:#fff;border:none;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#96136f}@media (max-width: 767px){.container[_ngcontent-%COMP%]{width:100%;padding:0 10px}.form-container[_ngcontent-%COMP%], .submit-btn[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{padding:8px}}.register-link[_ngcontent-%COMP%]{text-align:center;margin-top:10px}.register-link[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.register-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#f35221;text-decoration:underline;cursor:pointer}"]}),n})()},{path:"sms",component:(()=>{class n{constructor(t,i){this.userService=t,this.router=i,this.phoneNumber="",this.verificationCode="",this.auth=lE()}ngOnInit(){this.recaptchaVerifier=new Eee("recaptcha-container",{size:"invisible"},this.auth)}sendSMSVerificationCode(){this.userService.enviarCodigoSMS(this.phoneNumber,this.recaptchaVerifier).then(()=>{console.log("Numero enviado correctamente")}).catch(t=>{console.log("Fallo al enviar el codigo")})}verifySMSCode(){this.userService.verificarCodigoSMS(this.verificationCode).then(t=>{t?(console.log(t),this.router.navigate(["/login"])):console.error("Error al verificar el c\xf3digo SMS")}).catch(t=>{console.error("Error al verificar el c\xf3digo SMS",t)})}}return n.\u0275fac=function(t){return new(t||n)(nt(_0),nt(Qs))},n.\u0275cmp=pr({type:n,selectors:[["app-sms"]],decls:17,vars:2,consts:[[1,"container"],[1,"form-group"],["for","phone-input"],["type","text","id","phone-input",3,"ngModel","ngModelChange"],["id","recaptcha-container",3,"click"],["for","code-input"],["type","text","id","code-input",3,"ngModel","ngModelChange"],[3,"click"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"h1"),Re(2,"Agrega un n\xfamero telef\xf3nico"),be(),pe(3,"div",1)(4,"label",2),Re(5,"N\xfamero de tel\xe9fono:"),be(),pe(6,"input",3),$t("ngModelChange",function(s){return i.phoneNumber=s}),be()(),pe(7,"div",1)(8,"button",4),$t("click",function(){return i.sendSMSVerificationCode()}),Re(9,"Enviar c\xf3digo SMS"),be()(),pe(10,"div",1)(11,"label",5),Re(12,"C\xf3digo de verificaci\xf3n SMS:"),be(),pe(13,"input",6),$t("ngModelChange",function(s){return i.verificationCode=s}),be()(),pe(14,"div",1)(15,"button",7),$t("click",function(){return i.verifySMSCode()}),Re(16,"Verificar c\xf3digo SMS"),be()()()),2&t&&(oi(6),sn("ngModel",i.phoneNumber),oi(7),sn("ngModel",i.verificationCode))},dependencies:[ip,sy,z0],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:10vh auto;padding:20px;width:50%;background-color:#f9c;border-radius:10px;box-shadow:0 2px 4px #0000001a}h1[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px}input[type=text][_ngcontent-%COMP%]{width:100%;padding:8px;font-size:16px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}button[_ngcontent-%COMP%]{display:block;width:100%;padding:10px;font-size:16px;background-color:#b8174d;color:#fff;border:none;border-radius:4px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#ff66a3}@media (max-width: 768px){input[type=text][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:100%}}"]}),n})()},{path:"about",component:Vae},{path:"registro",component:(()=>{class n{constructor(t,i){this.userService=t,this.router=i,this.cita={},this.minDate=(new Date).toISOString().split("T")[0]}ngOnInit(){}guardarCita(){this.userService.guardarCita(this.cita).then(()=>{console.log("Cita guardada"),this.router.navigate(["/reservaciones"])}).catch(t=>{console.error("Error al guardar la cita",t)})}}return n.\u0275fac=function(t){return new(t||n)(nt(_0),nt(Qs))},n.\u0275cmp=pr({type:n,selectors:[["app-formulario"]],decls:30,vars:5,consts:[[1,"container"],[1,"form-container",3,"ngSubmit"],["type","text","name","nombre","required","",3,"ngModel","ngModelChange"],["type","date","name","fecha","required","",3,"ngModel","min","ngModelChange"],["type","time","name","hora","required","",3,"ngModel","ngModelChange"],["name","tipoHabitacion","required","",3,"ngModel","ngModelChange"],["value",""],["value","Sencilla"],["value","Doble"],["value","Suite"],["type","submit"]],template:function(t,i){1&t&&(pe(0,"div",0)(1,"form",1),$t("ngSubmit",function(){return i.guardarCita()}),pe(2,"h2"),Re(3,"Guardar Cita"),be(),pe(4,"div")(5,"label"),Re(6,"Nombre:"),be(),pe(7,"input",2),$t("ngModelChange",function(s){return i.cita.nombre=s}),be()(),pe(8,"div")(9,"label"),Re(10,"Fecha:"),be(),pe(11,"input",3),$t("ngModelChange",function(s){return i.cita.fecha=s}),be()(),pe(12,"div")(13,"label"),Re(14,"Hora:"),be(),pe(15,"input",4),$t("ngModelChange",function(s){return i.cita.hora=s}),be()(),pe(16,"div")(17,"label"),Re(18,"Tipo de Habitaci\xf3n:"),be(),pe(19,"select",5),$t("ngModelChange",function(s){return i.cita.tipoHabitacion=s}),pe(20,"option",6),Re(21,"Seleccione"),be(),pe(22,"option",7),Re(23,"Sencilla"),be(),pe(24,"option",8),Re(25,"Doble"),be(),pe(26,"option",9),Re(27,"Suite"),be()()(),pe(28,"button",10),Re(29,"Guardar"),be()()()),2&t&&(oi(7),sn("ngModel",i.cita.nombre),oi(4),sn("ngModel",i.cita.fecha)("min",i.minDate),oi(4),sn("ngModel",i.cita.hora),oi(4),sn("ngModel",i.cita.tipoHabitacion))},dependencies:[IC,C4,I4,ip,SC,sy,_C,AC,z0,TC],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin:10vh auto;padding:20px;width:50%;background-color:#f9c;border-radius:10px;box-shadow:0 2px 4px #0000001a}.form-container[_ngcontent-%COMP%]{background-color:#ce4e8e;width:100%;padding:20px;border-radius:10px}h2[_ngcontent-%COMP%]{color:#fff;text-align:center;margin-top:0;padding-top:20px}label[_ngcontent-%COMP%]{color:#fff}input[type=text][_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], input[type=time][_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background-color:#fff;color:#ff0080;width:100%;padding:5px;border:none;border-radius:5px;margin-bottom:10px}button[type=submit][_ngcontent-%COMP%]{background-color:#fff;color:#ff0080;width:100%;padding:10px;border:none;border-radius:5px;cursor:pointer}"]}),n})()},{path:"reservaciones",component:(()=>{class n{constructor(){this.citas=[],this.db=UP()}ngOnInit(){p5(zP(this.db,"citas"),i=>{const r=i.val();this.citas=r?Object.values(r):[]})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=pr({type:n,selectors:[["app-lista"]],decls:15,vars:1,consts:[[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&(pe(0,"h2"),Re(1,"Listado de Citas"),be(),pe(2,"table")(3,"thead")(4,"tr")(5,"th"),Re(6,"Nombre"),be(),pe(7,"th"),Re(8,"Fecha"),be(),pe(9,"th"),Re(10,"Hora"),be(),pe(11,"th"),Re(12,"Tipo de Habitaci\xf3n"),be()()(),pe(13,"tbody"),Zn(14,Ice,9,4,"tr",0),be()()),2&t&&(oi(14),sn("ngForOf",i.citas))},dependencies:[a1],styles:["h2[_ngcontent-%COMP%]{color:#ff1493;text-align:center}table[_ngcontent-%COMP%]{width:50%;margin:0 auto;border-collapse:collapse;border:1px solid #FF69B4}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px;border:1px solid #FF69B4}th[_ngcontent-%COMP%]{background-color:pink;color:#fff}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#ffb6c1}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#ffa07a;color:#fff}"]}),n})()},{path:"galeria",component:jae},{path:"habitacion-list",component:Hle},{path:"habitacion/:habitacion",component:Kle},{path:"contact",component:xce},{path:"questions",component:wce}];let Sce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Aj.forRoot(Dce),Aj]}),n})();class K4{}class Ace{}const Oh="*";function X4(n,e=null){return{type:2,steps:n,options:e}}function Sl(n){return{type:6,styles:n,offset:null}}function J4(n){Promise.resolve().then(n)}class $0{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){J4(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class e${constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?J4(()=>this._onFinish()):this.players.forEach(u=>{u.onDone(()=>{++t==s&&this._onFinish()}),u.onDestroy(()=>{++i==s&&this._onDestroy()}),u.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((u,m)=>Math.max(u,m.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const j2="!";function t$(n){return new ot(3e3,!1)}function hue(){return typeof window<"u"&&typeof window.document<"u"}function $2(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function up(n){switch(n.length){case 0:return new $0;case 1:return n[0];default:return new e$(n)}}function n$(n,e,t,i,r=new Map,s=new Map){const u=[],m=[];let v=-1,C=null;if(i.forEach(S=>{const R=S.get("offset"),j=R==v,K=j&&C||new Map;S.forEach((ie,we)=>{let Oe=we,Ke=ie;if("offset"!==we)switch(Oe=e.normalizePropertyName(Oe,u),Ke){case j2:Ke=r.get(we);break;case Oh:Ke=s.get(we);break;default:Ke=e.normalizeStyleValue(we,Oe,Ke,u)}K.set(Oe,Ke)}),j||m.push(K),C=K,v=R}),u.length)throw function eue(n){return new ot(3502,!1)}();return m}function H2(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&G2(t,"start",n)));break;case"done":n.onDone(()=>i(t&&G2(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&G2(t,"destroy",n)))}}function G2(n,e,t){const s=W2(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),u=n._data;return null!=u&&(s._data=u),s}function W2(n,e,t,i,r="",s=0,u){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!u}}function Jl(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function i$(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let q2=(n,e)=>!1,r$=(n,e,t)=>[],o$=null;function Z2(n){const e=n.parentNode||n.host;return e===o$?null:e}($2()||typeof Element<"u")&&(hue()?(o$=(()=>document.documentElement)(),q2=(n,e)=>{for(;e;){if(e===n)return!0;e=Z2(e)}return!1}):q2=(n,e)=>n.contains(e),r$=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let Ym=null,s$=!1;const a$=q2,l$=r$;let c$=(()=>{class n{validateStyleProperty(t){return function pue(n){Ym||(Ym=function mue(){return typeof document<"u"?document.body:null}()||{},s$=!!Ym.style&&"WebkitAppearance"in Ym.style);let e=!0;return Ym.style&&!function fue(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Ym.style,!e&&s$&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Ym.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return a$(t,i)}getParentElement(t){return Z2(t)}query(t,i,r){return l$(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,u,m=[],v){return new $0(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),Y2=(()=>{class n{}return n.NOOP=new c$,n})();const gue=1e3,K2="ng-enter",OC="ng-leave",FC="ng-trigger",LC=".ng-trigger",d$="ng-animating",X2=".ng-animating";function Fh(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Q2(parseFloat(e[1]),e[2])}function Q2(n,e){return"s"===e?n*gue:n}function NC(n,e,t){return n.hasOwnProperty("duration")?n:function yue(n,e,t){let r,s=0,u="";if("string"==typeof n){const m=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===m)return e.push(t$()),{duration:0,delay:0,easing:""};r=Q2(parseFloat(m[1]),m[2]);const v=m[3];null!=v&&(s=Q2(parseFloat(v),m[4]));const C=m[5];C&&(u=C)}else r=n;if(!t){let m=!1,v=e.length;r<0&&(e.push(function Rce(){return new ot(3100,!1)}()),m=!0),s<0&&(e.push(function Pce(){return new ot(3101,!1)}()),m=!0),m&&e.splice(v,0,t$())}return{duration:r,delay:s,easing:u}}(n,e,t)}function H0(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function h$(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function dp(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function p$(n,e,t){return t?e+":"+t+";":""}function m$(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=p$(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=p$(0,wue(t),n.style[t]));n.setAttribute("style",e)}function Od(n,e,t){n.style&&(e.forEach((i,r)=>{const s=eO(r);t&&!t.has(r)&&t.set(r,n.style[s]),n.style[s]=i}),$2()&&m$(n))}function Km(n,e){n.style&&(e.forEach((t,i)=>{const r=eO(i);n.style[r]=""}),$2()&&m$(n))}function G0(n){return Array.isArray(n)?1==n.length?n[0]:X4(n):n}const J2=new RegExp("{{\\s*(.+?)\\s*}}","g");function g$(n){let e=[];if("string"==typeof n){let t;for(;t=J2.exec(n);)e.push(t[1]);J2.lastIndex=0}return e}function W0(n,e,t){const i=n.toString(),r=i.replace(J2,(s,u)=>{let m=e[u];return null==m&&(t.push(function Fce(n){return new ot(3003,!1)}()),m=""),m.toString()});return r==i?n:r}function BC(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const xue=/-+([a-z0-9])/g;function eO(n){return n.replace(xue,(...e)=>e[1].toUpperCase())}function wue(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ec(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function Lce(n){return new ot(3004,!1)}()}}function _$(n,e){return window.getComputedStyle(n)[e]}const UC="*";function Sue(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Aue(n,e,t){if(":"==n[0]){const v=function Mue(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function Kce(n){return new ot(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof v)return void e.push(v);n=v}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function Yce(n){return new ot(3015,!1)}()),e;const r=i[1],s=i[2],u=i[3];e.push(y$(r,u));"<"==s[0]&&!(r==UC&&u==UC)&&e.push(y$(u,r))}(i,t,e)):t.push(n),t}const jC=new Set(["true","1"]),$C=new Set(["false","0"]);function y$(n,e){const t=jC.has(n)||$C.has(n),i=jC.has(e)||$C.has(e);return(r,s)=>{let u=n==UC||n==r,m=e==UC||e==s;return!u&&t&&"boolean"==typeof r&&(u=r?jC.has(n):$C.has(n)),!m&&i&&"boolean"==typeof s&&(m=s?jC.has(e):$C.has(e)),u&&m}}const kue=new RegExp("s*:selfs*,?","g");function tO(n,e,t,i){return new Rue(n).build(e,t,i)}class Rue{constructor(e){this._driver=e}build(e,t,i){const r=new Fue(t);return this._resetContextStyleTimingState(r),ec(this,G0(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],u=[];return"@"==e.name.charAt(0)&&t.errors.push(function Bce(){return new ot(3006,!1)}()),e.definitions.forEach(m=>{if(this._resetContextStyleTimingState(t),0==m.type){const v=m,C=v.name;C.toString().split(/\s*,\s*/).forEach(S=>{v.name=S,s.push(this.visitState(v,t))}),v.name=C}else if(1==m.type){const v=this.visitTransition(m,t);i+=v.queryCount,r+=v.depCount,u.push(v)}else t.errors.push(function zce(){return new ot(3007,!1)}())}),{type:7,name:e.name,states:s,transitions:u,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,u=r||{};i.styles.forEach(m=>{m instanceof Map&&m.forEach(v=>{g$(v).forEach(C=>{u.hasOwnProperty(C)||s.add(C)})})}),s.size&&(BC(s.values()),t.errors.push(function Vce(n,e){return new ot(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=ec(this,G0(e.animation),t);return{type:1,matchers:Sue(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Xm(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>ec(this,i,t)),options:Xm(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(u=>{t.currentTime=i;const m=ec(this,u,t);return r=Math.max(r,t.currentTime),m});return t.currentTime=r,{type:3,steps:s,options:Xm(e.options)}}visitAnimate(e,t){const i=function Nue(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return nO(NC(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=nO(0,0,"");return s.dynamic=!0,s.strValue=t,s}const r=NC(t,e);return nO(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:Sl({});if(5==s.type)r=this.visitKeyframes(s,t);else{let u=e.styles,m=!1;if(!u){m=!0;const C={};i.easing&&(C.easing=i.easing),u=Sl(C)}t.currentTime+=i.duration+i.delay;const v=this.visitStyle(u,t);v.isEmptyStep=m,r=v}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let m of r)"string"==typeof m?m===Oh?i.push(m):t.errors.push(new ot(3002,!1)):i.push(h$(m));let s=!1,u=null;return i.forEach(m=>{if(m instanceof Map&&(m.has("easing")&&(u=m.get("easing"),m.delete("easing")),!s))for(let v of m.values())if(v.toString().indexOf("{{")>=0){s=!0;break}}),{type:6,styles:i,easing:u,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(u=>{"string"!=typeof u&&u.forEach((m,v)=>{const C=t.collectedStyles.get(t.currentQuerySelector),S=C.get(v);let R=!0;S&&(s!=r&&s>=S.startTime&&r<=S.endTime&&(t.errors.push(function jce(n,e,t,i,r){return new ot(3010,!1)}()),R=!1),s=S.startTime),R&&C.set(v,{startTime:s,endTime:r}),t.options&&function bue(n,e,t){const i=e.params||{},r=g$(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(function Oce(n){return new ot(3001,!1)}())})}(m,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function $ce(){return new ot(3011,!1)}()),i;let s=0;const u=[];let m=!1,v=!1,C=0;const S=e.steps.map(Ke=>{const _t=this._makeStyleAst(Ke,t);let Qe=null!=_t.offset?_t.offset:function Lue(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(_t.styles),Ht=0;return null!=Qe&&(s++,Ht=_t.offset=Qe),v=v||Ht<0||Ht>1,m=m||Ht<C,C=Ht,u.push(Ht),_t});v&&t.errors.push(function Hce(){return new ot(3012,!1)}()),m&&t.errors.push(function Gce(){return new ot(3200,!1)}());const R=e.steps.length;let j=0;s>0&&s<R?t.errors.push(function Wce(){return new ot(3202,!1)}()):0==s&&(j=1/(R-1));const K=R-1,ie=t.currentTime,we=t.currentAnimateTimings,Oe=we.duration;return S.forEach((Ke,_t)=>{const Qe=j>0?_t==K?1:j*_t:u[_t],Ht=Qe*Oe;t.currentTime=ie+we.delay+Ht,we.duration=Ht,this._validateStyleAst(Ke,t),Ke.offset=Qe,i.styles.push(Ke)}),i}visitReference(e,t){return{type:8,animation:ec(this,G0(e.animation),t),options:Xm(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Xm(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Xm(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,u]=function Pue(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(kue,"")),n=n.replace(/@\*/g,LC).replace(/@\w+/g,t=>LC+"-"+t.slice(1)).replace(/:animating/g,X2),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Jl(t.collectedStyles,t.currentQuerySelector,new Map);const m=ec(this,G0(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:u,animation:m,originalSelector:e.selector,options:Xm(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function qce(){return new ot(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:NC(e.timings,t.errors,!0);return{type:12,animation:ec(this,G0(e.animation),t),timings:i,options:null}}}class Fue{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Xm(n){return n?(n=H0(n)).params&&(n.params=function Oue(n){return n?H0(n):null}(n.params)):n={},n}function nO(n,e,t){return{duration:n,delay:e,easing:t}}function iO(n,e,t,i,r,s,u=null,m=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:u,subTimeline:m}}class HC{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const Vue=new RegExp(":enter","g"),jue=new RegExp(":leave","g");function rO(n,e,t,i,r,s=new Map,u=new Map,m,v,C=[]){return(new $ue).buildKeyframes(n,e,t,i,r,s,u,m,v,C)}class $ue{buildKeyframes(e,t,i,r,s,u,m,v,C,S=[]){C=C||new HC;const R=new oO(e,t,C,r,s,S,[]);R.options=v;const j=v.delay?Fh(v.delay):0;R.currentTimeline.delayNextStep(j),R.currentTimeline.setStyles([u],null,R.errors,v),ec(this,i,R);const K=R.timelines.filter(ie=>ie.containsAnimation());if(K.length&&m.size){let ie;for(let we=K.length-1;we>=0;we--){const Oe=K[we];if(Oe.element===t){ie=Oe;break}}ie&&!ie.allowOnlyTimelineStyles()&&ie.setStyles([m],null,R.errors,v)}return K.length?K.map(ie=>ie.buildKeyframes()):[iO(t,[],[],[],0,j,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,u=this._visitSubInstructions(i,r,r.options);s!=u&&t.transformIntoNewTimeline(u)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const r of e){const s=r?.delay;if(s){const u="number"==typeof s?s:Fh(W0(s,r?.params??{},t.errors));i.delayNextStep(u)}}}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const u=null!=i.duration?Fh(i.duration):null,m=null!=i.delay?Fh(i.delay):null;return 0!==u&&e.forEach(v=>{const C=t.appendInstructionToTimeline(v,u,m);s=Math.max(s,C.duration+C.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),ec(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=GC);const u=Fh(s.delay);r.delayNextStep(u)}e.steps.length&&(e.steps.forEach(u=>ec(this,u,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Fh(e.options.delay):0;e.steps.forEach(u=>{const m=t.createSubContext(e.options);s&&m.delayNextStep(s),ec(this,u,m),r=Math.max(r,m.currentTimeline.currentTime),i.push(m.currentTimeline)}),i.forEach(u=>t.currentTimeline.mergeTimelineCollectedStyles(u)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return NC(t.params?W0(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,m=t.createSubContext().currentTimeline;m.easing=i.easing,e.styles.forEach(v=>{m.forwardTime((v.offset||0)*s),m.setStyles(v.styles,v.easing,t.errors,t.options),m.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(m),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Fh(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=GC);let u=i;const m=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=m.length;let v=null;m.forEach((C,S)=>{t.currentQueryIndex=S;const R=t.createSubContext(e.options,C);s&&R.delayNextStep(s),C===t.element&&(v=R.currentTimeline),ec(this,e.animation,R),R.currentTimeline.applyStylesToKeyframe(),u=Math.max(u,R.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(u),v&&(t.currentTimeline.mergeTimelineCollectedStyles(v),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,u=Math.abs(s.duration),m=u*(t.currentQueryTotal-1);let v=u*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":v=m-v;break;case"full":v=i.currentStaggerTime}const S=t.currentTimeline;v&&S.delayNextStep(v);const R=S.currentTime;ec(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-R+(r.startTime-i.currentTimeline.startTime)}}const GC={};class oO{constructor(e,t,i,r,s,u,m,v){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=u,this.timelines=m,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=GC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=v||new WC(this._driver,t,0),m.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Fh(i.duration)),null!=i.delay&&(r.delay=Fh(i.delay));const s=i.params;if(s){let u=r.params;u||(u=this.options.params={}),Object.keys(s).forEach(m=>{(!t||!u.hasOwnProperty(m))&&(u[m]=W0(s[m],u,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new oO(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=GC,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},s=new Hue(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,u){let m=[];if(r&&m.push(this.element),e.length>0){e=(e=e.replace(Vue,"."+this._enterClassName)).replace(jue,"."+this._leaveClassName);let C=this._driver.query(this.element,e,1!=i);0!==i&&(C=i<0?C.slice(C.length+i,C.length):C.slice(0,i)),m.push(...C)}return!s&&0==m.length&&u.push(function Zce(n){return new ot(3014,!1)}()),m}}class WC{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new WC(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Oh),this._currentKeyframe.set(t,Oh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&this._previousKeyframe.set("easing",t);const s=r&&r.params||{},u=function Gue(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let s of i)t.set(s,Oh)}else dp(r,t)}),t}(e,this._globalTimelineStyles);for(let[m,v]of u){const C=W0(v,s,i);this._pendingStyles.set(m,C),this._localTimelineStyles.has(m)||this._backFill.set(m,this._globalTimelineStyles.get(m)??Oh),this._updateStyle(m,C)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((m,v)=>{const C=dp(m,new Map,this._backFill);C.forEach((S,R)=>{S===j2?e.add(R):S===Oh&&t.add(R)}),i||C.set("offset",v/this.duration),r.push(C)});const s=e.size?BC(e.values()):[],u=t.size?BC(t.values()):[];if(i){const m=r[0],v=new Map(m);m.set("offset",0),v.set("offset",1),r=[m,v]}return iO(this.element,r,s,u,this.duration,this.startTime,this.easing,!1)}}class Hue extends WC{constructor(e,t,i,r,s,u,m=!1){super(e,t,u.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=m,this.timings={duration:u.duration,delay:u.delay,easing:u.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],u=i+t,m=t/u,v=dp(e[0]);v.set("offset",0),s.push(v);const C=dp(e[0]);C.set("offset",x$(m)),s.push(C);const S=e.length-1;for(let R=1;R<=S;R++){let j=dp(e[R]);const K=j.get("offset");j.set("offset",x$((t+K*i)/u)),s.push(j)}i=u,t=0,r="",e=s}return iO(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function x$(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class sO{}const Wue=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class que extends sO{normalizePropertyName(e,t){return eO(e)}normalizeStyleValue(e,t,i,r){let s="";const u=i.toString().trim();if(Wue.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const m=i.match(/^[+-]?[\d\.]+([a-z]*)$/);m&&0==m[1].length&&r.push(function Nce(n,e){return new ot(3005,!1)}())}return u+s}}function w$(n,e,t,i,r,s,u,m,v,C,S,R,j){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:u,timelines:m,queriedElements:v,preStyleProps:C,postStyleProps:S,totalTime:R,errors:j}}const aO={};class E${constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Zue(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,s,u,m,v,C,S){const R=[],j=this.ast.options&&this.ast.options.params||aO,ie=this.buildStyles(i,m&&m.params||aO,R),we=v&&v.params||aO,Oe=this.buildStyles(r,we,R),Ke=new Set,_t=new Map,Qe=new Map,Ht="void"===r,ui={params:Yue(we,j),delay:this.ast.options?.delay},Oi=S?[]:rO(e,t,this.ast.animation,s,u,ie,Oe,ui,C,R);let ls=0;if(Oi.forEach(tc=>{ls=Math.max(tc.duration+tc.delay,ls)}),R.length)return w$(t,this._triggerName,i,r,Ht,ie,Oe,[],[],_t,Qe,ls,R);Oi.forEach(tc=>{const Wu=tc.element,NH=Jl(_t,Wu,new Set);tc.preStyleProps.forEach(tg=>NH.add(tg));const ix=Jl(Qe,Wu,new Set);tc.postStyleProps.forEach(tg=>ix.add(tg)),Wu!==t&&Ke.add(Wu)});const Gu=BC(Ke.values());return w$(t,this._triggerName,i,r,Ht,ie,Oe,Oi,Gu,_t,Qe,ls)}}function Yue(n,e){const t=H0(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class Kue{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=H0(this.defaultParams);return Object.keys(e).forEach(s=>{const u=e[s];null!==u&&(r[s]=u)}),this.styles.styles.forEach(s=>{"string"!=typeof s&&s.forEach((u,m)=>{u&&(u=W0(u,r,t));const v=this.normalizer.normalizePropertyName(m,t);u=this.normalizer.normalizeStyleValue(m,v,u,t),i.set(m,u)})}),i}}class Que{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new Kue(r.style,r.options&&r.options.params||{},i))}),C$(this.states,"true","1"),C$(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new E$(e,r,this.states))}),this.fallbackTransition=function Jue(n,e,t){return new E$(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(u,m)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(u=>u.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function C$(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const ede=new HC;class tde{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],r=[],s=tO(this._driver,t,i,r);if(i.length)throw function tue(n){return new ot(3503,!1)}();this._animations.set(e,s)}_buildPlayer(e,t,i){const r=e.element,s=n$(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations.get(e);let u;const m=new Map;if(s?(u=rO(this._driver,t,s,K2,OC,new Map,new Map,i,ede,r),u.forEach(S=>{const R=Jl(m,S.element,new Map);S.postStyleProps.forEach(j=>R.set(j,null))})):(r.push(function nue(){return new ot(3300,!1)}()),u=[]),r.length)throw function iue(n){return new ot(3504,!1)}();m.forEach((S,R)=>{S.forEach((j,K)=>{S.set(K,this._driver.computeStyle(R,K,Oh))})});const C=up(u.map(S=>{const R=m.get(S.element);return this._buildPlayer(S,new Map,R)}));return this._playersById.set(e,C),C.onDestroy(()=>this.destroy(e)),this.players.push(C),C}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function rue(n){return new ot(3301,!1)}();return t}listen(e,t,i,r){const s=W2(t,"","","");return H2(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const T$="ng-animate-queued",lO="ng-animate-disabled",sde=[],I$={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ade={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},jc="__ng_removed";class cO{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function dde(n){return n??null}(i?e.value:e),i){const s=H0(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const q0="void",uO=new cO(q0);class lde{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,$c(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function oue(n,e){return new ot(3302,!1)}();if(null==i||0==i.length)throw function sue(n){return new ot(3303,!1)}();if(!function hde(n){return"start"==n||"done"==n}(i))throw function aue(n,e){return new ot(3400,!1)}();const s=Jl(this._elementListeners,e,[]),u={name:t,phase:i,callback:r};s.push(u);const m=Jl(this._engine.statesByElement,e,new Map);return m.has(t)||($c(e,FC),$c(e,FC+"-"+t),m.set(t,uO)),()=>{this._engine.afterFlush(()=>{const v=s.indexOf(u);v>=0&&s.splice(v,1),this._triggers.has(t)||m.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function lue(n){return new ot(3401,!1)}();return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),u=new dO(this.id,t,e);let m=this._engine.statesByElement.get(e);m||($c(e,FC),$c(e,FC+"-"+t),this._engine.statesByElement.set(e,m=new Map));let v=m.get(t);const C=new cO(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&v&&C.absorbOptions(v.options),m.set(t,C),v||(v=uO),C.value!==q0&&v.value===C.value){if(!function mde(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(v.params,C.params)){const we=[],Oe=s.matchStyles(v.value,v.params,we),Ke=s.matchStyles(C.value,C.params,we);we.length?this._engine.reportError(we):this._engine.afterFlush(()=>{Km(e,Oe),Od(e,Ke)})}return}const j=Jl(this._engine.playersByElement,e,[]);j.forEach(we=>{we.namespaceId==this.id&&we.triggerName==t&&we.queued&&we.destroy()});let K=s.matchTransition(v.value,C.value,e,C.params),ie=!1;if(!K){if(!r)return;K=s.fallbackTransition,ie=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:K,fromState:v,toState:C,player:u,isFallbackTransition:ie}),ie||($c(e,T$),u.onStart(()=>{uy(e,T$)})),u.onDone(()=>{let we=this.players.indexOf(u);we>=0&&this.players.splice(we,1);const Oe=this._engine.playersByElement.get(e);if(Oe){let Ke=Oe.indexOf(u);Ke>=0&&Oe.splice(Ke,1)}}),this.players.push(u),j.push(u),u}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,LC,!0);i.forEach(r=>{if(r[jc])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(u=>u.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),u=new Map;if(s){const m=[];if(s.forEach((v,C)=>{if(u.set(C,v.value),this._triggers.has(C)){const S=this.trigger(e,C,q0,r);S&&m.push(S)}}),m.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,u),i&&up(m).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const u=s.name;if(r.has(u))return;r.add(u);const v=this._triggers.get(u).fallbackTransition,C=i.get(u)||uO,S=new cO(q0),R=new dO(this.id,u,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:u,transition:v,fromState:C,toState:S,player:R,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let u=e;for(;u=u.parentNode;)if(i.statesByElement.get(u)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[jc];(!s||s===I$)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){$c(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,u=this._elementListeners.get(s);u&&u.forEach(m=>{if(m.name==i.triggerName){const v=W2(s,i.triggerName,i.fromState.value,i.toState.value);v._data=e,H2(i.player,m.phase,v,m.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,u=r.transition.ast.depCount;return 0==s||0==u?s-u:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class cde{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new lde(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let u=!1,m=this.driver.getParentElement(t);for(;m;){const v=r.get(m);if(v){const C=i.indexOf(v);i.splice(C+1,0,e),u=!0;break}m=this.driver.getParentElement(m)}u||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}return t}trigger(e,t,i,r){if(qC(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!qC(t))return;const s=t[jc];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const u=this.collectedLeaveElements.indexOf(t);u>=0&&this.collectedLeaveElements.splice(u,1)}if(e){const u=this._fetchNamespace(e);u&&u.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),$c(e,lO)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),uy(e,lO))}removeNode(e,t,i,r){if(qC(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const u=this.namespacesByHostElement.get(t);u&&u.id!==e&&u.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[jc]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return qC(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,LC,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,X2,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return up(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[jc];if(t&&t.setForRemoval){if(e[jc]=I$,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(lO)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)$c(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?up(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function cue(n){return new ot(3402,!1)}()}_flushAnimations(e,t){const i=new HC,r=[],s=new Map,u=[],m=new Map,v=new Map,C=new Map,S=new Set;this.disabledNodes.forEach(pn=>{S.add(pn);const In=this.driver.query(pn,".ng-animate-queued",!0);for(let Bn=0;Bn<In.length;Bn++)S.add(In[Bn])});const R=this.bodyNode,j=Array.from(this.statesByElement.keys()),K=A$(j,this.collectedEnterElements),ie=new Map;let we=0;K.forEach((pn,In)=>{const Bn=K2+we++;ie.set(In,Bn),pn.forEach(Ki=>$c(Ki,Bn))});const Oe=[],Ke=new Set,_t=new Set;for(let pn=0;pn<this.collectedLeaveElements.length;pn++){const In=this.collectedLeaveElements[pn],Bn=In[jc];Bn&&Bn.setForRemoval&&(Oe.push(In),Ke.add(In),Bn.hasAnimation?this.driver.query(In,".ng-star-inserted",!0).forEach(Ki=>Ke.add(Ki)):_t.add(In))}const Qe=new Map,Ht=A$(j,Array.from(Ke));Ht.forEach((pn,In)=>{const Bn=OC+we++;Qe.set(In,Bn),pn.forEach(Ki=>$c(Ki,Bn))}),e.push(()=>{K.forEach((pn,In)=>{const Bn=ie.get(In);pn.forEach(Ki=>uy(Ki,Bn))}),Ht.forEach((pn,In)=>{const Bn=Qe.get(In);pn.forEach(Ki=>uy(Ki,Bn))}),Oe.forEach(pn=>{this.processLeaveNode(pn)})});const ui=[],Oi=[];for(let pn=this._namespaceList.length-1;pn>=0;pn--)this._namespaceList[pn].drainQueuedTransitions(t).forEach(Bn=>{const Ki=Bn.player,Ls=Bn.element;if(ui.push(Ki),this.collectedEnterElements.length){const ya=Ls[jc];if(ya&&ya.setForMove){if(ya.previousTriggersValues&&ya.previousTriggersValues.has(Bn.triggerName)){const ng=ya.previousTriggersValues.get(Bn.triggerName),Hc=this.statesByElement.get(Bn.element);if(Hc&&Hc.has(Bn.triggerName)){const hT=Hc.get(Bn.triggerName);hT.value=ng,Hc.set(Bn.triggerName,hT)}}return void Ki.destroy()}}const Ld=!R||!this.driver.containsElement(R,Ls),nc=Qe.get(Ls),fp=ie.get(Ls),no=this._buildInstruction(Bn,i,fp,nc,Ld);if(no.errors&&no.errors.length)return void Oi.push(no);if(Ld)return Ki.onStart(()=>Km(Ls,no.fromStyles)),Ki.onDestroy(()=>Od(Ls,no.toStyles)),void r.push(Ki);if(Bn.isFallbackTransition)return Ki.onStart(()=>Km(Ls,no.fromStyles)),Ki.onDestroy(()=>Od(Ls,no.toStyles)),void r.push(Ki);const VH=[];no.timelines.forEach(ya=>{ya.stretchStartingKeyframe=!0,this.disabledNodes.has(ya.element)||VH.push(ya)}),no.timelines=VH,i.append(Ls,no.timelines),u.push({instruction:no,player:Ki,element:Ls}),no.queriedElements.forEach(ya=>Jl(m,ya,[]).push(Ki)),no.preStyleProps.forEach((ya,ng)=>{if(ya.size){let Hc=v.get(ng);Hc||v.set(ng,Hc=new Set),ya.forEach((hT,PO)=>Hc.add(PO))}}),no.postStyleProps.forEach((ya,ng)=>{let Hc=C.get(ng);Hc||C.set(ng,Hc=new Set),ya.forEach((hT,PO)=>Hc.add(PO))})});if(Oi.length){const pn=[];Oi.forEach(In=>{pn.push(function uue(n,e){return new ot(3505,!1)}())}),ui.forEach(In=>In.destroy()),this.reportError(pn)}const ls=new Map,Gu=new Map;u.forEach(pn=>{const In=pn.element;i.has(In)&&(Gu.set(In,In),this._beforeAnimationBuild(pn.player.namespaceId,pn.instruction,ls))}),r.forEach(pn=>{const In=pn.element;this._getPreviousPlayers(In,!1,pn.namespaceId,pn.triggerName,null).forEach(Ki=>{Jl(ls,In,[]).push(Ki),Ki.destroy()})});const tc=Oe.filter(pn=>k$(pn,v,C)),Wu=new Map;S$(Wu,this.driver,_t,C,Oh).forEach(pn=>{k$(pn,v,C)&&tc.push(pn)});const ix=new Map;K.forEach((pn,In)=>{S$(ix,this.driver,new Set(pn),v,j2)}),tc.forEach(pn=>{const In=Wu.get(pn),Bn=ix.get(pn);Wu.set(pn,new Map([...Array.from(In?.entries()??[]),...Array.from(Bn?.entries()??[])]))});const tg=[],BH=[],zH={};u.forEach(pn=>{const{element:In,player:Bn,instruction:Ki}=pn;if(i.has(In)){if(S.has(In))return Bn.onDestroy(()=>Od(In,Ki.toStyles)),Bn.disabled=!0,Bn.overrideTotalTime(Ki.totalTime),void r.push(Bn);let Ls=zH;if(Gu.size>1){let nc=In;const fp=[];for(;nc=nc.parentNode;){const no=Gu.get(nc);if(no){Ls=no;break}fp.push(nc)}fp.forEach(no=>Gu.set(no,Ls))}const Ld=this._buildAnimation(Bn.namespaceId,Ki,ls,s,ix,Wu);if(Bn.setRealPlayer(Ld),Ls===zH)tg.push(Bn);else{const nc=this.playersByElement.get(Ls);nc&&nc.length&&(Bn.parentPlayer=up(nc)),r.push(Bn)}}else Km(In,Ki.fromStyles),Bn.onDestroy(()=>Od(In,Ki.toStyles)),BH.push(Bn),S.has(In)&&r.push(Bn)}),BH.forEach(pn=>{const In=s.get(pn.element);if(In&&In.length){const Bn=up(In);pn.setRealPlayer(Bn)}}),r.forEach(pn=>{pn.parentPlayer?pn.syncPlayerEvents(pn.parentPlayer):pn.destroy()});for(let pn=0;pn<Oe.length;pn++){const In=Oe[pn],Bn=In[jc];if(uy(In,OC),Bn&&Bn.hasAnimation)continue;let Ki=[];if(m.size){let Ld=m.get(In);Ld&&Ld.length&&Ki.push(...Ld);let nc=this.driver.query(In,X2,!0);for(let fp=0;fp<nc.length;fp++){let no=m.get(nc[fp]);no&&no.length&&Ki.push(...no)}}const Ls=Ki.filter(Ld=>!Ld.destroyed);Ls.length?fde(this,In,Ls):this.processLeaveNode(In)}return Oe.length=0,tg.forEach(pn=>{this.players.push(pn),pn.onDone(()=>{pn.destroy();const In=this.players.indexOf(pn);this.players.splice(In,1)}),pn.play()}),tg}elementContainsData(e,t){let i=!1;const r=t[jc];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let u=[];if(t){const m=this.playersByQueriedElement.get(e);m&&(u=m)}else{const m=this.playersByElement.get(e);if(m){const v=!s||s==q0;m.forEach(C=>{C.queued||!v&&C.triggerName!=r||u.push(C)})}}return(i||r)&&(u=u.filter(m=>!(i&&i!=m.namespaceId||r&&r!=m.triggerName))),u}_beforeAnimationBuild(e,t,i){const s=t.element,u=t.isRemovalTransition?void 0:e,m=t.isRemovalTransition?void 0:t.triggerName;for(const v of t.timelines){const C=v.element,S=C!==s,R=Jl(i,C,[]);this._getPreviousPlayers(C,S,u,m,t.toState).forEach(K=>{const ie=K.getRealPlayer();ie.beforeDestroy&&ie.beforeDestroy(),K.destroy(),R.push(K)})}Km(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,u){const m=t.triggerName,v=t.element,C=[],S=new Set,R=new Set,j=t.timelines.map(ie=>{const we=ie.element;S.add(we);const Oe=we[jc];if(Oe&&Oe.removedBeforeQueried)return new $0(ie.duration,ie.delay);const Ke=we!==v,_t=function pde(n){const e=[];return M$(n,e),e}((i.get(we)||sde).map(ls=>ls.getRealPlayer())).filter(ls=>!!ls.element&&ls.element===we),Qe=s.get(we),Ht=u.get(we),ui=n$(0,this._normalizer,0,ie.keyframes,Qe,Ht),Oi=this._buildPlayer(ie,ui,_t);if(ie.subTimeline&&r&&R.add(we),Ke){const ls=new dO(e,m,we);ls.setRealPlayer(Oi),C.push(ls)}return Oi});C.forEach(ie=>{Jl(this.playersByQueriedElement,ie.element,[]).push(ie),ie.onDone(()=>function ude(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,ie.element,ie))}),S.forEach(ie=>$c(ie,d$));const K=up(j);return K.onDestroy(()=>{S.forEach(ie=>uy(ie,d$)),Od(v,t.toStyles)}),R.forEach(ie=>{Jl(r,ie,[]).push(K)}),K}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new $0(e.duration,e.delay)}}class dO{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new $0,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>H2(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Jl(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function qC(n){return n&&1===n.nodeType}function D$(n,e){const t=n.style.display;return n.style.display=e??"none",t}function S$(n,e,t,i,r){const s=[];t.forEach(v=>s.push(D$(v)));const u=[];i.forEach((v,C)=>{const S=new Map;v.forEach(R=>{const j=e.computeStyle(C,R,r);S.set(R,j),(!j||0==j.length)&&(C[jc]=ade,u.push(C))}),n.set(C,S)});let m=0;return t.forEach(v=>D$(v,s[m++])),u}function A$(n,e){const t=new Map;if(n.forEach(m=>t.set(m,[])),0==e.length)return t;const i=1,r=new Set(e),s=new Map;function u(m){if(!m)return i;let v=s.get(m);if(v)return v;const C=m.parentNode;return v=t.has(C)?C:r.has(C)?i:u(C),s.set(m,v),v}return e.forEach(m=>{const v=u(m);v!==i&&t.get(v).push(m)}),t}function $c(n,e){n.classList?.add(e)}function uy(n,e){n.classList?.remove(e)}function fde(n,e,t){up(t).onDone(()=>n.processLeaveNode(e))}function M$(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof e$?M$(i.players,e):e.push(i)}}function k$(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class ZC{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new cde(e,t,i),this._timelineEngine=new tde(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const u=e+"-"+r;let m=this._triggerCache[u];if(!m){const v=[],C=[],S=tO(this._driver,s,v,C);if(v.length)throw function Jce(n,e){return new ot(3404,!1)}();m=function Xue(n,e,t){return new Que(n,e,t)}(r,S,this._normalizer),this._triggerCache[u]=m}this._transitionEngine.registerTrigger(t,r,m)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,u]=i$(i);this._timelineEngine.command(s,t,u,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[u,m]=i$(i);return this._timelineEngine.listen(u,t,m,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let _de=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Od(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Od(this._element,this._initialStyles),this._endStyles&&(Od(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Km(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Km(this._element,this._endStyles),this._endStyles=null),Od(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function hO(n){let e=null;return n.forEach((t,i)=>{(function yde(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class R${constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:_$(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class vde{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return a$(e,t)}getParentElement(e){return Z2(e)}query(e,t,i){return l$(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,s,u=[]){const v={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(v.easing=s);const C=new Map,S=u.filter(K=>K instanceof R$);(function Eue(n,e){return 0===n||0===e})(i,r)&&S.forEach(K=>{K.currentSnapshot.forEach((ie,we)=>C.set(we,ie))});let R=function vue(n){return n.length?n[0]instanceof Map?n:n.map(e=>h$(e)):[]}(t).map(K=>dp(K));R=function Cue(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((s,u)=>{i.has(u)||r.push(u),i.set(u,s)}),r.length)for(let s=1;s<e.length;s++){let u=e[s];r.forEach(m=>u.set(m,_$(n,m)))}}return e}(e,R,C);const j=function gde(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=hO(e[0]),e.length>1&&(i=hO(e[e.length-1]))):e instanceof Map&&(t=hO(e)),t||i?new _de(n,t,i):null}(e,R);return new R$(e,R,v,j)}}let bde=(()=>{class n extends K4{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Xo.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?X4(t):t;return P$(this._renderer,null,i,"register",[r]),new xde(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(lt(Eu),lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class xde extends Ace{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new wde(this._id,e,t||{},this._renderer)}}class wde{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return P$(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function P$(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const O$="@.disabled";let Ede=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,u)=>{const m=u?.parentNode(s);m&&u.removeChild(m,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let S=this._rendererCache.get(s);return S||(S=new F$("",s,this.engine,()=>this._rendererCache.delete(s)),this._rendererCache.set(s,S)),S}const u=i.id,m=i.id+"-"+this._currentId;this._currentId++,this.engine.register(m,t);const v=S=>{Array.isArray(S)?S.forEach(v):this.engine.registerTrigger(u,m,t,S.name,S)};return i.data.animation.forEach(v),new Cde(this,m,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[u,m]=s;u(m)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(lt(Eu),lt(ZC),lt(Ti))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class F${constructor(e,t,i,r){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?s=>t.destroyNode(s):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==O$?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Cde extends F${constructor(e,t,i,r,s){super(t,i,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==O$?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Tde(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.slice(1),u="";return"@"!=s.charAt(0)&&([s,u]=function Ide(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,u,m=>{this.factory.scheduleListenerCallback(m._data||-1,i,m)})}return this.delegate.listen(e,t,i)}}const L$=[{provide:K4,useClass:bde},{provide:sO,useFactory:function Sde(){return new que}},{provide:ZC,useClass:(()=>{class n extends ZC{constructor(t,i,r,s){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi),lt(Y2),lt(sO),lt(cm))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})()},{provide:Eu,useFactory:function Ade(n,e,t){return new Ede(n,e,t)},deps:[p1,ZC,Ti]}],fO=[{provide:Y2,useFactory:()=>new vde},{provide:QI,useValue:"BrowserAnimations"},...L$],N$=[{provide:Y2,useClass:c$},{provide:QI,useValue:"NoopAnimations"},...L$];let pO,Mde=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?N$:fO}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:fO,imports:[cB]}),n})(),kde=(()=>{class n{constructor(){}guardarRegistro(t){let i=JSON.parse(localStorage.getItem("registros")||"[]");i.push(t),localStorage.setItem("registros",JSON.stringify(i))}obtenerRegistros(){return JSON.parse(localStorage.getItem("registros")||"[]")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();try{pO=typeof Intl<"u"&&Intl.v8BreakIterator}catch{pO=!1}let Z0,KC,Qm,Lh=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?AD(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!pO)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(lt(lm))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Y0(n){return function Rde(){if(null==Z0&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Z0=!0}))}finally{Z0=Z0||!1}return Z0}()?n:!!n.capture}function z$(){if(null==Qm){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Qm=!1,Qm;if("scrollBehavior"in document.documentElement.style)Qm=!0;else{const n=Element.prototype.scrollTo;Qm=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Qm}function K0(){if("object"!=typeof document||!document)return 0;if(null==KC){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),KC=0,0===n.scrollLeft&&(n.scrollLeft=1,KC=0===n.scrollLeft?1:2),n.remove()}return KC}function gO(n){return n.composedPath?n.composedPath()[0]:n.target}function _O(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}let Vde=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),U$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[Vde]}),n})();function XC(n){return Array.isArray(n)?n:[n]}function Wo(n){return null==n?"":"string"==typeof n?n:`${n}px`}function yO(n){return n instanceof Kr?n.nativeElement:n}function QC(n){return ti((e,t)=>{W(n).subscribe(zn(t,()=>t.complete(),dn)),!t.closed&&e.subscribe(t)})}const $$=new Set;let hy,Hde=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Wde}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Gde(n){if(!$$.has(n))try{hy||(hy=document.createElement("style"),hy.setAttribute("type","text/css"),document.head.appendChild(hy)),hy.sheet&&(hy.sheet.insertRule(`@media ${n} {body{ }}`,0),$$.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(lt(Lh))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Wde(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let qde=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new si}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return H$(XC(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=HP(H$(XC(t)).map(u=>this._registerQuery(u).observable));return s=Z_(s.pipe(_a(1)),s.pipe(function jde(n){return Fs((e,t)=>n<=t)}(1),function $de(n,e=Ab){return ti((t,i)=>{let r=null,s=null,u=null;const m=()=>{if(r){r.unsubscribe(),r=null;const C=s;s=null,i.next(C)}};function v(){const C=u+n,S=e.now();if(S<C)return r=this.schedule(void 0,C-S),void i.add(r);m()}t.subscribe(zn(i,C=>{s=C,u=e.now(),r||(r=e.schedule(v,n),i.add(r))},()=>{m(),i.complete()},void 0,()=>{s=r=null}))})}(0))),s.pipe(cn(u=>{const m={matches:!1,breakpoints:{}};return u.forEach(({matches:v,query:C})=>{m.matches=m.matches||v,m.breakpoints[C]=v}),m}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new xn(u=>{const m=v=>this._zone.run(()=>u.next(v));return i.addListener(m),()=>{i.removeListener(m)}}).pipe(qP(i),cn(({matches:u})=>({query:t,matches:u})),QC(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(lt(Hde),lt(Ti))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function H$(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}const Z$="cdk-high-contrast-black-on-white",Y$="cdk-high-contrast-white-on-black",vO="cdk-high-contrast-active";let K$=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=En(qde).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(vO,Z$,Y$),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(vO,Z$):2===i&&t.add(vO,Y$)}}}return n.\u0275fac=function(t){return new(t||n)(lt(Lh),lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rhe=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(lt(K$))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[U$]}),n})();const ohe=["addListener","removeListener"],she=["addEventListener","removeEventListener"],ahe=["on","off"];function fy(n,e,t,i){if(Vt(t)&&(i=t,t=void 0),i)return fy(n,e,t).pipe($P(i));const[r,s]=function uhe(n){return Vt(n.addEventListener)&&Vt(n.removeEventListener)}(n)?she.map(u=>m=>n[u](e,m,t)):function lhe(n){return Vt(n.addListener)&&Vt(n.removeListener)}(n)?ohe.map(X$(n,e)):function che(n){return Vt(n.on)&&Vt(n.off)}(n)?ahe.map(X$(n,e)):[];if(!r&&ja(n))return tt(u=>fy(u,e,t))(W(n));if(!r)throw new TypeError("Invalid event target");return new xn(u=>{const m=(...v)=>u.next(1<v.length?v:v[0]);return r(m),()=>s(m)})}function X$(n,e){return t=>i=>n[t](e,i)}const X0={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=X0;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new ze(()=>t?.(r))},requestAnimationFrame(...n){const{delegate:e}=X0;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=X0;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},fhe=new class hhe extends O1{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class dhe extends P1{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=X0.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(X0.cancelAnimationFrame(t),e._scheduled=void 0)}});let bO,phe=1;const JC={};function Q$(n){return n in JC&&(delete JC[n],!0)}const mhe={setImmediate(n){const e=phe++;return JC[e]=!0,bO||(bO=Promise.resolve()),bO.then(()=>Q$(e)&&n()),e},clearImmediate(n){Q$(n)}},{setImmediate:ghe,clearImmediate:_he}=mhe,eT={setImmediate(...n){const{delegate:e}=eT;return(e?.setImmediate||ghe)(...n)},clearImmediate(n){const{delegate:e}=eT;return(e?.clearImmediate||_he)(n)},delegate:void 0},bhe=new class vhe extends O1{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class yhe extends P1{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=eT.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:s}=e;null!=t&&(null===(r=s[s.length-1])||void 0===r?void 0:r.id)!==t&&(eT.clearImmediate(t),e._scheduled===t&&(e._scheduled=void 0))}});function J$(n=0,e,t=AX){let i=-1;return null!=e&&(Dn(e)?t=e:i=e),new xn(r=>{let s=function whe(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let u=0;return t.schedule(function(){r.closed||(r.next(u++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function xO(n,e=Ab){return function xhe(n){return ti((e,t)=>{let i=!1,r=null,s=null,u=!1;const m=()=>{if(s?.unsubscribe(),s=null,i){i=!1;const C=r;r=null,t.next(C)}u&&t.complete()},v=()=>{s=null,u&&t.complete()};e.subscribe(zn(t,C=>{i=!0,r=C,s||W(n(C)).subscribe(s=zn(t,m,v))},()=>{u=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>J$(n,e))}const Ehe=new Ct("cdk-dir-doc",{providedIn:"root",factory:function Che(){return En(Yi)}}),The=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let tT=(()=>{class n{constructor(t){this.value="ltr",this.change=new Ir,t&&(this.value=function Ihe(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?The.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(lt(Ehe,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Q0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();const Dhe=["contentWrapper"],She=["*"],Ahe=new Ct("VIRTUAL_SCROLL_STRATEGY");let nT=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new si,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new xn(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(xO(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):fn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Fs(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=yO(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>fy(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(lt(Ti),lt(Lh),lt(Yi,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),eH=(()=>{class n{constructor(t,i,r,s){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=s,this._destroyed=new si,this._elementScrolled=new xn(u=>this.ngZone.runOutsideAngular(()=>fy(this.elementRef.nativeElement,"scroll").pipe(QC(this._destroyed)).subscribe(u)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=K0()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==K0()?t.left=t.right:1==K0()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;z$()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",r="right",s=this.elementRef.nativeElement;if("top"==t)return s.scrollTop;if("bottom"==t)return s.scrollHeight-s.clientHeight-s.scrollTop;const u=this.dir&&"rtl"==this.dir.value;return"start"==t?t=u?r:i:"end"==t&&(t=u?i:r),u&&2==K0()?t==i?s.scrollWidth-s.clientWidth-s.scrollLeft:s.scrollLeft:u&&1==K0()?t==i?s.scrollLeft+s.scrollWidth-s.clientWidth:-s.scrollLeft:t==i?s.scrollLeft:s.scrollWidth-s.clientWidth-s.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(nT),nt(Ti),nt(tT,8))},n.\u0275dir=vn({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),wO=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new si,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(xO(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(lt(Lh),lt(Ti),lt(Yi,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const tH=new Ct("VIRTUAL_SCROLLABLE");let Rhe=(()=>{class n extends eH{constructor(t,i,r,s){super(t,i,r,s)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(nT),nt(Ti),nt(tT,8))},n.\u0275dir=vn({type:n,features:[Ni]}),n})();const Ohe=typeof requestAnimationFrame<"u"?fhe:bhe;let Fhe=(()=>{class n extends Rhe{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=function j$(n){return null!=n&&"false"!=`${n}`}(t)}constructor(t,i,r,s,u,m,v,C){super(t,m,r,u),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=s,this.scrollable=C,this._platform=En(Lh),this._detachedSubject=new si,this._renderedRangeSubject=new si,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new xn(S=>this._scrollStrategy.scrolledIndexChange.subscribe(R=>Promise.resolve().then(()=>this.ngZone.run(()=>S.next(R))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=ze.EMPTY,this._viewportChanges=v.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe(qP(null),xO(0,Ohe)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(QC(this._detachedSubject)).subscribe(i=>{const r=i.length;r!==this._dataLength&&(this._dataLength=r,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function Phe(n,e){return n.start==e.start&&n.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const s="horizontal"==this.orientation,u=s?"X":"Y";let v=`translate${u}(${Number((s&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(v+=` translate${u}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=v&&(this._renderedContentTransform=v,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const r={behavior:i};"horizontal"===this.orientation?r.start=t:r.top=t,this.scrollable.scrollTo(r)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?r=>super.measureScrollOffset(r):r=>this.scrollable.measureScrollOffset(r),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const r="left",s="right",u="rtl"==this.dir?.value;i="start"==t?u?s:r:"end"==t?u?r:s:t||("horizontal"===this.orientation?"left":"top");const m=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-m}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(t){return new(t||n)(nt(Kr),nt(mb),nt(Ti),nt(Ahe,8),nt(tT,8),nt(nT),nt(wO),nt(tH,8))},n.\u0275cmp=pr({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,i){if(1&t&&bL(Dhe,7),2&t){let r;HI(r=function GI(){return function u8(n,e){return n[xs].queries[e].queryList}(gt(),h())}())&&(i._contentWrapper=r.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,i){2&t&&nb("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[Tr([{provide:eH,useFactory:(e,t)=>e||t,deps:[[new or,new Tc(tH)],n]}]),Ni,OI],ngContentSelectors:She,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,i){1&t&&(function Jv(n){const e=gt()[zr][Hr];if(!e.projection){const i=e.projection=Sp(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const u=n?kw(s,n):0;null!==u&&(r[u]?r[u].projectionNext=s:i[u]=s,r[u]=s),s=s.next}}}(),pe(0,"div",0,1),function c_(n,e=0,t){const i=gt(),r=di(),s=Au(r,Ri+n,16,null,t||null);null===s.projection&&(s.projection=e),Jh(),32!=(32&s.flags)&&function Ex(n,e,t){Cx(e[$n],0,e,t,Cg(n,t,e),Hy(t.parent||e[Hr],t,e))}(r,i,s)}(2),be(),St(3,"div",2)),2&t&&(oi(3),CI("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),iT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})(),nH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Q0,iT,Fhe,Q0,iT]}),n})();class EO{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class Lhe extends EO{constructor(e,t,i,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r,this.projectableNodes=s}}class Nhe extends EO{constructor(e,t,i,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class Bhe extends EO{constructor(e){super(),this.element=e instanceof Kr?e.nativeElement:e}}class zhe{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof Lhe?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof Nhe?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof Bhe?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Vhe extends zhe{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=u=>{const m=u.element,v=this._document.createComment("dom-portal");m.parentNode.insertBefore(v,m),this.outletElement.appendChild(m),this._attachedPortal=u,super.setDisposeFn(()=>{v.parentNode&&v.parentNode.replaceChild(m,v)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||Uo.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let iH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();const rH=z$();class Uhe{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Wo(-this._previousScrollPosition.left),e.style.top=Wo(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",u=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),rH&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),rH&&(i.scrollBehavior=s,r.scrollBehavior=u)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class jhe{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(Fs(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class oH{enable(){}disable(){}attach(){}}function CO(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function sH(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class $he{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();CO(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Hhe=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new oH,this.close=u=>new jhe(this._scrollDispatcher,this._ngZone,this._viewportRuler,u),this.block=()=>new Uhe(this._viewportRuler,this._document),this.reposition=u=>new $he(this._scrollDispatcher,this._viewportRuler,this._ngZone,u),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(lt(nT),lt(wO),lt(Ti),lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ghe{constructor(e){if(this.scrollStrategy=new oH,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class Whe{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let aH=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),qhe=(()=>{class n extends aH{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let u=s.length-1;u>-1;u--)if(s[u]._keydownEvents.observers.length>0){const m=s[u]._keydownEvents;this._ngZone?this._ngZone.run(()=>m.next(r)):m.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi),lt(Ti,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Zhe=(()=>{class n extends aH{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=gO(s)},this._clickListener=s=>{const u=gO(s),m="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:u;this._pointerDownEventTarget=null;const v=this._attachedOverlays.slice();for(let C=v.length-1;C>-1;C--){const S=v[C];if(S._outsidePointerEvents.observers.length<1||!S.hasAttached())continue;if(S.overlayElement.contains(u)||S.overlayElement.contains(m))break;const R=S._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>R.next(s)):R.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi),lt(Lh),lt(Ti,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),lH=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||_O()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),_O()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(lt(Yi),lt(Lh))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Yhe{constructor(e,t,i,r,s,u,m,v,C,S=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=u,this._document=m,this._location=v,this._outsideClickDispatcher=C,this._animationsDisabled=S,this._backdropElement=null,this._backdropClick=new si,this._attachments=new si,this._detachments=new si,this._locationChanges=ze.EMPTY,this._backdropClickHandler=R=>this._backdropClick.next(R),this._backdropTransitionendHandler=R=>{this._disposeBackdrop(R.target)},this._keydownEvents=new si,this._outsidePointerEvents=new si,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(_a(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Wo(this._config.width),e.height=Wo(this._config.height),e.minWidth=Wo(this._config.minWidth),e.minHeight=Wo(this._config.minHeight),e.maxWidth=Wo(this._config.maxWidth),e.maxHeight=Wo(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const r=XC(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(QC(xa(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const cH="cdk-overlay-connected-position-bounding-box",Khe=/([A-Za-z%]+)$/;class Xhe{get positions(){return this._preferredPositions}constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new si,this._resizeSubscription=ze.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(cH),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let u;for(let m of this._preferredPositions){let v=this._getOriginPoint(e,r,m),C=this._getOverlayPoint(v,t,m),S=this._getOverlayFit(C,t,i,m);if(S.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(m,v);this._canFitWithFlexibleDimensions(S,C,i)?s.push({position:m,origin:v,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(v,m)}):(!u||u.overlayFit.visibleArea<S.visibleArea)&&(u={overlayFit:S,overlayPoint:C,originPoint:v,position:m,overlayRect:t})}if(s.length){let m=null,v=-1;for(const C of s){const S=C.boundingBoxRect.width*C.boundingBoxRect.height*(C.position.weight||1);S>v&&(v=S,m=C)}return this._isPushed=!1,void this._applyPosition(m.position,m.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(u.position,u.originPoint);this._applyPosition(u.position,u.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Jm(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(cH),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const u=this._isRtl()?e.right:e.left,m=this._isRtl()?e.left:e.right;r="start"==i.originX?u:m}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=dH(t);let{x:u,y:m}=e,v=this._getOffset(r,"x"),C=this._getOffset(r,"y");v&&(u+=v),C&&(m+=C);let j=0-m,K=m+s.height-i.height,ie=this._subtractOverflows(s.width,0-u,u+s.width-i.width),we=this._subtractOverflows(s.height,j,K),Oe=ie*we;return{visibleArea:Oe,isCompletelyWithinViewport:s.width*s.height===Oe,fitsInViewportVertically:we===s.height,fitsInViewportHorizontally:ie==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,u=uH(this._overlayRef.getConfig().minHeight),m=uH(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=u&&u<=r)&&(e.fitsInViewportHorizontally||null!=m&&m<=s)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=dH(t),s=this._viewportRect,u=Math.max(e.x+r.width-s.width,0),m=Math.max(e.y+r.height-s.height,0),v=Math.max(s.top-i.top-e.y,0),C=Math.max(s.left-i.left-e.x,0);let S=0,R=0;return S=r.width<=s.width?C||-u:e.x<this._viewportMargin?s.left-i.left-e.x:0,R=r.height<=s.height?v||-m:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:S,y:R},{x:e.x+S,y:e.y+R}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new Whe(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,u,m,S,R,j;if("top"===t.overlayY)u=e.y,s=i.height-u+this._viewportMargin;else if("bottom"===t.overlayY)m=i.height-e.y+2*this._viewportMargin,s=i.height-m+this._viewportMargin;else{const K=Math.min(i.bottom-e.y+i.top,e.y),ie=this._lastBoundingBoxSize.height;s=2*K,u=e.y-K,s>ie&&!this._isInitialRender&&!this._growAfterOpen&&(u=e.y-ie/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)j=i.width-e.x+this._viewportMargin,S=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)R=e.x,S=i.right-e.x;else{const K=Math.min(i.right-e.x+i.left,e.x),ie=this._lastBoundingBoxSize.width;S=2*K,R=e.x-K,S>ie&&!this._isInitialRender&&!this._growAfterOpen&&(R=e.x-ie/2)}return{top:u,left:R,bottom:m,right:j,width:S,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,u=this._overlayRef.getConfig().maxWidth;r.height=Wo(i.height),r.top=Wo(i.top),r.bottom=Wo(i.bottom),r.width=Wo(i.width),r.left=Wo(i.left),r.right=Wo(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Wo(s)),u&&(r.maxWidth=Wo(u))}this._lastBoundingBoxSize=i,Jm(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Jm(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Jm(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,u=this._overlayRef.getConfig();if(r){const S=this._viewportRuler.getViewportScrollPosition();Jm(i,this._getExactOverlayY(t,e,S)),Jm(i,this._getExactOverlayX(t,e,S))}else i.position="static";let m="",v=this._getOffset(t,"x"),C=this._getOffset(t,"y");v&&(m+=`translateX(${v}px) `),C&&(m+=`translateY(${C}px)`),i.transform=m.trim(),u.maxHeight&&(r?i.maxHeight=Wo(u.maxHeight):s&&(i.maxHeight="")),u.maxWidth&&(r?i.maxWidth=Wo(u.maxWidth):s&&(i.maxWidth="")),Jm(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Wo(s.y),r}_getExactOverlayX(e,t,i){let u,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),u=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===u?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Wo(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:sH(e,i),isOriginOutsideView:CO(e,i),isOverlayClipped:sH(t,i),isOverlayOutsideView:CO(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&XC(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof Kr)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Jm(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function uH(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(Khe);return t&&"px"!==t?null:parseFloat(e)}return n||null}function dH(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const hH="cdk-global-overlay-wrapper";class Qhe{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(hH),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:u,maxHeight:m}=i,v=!("100%"!==r&&"100vw"!==r||u&&"100%"!==u&&"100vw"!==u),C=!("100%"!==s&&"100vh"!==s||m&&"100%"!==m&&"100vh"!==m),S=this._xPosition,R=this._xOffset,j="rtl"===this._overlayRef.getConfig().direction;let K="",ie="",we="";v?we="flex-start":"center"===S?(we="center",j?ie=R:K=R):j?"left"===S||"end"===S?(we="flex-end",K=R):("right"===S||"start"===S)&&(we="flex-start",ie=R):"left"===S||"start"===S?(we="flex-start",K=R):("right"===S||"end"===S)&&(we="flex-end",ie=R),e.position=this._cssPosition,e.marginLeft=v?"0":K,e.marginTop=C?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=v?"0":ie,t.justifyContent=we,t.alignItems=C?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(hH),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let Jhe=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new Qhe}flexibleConnectedTo(t){return new Xhe(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(lt(wO),lt(Yi),lt(Lh),lt(lH))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),efe=0,rT=(()=>{class n{constructor(t,i,r,s,u,m,v,C,S,R,j,K){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=u,this._injector=m,this._ngZone=v,this._document=C,this._directionality=S,this._location=R,this._outsideClickDispatcher=j,this._animationsModuleType=K}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),u=new Ghe(t);return u.direction=u.direction||this._directionality.value,new Yhe(s,i,r,u,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+efe++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(cm)),new Vhe(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(lt(Hhe),lt(lH),lt(pd),lt(Jhe),lt(qhe),lt(Uo),lt(Ti),lt(Yi),lt(tT),lt(Kw),lt(Zhe),lt(QI,8))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ife={provide:new Ct("cdk-connected-overlay-scroll-strategy"),deps:[rT],useFactory:function nfe(n){return()=>n.scrollStrategies.reposition()}};let fH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[rT,ife],imports:[Q0,iH,nH,nH]}),n})();const ofe=new Ct("mat-sanity-checks",{providedIn:"root",factory:function rfe(){return!0}});let Ba=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!_O()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(lt(K$),lt(ofe,8),lt(Yi))},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Q0,Q0]}),n})();const sfe=new Ct("MAT_DATE_LOCALE",{providedIn:"root",factory:function afe(){return En(wd)}});class Fd{constructor(){this._localeChanges=new si,this.localeChanges=this._localeChanges}getValidDateOrNull(e){return this.isDateInstance(e)&&this.isValid(e)?e:null}deserialize(e){return null==e||this.isDateInstance(e)&&this.isValid(e)?e:this.invalid()}setLocale(e){this.locale=e,this._localeChanges.next()}compareDate(e,t){return this.getYear(e)-this.getYear(t)||this.getMonth(e)-this.getMonth(t)||this.getDate(e)-this.getDate(t)}sameDate(e,t){if(e&&t){let i=this.isValid(e),r=this.isValid(t);return i&&r?!this.compareDate(e,t):i==r}return e==t}clampDate(e,t,i){return t&&this.compareDate(e,t)<0?t:i&&this.compareDate(e,i)>0?i:e}}const TO=new Ct("mat-date-formats"),lfe=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function IO(n,e){const t=Array(n);for(let i=0;i<n;i++)t[i]=e(i);return t}let cfe=(()=>{class n extends Fd{constructor(t,i){super(),this.useUtcForDisplay=!1,super.setLocale(t)}getYear(t){return t.getFullYear()}getMonth(t){return t.getMonth()}getDate(t){return t.getDate()}getDayOfWeek(t){return t.getDay()}getMonthNames(t){const i=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return IO(12,r=>this._format(i,new Date(2017,r,1)))}getDateNames(){const t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return IO(31,i=>this._format(t,new Date(2017,0,i+1)))}getDayOfWeekNames(t){const i=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return IO(7,r=>this._format(i,new Date(2017,0,r+1)))}getYearName(t){const i=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(i,t)}getFirstDayOfWeek(){return 0}getNumDaysInMonth(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}clone(t){return new Date(t.getTime())}createDate(t,i,r){let s=this._createDateWithOverflow(t,i,r);return s.getMonth(),s}today(){return new Date}parse(t,i){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}format(t,i){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");const r=new Intl.DateTimeFormat(this.locale,{...i,timeZone:"utc"});return this._format(r,t)}addCalendarYears(t,i){return this.addCalendarMonths(t,12*i)}addCalendarMonths(t,i){let r=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+i,this.getDate(t));return this.getMonth(r)!=((this.getMonth(t)+i)%12+12)%12&&(r=this._createDateWithOverflow(this.getYear(r),this.getMonth(r),0)),r}addCalendarDays(t,i){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+i)}toIso8601(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}deserialize(t){if("string"==typeof t){if(!t)return null;if(lfe.test(t)){let i=new Date(t);if(this.isValid(i))return i}}return super.deserialize(t)}isDateInstance(t){return t instanceof Date}isValid(t){return!isNaN(t.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(t,i,r){const s=new Date;return s.setFullYear(t,i,r),s.setHours(0,0,0,0),s}_2digit(t){return("00"+t).slice(-2)}_format(t,i){const r=new Date;return r.setUTCFullYear(i.getFullYear(),i.getMonth(),i.getDate()),r.setUTCHours(i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()),t.format(r)}}return n.\u0275fac=function(t){return new(t||n)(lt(sfe,8),lt(Lh))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();const ufe={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let dfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[{provide:Fd,useClass:cfe}]}),n})(),hfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[{provide:TO,useValue:ufe}],imports:[dfe]}),n})();class ffe{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const gH=Y0({passive:!0,capture:!0});class pfe{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=gO(e);t&&this._events.get(e.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,i,r){const s=this._events.get(t);if(s){const u=s.get(i);u?u.add(r):s.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,gH)})}removeHandler(e,t,i){const r=this._events.get(e);if(!r)return;const s=r.get(t);s&&(s.delete(i),0===s.size&&r.delete(t),0===r.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,gH)))}}const _H={enterDuration:225,exitDuration:150},yH=Y0({passive:!0,capture:!0}),vH=["mousedown","touchstart"],bH=["mouseup","mouseleave","touchend","touchcancel"];class oT{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=yO(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s={..._H,...i.animation};i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const u=i.radius||function gfe(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),m=e-r.left,v=t-r.top,C=s.enterDuration,S=document.createElement("div");S.classList.add("mat-ripple-element"),S.style.left=m-u+"px",S.style.top=v-u+"px",S.style.height=2*u+"px",S.style.width=2*u+"px",null!=i.color&&(S.style.backgroundColor=i.color),S.style.transitionDuration=`${C}ms`,this._containerElement.appendChild(S);const R=window.getComputedStyle(S),K=R.transitionDuration,ie="none"===R.transitionProperty||"0s"===K||"0s, 0s"===K||0===r.width&&0===r.height,we=new ffe(this,S,i,ie);S.style.transform="scale3d(1, 1, 1)",we.state=0,i.persistent||(this._mostRecentTransientRipple=we);let Oe=null;return!ie&&(C||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Ke=()=>this._finishRippleTransition(we),_t=()=>this._destroyRipple(we);S.addEventListener("transitionend",Ke),S.addEventListener("transitioncancel",_t),Oe={onTransitionEnd:Ke,onTransitionCancel:_t}}),this._activeRipples.set(we,Oe),(ie||!C)&&this._finishRippleTransition(we),we}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={..._H,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=yO(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,vH.forEach(i=>{oT._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{bH.forEach(t=>{this._triggerElement.addEventListener(t,this,yH)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=function the(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!function nhe(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(vH.forEach(t=>oT._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&bH.forEach(t=>e.removeEventListener(t,this,yH)))}}oT._eventManager=new pfe;let xH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba,Ba]}),n})(),_fe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba]}),n})(),wH=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[xH,b_,Ba,_fe]}),n})(),bfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba,xH,Ba]}),n})(),sT=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba,b_,U$,Ba]}),n})(),Sfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})(),Mfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba,sT,sT,Sfe,Ba]}),n})(),Pfe=(()=>{class n{constructor(){this.changes=new si,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.closeCalendarLabel="Close calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 24 years",this.nextMultiYearLabel="Next 24 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year",this.startDateLabel="Start date",this.endDateLabel="End date"}formatYearRange(t,i){return`${t} \u2013 ${i}`}formatYearRangeLabel(t,i){return`${t} to ${i}`}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=Mt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const $fe={provide:new Ct("mat-datepicker-scroll-strategy"),deps:[rT],useFactory:function jfe(n){return()=>n.scrollStrategies.reposition()}};let Kfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[Pfe,$fe],imports:[b_,bfe,fH,rhe,iH,Ba,iT]}),n})(),npe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({imports:[Ba,Ba]}),n})();pi(9);let ipe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({}),n})();const lpe={provide:new Ct("mat-select-scroll-strategy"),deps:[rT],useFactory:function ape(n){return()=>n.scrollStrategies.reposition()}};let cpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[lpe],imports:[b_,fH,wH,Ba,iT,sT,wH,Ba]}),n})();const hp=new xn(dn),dpe={connector:()=>new si};function kH(n,e=dpe){const{connector:t}=e;return ti((i,r)=>{const s=t();W(n(function upe(n){return new xn(e=>n.subscribe(e))}(s))).subscribe(r),r.add(i.subscribe(s))})}function RH(n,e){return e?t=>Z_(e.pipe(_a(1),function ppe(){return ti((n,e)=>{n.subscribe(zn(e,dn))})}()),t.pipe(RH(n))):tt((t,i)=>W(n(t,i)).pipe(_a(1),T5(t)))}const nx="Service workers are disabled or not supported by this browser";class dT{constructor(e){if(this.serviceWorker=e,e){const i=fy(e,"controllerchange").pipe(cn(()=>e.controller)),s=Z_(GE(()=>fn(e.controller)),i);this.worker=s.pipe(Fs(S=>!!S)),this.registration=this.worker.pipe(Dl(()=>e.getRegistration()));const C=fy(e,"message").pipe(cn(S=>S.data)).pipe(Fs(S=>S&&S.type)).pipe(function fpe(n){return n?e=>kH(n)(e):e=>function hpe(n,e){const t=Vt(n)?n:()=>n;return Vt(e)?kH(e,{connector:t}):i=>new WP(i,t)}(new si)(e)}());C.connect(),this.events=C}else this.worker=this.events=this.registration=function gpe(n){return GE(()=>zm(new Error(n)))}(nx)}postMessage(e,t){return this.worker.pipe(_a(1),Io(i=>{i.postMessage({action:e,...t})})).toPromise().then(()=>{})}postMessageWithOperation(e,t,i){const r=this.waitForOperationCompleted(i),s=this.postMessage(e,t);return Promise.all([s,r]).then(([,u])=>u)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(e){let t;return t="string"==typeof e?i=>i.type===e:i=>e.includes(i.type),this.events.pipe(Fs(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(_a(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(Fs(t=>t.nonce===e),_a(1),cn(t=>{if(void 0!==t.result)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let _pe=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new si,!t.isEnabled)return this.messages=hp,this.notificationClicks=hp,void(this.subscription=hp);this.messages=this.sw.eventsOfType("PUSH").pipe(cn(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(cn(r=>r.data)),this.pushManager=this.sw.registration.pipe(cn(r=>r.pushManager));const i=this.pushManager.pipe(Dl(r=>r.getSubscription()));this.subscription=xa(i,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(nx));const i={userVisibleOnly:!0};let r=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(r.length));for(let u=0;u<r.length;u++)s[u]=r.charCodeAt(u);return i.applicationServerKey=s,this.pushManager.pipe(Dl(u=>u.subscribe(i)),_a(1)).toPromise().then(u=>(this.subscriptionChanges.next(u),u))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(_a(1),Dl(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(nx))}decodeBase64(t){return atob(t)}}return n.\u0275fac=function(t){return new(t||n)(lt(dT))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})(),ype=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled)return this.versionUpdates=hp,this.available=hp,this.activated=hp,void(this.unrecoverable=hp);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(Fs(i=>"VERSION_READY"===i.type),cn(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(nx));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(nx));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}}return n.\u0275fac=function(t){return new(t||n)(lt(dT))},n.\u0275prov=Mt({token:n,factory:n.\u0275fac}),n})();class MO{}const PH=new Ct("NGSW_REGISTER_SCRIPT");function vpe(n,e,t,i){return()=>{if(!AD(i)||!("serviceWorker"in navigator)||!1===t.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof t.registrationStrategy)r=t.registrationStrategy();else{const[u,...m]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(u){case"registerImmediately":r=fn(null);break;case"registerWithDelay":r=OH(+m[0]||0);break;case"registerWhenStable":r=m[0]?xa(FH(n),OH(+m[0])):FH(n);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}n.get(Ti).runOutsideAngular(()=>r.pipe(_a(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(u=>console.error("Service worker registration failed with:",u))))}}function OH(n){return fn(null).pipe(function mpe(n,e=Ab){const t=J$(n,e);return RH(()=>t)}(n))}function FH(n){return n.get(cm).isStable.pipe(Fs(t=>t))}function bpe(n,e){return new dT(AD(e)&&!1!==n.enabled?navigator.serviceWorker:void 0)}let xpe=(()=>{class n{static register(t,i={}){return{ngModule:n,providers:[{provide:PH,useValue:t},{provide:MO,useValue:i},{provide:dT,useFactory:bpe,deps:[MO,lm]},{provide:fb,useFactory:vpe,deps:[Uo,PH,MO,lm],multi:!0}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[_pe,ype]}),n})();const wpe_firebase={projectId:"pytowebangular",appId:"1:878131864286:web:76ba22bf05d23be7d6184f",databaseURL:"https://pytowebangular-default-rtdb.firebaseio.com",storageBucket:"pytowebangular.appspot.com",apiKey:"AIzaSyDfKlJmsv7MyzYm1L84iUMpeCVNopi7uEM",authDomain:"pytowebangular.firebaseapp.com",messagingSenderId:"878131864286",measurementId:"G-MCR5ETW79L"};class kO{constructor(e){return e}}const LH="database",RO=new Ct("angularfire2.database-instances");function Tpe(n){return(e,t)=>{const i=e.runOutsideAngular(()=>n(t));return new kO(i)}}const Ipe={provide:class Epe{constructor(){return nM(LH)}},deps:[[new or,RO]]},Dpe={provide:kO,useFactory:function Cpe(n,e){const t=tM(LH,n,e);return t&&new kO(t)},deps:[[new or,RO],A_]};let Spe=(()=>{class n{constructor(){po("angularfire",F1.full,"rtdb")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n}),n.\u0275inj=Pn({providers:[Dpe,Ipe]}),n})();function Ape(n,...e){return{ngModule:Spe,providers:[{provide:RO,useFactory:Tpe(n),multi:!0,deps:[Ti,Uo,iM,rM,[new or,v3],[new or,IM],...e]}]}}const Mpe=Ch(UP,!0);let kpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Yn({type:n,bootstrap:[Bae]}),n.\u0275inj=Pn({providers:[kj,kde,_0],imports:[cB,Sce,Mde,zle,Vle,Kfe,hfe,Mfe,sT,npe,ipe,b_,cpe,xpe.register("ngsw-worker.js",{enabled:!0,registrationStrategy:"registerWhenStable:30000"}),VX(()=>UX(wpe_firebase)),Dte(()=>lE()),Ape(()=>Mpe())]}),n})();L7().bootstrapModule(kpe).catch(n=>console.error(n))},730:(Fr,tn,pi)=>{var Vt,$e;!function(Hi,f){"use strict";Vt=function(){var f=function(){var ze=window.Element.prototype;if(ze.matches)return"matches";if(ze.matchesSelector)return"matchesSelector";for(var Qt=["webkit","moz","ms","o"],Pt=0;Pt<Qt.length;Pt++){var qe=Qt[Pt]+"MatchesSelector";if(ze[qe])return qe}}();return function(Qt,Pt){return Qt[f](Pt)}},void 0!==($e=Vt.call(tn,pi,tn,Fr))&&(Fr.exports=$e)}(window)},349:function(Fr,tn,pi){var Vt,$e;typeof window<"u"&&window,void 0!==($e="function"==typeof(Vt=function(){"use strict";function Hi(){}var f=Hi.prototype;return f.on=function(ze,Qt){if(ze&&Qt){var Pt=this._events=this._events||{},Tt=Pt[ze]=Pt[ze]||[];return-1==Tt.indexOf(Qt)&&Tt.push(Qt),this}},f.once=function(ze,Qt){if(ze&&Qt){this.on(ze,Qt);var Pt=this._onceEvents=this._onceEvents||{};return(Pt[ze]=Pt[ze]||{})[Qt]=!0,this}},f.off=function(ze,Qt){var Pt=this._events&&this._events[ze];if(Pt&&Pt.length){var Tt=Pt.indexOf(Qt);return-1!=Tt&&Pt.splice(Tt,1),this}},f.emitEvent=function(ze,Qt){var Pt=this._events&&this._events[ze];if(Pt&&Pt.length){Pt=Pt.slice(0),Qt=Qt||[];for(var Tt=this._onceEvents&&this._onceEvents[ze],qe=0;qe<Pt.length;qe++){var xt=Pt[qe];Tt&&Tt[xt]&&(this.off(ze,xt),delete Tt[xt]),xt.apply(this,Qt)}return this}},f.allOff=function(){delete this._events,delete this._onceEvents},Hi})?Vt.call(tn,pi,tn,Fr):Vt)&&(Fr.exports=$e)},422:(Fr,tn,pi)=>{var Vt,$e,Hi;Hi=window,Vt=[pi(730)],void 0!==($e=function(ze){return function(f,ze){"use strict";var Qt={extend:function(qe,xt){for(var Bt in xt)qe[Bt]=xt[Bt];return qe},modulo:function(qe,xt){return(qe%xt+xt)%xt}},Pt=Array.prototype.slice;Qt.makeArray=function(qe){return Array.isArray(qe)?qe:null==qe?[]:"object"==typeof qe&&"number"==typeof qe.length?Pt.call(qe):[qe]},Qt.removeFrom=function(qe,xt){var Bt=qe.indexOf(xt);-1!=Bt&&qe.splice(Bt,1)},Qt.getParent=function(qe,xt){for(;qe.parentNode&&qe!=document.body;)if(ze(qe=qe.parentNode,xt))return qe},Qt.getQueryElement=function(qe){return"string"==typeof qe?document.querySelector(qe):qe},Qt.handleEvent=function(qe){var xt="on"+qe.type;this[xt]&&this[xt](qe)},Qt.filterFindElements=function(qe,xt){qe=Qt.makeArray(qe);var Bt=[];return qe.forEach(function(dn){if(dn instanceof HTMLElement){if(!xt)return void Bt.push(dn);ze(dn,xt)&&Bt.push(dn);for(var Kn=dn.querySelectorAll(xt),Ot=0;Ot<Kn.length;Ot++)Bt.push(Kn[Ot])}}),Bt},Qt.debounceMethod=function(qe,xt,Bt){Bt=Bt||100;var dn=qe.prototype[xt],Kn=xt+"Timeout";qe.prototype[xt]=function(){clearTimeout(this[Kn]);var mt=arguments,rn=this;this[Kn]=setTimeout(function(){dn.apply(rn,mt),delete rn[Kn]},Bt)}},Qt.docReady=function(qe){var xt=document.readyState;"complete"==xt||"interactive"==xt?setTimeout(qe):document.addEventListener("DOMContentLoaded",qe)},Qt.toDashed=function(qe){return qe.replace(/(.)([A-Z])/g,function(xt,Bt,dn){return Bt+"-"+dn}).toLowerCase()};var Tt=f.console;return Qt.htmlInit=function(qe,xt){Qt.docReady(function(){var Bt=Qt.toDashed(xt),dn="data-"+Bt,Kn=document.querySelectorAll("["+dn+"]"),Ot=document.querySelectorAll(".js-"+Bt),mt=Qt.makeArray(Kn).concat(Qt.makeArray(Ot)),rn=dn+"-options",nn=f.jQuery;mt.forEach(function(st){var De,ue=st.getAttribute(dn)||st.getAttribute(rn);try{De=ue&&JSON.parse(ue)}catch(vt){return void(Tt&&Tt.error("Error parsing "+dn+" on "+st.className+": "+vt))}var at=new qe(st,De);nn&&nn.data(st,xt,at)})})},Qt}(Hi,ze)}.apply(tn,Vt))&&(Fr.exports=$e)},498:(Fr,tn,pi)=>{var Vt,$e;window,void 0!==($e="function"==typeof(Vt=function(){"use strict";function f(mt){var rn=parseFloat(mt);return-1==mt.indexOf("%")&&!isNaN(rn)&&rn}var Qt=typeof console>"u"?function ze(){}:function(mt){console.error(mt)},Pt=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],Tt=Pt.length;function xt(mt){var rn=getComputedStyle(mt);return rn||Qt("Style returned "+rn+". Are you running this code in a hidden iframe on Firefox? See https://bit.ly/getsizebug1"),rn}var dn,Bt=!1;function Ot(mt){if(function Kn(){if(!Bt){Bt=!0;var mt=document.createElement("div");mt.style.width="200px",mt.style.padding="1px 2px 3px 4px",mt.style.borderStyle="solid",mt.style.borderWidth="1px 2px 3px 4px",mt.style.boxSizing="border-box";var rn=document.body||document.documentElement;rn.appendChild(mt);var nn=xt(mt);dn=200==Math.round(f(nn.width)),Ot.isBoxSizeOuter=dn,rn.removeChild(mt)}}(),"string"==typeof mt&&(mt=document.querySelector(mt)),mt&&"object"==typeof mt&&mt.nodeType){var rn=xt(mt);if("none"==rn.display)return function qe(){for(var mt={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},rn=0;rn<Tt;rn++)mt[Pt[rn]]=0;return mt}();var nn={};nn.width=mt.offsetWidth,nn.height=mt.offsetHeight;for(var st=nn.isBorderBox="border-box"==rn.boxSizing,ue=0;ue<Tt;ue++){var De=Pt[ue],vt=parseFloat(rn[De]);nn[De]=isNaN(vt)?0:vt}var yn=nn.paddingLeft+nn.paddingRight,ki=nn.paddingTop+nn.paddingBottom,Gi=nn.marginLeft+nn.marginRight,ir=nn.marginTop+nn.marginBottom,xr=nn.borderLeftWidth+nn.borderRightWidth,_n=nn.borderTopWidth+nn.borderBottomWidth,wr=st&&dn,Lr=f(rn.width);!1!==Lr&&(nn.width=Lr+(wr?0:yn+xr));var Do=f(rn.height);return!1!==Do&&(nn.height=Do+(wr?0:ki+_n)),nn.innerWidth=nn.width-(yn+xr),nn.innerHeight=nn.height-(ki+_n),nn.outerWidth=nn.width+Gi,nn.outerHeight=nn.height+ir,nn}}return Ot})?Vt.call(tn,pi,tn,Fr):Vt)&&(Fr.exports=$e)},903:function(Fr){Fr.exports=function(){"use strict";var tn,pi,Vt;function $e(f,ze){if(tn)if(pi){var Qt="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+tn+")(sharedChunk); ("+pi+")(sharedChunk); self.onerror = null;",Pt={};tn(Pt),Vt=ze(Pt),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Vt.workerUrl=window.URL.createObjectURL(new Blob([Qt],{type:"text/javascript"})))}else pi=ze;else tn=ze}return $e(0,function(f){var ze=typeof self<"u"?self:{},Qt="2.14.1";let Pt;const Tt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Pt){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Pt=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):a}catch{Pt=a}}return Pt},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Tt.API_URL)return null;try{const a=new URL(Tt.API_URL);return"api.mapbox.cn"===a.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===a.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},qe={supported:!1,testSupport:function(a){!dn&&Bt&&(Kn?Ot(a):xt=a)}};let xt,Bt,dn=!1,Kn=!1;function Ot(a){const o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Bt),a.isContextLost())return;qe.supported=!0}catch{}a.deleteTexture(o),dn=!0}ze.document&&(Bt=ze.document.createElement("img"),Bt.onload=function(){xt&&Ot(xt),xt=null,Kn=!0},Bt.onerror=function(){dn=!0,xt=null},Bt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const mt="01";var rn=nn;function nn(a,o,l,d){this.cx=3*a,this.bx=3*(l-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(d-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=o,this.p2x=l,this.p2y=d}nn.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,o){if(void 0===o&&(o=1e-6),a<0)return 0;if(a>1)return 1;for(var l=a,d=0;d<8;d++){var p=this.sampleCurveX(l)-a;if(Math.abs(p)<o)return l;var _=this.sampleCurveDerivativeX(l);if(Math.abs(_)<1e-6)break;l-=p/_}var b=0,w=1;for(l=a,d=0;d<20&&(p=this.sampleCurveX(l),!(Math.abs(p-a)<o));d++)a>p?b=l:w=l,l=.5*(w-b)+b;return l},solve:function(a,o){return this.sampleCurveY(this.solveCurveX(a,o))}};var st=ue;function ue(a,o){this.x=a,this.y=o}ue.prototype={clone:function(){return new ue(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,o){return this.clone()._rotateAround(a,o)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var o=a.x-this.x,l=a.y-this.y;return o*o+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,o){return Math.atan2(this.x*o-this.y*a,this.x*a+this.y*o)},_matMult:function(a){var o=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=o,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var o=Math.cos(a),l=Math.sin(a),d=l*this.x+o*this.y;return this.x=o*this.x-l*this.y,this.y=d,this},_rotateAround:function(a,o){var l=Math.cos(a),d=Math.sin(a),p=o.y+d*(this.x-o.x)+l*(this.y-o.y);return this.x=o.x+l*(this.x-o.x)-d*(this.y-o.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ue.convert=function(a){return a instanceof ue?a:Array.isArray(a)?new ue(a[0],a[1]):a};const De=Math.PI/180,at=180/Math.PI;function vt(a){return a*De}function yn(a){return a*at}const ki=[[0,0],[1,0],[1,1],[0,1]];function Gi(a){if(a<=0)return 0;if(a>=1)return 1;const o=a*a,l=o*a;return 4*(a<.5?l:3*(a-o)+l-.75)}function ir(a,o,l,d){const p=new rn(a,o,l,d);return function(_){return p.solve(_)}}const xr=ir(.25,.1,.25,1);function _n(a,o,l){return Math.min(l,Math.max(o,a))}function wr(a,o,l){return(l=_n((l-a)/(o-a),0,1))*l*(3-2*l)}function Lr(a,o,l){const d=l-o,p=((a-o)%d+d)%d+o;return p===o?l:p}function Do(a,o,l){if(!a.length)return l(null,[]);let d=a.length;const p=new Array(a.length);let _=null;a.forEach((b,w)=>{o(b,(T,I)=>{T&&(_=T),p[w]=I,0==--d&&l(_,p)})})}function qo(a){const o=[];for(const l in a)o.push(a[l]);return o}function xn(a,...o){for(const l of o)for(const d in l)a[d]=l[d];return a}let cs=1;function za(){return cs++}function ta(){return function a(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function us(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function si(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function ds(a,o){a.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function Ns(a,o){return-1!==a.indexOf(o,a.length-o.length)}function ti(a,o,l){const d={};for(const p in a)d[p]=o.call(l||this,a[p],p,a);return d}function zn(a,o,l){const d={};for(const p in a)o.call(l||this,a[p],p,a)&&(d[p]=a[p]);return d}function dr(a){return Array.isArray(a)?a.map(dr):"object"==typeof a&&a?ti(a,dr):a}const cn={};function ni(a){cn[a]||(typeof console<"u"&&console.warn(a),cn[a]=!0)}function hs(a,o,l){return(l.y-a.y)*(o.x-a.x)>(o.y-a.y)*(l.x-a.x)}function Xn(a){let o=0;for(let l,d,p=0,_=a.length,b=_-1;p<_;b=p++)l=a[p],d=a[b],o+=(d.x-l.x)*(l.y+d.y);return o}function So(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Wn(a){const o={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,d,p,_)=>{const b=p||_;return o[d]=!b||b.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let Zo=null;function _o(a){if(null==Zo){const o=a.navigator?a.navigator.userAgent:null;Zo=!!a.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Zo}function va(a){try{const o=ze[a];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}}function ar(a,o){return[a[4*o],a[4*o+1],a[4*o+2],a[4*o+3]]}const Er="mapbox-tiles";let Bs,Yo,$r=500,Al=50;function Gc(){try{return ze.caches}catch{}}function na(){Gc()&&!Bs&&(Bs=ze.caches.open(Er))}function Va(a){const o=a.indexOf("?");if(o<0)return a;const d=function(p){const _=p.indexOf("?");return _>0?p.slice(_+1).split("&"):[]}(a).filter(p=>{const _=p.split("=");return"language"===_[0]||"worldview"===_[0]});return d.length?`${a.slice(0,o)}?${d.join("&")}`:a.slice(0,o)}let Wc=1/0;const qc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(qc);class wn extends Error{constructor(o,l,d){401===l&&oc(d)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=d}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const zs=So()?()=>self.worker&&self.worker.referrer:()=>("blob:"===ze.location.protocol?ze.parent:ze).location.href,Ua=function(a,o){if(!(/^file:/.test(l=a.url)||/^file:/.test(zs())&&!/^\w+:/.test(l))){if(ze.fetch&&ze.Request&&ze.AbortController&&ze.Request.prototype.hasOwnProperty("signal"))return function(d,p){const _=new ze.AbortController,b=new ze.Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,referrer:zs(),referrerPolicy:d.referrerPolicy,signal:_.signal});let w=!1,T=!1;const I=(k=b.url).indexOf("sku=")>0&&oc(k);var k;"json"===d.type&&b.headers.set("Accept","application/json");const F=(V,U,G)=>{if(T)return;if(V&&"SecurityError"!==V.message&&ni(V),U&&G)return N(U);const Q=Date.now();ze.fetch(b).then(ae=>{if(ae.ok){const ge=I?ae.clone():null;return N(ae,ge,Q)}return p(new wn(ae.statusText,ae.status,d.url))}).catch(ae=>{"AbortError"!==ae.name&&p(new Error(`${ae.message} ${d.url}`))})},N=(V,U,G)=>{("arrayBuffer"===d.type?V.arrayBuffer():"json"===d.type?V.json():V.text()).then(Q=>{T||(U&&G&&function(ae,ge,se){if(na(),!Bs)return;const he={status:ge.status,statusText:ge.statusText,headers:new ze.Headers};ge.headers.forEach((Be,Fe)=>he.headers.set(Fe,Be));const ve=Wn(ge.headers.get("Cache-Control")||"");if(ve["no-store"])return;ve["max-age"]&&he.headers.set("Expires",new Date(se+1e3*ve["max-age"]).toUTCString());const me=he.headers.get("Expires");me&&(new Date(me).getTime()-se<42e4||function(Be,Fe){if(void 0===Yo)try{new Response(new ReadableStream),Yo=!0}catch{Yo=!1}Yo?Fe(Be.body):Be.blob().then(Fe)}(ge,Be=>{const Fe=new ze.Response(Be,he);na(),Bs&&Bs.then(Ze=>Ze.put(Va(ae.url),Fe)).catch(Ze=>ni(Ze.message))}))}(b,U,G),w=!0,p(null,Q,V.headers.get("Cache-Control"),V.headers.get("Expires")))}).catch(Q=>{T||p(new Error(Q.message))})};return I?function(V,U){if(na(),!Bs)return U(null);const G=Va(V.url);Bs.then(Q=>{Q.match(G).then(ae=>{const ge=function(se){if(!se)return!1;const he=new Date(se.headers.get("Expires")||0),ve=Wn(se.headers.get("Cache-Control")||"");return he>Date.now()&&!ve["no-cache"]}(ae);Q.delete(G),ge&&Q.put(G,ae.clone()),U(null,ae,ge)}).catch(U)}).catch(U)}(b,F):F(null,null),{cancel:()=>{T=!0,w||_.abort()}}}(a,o);if(So()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,o,void 0,!0)}var l;return function(d,p){const _=new ze.XMLHttpRequest;_.open(d.method||"GET",d.url,!0),"arrayBuffer"===d.type&&(_.responseType="arraybuffer");for(const b in d.headers)_.setRequestHeader(b,d.headers[b]);return"json"===d.type&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials="include"===d.credentials,_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||0===_.status)&&null!==_.response){let b=_.response;if("json"===d.type)try{b=JSON.parse(_.response)}catch(w){return p(w)}p(null,b,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new wn(_.statusText,_.status,d.url))},_.send(d.body),{cancel:()=>_.abort()}}(a,o)},Ml=function(a,o){return Ua(xn(a,{type:"arrayBuffer"}),o)};function Zc(a){const o=ze.document.createElement("a");return o.href=a,o.protocol===ze.document.location.protocol&&o.host===ze.document.location.host}const Yc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fs,ic;fs=[],ic=0;const qu=function(a,o){if(qe.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),ic>=Tt.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:a,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return fs.push(_),_}ic++;let l=!1;const d=()=>{if(!l)for(l=!0,ic--;fs.length&&ic<Tt.MAX_PARALLEL_IMAGE_REQUESTS;){const _=fs.shift(),{requestParameters:b,callback:w,cancelled:T}=_;T||(_.cancel=qu(b,w).cancel)}},p=Ml(a,(_,b,w,T)=>{d(),_?o(_):b&&(ze.createImageBitmap?function(I,k){const F=new ze.Blob([new Uint8Array(I)],{type:"image/png"});ze.createImageBitmap(F).then(N=>{k(null,N)}).catch(N=>{k(new Error(`Could not load image because of ${N.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(I,k)=>o(I,k,w,T)):function(I,k){const F=new ze.Image,N=ze.URL;F.onload=()=>{k(null,F),N.revokeObjectURL(F.src),F.onload=null,ze.requestAnimationFrame(()=>{F.src=Yc})},F.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new ze.Blob([new Uint8Array(I)],{type:"image/png"});F.src=I.byteLength?N.createObjectURL(V):Yc}(b,(I,k)=>o(I,k,w,T)))});return{cancel:()=>{p.cancel(),d()}}},rc="NO_ACCESS_TOKEN";function ia(a){return 0===a.indexOf("mapbox:")}function oc(a){return Tt.API_URL_REGEX.test(a)}function ja(a){return Tt.API_CDN_URL_REGEX.test(a)}function Kc(a){return Tt.API_STYLE_REGEX.test(a)&&!kl(a)}function kl(a){return Tt.API_SPRITE_REGEX.test(a)}const ps=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ao(a){const o=a.match(ps);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function $a(a){const o=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${o}`}function Xc(a){if(!a)return null;const o=a.split(".");if(!o||3!==o.length)return null;try{return JSON.parse(decodeURIComponent(ze.atob(o[1]).split("").map(l=>"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ha{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const l=Xc(Tt.ACCESS_TOKEN);let d="";return d=l&&l.u?ze.btoa(encodeURIComponent(l.u).replace(/%([0-9A-F]{2})/g,(p,_)=>String.fromCharCode(Number("0x"+_)))):Tt.ACCESS_TOKEN||"",o?`mapbox.eventData.${o}:${d}`:`mapbox.eventData:${d}`}fetchEventData(){const o=va("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(o)try{const p=ze.localStorage.getItem(l);p&&(this.eventData=JSON.parse(p));const _=ze.localStorage.getItem(d);_&&(this.anonId=_)}catch{ni("Unable to read from LocalStorage")}}saveEventData(){const o=va("localStorage"),l=this.getStorageKey(),d=this.getStorageKey("uuid");if(o)try{ze.localStorage.setItem(d,this.anonId),Object.keys(this.eventData).length>=1&&ze.localStorage.setItem(l,JSON.stringify(this.eventData))}catch{ni("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,l,d,p){if(!Tt.EVENTS_URL)return;const _=Ao(Tt.EVENTS_URL);_.params.push(`access_token=${p||Tt.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(o).toISOString()},w=l?xn(b,l):b,T={url:$a(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};var k;this.pendingRequest=(k=I=>{this.pendingRequest=null,d(I),this.saveEventData(),this.processRequests(p)},Ua(xn(T,{method:"POST"}),k))}queueRequest(o,l){this.queue.push(o),this.processRequests(l)}}const oe=new class extends Ha{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,o){Tt.EVENTS_URL&&Tt.ACCESS_TOKEN&&Array.isArray(a)&&a.some(l=>ia(l)||oc(l))&&this.queueRequest(Date.now(),o)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Xc(Tt.ACCESS_TOKEN),l=o?o.u:Tt.ACCESS_TOKEN;let d=l!==this.eventData.tokenU;si(this.anonId)||(this.anonId=ta(),d=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),b=new Date(p),w=(p-this.eventData.lastSuccess)/864e5;d=d||w>=1||w<-1||_.getDate()!==b.getDate()}else d=!0;d?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Qt,skuId:mt,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=p,this.eventData.tokenU=l)},a):this.processRequests()}},H=oe.postTurnstileEvent.bind(oe),W=new class extends Ha{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,o,l,d){this.skuToken=o,this.errorCb=d,Tt.EVENTS_URL&&(l||Tt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(rc)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),si(this.anonId)||(this.anonId=ta()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Qt,skuId:mt,skuToken:this.skuToken,userId:this.anonId},d=>{d?this.errorCb(d):o&&(this.success[o]=!0)},a))}},re=W.postMapLoadEvent.bind(W),fe=new class extends Ha{constructor(){super("gljs.performance")}postPerformanceEvent(a,o){Tt.EVENTS_URL&&(a||Tt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},a)}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:o,performanceData:l}=this.queue.shift(),d=function(p){const _=ze.performance.getEntriesByType("resource"),b=ze.performance.getEntriesByType("mark"),w=function(N){const V={};if(N)for(const U in N)if("other"!==U)for(const G of N[U]){const Q=`${U}ResolveRangeMin`,ae=`${U}ResolveRangeMax`,ge=`${U}RequestCount`,se=`${U}RequestCachedCount`;V[Q]=Math.min(V[Q]||1/0,G.startTime),V[ae]=Math.max(V[ae]||-1/0,G.responseEnd);const he=ve=>{void 0===V[ve]&&(V[ve]=0),++V[ve]};void 0!==G.transferSize&&0===G.transferSize&&he(se),he(ge)}return V}(function(N,V){const U={};if(N)for(const G of N){const Q=V(G);void 0===U[Q]&&(U[Q]=[]),U[Q].push(G)}return U}(_,At)),T=ze.devicePixelRatio,I=ze.navigator.connection||ze.navigator.mozConnection||ze.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},F=(N,V,U)=>{null!=U&&N.push({name:V,value:U.toString()})};for(const N in w)F(k.counters,N,w[N]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(F(k.counters,"interactionRangeMin",p.interactionRange[0]),F(k.counters,"interactionRangeMax",p.interactionRange[1])),b)for(const N of Object.keys(Le)){const V=Le[N],U=b.find(G=>G.name===V);U&&F(k.counters,V,U.startTime)}return F(k.counters,"visibilityHidden",p.visibilityHidden),F(k.attributes,"style",function(N){if(N)for(const V of N){const U=V.name.split("?")[0];if(Kc(U)){const G=U.split("/").slice(-2);if(2===G.length)return`mapbox://styles/${G[0]}/${G[1]}`}}}(_)),F(k.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),F(k.attributes,"fogEnabled",p.fogEnabled?"true":"false"),F(k.attributes,"projection",p.projection),F(k.attributes,"zoom",p.zoom),F(k.metadata,"devicePixelRatio",T),F(k.metadata,"connectionEffectiveType",I?I.effectiveType:void 0),F(k.metadata,"navigatorUserAgent",ze.navigator.userAgent),F(k.metadata,"screenWidth",ze.screen.width),F(k.metadata,"screenHeight",ze.screen.height),F(k.metadata,"windowWidth",ze.innerWidth),F(k.metadata,"windowHeight",ze.innerHeight),F(k.metadata,"mapWidth",p.width/T),F(k.metadata,"mapHeight",p.height/T),F(k.metadata,"webglRenderer",p.renderer),F(k.metadata,"webglVendor",p.vendor),F(k.metadata,"sdkVersion",Qt),F(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(l);for(const p of d.metadata);for(const p of d.counters);for(const p of d.attributes);this.postEvent(o,d,()=>{},a)}},Ee=fe.postPerformanceEvent.bind(fe),ke=new class extends Ha{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,o,l,d){if(!Tt.API_URL||!Tt.SESSION_PATH)return;const p=Ao(Tt.API_URL+Tt.SESSION_PATH);p.params.push(`sku=${o||""}`),p.params.push(`access_token=${d||Tt.ACCESS_TOKEN||""}`);const _={url:$a(p),headers:{"Content-Type":"text/plain"}};var w;this.pendingRequest=(w=b=>{this.pendingRequest=null,l(b),this.saveEventData(),this.processRequests(d)},Ua(xn(_,{method:"GET"}),w))}getSessionAPI(a,o,l,d){this.skuToken=o,this.errorCb=d,Tt.SESSION_PATH&&Tt.API_URL&&(l||Tt.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},l):this.errorCb(new Error(rc)))}processRequests(a){if(this.pendingRequest||0===this.queue.length)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||this.getSession(l,this.skuToken,d=>{d?this.errorCb(d):o&&(this.success[o]=!0)},a)}},Me=ke.getSessionAPI.bind(ke),Te=new Set,Le={create:"create",load:"load",fullLoad:"fullLoad"},rt={mark(a){ze.performance.mark(a)},measure(a,o,l){ze.performance.measure(a,o,l)}};function At(a){const o=a.name.split("?")[0];return ja(o)&&o.includes("mapbox-gl.js")?"javascript":ja(o)&&o.includes("mapbox-gl.css")?"css":Tt.API_FONTS_REGEX.test(o)?"fontRange":kl(o)?"sprite":Kc(o)?"style":Tt.API_TILEJSON_REGEX.test(o)?"tilejson":"other"}const tt=ze.performance;function jt(a){const o=a?a.url.toString():void 0;return tt.getEntriesByName(o)}let zt,Zt,Gt,Dn;const Qn={now:()=>void 0!==Gt?Gt:ze.performance.now(),setNow(a){Gt=a},restoreNow(){Gt=void 0},frame(a){const o=ze.requestAnimationFrame(a);return{cancel:()=>ze.cancelAnimationFrame(o)}},getImageData(a,o=0){const{width:l,height:d}=a;Dn||(Dn=ze.document.createElement("canvas"));const p=Dn.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(l>Dn.width||d>Dn.height)&&(Dn.width=l,Dn.height=d),p.clearRect(-o,-o,l+2*o,d+2*o),p.drawImage(a,0,0,l,d),p.getImageData(-o,-o,l+2*o,d+2*o)},resolveURL:a=>(zt||(zt=ze.document.createElement("a")),zt.href=a,zt.href),get devicePixelRatio(){return ze.devicePixelRatio},get prefersReducedMotion(){return!!ze.matchMedia&&(null==Zt&&(Zt=ze.matchMedia("(prefers-reduced-motion: reduce)")),Zt.matches)}};function on(a,o,l){l[a]&&-1!==l[a].indexOf(o)||(l[a]=l[a]||[],l[a].push(o))}function ii(a,o,l){if(l&&l[a]){const d=l[a].indexOf(o);-1!==d&&l[a].splice(d,1)}}class Di{constructor(o,l={}){xn(this,l),this.type=o}}class Vs extends Di{constructor(o,l={}){super("error",xn({error:o},l))}}class ms{on(o,l){return this._listeners=this._listeners||{},on(o,l,this._listeners),this}off(o,l){return ii(o,l,this._listeners),ii(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},on(o,l,this._oneTimeListeners),this):new Promise(d=>this.once(o,d))}fire(o,l){"string"==typeof o&&(o=new Di(o,l||{}));const d=o.type;if(this.listens(d)){o.target=this;const p=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const w of p)w.call(this,o);const _=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const w of _)ii(d,w,this._oneTimeListeners),w.call(this,o);const b=this._eventedParent;b&&(xn(o,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),b.fire(o))}else o instanceof Vs&&console.error(o.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}var Ye=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ba(a,...o){for(const l of o)for(const d in l)a[d]=l[d];return a}function lr(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ga(a){if(Array.isArray(a))return a.map(Ga);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const o={};for(const l in a)o[l]=Ga(a[l]);return o}return lr(a)}class Nd extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}var ra=Nd;class sc{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[d,p]of l)this.bindings[d]=p}concat(o){return new sc(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}var hr=sc;const xa={kind:"null"},Et={kind:"number"},kn={kind:"string"},qt={kind:"boolean"},gs={kind:"color"},xi={kind:"object"},An={kind:"value"},ac={kind:"collator"},mi={kind:"formatted"},mn={kind:"resolvedImage"};function cr(a,o){return{kind:"array",itemType:a,N:o}}function wi(a){if("array"===a.kind){const o=wi(a.itemType);return"number"==typeof a.N?`array<${o}, ${a.N}>`:"value"===a.itemType.kind?"array":`array<${o}>`}return a.kind}const pp=[xa,Et,kn,qt,gs,mi,xi,cr(An),mn];function Mr(a,o){if("error"===o.kind)return null;if("array"===a.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!Mr(a.itemType,o.itemType))&&("number"!=typeof a.N||a.N===o.N))return null}else{if(a.kind===o.kind)return null;if("value"===a.kind)for(const l of pp)if(!Mr(l,o))return null}return`Expected ${wi(a)} but found ${wi(o)} instead.`}function ot(a,o){return o.some(l=>l.kind===a.kind)}function oa(a,o){return o.some(l=>"null"===l?null===a:"array"===l?Array.isArray(a):"object"===l?a&&!Array.isArray(a)&&"object"==typeof a:l===typeof a)}var Sn,gi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Qc(a){return(a=Math.round(a))<0?0:a>255?255:a}function lc(a){return Qc("%"===a[a.length-1]?parseFloat(a)/100*255:parseInt(a))}function cc(a){return(o="%"===a[a.length-1]?parseFloat(a)/100:parseFloat(a))<0?0:o>1?1:o;var o}function sa(a,o,l){return l<0?l+=1:l>1&&(l-=1),6*l<1?a+(o-a)*l*6:2*l<1?o:3*l<2?a+(o-a)*(2/3-l)*6:a}try{Sn={}.parseCSSColor=function(a){var o,l=a.replace(/ /g,"").toLowerCase();if(l in gi)return gi[l].slice();if("#"===l[0])return 4===l.length?(o=parseInt(l.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:7===l.length&&(o=parseInt(l.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var d=l.indexOf("("),p=l.indexOf(")");if(-1!==d&&p+1===l.length){var _=l.substr(0,d),b=l.substr(d+1,p-(d+1)).split(","),w=1;switch(_){case"rgba":if(4!==b.length)return null;w=cc(b.pop());case"rgb":return 3!==b.length?null:[lc(b[0]),lc(b[1]),lc(b[2]),w];case"hsla":if(4!==b.length)return null;w=cc(b.pop());case"hsl":if(3!==b.length)return null;var T=(parseFloat(b[0])%360+360)%360/360,I=cc(b[1]),k=cc(b[2]),F=k<=.5?k*(I+1):k+I-k*I,N=2*k-F;return[Qc(255*sa(N,F,T+1/3)),Qc(255*sa(N,F,T)),Qc(255*sa(N,F,T-1/3)),w];default:return null}}return null}}catch{}class Xi{constructor(o,l,d,p=1){this.r=o,this.g=l,this.b=d,this.a=p}static parse(o){if(!o)return;if(o instanceof Xi)return o;if("string"!=typeof o)return;const l=Sn(o);return l?new Xi(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toString(){const[o,l,d,p]=this.toArray();return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(d)},${p})`}toArray(){const{r:o,g:l,b:d,a:p}=this;return 0===p?[0,0,0,0]:[255*o/p,255*l/p,255*d/p,p]}toArray01(){const{r:o,g:l,b:d,a:p}=this;return 0===p?[0,0,0,0]:[o/p,l/p,d/p,p]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:d,a:p}=this;return[o,l,d,p]}}Xi.black=new Xi(0,0,0,1),Xi.white=new Xi(1,1,1,1),Xi.transparent=new Xi(0,0,0,0),Xi.red=new Xi(1,0,0,1),Xi.blue=new Xi(0,0,1,1);var ur=Xi;class Zu{constructor(o,l,d){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Yu{constructor(o,l,d,p,_){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=d,this.fontStack=p,this.textColor=_}}class fr{constructor(o){this.sections=o}static fromString(o){return new fr([new Yu(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&0!==o.image.name.length)}static factory(o){return o instanceof fr?o:fr.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){o.push(["image",l.image.name]);continue}o.push(l.text);const d={};l.fontStack&&(d["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(d["font-scale"]=l.scale),l.textColor&&(d["text-color"]=["rgba"].concat(l.textColor.toArray())),o.push(d)}return o}}class Mo{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new Mo({name:o,available:!1}):null}serialize(){return["image",this.name]}}function mp(a,o,l,d){return"number"==typeof a&&a>=0&&a<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===d||"number"==typeof d&&d>=0&&d<=1?null:`Invalid rgba value [${[a,o,l,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof d?[a,o,l,d]:[a,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Bd(a){if(null===a||"string"==typeof a||"boolean"==typeof a||"number"==typeof a||a instanceof ur||a instanceof Zu||a instanceof fr||a instanceof Mo)return!0;if(Array.isArray(a)){for(const o of a)if(!Bd(o))return!1;return!0}if("object"==typeof a){for(const o in a)if(!Bd(a[o]))return!1;return!0}return!1}function kr(a){if(null===a)return xa;if("string"==typeof a)return kn;if("boolean"==typeof a)return qt;if("number"==typeof a)return Et;if(a instanceof ur)return gs;if(a instanceof Zu)return ac;if(a instanceof fr)return mi;if(a instanceof Mo)return mn;if(Array.isArray(a)){const o=a.length;let l;for(const d of a){const p=kr(d);if(l){if(l===p)continue;l=An;break}l=p}return cr(l||An,o)}return xi}function Jc(a){const o=typeof a;return null===a?"":"string"===o||"number"===o||"boolean"===o?String(a):a instanceof ur||a instanceof fr||a instanceof Mo?a.toString():JSON.stringify(a)}class Nh{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(2!==o.length)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Bd(o[1]))return l.error("invalid value");const d=o[1];let p=kr(d);const _=l.expectedType;return"array"!==p.kind||0!==p.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(p=_),new Nh(p,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ur?["rgba"].concat(this.value.toArray()):this.value instanceof fr?this.value.serialize():this.value}}var uc=Nh,io=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const Nr={string:kn,number:Et,boolean:qt,object:xi};class ai{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let d,p=1;const _=o[0];if("array"===_){let w,T;if(o.length>2){const I=o[1];if("string"!=typeof I||!(I in Nr)||"object"===I)return l.error('The item type argument of "array" must be one of string, number, boolean',1);w=Nr[I],p++}else w=An;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);T=o[2],p++}d=cr(w,T)}else d=Nr[_];const b=[];for(;p<o.length;p++){const w=l.parse(o[p],p,An);if(!w)return null;b.push(w)}return new ai(d,b)}evaluate(o){for(let l=0;l<this.args.length;l++){const d=this.args[l].evaluate(o);if(!Mr(this.type,kr(d)))return d;if(l===this.args.length-1)throw new io(`Expected value to be of type ${wi(this.type)}, but found ${wi(kr(d))} instead.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if("array"===o.kind){const d=o.itemType;if("string"===d.kind||"number"===d.kind||"boolean"===d.kind){l.push(d.kind);const p=o.N;("number"==typeof p||this.args.length>1)&&l.push(p)}}return l.concat(this.args.map(d=>d.serialize()))}}var Wa=ai;class Ku{constructor(o){this.type=mi,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[1];if(!Array.isArray(d)&&"object"==typeof d)return l.error("First argument must be an image or text section.");const p=[];let _=!1;for(let b=1;b<=o.length-1;++b){const w=o[b];if(_&&"object"==typeof w&&!Array.isArray(w)){_=!1;let T=null;if(w["font-scale"]&&(T=l.parse(w["font-scale"],1,Et),!T))return null;let I=null;if(w["text-font"]&&(I=l.parse(w["text-font"],1,cr(kn)),!I))return null;let k=null;if(w["text-color"]&&(k=l.parse(w["text-color"],1,gs),!k))return null;const F=p[p.length-1];F.scale=T,F.font=I,F.textColor=k}else{const T=l.parse(o[b],1,An);if(!T)return null;const I=T.type.kind;if("string"!==I&&"value"!==I&&"null"!==I&&"resolvedImage"!==I)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new Ku(p)}evaluate(o){return new fr(this.sections.map(l=>{const d=l.content.evaluate(o);return kr(d)===mn?new Yu("",d,null,null,null):new Yu(Jc(d),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const d={};l.scale&&(d["font-scale"]=l.scale.serialize()),l.font&&(d["text-font"]=l.font.serialize()),l.textColor&&(d["text-color"]=l.textColor.serialize()),o.push(d)}return o}}class Rl{constructor(o){this.type=mn,this.input=o}static parse(o,l){if(2!==o.length)return l.error("Expected two arguments.");const d=l.parse(o[1],1,kn);return d?new Rl(d):l.error("No image name provided.")}evaluate(o){const l=this.input.evaluate(o),d=Mo.fromString(l);return d&&o.availableImages&&(d.available=o.availableImages.indexOf(l)>-1),d}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Mt={"to-boolean":qt,"to-color":gs,"to-number":Et,"to-string":kn};class Bh{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const d=o[0];if(("to-boolean"===d||"to-string"===d)&&2!==o.length)return l.error("Expected one argument.");const p=Mt[d],_=[];for(let b=1;b<o.length;b++){const w=l.parse(o[b],b,An);if(!w)return null;_.push(w)}return new Bh(p,_)}evaluate(o){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(o));if("color"===this.type.kind){let l,d;for(const p of this.args){if(l=p.evaluate(o),d=null,l instanceof ur)return l;if("string"==typeof l){const _=o.parseColor(l);if(_)return _}else if(Array.isArray(l)&&(d=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:mp(l[0],l[1],l[2],l[3]),!d))return new ur(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new io(d||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const d of this.args){if(l=d.evaluate(o),null===l)return 0;const p=Number(l);if(!isNaN(p))return p}throw new io(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?fr.fromString(Jc(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Mo.fromString(Jc(this.args[0].evaluate(o))):Jc(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ku([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Rl(this.args[0]).serialize();const o=[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}var Pn=Bh;const dc=["Unknown","Point","LineString","Polygon"];var hc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?dc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:l,y:d}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(l*o-a[0])+this.featureDistanceData.bearing[1]*(d*o-a[1])}return 0}parseColor(a){let o=this._parseColorCache[a];return o||(o=this._parseColorCache[a]=ur.parse(a)),o}};class qa{constructor(o,l,d,p){this.name=o,this.type=l,this._evaluate=d,this.args=p}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const d=o[0],p=qa.definitions[d];if(!p)return l.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,w=b.filter(([I])=>!Array.isArray(I)||I.length===o.length-1);let T=null;for(const[I,k]of w){T=new lt(l.registry,l.path,null,l.scope);const F=[];let N=!1;for(let V=1;V<o.length;V++){const U=o[V],G=Array.isArray(I)?I[V-1]:I.type,Q=T.parse(U,1+F.length,G);if(!Q){N=!0;break}F.push(Q)}if(!N)if(Array.isArray(I)&&I.length!==F.length)T.error(`Expected ${I.length} arguments, but found ${F.length} instead.`);else{for(let V=0;V<F.length;V++){const U=Array.isArray(I)?I[V]:I.type,G=F[V];T.concat(V+1).checkSubtype(U,G.type)}if(0===T.errors.length)return new qa(d,_,k,F)}}if(1===w.length)l.errors.push(...T.errors);else{const I=(w.length?w:b).map(([F])=>{return N=F,Array.isArray(N)?`(${N.map(wi).join(", ")})`:`(${wi(N.type)}...)`;var N}).join(" | "),k=[];for(let F=1;F<o.length;F++){const N=l.parse(o[F],1+k.length);if(!N)return null;k.push(wi(N.type))}l.error(`Expected arguments of type ${I}, but found (${k.join(", ")}) instead.`)}return null}static register(o,l){qa.definitions=l;for(const d in l)o[d]=qa}}var Za=qa;class eu{constructor(o,l,d){this.type=ac,this.locale=d,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(2!==o.length)return l.error("Expected one argument.");const d=o[1];if("object"!=typeof d||Array.isArray(d))return l.error("Collator options argument must be an object.");const p=l.parse(void 0!==d["case-sensitive"]&&d["case-sensitive"],1,qt);if(!p)return null;const _=l.parse(void 0!==d["diacritic-sensitive"]&&d["diacritic-sensitive"],1,qt);if(!_)return null;let b=null;return d.locale&&(b=l.parse(d.locale,1,kn),!b)?null:new eu(p,_,b)}evaluate(o){return new Zu(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}const Us=8192;function ko(a,o){a[0]=Math.min(a[0],o[0]),a[1]=Math.min(a[1],o[1]),a[2]=Math.max(a[2],o[0]),a[3]=Math.max(a[3],o[1])}function fc(a,o){return!(a[0]<=o[0]||a[2]>=o[2]||a[1]<=o[1]||a[3]>=o[3])}function zh(a,o){const l=(180+a[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,p=Math.pow(2,o.z);return[Math.round(l*p*Us),Math.round(d*p*Us)]}function hn(a,o,l){const d=a[0]-o[0],p=a[1]-o[1],_=a[0]-l[0],b=a[1]-l[1];return d*b-_*p==0&&d*_<=0&&p*b<=0}function pc(a,o){let l=!1;for(let b=0,w=o.length;b<w;b++){const T=o[b];for(let I=0,k=T.length;I<k-1;I++){if(hn(a,T[I],T[I+1]))return!1;(p=T[I])[1]>(d=a)[1]!=(_=T[I+1])[1]>d[1]&&d[0]<(_[0]-p[0])*(d[1]-p[1])/(_[1]-p[1])+p[0]&&(l=!l)}}var d,p,_;return l}function Vh(a,o){for(let l=0;l<o.length;l++)if(pc(a,o[l]))return!0;return!1}function Ro(a,o,l,d){const p=d[0]-l[0],_=d[1]-l[1],b=(a[0]-l[0])*_-p*(a[1]-l[1]),w=(o[0]-l[0])*_-p*(o[1]-l[1]);return b>0&&w<0||b<0&&w>0}function tu(a,o,l){for(const I of l)for(let k=0;k<I.length-1;++k)if((w=[(b=I[k+1])[0]-(_=I[k])[0],b[1]-_[1]])[0]*(T=[(p=o)[0]-(d=a)[0],p[1]-d[1]])[1]-w[1]*T[0]!=0&&Ro(d,p,_,b)&&Ro(_,b,d,p))return!0;var d,p,_,b,w,T;return!1}function mc(a,o){for(let l=0;l<a.length;++l)if(!pc(a[l],o))return!1;for(let l=0;l<a.length-1;++l)if(tu(a[l],a[l+1],o))return!1;return!0}function zi(a,o){for(let l=0;l<o.length;l++)if(mc(a,o[l]))return!0;return!1}function zd(a,o,l){const d=[];for(let p=0;p<a.length;p++){const _=[];for(let b=0;b<a[p].length;b++){const w=zh(a[p][b],l);ko(o,w),_.push(w)}d.push(_)}return d}function Vd(a,o,l){const d=[];for(let p=0;p<a.length;p++){const _=zd(a[p],o,l);d.push(_)}return d}function Uh(a,o,l,d){if(a[0]<l[0]||a[0]>l[2]){const p=.5*d;let _=a[0]-l[0]>p?-d:l[0]-a[0]>p?d:0;0===_&&(_=a[0]-l[2]>p?-d:l[2]-a[0]>p?d:0),a[0]+=_}ko(o,a)}function js(a,o,l,d){const p=Math.pow(2,d.z)*Us,_=[d.x*Us,d.y*Us],b=[];if(!a)return b;for(const w of a)for(const T of w){const I=[T.x+_[0],T.y+_[1]];Uh(I,o,l,p),b.push(I)}return b}function ri(a,o,l,d){const p=Math.pow(2,d.z)*Us,_=[d.x*Us,d.y*Us],b=[];if(!a)return b;for(const T of a){const I=[];for(const k of T){const F=[k.x+_[0],k.y+_[1]];ko(o,F),I.push(F)}b.push(I)}if(o[2]-o[0]<=p/2){(w=o)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of b)for(const I of T)Uh(I,o,l,p)}var w;return b}class Ya{constructor(o,l){this.type=qt,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Bd(o[1])){const d=o[1];if("FeatureCollection"===d.type)for(let p=0;p<d.features.length;++p){const _=d.features[p].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Ya(d,d.features[p].geometry)}else if("Feature"===d.type){const p=d.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Ya(d,d.geometry)}else if("Polygon"===d.type||"MultiPolygon"===d.type)return new Ya(d,d)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(l,d){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(!b)return!1;if("Polygon"===d.type){const w=zd(d.coordinates,_,b),T=js(l.geometry(),p,_,b);if(!fc(p,_))return!1;for(const I of T)if(!pc(I,w))return!1}if("MultiPolygon"===d.type){const w=Vd(d.coordinates,_,b),T=js(l.geometry(),p,_,b);if(!fc(p,_))return!1;for(const I of T)if(!Vh(I,w))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(l,d){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],b=l.canonicalID();if(!b)return!1;if("Polygon"===d.type){const w=zd(d.coordinates,_,b),T=ri(l.geometry(),p,_,b);if(!fc(p,_))return!1;for(const I of T)if(!mc(I,w))return!1}if("MultiPolygon"===d.type){const w=Vd(d.coordinates,_,b),T=ri(l.geometry(),p,_,b);if(!fc(p,_))return!1;for(const I of T)if(!zi(I,w))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ud=Ya;function nu(a){if(a instanceof Za&&("get"===a.name&&1===a.args.length||"feature-state"===a.name||"has"===a.name&&1===a.args.length||"properties"===a.name||"geometry-type"===a.name||"id"===a.name||/^filter-/.test(a.name))||a instanceof Ud)return!1;let o=!0;return a.eachChild(l=>{o&&!nu(l)&&(o=!1)}),o}function gc(a){if(a instanceof Za&&"feature-state"===a.name)return!1;let o=!0;return a.eachChild(l=>{o&&!gc(l)&&(o=!1)}),o}function Pl(a,o){if(a instanceof Za&&o.indexOf(a.name)>=0)return!1;let l=!0;return a.eachChild(d=>{l&&!Pl(d,o)&&(l=!1)}),l}class wa{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(2!==o.length||"string"!=typeof o[1])return l.error("'var' expression requires exactly one string literal argument.");const d=o[1];return l.scope.has(d)?new wa(d,l.scope.get(d)):l.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ko=wa;class Xu{constructor(o,l=[],d,p=new hr,_=[]){this.registry=o,this.path=l,this.key=l.map(b=>`[${b}]`).join(""),this.scope=p,this.errors=_,this.expectedType=d}parse(o,l,d,p,_={}){return l?this.concat(l,d,p)._parse(o,_):this._parse(o,_)}_parse(o,l){function d(p,_,b){return"assert"===b?new Wa(_,[p]):"coerce"===b?new Pn(_,[p]):p}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=o[0];if("string"!=typeof p)return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let b=_.parse(o,this);if(!b)return null;if(this.expectedType){const w=this.expectedType,T=b.type;if("string"!==w.kind&&"number"!==w.kind&&"boolean"!==w.kind&&"object"!==w.kind&&"array"!==w.kind||"value"!==T.kind)if("color"!==w.kind&&"formatted"!==w.kind&&"resolvedImage"!==w.kind||"value"!==T.kind&&"string"!==T.kind){if(this.checkSubtype(w,T))return null}else b=d(b,w,l.typeAnnotation||"coerce");else b=d(b,w,l.typeAnnotation||"assert")}if(!(b instanceof uc)&&"resolvedImage"!==b.type.kind&&Ea(b)){const w=new hc;try{b=new uc(b.type,b.evaluate(w))}catch(T){return this.error(T.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,d){const p="number"==typeof o?this.path.concat(o):this.path,_=d?this.scope.concat(d):this.scope;return new Xu(this.registry,p,l||null,_,this.errors)}error(o,...l){const d=`${this.key}${l.map(p=>`[${p}]`).join("")}`;this.errors.push(new ra(d,o))}checkSubtype(o,l){const d=Mr(o,l);return d&&this.error(d),d}}var lt=Xu;function Ea(a){if(a instanceof Ko)return Ea(a.boundExpression);if(a instanceof Za&&"error"===a.name||a instanceof eu||a instanceof Ud)return!1;const o=a instanceof Pn||a instanceof Wa;let l=!0;return a.eachChild(d=>{l=o?l&&Ea(d):l&&d instanceof uc}),!!l&&nu(a)&&Pl(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function En(a,o){const l=a.length-1;let d,p,_=0,b=l,w=0;for(;_<=b;)if(w=Math.floor((_+b)/2),d=a[w],p=a[w+1],d<=o){if(w===l||o<p)return w;_=w+1}else{if(!(d>o))throw new io("Input is not a number.");b=w-1}return 0}class Ol{constructor(o,l,d){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[p,_]of d)this.labels.push(p),this.outputs.push(_)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const d=l.parse(o[1],1,Et);if(!d)return null;const p=[];let _=null;l.expectedType&&"value"!==l.expectedType.kind&&(_=l.expectedType);for(let b=1;b<o.length;b+=2){const w=1===b?-1/0:o[b],T=o[b+1],I=b,k=b+1;if("number"!=typeof w)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(p.length&&p[p.length-1][0]>=w)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const F=l.parse(T,k,_);if(!F)return null;_=_||F.type,p.push([w,F])}return new Ol(_,d,p)}evaluate(o){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const _=l.length;return p>=l[_-1]?d[_-1].evaluate(o):d[En(l,p)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}var iu=Ol;function Vn(a,o,l){return a*(1-l)+o*l}var ru=Object.freeze({__proto__:null,number:Vn,color:function(a,o,l){return new ur(Vn(a.r,o.r,l),Vn(a.g,o.g,l),Vn(a.b,o.b,l),Vn(a.a,o.a,l))},array:function(a,o,l){return a.map((d,p)=>Vn(d,o[p],l))}});const jh=.95047,Qu=1.08883,_s=4/29,ys=6/29,Xo=3*ys*ys,aa=Math.PI/180,Ei=180/Math.PI;function Fl(a){return a>.008856451679035631?Math.pow(a,1/3):a/Xo+_s}function Ll(a){return a>ys?a*a*a:Xo*(a-_s)}function Nl(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function _c(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function vs(a){const o=_c(a.r),l=_c(a.g),d=_c(a.b),p=Fl((.4124564*o+.3575761*l+.1804375*d)/jh),_=Fl((.2126729*o+.7151522*l+.072175*d)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-Fl((.0193339*o+.119192*l+.9503041*d)/Qu)),alpha:a.a}}function yc(a){let o=(a.l+16)/116,l=isNaN(a.a)?o:o+a.a/500,d=isNaN(a.b)?o:o-a.b/200;return o=1*Ll(o),l=jh*Ll(l),d=Qu*Ll(d),new ur(Nl(3.2404542*l-1.5371385*o-.4985314*d),Nl(-.969266*l+1.8760108*o+.041556*d),Nl(.0556434*l-.2040259*o+1.0572252*d),a.alpha)}function gp(a,o,l){const d=o-a;return a+l*(d>180||d<-180?d-360*Math.round(d/360):d)}const pr={forward:vs,reverse:yc,interpolate:function(a,o,l){return{l:Vn(a.l,o.l,l),a:Vn(a.a,o.a,l),b:Vn(a.b,o.b,l),alpha:Vn(a.alpha,o.alpha,l)}}},Ka={forward:function(a){const{l:o,a:l,b:d}=vs(a),p=Math.atan2(d,l)*Ei;return{h:p<0?p+360:p,c:Math.sqrt(l*l+d*d),l:o,alpha:a.a}},reverse:function(a){const o=a.h*aa,l=a.c;return yc({l:a.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:a.alpha})},interpolate:function(a,o,l){return{h:gp(a.h,o.h,l),c:Vn(a.c,o.c,l),l:Vn(a.l,o.l,l),alpha:Vn(a.alpha,o.alpha,l)}}};var $h=Object.freeze({__proto__:null,lab:pr,hcl:Ka});class ou{constructor(o,l,d,p,_){this.type=o,this.operator=l,this.interpolation=d,this.input=p,this.labels=[],this.outputs=[];for(const[b,w]of _)this.labels.push(b),this.outputs.push(w)}static interpolationFactor(o,l,d,p){let _=0;if("exponential"===o.name)_=Yn(l,o.base,d,p);else if("linear"===o.name)_=Yn(l,1,d,p);else if("cubic-bezier"===o.name){const b=o.controlPoints;_=new rn(b[0],b[1],b[2],b[3]).solve(Yn(l,1,d,p))}return _}static parse(o,l){let[d,p,_,...b]=o;if(!Array.isArray(p)||0===p.length)return l.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){const I=p[1];if("number"!=typeof I)return l.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:I}}else{if("cubic-bezier"!==p[0])return l.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const I=p.slice(1);if(4!==I.length||I.some(k=>"number"!=typeof k||k<0||k>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:I}}}if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(_=l.parse(_,2,Et),!_)return null;const w=[];let T=null;"interpolate-hcl"===d||"interpolate-lab"===d?T=gs:l.expectedType&&"value"!==l.expectedType.kind&&(T=l.expectedType);for(let I=0;I<b.length;I+=2){const k=b[I],F=b[I+1],N=I+3,V=I+4;if("number"!=typeof k)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(w.length&&w[w.length-1][0]>=k)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',N);const U=l.parse(F,V,T);if(!U)return null;T=T||U.type,w.push([k,U])}return"number"===T.kind||"color"===T.kind||"array"===T.kind&&"number"===T.itemType.kind&&"number"==typeof T.N?new ou(T,d,p,_,w):l.error(`Type ${wi(T)} is not interpolatable.`)}evaluate(o){const l=this.labels,d=this.outputs;if(1===l.length)return d[0].evaluate(o);const p=this.input.evaluate(o);if(p<=l[0])return d[0].evaluate(o);const _=l.length;if(p>=l[_-1])return d[_-1].evaluate(o);const b=En(l,p),w=ou.interpolationFactor(this.interpolation,p,l[b],l[b+1]),T=d[b].evaluate(o),I=d[b+1].evaluate(o);return"interpolate"===this.operator?ru[this.type.kind.toLowerCase()](T,I,w):"interpolate-hcl"===this.operator?Ka.reverse(Ka.interpolate(Ka.forward(T),Ka.forward(I),w)):pr.reverse(pr.interpolate(pr.forward(T),pr.forward(I),w))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,o,this.input.serialize()];for(let d=0;d<this.labels.length;d++)l.push(this.labels[d],this.outputs[d].serialize());return l}}function Yn(a,o,l,d){const p=d-l,_=a-l;return 0===p?0:1===o?_/p:(Math.pow(o,_)-1)/(Math.pow(o,p)-1)}var la=ou;class su{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let d=null;const p=l.expectedType;p&&"value"!==p.kind&&(d=p);const _=[];for(const w of o.slice(1)){const T=l.parse(w,1+_.length,d,void 0,{typeAnnotation:"omit"});if(!T)return null;d=d||T.type,_.push(T)}const b=p&&_.some(w=>Mr(p,w.type));return new su(b?An:d,_)}evaluate(o){let l,d=null,p=0;for(const _ of this.args){if(p++,d=_.evaluate(o),d&&d instanceof Mo&&!d.available&&(l||(l=d),d=null,p===this.args.length))return l;if(null!==d)break}return d}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var vn=su;class Br{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const d=[];for(let _=1;_<o.length-1;_+=2){const b=o[_];if("string"!=typeof b)return l.error(`Expected string, but found ${typeof b} instead.`,_);if(/[^a-zA-Z0-9_]/.test(b))return l.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=l.parse(o[_+1],_+1);if(!w)return null;d.push([b,w])}const p=l.parse(o[o.length-1],o.length-1,l.expectedType,d);return p?new Br(d,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,d]of this.bindings)o.push(l,d.serialize());return o.push(this.result.serialize()),o}}var Ci=Br;class Rr{constructor(o,l,d){this.type=o,this.index=l,this.input=d}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,Et),p=l.parse(o[2],2,cr(l.expectedType||An));return d&&p?new Rr(p.type.itemType,d,p):null}evaluate(o){const l=this.index.evaluate(o),d=this.input.evaluate(o);if(l<0)throw new io(`Array index out of bounds: ${l} < 0.`);if(l>=d.length)throw new io(`Array index out of bounds: ${l} > ${d.length-1}.`);if(l!==Math.floor(l))throw new io(`Array index must be an integer, but found ${l} instead.`);return d[l]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var yo=Rr;class Ca{constructor(o,l){this.type=qt,this.needle=o,this.haystack=l}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,An),p=l.parse(o[2],2,An);return d&&p?ot(d.type,[qt,kn,Et,xa,An])?new Ca(d,p):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(d.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(null==d)return!1;if(!oa(l,["boolean","string","number","null"]))throw new io(`Expected first argument to be of type boolean, string, number or null, but found ${wi(kr(l))} instead.`);if(!oa(d,["string","array"]))throw new io(`Expected second argument to be of type array or string, but found ${wi(kr(d))} instead.`);return d.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Po=Ca;class vc{constructor(o,l,d){this.type=Et,this.needle=o,this.haystack=l,this.fromIndex=d}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,An),p=l.parse(o[2],2,An);if(!d||!p)return null;if(!ot(d.type,[qt,kn,Et,xa,An]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(d.type)} instead`);if(4===o.length){const _=l.parse(o[3],3,Et);return _?new vc(d,p,_):null}return new vc(d,p)}evaluate(o){const l=this.needle.evaluate(o),d=this.haystack.evaluate(o);if(!oa(l,["boolean","string","number","null"]))throw new io(`Expected first argument to be of type boolean, string, number or null, but found ${wi(kr(l))} instead.`);if(!oa(d,["string","array"]))throw new io(`Expected second argument to be of type array or string, but found ${wi(kr(d))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(o);return d.indexOf(l,p)}return d.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var jd=vc;class Bl{constructor(o,l,d,p,_,b){this.inputType=o,this.type=l,this.input=d,this.cases=p,this.outputs=_,this.otherwise=b}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let d,p;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);const _={},b=[];for(let I=2;I<o.length-1;I+=2){let k=o[I];const F=o[I+1];Array.isArray(k)||(k=[k]);const N=l.concat(I);if(0===k.length)return N.error("Expected at least one branch label.");for(const U of k){if("number"!=typeof U&&"string"!=typeof U)return N.error("Branch labels must be numbers or strings.");if("number"==typeof U&&Math.abs(U)>Number.MAX_SAFE_INTEGER)return N.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof U&&Math.floor(U)!==U)return N.error("Numeric branch labels must be integer values.");if(d){if(N.checkSubtype(d,kr(U)))return null}else d=kr(U);if(void 0!==_[String(U)])return N.error("Branch labels must be unique.");_[String(U)]=b.length}const V=l.parse(F,I,p);if(!V)return null;p=p||V.type,b.push(V)}const w=l.parse(o[1],1,An);if(!w)return null;const T=l.parse(o[o.length-1],o.length-1,p);return T?"value"!==w.type.kind&&l.concat(1).checkSubtype(d,w.type)?null:new Bl(d,p,w,_,b,T):null}evaluate(o){const l=this.input.evaluate(o);return(kr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),d=[],p={};for(const b of l){const w=p[this.cases[b]];void 0===w?(p[this.cases[b]]=d.length,d.push([this.cases[b],[b]])):d[w][1].push(b)}const _=b=>"number"===this.inputType.kind?Number(b):b;for(const[b,w]of d)o.push(1===w.length?_(w[0]):w.map(_)),o.push(this.outputs[b].serialize());return o.push(this.otherwise.serialize()),o}}var $s=Bl;class Wt{constructor(o,l,d){this.type=o,this.branches=l,this.otherwise=d}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let d;l.expectedType&&"value"!==l.expectedType.kind&&(d=l.expectedType);const p=[];for(let b=1;b<o.length-1;b+=2){const w=l.parse(o[b],b,qt);if(!w)return null;const T=l.parse(o[b+1],b+1,d);if(!T)return null;p.push([w,T]),d=d||T.type}const _=l.parse(o[o.length-1],o.length-1,d);return _?new Wt(d,p,_):null}evaluate(o){for(const[l,d]of this.branches)if(l.evaluate(o))return d.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,d]of this.branches)o(l),o(d);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}var jn=Wt;class Vi{constructor(o,l,d,p){this.type=o,this.input=l,this.beginIndex=d,this.endIndex=p}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const d=l.parse(o[1],1,An),p=l.parse(o[2],2,Et);if(!d||!p)return null;if(!ot(d.type,[cr(An),kn,An]))return l.error(`Expected first argument to be of type array or string, but found ${wi(d.type)} instead`);if(4===o.length){const _=l.parse(o[3],3,Et);return _?new Vi(d.type,d,p,_):null}return new Vi(d.type,d,p)}evaluate(o){const l=this.input.evaluate(o),d=this.beginIndex.evaluate(o);if(!oa(l,["string","array"]))throw new io(`Expected first argument to be of type array or string, but found ${wi(kr(l))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(o);return l.slice(d,p)}return l.slice(d)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var bs=Vi;function ca(a,o){return"=="===a||"!="===a?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function Hr(a,o,l,d){return 0===d.compare(o,l)}function Hs(a,o,l){const d="=="!==a&&"!="!==a;return class UH{constructor(_,b,w){this.type=qt,this.lhs=_,this.rhs=b,this.collator=w,this.hasUntypedArgument="value"===_.type.kind||"value"===b.type.kind}static parse(_,b){if(3!==_.length&&4!==_.length)return b.error("Expected two or three arguments.");const w=_[0];let T=b.parse(_[1],1,An);if(!T)return null;if(!ca(w,T.type))return b.concat(1).error(`"${w}" comparisons are not supported for type '${wi(T.type)}'.`);let I=b.parse(_[2],2,An);if(!I)return null;if(!ca(w,I.type))return b.concat(2).error(`"${w}" comparisons are not supported for type '${wi(I.type)}'.`);if(T.type.kind!==I.type.kind&&"value"!==T.type.kind&&"value"!==I.type.kind)return b.error(`Cannot compare types '${wi(T.type)}' and '${wi(I.type)}'.`);d&&("value"===T.type.kind&&"value"!==I.type.kind?T=new Wa(I.type,[T]):"value"!==T.type.kind&&"value"===I.type.kind&&(I=new Wa(T.type,[I])));let k=null;if(4===_.length){if("string"!==T.type.kind&&"string"!==I.type.kind&&"value"!==T.type.kind&&"value"!==I.type.kind)return b.error("Cannot use collator to compare non-string types.");if(k=b.parse(_[3],3,ac),!k)return null}return new UH(T,I,k)}evaluate(_){const b=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(d&&this.hasUntypedArgument){const T=kr(b),I=kr(w);if(T.kind!==I.kind||"string"!==T.kind&&"number"!==T.kind)throw new io(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${I.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const T=kr(b),I=kr(w);if("string"!==T.kind||"string"!==I.kind)return o(_,b,w)}return this.collator?l(_,b,w,this.collator.evaluate(_)):o(_,b,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[a];return this.eachChild(b=>{_.push(b.serialize())}),_}}}const mr=Hs("==",function(a,o,l){return o===l},Hr),au=Hs("!=",function(a,o,l){return o!==l},function(a,o,l,d){return!Hr(0,o,l,d)}),lu=Hs("<",function(a,o,l){return o<l},function(a,o,l,d){return d.compare(o,l)<0}),$n=Hs(">",function(a,o,l){return o>l},function(a,o,l,d){return d.compare(o,l)>0}),cu=Hs("<=",function(a,o,l){return o<=l},function(a,o,l,d){return d.compare(o,l)<=0}),uu=Hs(">=",function(a,o,l){return o>=l},function(a,o,l,d){return d.compare(o,l)>=0});class Ju{constructor(o,l,d,p,_,b){this.type=kn,this.number=o,this.locale=l,this.currency=d,this.unit=p,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(o,l){if(3!==o.length)return l.error("Expected two arguments.");const d=l.parse(o[1],1,Et);if(!d)return null;const p=o[2];if("object"!=typeof p||Array.isArray(p))return l.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=l.parse(p.locale,1,kn),!_))return null;let b=null;if(p.currency&&(b=l.parse(p.currency,1,kn),!b))return null;let w=null;if(p.unit&&(w=l.parse(p.unit,1,kn),!w))return null;let T=null;if(p["min-fraction-digits"]&&(T=l.parse(p["min-fraction-digits"],1,Et),!T))return null;let I=null;return p["max-fraction-digits"]&&(I=l.parse(p["max-fraction-digits"],1,Et),!I)?null:new Ju(d,_,b,w,T,I)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Oo{constructor(o){this.type=Et,this.input=o}static parse(o,l){if(2!==o.length)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const d=l.parse(o[1],1);return d?"array"!==d.type.kind&&"string"!==d.type.kind&&"value"!==d.type.kind?l.error(`Expected argument of type string or array, but found ${wi(d.type)} instead.`):new Oo(d):null}evaluate(o){const l=this.input.evaluate(o);if("string"==typeof l||Array.isArray(l))return l.length;throw new io(`Expected value to be of type string or array, but found ${wi(kr(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}const zr={"==":mr,"!=":au,">":$n,"<":lu,">=":uu,"<=":cu,array:Wa,at:yo,boolean:Wa,case:jn,coalesce:vn,collator:eu,format:Ku,image:Rl,in:Po,"index-of":jd,interpolate:la,"interpolate-hcl":la,"interpolate-lab":la,length:Oo,let:Ci,literal:uc,match:$s,number:Wa,"number-format":Ju,object:Wa,slice:bs,step:iu,string:Wa,"to-boolean":Pn,"to-color":Pn,"to-number":Pn,"to-string":Pn,var:Ko,within:Ud};function bc(a,[o,l,d,p]){o=o.evaluate(a),l=l.evaluate(a),d=d.evaluate(a);const _=p?p.evaluate(a):1,b=mp(o,l,d,_);if(b)throw new io(b);return new ur(o/255*_,l/255*_,d/255*_,_)}function Xa(a,o){return a in o}function xs(a,o){const l=o[a];return void 0===l?null:l}function ws(a){return{type:a}}Za.register(zr,{error:[{kind:"error"},[kn],(a,[o])=>{throw new io(o.evaluate(a))}],typeof:[kn,[An],(a,[o])=>wi(kr(o.evaluate(a)))],"to-rgba":[cr(Et,4),[gs],(a,[o])=>o.evaluate(a).toArray()],rgb:[gs,[Et,Et,Et],bc],rgba:[gs,[Et,Et,Et,Et],bc],has:{type:qt,overloads:[[[kn],(a,[o])=>Xa(o.evaluate(a),a.properties())],[[kn,xi],(a,[o,l])=>Xa(o.evaluate(a),l.evaluate(a))]]},get:{type:An,overloads:[[[kn],(a,[o])=>xs(o.evaluate(a),a.properties())],[[kn,xi],(a,[o,l])=>xs(o.evaluate(a),l.evaluate(a))]]},"feature-state":[An,[kn],(a,[o])=>xs(o.evaluate(a),a.featureState||{})],properties:[xi,[],a=>a.properties()],"geometry-type":[kn,[],a=>a.geometryType()],id:[An,[],a=>a.id()],zoom:[Et,[],a=>a.globals.zoom],pitch:[Et,[],a=>a.globals.pitch||0],"distance-from-center":[Et,[],a=>a.distanceFromCenter()],"heatmap-density":[Et,[],a=>a.globals.heatmapDensity||0],"line-progress":[Et,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Et,[],a=>a.globals.skyRadialProgress||0],accumulated:[An,[],a=>void 0===a.globals.accumulated?null:a.globals.accumulated],"+":[Et,ws(Et),(a,o)=>{let l=0;for(const d of o)l+=d.evaluate(a);return l}],"*":[Et,ws(Et),(a,o)=>{let l=1;for(const d of o)l*=d.evaluate(a);return l}],"-":{type:Et,overloads:[[[Et,Et],(a,[o,l])=>o.evaluate(a)-l.evaluate(a)],[[Et],(a,[o])=>-o.evaluate(a)]]},"/":[Et,[Et,Et],(a,[o,l])=>o.evaluate(a)/l.evaluate(a)],"%":[Et,[Et,Et],(a,[o,l])=>o.evaluate(a)%l.evaluate(a)],ln2:[Et,[],()=>Math.LN2],pi:[Et,[],()=>Math.PI],e:[Et,[],()=>Math.E],"^":[Et,[Et,Et],(a,[o,l])=>Math.pow(o.evaluate(a),l.evaluate(a))],sqrt:[Et,[Et],(a,[o])=>Math.sqrt(o.evaluate(a))],log10:[Et,[Et],(a,[o])=>Math.log(o.evaluate(a))/Math.LN10],ln:[Et,[Et],(a,[o])=>Math.log(o.evaluate(a))],log2:[Et,[Et],(a,[o])=>Math.log(o.evaluate(a))/Math.LN2],sin:[Et,[Et],(a,[o])=>Math.sin(o.evaluate(a))],cos:[Et,[Et],(a,[o])=>Math.cos(o.evaluate(a))],tan:[Et,[Et],(a,[o])=>Math.tan(o.evaluate(a))],asin:[Et,[Et],(a,[o])=>Math.asin(o.evaluate(a))],acos:[Et,[Et],(a,[o])=>Math.acos(o.evaluate(a))],atan:[Et,[Et],(a,[o])=>Math.atan(o.evaluate(a))],min:[Et,ws(Et),(a,o)=>Math.min(...o.map(l=>l.evaluate(a)))],max:[Et,ws(Et),(a,o)=>Math.max(...o.map(l=>l.evaluate(a)))],abs:[Et,[Et],(a,[o])=>Math.abs(o.evaluate(a))],round:[Et,[Et],(a,[o])=>{const l=o.evaluate(a);return l<0?-Math.round(-l):Math.round(l)}],floor:[Et,[Et],(a,[o])=>Math.floor(o.evaluate(a))],ceil:[Et,[Et],(a,[o])=>Math.ceil(o.evaluate(a))],"filter-==":[qt,[kn,An],(a,[o,l])=>a.properties()[o.value]===l.value],"filter-id-==":[qt,[An],(a,[o])=>a.id()===o.value],"filter-type-==":[qt,[kn],(a,[o])=>a.geometryType()===o.value],"filter-<":[qt,[kn,An],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d<p}],"filter-id-<":[qt,[An],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l<d}],"filter->":[qt,[kn,An],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d>p}],"filter-id->":[qt,[An],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l>d}],"filter-<=":[qt,[kn,An],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d<=p}],"filter-id-<=":[qt,[An],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l<=d}],"filter->=":[qt,[kn,An],(a,[o,l])=>{const d=a.properties()[o.value],p=l.value;return typeof d==typeof p&&d>=p}],"filter-id->=":[qt,[An],(a,[o])=>{const l=a.id(),d=o.value;return typeof l==typeof d&&l>=d}],"filter-has":[qt,[An],(a,[o])=>o.value in a.properties()],"filter-has-id":[qt,[],a=>null!==a.id()&&void 0!==a.id()],"filter-type-in":[qt,[cr(kn)],(a,[o])=>o.value.indexOf(a.geometryType())>=0],"filter-id-in":[qt,[cr(An)],(a,[o])=>o.value.indexOf(a.id())>=0],"filter-in-small":[qt,[kn,cr(An)],(a,[o,l])=>l.value.indexOf(a.properties()[o.value])>=0],"filter-in-large":[qt,[kn,cr(An)],(a,[o,l])=>function(d,p,_,b){for(;_<=b;){const w=_+b>>1;if(p[w]===d)return!0;p[w]>d?b=w-1:_=w+1}return!1}(a.properties()[o.value],l.value,0,l.value.length-1)],all:{type:qt,overloads:[[[qt,qt],(a,[o,l])=>o.evaluate(a)&&l.evaluate(a)],[ws(qt),(a,o)=>{for(const l of o)if(!l.evaluate(a))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],(a,[o,l])=>o.evaluate(a)||l.evaluate(a)],[ws(qt),(a,o)=>{for(const l of o)if(l.evaluate(a))return!0;return!1}]]},"!":[qt,[qt],(a,[o])=>!o.evaluate(a)],"is-supported-script":[qt,[kn],(a,[o])=>{const l=a.globals&&a.globals.isSupportedScript;return!l||l(o.evaluate(a))}],upcase:[kn,[kn],(a,[o])=>o.evaluate(a).toUpperCase()],downcase:[kn,[kn],(a,[o])=>o.evaluate(a).toLowerCase()],concat:[kn,ws(An),(a,o)=>o.map(l=>Jc(l.evaluate(a))).join("")],"resolved-locale":[kn,[ac],(a,[o])=>o.evaluate(a).resolvedLocale()]});var zl=zr;function Ri(a){return{result:"success",value:a}}function du(a){return{result:"error",value:a}}function Qa(a){return"data-driven"===a["property-type"]}function ua(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function ro(a){return!!a.expression&&a.expression.interpolated}function Cn(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a}function Ta(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function vo(a){return a}function Hh(a,o){const l="color"===o.type,d=a.stops&&"object"==typeof a.stops[0][0],p=d||!(d||void 0!==a.property),_=a.type||(ro(o)?"exponential":"interval");if(l&&((a=ba({},a)).stops&&(a.stops=a.stops.map(I=>[I[0],ur.parse(I[1])])),a.default=ur.parse(a.default?a.default:o.default)),a.colorSpace&&"rgb"!==a.colorSpace&&!$h[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let b,w,T;if("exponential"===_)b=Ja;else if("interval"===_)b=ed;else if("categorical"===_){b=Qo,w=Object.create(null);for(const I of a.stops)w[I[0]]=I[1];T=typeof a.stops[0][0]}else{if("identity"!==_)throw new Error(`Unknown function type "${_}"`);b=el}if(d){const I={},k=[];for(let V=0;V<a.stops.length;V++){const U=a.stops[V],G=U[0].zoom;void 0===I[G]&&(I[G]={zoom:G,type:a.type,property:a.property,default:a.default,stops:[]},k.push(G)),I[G].stops.push([U[0].value,U[1]])}const F=[];for(const V of k)F.push([I[V].zoom,Hh(I[V],o)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:la.interpolationFactor.bind(void 0,N),zoomStops:F.map(V=>V[0]),evaluate:({zoom:V},U)=>Ja({stops:F,base:a.base},o,V).evaluate(V,U)}}if(p){const I="exponential"===_?{name:"exponential",base:void 0!==a.base?a.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:la.interpolationFactor.bind(void 0,I),zoomStops:a.stops.map(k=>k[0]),evaluate:({zoom:k})=>b(a,o,k,w,T)}}return{kind:"source",evaluate(I,k){const F=k&&k.properties?k.properties[a.property]:void 0;return void 0===F?Gr(a.default,o.default):b(a,o,F,w,T)}}}function Gr(a,o,l){return void 0!==a?a:void 0!==o?o:void 0!==l?l:void 0}function Qo(a,o,l,d,p){return Gr(typeof l===p?d[l]:void 0,a.default,o.default)}function ed(a,o,l){if("number"!==Cn(l))return Gr(a.default,o.default);const d=a.stops.length;if(1===d||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[d-1][0])return a.stops[d-1][1];const p=En(a.stops.map(_=>_[0]),l);return a.stops[p][1]}function Ja(a,o,l){const d=void 0!==a.base?a.base:1;if("number"!==Cn(l))return Gr(a.default,o.default);const p=a.stops.length;if(1===p||l<=a.stops[0][0])return a.stops[0][1];if(l>=a.stops[p-1][0])return a.stops[p-1][1];const _=En(a.stops.map(k=>k[0]),l),b=function(k,F,N,V){const U=V-N,G=k-N;return 0===U?0:1===F?G/U:(Math.pow(F,G)-1)/(Math.pow(F,U)-1)}(l,d,a.stops[_][0],a.stops[_+1][0]),w=a.stops[_][1],T=a.stops[_+1][1];let I=ru[o.type]||vo;if(a.colorSpace&&"rgb"!==a.colorSpace){const k=$h[a.colorSpace];I=(F,N)=>k.reverse(k.interpolate(k.forward(F),k.forward(N),b))}return"function"==typeof w.evaluate?{evaluate(...k){const F=w.evaluate.apply(void 0,k),N=T.evaluate.apply(void 0,k);if(void 0!==F&&void 0!==N)return I(F,N,b)}}:I(w,T,b)}function el(a,o,l){return"color"===o.type?l=ur.parse(l):"formatted"===o.type?l=fr.fromString(l.toString()):"resolvedImage"===o.type?l=Mo.fromString(l.toString()):Cn(l)===o.type||"enum"===o.type&&o.values[l]||(l=void 0),Gr(l,a.default,o.default)}class O{constructor(o,l){var d;this.expression=o,this._warningHistory={},this._evaluator=new hc,this._defaultValue=l?"color"===(d=l).type&&(Ta(d.default)||Array.isArray(d.default))?new ur(0,0,0,0):"color"===d.type?ur.parse(d.default)||null:void 0===d.default?null:d.default:null,this._enumValues=l&&"enum"===l.type?l.values:null}evaluateWithoutErrorHandling(o,l,d,p,_,b,w,T){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=d,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,d,p,_,b,w,T){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=d||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null;try{const I=this.expression.evaluate(this._evaluator);if(null==I||"number"==typeof I&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new io(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function L(a){return Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in zl}function q(a,o){const l=new lt(zl,[],o?function(p){const _={color:gs,string:kn,number:Et,enum:kn,boolean:qt,formatted:mi,resolvedImage:mn};return"array"===p.type?cr(_[p.value]||An,p.length):_[p.type]}(o):void 0),d=l.parse(a,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return d?Ri(new O(d,o)):du(l.errors)}class _e{constructor(o,l){this.kind=o,this._styleExpression=l,this.isStateDependent="constant"!==o&&!gc(l.expression)}evaluateWithoutErrorHandling(o,l,d,p,_,b){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,_,b)}evaluate(o,l,d,p,_,b){return this._styleExpression.evaluate(o,l,d,p,_,b)}}class Je{constructor(o,l,d,p){this.kind=o,this.zoomStops=d,this._styleExpression=l,this.isStateDependent="camera"!==o&&!gc(l.expression),this.interpolationType=p}evaluateWithoutErrorHandling(o,l,d,p,_,b){return this._styleExpression.evaluateWithoutErrorHandling(o,l,d,p,_,b)}evaluate(o,l,d,p,_,b){return this._styleExpression.evaluate(o,l,d,p,_,b)}interpolationFactor(o,l,d){return this.interpolationType?la.interpolationFactor(this.interpolationType,o,l,d):0}}function an(a,o){if("error"===(a=q(a,o)).result)return a;const l=a.value.expression,d=nu(l);if(!d&&!Qa(o))return du([new ra("","data expressions not supported")]);const p=Pl(l,["zoom","pitch","distance-from-center"]);if(!p&&!ua(o))return du([new ra("","zoom expressions not supported")]);const _=oo(l);return _||p?_ instanceof ra?du([_]):_ instanceof la&&!ro(o)?du([new ra("",'"interpolate" expressions cannot be used with this property')]):Ri(_?new Je(d?"camera":"composite",a.value,_.labels,_ instanceof la?_.interpolation:void 0):new _e(d?"constant":"source",a.value)):du([new ra("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Fi{constructor(o,l){this._parameters=o,this._specification=l,ba(this,Hh(this._parameters,this._specification))}static deserialize(o){return new Fi(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function oo(a){let o=null;if(a instanceof Ci)o=oo(a.result);else if(a instanceof vn){for(const l of a.args)if(o=oo(l),o)break}else(a instanceof iu||a instanceof la)&&a.input instanceof Za&&"zoom"===a.input.name&&(o=a);return o instanceof ra||a.eachChild(l=>{const d=oo(l);d instanceof ra?o=d:!o&&d?o=new ra("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&d&&o!==d&&(o=new ra("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}class bt{constructor(o,l,d,p){this.message=(o?`${o}: `:"")+d,p&&(this.identifier=p),null!=l&&l.__line__&&(this.line=l.__line__)}}function so(a){const o=a.key,l=a.value,d=a.valueSpec||{},p=a.objectElementValidators||{},_=a.style,b=a.styleSpec;let w=[];const T=Cn(l);if("object"!==T)return[new bt(o,l,`object expected, ${T} found`)];for(const I in l){const k=I.split(".")[0];let N;p[k]?N=p[k]:d[k]?N=Wi:p["*"]?N=p["*"]:d["*"]&&(N=Wi),N?w=w.concat(N({key:(o&&`${o}.`)+I,value:l[I],valueSpec:d[k]||d["*"],style:_,styleSpec:b,object:l,objectKey:I},l)):w.push(new bt(o,l[I],`unknown property "${I}"`))}for(const I in d)p[I]||d[I].required&&void 0===d[I].default&&void 0===l[I]&&w.push(new bt(o,l,`missing required property "${I}"`));return w}function $d(a){const o=a.value,l=a.valueSpec,d=a.style,p=a.styleSpec,_=a.key,b=a.arrayElementValidator||Wi;if("array"!==Cn(o))return[new bt(_,o,`array expected, ${Cn(o)} found`)];if(l.length&&o.length!==l.length)return[new bt(_,o,`array length ${l.length} expected, length ${o.length} found`)];if(l["min-length"]&&o.length<l["min-length"])return[new bt(_,o,`array length at least ${l["min-length"]} expected, length ${o.length} found`)];let w={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};p.$version<7&&(w.function=l.function),"object"===Cn(l.value)&&(w=l.value);let T=[];for(let I=0;I<o.length;I++)T=T.concat(b({array:o,arrayIndex:I,value:o[I],valueSpec:w,style:d,styleSpec:p,key:`${_}[${I}]`}));return T}function ig(a){const o=a.key,l=a.value,d=a.valueSpec;let p=Cn(l);if("number"===p&&l!=l&&(p="NaN"),"number"!==p)return[new bt(o,l,`number expected, ${p} found`)];if("minimum"in d){let _=d.minimum;if("array"===Cn(d.minimum)&&(_=d.minimum[a.arrayIndex]),l<_)return[new bt(o,l,`${l} is less than the minimum value ${_}`)]}if("maximum"in d){let _=d.maximum;if("array"===Cn(d.maximum)&&(_=d.maximum[a.arrayIndex]),l>_)return[new bt(o,l,`${l} is greater than the maximum value ${_}`)]}return[]}function Gh(a){const o=a.valueSpec,l=lr(a.value.type);let d,p,_,b={};const w="categorical"!==l&&void 0===a.value.property,T=!w,I="array"===Cn(a.value.stops)&&"array"===Cn(a.value.stops[0])&&"object"===Cn(a.value.stops[0][0]),k=so({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(V){if("identity"===l)return[new bt(V.key,V.value,'identity function may not have a "stops" property')];let U=[];const G=V.value;return U=U.concat($d({key:V.key,value:G,valueSpec:V.valueSpec,style:V.style,styleSpec:V.styleSpec,arrayElementValidator:F})),"array"===Cn(G)&&0===G.length&&U.push(new bt(V.key,G,"array must have at least one stop")),U},default:function(V){return Wi({key:V.key,value:V.value,valueSpec:o,style:V.style,styleSpec:V.styleSpec})}}});return"identity"===l&&w&&k.push(new bt(a.key,a.value,'missing required property "property"')),"identity"===l||a.value.stops||k.push(new bt(a.key,a.value,'missing required property "stops"')),"exponential"===l&&a.valueSpec.expression&&!ro(a.valueSpec)&&k.push(new bt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Qa(a.valueSpec)?k.push(new bt(a.key,a.value,"property functions not supported")):w&&!ua(a.valueSpec)&&k.push(new bt(a.key,a.value,"zoom functions not supported"))),"categorical"!==l&&!I||void 0!==a.value.property||k.push(new bt(a.key,a.value,'"property" property is required')),k;function F(V){let U=[];const G=V.value,Q=V.key;if("array"!==Cn(G))return[new bt(Q,G,`array expected, ${Cn(G)} found`)];if(2!==G.length)return[new bt(Q,G,`array length 2 expected, length ${G.length} found`)];if(I){if("object"!==Cn(G[0]))return[new bt(Q,G,`object expected, ${Cn(G[0])} found`)];if(void 0===G[0].zoom)return[new bt(Q,G,"object stop key must have zoom")];if(void 0===G[0].value)return[new bt(Q,G,"object stop key must have value")];const ae=lr(G[0].zoom);if("number"!=typeof ae)return[new bt(Q,G[0].zoom,"stop zoom values must be numbers")];if(_&&_>ae)return[new bt(Q,G[0].zoom,"stop zoom values must appear in ascending order")];ae!==_&&(_=ae,p=void 0,b={}),U=U.concat(so({key:`${Q}[0]`,value:G[0],valueSpec:{zoom:{}},style:V.style,styleSpec:V.styleSpec,objectElementValidators:{zoom:ig,value:N}}))}else U=U.concat(N({key:`${Q}[0]`,value:G[0],valueSpec:{},style:V.style,styleSpec:V.styleSpec},G));return L(Ga(G[1]))?U.concat([new bt(`${Q}[1]`,G[1],"expressions are not allowed in function stops.")]):U.concat(Wi({key:`${Q}[1]`,value:G[1],valueSpec:o,style:V.style,styleSpec:V.styleSpec}))}function N(V,U){const G=Cn(V.value),Q=lr(V.value),ae=null!==V.value?V.value:U;if(d){if(G!==d)return[new bt(V.key,ae,`${G} stop domain type must match previous stop domain type ${d}`)]}else d=G;if("number"!==G&&"string"!==G&&"boolean"!==G&&"number"!=typeof Q&&"string"!=typeof Q&&"boolean"!=typeof Q)return[new bt(V.key,ae,"stop domain value must be a number, string, or boolean")];if("number"!==G&&"categorical"!==l){let ge=`number expected, ${G} found`;return Qa(o)&&void 0===l&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new bt(V.key,ae,ge)]}return"categorical"!==l||"number"!==G||"number"==typeof Q&&isFinite(Q)&&Math.floor(Q)===Q?"categorical"!==l&&"number"===G&&"number"==typeof Q&&"number"==typeof p&&void 0!==p&&Q<p?[new bt(V.key,ae,"stop domain values must appear in ascending order")]:(p=Q,"categorical"===l&&Q in b?[new bt(V.key,ae,"stop domain values must be unique")]:(b[Q]=!0,[])):[new bt(V.key,ae,`integer expected, found ${String(Q)}`)]}}function Hd(a){const o=("property"===a.expressionContext?an:q)(Ga(a.value),a.valueSpec);if("error"===o.result)return o.value.map(d=>new bt(`${a.key}${d.key}`,a.value,d.message));const l=o.value.expression||o.value._styleExpression.expression;if("property"===a.expressionContext&&"text-font"===a.propertyKey&&!l.outputDefined())return[new bt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===a.expressionContext&&"layout"===a.propertyType&&!gc(l))return[new bt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===a.expressionContext)return my(l,a);if(a.expressionContext&&0===a.expressionContext.indexOf("cluster")){if(!Pl(l,["zoom","feature-state"]))return[new bt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===a.expressionContext&&!nu(l))return[new bt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function my(a,o){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const p of o.valueSpec.expression.parameters)l.delete(p);if(0===l.size)return[];const d=[];return a instanceof Za&&l.has(a.name)?[new bt(o.key,o.value,`["${a.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(a.eachChild(p=>{d.push(...my(p,o))}),d)}function _p(a){const o=a.key,l=a.value,d=a.valueSpec,p=[];return Array.isArray(d.values)?-1===d.values.indexOf(lr(l))&&p.push(new bt(o,l,`expected one of [${d.values.join(", ")}], ${JSON.stringify(l)} found`)):-1===Object.keys(d.values).indexOf(lr(l))&&p.push(new bt(o,l,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(l)} found`)),p}function rg(a){if(!0===a||!1===a)return!0;if(!Array.isArray(a)||0===a.length)return!1;switch(a[0]){case"has":return a.length>=2&&"$id"!==a[1]&&"$type"!==a[1];case"in":return a.length>=3&&("string"!=typeof a[1]||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==a.length||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const o of a.slice(1))if(!rg(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function Gd(a,o="fill"){if(null==a)return{filter:()=>!0,needGeometry:!1,needFeature:!1};rg(a)||(a=Fo(a));const l=a;let d=!0;try{d=function(I){if(!bo(I))return I;let k=Ga(I);return Wh(k),k=td(k),k}(l)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(l,null,2)}\n        `)}const p=Ye[`filter_${o}`],_=q(d,p);let b=null;if("error"===_.result)throw new Error(_.value.map(I=>`${I.key}: ${I.message}`).join(", "));b=(I,k,F)=>_.value.evaluate(I,k,{},F);let w=null,T=null;if(d!==l){const I=q(l,p);if("error"===I.result)throw new Error(I.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,F,N,V,U)=>I.value.evaluate(k,F,{},N,void 0,void 0,V,U),T=!nu(I.value.expression)}return{filter:b,dynamicFilter:w||void 0,needGeometry:og(d),needFeature:!!T}}function td(a){if(!Array.isArray(a))return a;const o=function(l){if(yp.has(l[0]))for(let d=1;d<l.length;d++)if(bo(l[d]))return!0;return l}(a);return!0===o?o:o.map(l=>td(l))}function Wh(a){let o=!1;const l=[];if("case"===a[0]){for(let d=1;d<a.length-1;d+=2)o=o||bo(a[d]),l.push(a[d+1]);l.push(a[a.length-1])}else if("match"===a[0]){o=o||bo(a[1]);for(let d=2;d<a.length-1;d+=2)l.push(a[d+1]);l.push(a[a.length-1])}else if("step"===a[0]){o=o||bo(a[1]);for(let d=1;d<a.length-1;d+=2)l.push(a[d+1])}o&&(a.length=0,a.push("any",...l));for(let d=1;d<a.length;d++)Wh(a[d])}function bo(a){if(!Array.isArray(a))return!1;if("pitch"===(o=a[0])||"distance-from-center"===o)return!0;var o;for(let l=1;l<a.length;l++)if(bo(a[l]))return!0;return!1}const yp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function hu(a,o){return a<o?-1:a>o?1:0}function og(a){if(!Array.isArray(a))return!1;if("within"===a[0])return!0;for(let o=1;o<a.length;o++)if(og(a[o]))return!0;return!1}function Fo(a){if(!a)return!0;const o=a[0];return a.length<=1?"any"!==o:"=="===o?qh(a[1],a[2],"=="):"!="===o?fu(qh(a[1],a[2],"==")):"<"===o||">"===o||"<="===o||">="===o?qh(a[1],a[2],o):"any"===o?(l=a.slice(1),["any"].concat(l.map(Fo))):"all"===o?["all"].concat(a.slice(1).map(Fo)):"none"===o?["all"].concat(a.slice(1).map(Fo).map(fu)):"in"===o?Zh(a[1],a.slice(2)):"!in"===o?fu(Zh(a[1],a.slice(2))):"has"===o?sg(a[1]):"!has"===o?fu(sg(a[1])):"within"!==o||a;var l}function qh(a,o,l){switch(a){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,a,o]}}function Zh(a,o){if(0===o.length)return!1;switch(a){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",a,["literal",o.sort(hu)]]:["filter-in-small",a,["literal",o]]}}function sg(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function fu(a){return["!",a]}function Yh(a){return rg(Ga(a.value))?Hd(ba({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):ag(a)}function ag(a){const o=a.value,l=a.key;if("array"!==Cn(o))return[new bt(l,o,`array expected, ${Cn(o)} found`)];const d=a.styleSpec;let p,_=[];if(o.length<1)return[new bt(l,o,"filter array must have at least 1 element")];switch(_=_.concat(_p({key:`${l}[0]`,value:o[0],valueSpec:d.filter_operator,style:a.style,styleSpec:a.styleSpec})),lr(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&"$type"===lr(o[1])&&_.push(new bt(l,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":3!==o.length&&_.push(new bt(l,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(p=Cn(o[1]),"string"!==p&&_.push(new bt(`${l}[1]`,o[1],`string expected, ${p} found`)));for(let b=2;b<o.length;b++)p=Cn(o[b]),"$type"===lr(o[1])?_=_.concat(_p({key:`${l}[${b}]`,value:o[b],valueSpec:d.geometry_type,style:a.style,styleSpec:a.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&_.push(new bt(`${l}[${b}]`,o[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<o.length;b++)_=_.concat(ag({key:`${l}[${b}]`,value:o[b],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":p=Cn(o[1]),2!==o.length?_.push(new bt(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"string"!==p&&_.push(new bt(`${l}[1]`,o[1],`string expected, ${p} found`));break;case"within":p=Cn(o[1]),2!==o.length?_.push(new bt(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):"object"!==p&&_.push(new bt(`${l}[1]`,o[1],`object expected, ${p} found`))}return _}function nd(a,o){const l=a.key,d=a.style,p=a.styleSpec,_=a.value,b=a.objectKey,w=p[`${o}_${a.layerType}`];if(!w)return[];const T=b.match(/^(.*)-transition$/);if("paint"===o&&T&&w[T[1]]&&w[T[1]].transition)return Wi({key:l,value:_,valueSpec:p.transition,style:d,styleSpec:p});const I=a.valueSpec||w[b];if(!I)return[new bt(l,_,`unknown property "${b}"`)];let k;if("string"===Cn(_)&&Qa(I)&&!I.tokens&&(k=/^{([^}]+)}$/.exec(_))){const N=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new bt(l,_,`"${b}" does not support interpolation syntax\nUse an identity property function instead: ${N}.`)]}const F=[];return"symbol"===a.layerType&&("text-field"===b&&d&&!d.glyphs&&F.push(new bt(l,_,'use of "text-field" requires a style "glyphs" property')),"text-font"===b&&Ta(Ga(_))&&"identity"===lr(_.type)&&F.push(new bt(l,_,'"text-font" does not support identity functions'))),F.concat(Wi({key:a.key,value:_,valueSpec:I,style:d,styleSpec:p,expressionContext:"property",propertyType:o,propertyKey:b}))}function lg(a){return nd(a,"paint")}function Es(a){return nd(a,"layout")}function Kh(a){let o=[];const l=a.value,d=a.key,p=a.style,_=a.styleSpec;l.type||l.ref||o.push(new bt(d,l,'either "type" or "ref" is required'));let b=lr(l.type);const w=lr(l.ref);if(l.id){const T=lr(l.id);for(let I=0;I<a.arrayIndex;I++){const k=p.layers[I];lr(k.id)===T&&o.push(new bt(d,l.id,`duplicate layer id "${l.id}", previously used at line ${k.id.__line__}`))}}if("ref"in l){let T;["type","source","source-layer","filter","layout"].forEach(I=>{I in l&&o.push(new bt(d,l[I],`"${I}" is prohibited for ref layers`))}),p.layers.forEach(I=>{lr(I.id)===w&&(T=I)}),T?T.ref?o.push(new bt(d,l.ref,"ref cannot reference another ref layer")):b=lr(T.type):"string"==typeof w&&o.push(new bt(d,l.ref,`ref layer "${w}" not found`))}else if("background"!==b&&"sky"!==b)if(l.source){const T=p.sources&&p.sources[l.source],I=T&&lr(T.type);T?"vector"===I&&"raster"===b?o.push(new bt(d,l.source,`layer "${l.id}" requires a raster source`)):"raster"===I&&"raster"!==b?o.push(new bt(d,l.source,`layer "${l.id}" requires a vector source`)):"vector"!==I||l["source-layer"]?"raster-dem"===I&&"hillshade"!==b?o.push(new bt(d,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==b||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||"geojson"===I&&T.lineMetrics||o.push(new bt(d,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new bt(d,l,`layer "${l.id}" must specify a "source-layer"`)):o.push(new bt(d,l.source,`source "${l.source}" not found`))}else o.push(new bt(d,l,'missing required property "source"'));return o=o.concat(so({key:d,value:l,valueSpec:_.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Wi({key:`${d}.type`,value:l.type,valueSpec:_.layer.type,style:a.style,styleSpec:a.styleSpec,object:l,objectKey:"type"}),filter:T=>Yh(ba({layerType:b},T)),layout:T=>so({layer:l,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":I=>Es(ba({layerType:b},I))}}),paint:T=>so({layer:l,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":I=>lg(ba({layerType:b},I))}})}})),o}function pu(a){const o=a.value,l=a.key,d=Cn(o);return"string"!==d?[new bt(l,o,`string expected, ${d} found`)]:[]}const Vr={promoteId:function({key:a,value:o}){if("string"===Cn(o))return pu({key:a,value:o});{const l=[];for(const d in o)l.push(...pu({key:`${a}.${d}`,value:o[d]}));return l}}};function Wd(a){const o=a.value,l=a.key,d=a.styleSpec,p=a.style;if(!o.type)return[new bt(l,o,'"type" is required')];const _=lr(o.type);let b;switch(_){case"vector":case"raster":case"raster-dem":return b=so({key:l,value:o,valueSpec:d[`source_${_.replace("-","_")}`],style:a.style,styleSpec:d,objectElementValidators:Vr}),b;case"geojson":if(b=so({key:l,value:o,valueSpec:d.source_geojson,style:p,styleSpec:d,objectElementValidators:Vr}),o.cluster)for(const w in o.clusterProperties){const[T,I]=o.clusterProperties[w],k="string"==typeof T?[T,["accumulated"],["get",w]]:T;b.push(...Hd({key:`${l}.${w}.map`,value:I,expressionContext:"cluster-map"})),b.push(...Hd({key:`${l}.${w}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return b;case"video":return so({key:l,value:o,valueSpec:d.source_video,style:p,styleSpec:d});case"image":return so({key:l,value:o,valueSpec:d.source_image,style:p,styleSpec:d});case"canvas":return[new bt(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _p({key:`${l}.type`,value:o.type,valueSpec:{values:qd(d)},style:p,styleSpec:d})}}function qd(a){return a.source.reduce((o,l)=>{const d=a[l];return"enum"===d.type.type&&(o=o.concat(Object.keys(d.type.values))),o},[])}function Cs(a){const o=a.value,l=a.styleSpec,d=l.light,p=a.style;let _=[];const b=Cn(o);if(void 0===o)return _;if("object"!==b)return _=_.concat([new bt("light",o,`object expected, ${b} found`)]),_;for(const w in o){const T=w.match(/^(.*)-transition$/);_=_.concat(T&&d[T[1]]&&d[T[1]].transition?Wi({key:w,value:o[w],valueSpec:l.transition,style:p,styleSpec:l}):d[w]?Wi({key:w,value:o[w],valueSpec:d[w],style:p,styleSpec:l}):[new bt(w,o[w],`unknown property "${w}"`)])}return _}function vp(a){const o=a.value,l=a.key,d=a.style,p=a.styleSpec,_=p.terrain;let b=[];const w=Cn(o);if(void 0===o)return b;if("object"!==w)return b=b.concat([new bt("terrain",o,`object expected, ${w} found`)]),b;for(const T in o){const I=T.match(/^(.*)-transition$/);b=b.concat(I&&_[I[1]]&&_[I[1]].transition?Wi({key:T,value:o[T],valueSpec:p.transition,style:d,styleSpec:p}):_[T]?Wi({key:T,value:o[T],valueSpec:_[T],style:d,styleSpec:p}):[new bt(T,o[T],`unknown property "${T}"`)])}if(o.source){const T=d.sources&&d.sources[o.source],I=T&&lr(T.type);T?"raster-dem"!==I&&b.push(new bt(l,o.source,`terrain cannot be used with a source of type ${String(I)}, it only be used with a "raster-dem" source type`)):b.push(new bt(l,o.source,`source "${o.source}" not found`))}else b.push(new bt(l,o,'terrain is missing required property "source"'));return b}function bp(a){const o=a.value,l=a.style,d=a.styleSpec,p=d.fog;let _=[];const b=Cn(o);if(void 0===o)return _;if("object"!==b)return _=_.concat([new bt("fog",o,`object expected, ${b} found`)]),_;for(const w in o){const T=w.match(/^(.*)-transition$/);_=_.concat(T&&p[T[1]]&&p[T[1]].transition?Wi({key:w,value:o[w],valueSpec:d.transition,style:l,styleSpec:d}):p[w]?Wi({key:w,value:o[w],valueSpec:p[w],style:l,styleSpec:d}):[new bt(w,o[w],`unknown property "${w}"`)])}return _}const Vl={"*":()=>[],array:$d,boolean:function(a){const o=a.value,l=a.key,d=Cn(o);return"boolean"!==d?[new bt(l,o,`boolean expected, ${d} found`)]:[]},number:ig,color:function(a){const o=a.key,l=a.value,d=Cn(l);return"string"!==d?[new bt(o,l,`color expected, ${d} found`)]:null===Sn(l)?[new bt(o,l,`color expected, "${l}" found`)]:[]},enum:_p,filter:Yh,function:Gh,layer:Kh,object:so,source:Wd,light:Cs,terrain:vp,fog:bp,string:pu,formatted:function(a){return 0===pu(a).length?[]:Hd(a)},resolvedImage:function(a){return 0===pu(a).length?[]:Hd(a)},projection:function(a){const o=a.value,l=a.styleSpec,d=l.projection,p=a.style;let _=[];const b=Cn(o);if("object"===b)for(const w in o)_=_.concat(Wi({key:w,value:o[w],valueSpec:d[w],style:p,styleSpec:l}));else"string"!==b&&(_=_.concat([new bt("projection",o,`object or string expected, ${b} found`)]));return _}};function Wi(a){const o=a.value,l=a.valueSpec,d=a.styleSpec;return l.expression&&Ta(lr(o))?Gh(a):l.expression&&L(Ga(o))?Hd(a):l.type&&Vl[l.type]?Vl[l.type](a):so(ba({},a,{valueSpec:l.type?d[l.type]:l}))}function gy(a){const o=a.value,l=a.key,d=pu(a);return d.length||(-1===o.indexOf("{fontstack}")&&d.push(new bt(l,o,'"glyphs" url must include a "{fontstack}" token')),-1===o.indexOf("{range}")&&d.push(new bt(l,o,'"glyphs" url must include a "{range}" token'))),d}function Zd(a,o=Ye){return tl(Wi({key:"",value:a,valueSpec:o.$root,styleSpec:o,style:a,objectElementValidators:{glyphs:gy,"*":()=>[]}}))}const _y=a=>tl(lg(a)),Ul=a=>tl(Es(a));function tl(a){return a.slice().sort((o,l)=>o.line&&l.line?o.line-l.line:0)}function Xh(a,o){let l=!1;if(o&&o.length)for(const d of o)a.fire(new Vs(new Error(d.message))),l=!0;return l}var Tn=Ia;function Ia(a,o,l){var d=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var p=new Int32Array(this.arrayBuffer);a=p[0],this.d=(o=p[1])+2*(l=p[2]);for(var _=0;_<this.d*this.d;_++){var b=p[3+_],w=p[3+_+1];d.push(b===w?null:p.subarray(b,w))}var T=p[3+d.length+1];this.keys=p.subarray(p[3+d.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=o+2*l;for(var I=0;I<this.d*this.d;I++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=a,this.padding=l,this.scale=o/a,this.uid=0;var k=l/o*a;this.min=-k,this.max=a+k}Ia.prototype.insert=function(a,o,l,d,p){this._forEachCell(o,l,d,p,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(p)},Ia.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ia.prototype._insertCell=function(a,o,l,d,p,_){this.cells[p].push(_)},Ia.prototype.query=function(a,o,l,d,p){var _=this.min,b=this.max;if(a<=_&&o<=_&&b<=l&&b<=d&&!p)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(a,o,l,d,this._queryCell,w,{},p),w},Ia.prototype._queryCell=function(a,o,l,d,p,_,b,w){var T=this.cells[p];if(null!==T)for(var I=this.keys,k=this.bboxes,F=0;F<T.length;F++){var N=T[F];if(void 0===b[N]){var V=4*N;(w?w(k[V+0],k[V+1],k[V+2],k[V+3]):a<=k[V+2]&&o<=k[V+3]&&l>=k[V+0]&&d>=k[V+1])?(b[N]=!0,_.push(I[N])):b[N]=!1}}},Ia.prototype._forEachCell=function(a,o,l,d,p,_,b,w){for(var T=this._convertToCellCoord(a),I=this._convertToCellCoord(o),k=this._convertToCellCoord(l),F=this._convertToCellCoord(d),N=T;N<=k;N++)for(var V=I;V<=F;V++){var U=this.d*V+N;if((!w||w(this._convertFromCellCoord(N),this._convertFromCellCoord(V),this._convertFromCellCoord(N+1),this._convertFromCellCoord(V+1)))&&p.call(this,a,o,l,d,U,_,b,w))return}},Ia.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Ia.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Ia.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,o=3+this.cells.length+1+1,l=0,d=0;d<this.cells.length;d++)l+=this.cells[d].length;var p=new Int32Array(o+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var _=o,b=0;b<a.length;b++){var w=a[b];p[3+b]=_,p.set(w,_),_+=w.length}return p[3+a.length]=_,p.set(this.keys,_),p[3+a.length+1]=_+=this.keys.length,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer};const xp={};function Nt(a,o,l={}){Object.defineProperty(a,"_classRegistryKey",{value:o,writeable:!1}),xp[o]={klass:a,omit:l.omit||[]}}Nt(Object,"Object"),Tn.serialize=function(a,o){const l=a.toArrayBuffer();return o&&o.push(l),{buffer:l}},Tn.deserialize=function(a){return new Tn(a.buffer)},Object.defineProperty(Tn,"name",{value:"Grid"}),Nt(Tn,"Grid"),Nt(ur,"Color"),Nt(Error,"Error"),Nt(wn,"AJAXError"),Nt(Mo,"ResolvedImage"),Nt(Fi,"StylePropertyFunction"),Nt(O,"StyleExpression",{omit:["_evaluator"]}),Nt(Je,"ZoomDependentExpression"),Nt(_e,"ZoomConstantExpression"),Nt(Za,"CompoundExpression",{omit:["_evaluate"]});for(const a in zl)xp[zl[a]._classRegistryKey]||Nt(zl[a],`Expression${a}`);function cg(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&"ArrayBuffer"===a.constructor.name)}function Yd(a){return ze.ImageBitmap&&a instanceof ze.ImageBitmap}function id(a,o){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(cg(a)||Yd(a))return o&&o.push(a),a;if(ArrayBuffer.isView(a)){const l=a;return o&&o.push(l.buffer),l}if(a instanceof ze.ImageData)return o&&o.push(a.data.buffer),a;if(Array.isArray(a)){const l=[];for(const d of a)l.push(id(d,o));return l}if("object"==typeof a){const l=a.constructor,d=l._classRegistryKey;if(!d)throw new Error(`can't serialize object of unregistered class ${d}`);const p=l.serialize?l.serialize(a,o):{};if(!l.serialize){for(const _ in a)a.hasOwnProperty(_)&&(xp[d].omit.indexOf(_)>=0||(p[_]=id(a[_],o)));a instanceof Error&&(p.message=a.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==d&&(p.$name=d),p}throw new Error("can't serialize object of type "+typeof a)}function Kd(a){if(null==a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||cg(a)||Yd(a)||ArrayBuffer.isView(a)||a instanceof ze.ImageData)return a;if(Array.isArray(a))return a.map(Kd);if("object"==typeof a){const o=a.$name||"Object",{klass:l}=xp[o];if(!l)throw new Error(`can't deserialize unregistered class ${o}`);if(l.deserialize)return l.deserialize(a);const d=Object.create(l.prototype);for(const p of Object.keys(a))"$name"!==p&&(d[p]=Kd(a[p]));return d}throw new Error("can't deserialize object of type "+typeof a)}const Xd=a=>a>=1536&&a<=1791,gt=a=>a>=1872&&a<=1919,di=a=>a>=2208&&a<=2303,wp=a=>a>=11904&&a<=12031,Qh=a=>a>=12032&&a<=12255,Wr=a=>a>=12272&&a<=12287,rd=a=>a>=12288&&a<=12351,xc=a=>a>=12352&&a<=12447,Jo=a=>a>=12448&&a<=12543,od=a=>a>=12544&&a<=12591,Jh=a=>a>=12704&&a<=12735,ug=a=>a>=12736&&a<=12783,dg=a=>a>=12784&&a<=12799,Ep=a=>a>=12800&&a<=13055,Lo=a=>a>=13056&&a<=13311,nl=a=>a>=13312&&a<=19903,ef=a=>a>=19968&&a<=40959,mu=a=>a>=40960&&a<=42127,il=a=>a>=42128&&a<=42191,hg=a=>a>=44032&&a<=55215,Cp=a=>a>=63744&&a<=64255,tf=a=>a>=64336&&a<=65023,Qd=a=>a>=65040&&a<=65055,g=a=>a>=65072&&a<=65103,c=a=>a>=65104&&a<=65135,h=a=>a>=65136&&a<=65279,y=a=>a>=65280&&a<=65519;function x(a){for(const o of a)if(M(o.charCodeAt(0)))return!0;return!1}function E(a){for(const o of a)if(!D(o.charCodeAt(0)))return!1;return!0}function D(a){return!(Xd(a)||gt(a)||di(a)||tf(a)||h(a))}function M(a){return!(746!==a&&747!==a&&(a<4352||!(Jh(a)||od(a)||g(a)&&!(a>=65097&&a<=65103)||Cp(a)||Lo(a)||wp(a)||ug(a)||!(!rd(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||12336===a)||nl(a)||ef(a)||Ep(a)||(o=a,o>=12592&&o<=12687)||(o=>o>=43360&&o<=43391)(a)||(o=>o>=55216&&o<=55295)(a)||(o=>o>=4352&&o<=4607)(a)||hg(a)||xc(a)||Wr(a)||(o=>o>=12688&&o<=12703)(a)||Qh(a)||dg(a)||Jo(a)&&12540!==a||!(!y(a)||65288===a||65289===a||65293===a||a>=65306&&a<=65310||65339===a||65341===a||65343===a||a>=65371&&a<=65503||65507===a||a>=65512&&a<=65519)||!(!c(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(o=>o>=5120&&o<=5759)(a)||(o=>o>=6320&&o<=6399)(a)||Qd(a)||(o=>o>=19904&&o<=19967)(a)||mu(a)||il(a))));var o}function P(a){return!(M(a)||(o=a,(l=o)>=128&&l<=255&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||(l=>l>=8192&&l<=8303)(o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||(l=>l>=8448&&l<=8527)(o)||(l=>l>=8528&&l<=8591)(o)||(l=>l>=8960&&l<=9215)(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||(l=>l>=9216&&l<=9279)(o)&&9251!==o||(l=>l>=9280&&l<=9311)(o)||(l=>l>=9312&&l<=9471)(o)||(l=>l>=9632&&l<=9727)(o)||(l=>l>=9728&&l<=9983)(o)&&!(o>=9754&&o<=9759)||(l=>l>=11008&&l<=11263)(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||rd(o)||Jo(o)||(l=>l>=57344&&l<=63743)(o)||g(o)||c(o)||y(o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o,l}function z(a){return a>=1424&&a<=2303||tf(a)||h(a)}function B(a,o){return!(!o&&z(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(l=a,l>=6016&&l<=6143));var l}function $(a){for(const o of a)if(z(o.charCodeAt(0)))return!0;return!1}const X="deferred",ee="loading",te="loaded";let ne=null,J="unavailable",Y=null;const ce=function(a){a&&"string"==typeof a&&a.indexOf("NetworkError")>-1&&(J="error"),ne&&ne(a)};function le(){de.fire(new Di("pluginStateChange",{pluginStatus:J,pluginURL:Y}))}const de=new ms,xe=function(){return J},ye=function(){if(J!==X||!Y)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");J=ee,le(),Y&&Ml({url:Y},a=>{a?ce(a):(J=te,le())})},Ce={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>J===te||null!=Ce.applyArabicShaping,isLoading:()=>J===ee,setState(a){J=a.pluginStatus,Y=a.pluginURL},isParsed:()=>null!=Ce.applyArabicShaping&&null!=Ce.processBidirectionalText&&null!=Ce.processStyledBidirectionalText,getPluginURL:()=>Y};class Ae{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(o){return function(l,d){for(const p of l)if(!B(p.charCodeAt(0),d))return!1;return!0}(o,Ce.isLoaded())}}class Ne{constructor(o,l){this.property=o,this.value=l,this.expression=function(d,p){if(Ta(d))return new Fi(d,p);if(L(d)){const _=an(d,p);if("error"===_.result)throw new Error(_.value.map(b=>`${b.key}: ${b.message}`).join(", "));return _.value}{let _=d;return"string"==typeof d&&"color"===p.type&&(_=ur.parse(d)),{kind:"constant",evaluate:()=>_}}}(void 0===l?o.specification.default:l,o.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,l,d){return this.property.possiblyEvaluate(this,o,l,d)}}class Ve{constructor(o){this.property=o,this.value=new Ne(o,void 0)}transitioned(o,l){return new Pe(this.property,this.value,l,xn({},o.transition,this.transition),o.now)}untransitioned(){return new Pe(this.property,this.value,null,{},0)}}class yt{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues)}getValue(o){return dr(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new Ve(this._values[o].property)),this._values[o].value=new Ne(this._values[o].property,null===l?void 0:dr(l))}getTransition(o){return dr(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new Ve(this._values[o].property)),this._values[o].transition=dr(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(o[l]=d);const p=this.getTransition(l);void 0!==p&&(o[`${l}-transition`]=p)}return o}transitioned(o,l){const d=new et(this._properties);for(const p of Object.keys(this._values))d._values[p]=this._values[p].transitioned(o,l._values[p]);return d}untransitioned(){const o=new et(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class Pe{constructor(o,l,d,p,_){const b=p.delay||0,w=p.duration||0;_=_||0,this.property=o,this.value=l,this.begin=_+b,this.end=this.begin+w,o.specification.transition&&(p.delay||p.duration)&&(this.prior=d)}possiblyEvaluate(o,l,d){const p=o.now||0,_=this.value.possiblyEvaluate(o,l,d),b=this.prior;if(b){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return b.possiblyEvaluate(o,l,d);{const w=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(o,l,d),_,Gi(w))}}return _}}class et{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,d){const p=new Ue(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(o,l,d);return p}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class We{constructor(o){this._properties=o,this._values=Object.create(o.defaultPropertyValues)}getValue(o){return dr(this._values[o].value)}setValue(o,l){this._values[o]=new Ne(this._values[o].property,null===l?void 0:dr(l))}serialize(){const o={};for(const l of Object.keys(this._values)){const d=this.getValue(l);void 0!==d&&(o[l]=d)}return o}possiblyEvaluate(o,l,d){const p=new Ue(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(o,l,d);return p}}class ht{constructor(o,l,d){this.property=o,this.value=l,this.parameters=d}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,l,d,p){return this.property.evaluate(this.value,this.parameters,o,l,d,p)}}class Ue{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class Se{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,d){const p=ru[this.specification.type];return p?p(o,l,d):o}}class He{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,d,p){return new ht(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(l,null,{},d,p)}:o.expression,l)}interpolate(o,l,d){if("constant"!==o.value.kind||"constant"!==l.value.kind)return o;if(void 0===o.value.value||void 0===l.value.value)return new ht(this,{kind:"constant",value:void 0},o.parameters);const p=ru[this.specification.type];return p?new ht(this,{kind:"constant",value:p(o.value.value,l.value.value,d)},o.parameters):o}evaluate(o,l,d,p,_,b){return"constant"===o.kind?o.value:o.evaluate(l,d,p,_,b)}}class ct{constructor(o){this.specification=o}possiblyEvaluate(o,l,d,p){return!!o.expression.evaluate(l,null,{},d,p)}interpolate(){return!1}}class ft{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new Ae(0,{});for(const d in o){const p=o[d];p.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new Ne(p,void 0),b=this.defaultTransitionablePropertyValues[d]=new Ve(p);this.defaultTransitioningPropertyValues[d]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate(l)}}}function Yt(a,o){return 256*(a=_n(Math.floor(a),0,255))+_n(Math.floor(o),0,255)}Nt(He,"DataDrivenProperty"),Nt(Se,"DataConstantProperty"),Nt(ct,"ColorRampProperty");const On={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ft{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Kt(a,o=1){let l=0,d=0;return{members:a.map(p=>{const _=On[p.type].BYTES_PER_ELEMENT,b=l=Rn(l,Math.max(o,_)),w=p.components||1;return d=Math.max(d,_),l+=_*w,{name:p.name,type:p.type,components:w,offset:b}}),size:Rn(l,Math.max(d,o)),alignment:o}}function Rn(a,o){return Math.ceil(a/o)*o}class Jt extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.int16[p+0]=l,this.int16[p+1]=d,o}}Jt.prototype.bytesPerElement=4,Nt(Jt,"StructArrayLayout2i4");class _i extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.int16[_+0]=l,this.int16[_+1]=d,this.int16[_+2]=p,o}}_i.prototype.bytesPerElement=6,Nt(_i,"StructArrayLayout3i6");class hi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const b=4*o;return this.int16[b+0]=l,this.int16[b+1]=d,this.int16[b+2]=p,this.int16[b+3]=_,o}}hi.prototype.bytesPerElement=8,Nt(hi,"StructArrayLayout4i8");class qi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w){const T=this.length;return this.resize(T+1),this.emplace(T,o,l,d,p,_,b,w)}emplace(o,l,d,p,_,b,w,T){const I=6*o,k=12*o,F=3*o;return this.int16[I+0]=l,this.int16[I+1]=d,this.uint8[k+4]=p,this.uint8[k+5]=_,this.uint8[k+6]=b,this.uint8[k+7]=w,this.float32[F+2]=T,o}}qi.prototype.bytesPerElement=12,Nt(qi,"StructArrayLayout2i4ub1f12");class Si extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const b=4*o;return this.float32[b+0]=l,this.float32[b+1]=d,this.float32[b+2]=p,this.float32[b+3]=_,o}}Si.prototype.bytesPerElement=16,Nt(Si,"StructArrayLayout4f16");class gr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,o,l,d,p,_)}emplace(o,l,d,p,_,b){const w=6*o,T=3*o;return this.uint16[w+0]=l,this.uint16[w+1]=d,this.uint16[w+2]=p,this.uint16[w+3]=_,this.float32[T+2]=b,o}}gr.prototype.bytesPerElement=12,Nt(gr,"StructArrayLayout4ui1f12");class xo extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const b=4*o;return this.uint16[b+0]=l,this.uint16[b+1]=d,this.uint16[b+2]=p,this.uint16[b+3]=_,o}}xo.prototype.bytesPerElement=8,Nt(xo,"StructArrayLayout4ui8");class rl extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,d,p,_,b)}emplace(o,l,d,p,_,b,w){const T=6*o;return this.int16[T+0]=l,this.int16[T+1]=d,this.int16[T+2]=p,this.int16[T+3]=_,this.int16[T+4]=b,this.int16[T+5]=w,o}}rl.prototype.bytesPerElement=12,Nt(rl,"StructArrayLayout6i12");class ol extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w,T,I,k,F,N){const V=this.length;return this.resize(V+1),this.emplace(V,o,l,d,p,_,b,w,T,I,k,F,N)}emplace(o,l,d,p,_,b,w,T,I,k,F,N,V){const U=12*o;return this.int16[U+0]=l,this.int16[U+1]=d,this.int16[U+2]=p,this.int16[U+3]=_,this.uint16[U+4]=b,this.uint16[U+5]=w,this.uint16[U+6]=T,this.uint16[U+7]=I,this.int16[U+8]=k,this.int16[U+9]=F,this.int16[U+10]=N,this.int16[U+11]=V,o}}ol.prototype.bytesPerElement=24,Nt(ol,"StructArrayLayout4i4ui4i24");class Qi extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,d,p,_,b)}emplace(o,l,d,p,_,b,w){const T=10*o,I=5*o;return this.int16[T+0]=l,this.int16[T+1]=d,this.int16[T+2]=p,this.float32[I+2]=_,this.float32[I+3]=b,this.float32[I+4]=w,o}}Qi.prototype.bytesPerElement=20,Nt(Qi,"StructArrayLayout3i3f20");class Ui extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}Ui.prototype.bytesPerElement=4,Nt(Ui,"StructArrayLayout1ul4");class Fn extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w,T,I,k,F,N,V){const U=this.length;return this.resize(U+1),this.emplace(U,o,l,d,p,_,b,w,T,I,k,F,N,V)}emplace(o,l,d,p,_,b,w,T,I,k,F,N,V,U){const G=20*o,Q=10*o;return this.int16[G+0]=l,this.int16[G+1]=d,this.int16[G+2]=p,this.int16[G+3]=_,this.int16[G+4]=b,this.float32[Q+3]=w,this.float32[Q+4]=T,this.float32[Q+5]=I,this.float32[Q+6]=k,this.int16[G+14]=F,this.uint32[Q+8]=N,this.uint16[G+18]=V,this.uint16[G+19]=U,o}}Fn.prototype.bytesPerElement=40,Nt(Fn,"StructArrayLayout5i4f1i1ul2ui40");class _r extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w){const T=this.length;return this.resize(T+1),this.emplace(T,o,l,d,p,_,b,w)}emplace(o,l,d,p,_,b,w,T){const I=8*o;return this.int16[I+0]=l,this.int16[I+1]=d,this.int16[I+2]=p,this.int16[I+4]=_,this.int16[I+5]=b,this.int16[I+6]=w,this.int16[I+7]=T,o}}_r.prototype.bytesPerElement=16,Nt(_r,"StructArrayLayout3i2i2i16");class qr extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,o,l,d,p,_)}emplace(o,l,d,p,_,b){const w=4*o,T=8*o;return this.float32[w+0]=l,this.float32[w+1]=d,this.float32[w+2]=p,this.int16[T+6]=_,this.int16[T+7]=b,o}}qr.prototype.bytesPerElement=16,Nt(qr,"StructArrayLayout2f1f2i16");class ji extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const b=12*o,w=3*o;return this.uint8[b+0]=l,this.uint8[b+1]=d,this.float32[w+1]=p,this.float32[w+2]=_,o}}ji.prototype.bytesPerElement=12,Nt(ji,"StructArrayLayout2ub2f12");class wo extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.float32[_+0]=l,this.float32[_+1]=d,this.float32[_+2]=p,o}}wo.prototype.bytesPerElement=12,Nt(wo,"StructArrayLayout3f12");class ao extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,d)}emplace(o,l,d,p){const _=3*o;return this.uint16[_+0]=l,this.uint16[_+1]=d,this.uint16[_+2]=p,o}}ao.prototype.bytesPerElement=6,Nt(ao,"StructArrayLayout3ui6");class sl extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve){const me=this.length;return this.resize(me+1),this.emplace(me,o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve)}emplace(o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve,me){const Be=30*o,Fe=15*o,Ze=60*o;return this.int16[Be+0]=l,this.int16[Be+1]=d,this.int16[Be+2]=p,this.float32[Fe+2]=_,this.float32[Fe+3]=b,this.uint16[Be+8]=w,this.uint16[Be+9]=T,this.uint32[Fe+5]=I,this.uint32[Fe+6]=k,this.uint32[Fe+7]=F,this.uint16[Be+16]=N,this.uint16[Be+17]=V,this.uint16[Be+18]=U,this.float32[Fe+10]=G,this.float32[Fe+11]=Q,this.uint8[Ze+48]=ae,this.uint8[Ze+49]=ge,this.uint8[Ze+50]=se,this.uint32[Fe+13]=he,this.int16[Be+28]=ve,this.uint8[Ze+58]=me,o}}sl.prototype.bytesPerElement=60,Nt(sl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class sd extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve,me,Be,Fe,Ze,dt,je,Xe,it,ut){const pt=this.length;return this.resize(pt+1),this.emplace(pt,o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve,me,Be,Fe,Ze,dt,je,Xe,it,ut)}emplace(o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q,ae,ge,se,he,ve,me,Be,Fe,Ze,dt,je,Xe,it,ut,pt){const Ge=38*o,wt=19*o;return this.int16[Ge+0]=l,this.int16[Ge+1]=d,this.int16[Ge+2]=p,this.float32[wt+2]=_,this.float32[wt+3]=b,this.int16[Ge+8]=w,this.int16[Ge+9]=T,this.int16[Ge+10]=I,this.int16[Ge+11]=k,this.int16[Ge+12]=F,this.int16[Ge+13]=N,this.uint16[Ge+14]=V,this.uint16[Ge+15]=U,this.uint16[Ge+16]=G,this.uint16[Ge+17]=Q,this.uint16[Ge+18]=ae,this.uint16[Ge+19]=ge,this.uint16[Ge+20]=se,this.uint16[Ge+21]=he,this.uint16[Ge+22]=ve,this.uint16[Ge+23]=me,this.uint16[Ge+24]=Be,this.uint16[Ge+25]=Fe,this.uint16[Ge+26]=Ze,this.uint16[Ge+27]=dt,this.uint16[Ge+28]=je,this.uint32[wt+15]=Xe,this.float32[wt+16]=it,this.float32[wt+17]=ut,this.float32[wt+18]=pt,o}}sd.prototype.bytesPerElement=76,Nt(sd,"StructArrayLayout3i2f6i15ui1ul3f76");class Ts extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}Ts.prototype.bytesPerElement=4,Nt(Ts,"StructArrayLayout1f4");class Gs extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,o,l,d,p,_)}emplace(o,l,d,p,_,b){const w=5*o;return this.float32[w+0]=l,this.float32[w+1]=d,this.float32[w+2]=p,this.float32[w+3]=_,this.float32[w+4]=b,o}}Gs.prototype.bytesPerElement=20,Nt(Gs,"StructArrayLayout5f20");class al extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,d,p)}emplace(o,l,d,p,_){const b=6*o;return this.uint32[3*o+0]=l,this.uint16[b+2]=d,this.uint16[b+3]=p,this.uint16[b+4]=_,o}}al.prototype.bytesPerElement=12,Nt(al,"StructArrayLayout1ul3ui12");class jl extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.uint16[p+0]=l,this.uint16[p+1]=d,o}}jl.prototype.bytesPerElement=4,Nt(jl,"StructArrayLayout2ui4");class wc extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}wc.prototype.bytesPerElement=2,Nt(wc,"StructArrayLayout1ui2");class $l extends kt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const d=this.length;return this.resize(d+1),this.emplace(d,o,l)}emplace(o,l,d){const p=2*o;return this.float32[p+0]=l,this.float32[p+1]=d,o}}$l.prototype.bytesPerElement=8,Nt($l,"StructArrayLayout2f8");class ad extends Ft{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ad.prototype.size=40;class yy extends Fn{get(o){return new ad(this,o)}}Nt(yy,"CollisionBoxArray");class vy extends Ft{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}vy.prototype.size=60;class by extends sl{get(o){return new vy(this,o)}}Nt(by,"PlacedSymbolArray");class Jd extends Ft{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(o){this._structArray.uint32[this._pos4+15]=o}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Jd.prototype.size=76;class rx extends sd{get(o){return new Jd(this,o)}}Nt(rx,"SymbolInstanceArray");class No extends Ts{getoffsetX(o){return this.float32[1*o+0]}}Nt(No,"GlyphOffsetArray");class fg extends Jt{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Nt(fg,"SymbolLineVertexArray");class ox extends Ft{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ox.prototype.size=12;class xy extends al{get(o){return new ox(this,o)}}Nt(xy,"FeatureIndexArray");class Tp extends jl{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Nt(Tp,"FillExtrusionCentroidArray");const nf=Kt([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),rf=Kt([{name:"a_dash",components:4,type:"Uint16"}]);var ll={},sx={get exports(){return ll},set exports(a){ll=a}},Ip={};({get exports(){return Ip},set exports(a){Ip=a}}).exports=function(a,o){var l,d,p,_,b,w,T,I;for(d=a.length-(l=3&a.length),p=o,b=3432918353,w=461845907,I=0;I<d;)T=255&a.charCodeAt(I)|(255&a.charCodeAt(++I))<<8|(255&a.charCodeAt(++I))<<16|(255&a.charCodeAt(++I))<<24,++I,p=27492+(65535&(_=5*(65535&(p=(p^=T=(65535&(T=(T=(65535&T)*b+(((T>>>16)*b&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(T=0,l){case 3:T^=(255&a.charCodeAt(I+2))<<16;case 2:T^=(255&a.charCodeAt(I+1))<<8;case 1:p^=T=(65535&(T=(T=(65535&(T^=255&a.charCodeAt(I)))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295}return p^=a.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var ld={};({get exports(){return ld},set exports(a){ld=a}}).exports=function(a,o){for(var l,d=a.length,p=o^d,_=0;d>=4;)l=1540483477*(65535&(l=255&a.charCodeAt(_)|(255&a.charCodeAt(++_))<<8|(255&a.charCodeAt(++_))<<16|(255&a.charCodeAt(++_))<<24))+((1540483477*(l>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),d-=4,++_;switch(d){case 3:p^=(255&a.charCodeAt(_+2))<<16;case 2:p^=(255&a.charCodeAt(_+1))<<8;case 1:p=1540483477*(65535&(p^=255&a.charCodeAt(_)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var fT=Ip,pT=ld;sx.exports=fT,ll.murmur3=fT,ll.murmur2=pT;class Ct{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,l,d,p){this.ids.push(mT(o)),this.positions.push(l,d,p)}getPositions(o){const l=mT(o);let d=0,p=this.ids.length-1;for(;d<p;){const b=d+p>>1;this.ids[b]>=l?p=b:d=b+1}const _=[];for(;this.ids[d]===l;)_.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return _}static serialize(o,l){const d=new Float64Array(o.ids),p=new Uint32Array(o.positions);return ax(d,p,0,d.length-1),l&&l.push(d.buffer,p.buffer),{ids:d,positions:p}}static deserialize(o){const l=new Ct;return l.ids=o.ids,l.positions=o.positions,l.indexed=!0,l}}function mT(a){const o=+a;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:ll(String(a))}function ax(a,o,l,d){for(;l<d;){const p=a[l+d>>1];let _=l-1,b=d+1;for(;;){do{_++}while(a[_]<p);do{b--}while(a[b]>p);if(_>=b)break;wy(a,_,b),wy(o,3*_,3*b),wy(o,3*_+1,3*b+1),wy(o,3*_+2,3*b+2)}b-l<d-b?(ax(a,o,l,b),l=b+1):(ax(a,o,b+1,d),d=b)}}function wy(a,o,l){const d=a[o];a[o]=a[l],a[l]=d}Nt(Ct,"FeaturePositionMap");class cd{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}}class Ey extends cd{constructor(o){super(o),this.current=0}set(o,l,d){this.fetchUniformLocation(o,l)&&this.current!==d&&(this.current=d,this.gl.uniform1f(this.location,d))}}class gT extends cd{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,d){this.fetchUniformLocation(o,l)&&(d[0]===this.current[0]&&d[1]===this.current[1]&&d[2]===this.current[2]&&d[3]===this.current[3]||(this.current=d,this.gl.uniform4f(this.location,d[0],d[1],d[2],d[3])))}}class _T extends cd{constructor(o){super(o),this.current=ur.transparent}set(o,l,d){this.fetchUniformLocation(o,l)&&(d.r===this.current.r&&d.g===this.current.g&&d.b===this.current.b&&d.a===this.current.a||(this.current=d,this.gl.uniform4f(this.location,d.r,d.g,d.b,d.a)))}}const Dp=new Float32Array(16),OO=new Float32Array(9),FO=new Float32Array(4);function Zr(a){return[Yt(255*a.r,255*a.g),Yt(255*a.b,255*a.a)]}class eh{constructor(o,l,d){this.value=o,this.uniformNames=l.map(p=>`u_${p}`),this.type=d}setUniform(o,l,d,p,_){l.set(o,_,p.constantOr(this.value))}getBinding(o,l){return"color"===this.type?new _T(o):new Ey(o)}}class Ec{constructor(o,l){this.uniformNames=l.map(d=>`u_${d}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,d,p,_){const b="u_pattern"===_||"u_dash"===_?this.pattern:"u_pixel_ratio"===_?this.pixelRatio:null;b&&l.set(o,_,b)}getBinding(o,l){return"u_pattern"===l||"u_dash"===l?new gT(o):new Ey(o)}}class gu{constructor(o,l,d,p){this.expression=o,this.type=d,this.maxValue=0,this.paintVertexAttributes=l.map(_=>({name:`a_${_}`,type:"Float32",components:"color"===d?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(o,l,d,p,_,b){const w=this.paintVertexArray.length,T=this.expression.evaluate(new Ae(0),l,{},_,p,b);this.paintVertexArray.resize(o),this._setPaintValue(w,o,T)}updatePaintArray(o,l,d,p,_){const b=this.expression.evaluate({zoom:0},d,p,void 0,_);this._setPaintValue(o,l,b)}_setPaintValue(o,l,d){if("color"===this.type){const p=Zr(d);for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=o;p<l;p++)this.paintVertexArray.emplace(p,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ur{constructor(o,l,d,p,_,b){this.expression=o,this.uniformNames=l.map(w=>`u_${w}_t`),this.type=d,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=l.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===d?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(o,l,d,p,_,b){const w=this.expression.evaluate(new Ae(this.zoom),l,{},_,p,b),T=this.expression.evaluate(new Ae(this.zoom+1),l,{},_,p,b),I=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(I,o,w,T)}updatePaintArray(o,l,d,p,_){const b=this.expression.evaluate({zoom:this.zoom},d,p,void 0,_),w=this.expression.evaluate({zoom:this.zoom+1},d,p,void 0,_);this._setPaintValue(o,l,b,w)}_setPaintValue(o,l,d,p){if("color"===this.type){const _=Zr(d),b=Zr(p);for(let w=o;w<l;w++)this.paintVertexArray.emplace(w,_[0],_[1],b[0],b[1])}else{for(let _=o;_<l;_++)this.paintVertexArray.emplace(_,d,p);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(p))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,d,p,_){const b=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,w=_n(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);l.set(o,_,w)}getBinding(o,l){return new Ey(o)}}class da{constructor(o,l,d,p,_){this.expression=o,this.layerId=_,this.paintVertexAttributes=("array"===d?rf:nf).members;for(let b=0;b<l.length;++b);this.paintVertexArray=new p}populatePaintArray(o,l,d){const p=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(p,o,l.patterns&&l.patterns[this.layerId],d)}updatePaintArray(o,l,d,p,_,b){this._setPaintValues(o,l,d.patterns&&d.patterns[this.layerId],b)}_setPaintValues(o,l,d,p){if(!p||!d)return;const _=p[d];if(!_)return;const{tl:b,br:w,pixelRatio:T}=_;for(let I=o;I<l;I++)this.paintVertexArray.emplace(I,b[0],b[1],w[0],w[1],T)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _u{constructor(o,l,d=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const _ in o.paint._values){if(!d(_))continue;const b=o.paint.get(_);if(!(b instanceof ht&&Qa(b.property.specification)))continue;const w=yT(_,o.type),T=b.value,I=b.property.specification.type,k=!!b.property.useIntegerZoom,F="line-dasharray"===_||_.endsWith("pattern"),N="line-dasharray"===_&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==T.kind||N)if("source"===T.kind||N||F){const V=bT(_,I,"source");this.binders[_]=F?new da(T,w,I,V,o.id):new gu(T,w,I,V),p.push(`/a_${_}`)}else{const V=bT(_,I,"composite");this.binders[_]=new Ur(T,w,I,k,l,V),p.push(`/z_${_}`)}else this.binders[_]=F?new Ec(T.value,w):new eh(T.value,w,I),p.push(`/u_${_}`)}this.cacheKey=p.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof gu||l instanceof Ur?l.maxValue:0}populatePaintArrays(o,l,d,p,_,b){for(const w in this.binders){const T=this.binders[w];(T instanceof gu||T instanceof Ur||T instanceof da)&&T.populatePaintArray(o,l,d,p,_,b)}}setConstantPatternPositions(o){for(const l in this.binders){const d=this.binders[l];d instanceof Ec&&d.setConstantPatternPositions(o)}}updatePaintArrays(o,l,d,p,_,b){let w=!1;for(const T in o){const I=l.getPositions(T);for(const k of I){const F=d.feature(k.index);for(const N in this.binders){const V=this.binders[N];if((V instanceof gu||V instanceof Ur||V instanceof da)&&!0===V.expression.isStateDependent){const U=p.paint.get(N);V.expression=U.value,V.updatePaintArray(k.start,k.end,F,o[T],_,b),w=!0}}}}return w}defines(){const o=[];for(const l in this.binders){const d=this.binders[l];(d instanceof eh||d instanceof Ec)&&o.push(...d.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof gu||d instanceof Ur||d instanceof da)for(let p=0;p<d.paintVertexAttributes.length;p++)o.push(d.paintVertexAttributes[p].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const d=this.binders[l];if(d instanceof eh||d instanceof Ec||d instanceof Ur)for(const p of d.uniformNames)o.push(p)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof eh||p instanceof Ec||p instanceof Ur)for(const _ of p.uniformNames)l.push({name:_,property:d,binding:p.getBinding(o,_)})}return l}setUniforms(o,l,d,p,_){for(const{name:b,property:w,binding:T}of d)this.binders[w].setUniform(o,T,_,p.get(w),b)}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof gu||l instanceof Ur||l instanceof da)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(const l in this.binders){const d=this.binders[l];(d instanceof gu||d instanceof Ur||d instanceof da)&&d.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof gu||l instanceof Ur||l instanceof da)&&l.destroy()}}}class Cc{constructor(o,l,d=(()=>!0)){this.programConfigurations={};for(const p of o)this.programConfigurations[p.id]=new _u(p,l,d);this.needsUpload=!1,this._featureMap=new Ct,this._bufferOffset=0}populatePaintArrays(o,l,d,p,_,b,w){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(o,l,p,_,b,w);void 0!==l.id&&this._featureMap.add(l.id,d,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,d,p,_){for(const b of d)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(o,this._featureMap,l,b,p,_)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Sp={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function yT(a,o){return Sp[a]||[a.replace(`${o}-`,"").replace(/-/g,"_")]}const LO={"line-pattern":{source:gr,composite:gr},"fill-pattern":{source:gr,composite:gr},"fill-extrusion-pattern":{source:gr,composite:gr},"line-dasharray":{source:xo,composite:xo}},vT={color:{source:$l,composite:Si},number:{source:Ts,composite:$l}};function bT(a,o,l){const d=LO[a];return d&&d[l]||vT[o][l]}Nt(eh,"ConstantBinder"),Nt(Ec,"PatternConstantBinder"),Nt(gu,"SourceExpressionBinder"),Nt(da,"PatternCompositeBinder"),Nt(Ur,"CompositeExpressionBinder"),Nt(_u,"ProgramConfiguration",{omit:["_buffers"]}),Nt(Cc,"ProgramConfigurationSet");const Is="-transition";class Da extends ms{constructor(o,l){if(super(),this.id=o.id,this.type=o.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==o.type&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,"background"!==o.type&&"sky"!==o.type&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter),l.layout&&(this._unevaluatedLayout=new We(l.layout)),l.paint)){this._transitionablePaint=new yt(l.paint);for(const d in o.paint)this.setPaintProperty(d,o.paint[d],{validate:!1});for(const d in o.layout)this.setLayoutProperty(d,o.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ue(l.paint)}}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l,d={}){null!=l&&this._validate(Ul,`layers.${this.id}.layout.${o}`,o,l,d)||("visibility"!==o?this._unevaluatedLayout.setValue(o,l):this.visibility=l)}getPaintProperty(o){return Ns(o,Is)?this._transitionablePaint.getTransition(o.slice(0,-Is.length)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l,d={}){if(null!=l&&this._validate(_y,`layers.${this.id}.paint.${o}`,o,l,d))return!1;if(Ns(o,Is))return this._transitionablePaint.setTransition(o.slice(0,-Is.length),l||void 0),!1;{const p=this._transitionablePaint._values[o],_=p.value.isDataDriven(),b=p.value;this._transitionablePaint.setValue(o,l),this._handleSpecialPaintPropertyUpdate(o);const w=this._transitionablePaint._values[o].value,T=w.isDataDriven(),I=Ns(o,"pattern")||"line-dasharray"===o;return T||_||I||this._handleOverridablePaintPropertyUpdate(o,b,w)}}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getProgramConfiguration(o){return null}_handleOverridablePaintPropertyUpdate(o,l,d){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),zn(o,(l,d)=>!(void 0===l||"layout"===d&&!Object.keys(l).length||"paint"===d&&!Object.keys(l).length))}_validate(o,l,d,p,_={}){return(!_||!1!==_.validate)&&Xh(this,o.call(Zd,{key:l,layerType:this.type,objectKey:d,value:p,styleSpec:Ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof ht&&Qa(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Gd(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const sf=Kt([{name:"a_pos",components:2,type:"Int16"}],4),NO=Kt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Cr{constructor(o=[]){this.segments=o}prepareSegment(o,l,d,p){let _=this.segments[this.segments.length-1];return o>Cr.MAX_VERTEX_ARRAY_LENGTH&&ni(`Max vertices per segment is ${Cr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!_||_.vertexLength+o>Cr.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:l.length,primitiveOffset:d.length,vertexLength:0,primitiveLength:0},void 0!==p&&(_.sortKey=p),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,d,p){return new Cr([{vertexOffset:o,primitiveOffset:l,vertexLength:d,primitiveLength:p,vaos:{},sortKey:0}])}}Cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nt(Cr,"SegmentVector");var gn=8192;class ud{constructor(o,l){o&&(l?this.setSouthWest(o).setNorthEast(l):4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1]))}setNorthEast(o){return this._ne=o instanceof li?new li(o.lng,o.lat):li.convert(o),this}setSouthWest(o){return this._sw=o instanceof li?new li(o.lng,o.lat):li.convert(o),this}extend(o){const l=this._sw,d=this._ne;let p,_;if(o instanceof li)p=o,_=o;else{if(!(o instanceof ud))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(ud.convert(o)):this.extend(li.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(li.convert(o)):this;if(p=o._sw,_=o._ne,!p||!_)return this}return l||d?(l.lng=Math.min(p.lng,l.lng),l.lat=Math.min(p.lat,l.lat),d.lng=Math.max(_.lng,d.lng),d.lat=Math.max(_.lat,d.lat)):(this._sw=new li(p.lng,p.lat),this._ne=new li(_.lng,_.lat)),this}getCenter(){return new li((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new li(this.getWest(),this.getNorth())}getSouthEast(){return new li(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:d}=li.convert(o);let p=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=d&&d<=this._ne.lat&&p}static convert(o){return!o||o instanceof ud?o:new ud(o)}}var pg=1e-6,ha=typeof Float32Array<"u"?Float32Array:Array;function lx(){var a=new ha(9);return ha!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function cx(a,o,l){var d=o[0],p=o[1],_=o[2],b=o[3],w=o[4],T=o[5],I=o[6],k=o[7],F=o[8],N=l[0],V=l[1],U=l[2],G=l[3],Q=l[4],ae=l[5],ge=l[6],se=l[7],he=l[8];return a[0]=N*d+V*b+U*I,a[1]=N*p+V*w+U*k,a[2]=N*_+V*T+U*F,a[3]=G*d+Q*b+ae*I,a[4]=G*p+Q*w+ae*k,a[5]=G*_+Q*T+ae*F,a[6]=ge*d+se*b+he*I,a[7]=ge*p+se*w+he*k,a[8]=ge*_+se*T+he*F,a}function Sa(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function af(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],b=o[4],w=o[5],T=o[6],I=o[7],k=o[8],F=o[9],N=o[10],V=o[11],U=o[12],G=o[13],Q=o[14],ae=o[15],ge=l*w-d*b,se=l*T-p*b,he=l*I-_*b,ve=d*T-p*w,me=d*I-_*w,Be=p*I-_*T,Fe=k*G-F*U,Ze=k*Q-N*U,dt=k*ae-V*U,je=F*Q-N*G,Xe=F*ae-V*G,it=N*ae-V*Q,ut=ge*it-se*Xe+he*je+ve*dt-me*Ze+Be*Fe;return ut?(a[0]=(w*it-T*Xe+I*je)*(ut=1/ut),a[1]=(p*Xe-d*it-_*je)*ut,a[2]=(G*Be-Q*me+ae*ve)*ut,a[3]=(N*me-F*Be-V*ve)*ut,a[4]=(T*dt-b*it-I*Ze)*ut,a[5]=(l*it-p*dt+_*Ze)*ut,a[6]=(Q*he-U*Be-ae*se)*ut,a[7]=(k*Be-N*he+V*se)*ut,a[8]=(b*Xe-w*dt+I*Fe)*ut,a[9]=(d*dt-l*Xe-_*Fe)*ut,a[10]=(U*me-G*he+ae*ge)*ut,a[11]=(F*he-k*me-V*ge)*ut,a[12]=(w*Ze-b*je-T*Fe)*ut,a[13]=(l*je-d*Ze+p*Fe)*ut,a[14]=(G*se-U*ve-Q*ge)*ut,a[15]=(k*ve-F*se+N*ge)*ut,a):null}function Tc(a,o,l){var d=o[0],p=o[1],_=o[2],b=o[3],w=o[4],T=o[5],I=o[6],k=o[7],F=o[8],N=o[9],V=o[10],U=o[11],G=o[12],Q=o[13],ae=o[14],ge=o[15],se=l[0],he=l[1],ve=l[2],me=l[3];return a[0]=se*d+he*w+ve*F+me*G,a[1]=se*p+he*T+ve*N+me*Q,a[2]=se*_+he*I+ve*V+me*ae,a[3]=se*b+he*k+ve*U+me*ge,a[4]=(se=l[4])*d+(he=l[5])*w+(ve=l[6])*F+(me=l[7])*G,a[5]=se*p+he*T+ve*N+me*Q,a[6]=se*_+he*I+ve*V+me*ae,a[7]=se*b+he*k+ve*U+me*ge,a[8]=(se=l[8])*d+(he=l[9])*w+(ve=l[10])*F+(me=l[11])*G,a[9]=se*p+he*T+ve*N+me*Q,a[10]=se*_+he*I+ve*V+me*ae,a[11]=se*b+he*k+ve*U+me*ge,a[12]=(se=l[12])*d+(he=l[13])*w+(ve=l[14])*F+(me=l[15])*G,a[13]=se*p+he*T+ve*N+me*Q,a[14]=se*_+he*I+ve*V+me*ae,a[15]=se*b+he*k+ve*U+me*ge,a}function or(a,o,l){var d,p,_,b,w,T,I,k,F,N,V,U,G=l[0],Q=l[1],ae=l[2];return o===a?(a[12]=o[0]*G+o[4]*Q+o[8]*ae+o[12],a[13]=o[1]*G+o[5]*Q+o[9]*ae+o[13],a[14]=o[2]*G+o[6]*Q+o[10]*ae+o[14],a[15]=o[3]*G+o[7]*Q+o[11]*ae+o[15]):(p=o[1],_=o[2],b=o[3],w=o[4],T=o[5],I=o[6],k=o[7],F=o[8],N=o[9],V=o[10],U=o[11],a[0]=d=o[0],a[1]=p,a[2]=_,a[3]=b,a[4]=w,a[5]=T,a[6]=I,a[7]=k,a[8]=F,a[9]=N,a[10]=V,a[11]=U,a[12]=d*G+w*Q+F*ae+o[12],a[13]=p*G+T*Q+N*ae+o[13],a[14]=_*G+I*Q+V*ae+o[14],a[15]=b*G+k*Q+U*ae+o[15]),a}function dd(a,o,l){var d=l[0],p=l[1],_=l[2];return a[0]=o[0]*d,a[1]=o[1]*d,a[2]=o[2]*d,a[3]=o[3]*d,a[4]=o[4]*p,a[5]=o[5]*p,a[6]=o[6]*p,a[7]=o[7]*p,a[8]=o[8]*_,a[9]=o[9]*_,a[10]=o[10]*_,a[11]=o[11]*_,a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],a}function Hl(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[4],b=o[5],w=o[6],T=o[7],I=o[8],k=o[9],F=o[10],N=o[11];return o!==a&&(a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[4]=_*p+I*d,a[5]=b*p+k*d,a[6]=w*p+F*d,a[7]=T*p+N*d,a[8]=I*p-_*d,a[9]=k*p-b*d,a[10]=F*p-w*d,a[11]=N*p-T*d,a}function mg(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[0],b=o[1],w=o[2],T=o[3],I=o[8],k=o[9],F=o[10],N=o[11];return o!==a&&(a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=_*p-I*d,a[1]=b*p-k*d,a[2]=w*p-F*d,a[3]=T*p-N*d,a[8]=_*d+I*p,a[9]=b*d+k*p,a[10]=w*d+F*p,a[11]=T*d+N*p,a}function Cy(a,o){return a[0]=o[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=o[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function lf(a,o,l){var d,p,_,b=l[0],w=l[1],T=l[2],I=Math.hypot(b,w,T);return I<pg?null:(b*=I=1/I,w*=I,T*=I,d=Math.sin(o),p=Math.cos(o),a[0]=b*b*(_=1-p)+p,a[1]=w*b*_+T*d,a[2]=T*b*_-w*d,a[3]=0,a[4]=b*w*_-T*d,a[5]=w*w*_+p,a[6]=T*w*_+b*d,a[7]=0,a[8]=b*T*_+w*d,a[9]=w*T*_-b*d,a[10]=T*T*_+p,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,o=arguments.length;o--;)a+=arguments[o]*arguments[o];return Math.sqrt(a)});var gg=Tc;function _g(){var a=new ha(3);return ha!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ux(a){var o=new ha(3);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o}function Ap(a){return Math.hypot(a[0],a[1],a[2])}function Gl(a,o,l){var d=new ha(3);return d[0]=a,d[1]=o,d[2]=l,d}function Aa(a,o,l){return a[0]=o[0]+l[0],a[1]=o[1]+l[1],a[2]=o[2]+l[2],a}function Ty(a,o,l){return a[0]=o[0]-l[0],a[1]=o[1]-l[1],a[2]=o[2]-l[2],a}function xT(a,o,l){return a[0]=o[0]*l[0],a[1]=o[1]*l[1],a[2]=o[2]*l[2],a}function cf(a,o,l){return a[0]=Math.min(o[0],l[0]),a[1]=Math.min(o[1],l[1]),a[2]=Math.min(o[2],l[2]),a}function Mp(a,o,l){return a[0]=Math.max(o[0],l[0]),a[1]=Math.max(o[1],l[1]),a[2]=Math.max(o[2],l[2]),a}function cl(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a}function kp(a,o,l,d){return a[0]=o[0]+l[0]*d,a[1]=o[1]+l[1]*d,a[2]=o[2]+l[2]*d,a}function Ds(a,o){var l=o[0],d=o[1],p=o[2],_=l*l+d*d+p*p;return _>0&&(_=1/Math.sqrt(_)),a[0]=o[0]*_,a[1]=o[1]*_,a[2]=o[2]*_,a}function ul(a,o){return a[0]*o[0]+a[1]*o[1]+a[2]*o[2]}function uf(a,o,l){var d=o[0],p=o[1],_=o[2],b=l[0],w=l[1],T=l[2];return a[0]=p*T-_*w,a[1]=_*b-d*T,a[2]=d*w-p*b,a}function yr(a,o,l){var d=o[0],p=o[1],_=o[2],b=l[3]*d+l[7]*p+l[11]*_+l[15];return a[0]=(l[0]*d+l[4]*p+l[8]*_+l[12])/(b=b||1),a[1]=(l[1]*d+l[5]*p+l[9]*_+l[13])/b,a[2]=(l[2]*d+l[6]*p+l[10]*_+l[14])/b,a}function dx(a,o,l){var d=l[0],p=l[1],_=l[2],b=o[0],w=o[1],T=o[2],I=p*T-_*w,k=_*b-d*T,F=d*w-p*b,N=p*F-_*k,V=_*I-d*F,U=d*k-p*I,G=2*l[3];return k*=G,F*=G,V*=2,U*=2,a[0]=b+(I*=G)+(N*=2),a[1]=w+k+V,a[2]=T+F+U,a}var df,Ic=Ty,hx=xT,BO=Ap;function fx(a,o,l){return a[0]=o[0]*l,a[1]=o[1]*l,a[2]=o[2]*l,a[3]=o[3]*l,a}function px(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],b=l*l+d*d+p*p+_*_;return b>0&&(b=1/Math.sqrt(b)),a[0]=l*b,a[1]=d*b,a[2]=p*b,a[3]=_*b,a}function yu(a,o,l){var d=o[0],p=o[1],_=o[2],b=o[3];return a[0]=l[0]*d+l[4]*p+l[8]*_+l[12]*b,a[1]=l[1]*d+l[5]*p+l[9]*_+l[13]*b,a[2]=l[2]*d+l[6]*p+l[10]*_+l[14]*b,a[3]=l[3]*d+l[7]*p+l[11]*_+l[15]*b,a}function wT(){var a=new ha(4);return ha!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function ET(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function yg(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],b=o[3],w=Math.sin(l),T=Math.cos(l);return a[0]=d*T+b*w,a[1]=p*T+_*w,a[2]=_*T-p*w,a[3]=b*T-d*w,a}function CT(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],b=o[3],w=Math.sin(l),T=Math.cos(l);return a[0]=d*T-_*w,a[1]=p*T+b*w,a[2]=_*T+d*w,a[3]=b*T-p*w,a}_g(),df=new ha(4),ha!=Float32Array&&(df[0]=0,df[1]=0,df[2]=0,df[3]=0);var zO=px;_g(),Gl(1,0,0),Gl(0,1,0),wT(),wT(),lx();const VO=Kt([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:TT}=VO,IT=Kt([{name:"a_pos_3",components:3,type:"Int16"}]);var Rp=Kt([{name:"a_pos",type:"Int16",components:2}]);class vg{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,d){const p=ul(l,this.dir);if(Math.abs(p)<1e-6)return!1;const _=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/p;return d[0]=this.pos[0]+this.dir[0]*_,d[1]=this.pos[1]+this.dir[1]*_,d[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(o,l,d){if(G=(V=this.pos)[0],Q=V[1],ae=V[2],ge=(U=o)[0],se=U[1],he=U[2],Math.abs(G-ge)<=pg*Math.max(1,Math.abs(G),Math.abs(ge))&&Math.abs(Q-se)<=pg*Math.max(1,Math.abs(Q),Math.abs(se))&&Math.abs(ae-he)<=pg*Math.max(1,Math.abs(ae),Math.abs(he))||0===l)return d[0]=d[1]=d[2]=0,!1;var V,U,G,Q,ae,ge,se,he;const[p,_,b]=this.dir,w=this.pos[0]-o[0],T=this.pos[1]-o[1],I=this.pos[2]-o[2],k=p*p+_*_+b*b,F=2*(w*p+T*_+I*b),N=F*F-4*k*(w*w+T*T+I*I-l*l);if(N<0){const V=Math.max(-F/2,0),U=w+p*V,G=T+_*V,Q=I+b*V,ae=Math.hypot(U,G,Q);return d[0]=U*l/ae,d[1]=G*l/ae,d[2]=Q*l/ae,!1}{const V=(-F-Math.sqrt(N))/(2*k);if(V<0){const U=Math.hypot(w,T,I);return d[0]=w*l/U,d[1]=T*l/U,d[2]=I*l/U,!1}return d[0]=w+p*V,d[1]=T+_*V,d[2]=I+b*V,!0}}}class Pp{constructor(o,l,d,p,_){this.TL=o,this.TR=l,this.BR=d,this.BL=p,this.horizon=_}static fromInvProjectionMatrix(o,l,d){const p=[-1,1,1],_=[1,1,1],b=[1,-1,1],w=[-1,-1,1],T=yr(p,p,o),I=yr(_,_,o),k=yr(b,b,o),F=yr(w,w,o);return new Pp(T,I,k,F,l/d)}}class bg{constructor(o,l){this.points=o,this.planes=l}static fromInvProjectionMatrix(o,l,d,p){const _=Math.pow(2,d),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const I=yu([],T,o),k=1/I[3]/l*_;return(F=I)[0]=(N=I)[0]*(V=[k,k,p?1/I[3]:k,k])[0],F[1]=N[1]*V[1],F[2]=N[2]*V[2],F[3]=N[3]*V[3],F;var F,N,V}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const I=Ds([],uf([],Ic([],b[T[0]],b[T[1]]),Ic([],b[T[2]],b[T[1]]))),k=-ul(I,b[T[1]]);return I.concat(k)});return new bg(b,w)}}class es{static fromPoints(o){const l=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(const p of o)cf(l,l,p),Mp(d,d,p);return new es(l,d)}static applyTransform(o,l){const d=o.getCorners();for(let p=0;p<d.length;++p)yr(d[p],d[p],l);return es.fromPoints(d)}constructor(o,l){this.min=o,this.max=l,this.center=cl([],Aa([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],d=ux(this.min),p=ux(this.max);for(let _=0;_<l.length;_++)d[_]=l[_]?this.min[_]:this.center[_],p[_]=l[_]?this.center[_]:this.max[_];return p[2]=this.max[2],new es(d,p)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){const l=this.getCorners();let d=!0;for(let p=0;p<o.planes.length;p++){const _=o.planes[p];let b=0;for(let w=0;w<l.length;w++)b+=ul(_,l[w])+_[3]>=0;if(0===b)return 0;b!==l.length&&(d=!1)}if(d)return 2;for(let p=0;p<3;p++){let _=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let w=0;w<o.points.length;w++){const T=o.points[w][p]-this.min[p];_=Math.min(_,T),b=Math.max(b,T)}if(b<0||_>this.max[p]-this.min[p])return 0}return 1}}const Wl=gn/Math.PI/2,Op=[64,32,16],dl=-Wl,hl=Wl,mx=[new es([dl,dl,dl],[hl,hl,hl]),new es([dl,dl,dl],[0,0,hl]),new es([0,dl,dl],[hl,0,hl]),new es([dl,0,dl],[0,hl,hl]),new es([0,0,dl],[hl,hl,hl])];function hf(a){return a*Wl/Bp}function gx(a,o,l,d=!0){const p=cl([],a._camera.position,a.worldSize),_=[o,l,1,1];yu(_,_,a.pixelMatrixInverse),fx(_,_,1/_[3]);const b=Ds([],Ic([],_,p)),w=a.globeMatrix,T=[w[12],w[13],w[14]],I=Ic([],T,p),k=Ap(I),F=Ds([],I),N=a.worldSize/(2*Math.PI),V=ul(F,b),U=Math.asin(N/k);if(U<Math.acos(V)){if(!d)return null;const dt=[],je=[];cl(dt,b,k/V),Ds(je,Ic(je,dt,I)),Ds(b,Aa(b,I,cl(b,je,Math.tan(U)*k)))}const G=[];new vg(p,b).closestPointOnSphere(T,N,G);const Q=Ds([],ar(w,0)),ae=Ds([],ar(w,1)),ge=Ds([],ar(w,2)),se=ul(Q,G),he=ul(ae,G),ve=ul(ge,G),me=yn(Math.asin(-he/N));let Be=yn(Math.atan2(se,ve));Be=a.center.lng+function(dt,je){const Xe=(je-dt+180)%360-180;return Xe<-180?Xe+360:Xe}(a.center.lng,Be);const Fe=fl(Be),Ze=_n(pl(me),0,1);return new _f(Fe,Ze)}class DT{constructor(o,l,d){this.a=Ic([],o,d),this.b=Ic([],l,d),this.center=d;const p=Ds([],this.a),_=Ds([],this.b);this.angle=Math.acos(ul(p,_))}}function Iy(a,o){if(0===a.angle)return null;let l;return l=0===a.a[o]?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[o]/a.a[o]/Math.sin(a.angle)-1/Math.tan(a.angle)),l<0||l>1?null:function(d,p,_,b){const w=Math.sin(_);return d*(Math.sin((1-b)*_)/w)+p*(Math.sin(b*_)/w)}(a.a[o],a.b[o],a.angle,_n(l,0,1))+a.center[o]}function ql(a){if(a.z<=1)return mx[a.z+2*a.y+a.x];const o=Lp(Fp(a));return es.fromPoints(o)}function th(a,o,l){return cl(a,a,1-l),kp(a,a,o,l)}function _x(a,o){const l=mf(o.zoom);if(0===l)return ql(a);const d=Fp(a),p=Lp(d),_=fl(d.getWest())*o.worldSize,b=fl(d.getEast())*o.worldSize,w=pl(d.getNorth())*o.worldSize,T=pl(d.getSouth())*o.worldSize,I=[_,w,0],k=[b,w,0],F=[_,T,0],N=[b,T,0],V=af([],o.globeMatrix);return yr(I,I,V),yr(k,k,V),yr(F,F,V),yr(N,N,V),p[0]=th(p[0],F,l),p[1]=th(p[1],N,l),p[2]=th(p[2],k,l),p[3]=th(p[3],I,l),es.fromPoints(p)}function Ws(a,o,l){for(const d of a)yr(d,d,o),cl(d,d,l)}function Fp({x:a,y:o,z:l}){const d=1/(1<<l),p=new li(Bo(a*d),co((o+1)*d)),_=new li(Bo((a+1)*d),co(o*d));return new ud(p,_)}function Lp(a){const o=vt(a.getNorth()),l=vt(a.getSouth()),d=Math.cos(o),p=Math.cos(l),_=Math.sin(o),b=Math.sin(l),w=a.getWest(),T=a.getEast();return[Yr(p,b,w),Yr(p,b,T),Yr(d,_,T),Yr(d,_,w)]}function Yr(a,o,l,d=Wl){return l=vt(l),[a*Math.sin(l)*d,-o*d,a*Math.cos(l)*d]}function Dc(a,o,l){return Yr(Math.cos(vt(a)),Math.sin(vt(a)),o,l)}function ff(a,o,l,d){const p=1<<l.z,_=(a/gn+l.x)/p;return Dc(co((o/gn+l.y)/p),Bo(_),d)}function Np({min:a,max:o}){return 16383/Math.max(o[0]-a[0],o[1]-a[1],o[2]-a[2])}const yx=new Float64Array(16);function pf(a){const o=Np(a),l=Cy(yx,[o,o,o]);return or(l,l,((d=[])[0]=-(p=a.min)[0],d[1]=-p[1],d[2]=-p[2],d));var d,p}function Sy(a){const o=(d=a.min,(l=yx)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=d[0],l[13]=d[1],l[14]=d[2],l[15]=1,l);var l,d;const p=1/Np(a);return dd(o,o,[p,p,p])}function Ay(a,o,l,d,p){const _=function(T){const I=gn/(2*Math.PI);return T/(2*Math.PI)/I}(l),b=[a,o,-l/(2*Math.PI)],w=Sa(new Float64Array(16));return or(w,w,b),dd(w,w,[_,_,_]),Hl(w,w,vt(-p)),mg(w,w,vt(-d)),w}function mf(a){return wr(5,6,a)}function My(a,o){const l=Dc(o.lat,o.lng);return b=(p=Ty([],function(U){const G=Dc(U._center.lat,U._center.lng);let Q=uf([],Gl(0,1,0),G);const ae=lf([],-U.angle,G);Q=yr(Q,Q,ae),lf(ae,-U._pitch,Q);const ge=Ds([],G);return cl(ge,ge,hf(U.cameraToCenterDistance/U.pixelsPerMeter)),yr(ge,ge,ae),Aa([],G,ge)}(a),l))[0],w=p[1],T=p[2],I=(_=l)[0],k=_[1],F=_[2],V=(N=Math.sqrt(b*b+w*w+T*T)*Math.sqrt(I*I+k*k+F*F))&&ul(p,_)/N,Math.acos(Math.min(Math.max(V,-1),1));var p,_,b,w,T,I,k,F,N,V}function ky(a,o){return My(a,o)>Math.PI/2*1.01}const vx=vt(85),Ry=Math.cos(vx),Py=Math.sin(vx),Bp=6371008.8,gf=2*Math.PI*Bp;class li{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new li(Lr(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,d=this.lat*l,p=o.lat*l,_=Math.sin(d)*Math.sin(p)+Math.cos(d)*Math.cos(p)*Math.cos((o.lng-this.lng)*l);return Bp*Math.acos(Math.min(_,1))}toBounds(o=0){const l=360*o/40075017,d=l/Math.cos(Math.PI/180*this.lat);return new ud(new li(this.lng-d,this.lat-l),new li(this.lng+d,this.lat+l))}toEcef(o){const l=hf(o);return Dc(this.lat,this.lng,Wl+l)}static convert(o){if(o instanceof li)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new li(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new li(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Oy(a){return gf*Math.cos(a*Math.PI/180)}function fl(a){return(180+a)/360}function pl(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function ml(a,o){return a/Oy(o)}function Bo(a){return 360*a-180}function co(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Fy(a,o){return a*Oy(co(o))}const zo=85.051129;function xg(a){return 1/Math.cos(a*Math.PI/180)}class _f{constructor(o,l,d=0){this.x=+o,this.y=+l,this.z=+d}static fromLngLat(o,l=0){const d=li.convert(o);return new _f(fl(d.lng),pl(d.lat),ml(l,d.lat))}toLngLat(){return new li(Bo(this.x),co(this.y))}toAltitude(){return Fy(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/gf*xg(co(this.y))}}function Ly(a,o,l,d,p,_,b,w,T){const I=(o+d)/2,k=(l+p)/2,F=new st(I,k);w(F),function(N,V,U,G,Q,ae){const ge=U-Q,se=G-ae;return Math.abs((G-V)*ge-(U-N)*se)/Math.hypot(ge,se)}(F.x,F.y,_.x,_.y,b.x,b.y)>=T?(Ly(a,o,l,I,k,_,F,w,T),Ly(a,I,k,d,p,F,b,w,T)):a.push(b)}function bx(a,o,l){let d=a[0],p=d.x,_=d.y;o(d);const b=[d];for(let w=1;w<a.length;w++){const T=a[w],{x:I,y:k}=T;o(T),Ly(b,p,_,I,k,d,T,o,l),p=I,_=k,d=T}return b}function Ny(a,o,l,d){if(d(o,l)){const p=o.add(l)._mult(.5);Ny(a,o,p,d),Ny(a,p,l,d)}else a.push(l)}function ST(a,o){let l=a[0];const d=[l];for(let p=1;p<a.length;p++){const _=a[p];Ny(d,l,_,o),l=_}return d}const By=Math.pow(2,14)-1,zy=-By-1;function Vy(a,o){const l=Math.round(a.x*o),d=Math.round(a.y*o);return a.x=_n(l,zy,By),a.y=_n(d,zy,By),(l<a.x||l>a.x+1||d<a.y||d>a.y+1)&&ni("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Sc(a,o,l){const d=a.loadGeometry(),p=a.extent,_=gn/p;if(o&&l&&l.projection.isReprojectedInTileSpace){const b=1<<o.z,{scale:w,x:T,y:I,projection:k}=l,F=N=>{const V=Bo((o.x+N.x/p)/b),U=co((o.y+N.y/p)/b),G=k.project(V,U);N.x=(G.x*w-T)*p,N.y=(G.y*w-I)*p};for(let N=0;N<d.length;N++)if(1!==a.type)d[N]=bx(d[N],F,1);else{const V=[];for(const U of d[N])U.x<0||U.x>=p||U.y<0||U.y>=p||(F(U),V.push(U));d[N]=V}}for(const b of d)for(const w of b)Vy(w,_);return d}function vu(a,o){return{type:a.type,id:a.id,properties:a.properties,geometry:o?Sc(a):[]}}function wg(a,o,l,d,p){a.emplaceBack(2*o+(d+1)/2,2*l+(p+1)/2)}function Eg(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class Cg{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Jt,this.indexArray=new ao,this.segments=new Cr,this.programConfigurations=new Cc(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,d,p){const _=this.layers[0],b=[];let w=null;"circle"===_.type&&(w=_.layout.get("circle-sort-key"));for(const{feature:I,id:k,index:F,sourceLayerIndex:N}of o){const V=this.layers[0]._featureFilter.needGeometry,U=vu(I,V);if(!this.layers[0]._featureFilter.filter(new Ae(this.zoom),U,d))continue;const G=w?w.evaluate(U,{},d):void 0,Q={id:k,properties:I.properties,type:I.type,sourceLayerIndex:N,index:F,geometry:V?U.geometry:Sc(I,d,p),patterns:{},sortKey:G};b.push(Q)}w&&b.sort((I,k)=>I.sortKey-k.sortKey);let T=null;"globe"===p.projection.name&&(this.globeExtVertexArray=new rl,T=p.projection);for(const I of b){const{geometry:k,index:F,sourceLayerIndex:N}=I,V=o[F].feature;this.addFeature(I,k,F,l.availableImages,d,T),l.featureIndex.insert(V,k,F,N,this.index)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,sf.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,NO.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,d,p,_,b){for(const w of l)for(const T of w){const I=T.x,k=T.y;if(I<0||I>=gn||k<0||k>=gn)continue;if(b){const V=b.projectTilePoint(I,k,_),U=b.upVector(_,I,k),G=this.globeExtVertexArray;Eg(G,V,U),Eg(G,V,U),Eg(G,V,U),Eg(G,V,U)}const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),N=F.vertexLength;wg(this.layoutVertexArray,I,k,-1,-1),wg(this.layoutVertexArray,I,k,1,-1),wg(this.layoutVertexArray,I,k,1,1),wg(this.layoutVertexArray,I,k,-1,1),this.indexArray.emplaceBack(N,N+1,N+2),this.indexArray.emplaceBack(N,N+2,N+3),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,{},p,_)}}function Uy(a,o){for(let l=0;l<a.length;l++)if(hd(o,a[l]))return!0;for(let l=0;l<o.length;l++)if(hd(a,o[l]))return!0;return!!$y(a,o)}function nh(a,o,l){return!!hd(a,o)||!!yf(o,a,l)}function jy(a,o){if(1===a.length)return Hy(o,a[0]);for(let l=0;l<o.length;l++){const d=o[l];for(let p=0;p<d.length;p++)if(hd(a,d[p]))return!0}for(let l=0;l<a.length;l++)if(Hy(o,a[l]))return!0;for(let l=0;l<o.length;l++)if($y(a,o[l]))return!0;return!1}function xx(a,o,l){if(a.length>1){if($y(a,o))return!0;for(let d=0;d<o.length;d++)if(yf(o[d],a,l))return!0}for(let d=0;d<a.length;d++)if(yf(a[d],o,l))return!0;return!1}function $y(a,o){if(0===a.length||0===o.length)return!1;for(let l=0;l<a.length-1;l++){const d=a[l],p=a[l+1];for(let _=0;_<o.length-1;_++)if(UO(d,p,o[_],o[_+1]))return!0}return!1}function UO(a,o,l,d){return hs(a,l,d)!==hs(o,l,d)&&hs(a,o,l)!==hs(a,o,d)}function yf(a,o,l){const d=l*l;if(1===o.length)return a.distSqr(o[0])<d;for(let p=1;p<o.length;p++)if(wx(a,o[p-1],o[p])<d)return!0;return!1}function wx(a,o,l){const d=o.distSqr(l);if(0===d)return a.distSqr(o);const p=((a.x-o.x)*(l.x-o.x)+(a.y-o.y)*(l.y-o.y))/d;return a.distSqr(p<0?o:p>1?l:l.sub(o)._mult(p)._add(o))}function Hy(a,o){let l,d,p,_=!1;for(let b=0;b<a.length;b++){l=a[b];for(let w=0,T=l.length-1;w<l.length;T=w++)d=l[w],p=l[T],d.y>o.y!=p.y>o.y&&o.x<(p.x-d.x)*(o.y-d.y)/(p.y-d.y)+d.x&&(_=!_)}return _}function hd(a,o){let l=!1;for(let d=0,p=a.length-1;d<a.length;p=d++){const _=a[d],b=a[p];_.y>o.y!=b.y>o.y&&o.x<(b.x-_.x)*(o.y-_.y)/(b.y-_.y)+_.x&&(l=!l)}return l}function Gy(a,o,l,d,p){for(const b of a)if(o<=b.x&&l<=b.y&&d>=b.x&&p>=b.y)return!0;const _=[new st(o,l),new st(o,p),new st(d,p),new st(d,l)];if(a.length>2)for(const b of _)if(hd(a,b))return!0;for(let b=0;b<a.length-1;b++)if(Wy(a[b],a[b+1],_))return!0;return!1}function Wy(a,o,l){const d=l[0],p=l[2];if(a.x<d.x&&o.x<d.x||a.x>p.x&&o.x>p.x||a.y<d.y&&o.y<d.y||a.y>p.y&&o.y>p.y)return!1;const _=hs(a,o,l[0]);return _!==hs(a,o,l[1])||_!==hs(a,o,l[2])||_!==hs(a,o,l[3])}function ih(a,o,l){const d=o.paint.get(a).value;return"constant"===d.kind?d.value:l.programConfigurations.get(o.id).getMaxValue(a)}function rh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function zp(a,o,l,d,p){if(!o[0]&&!o[1])return a;const _=st.convert(o)._mult(p);"viewport"===l&&_._rotate(-d);const b=[];for(let w=0;w<a.length;w++)b.push(a[w].sub(_));return b}function qy(a,o,l,d){const p=st.convert(a)._mult(d);return"viewport"===o&&p._rotate(-l),p}Nt(Cg,"CircleBucket",{omit:["layers"]});const Zy=new ft({"circle-sort-key":new He(Ye.layout_circle["circle-sort-key"])});var Yy={paint:new ft({"circle-radius":new He(Ye.paint_circle["circle-radius"]),"circle-color":new He(Ye.paint_circle["circle-color"]),"circle-blur":new He(Ye.paint_circle["circle-blur"]),"circle-opacity":new He(Ye.paint_circle["circle-opacity"]),"circle-translate":new Se(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Se(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Se(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Se(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new He(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new He(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new He(Ye.paint_circle["circle-stroke-opacity"])}),layout:Zy};function Tg(a,o,l,d,p,_,b,w,T){if(_&&a.queryGeometry.isAboveHorizon)return!1;_&&(T*=a.pixelToTileUnitsFactor);const I=a.tileID.canonical,k=l.projection.upVectorScale(I,l.center.lat,l.worldSize).metersToTile;for(const F of o)for(const N of F){const V=N.add(w),U=p&&l.elevation?l.elevation.exaggeration()*p.getElevationAt(V.x,V.y,!0):0,G=l.projection.projectTilePoint(V.x,V.y,I);if(U>0){const se=l.projection.upVector(I,V.x,V.y);G.x+=se[0]*k*U,G.y+=se[1]*k*U,G.z+=se[2]*k*U}const Q=_?V:Vp(G.x,G.y,G.z,d),ae=_?a.tilespaceRays.map(se=>AT(se,U)):a.queryGeometry.screenGeometry,ge=yu([],[G.x,G.y,G.z,1],d);if(!b&&_?T*=ge[3]/l.cameraToCenterDistance:b&&!_&&(T*=l.cameraToCenterDistance/ge[3]),_){const se=co((N.y/gn+I.y)/(1<<I.z));T/=l.projection.pixelsPerMeter(se,1)/ml(1,se)}if(nh(ae,Q,T))return!0}return!1}function Vp(a,o,l,d){const p=yu([],[a,o,l,1],d);return new st(p[0]/p[3],p[1]/p[3])}const Ex=Gl(0,0,0),Cx=Gl(0,0,1);function AT(a,o){const l=_g();return Ex[2]=o,a.intersectsPlane(Ex,Cx,l),new st(l[0],l[1])}class Tx extends Cg{}function Ix(a,{width:o,height:l},d,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==o*l*d)throw new RangeError("mismatched image size")}else p=new Uint8Array(o*l*d);return a.width=o,a.height=l,a.data=p,a}function Ky(a,o,l){const{width:d,height:p}=o;d===a.width&&p===a.height||(Ig(a,o,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,d),height:Math.min(a.height,p)},l),a.width=d,a.height=p,a.data=o.data)}function Ig(a,o,l,d,p,_){if(0===p.width||0===p.height)return o;if(p.width>a.width||p.height>a.height||l.x>a.width-p.width||l.y>a.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>o.width||p.height>o.height||d.x>o.width-p.width||d.y>o.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=a.data,w=o.data;for(let T=0;T<p.height;T++){const I=((l.y+T)*a.width+l.x)*_,k=((d.y+T)*o.width+d.x)*_;for(let F=0;F<p.width*_;F++)w[k+F]=b[I+F]}return o}Nt(Tx,"HeatmapBucket",{omit:["layers"]});class gl{constructor(o,l){Ix(this,o,1,l)}resize(o){Ky(this,new gl(o),1)}clone(){return new gl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,_){Ig(o,l,d,p,_,1)}}class Ss{constructor(o,l){Ix(this,o,4,l)}resize(o){Ky(this,new Ss(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,d,p,_){Ig(o,l,d,p,_,4)}}Nt(gl,"AlphaImage"),Nt(Ss,"RGBAImage");var vf={paint:new ft({"heatmap-radius":new He(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new He(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Se(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ct(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Se(Ye.paint_heatmap["heatmap-opacity"])})};function Xy(a){const o={},l=a.resolution||256,d=a.clips?a.clips.length:1,p=a.image||new Ss({width:l,height:d}),_=(b,w,T)=>{o[a.evaluationKey]=T;const I=a.expression.evaluate(o);p.data[b+w+0]=Math.floor(255*I.r/I.a),p.data[b+w+1]=Math.floor(255*I.g/I.a),p.data[b+w+2]=Math.floor(255*I.b/I.a),p.data[b+w+3]=Math.floor(255*I.a)};if(a.clips)for(let b=0,w=0;b<d;++b,w+=4*l)for(let T=0,I=0;T<l;T++,I+=4){const k=T/(l-1),{start:F,end:N}=a.clips[b];_(w,I,F*(1-k)+N*k)}else for(let b=0,w=0;b<l;b++,w+=4)_(0,w,b/(l-1));return p}var MT={paint:new ft({"hillshade-illumination-direction":new Se(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Se(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Se(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Se(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Se(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Se(Ye.paint_hillshade["hillshade-accent-color"])})};const jO=Kt([{name:"a_pos",components:2,type:"Int16"}],4),{members:kT}=jO;var fd={};function Dg(a,o,l){l=l||2;var d,p,_,b,w,T,I,k=o&&o.length,F=k?o[0]*l:a.length,N=Qy(a,0,F,l,!0),V=[];if(!N||N.next===N.prev)return V;if(k&&(N=function(G,Q,ae,ge){var se,he,ve,me=[];for(se=0,he=Q.length;se<he;se++)(ve=Qy(G,Q[se]*ge,se<he-1?Q[se+1]*ge:G.length,ge,!1))===ve.next&&(ve.steiner=!0),me.push(FT(ve));for(me.sort(RT),se=0;se<me.length;se++)ae=PT(me[se],ae);return ae}(a,o,N,l)),a.length>80*l){d=_=a[0],p=b=a[1];for(var U=l;U<F;U+=l)(w=a[U])<d&&(d=w),(T=a[U+1])<p&&(p=T),w>_&&(_=w),T>b&&(b=T);I=0!==(I=Math.max(_-d,b-p))?32767/I:0}return oh(N,V,l,d,p,I,0),V}function Qy(a,o,l,d,p){var _,b;if(p===nv(a,o,l,d)>0)for(_=o;_<l;_+=d)b=kx(_,a[_],a[_+1],b);else for(_=l-d;_>=o;_-=d)b=kx(_,a[_],a[_+1],b);return b&&Sg(b,b.next)&&(jp(b),b=b.next),b}function Ac(a,o){if(!a)return a;o||(o=a);var l,d=a;do{if(l=!1,d.steiner||!Sg(d,d.next)&&0!==Pr(d.prev,d,d.next))d=d.next;else{if(jp(d),(d=o=d.prev)===d.next)break;l=!0}}while(l||d!==o);return o}function oh(a,o,l,d,p,_,b){if(a){!b&&_&&function(k,F,N,V){var U=k;do{0===U.z&&(U.z=Jy(U.x,U.y,F,N,V)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next}while(U!==k);U.prevZ.nextZ=null,U.prevZ=null,function(G){var Q,ae,ge,se,he,ve,me,Be,Fe=1;do{for(ae=G,G=null,he=null,ve=0;ae;){for(ve++,ge=ae,me=0,Q=0;Q<Fe&&(me++,ge=ge.nextZ);Q++);for(Be=Fe;me>0||Be>0&&ge;)0!==me&&(0===Be||!ge||ae.z<=ge.z)?(se=ae,ae=ae.nextZ,me--):(se=ge,ge=ge.nextZ,Be--),he?he.nextZ=se:G=se,se.prevZ=he,he=se;ae=ge}he.nextZ=null,Fe*=2}while(ve>1)}(U)}(a,d,p,_);for(var w,T,I=a;a.prev!==a.next;)if(w=a.prev,T=a.next,_?Sx(a,d,p,_):Dx(a))o.push(w.i/l|0),o.push(a.i/l|0),o.push(T.i/l|0),jp(a),a=T.next,I=T.next;else if((a=T)===I){b?1===b?oh(a=Ax(Ac(a),o,l),o,l,d,p,_,2):2===b&&sh(a,o,l,d,p,_):oh(Ac(a),o,l,d,p,_,1);break}}}function Dx(a){var o=a.prev,l=a,d=a.next;if(Pr(o,l,d)>=0)return!1;for(var p=o.x,_=l.x,b=d.x,w=o.y,T=l.y,I=d.y,k=p<_?p<b?p:b:_<b?_:b,F=w<T?w<I?w:I:T<I?T:I,N=p>_?p>b?p:b:_>b?_:b,V=w>T?w>I?w:I:T>I?T:I,U=d.next;U!==o;){if(U.x>=k&&U.x<=N&&U.y>=F&&U.y<=V&&Vo(p,w,_,T,b,I,U.x,U.y)&&Pr(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function Sx(a,o,l,d){var p=a.prev,_=a,b=a.next;if(Pr(p,_,b)>=0)return!1;for(var w=p.x,T=_.x,I=b.x,k=p.y,F=_.y,N=b.y,V=w<T?w<I?w:I:T<I?T:I,U=k<F?k<N?k:N:F<N?F:N,G=w>T?w>I?w:I:T>I?T:I,Q=k>F?k>N?k:N:F>N?F:N,ae=Jy(V,U,o,l,d),ge=Jy(G,Q,o,l,d),se=a.prevZ,he=a.nextZ;se&&se.z>=ae&&he&&he.z<=ge;){if(se.x>=V&&se.x<=G&&se.y>=U&&se.y<=Q&&se!==p&&se!==b&&Vo(w,k,T,F,I,N,se.x,se.y)&&Pr(se.prev,se,se.next)>=0||(se=se.prevZ,he.x>=V&&he.x<=G&&he.y>=U&&he.y<=Q&&he!==p&&he!==b&&Vo(w,k,T,F,I,N,he.x,he.y)&&Pr(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;se&&se.z>=ae;){if(se.x>=V&&se.x<=G&&se.y>=U&&se.y<=Q&&se!==p&&se!==b&&Vo(w,k,T,F,I,N,se.x,se.y)&&Pr(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;he&&he.z<=ge;){if(he.x>=V&&he.x<=G&&he.y>=U&&he.y<=Q&&he!==p&&he!==b&&Vo(w,k,T,F,I,N,he.x,he.y)&&Pr(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function Ax(a,o,l){var d=a;do{var p=d.prev,_=d.next.next;!Sg(p,_)&&Mx(p,d,d.next,_)&&Up(p,_)&&Up(_,p)&&(o.push(p.i/l|0),o.push(d.i/l|0),o.push(_.i/l|0),jp(d),jp(d.next),d=a=_),d=d.next}while(d!==a);return Ac(d)}function sh(a,o,l,d,p,_){var b=a;do{for(var w=b.next.next;w!==b.prev;){if(b.i!==w.i&&Mc(b,w)){var T=ev(b,w);return b=Ac(b,b.next),T=Ac(T,T.next),oh(b,o,l,d,p,_,0),void oh(T,o,l,d,p,_,0)}w=w.next}b=b.next}while(b!==a)}function RT(a,o){return a.x-o.x}function PT(a,o){var l=function(p,_){var b,w=_,T=p.x,I=p.y,k=-1/0;do{if(I<=w.y&&I>=w.next.y&&w.next.y!==w.y){var F=w.x+(I-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(F<=T&&F>k&&(k=F,b=w.x<w.next.x?w:w.next,F===T))return b}w=w.next}while(w!==_);if(!b)return null;var N,V=b,U=b.x,G=b.y,Q=1/0;w=b;do{T>=w.x&&w.x>=U&&T!==w.x&&Vo(I<G?T:k,I,U,G,I<G?k:T,I,w.x,w.y)&&(N=Math.abs(I-w.y)/(T-w.x),Up(w,p)&&(N<Q||N===Q&&(w.x>b.x||w.x===b.x&&OT(b,w)))&&(b=w,Q=N)),w=w.next}while(w!==V);return b}(a,o);if(!l)return o;var d=ev(l,a);return Ac(d,d.next),Ac(l,l.next)}function OT(a,o){return Pr(a.prev,a,o.prev)<0&&Pr(o.next,a,a.next)<0}function Jy(a,o,l,d,p){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-l)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-d)*p|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function FT(a){var o=a,l=a;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==a);return l}function Vo(a,o,l,d,p,_,b,w){return(p-b)*(o-w)>=(a-b)*(_-w)&&(a-b)*(d-w)>=(l-b)*(o-w)&&(l-b)*(_-w)>=(p-b)*(d-w)}function Mc(a,o){return a.next.i!==o.i&&a.prev.i!==o.i&&!function(l,d){var p=l;do{if(p.i!==l.i&&p.next.i!==l.i&&p.i!==d.i&&p.next.i!==d.i&&Mx(p,p.next,l,d))return!0;p=p.next}while(p!==l);return!1}(a,o)&&(Up(a,o)&&Up(o,a)&&function(l,d){var p=l,_=!1,b=(l.x+d.x)/2,w=(l.y+d.y)/2;do{p.y>w!=p.next.y>w&&p.next.y!==p.y&&b<(p.next.x-p.x)*(w-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next}while(p!==l);return _}(a,o)&&(Pr(a.prev,a,o.prev)||Pr(a,o.prev,o))||Sg(a,o)&&Pr(a.prev,a,a.next)>0&&Pr(o.prev,o,o.next)>0)}function Pr(a,o,l){return(o.y-a.y)*(l.x-o.x)-(o.x-a.x)*(l.y-o.y)}function Sg(a,o){return a.x===o.x&&a.y===o.y}function Mx(a,o,l,d){var p=Mg(Pr(a,o,l)),_=Mg(Pr(a,o,d)),b=Mg(Pr(l,d,a)),w=Mg(Pr(l,d,o));return p!==_&&b!==w||!(0!==p||!Ag(a,l,o))||!(0!==_||!Ag(a,d,o))||!(0!==b||!Ag(l,a,d))||!(0!==w||!Ag(l,o,d))}function Ag(a,o,l){return o.x<=Math.max(a.x,l.x)&&o.x>=Math.min(a.x,l.x)&&o.y<=Math.max(a.y,l.y)&&o.y>=Math.min(a.y,l.y)}function Mg(a){return a>0?1:a<0?-1:0}function Up(a,o){return Pr(a.prev,a,a.next)<0?Pr(a,o,a.next)>=0&&Pr(a,a.prev,o)>=0:Pr(a,o,a.prev)<0||Pr(a,a.next,o)<0}function ev(a,o){var l=new tv(a.i,a.x,a.y),d=new tv(o.i,o.x,o.y),p=a.next,_=o.prev;return a.next=o,o.prev=a,l.next=p,p.prev=l,d.next=l,l.prev=d,_.next=d,d.prev=_,d}function kx(a,o,l,d){var p=new tv(a,o,l);return d?(p.next=d.next,p.prev=d,d.next.prev=p,d.next=p):(p.prev=p,p.next=p),p}function jp(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function tv(a,o,l){this.i=a,this.x=o,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nv(a,o,l,d){for(var p=0,_=o,b=l-d;_<l;_+=d)p+=(a[b]-a[_])*(a[_+1]+a[b+1]),b=_;return p}function kg(a,o,l,d,p){kc(a,o,l||0,d||a.length-1,p||Rx)}function kc(a,o,l,d,p){for(;d>l;){if(d-l>600){var _=d-l+1,b=o-l+1,w=Math.log(_),T=.5*Math.exp(2*w/3),I=.5*Math.sqrt(w*T*(_-T)/_)*(b-_/2<0?-1:1);kc(a,o,Math.max(l,Math.floor(o-b*T/_+I)),Math.min(d,Math.floor(o+(_-b)*T/_+I)),p)}var k=a[o],F=l,N=d;for(bu(a,l,o),p(a[d],k)>0&&bu(a,l,d);F<N;){for(bu(a,F,N),F++,N--;p(a[F],k)<0;)F++;for(;p(a[N],k)>0;)N--}0===p(a[l],k)?bu(a,l,N):bu(a,++N,d),N<=o&&(l=N+1),o<=N&&(d=N-1)}}function bu(a,o,l){var d=a[o];a[o]=a[l],a[l]=d}function Rx(a,o){return a<o?-1:a>o?1:0}function Rg(a,o){const l=a.length;if(l<=1)return[a];const d=[];let p,_;for(let b=0;b<l;b++){const w=Xn(a[b]);0!==w&&(a[b].area=Math.abs(w),void 0===_&&(_=w<0),_===w<0?(p&&d.push(p),p=[a[b]]):p.push(a[b]))}if(p&&d.push(p),o>1)for(let b=0;b<d.length;b++)d[b].length<=o||(kg(d[b],o,1,d[b].length-1,Px),d[b]=d[b].slice(0,o));return d}function Px(a,o){return o.area-a.area}function Ox(a,o,l){const d=l.patternDependencies;let p=!1;for(const _ of o){const b=_.paint.get(`${a}-pattern`);b.isConstant()||(p=!0);const w=b.constantOr(null);w&&(p=!0,d[w]=!0)}return p}function Fx(a,o,l,d,p){const _=p.patternDependencies;for(const b of o){const w=b.paint.get(`${a}-pattern`).value;if("constant"!==w.kind){let T=w.evaluate({zoom:d},l,{},p.availableImages);T=T&&T.name?T.name:T,_[T]=!0,l.patterns[b.id]=T}}return l}({get exports(){return fd},set exports(a){fd=a}}).exports=Dg,fd.default=Dg,Dg.deviation=function(a,o,l,d){var p=o&&o.length,_=Math.abs(nv(a,0,p?o[0]*l:a.length,l));if(p)for(var b=0,w=o.length;b<w;b++)_-=Math.abs(nv(a,o[b]*l,b<w-1?o[b+1]*l:a.length,l));var T=0;for(b=0;b<d.length;b+=3){var I=d[b]*l,k=d[b+1]*l,F=d[b+2]*l;T+=Math.abs((a[I]-a[F])*(a[k+1]-a[I+1])-(a[I]-a[k])*(a[F+1]-a[I+1]))}return 0===_&&0===T?0:Math.abs((T-_)/_)},Dg.flatten=function(a){for(var o=a[0][0].length,l={vertices:[],holes:[],dimensions:o},d=0,p=0;p<a.length;p++){for(var _=0;_<a[p].length;_++)for(var b=0;b<o;b++)l.vertices.push(a[p][_][b]);p>0&&l.holes.push(d+=a[p-1].length)}return l};class iv{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Jt,this.indexArray=new ao,this.indexArray2=new jl,this.programConfigurations=new Cc(o.layers,o.zoom),this.segments=new Cr,this.segments2=new Cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection}populate(o,l,d,p){this.hasPattern=Ox("fill",this.layers,l);const _=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:w,id:T,index:I,sourceLayerIndex:k}of o){const F=this.layers[0]._featureFilter.needGeometry,N=vu(w,F);if(!this.layers[0]._featureFilter.filter(new Ae(this.zoom),N,d))continue;const V=_?_.evaluate(N,{},d,l.availableImages):void 0,U={id:T,properties:w.properties,type:w.type,sourceLayerIndex:k,index:I,geometry:F?N.geometry:Sc(w,d,p),patterns:{},sortKey:V};b.push(U)}_&&b.sort((w,T)=>w.sortKey-T.sortKey);for(const w of b){const{geometry:T,index:I,sourceLayerIndex:k}=w;if(this.hasPattern){const F=Fx("fill",this.layers,w,this.zoom,l);this.patternFeatures.push(F)}else this.addFeature(w,T,I,d,{},l.availableImages);l.featureIndex.insert(o[I].feature,T,I,k,this.index)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}addFeatures(o,l,d,p,_){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,kT),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,l,d,p,_,b=[]){for(const w of Rg(l,500)){let T=0;for(const U of w)T+=U.length;const I=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),k=I.vertexLength,F=[],N=[];for(const U of w){if(0===U.length)continue;U!==w[0]&&N.push(F.length/2);const G=this.segments2.prepareSegment(U.length,this.layoutVertexArray,this.indexArray2),Q=G.vertexLength;this.layoutVertexArray.emplaceBack(U[0].x,U[0].y),this.indexArray2.emplaceBack(Q+U.length-1,Q),F.push(U[0].x),F.push(U[0].y);for(let ae=1;ae<U.length;ae++)this.layoutVertexArray.emplaceBack(U[ae].x,U[ae].y),this.indexArray2.emplaceBack(Q+ae-1,Q+ae),F.push(U[ae].x),F.push(U[ae].y);G.vertexLength+=U.length,G.primitiveLength+=U.length}const V=fd(F,N);for(let U=0;U<V.length;U+=3)this.indexArray.emplaceBack(k+V[U],k+V[U+1],k+V[U+2]);I.vertexLength+=T,I.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,b,p)}}Nt(iv,"FillBucket",{omit:["layers","patternFeatures"]});const rv=new ft({"fill-sort-key":new He(Ye.layout_fill["fill-sort-key"])});var ov={paint:new ft({"fill-antialias":new Se(Ye.paint_fill["fill-antialias"]),"fill-opacity":new He(Ye.paint_fill["fill-opacity"]),"fill-color":new He(Ye.paint_fill["fill-color"]),"fill-outline-color":new He(Ye.paint_fill["fill-outline-color"]),"fill-translate":new Se(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Se(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new He(Ye.paint_fill["fill-pattern"])}),layout:rv};const $O=Kt([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),HO=Kt([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Lx=Kt([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:LT}=$O;var Pg={},NT=st,Nx=ah;function ah(a,o,l,d,p){this.properties={},this.extent=l,this.type=0,this._pbf=a,this._geometry=-1,this._keys=d,this._values=p,a.readFields(Og,this,o)}function Og(a,o,l){1==a?o.id=l.readVarint():2==a?function(d,p){for(var _=d.readVarint()+d.pos;d.pos<_;){var b=p._keys[d.readVarint()],w=p._values[d.readVarint()];p.properties[b]=w}}(l,o):3==a?o.type=l.readVarint():4==a&&(o._geometry=l.pos)}function Bx(a){for(var o,l,d=0,p=0,_=a.length,b=_-1;p<_;b=p++)d+=((l=a[b]).x-(o=a[p]).x)*(o.y+l.y);return d}ah.types=["Unknown","Point","LineString","Polygon"],ah.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var o,l=a.readVarint()+a.pos,d=1,p=0,_=0,b=0,w=[];a.pos<l;){if(p<=0){var T=a.readVarint();d=7&T,p=T>>3}if(p--,1===d||2===d)_+=a.readSVarint(),b+=a.readSVarint(),1===d&&(o&&w.push(o),o=[]),o.push(new NT(_,b));else{if(7!==d)throw new Error("unknown command "+d);o&&o.push(o[0].clone())}}return o&&w.push(o),w},ah.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var o=a.readVarint()+a.pos,l=1,d=0,p=0,_=0,b=1/0,w=-1/0,T=1/0,I=-1/0;a.pos<o;){if(d<=0){var k=a.readVarint();l=7&k,d=k>>3}if(d--,1===l||2===l)(p+=a.readSVarint())<b&&(b=p),p>w&&(w=p),(_+=a.readSVarint())<T&&(T=_),_>I&&(I=_);else if(7!==l)throw new Error("unknown command "+l)}return[b,T,w,I]},ah.prototype.toGeoJSON=function(a,o,l){var d,p,_=this.extent*Math.pow(2,l),b=this.extent*a,w=this.extent*o,T=this.loadGeometry(),I=ah.types[this.type];function k(V){for(var U=0;U<V.length;U++){var G=V[U];V[U]=[360*(G.x+b)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(d=0;d<T.length;d++)F[d]=T[d][0];k(T=F);break;case 2:for(d=0;d<T.length;d++)k(T[d]);break;case 3:for(T=function(V){var U=V.length;if(U<=1)return[V];for(var G,Q,ae=[],ge=0;ge<U;ge++){var se=Bx(V[ge]);0!==se&&(void 0===Q&&(Q=se<0),Q===se<0?(G&&ae.push(G),G=[V[ge]]):G.push(V[ge]))}return G&&ae.push(G),ae}(T),d=0;d<T.length;d++)for(p=0;p<T[d].length;p++)k(T[d][p])}1===T.length?T=T[0]:I="Multi"+I;var N={type:"Feature",geometry:{type:I,coordinates:T},properties:this.properties};return"id"in this&&(N.id=this.id),N};var sv=Nx,zx=$i;function $i(a,o){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(BT,this,o),this.length=this._features.length}function BT(a,o,l){15===a?o.version=l.readVarint():1===a?o.name=l.readString():5===a?o.extent=l.readVarint():2===a?o._features.push(l.pos):3===a?o._keys.push(l.readString()):4===a&&o._values.push(function(d){for(var p=null,_=d.readVarint()+d.pos;d.pos<_;){var b=d.readVarint()>>3;p=1===b?d.readString():2===b?d.readFloat():3===b?d.readDouble():4===b?d.readVarint64():5===b?d.readVarint():6===b?d.readSVarint():7===b?d.readBoolean():null}return p}(l))}$i.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var o=this._pbf.readVarint()+this._pbf.pos;return new sv(this._pbf,o,this.extent,this._keys,this._values)};var zT=zx;function av(a,o,l){if(3===a){var d=new zT(l,l.readVarint()+l.pos);d.length&&(o[d.name]=d)}}var $p=Pg.VectorTile=function(a,o){this.layers=a.readFields(av,{},o)},Fg=Pg.VectorTileFeature=Nx;function Lg(a,o,l,d){const p=[],_=0===d?(b,w,T,I,k,F)=>{b.push(new st(F,T+(F-w)/(I-w)*(k-T)))}:(b,w,T,I,k,F)=>{b.push(new st(w+(F-T)/(k-T)*(I-w),F))};for(const b of a){const w=[];for(const T of b){if(T.length<=2)continue;const I=[];for(let N=0;N<T.length-1;N++){const V=T[N].x,U=T[N].y,G=T[N+1].x,Q=T[N+1].y,ae=0===d?V:U,ge=0===d?G:Q;ae<o?ge>o&&_(I,V,U,G,Q,o):ae>l?ge<l&&_(I,V,U,G,Q,l):I.push(T[N]),ge<o&&ae>=o&&_(I,V,U,G,Q,o),ge>l&&ae<=l&&_(I,V,U,G,Q,l)}let k=T[T.length-1];const F=0===d?k.x:k.y;F>=o&&F<=l&&I.push(k),I.length&&(k=I[I.length-1],I[0].x===k.x&&I[0].y===k.y||I.push(I[0]),w.push(I))}w.length&&p.push(w)}return p}Pg.VectorTileLayer=zx;const VT=Fg.types,UT=Math.pow(2,13);function bf(a,o,l,d,p,_,b,w){a.emplaceBack((o<<1)+b,(l<<1)+_,(Math.floor(d*UT)<<1)+p,Math.round(w))}function Ng(a,o,l){a.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class jT{constructor(){this.acc=new st(0,0),this.polyCount=[]}startRing(o){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new st(o.x,o.y),this.max=new st(o.x,o.y))}append(o,l){this.currentPolyCount.edges++,this.acc._add(o);const d=this.min,p=this.max;o.x<d.x?d.x=o.x:o.x>p.x&&(p.x=o.x),o.y<d.y?d.y=o.y:o.y>p.y&&(p.y=o.y),((0===o.x||o.x===gn)&&o.x===l.x)!=((0===o.y||o.y===gn)&&o.y===l.y)&&this.processBorderOverlap(o,l),l.x<0!=o.x<0&&this.addBorderIntersection(0,Vn(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>gn!=o.x>gn&&this.addBorderIntersection(1,Vn(l.y,o.y,(gn-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,Vn(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>gn!=o.y>gn&&this.addBorderIntersection(3,Vn(l.x,o.x,(gn-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const d=this.borders[o];l<d[0]&&(d[0]=l),l>d[1]&&(d[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const d=0===o.x?0:1;this.addBorderIntersection(d,l.y),this.addBorderIntersection(d,o.y)}else{const d=0===o.y?2:3;this.addBorderIntersection(d,l.x),this.addBorderIntersection(d,o.x)}}centroid(){const o=this.polyCount.reduce((l,d)=>l+d.edges,0);return 0!==o?this.acc.div(o)._round():new st(0,0)}span(){return new st(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0)}}class xu{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.layoutVertexArray=new hi,this.centroidVertexArray=new Tp,this.indexArray=new ao,this.programConfigurations=new Cc(o.layers,o.zoom),this.segments=new Cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.enableTerrain=o.enableTerrain}populate(o,l,d,p){this.features=[],this.hasPattern=Ox("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const b=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*b/(b*b+1)/gn/(1<<_.z)}(d),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:b,index:w,sourceLayerIndex:T}of o){const I=this.layers[0]._featureFilter.needGeometry,k=vu(_,I);if(!this.layers[0]._featureFilter.filter(new Ae(this.zoom),k,d))continue;const F={id:b,sourceLayerIndex:T,index:w,geometry:I?k.geometry:Sc(_,d,p),properties:_.properties,type:_.type,patterns:{}},N=this.layoutVertexArray.length;this.hasPattern?this.features.push(Fx("fill-extrusion",this.layers,F,this.zoom,l)):this.addFeature(F,F.geometry,w,d,{},l.availableImages,p),l.featureIndex.insert(_,F.geometry,w,T,this.index,N)}this.sortBorders()}addFeatures(o,l,d,p,_){for(const b of this.features){const{geometry:w}=b;this.addFeature(b,w,b.index,l,d,p,_)}this.sortBorders()}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,LT),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Lx.members,!0))),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,HO.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,d,p,_,b,w){const T=[new st(0,0),new st(gn,gn)],I=w.projection,k="globe"===I.name,F=this.enableTerrain&&!k?new jT:null,N="Polygon"===VT[o.type];k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new rl);const V=Rg(l,500);for(let ae=V.length-1;ae>=0;ae--){const ge=V[ae];(0===ge.length||(U=ge[0]).every(se=>se.x<=0)||U.every(se=>se.x>=gn)||U.every(se=>se.y<=0)||U.every(se=>se.y>=gn))&&V.splice(ae,1)}var U;let G;if(k)G=dv(V,T,p);else{G=[];for(const ae of V)G.push({polygon:ae,bounds:T})}const Q=N?this.edgeRadius:0;for(const{polygon:ae,bounds:ge}of G){let se=0,he=0;for(const me of ae)N&&!me[0].equals(me[me.length-1])&&me.push(me[0]),he+=N?me.length-1:me.length;const ve=this.segments.prepareSegment((N?5:4)*he,this.layoutVertexArray,this.indexArray);if(N){const me=[],Be=[];se=ve.vertexLength;for(const Ze of ae){let dt,je;Ze.length&&Ze!==ae[0]&&Be.push(me.length/2),dt=Ze[1].sub(Ze[0])._perp()._unit();for(let Xe=1;Xe<Ze.length;Xe++){const it=Ze[Xe],ut=Ze[Xe===Ze.length-1?1:Xe+1];let{x:pt,y:Ge}=it;if(Q){je=ut.sub(it)._perp()._unit();const wt=dt.add(je)._unit(),en=Q*Math.min(4,1/(dt.x*wt.x+dt.y*wt.y));pt+=en*wt.x,Ge+=en*wt.y,dt=je}bf(this.layoutVertexArray,pt,Ge,0,0,1,1,0),ve.vertexLength++,me.push(it.x,it.y),k&&Ng(this.layoutVertexExtArray,I.projectTilePoint(pt,Ge,p),I.upVector(p,pt,Ge))}}const Fe=fd(me,Be);for(let Ze=0;Ze<Fe.length;Ze+=3)this.indexArray.emplaceBack(se+Fe[Ze],se+Fe[Ze+2],se+Fe[Ze+1]),ve.primitiveLength++}for(const me of ae){F&&me.length&&F.startRing(me[0]);let Be,Fe,Ze,dt=me.length>4&&$T(me[me.length-2],me[0],me[1]),je=Q?Vx(me[me.length-2],me[0],me[1],Q):0;Fe=me[1].sub(me[0])._perp()._unit();let Xe=!0;for(let it=1,ut=0;it<me.length;it++){let pt=me[it-1],Ge=me[it];const wt=me[it===me.length-1?1:it+1];if(F&&N&&F.currentPolyCount.top++,cv(Ge,pt,ge)){Q&&(Fe=wt.sub(Ge)._perp()._unit(),Xe=!Xe);continue}F&&F.append(Ge,pt);const en=Ge.sub(pt)._perp(),Dt=en.x/(Math.abs(en.x)+Math.abs(en.y)),Ut=en.y>0?1:0,It=pt.dist(Ge);if(ut+It>32768&&(ut=0),Q){Ze=wt.sub(Ge)._perp()._unit();let Ln=lv(pt,Ge,wt,Hp(Fe,Ze),Q);isNaN(Ln)&&(Ln=0);const un=Ge.sub(pt)._unit();pt=pt.add(un.mult(je))._round(),Ge=Ge.add(un.mult(-Ln))._round(),je=Ln,Fe=Ze}const ln=ve.vertexLength,Gn=me.length>4&&$T(pt,Ge,wt);let Un=Ux(ut,dt,Xe);if(bf(this.layoutVertexArray,pt.x,pt.y,Dt,Ut,0,0,Un),bf(this.layoutVertexArray,pt.x,pt.y,Dt,Ut,0,1,Un),ut+=It,Un=Ux(ut,Gn,!Xe),dt=Gn,bf(this.layoutVertexArray,Ge.x,Ge.y,Dt,Ut,0,0,Un),bf(this.layoutVertexArray,Ge.x,Ge.y,Dt,Ut,0,1,Un),ve.vertexLength+=4,this.indexArray.emplaceBack(ln+0,ln+1,ln+2),this.indexArray.emplaceBack(ln+1,ln+3,ln+2),ve.primitiveLength+=2,Q){const Ln=se+(1===it?me.length-2:it-2),un=1===it?se:Ln+1;if(this.indexArray.emplaceBack(ln+1,Ln,ln+3),this.indexArray.emplaceBack(Ln,un,ln+3),ve.primitiveLength+=2,void 0===Be&&(Be=ln),!cv(wt,me[it],ge)){const Ai=it===me.length-1?Be:ve.vertexLength;this.indexArray.emplaceBack(ln+2,ln+3,Ai),this.indexArray.emplaceBack(ln+3,Ai+1,Ai),this.indexArray.emplaceBack(ln+3,un,Ai+1),ve.primitiveLength+=3}Xe=!Xe}if(k){const Ln=this.layoutVertexExtArray,un=I.projectTilePoint(pt.x,pt.y,p),Ai=I.projectTilePoint(Ge.x,Ge.y,p),bn=I.upVector(p,pt.x,pt.y),qn=I.upVector(p,Ge.x,Ge.y);Ng(Ln,un,bn),Ng(Ln,un,bn),Ng(Ln,Ai,qn),Ng(Ln,Ai,qn)}}N&&(se+=me.length-1)}}if(F&&F.polyCount.length>0){if(F.borders){F.vertexArrayOffset=this.centroidVertexArray.length;const ae=F.borders,ge=this.featuresOnBorder.push(F)-1;for(let se=0;se<4;se++)ae[se][0]!==Number.MAX_VALUE&&this.borders[se].push(ge)}this.encodeCentroid(F.borders?void 0:F.centroid(),F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,b,p)}sortBorders(){for(let o=0;o<4;o++)this.borders[o].sort((l,d)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[d].borders[o][0])}encodeCentroid(o,l,d=!0){let p,_;if(o)if(0!==o.y){const w=l.span()._mult(this.tileToMeter);p=(Math.max(o.x,1)<<3)+Math.min(7,Math.round(w.x/10)),_=(Math.max(o.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else p=Math.ceil(7*(o.x+450)),_=0;else p=0,_=+d;let b=d?this.centroidVertexArray.length:l.vertexArrayOffset;for(const w of l.polyCount){d&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let T=0;T<w.top;T++)this.centroidVertexArray.emplace(b++,p,_);for(let T=0;T<2*w.edges;T++)this.centroidVertexArray.emplace(b++,0,_),this.centroidVertexArray.emplace(b++,p,_)}}}function Hp(a,o){const l=a.add(o)._unit();return a.x*l.x+a.y*l.y}function Vx(a,o,l,d){const p=o.sub(a)._perp()._unit(),_=l.sub(o)._perp()._unit();return lv(a,o,l,Hp(p,_),d)}function lv(a,o,l,d,p){const _=Math.sqrt(1-d*d);return Math.min(a.dist(o)/3,o.dist(l)/3,p*_/d)}function cv(a,o,l){return a.x<l[0].x&&o.x<l[0].x||a.x>l[1].x&&o.x>l[1].x||a.y<l[0].y&&o.y<l[0].y||a.y>l[1].y&&o.y>l[1].y}function $T(a,o,l){if(a.x<0||a.x>=gn||o.x<0||o.x>=gn||l.x<0||l.x>=gn)return!1;const d=l.sub(o),p=d.perp(),_=a.sub(o);return(d.x*_.x+d.y*_.y)/Math.sqrt((d.x*d.x+d.y*d.y)*(_.x*_.x+_.y*_.y))>-.866&&p.x*_.x+p.y*_.y<0}function Ux(a,o,l){const d=o?2|a:-3&a;return l?1|d:-2&d}function uv(){const a=Math.PI/32,o=Math.tan(a),l=Bp;return l*Math.sqrt(1+2*o*o)-l}function dv(a,o,l){const d=1<<l.z,p=Bo(l.x/d),_=Bo((l.x+1)/d),b=co(l.y/d),w=co((l.y+1)/d);return function(T,I,k,F,N=0,V){const U=[];if(!T.length||!k||!F)return U;const G=(me,Be)=>{for(const Fe of me)U.push({polygon:Fe,bounds:Be})},Q=Math.ceil(Math.log2(k)),ae=Math.ceil(Math.log2(F)),ge=Q-ae,se=[];for(let me=0;me<Math.abs(ge);me++)se.push(ge>0?0:1);for(let me=0;me<Math.min(Q,ae);me++)se.push(0),se.push(1);let he=T;if(he=Lg(he,I[0].y-N,I[1].y+N,1),he=Lg(he,I[0].x-N,I[1].x+N,0),!he.length)return U;const ve=[];for(se.length?ve.push({polygons:he,bounds:I,depth:0}):G(he,I);ve.length;){const me=ve.pop(),Be=me.depth,Fe=se[Be],Ze=me.bounds[0],dt=me.bounds[1],je=0===Fe?Ze.x:Ze.y,Xe=0===Fe?dt.x:dt.y,it=V?V(Fe,je,Xe):.5*(je+Xe),ut=Lg(me.polygons,je-N,it+N,Fe),pt=Lg(me.polygons,it-N,Xe+N,Fe);if(ut.length){const Ge=[Ze,new st(0===Fe?it:dt.x,1===Fe?it:dt.y)];se.length>Be+1?ve.push({polygons:ut,bounds:Ge,depth:Be+1}):G(ut,Ge)}if(pt.length){const Ge=[new st(0===Fe?it:Ze.x,1===Fe?it:Ze.y),dt];se.length>Be+1?ve.push({polygons:pt,bounds:Ge,depth:Be+1}):G(pt,Ge)}}return U}(a,o,Math.ceil((_-p)/11.25),Math.ceil((b-w)/11.25),1,(T,I,k)=>{if(0===T)return.5*(I+k);{const F=co((l.y+I/gn)/d);return(pl(.5*(co((l.y+k/gn)/d)+F))*d-l.y)*gn}})}Nt(xu,"FillExtrusionBucket",{omit:["layers","features"]}),Nt(jT,"PartMetadata");const hv=new ft({"fill-extrusion-edge-radius":new Se(Ye["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var GO={paint:new ft({"fill-extrusion-opacity":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new He(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new He(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new He(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new He(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Se(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:hv};function Bg(a,o,l){var d=2*Math.PI*6378137/256/Math.pow(2,l);return[a*d-2*Math.PI*6378137/2,o*d-2*Math.PI*6378137/2]}class zg{constructor(o,l,d){this.z=o,this.x=l,this.y=d,this.key=xf(0,o,o,l,d)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const d=(b=this.y,w=this.z,T=Bg(256*(_=this.x),256*(b=Math.pow(2,w)-b-1),w),I=Bg(256*(_+1),256*(b+1),w),T[0]+","+T[1]+","+I[0]+","+I[1]),p=function(_,b,w){let T,I="";for(let k=_;k>0;k--)T=1<<k-1,I+=(b&T?1:0)+(w&T?2:0);return I}(this.z,this.x,this.y);var _,b,w,T,I;return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",d)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vg{constructor(o,l){this.wrap=o,this.canonical=l,this.key=xf(o,l.z,l.z,l.x,l.y)}}class ts{constructor(o,l,d,p,_){this.overscaledZ=o,this.wrap=l,this.canonical=new zg(d,+p,+_),this.key=0===l&&o===d?this.canonical.key:xf(l,o,d,p,_)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new ts(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ts(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return xf(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const d=this.canonical.z-o;return xf(this.wrap*+l,o,o,this.canonical.x>>d,this.canonical.y>>d)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,d=2*this.canonical.x,p=2*this.canonical.y;return[new ts(l,this.wrap,l,d,p),new ts(l,this.wrap,l,d+1,p),new ts(l,this.wrap,l,d,p+1),new ts(l,this.wrap,l,d+1,p+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new ts(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function xf(a,o,l,d,p){const _=1<<Math.min(l,22);let b=_*(p%_)+d%_;return a&&l<22&&(b+=_*_*((a<0?-2*a-1:2*a)%(1<<2*(22-l)))),16*(32*b+l)+(o-l)}Nt(zg,"CanonicalTileID"),Nt(ts,"OverscaledTileID",{omit:["projMatrix"]});class _l extends st{constructor(o,l,d){super(o,l),this.z=d}}function Gp(a,o){return a.x*o.x+a.y*o.y}function Ug(a,o){if(1===a.length){let l=0;const d=o[l++];let p;for(;!p||d.equals(p);)if(p=o[l++],!p)return 1/0;for(;l<o.length;l++){const _=o[l],b=a[0],w=p.sub(d),T=_.sub(d),I=b.sub(d),k=Gp(w,w),F=Gp(w,T),N=Gp(T,T),V=Gp(I,w),U=Gp(I,T),G=k*N-F*F,Q=(N*V-F*U)/G,ae=(k*U-F*V)/G,ge=d.z*(1-Q-ae)+p.z*Q+_.z*ae;if(isFinite(ge))return ge}return 1/0}{let l=1/0;for(const d of o)l=Math.min(l,d.z);return l}}function Wp(a,o,l,d,p,_,b,w){const T=b*p.getElevationAt(a,o,!0,!0),I=0!==_[0],k=I?0===_[1]?b*(_[0]/7-450):b*function(F,N,V){const U=Math.floor(N[0]/8),G=Math.floor(N[1]/8),Q=10*(N[0]-8*U),ae=10*(N[1]-8*G),ge=F.getElevationAt(U,G,!0,!0),se=F.getMeterToDEM(V),he=Math.floor(.5*(Q*se-1)),ve=Math.floor(.5*(ae*se-1)),me=F.tileCoordToPixel(U,G),Be=2*he+1,Fe=2*ve+1,Ze=(en=Be,Dt=Fe,[(pt=F).getElevationAtPixel(Ge=me.x-he,wt=me.y-ve,!0),pt.getElevationAtPixel(Ge+Dt,wt,!0),pt.getElevationAtPixel(Ge,wt+Dt,!0),pt.getElevationAtPixel(Ge+en,wt+Dt,!0)]),dt=Math.abs(Ze[0]-Ze[1]),je=Math.abs(Ze[2]-Ze[3]),Xe=Math.abs(Ze[0]-Ze[2])+Math.abs(Ze[1]-Ze[3]),it=Math.min(.25,.5*se*(dt+je)/Be),ut=Math.min(.25,.5*se*Xe/Fe);var pt,Ge,wt,en,Dt;return ge+Math.max(it*Q,ut*ae)}(p,_,w):T;return{base:T+(0===l)?-1:l,top:I?Math.max(k+d,T+l+2):T+d}}const HT=Kt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:fv}=HT,jg=Kt([{name:"a_packed",components:4,type:"Float32"}]),{members:wu}=jg,jx=Fg.types,pv=Math.cos(Math.PI/180*37.5);class $g{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.id),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new qi,this.layoutVertexArray2=new Si,this.indexArray=new ao,this.programConfigurations=new Cc(o.layers,o.zoom),this.segments=new Cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(o,l,d,p){this.hasPattern=Ox("line",this.layers,l);const _=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:k,id:F,index:N,sourceLayerIndex:V}of o){const U=this.layers[0]._featureFilter.needGeometry,G=vu(k,U);if(!this.layers[0]._featureFilter.filter(new Ae(this.zoom),G,d))continue;const Q=_?_.evaluate(G,{},d):void 0,ae={id:F,properties:k.properties,type:k.type,sourceLayerIndex:V,index:N,geometry:U?G.geometry:Sc(k,d,p),patterns:{},sortKey:Q};b.push(ae)}_&&b.sort((k,F)=>k.sortKey-F.sortKey);const{lineAtlas:w,featureIndex:T}=l,I=this.addConstantDashes(w);for(const k of b){const{geometry:F,index:N,sourceLayerIndex:V}=k;if(I&&this.addFeatureDashes(k,w),this.hasPattern){const U=Fx("line",this.layers,k,this.zoom,l);this.patternFeatures.push(U)}else this.addFeature(k,F,N,d,w.positions,l.availableImages);T.insert(o[N].feature,F,N,V,this.index)}}addConstantDashes(o){let l=!1;for(const d of this.layers){const p=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if("constant"!==p.kind||"constant"!==_.kind)l=!0;else{const b=_.value,w=p.value;if(!w)continue;o.addDash(w,b)}}return l}addFeatureDashes(o,l){const d=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if("constant"===_.kind&&"constant"===b.kind)continue;let w,T;if("constant"===_.kind){if(w=_.value,!w)continue}else w=_.evaluate({zoom:d},o);T="constant"===b.kind?b.value:b.evaluate({zoom:d},o),l.addDash(w,T),o.patterns[p.id]=l.getKey(w,T)}}update(o,l,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,l,this.stateDependentLayers,d,p)}addFeatures(o,l,d,p,_){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,l,d,p)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,wu)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,fv),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,d,p,_,b){const w=this.layers[0].layout,T=w.get("line-join").evaluate(o,{}),I=w.get("line-cap").evaluate(o,{}),k=w.get("line-miter-limit"),F=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const N of l)this.addLine(N,o,T,I,k,F);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,d,_,b,p)}addLine(o,l,d,p,_,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ae=0;ae<o.length-1;ae++)this.totalDistance+=o[ae].dist(o[ae+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w="Polygon"===jx[l.type];let T=o.length;for(;T>=2&&o[T-1].equals(o[T-2]);)T--;let I=0;for(;I<T-1&&o[I].equals(o[I+1]);)I++;if(T<(w?3:2))return;"bevel"===d&&(_=1.05);const k=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let N,V,U,G,Q;this.e1=this.e2=-1,w&&(N=o[T-2],Q=o[I].sub(N)._unit()._perp());for(let ae=I;ae<T;ae++){if(U=ae===T-1?w?o[I+1]:void 0:o[ae+1],U&&o[ae].equals(U))continue;Q&&(G=Q),N&&(V=N),N=o[ae],Q=U?U.sub(N)._unit()._perp():G,G=G||Q;let ge=G.add(Q);0===ge.x&&0===ge.y||ge._unit();const se=G.x*Q.x+G.y*Q.y,he=ge.x*Q.x+ge.y*Q.y,ve=0!==he?1/he:1/0,me=2*Math.sqrt(2-2*he),Be=he<pv&&V&&U,Fe=G.x*Q.y-G.y*Q.x>0;if(Be&&ae>I){const je=N.dist(V);if(je>2*k){const Xe=N.sub(N.sub(V)._mult(k/je)._round());this.updateDistance(V,Xe),this.addCurrentVertex(Xe,G,0,0,F),V=Xe}}const Ze=V&&U;let dt=Ze?d:w?"butt":p;if(Ze&&"round"===dt&&(ve<b?dt="miter":ve<=2&&(dt="fakeround")),"miter"===dt&&ve>_&&(dt="bevel"),"bevel"===dt&&(ve>2&&(dt="flipbevel"),ve<_&&(dt="miter")),V&&this.updateDistance(V,N),"miter"===dt)ge._mult(ve),this.addCurrentVertex(N,ge,0,0,F);else if("flipbevel"===dt){if(ve>100)ge=Q.mult(-1);else{const je=ve*G.add(Q).mag()/G.sub(Q).mag();ge._perp()._mult(je*(Fe?-1:1))}this.addCurrentVertex(N,ge,0,0,F),this.addCurrentVertex(N,ge.mult(-1),0,0,F)}else if("bevel"===dt||"fakeround"===dt){const je=-Math.sqrt(ve*ve-1),Xe=Fe?je:0,it=Fe?0:je;if(V&&this.addCurrentVertex(N,G,Xe,it,F),"fakeround"===dt){const ut=Math.round(180*me/Math.PI/20);for(let pt=1;pt<ut;pt++){let Ge=pt/ut;if(.5!==Ge){const en=Ge-.5;Ge+=Ge*en*(Ge-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*en*en+(.848013+se*(.215638*se-1.06021)))}const wt=Q.sub(G)._mult(Ge)._add(G)._unit()._mult(Fe?-1:1);this.addHalfVertex(N,wt.x,wt.y,!1,Fe,0,F)}}U&&this.addCurrentVertex(N,Q,-Xe,-it,F)}else if("butt"===dt)this.addCurrentVertex(N,ge,0,0,F);else if("square"===dt){const je=V?1:-1;V||this.addCurrentVertex(N,ge,je,je,F),this.addCurrentVertex(N,ge,0,0,F),V&&this.addCurrentVertex(N,ge,je,je,F)}else"round"===dt&&(V&&(this.addCurrentVertex(N,G,0,0,F),this.addCurrentVertex(N,G,1,1,F,!0)),U&&(this.addCurrentVertex(N,Q,-1,-1,F,!0),this.addCurrentVertex(N,Q,0,0,F)));if(Be&&ae<T-1){const je=N.dist(U);if(je>2*k){const Xe=N.add(U.sub(N)._mult(k/je)._round());this.updateDistance(N,Xe),this.addCurrentVertex(Xe,Q,0,0,F),N=Xe}}}}addCurrentVertex(o,l,d,p,_,b=!1){const w=l.y*p-l.x,T=-l.y-l.x*p;this.addHalfVertex(o,l.x+l.y*d,l.y-l.x*d,b,!1,d,_),this.addHalfVertex(o,w,T,b,!0,-p,_)}addHalfVertex({x:o,y:l},d,p,_,b,w,T){this.layoutVertexArray.emplaceBack((o<<1)+(_?1:0),(l<<1)+(b?1:0),Math.round(63*d)+128,Math.round(63*p)+128,1+(0===w?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const I=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),T.primitiveLength++),b?this.e2=I:this.e1=I}updateScaledDistance(){if(this.lineClips){const o=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=o*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(o,l){this.distance+=o.dist(l),this.updateScaledDistance()}}Nt($g,"LineBucket",{omit:["layers","patternFeatures"]});const GT=new ft({"line-cap":new He(Ye.layout_line["line-cap"]),"line-join":new He(Ye.layout_line["line-join"]),"line-miter-limit":new Se(Ye.layout_line["line-miter-limit"]),"line-round-limit":new Se(Ye.layout_line["line-round-limit"]),"line-sort-key":new He(Ye.layout_line["line-sort-key"])});var mv={paint:new ft({"line-opacity":new He(Ye.paint_line["line-opacity"]),"line-color":new He(Ye.paint_line["line-color"]),"line-translate":new Se(Ye.paint_line["line-translate"]),"line-translate-anchor":new Se(Ye.paint_line["line-translate-anchor"]),"line-width":new He(Ye.paint_line["line-width"]),"line-gap-width":new He(Ye.paint_line["line-gap-width"]),"line-offset":new He(Ye.paint_line["line-offset"]),"line-blur":new He(Ye.paint_line["line-blur"]),"line-dasharray":new He(Ye.paint_line["line-dasharray"]),"line-pattern":new He(Ye.paint_line["line-pattern"]),"line-gradient":new ct(Ye.paint_line["line-gradient"]),"line-trim-offset":new Se(Ye.paint_line["line-trim-offset"])}),layout:GT};const lh=new class extends He{possiblyEvaluate(a,o){return o=new Ae(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(a,o)}evaluate(a,o,l,d){return o=xn({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(a,o,l,d)}}(mv.paint.properties["line-width"].specification);function $x(a,o){return o>0?o+2*a:a}lh.useIntegerZoom=!0;const WT=Kt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qT=Kt([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),gv=Kt([{name:"a_projected_pos",components:4,type:"Float32"}],4);Kt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ZT=Kt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Hx=Kt([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Kt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Gx=Kt([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Wx=Kt([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Kt([{name:"triangle",components:3,type:"Uint16"}]),Kt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Kt([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Kt([{type:"Float32",name:"offsetX"}]),Kt([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ns=24;const Rc=128;function pd(a,o){const{expression:l}=o;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new Ae(a+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:d,interpolationType:p}=l;let _=0;for(;_<d.length&&d[_]<=a;)_++;_=Math.max(0,_-1);let b=_;for(;b<d.length&&d[b]<a+1;)b++;b=Math.min(d.length-1,b);const w=d[_],T=d[b];return"composite"===l.kind?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:w,maxZoom:T,minSize:l.evaluate(new Ae(w)),maxSize:l.evaluate(new Ae(T)),interpolationType:p}}}function Hg(a,{uSize:o,uSizeT:l},{lowerSize:d,upperSize:p}){return"source"===a.kind?d/Rc:"composite"===a.kind?Vn(d/Rc,p/Rc,l):o}function Zl(a,o){let l=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){const{interpolationType:p,minZoom:_,maxZoom:b}=a,w=p?_n(la.interpolationFactor(p,o,_,b),0,1):0;"camera"===a.kind?d=Vn(a.minSize,a.maxSize,w):l=w}return{uSizeT:l,uSize:d}}var Kr=Object.freeze({__proto__:null,getSizeData:pd,evaluateSizeForFeature:Hg,evaluateSizeForZoom:Zl,SIZE_PACK_FACTOR:Rc});function YT(a,o,l){return a.sections.forEach(d=>{d.text=function(p,_,b){const w=_.layout.get("text-transform").evaluate(b,{});return"uppercase"===w?p=p.toLocaleUpperCase():"lowercase"===w&&(p=p.toLocaleLowerCase()),Ce.applyArabicShaping&&(p=Ce.applyArabicShaping(p)),p}(d.text,o,l)}),a}const Eu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Cu(a){return"\ufe36"===a||"\ufe48"===a||"\ufe38"===a||"\ufe44"===a||"\ufe42"===a||"\ufe3e"===a||"\ufe3c"===a||"\ufe3a"===a||"\ufe18"===a||"\ufe40"===a||"\ufe10"===a||"\ufe13"===a||"\ufe14"===a||"\uff40"===a||"\uffe3"===a||"\ufe11"===a||"\ufe12"===a}function KT(a){return"\ufe35"===a||"\ufe47"===a||"\ufe37"===a||"\ufe43"===a||"\ufe41"===a||"\ufe3d"===a||"\ufe3b"===a||"\ufe39"===a||"\ufe17"===a||"\ufe3f"===a}var qp=Li,Tu=function(a,o,l,d,p){var _,b,w=8*p-d-1,T=(1<<w)-1,I=T>>1,k=-7,F=l?p-1:0,N=l?-1:1,V=a[o+F];for(F+=N,_=V&(1<<-k)-1,V>>=-k,k+=w;k>0;_=256*_+a[o+F],F+=N,k-=8);for(b=_&(1<<-k)-1,_>>=-k,k+=d;k>0;b=256*b+a[o+F],F+=N,k-=8);if(0===_)_=1-I;else{if(_===T)return b?NaN:1/0*(V?-1:1);b+=Math.pow(2,d),_-=I}return(V?-1:1)*b*Math.pow(2,_-d)},_v=function(a,o,l,d,p,_){var b,w,T,I=8*_-p-1,k=(1<<I)-1,F=k>>1,N=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,V=d?0:_-1,U=d?1:-1,G=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(w=isNaN(o)?1:0,b=k):(b=Math.floor(Math.log(o)/Math.LN2),o*(T=Math.pow(2,-b))<1&&(b--,T*=2),(o+=b+F>=1?N/T:N*Math.pow(2,1-F))*T>=2&&(b++,T/=2),b+F>=k?(w=0,b=k):b+F>=1?(w=(o*T-1)*Math.pow(2,p),b+=F):(w=o*Math.pow(2,F-1)*Math.pow(2,p),b=0));p>=8;a[l+V]=255&w,V+=U,w/=256,p-=8);for(b=b<<p|w,I+=p;I>0;a[l+V]=255&b,V+=U,b/=256,I-=8);a[l+V-U]|=128*G};function Li(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Li.Varint=0,Li.Fixed64=1,Li.Bytes=2,Li.Fixed32=5;var Zp=4294967296,qx=1/Zp,Gg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function As(a){return a.type===Li.Bytes?a.readVarint()+a.pos:a.pos+1}function Zx(a,o,l){var d=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));l.realloc(d);for(var p=l.pos-1;p>=a;p--)l.buf[p+d]=l.buf[p]}function XT(a,o){for(var l=0;l<a.length;l++)o.writeVarint(a[l])}function QT(a,o){for(var l=0;l<a.length;l++)o.writeSVarint(a[l])}function JT(a,o){for(var l=0;l<a.length;l++)o.writeFloat(a[l])}function eI(a,o){for(var l=0;l<a.length;l++)o.writeDouble(a[l])}function tI(a,o){for(var l=0;l<a.length;l++)o.writeBoolean(a[l])}function Ef(a,o){for(var l=0;l<a.length;l++)o.writeFixed32(a[l])}function Iu(a,o){for(var l=0;l<a.length;l++)o.writeSFixed32(a[l])}function nI(a,o){for(var l=0;l<a.length;l++)o.writeFixed64(a[l])}function iI(a,o){for(var l=0;l<a.length;l++)o.writeSFixed64(a[l])}function yv(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+16777216*a[o+3]}function Yp(a,o,l){a[l]=o,a[l+1]=o>>>8,a[l+2]=o>>>16,a[l+3]=o>>>24}function vv(a,o){return(a[o]|a[o+1]<<8|a[o+2]<<16)+(a[o+3]<<24)}function WO(a,o,l){o.glyphs=[],1===a&&l.readMessage(Yx,o)}function Yx(a,o,l){if(3===a){const{id:d,bitmap:p,width:_,height:b,left:w,top:T,advance:I}=l.readMessage(Kx,{});o.glyphs.push({id:d,bitmap:new gl({width:_+6,height:b+6},p),metrics:{width:_,height:b,left:w,top:T,advance:I}})}else 4===a?o.ascender=l.readSVarint():5===a&&(o.descender=l.readSVarint())}function Kx(a,o,l){1===a?o.id=l.readVarint():2===a?o.bitmap=l.readBytes():3===a?o.width=l.readVarint():4===a?o.height=l.readVarint():5===a?o.left=l.readSVarint():6===a?o.top=l.readSVarint():7===a&&(o.advance=l.readVarint())}function bv(a){let o=0,l=0;for(const b of a)o+=b.w*b.h,l=Math.max(l,b.w);a.sort((b,w)=>w.h-b.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let p=0,_=0;for(const b of a)for(let w=d.length-1;w>=0;w--){const T=d[w];if(!(b.w>T.w||b.h>T.h)){if(b.x=T.x,b.y=T.y,_=Math.max(_,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===T.w&&b.h===T.h){const I=d.pop();w<d.length&&(d[w]=I)}else b.h===T.h?(T.x+=b.w,T.w-=b.w):b.w===T.w?(T.y+=b.h,T.h-=b.h):(d.push({x:T.x+b.w,y:T.y,w:T.w-b.w,h:b.h}),T.y+=b.h,T.h-=b.h);break}}return{w:p,h:_,fill:o/(p*_)||0}}Li.prototype={destroy:function(){this.buf=null},readFields:function(a,o,l){for(l=l||this.length;this.pos<l;){var d=this.readVarint(),p=d>>3,_=this.pos;this.type=7&d,a(p,o,this),this.pos===_&&this.skip(d)}return o},readMessage:function(a,o){return this.readFields(a,o,this.readVarint()+this.pos)},readFixed32:function(){var a=yv(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=vv(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=yv(this.buf,this.pos)+yv(this.buf,this.pos+4)*Zp;return this.pos+=8,a},readSFixed64:function(){var a=yv(this.buf,this.pos)+vv(this.buf,this.pos+4)*Zp;return this.pos+=8,a},readFloat:function(){var a=Tu(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Tu(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var o,l,d=this.buf;return o=127&(l=d[this.pos++]),l<128?o:(o|=(127&(l=d[this.pos++]))<<7,l<128?o:(o|=(127&(l=d[this.pos++]))<<14,l<128?o:(o|=(127&(l=d[this.pos++]))<<21,l<128?o:function(p,_,b){var w,T,I=b.buf;if(w=(112&(T=I[b.pos++]))>>4,T<128||(w|=(127&(T=I[b.pos++]))<<3,T<128)||(w|=(127&(T=I[b.pos++]))<<10,T<128)||(w|=(127&(T=I[b.pos++]))<<17,T<128)||(w|=(127&(T=I[b.pos++]))<<24,T<128)||(w|=(1&(T=I[b.pos++]))<<31,T<128))return function wf(a,o,l){return l?4294967296*o+(a>>>0):4294967296*(o>>>0)+(a>>>0)}(p,w,_);throw new Error("Expected varint not more than 10 bytes")}(o|=(15&(l=d[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,o=this.pos;return this.pos=a,a-o>=12&&Gg?Gg.decode(this.buf.subarray(o,a)):function(l,d,p){for(var _="",b=d;b<p;){var w,T,I,k=l[b],F=null,N=k>239?4:k>223?3:k>191?2:1;if(b+N>p)break;1===N?k<128&&(F=k):2===N?128==(192&(w=l[b+1]))&&(F=(31&k)<<6|63&w)<=127&&(F=null):3===N?(T=l[b+2],128==(192&(w=l[b+1]))&&128==(192&T)&&((F=(15&k)<<12|(63&w)<<6|63&T)<=2047||F>=55296&&F<=57343)&&(F=null)):4===N&&(T=l[b+2],I=l[b+3],128==(192&(w=l[b+1]))&&128==(192&T)&&128==(192&I)&&((F=(15&k)<<18|(63&w)<<12|(63&T)<<6|63&I)<=65535||F>=1114112)&&(F=null)),null===F?(F=65533,N=1):F>65535&&(F-=65536,_+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),_+=String.fromCharCode(F),b+=N}return _}(this.buf,o,a)},readBytes:function(){var a=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,a);return this.pos=a,o},readPackedVarint:function(a,o){if(this.type!==Li.Bytes)return a.push(this.readVarint(o));var l=As(this);for(a=a||[];this.pos<l;)a.push(this.readVarint(o));return a},readPackedSVarint:function(a){if(this.type!==Li.Bytes)return a.push(this.readSVarint());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Li.Bytes)return a.push(this.readBoolean());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Li.Bytes)return a.push(this.readFloat());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Li.Bytes)return a.push(this.readDouble());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Li.Bytes)return a.push(this.readFixed32());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Li.Bytes)return a.push(this.readSFixed32());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Li.Bytes)return a.push(this.readFixed64());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Li.Bytes)return a.push(this.readSFixed64());var o=As(this);for(a=a||[];this.pos<o;)a.push(this.readSFixed64());return a},skip:function(a){var o=7&a;if(o===Li.Varint)for(;this.buf[this.pos++]>127;);else if(o===Li.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Li.Fixed32)this.pos+=4;else{if(o!==Li.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(a,o){this.writeVarint(a<<3|o)},realloc:function(a){for(var o=this.length||16;o<this.pos+a;)o*=2;if(o!==this.length){var l=new Uint8Array(o);l.set(this.buf),this.buf=l,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Yp(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Yp(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Yp(this.buf,-1&a,this.pos),Yp(this.buf,Math.floor(a*qx),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Yp(this.buf,-1&a,this.pos),Yp(this.buf,Math.floor(a*qx),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(o,l){var d,p,_,w;if(o>=0?(d=o%4294967296|0,p=o/4294967296|0):(p=~(-o/4294967296),4294967295^(d=~(-o%4294967296))?d=d+1|0:(d=0,p=p+1|0)),o>=0x10000000000000000||o<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),_=d,(w=l).buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7),function(_,b){var w=(7&_)<<4;b.buf[b.pos++]|=w|((_>>>=3)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_|((_>>>=7)?128:0),_&&(b.buf[b.pos++]=127&_)))))}(p,l)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var o=this.pos;this.pos=function(d,p,_){for(var b,w,T=0;T<p.length;T++){if((b=p.charCodeAt(T))>55295&&b<57344){if(!w){b>56319||T+1===p.length?(d[_++]=239,d[_++]=191,d[_++]=189):w=b;continue}if(b<56320){d[_++]=239,d[_++]=191,d[_++]=189,w=b;continue}b=w-55296<<10|b-56320|65536,w=null}else w&&(d[_++]=239,d[_++]=191,d[_++]=189,w=null);b<128?d[_++]=b:(b<2048?d[_++]=b>>6|192:(b<65536?d[_++]=b>>12|224:(d[_++]=b>>18|240,d[_++]=b>>12&63|128),d[_++]=b>>6&63|128),d[_++]=63&b|128)}return _}(this.buf,a,this.pos);var l=this.pos-o;l>=128&&Zx(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeFloat:function(a){this.realloc(4),_v(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),_v(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var o=a.length;this.writeVarint(o),this.realloc(o);for(var l=0;l<o;l++)this.buf[this.pos++]=a[l]},writeRawMessage:function(a,o){this.pos++;var l=this.pos;a(o,this);var d=this.pos-l;d>=128&&Zx(l,d,this),this.pos=l-1,this.writeVarint(d),this.pos+=d},writeMessage:function(a,o,l){this.writeTag(a,Li.Bytes),this.writeRawMessage(o,l)},writePackedVarint:function(a,o){o.length&&this.writeMessage(a,XT,o)},writePackedSVarint:function(a,o){o.length&&this.writeMessage(a,QT,o)},writePackedBoolean:function(a,o){o.length&&this.writeMessage(a,tI,o)},writePackedFloat:function(a,o){o.length&&this.writeMessage(a,JT,o)},writePackedDouble:function(a,o){o.length&&this.writeMessage(a,eI,o)},writePackedFixed32:function(a,o){o.length&&this.writeMessage(a,Ef,o)},writePackedSFixed32:function(a,o){o.length&&this.writeMessage(a,Iu,o)},writePackedFixed64:function(a,o){o.length&&this.writeMessage(a,nI,o)},writePackedSFixed64:function(a,o){o.length&&this.writeMessage(a,iI,o)},writeBytesField:function(a,o){this.writeTag(a,Li.Bytes),this.writeBytes(o)},writeFixed32Field:function(a,o){this.writeTag(a,Li.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(a,o){this.writeTag(a,Li.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(a,o){this.writeTag(a,Li.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(a,o){this.writeTag(a,Li.Fixed64),this.writeSFixed64(o)},writeVarintField:function(a,o){this.writeTag(a,Li.Varint),this.writeVarint(o)},writeSVarintField:function(a,o){this.writeTag(a,Li.Varint),this.writeSVarint(o)},writeStringField:function(a,o){this.writeTag(a,Li.Bytes),this.writeString(o)},writeFloatField:function(a,o){this.writeTag(a,Li.Fixed32),this.writeFloat(o)},writeDoubleField:function(a,o){this.writeTag(a,Li.Fixed64),this.writeDouble(o)},writeBooleanField:function(a,o){this.writeVarintField(a,Boolean(o))}};class Wg{constructor(o,{pixelRatio:l,version:d,stretchX:p,stretchY:_,content:b}){this.paddedRect=o,this.pixelRatio=l,this.stretchX=p,this.stretchY=_,this.content=b,this.version=d}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Xx{constructor(o,l){const d={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(o,d,_),this.addImages(l,p,_);const{w:b,h:w}=bv(_),T=new Ss({width:b||1,height:w||1});for(const I in o){const k=o[I],F=d[I].paddedRect;Ss.copy(k.data,T,{x:0,y:0},{x:F.x+1,y:F.y+1},k.data)}for(const I in l){const k=l[I],F=p[I].paddedRect,N=F.x+1,V=F.y+1,U=k.data.width,G=k.data.height;Ss.copy(k.data,T,{x:0,y:0},{x:N,y:V},k.data),Ss.copy(k.data,T,{x:0,y:G-1},{x:N,y:V-1},{width:U,height:1}),Ss.copy(k.data,T,{x:0,y:0},{x:N,y:V+G},{width:U,height:1}),Ss.copy(k.data,T,{x:U-1,y:0},{x:N-1,y:V},{width:1,height:G}),Ss.copy(k.data,T,{x:0,y:0},{x:N+U,y:V},{width:1,height:G})}this.image=T,this.iconPositions=d,this.patternPositions=p}addImages(o,l,d){for(const p in o){const _=o[p],b={x:0,y:0,w:_.data.width+2,h:_.data.height+2};d.push(b),l[p]=new Wg(b,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(o,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(d=>o.hasImage(d)),o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in o.updatedImages)this.patchUpdatedImage(this.iconPositions[d],o.getImage(d),l),this.patchUpdatedImage(this.patternPositions[d],o.getImage(d),l)}patchUpdatedImage(o,l,d){if(!o||!l||o.version===l.version)return;o.version=l.version;const[p,_]=o.tl;d.update(l.data,void 0,{x:p,y:_})}}Nt(Wg,"ImagePosition"),Nt(Xx,"ImageAtlas");const Ma={horizontal:1,vertical:2,horizontalOnly:3};class qs{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(o,l){const d=new qs;return d.scale=o||1,d.fontStack=l,d}static forImage(o){const l=new qs;return l.imageName=o,l}}class Cf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l){const d=new Cf;for(let p=0;p<o.sections.length;p++){const _=o.sections[p];_.image?d.addImageSection(_):d.addTextSection(_,l)}return d}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(o){this.text=function(l,d){let p="";for(let _=0;_<l.length;_++){const b=l.charCodeAt(_+1)||null,w=l.charCodeAt(_-1)||null;p+=!d&&(b&&P(b)&&!Eu[l[_+1]]||w&&P(w)&&!Eu[l[_-1]])||!Eu[l[_]]?l[_]:Eu[l[_]]}return p}(this.text,o)}trim(){let o=0;for(let d=0;d<this.text.length&&Zg[this.text.charCodeAt(d)];d++)o++;let l=this.text.length;for(let d=this.text.length-1;d>=0&&d>=o&&Zg[this.text.charCodeAt(d)];d--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const d=new Cf;return d.text=this.text.substring(o,l),d.sectionIndex=this.sectionIndex.slice(o,l),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(qs.forText(o.scale,o.fontStack||l));const d=this.sections.length-1;for(let p=0;p<o.text.length;++p)this.sectionIndex.push(d)}addImageSection(o){const l=o.image?o.image.name:"";if(0===l.length)return void ni("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(qs.forImage(l)),this.sectionIndex.push(this.sections.length-1)):ni("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qg(a,o,l,d,p,_,b,w,T,I,k,F,N,V,U){const G=Cf.fromFeature(a,p);F===Ma.vertical&&G.verticalizePunctuation(N);let Q=[];const ae=function(me,Be,Fe,Ze,dt,je){if(!me)return[];const Xe=[],it=function(wt,en,Dt,Ut,It,ln){let Gn=0;for(let Un=0;Un<wt.length();Un++){const Ln=wt.getSection(Un);Gn+=Qx(wt.getCharCode(Un),Ln,Ut,It,en,ln)}return Gn/Math.max(1,Math.ceil(Gn/Dt))}(me,Be,Fe,Ze,dt,je),ut=me.text.indexOf("\u200b")>=0;let pt=0;for(let wt=0;wt<me.length();wt++){const en=me.getSection(wt),Dt=me.getCharCode(wt);if(Zg[Dt]||(pt+=Qx(Dt,en,Ze,dt,Be,je)),wt<me.length()-1){const Ut=!((Ge=Dt)<11904||!(Jh(Ge)||od(Ge)||g(Ge)||Cp(Ge)||Lo(Ge)||wp(Ge)||ug(Ge)||rd(Ge)||nl(Ge)||ef(Ge)||Ep(Ge)||y(Ge)||xc(Ge)||Wr(Ge)||Qh(Ge)||dg(Ge)||Jo(Ge)||Qd(Ge)||il(Ge)||mu(Ge)));(rI[Dt]||Ut||en.imageName)&&Xe.push(tw(wt+1,pt,it,Xe,ew(Dt,me.getCharCode(wt+1),Ut&&ut),!1))}}var Ge;return nw(tw(me.length(),pt,it,Xe,0,!0))}(G,I,_,o,d,V),{processBidirectionalText:ge,processStyledBidirectionalText:se}=Ce;if(ge&&1===G.sections.length){const me=ge(G.toString(),ae);for(const Be of me){const Fe=new Cf;Fe.text=Be,Fe.sections=G.sections;for(let Ze=0;Ze<Be.length;Ze++)Fe.sectionIndex.push(0);Q.push(Fe)}}else if(se){const me=se(G.text,G.sectionIndex,ae);for(const Be of me){const Fe=new Cf;Fe.text=Be[0],Fe.sectionIndex=Be[1],Fe.sections=G.sections,Q.push(Fe)}}else Q=function(me,Be){const Fe=[],Ze=me.text;let dt=0;for(const je of Be)Fe.push(me.substring(dt,je)),dt=je;return dt<Ze.length&&Fe.push(me.substring(dt,Ze.length)),Fe}(G,ae);const he=[],ve={positionedLines:he,text:G.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:F,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(me,Be,Fe,Ze,dt,je,Xe,it,ut,pt,Ge,wt){let en=0,Dt=0,Ut=0;const It="right"===it?1:"left"===it?0:.5;let ln=!1;for(const bn of dt){const qn=bn.getSections();for(const Bi of qn){if(Bi.imageName)continue;const Zn=Be[Bi.fontStack];if(Zn&&(ln=void 0!==Zn.ascender&&void 0!==Zn.descender,!ln))break}if(!ln)break}let Gn=0;for(const bn of dt){bn.trim();const qn=bn.getMaxScale(),Bi=(qn-1)*ns,Zn={positionedGlyphs:[],lineOffset:0};me.positionedLines[Gn]=Zn;const Zi=Zn.positionedGlyphs;let Ji=0;if(!bn.length()){Dt+=je,++Gn;continue}let sn=0,sr=0;for(let pe=0;pe<bn.length();pe++){const be=bn.getSection(pe),St=bn.getSectionIndex(pe),fi=bn.getCharCode(pe);let tr=be.scale,Or=null,Pi=null,vr=null,Xr=ns,uo=0;const Qr=!(ut===Ma.horizontal||!Ge&&!M(fi)||Ge&&(Zg[fi]||(Un=fi,Xd(Un)||gt(Un)||di(Un)||tf(Un)||h(Un))));if(be.imageName){const $t=Ze[be.imageName];if(!$t)continue;vr=be.imageName,me.iconsInText=me.iconsInText||!0,Pi=$t.paddedRect;const ho=$t.displaySize;tr=tr*ns/wt,Or={width:ho[0],height:ho[1],left:1,top:-3,advance:Qr?ho[1]:ho[0],localGlyph:!1},uo=ln?-Or.height*tr:qn*ns-17-ho[1]*tr,Xr=Or.advance;const Mu=(Qr?ho[0]:ho[1])*tr-ns*qn;Mu>0&&Mu>Ji&&(Ji=Mu)}else{const $t=Fe[be.fontStack];if(!$t)continue;$t[fi]&&(Pi=$t[fi]);const ho=Be[be.fontStack];if(!ho)continue;const Mu=ho.glyphs[fi];if(!Mu)continue;if(Or=Mu.metrics,Xr=8203!==fi?ns:0,ln){const hh=void 0!==ho.ascender?Math.abs(ho.ascender):0,Rf=void 0!==ho.descender?Math.abs(ho.descender):0,Pf=(hh+Rf)*tr;sn<Pf&&(sn=Pf,sr=(hh-Rf)/2*tr),uo=-hh*tr}else uo=(qn-tr)*ns-17}Qr?(me.verticalizable=!0,Zi.push({glyph:fi,imageName:vr,x:en,y:Dt+uo,vertical:Qr,scale:tr,localGlyph:Or.localGlyph,fontStack:be.fontStack,sectionIndex:St,metrics:Or,rect:Pi}),en+=Xr*tr+pt):(Zi.push({glyph:fi,imageName:vr,x:en,y:Dt+uo,vertical:Qr,scale:tr,localGlyph:Or.localGlyph,fontStack:be.fontStack,sectionIndex:St,metrics:Or,rect:Pi}),en+=Or.advance*tr+pt)}0!==Zi.length&&(Ut=Math.max(en-pt,Ut),ln?Hn(Zi,It,Ji,sr,je*qn/2):Hn(Zi,It,Ji,0,je/2)),en=0;const Eo=je*qn+Ji;Zn.lineOffset=Math.max(Ji,Bi),Dt+=Eo,++Gn}var Un;const Ln=Dt,{horizontalAlign:un,verticalAlign:Ai}=xv(Xe);(function(bn,qn,Bi,Zn,Zi,Ji){const sn=(qn-Bi)*Zi,sr=-Ji*Zn;for(const Eo of bn)for(const pe of Eo.positionedGlyphs)pe.x+=sn,pe.y+=sr})(me.positionedLines,It,un,Ai,Ut,Ln),me.top+=-Ai*Ln,me.bottom=me.top+Ln,me.left+=-un*Ut,me.right=me.left+Ut,me.hasBaseline=ln}(ve,o,l,d,Q,b,w,T,F,I,N,U),!function(me){for(const Be of me)if(0!==Be.positionedGlyphs.length)return!1;return!0}(he)&&ve}const Zg={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qx(a,o,l,d,p,_){if(o.imageName){const b=d[o.imageName];return b?b.displaySize[0]*o.scale*ns/_+p:0}{const b=l[o.fontStack],w=b&&b.glyphs[a];return w?w.metrics.advance*o.scale+p:0}}function Jx(a,o,l,d){const p=Math.pow(a-o,2);return d?a<o?p/2:2*p:p+Math.abs(l)*l}function ew(a,o,l){let d=0;return 10===a&&(d-=1e4),l&&(d+=150),40!==a&&65288!==a||(d+=50),41!==o&&65289!==o||(d+=50),d}function tw(a,o,l,d,p,_){let b=null,w=Jx(o,l,p,_);for(const T of d){const I=Jx(o-T.x,l,p,_)+T.badness;I<=w&&(b=T,w=I)}return{index:a,x:o,priorBreak:b,badness:w}}function nw(a){return a?nw(a.priorBreak).concat(a.index):[]}function xv(a){let o=.5,l=.5;switch(a){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function Hn(a,o,l,d,p){if(!(o||l||d||p))return;const _=a.length-1,b=a[_],w=(b.x+b.metrics.advance*b.scale)*o;for(let T=0;T<=_;T++)a[T].x-=w,a[T].y+=l+d+p}function oi(a,o,l){const{horizontalAlign:d,verticalAlign:p}=xv(l),_=o[0]-a.displaySize[0]*d,b=o[1]-a.displaySize[1]*p;return{image:a,top:b,bottom:b+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function wv(a,o,l,d,p,_){const b=a.image;let w;if(b.content){const Q=b.content,ae=b.pixelRatio||1;w=[Q[0]/ae,Q[1]/ae,b.displaySize[0]-Q[2]/ae,b.displaySize[1]-Q[3]/ae]}const T=o.left*_,I=o.right*_;let k,F,N,V;"width"===l||"both"===l?(V=p[0]+T-d[3],F=p[0]+I+d[1]):(V=p[0]+(T+I-b.displaySize[0])/2,F=V+b.displaySize[0]);const U=o.top*_,G=o.bottom*_;return"height"===l||"both"===l?(k=p[1]+U-d[0],N=p[1]+G+d[2]):(k=p[1]+(U+G-b.displaySize[1])/2,N=k+b.displaySize[1]),{image:b,top:k,right:F,bottom:N,left:V,collisionPadding:w}}class Pc extends st{constructor(o,l,d,p,_){super(o,l),this.angle=p,this.z=d,void 0!==_&&(this.segment=_)}clone(){return new Pc(this.x,this.y,this.z,this.angle,this.segment)}}function iw(a,o,l,d,p){if(void 0===o.segment)return!0;let _=o,b=o.segment+1,w=0;for(;w>-l/2;){if(b--,b<0)return!1;w-=a[b].dist(_),_=a[b]}w+=a[b].dist(a[b+1]),b++;const T=[];let I=0;for(;w<l/2;){const k=a[b],F=a[b+1];if(!F)return!1;let N=a[b-1].angleTo(k)-k.angleTo(F);for(N=Math.abs((N+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:N}),I+=N;w-T[0].distance>d;)I-=T.shift().angleDelta;if(I>p)return!1;b++,w+=k.dist(F)}return!0}function rw(a){let o=0;for(let l=0;l<a.length-1;l++)o+=a[l].dist(a[l+1]);return o}function Ev(a,o,l){return a?.6*o*l:0}function ow(a,o){return Math.max(a?a.right-a.left:0,o?o.right-o.left:0)}function sw(a,o,l,d,p,_){const b=Ev(l,p,_),w=ow(l,d)*_;let T=0;const I=rw(a)/2;for(let k=0;k<a.length-1;k++){const F=a[k],N=a[k+1],V=F.dist(N);if(T+V>I){const U=(I-T)/V,G=Vn(F.x,N.x,U),Q=Vn(F.y,N.y,U),ae=new Pc(G,Q,0,N.angleTo(F),k);return!b||iw(a,ae,w,b,o)?ae:void 0}T+=V}}function oI(a,o,l,d,p,_,b,w,T){const I=Ev(d,_,b),k=ow(d,p),F=k*b,N=0===a[0].x||a[0].x===T||0===a[0].y||a[0].y===T;return o-F<o/4&&(o=F+o/4),aw(a,N?o/2*w%o:(k/2+2*_)*b*w%o,o,I,l,F,N,!1,T)}function aw(a,o,l,d,p,_,b,w,T){const I=_/2,k=rw(a);let F=0,N=o-l,V=[];for(let U=0;U<a.length-1;U++){const G=a[U],Q=a[U+1],ae=G.dist(Q),ge=Q.angleTo(G);for(;N+l<F+ae;){N+=l;const se=(N-F)/ae,he=Vn(G.x,Q.x,se),ve=Vn(G.y,Q.y,se);if(he>=0&&he<T&&ve>=0&&ve<T&&N-I>=0&&N+I<=k){const me=new Pc(he,ve,0,ge,U);me._round(),d&&!iw(a,me,_,d,p)||V.push(me)}}F+=ae}return w||V.length||b||(V=aw(a,F/2,l,d,p,_,b,!0,T)),V}function sI(a,o,l,d,p){const _=[];for(let b=0;b<a.length;b++){const w=a[b];let T;for(let I=0;I<w.length-1;I++){let k=w[I],F=w[I+1];k.x<o&&F.x<o||(k.x<o?k=new st(o,k.y+(o-k.x)/(F.x-k.x)*(F.y-k.y))._round():F.x<o&&(F=new st(o,k.y+(o-k.x)/(F.x-k.x)*(F.y-k.y))._round()),k.y<l&&F.y<l||(k.y<l?k=new st(k.x+(l-k.y)/(F.y-k.y)*(F.x-k.x),l)._round():F.y<l&&(F=new st(k.x+(l-k.y)/(F.y-k.y)*(F.x-k.x),l)._round()),k.x>=d&&F.x>=d||(k.x>=d?k=new st(d,k.y+(d-k.x)/(F.x-k.x)*(F.y-k.y))._round():F.x>=d&&(F=new st(d,k.y+(d-k.x)/(F.x-k.x)*(F.y-k.y))._round()),k.y>=p&&F.y>=p||(k.y>=p?k=new st(k.x+(p-k.y)/(F.y-k.y)*(F.x-k.x),p)._round():F.y>=p&&(F=new st(k.x+(p-k.y)/(F.y-k.y)*(F.x-k.x),p)._round()),T&&k.equals(T[T.length-1])||(T=[k],_.push(T)),T.push(F)))))}}return _}Nt(Pc,"Anchor");const Tf=1e20;function Cv(a,o,l,d,p,_,b,w,T){for(let I=o;I<o+d;I++)Uo(a,l*_+I,_,p,b,w,T);for(let I=l;I<l+p;I++)Uo(a,I*_+o,1,d,b,w,T)}function Uo(a,o,l,d,p,_,b){_[0]=0,b[0]=-Tf,b[1]=Tf,p[0]=a[o];for(let w=1,T=0,I=0;w<d;w++){p[w]=a[o+w*l];const k=w*w;do{const F=_[T];I=(p[w]-p[F]+k-F*F)/(w-F)/2}while(I<=b[T]&&--T>-1);T++,_[T]=w,b[T]=I,b[T+1]=Tf}for(let w=0,T=0;w<d;w++){for(;b[T+1]<w;)T++;const I=_[T],k=w-I;a[o+w*l]=p[I]+k*k}}const Tv={none:0,ideographs:1,all:2};class md{constructor(o,l,d){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=d,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o){this.url=o}getGlyphs(o,l){const d=[];for(const p in o)for(const _ of o[p])d.push({stack:p,id:_});Do(d,({stack:p,id:_},b)=>{let w=this.entries[p];w||(w=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=w.glyphs[_];if(void 0!==T)return void b(null,{stack:p,id:_,glyph:T});if(T=this._tinySDF(w,p,_),T)return w.glyphs[_]=T,void b(null,{stack:p,id:_,glyph:T});const I=Math.floor(_/256);if(256*I>65535)return void b(new Error("glyphs > 65535 not supported"));if(w.ranges[I])return void b(null,{stack:p,id:_,glyph:T});let k=w.requests[I];k||(k=w.requests[I]=[],md.loadGlyphRange(p,I,this.url,this.requestManager,(F,N)=>{if(N){w.ascender=N.ascender,w.descender=N.descender;for(const V in N.glyphs)this._doesCharSupportLocalGlyph(+V)||(w.glyphs[+V]=N.glyphs[+V]);w.ranges[I]=!0}for(const V of k)V(F,N);delete w.requests[I]})),k.push((F,N)=>{F?b(F):N&&b(null,{stack:p,id:_,glyph:N.glyphs[_]||null})})},(p,_)=>{if(p)l(p);else if(_){const b={};for(const{stack:w,id:T,glyph:I}of _)void 0===b[w]&&(b[w]={}),void 0===b[w].glyphs&&(b[w].glyphs={}),b[w].glyphs[T]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},b[w].ascender=this.entries[w].ascender,b[w].descender=this.entries[w].descender;l(null,b)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==Tv.none&&(this.localGlyphMode===Tv.all?!!this.localFontFamily:!!this.localFontFamily&&(ef(o)||hg(o)||xc(o)||Jo(o)||rd(o)))}_tinySDF(o,l,d){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(d))return;let _=o.tinySDF;if(!_){let G="400";/bold/i.test(l)?G="900":/medium/i.test(l)?G="500":/light/i.test(l)&&(G="200"),_=o.tinySDF=new md.TinySDF({fontFamily:p,fontWeight:G,fontSize:48,buffer:6,radius:16}),_.fontWeight=G}if(this.localGlyphs[_.fontWeight][d])return this.localGlyphs[_.fontWeight][d];const b=String.fromCharCode(d),{data:w,width:T,height:I,glyphWidth:k,glyphHeight:F,glyphLeft:N,glyphTop:V,glyphAdvance:U}=_.draw(b);return this.localGlyphs[_.fontWeight][d]={id:d,bitmap:new gl({width:T,height:I},w),metrics:{width:k/2,height:F/2,left:N/2,top:V/2-27,advance:U/2,localGlyph:!0}}}}function Yg(a,o,l,d){const p=[],_=a.image,b=_.pixelRatio,w=_.paddedRect.w-2,T=_.paddedRect.h-2,I=a.right-a.left,k=a.bottom-a.top,F=_.stretchX||[[0,w]],N=_.stretchY||[[0,T]],V=(je,Xe)=>je+Xe[1]-Xe[0],U=F.reduce(V,0),G=N.reduce(V,0),Q=w-U,ae=T-G;let ge=0,se=U,he=0,ve=G,me=0,Be=Q,Fe=0,Ze=ae;if(_.content&&d){const je=_.content;ge=Kg(F,0,je[0]),he=Kg(N,0,je[1]),se=Kg(F,je[0],je[2]),ve=Kg(N,je[1],je[3]),me=je[0]-ge,Fe=je[1]-he,Be=je[2]-je[0]-se,Ze=je[3]-je[1]-ve}const dt=(je,Xe,it,ut)=>{const pt=Iv(je.stretch-ge,se,I,a.left),Ge=Dv(je.fixed-me,Be,je.stretch,U),wt=Iv(Xe.stretch-he,ve,k,a.top),en=Dv(Xe.fixed-Fe,Ze,Xe.stretch,G),Dt=Iv(it.stretch-ge,se,I,a.left),Ut=Dv(it.fixed-me,Be,it.stretch,U),It=Iv(ut.stretch-he,ve,k,a.top),ln=Dv(ut.fixed-Fe,Ze,ut.stretch,G),Gn=new st(pt,wt),Un=new st(Dt,wt),Ln=new st(Dt,It),un=new st(pt,It),Ai=new st(Ge/b,en/b),bn=new st(Ut/b,ln/b),qn=o*Math.PI/180;if(qn){const Zi=Math.sin(qn),Ji=Math.cos(qn),sn=[Ji,-Zi,Zi,Ji];Gn._matMult(sn),Un._matMult(sn),un._matMult(sn),Ln._matMult(sn)}const Bi=je.stretch+je.fixed,Zn=Xe.stretch+Xe.fixed;return{tl:Gn,tr:Un,bl:un,br:Ln,tex:{x:_.paddedRect.x+1+Bi,y:_.paddedRect.y+1+Zn,w:it.stretch+it.fixed-Bi,h:ut.stretch+ut.fixed-Zn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ai,pixelOffsetBR:bn,minFontScaleX:Be/b/I,minFontScaleY:Ze/b/k,isSDF:l}};if(d&&(_.stretchX||_.stretchY)){const je=aI(F,Q,U),Xe=aI(N,ae,G);for(let it=0;it<je.length-1;it++){const ut=je[it],pt=je[it+1];for(let Ge=0;Ge<Xe.length-1;Ge++)p.push(dt(ut,Xe[Ge],pt,Xe[Ge+1]))}}else p.push(dt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return p}function Kg(a,o,l){let d=0;for(const p of a)d+=Math.max(o,Math.min(l,p[1]))-Math.max(o,Math.min(l,p[0]));return d}function aI(a,o,l){const d=[{fixed:-1,stretch:0}];for(const[p,_]of a){const b=d[d.length-1];d.push({fixed:p-b.stretch,stretch:b.stretch}),d.push({fixed:p-b.stretch,stretch:b.stretch+(_-p)})}return d.push({fixed:o+1,stretch:l}),d}function Iv(a,o,l,d){return a/o*l+d}function Dv(a,o,l,d){return a-o*l/d}function lI(a,o,l,d){const p=o+a.positionedLines[d].lineOffset;return 0===d?l+p/2:l+(p+(o+a.positionedLines[d-1].lineOffset))/2}md.loadGlyphRange=function(a,o,l,d,p){const _=256*o,b=_+255,w=d.transformRequest(d.normalizeGlyphsURL(l).replace("{fontstack}",a).replace("{range}",`${_}-${b}`),qc.Glyphs);Ml(w,(T,I)=>{if(T)p(T);else if(I){const k={},F=new qp(I).readFields(WO,{});for(const N of F.glyphs)k[N.id]=N;p(null,{glyphs:k,ascender:F.ascender,descender:F.descender})}})},md.TinySDF=class{constructor({fontSize:a=24,buffer:o=3,radius:l=8,cutoff:d=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:b="normal"}={}){this.buffer=o,this.cutoff=d,this.radius=l;const w=this.size=a+4*o,T=this._createCanvas(w),I=this.ctx=T.getContext("2d",{willReadFrequently:!0});I.font=`${b} ${_} ${a}px ${p}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(a){const o=document.createElement("canvas");return o.width=o.height=a,o}draw(a){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:d,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(a),b=Math.ceil(l),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-p))),T=Math.min(this.size-this.buffer,b+Math.ceil(d)),I=w+2*this.buffer,k=T+2*this.buffer,F=Math.max(I*k,0),N=new Uint8ClampedArray(F),V={data:N,width:I,height:k,glyphWidth:w,glyphHeight:T,glyphTop:b,glyphLeft:0,glyphAdvance:o};if(0===w||0===T)return V;const{ctx:U,buffer:G,gridInner:Q,gridOuter:ae}=this;U.clearRect(G,G,w,T),U.fillText(a,G,G+b);const ge=U.getImageData(G,G,w,T);ae.fill(Tf,0,F),Q.fill(0,0,F);for(let se=0;se<T;se++)for(let he=0;he<w;he++){const ve=ge.data[4*(se*w+he)+3]/255;if(0===ve)continue;const me=(se+G)*I+he+G;if(1===ve)ae[me]=0,Q[me]=Tf;else{const Be=.5-ve;ae[me]=Be>0?Be*Be:0,Q[me]=Be<0?Be*Be:0}}Cv(ae,0,0,I,k,I,this.f,this.v,this.z),Cv(Q,G,G,w,T,I,this.f,this.v,this.z);for(let se=0;se<F;se++){const he=Math.sqrt(ae[se])-Math.sqrt(Q[se]);N[se]=Math.round(255-255*(he/this.radius+this.cutoff))}return V}};class lw{constructor(o=[],l=qO){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(o){this.data.push(o),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const o=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:d}=this,p=l[o];for(;o>0;){const _=o-1>>1,b=l[_];if(d(p,b)>=0)break;l[o]=b,o=_}l[o]=p}_down(o){const{data:l,compare:d}=this,p=this.length>>1,_=l[o];for(;o<p;){let b=1+(o<<1),w=l[b];const T=b+1;if(T<this.length&&d(l[T],w)<0&&(b=T,w=l[T]),d(w,_)>=0)break;l[o]=w,o=b}l[o]=_}}function qO(a,o){return a<o?-1:a>o?1:0}function cI(a,o=1,l=!1){let d=1/0,p=1/0,_=-1/0,b=-1/0;const w=a[0];for(let V=0;V<w.length;V++){const U=w[V];(!V||U.x<d)&&(d=U.x),(!V||U.y<p)&&(p=U.y),(!V||U.x>_)&&(_=U.x),(!V||U.y>b)&&(b=U.y)}const T=Math.min(_-d,b-p);let I=T/2;const k=new lw([],If);if(0===T)return new st(d,p);for(let V=d;V<_;V+=T)for(let U=p;U<b;U+=T)k.push(new Df(V+I,U+I,I,a));let F=function(V){let U=0,G=0,Q=0;const ae=V[0];for(let ge=0,se=ae.length,he=se-1;ge<se;he=ge++){const ve=ae[ge],me=ae[he],Be=ve.x*me.y-me.x*ve.y;G+=(ve.x+me.x)*Be,Q+=(ve.y+me.y)*Be,U+=3*Be}return new Df(G/U,Q/U,0,V)}(a),N=k.length;for(;k.length;){const V=k.pop();(V.d>F.d||!F.d)&&(F=V,l&&console.log("found best %d after %d probes",Math.round(1e4*V.d)/1e4,N)),V.max-F.d<=o||(I=V.h/2,k.push(new Df(V.p.x-I,V.p.y-I,I,a)),k.push(new Df(V.p.x+I,V.p.y-I,I,a)),k.push(new Df(V.p.x-I,V.p.y+I,I,a)),k.push(new Df(V.p.x+I,V.p.y+I,I,a)),N+=4)}return l&&(console.log(`num probes: ${N}`),console.log(`best distance: ${F.d}`)),F.p}function If(a,o){return o.max-a.max}class Df{constructor(o,l,d,p){this.p=new st(o,l),this.h=d,this.d=function(_,b){let w=!1,T=1/0;for(let I=0;I<b.length;I++){const k=b[I];for(let F=0,N=k.length,V=N-1;F<N;V=F++){const U=k[F],G=k[V];U.y>_.y!=G.y>_.y&&_.x<(G.x-U.x)*(_.y-U.y)/(G.y-U.y)+U.x&&(w=!w),T=Math.min(T,wx(_,U,G))}}return(w?1:-1)*Math.sqrt(T)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const Xg=Number.POSITIVE_INFINITY,Qg=Math.sqrt(2);function cw(a,[o,l]){let d=0,p=0;if(l===Xg){o<0&&(o=0);const _=o/Qg;switch(a){case"top-right":case"top-left":p=_-7;break;case"bottom-right":case"bottom-left":p=7-_;break;case"bottom":p=7-o;break;case"top":p=o-7}switch(a){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=o;break;case"right":d=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),a){case"top-right":case"top-left":case"top":p=l-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-l}switch(a){case"top-right":case"bottom-right":case"right":d=-o;break;case"top-left":case"bottom-left":case"left":d=o}}return[d,p]}function uw(a,o,l,d,p,_,b,w,T,I){a.createArrays(),a.tilePixelRatio=gn/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const k=a.layers[0].layout,F=a.layers[0]._unevaluatedLayout._values,N={};if("composite"===a.textSizeData.kind){const{minZoom:G,maxZoom:Q}=a.textSizeData;N.compositeTextSizes=[F["text-size"].possiblyEvaluate(new Ae(G),w),F["text-size"].possiblyEvaluate(new Ae(Q),w)]}if("composite"===a.iconSizeData.kind){const{minZoom:G,maxZoom:Q}=a.iconSizeData;N.compositeIconSizes=[F["icon-size"].possiblyEvaluate(new Ae(G),w),F["icon-size"].possiblyEvaluate(new Ae(Q),w)]}N.layoutTextSize=F["text-size"].possiblyEvaluate(new Ae(T+1),w),N.layoutIconSize=F["icon-size"].possiblyEvaluate(new Ae(T+1),w),N.textMaxSize=F["text-size"].possiblyEvaluate(new Ae(18),w);const V="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),U=k.get("text-size");for(const G of a.features){const Q=k.get("text-font").evaluate(G,{},w).join(","),ae=U.evaluate(G,{},w),ge=N.layoutTextSize.evaluate(G,{},w),se=(N.layoutIconSize.evaluate(G,{},w),{horizontal:{},vertical:void 0}),he=G.text;let ve,me=[0,0];if(he){const Ze=he.toString(),dt=k.get("text-letter-spacing").evaluate(G,{},w)*ns,je=k.get("text-line-height").evaluate(G,{},w)*ns,Xe=E(Ze)?dt:0,it=k.get("text-anchor").evaluate(G,{},w),ut=k.get("text-variable-anchor");if(!ut){const Dt=k.get("text-radial-offset").evaluate(G,{},w);me=Dt?cw(it,[Dt*ns,Xg]):k.get("text-offset").evaluate(G,{},w).map(Ut=>Ut*ns)}let pt=V?"center":k.get("text-justify").evaluate(G,{},w);const Ge="point"===k.get("symbol-placement"),wt=Ge?k.get("text-max-width").evaluate(G,{},w)*ns:1/0,en=Dt=>{a.allowVerticalPlacement&&x(Ze)&&(se.vertical=qg(he,o,l,p,Q,wt,je,it,Dt,Xe,me,Ma.vertical,!0,ge,ae))};if(!V&&ut){const Dt="auto"===pt?ut.map(It=>Sv(It)):[pt];let Ut=!1;for(let It=0;It<Dt.length;It++){const ln=Dt[It];if(!se.horizontal[ln])if(Ut)se.horizontal[ln]=se.horizontal[0];else{const Gn=qg(he,o,l,p,Q,wt,je,"center",ln,Xe,me,Ma.horizontal,!1,ge,ae);Gn&&(se.horizontal[ln]=Gn,Ut=1===Gn.positionedLines.length)}}en("left")}else{if("auto"===pt&&(pt=Sv(it)),Ge||k.get("text-writing-mode").indexOf("horizontal")>=0||!x(Ze)){const Dt=qg(he,o,l,p,Q,wt,je,it,pt,Xe,me,Ma.horizontal,!1,ge,ae);Dt&&(se.horizontal[pt]=Dt)}en(Ge?"left":pt)}}let Be=!1;if(G.icon&&G.icon.name){const Ze=d[G.icon.name];Ze&&(ve=oi(p[G.icon.name],k.get("icon-offset").evaluate(G,{},w),k.get("icon-anchor").evaluate(G,{},w)),Be=Ze.sdf,void 0===a.sdfIcons?a.sdfIcons=Ze.sdf:a.sdfIcons!==Ze.sdf&&ni("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ze.pixelRatio!==a.pixelRatio||0!==k.get("icon-rotate").constantOr(1))&&(a.iconsNeedLinear=!0))}const Fe=hw(se.horizontal)||se.vertical;a.iconsInText||(a.iconsInText=!!Fe&&Fe.iconsInText),(Fe||ve)&&uI(a,G,se,ve,d,N,ge,0,me,Be,b,w,I)}_&&a.generateCollisionDebugBuffers(T,a.collisionBoxArray)}function Sv(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function uI(a,o,l,d,p,_,b,w,T,I,k,F,N){let V=_.textMaxSize.evaluate(o,{},F);void 0===V&&(V=b);const U=a.layers[0].layout,G=U.get("icon-offset").evaluate(o,{},F),Q=hw(l.horizontal)||l.vertical,ae="globe"===N.name,ge=b/24,se=a.tilePixelRatio*V/24,he=(Xe=a.overscaling,a.zoom>18&&Xe>2&&(Xe>>=1),Math.max(gn/(512*Xe),1)*U.get("symbol-spacing")),ve=U.get("text-padding")*a.tilePixelRatio,me=U.get("icon-padding")*a.tilePixelRatio,Be=vt(U.get("text-max-angle")),Fe="map"===U.get("text-rotation-alignment")&&"point"!==U.get("symbol-placement"),Ze="map"===U.get("icon-rotation-alignment")&&"point"!==U.get("symbol-placement"),dt=U.get("symbol-placement"),je=he/2;var Xe;const it=U.get("icon-text-fit");let ut;d&&"none"!==it&&(a.allowVerticalPlacement&&l.vertical&&(ut=wv(d,l.vertical,it,U.get("icon-text-fit-padding"),G,ge)),Q&&(d=wv(d,Q,it,U.get("icon-text-fit-padding"),G,ge)));const pt=(Ge,wt,en)=>{if(wt.x<0||wt.x>=gn||wt.y<0||wt.y>=gn)return;let Dt=null;if(ae){const{x:Ut,y:It,z:ln}=N.projectTilePoint(wt.x,wt.y,en);Dt={anchor:new Pc(Ut,It,ln,0,void 0),up:N.upVector(en,wt.x,wt.y)}}!function(Ut,It,ln,Gn,Un,Ln,un,Ai,bn,qn,Bi,Zn,Zi,Ji,sn,sr,Eo,pe,be,St,fi,tr,Or,Pi,vr){const Xr=Ut.addToLineVertexArray(It,Gn);let uo,Qr,$t,ho,Mu,hh,Rf,Pf=0,Qv=0,kw=0,Jv=0,c_=-1,Of=-1;const xl={};let eb=ll("");const vd=ln?ln.anchor:It;let u_=0,d_=0;if(void 0===bn._unevaluatedLayout.getValue("text-radial-offset")?[u_,d_]=bn.layout.get("text-offset").evaluate(fi,{},vr).map(Zs=>Zs*ns):(u_=bn.layout.get("text-radial-offset").evaluate(fi,{},vr)*ns,d_=Xg),Ut.allowVerticalPlacement&&Un.vertical){const Zs=Un.vertical;if(sn)hh=Av(Zs),Ai&&(Rf=Av(Ai));else{const rs=bn.layout.get("text-rotate").evaluate(fi,{},vr)+90;$t=Kp(qn,vd,It,Bi,Zn,Zi,Zs,Ji,rs,sr),Ai&&(ho=Kp(qn,vd,It,Bi,Zn,Zi,Ai,pe,rs))}}if(Ln){const Zs=bn.layout.get("icon-rotate").evaluate(fi,{},vr),rs="none"!==bn.layout.get("icon-text-fit"),wl=Yg(Ln,Zs,Or,rs),tb=Ai?Yg(Ai,Zs,Or,rs):void 0;Qr=Kp(qn,vd,It,Bi,Zn,Zi,Ln,pe,Zs),Pf=4*wl.length;const Pw=Ut.iconSizeData;let Ru=null;"source"===Pw.kind?(Ru=[Rc*bn.layout.get("icon-size").evaluate(fi,{},vr)],Ru[0]>gd&&ni(`${Ut.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Pw.kind&&(Ru=[Rc*tr.compositeIconSizes[0].evaluate(fi,{},vr),Rc*tr.compositeIconSizes[1].evaluate(fi,{},vr)],(Ru[0]>gd||Ru[1]>gd)&&ni(`${Ut.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ut.addSymbols(Ut.icon,wl,Ru,St,be,fi,!1,ln,It,Xr.lineStartIndex,Xr.lineLength,-1,Pi,vr),c_=Ut.icon.placedSymbolArray.length-1,tb&&(Qv=4*tb.length,Ut.addSymbols(Ut.icon,tb,Ru,St,be,fi,Ma.vertical,ln,It,Xr.lineStartIndex,Xr.lineLength,-1,Pi,vr),Of=Ut.icon.placedSymbolArray.length-1)}for(const Zs in Un.horizontal){const rs=Un.horizontal[Zs];uo||(eb=ll(rs.text),sn?Mu=Av(rs):uo=Kp(qn,vd,It,Bi,Zn,Zi,rs,Ji,bn.layout.get("text-rotate").evaluate(fi,{},vr),sr));const wl=1===rs.positionedLines.length;if(kw+=dw(Ut,ln,It,rs,un,bn,sn,fi,sr,Xr,Un.vertical?Ma.horizontal:Ma.horizontalOnly,wl?Object.keys(Un.horizontal):[Zs],xl,c_,tr,Pi,vr),wl)break}Un.vertical&&(Jv+=dw(Ut,ln,It,Un.vertical,un,bn,sn,fi,sr,Xr,Ma.vertical,["vertical"],xl,Of,tr,Pi,vr));let ku=-1;const h_=(Zs,rs)=>Zs?Math.max(Zs,rs):rs;ku=h_(Mu,ku),ku=h_(hh,ku),ku=h_(Rf,ku);const Rw=ku>-1?1:0;Ut.glyphOffsetArray.length>=_d.MAX_GLYPHS&&ni("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==fi.sortKey&&Ut.addToSortKeyRanges(Ut.symbolInstances.length,fi.sortKey),Ut.symbolInstances.emplaceBack(vd.x,vd.y,vd.z,It.x,It.y,xl.right>=0?xl.right:-1,xl.center>=0?xl.center:-1,xl.left>=0?xl.left:-1,xl.vertical>=0?xl.vertical:-1,c_,Of,eb,void 0!==uo?uo:Ut.collisionBoxArray.length,void 0!==uo?uo+1:Ut.collisionBoxArray.length,void 0!==$t?$t:Ut.collisionBoxArray.length,void 0!==$t?$t+1:Ut.collisionBoxArray.length,void 0!==Qr?Qr:Ut.collisionBoxArray.length,void 0!==Qr?Qr+1:Ut.collisionBoxArray.length,ho||Ut.collisionBoxArray.length,ho?ho+1:Ut.collisionBoxArray.length,Bi,kw,Jv,Pf,Qv,Rw,0,u_,d_,ku)}(a,wt,Dt,Ge,l,d,p,ut,a.layers[0],a.collisionBoxArray,o.index,o.sourceLayerIndex,a.index,ve,Fe,T,0,me,Ze,G,o,_,I,k,F)};if("line"===dt)for(const Ge of sI(o.geometry,0,0,gn,gn)){const wt=oI(Ge,he,Be,l.vertical||Q,d,24,se,a.overscaling,gn);for(const en of wt)Q&&fw(a,Q.text,je,en)||pt(Ge,en,F)}else if("line-center"===dt){for(const Ge of o.geometry)if(Ge.length>1){const wt=sw(Ge,Be,l.vertical||Q,d,24,se);wt&&pt(Ge,wt,F)}}else if("Polygon"===o.type)for(const Ge of Rg(o.geometry,0)){const wt=cI(Ge,16);pt(Ge[0],new Pc(wt.x,wt.y,0,0,void 0),F)}else if("LineString"===o.type)for(const Ge of o.geometry)pt(Ge,new Pc(Ge[0].x,Ge[0].y,0,0,void 0),F);else if("Point"===o.type)for(const Ge of o.geometry)for(const wt of Ge)pt([wt],new Pc(wt.x,wt.y,0,0,void 0),F)}const gd=32640;function dw(a,o,l,d,p,_,b,w,T,I,k,F,N,V,U,G,Q){const ae=function(he,ve,me,Be,Fe,Ze,dt,je){const Xe=[];if(0===ve.positionedLines.length)return Xe;const it=Be.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,ut=function(Dt){const Ut=Dt[0],It=Dt[1],ln=Ut*It;return ln>0?[Ut,-It]:ln<0?[-Ut,It]:0===Ut?[It,Ut]:[It,-Ut]}(me);let pt=Math.abs(ve.top-ve.bottom);for(const Dt of ve.positionedLines)pt-=Dt.lineOffset;const Ge=ve.positionedLines.length,wt=pt/Ge;let en=ve.top-me[1];for(let Dt=0;Dt<Ge;++Dt){const Ut=ve.positionedLines[Dt];en=lI(ve,wt,en,Dt);for(const It of Ut.positionedGlyphs){if(!It.rect)continue;const ln=It.rect||{};let Gn=4,Un=!0,Ln=1,un=0;if(It.imageName){const Pi=dt[It.imageName];if(!Pi)continue;if(Pi.sdf){ni("SDF images are not supported in formatted text and will be ignored.");continue}Un=!1,Ln=Pi.pixelRatio,Gn=1/Ln}const Ai=(Fe||je)&&It.vertical,bn=It.metrics.advance*It.scale/2,qn=It.metrics,Bi=It.rect;if(null===Bi)continue;je&&ve.verticalizable&&(un=It.imageName?bn-It.metrics.width*It.scale/2:0);const Zn=Fe?[It.x+bn,It.y]:[0,0];let Zi=[0,0],Ji=[0,0],sn=!1;Fe||(Ai?(Ji=[It.x+bn+ut[0],It.y+ut[1]-un],sn=!0):Zi=[It.x+bn+me[0],It.y+me[1]-un]);const sr=Bi.w*It.scale/(Ln*(It.localGlyph?2:1)),Eo=Bi.h*It.scale/(Ln*(It.localGlyph?2:1));let pe,be,St,fi;if(Ai){const Pi=It.y-en,vr=new st(-bn,bn-Pi),Xr=-Math.PI/2,uo=new st(...Ji);pe=new st(-bn+Zi[0],Zi[1]),pe._rotateAround(Xr,vr)._add(uo),pe.x+=-Pi+bn,pe.y-=(qn.left-Gn)*It.scale;const Qr=It.imageName?qn.advance*It.scale:ns*It.scale,$t=String.fromCharCode(It.glyph);Cu($t)?pe.x+=(1-Gn)*It.scale:KT($t)?pe.x+=Qr-qn.height*It.scale+(-Gn-1)*It.scale:pe.x+=It.imageName||qn.width+2*Gn===Bi.w&&qn.height+2*Gn===Bi.h?(Qr-Eo)/2:(Qr-(qn.height+2*Gn)*It.scale)/2,be=new st(pe.x,pe.y-sr),St=new st(pe.x+Eo,pe.y),fi=new st(pe.x+Eo,pe.y-sr)}else{const Pi=(qn.left-Gn)*It.scale-bn+Zi[0],vr=(-qn.top-Gn)*It.scale+Zi[1],Xr=Pi+sr,uo=vr+Eo;pe=new st(Pi,vr),be=new st(Xr,vr),St=new st(Pi,uo),fi=new st(Xr,uo)}if(it){let Pi;Pi=Fe?new st(0,0):sn?new st(ut[0],ut[1]):new st(me[0],me[1]),pe._rotateAround(it,Pi),be._rotateAround(it,Pi),St._rotateAround(it,Pi),fi._rotateAround(it,Pi)}const tr=new st(0,0),Or=new st(0,0);Xe.push({tl:pe,tr:be,bl:St,br:fi,tex:ln,writingMode:ve.writingMode,glyphOffset:Zn,sectionIndex:It.sectionIndex,isSDF:Un,pixelOffsetTL:tr,pixelOffsetBR:Or,minFontScaleX:0,minFontScaleY:0})}}return Xe}(0,d,T,_,b,w,p,a.allowVerticalPlacement),ge=a.textSizeData;let se=null;"source"===ge.kind?(se=[Rc*_.layout.get("text-size").evaluate(w,{},Q)],se[0]>gd&&ni(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ge.kind&&(se=[Rc*U.compositeTextSizes[0].evaluate(w,{},Q),Rc*U.compositeTextSizes[1].evaluate(w,{},Q)],(se[0]>gd||se[1]>gd)&&ni(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,ae,se,T,b,w,k,o,l,I.lineStartIndex,I.lineLength,V,G,Q);for(const he of F)N[he]=a.text.placedSymbolArray.length-1;return 4*ae.length}function hw(a){for(const o in a)return a[o];return null}function Kp(a,o,l,d,p,_,b,w,T,I){let k=b.top,F=b.bottom,N=b.left,V=b.right;const U=b.collisionPadding;if(U&&(N-=U[0],k-=U[1],V+=U[2],F+=U[3]),T){const G=new st(N,k),Q=new st(V,k),ae=new st(N,F),ge=new st(V,F),se=vt(T);let he=new st(0,0);I&&(he=new st(I[0],I[1])),G._rotateAround(se,he),Q._rotateAround(se,he),ae._rotateAround(se,he),ge._rotateAround(se,he),N=Math.min(G.x,Q.x,ae.x,ge.x),V=Math.max(G.x,Q.x,ae.x,ge.x),k=Math.min(G.y,Q.y,ae.y,ge.y),F=Math.max(G.y,Q.y,ae.y,ge.y)}return a.emplaceBack(o.x,o.y,o.z,l.x,l.y,N,k,V,F,w,d,p,_),a.length-1}function Av(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const o=a.bottom-a.top;return o>0?Math.max(10,o):null}function fw(a,o,l,d){const p=a.compareText;if(o in p){const _=p[o];for(let b=_.length-1;b>=0;b--)if(d.dist(_[b])<l)return!0}else p[o]=[];return p[o].push(d),!1}function Mv(a,o){const l=a.fovAboveCenter,d=a.elevation?a.elevation.getMinElevationBelowMSL()*o:0,p=(a._camera.position[2]*a.worldSize-d)/Math.cos(a._pitch),_=Math.sin(l)*p/Math.sin(Math.max(Math.PI/2-a._pitch-l,.01)),b=Math.sin(a._pitch)*_+p;return Math.min(1.01*b,p*(1/a._horizonShift))}function Du(a,o){if(!o.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:o};const l=Math.pow(2,-a.z),d=a.x*l,p=(a.x+1)*l,_=a.y*l,b=(a.y+1)*l,w=Bo(d),T=Bo(p),I=co(_),k=co(b),F=o.project(w,I),N=o.project(T,I),V=o.project(T,k),U=o.project(w,k);let G=Math.min(F.x,N.x,V.x,U.x),Q=Math.min(F.y,N.y,V.y,U.y),ae=Math.max(F.x,N.x,V.x,U.x),ge=Math.max(F.y,N.y,V.y,U.y);const se=l/16;function he(me,Be,Fe,Ze,dt,je){const Xe=(Fe+dt)/2,it=(Ze+je)/2,ut=o.project(Bo(Xe),co(it)),pt=Math.max(0,G-ut.x,Q-ut.y,ut.x-ae,ut.y-ge);G=Math.min(G,ut.x),ae=Math.max(ae,ut.x),Q=Math.min(Q,ut.y),ge=Math.max(ge,ut.y),pt>se&&(he(me,ut,Fe,Ze,Xe,it),he(ut,Be,Xe,it,dt,je))}he(F,N,d,_,p,_),he(N,V,p,_,p,b),he(V,U,p,b,d,b),he(U,F,d,b,d,_),G-=se,Q-=se,ae+=se,ge+=se;const ve=1/Math.max(ae-G,ge-Q);return{scale:ve,x:G*ve,y:Q*ve,x2:ae*ve,y2:ge*ve,projection:o}}const ZO=Sa(new Float32Array(16));class Oc{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new li(0,0)}projectTilePoint(o,l,d){return{x:o,y:l,z:0}}locationPoint(o,l,d=!0){return o._coordinatePoint(o.locationCoordinate(l),d)}pixelsPerMeter(o,l){return ml(1,o)*l}pixelSpaceConversion(o,l,d){return 1}farthestPixelDistance(o){return Mv(o,o.pixelsPerMeter)}pointCoordinate(o,l,d,p){const _=o.horizonLineFromTop(!1),b=new st(l,Math.max(_,d));return o.rayIntersectionCoordinate(o.pointRayIntersection(b,p))}pointCoordinate3D(o,l,d){const p=new st(l,d);if(o.elevation)return o.elevation.pointCoordinate(p);{const _=this.pointCoordinate(o,p.x,p.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(o,l){if(o.elevation)return!this.pointCoordinate3D(o,l.x,l.y);const d=o.horizonLineFromTop();return l.y<d}createInversionMatrix(o,l){return ZO}createTileMatrix(o,l,d){let p,_,b;const w=d.canonical,T=Sa(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=Du(w,this);p=1,_=I.x+d.wrap*I.scale,b=I.y,dd(T,T,[p/I.scale,p/I.scale,o.pixelsPerMeter/l])}else p=l/o.zoomScale(w.z),_=(w.x+Math.pow(2,w.z)*d.wrap)*p,b=w.y*p;return or(T,T,[_,b,0]),dd(T,T,[p/gn,p/gn,1]),T}upVector(o,l,d){return[0,0,1]}upVectorScale(o,l,d){return{metersToTile:1}}}class dI extends Oc{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,d]=this.parallels=o.parallels||[29.5,45.5],p=Math.sin(vt(l));this.n=(p+Math.sin(vt(d)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:d,c:p,r0:_}=this,b=vt(o-this.center[0]),w=vt(l),T=Math.sqrt(p-2*d*Math.sin(w))/d;return{x:T*Math.sin(b*d),y:T*Math.cos(b*d)-_,z:0}}unproject(o,l){const{n:d,c:p,r0:_}=this,b=_+l;let w=Math.atan2(o,Math.abs(b))*Math.sign(b);b*d<0&&(w-=Math.PI*Math.sign(o)*Math.sign(b));const T=vt(this.center[0])*d;w=Lr(w,-Math.PI-T,Math.PI-T);const I=_n(yn(w/d)+this.center[0],-180,180),k=Math.asin(_n((p-(o*o+b*b)*d*d)/(2*d),-1,1)),F=_n(yn(k),-zo,zo);return new li(I,F)}}const Jg=1.340264,nt=-.081106,ch=893e-6,Xp=.003796,Qp=Math.sqrt(3)/2;class hI extends Oc{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const d=Math.asin(Qp*Math.sin(l)),p=d*d,_=p*p*p;return{x:.5*(o*Math.cos(d)/(Qp*(Jg+3*nt*p+_*(7*ch+9*Xp*p)))/Math.PI+.5),y:1-.5*(d*(Jg+nt*p+_*(ch+Xp*p))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=d*d,_=p*p*p;for(let k,F,N,V=0;V<12&&(F=d*(Jg+nt*p+_*(ch+Xp*p))-l,N=Jg+3*nt*p+_*(7*ch+9*Xp*p),k=F/N,d=_n(d-k,-Math.PI/3,Math.PI/3),p=d*d,_=p*p*p,!(Math.abs(k)<1e-12));++V);const b=Qp*o*(Jg+3*nt*p+_*(7*ch+9*Xp*p))/Math.cos(d),w=Math.asin(Math.sin(d)/Qp),T=_n(180*b/Math.PI,-180,180),I=_n(180*w/Math.PI,-zo,zo);return new li(T,I)}}class fI extends Oc{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const d=360*(o-.5),p=_n(360*(.5-l),-zo,zo);return new li(d,p)}}const Su=Math.PI/2;function Au(a){return Math.tan((Su+a)/2)}class kv extends Oc{constructor(o){super(o),this.center=o.center||[0,30];const[l,d]=this.parallels=o.parallels||[30,30];let p=vt(l),_=vt(d);this.southernCenter=p+_<0,this.southernCenter&&(p=-p,_=-_);const b=Math.cos(p),w=Au(p);this.n=p===_?Math.sin(p):Math.log(b/Math.cos(_))/Math.log(Au(_)/w),this.f=b*Math.pow(Au(p),this.n)/this.n}project(o,l){l=vt(l),this.southernCenter&&(l=-l),o=vt(o-this.center[0]);const d=1e-6,{n:p,f:_}=this;_>0?l<-Su+d&&(l=-Su+d):l>Su-d&&(l=Su-d);const b=_/Math.pow(Au(l),p);let w=b*Math.sin(p*o),T=_-b*Math.cos(p*o);return w=.5*(w/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:w,y:this.southernCenter?T:1-T,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:d,f:p}=this,_=p-l,b=Math.sign(_),w=Math.sign(d)*Math.sqrt(o*o+_*_);let T=Math.atan2(o,Math.abs(_))*b;_*d<0&&(T-=Math.PI*Math.sign(o)*b);const I=_n(yn(T/d)+this.center[0],-180,180),k=_n(yn(2*Math.atan(Math.pow(p/w,1/d))-Su),-zo,zo);return new li(I,this.southernCenter?-k:k)}}class Sf extends Oc{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:fl(o),y:pl(l),z:0}}unproject(o,l){const d=Bo(o),p=co(l);return new li(d,p)}}const e_=vt(zo);class t_ extends Oc{project(o,l){const d=(l=vt(l))*l,p=d*d;return{x:.5*((o=vt(o))*(.8707-.131979*d+p*(p*(.003971*d-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+d*(.015085+p*(.028874*d-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let d=l=(2*(1-l)-1)*Math.PI,p=25,_=0,b=d*d;do{b=d*d;const I=b*b;_=(d*(1.007226+b*(.015085+I*(.028874*b-.044475-.005916*I)))-l)/(1.007226+b*(.045255+I*(.259866*b-.311325-.005916*11*I))),d=_n(d-_,-e_,e_)}while(Math.abs(_)>1e-6&&--p>0);b=d*d;const w=_n(yn(o/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),T=yn(d);return new li(w,T)}}const Rv=vt(zo);class Pv extends Oc{project(o,l){l=vt(l),o=vt(o);const d=Math.cos(l),p=2/Math.PI,_=Math.acos(d*Math.cos(o/2)),b=Math.sin(_)/_,w=.5*(o*p+2*d*Math.sin(o/2)/b)||0,T=.5*(l+Math.sin(l)/b)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(o,l){let d=o=(2*o-.5)*Math.PI,p=l=(2*(1-l)-1)*Math.PI,_=25;const b=1e-6;let w=0,T=0;do{const I=Math.cos(p),k=Math.sin(p),F=2*k*I,N=k*k,V=I*I,U=Math.cos(d/2),G=Math.sin(d/2),Q=2*U*G,ae=G*G,ge=1-V*U*U,se=ge?1/ge:0,he=ge?Math.acos(I*U)*Math.sqrt(1/ge):0,ve=.5*(2*he*I*G+2*d/Math.PI)-o,me=.5*(he*k+p)-l,Be=.5*se*(V*ae+he*I*U*N)+1/Math.PI,Fe=se*(Q*F/4-he*k*G),Ze=.125*se*(F*G-he*k*V*Q),dt=.5*se*(N*U+he*ae*I)+.5,je=Fe*Ze-dt*Be;w=(me*Fe-ve*dt)/je,T=(ve*Ze-me*Be)/je,d=_n(d-w,-Math.PI,Math.PI),p=_n(p-T,-Rv,Rv)}while((Math.abs(w)>b||Math.abs(T)>b)&&--_>0);return new li(yn(d),yn(p))}}class n_ extends Oc{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(vt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:d,cosPhi:p}=this;return{x:vt(o)*p*d+.5,y:-Math.sin(vt(l))/p*d+.5,z:0}}unproject(o,l){const{scale:d,cosPhi:p}=this,_=-(l-.5)/d,b=_n(yn((o-.5)/d)/p,-180,180),w=Math.asin(_n(_*p,-1,1)),T=_n(yn(w),-zo,zo);return new li(b,T)}}class Ov extends Sf{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,d){const p=ff(o,l,d);return yr(p,p,pf(ql(d))),{x:p[0],y:p[1],z:p[2]}}locationPoint(o,l){const d=Dc(l.lat,l.lng),p=Ds([],d),_=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude;kp(d,d,p,ml(1,0)*gn*_);const b=Sa(new Float64Array(16));return Tc(b,o.pixelMatrix,o.globeMatrix),yr(d,d,b),new st(d[0],d[1])}pixelsPerMeter(o,l){return ml(1,0)*l}pixelSpaceConversion(o,l,d){const p=ml(1,o)*l,_=Vn(ml(1,45)*l,p,d);return this.pixelsPerMeter(o,l)/_}createTileMatrix(o,l,d){const p=Sy(ql(d.canonical));return Tc(new Float64Array(16),o.globeMatrix,p)}createInversionMatrix(o,l){const{center:d}=o,p=pf(ql(l));return mg(p,p,vt(d.lng)),Hl(p,p,vt(d.lat)),dd(p,p,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(o,l,d,p){return gx(o,l,d,!0)||new _f(0,0)}pointCoordinate3D(o,l,d){const p=this.pointCoordinate(o,l,d,0);return[p.x,p.y,p.z]}isPointAboveHorizon(o,l){return!gx(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(p,_){const b=p.cameraToCenterDistance,w=p._centerAltitude*_,T=p._camera,I=p._camera.forward(),k=Aa([],cl([],I,-b),[0,0,w]),F=p.worldSize/(2*Math.PI),N=[0,0,-F],V=p.width/p.height,U=Math.tan(p.fovAboveCenter),G=cl([],T.up(),U),Q=cl([],T.right(),U*V),ae=Ds([],Aa([],Aa([],I,G),Q)),ge=[];let se;if(new vg(k,ae).closestPointOnSphere(N,F,ge)){const he=Aa([],ge,N),ve=Ic([],he,k);se=Math.cos(p.fovAboveCenter)*Ap(ve)}else{const he=Ic([],k,N),ve=Ic([],N,k);Ds(ve,ve);const me=Ap(he)-F;se=Math.sqrt(me*(me+2*F));const Be=Math.acos(se/(F+me))-Math.acos(ul(I,ve));se*=Math.cos(Be)}return 1.01*se}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),d=mf(o.zoom);if(d>0){const p=Mv(o,ml(1,o.center.lat)*o.worldSize),_=o.worldSize/(2*Math.PI),b=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Vn(l,p+_*(1-Math.cos(b)),Math.pow(d,10))}return l}upVector(o,l,d){return ff(l,d,o,1)}upVectorScale(o){return{metersToTile:hf(Np(ql(o)))}}}function Fv(a){const o=a.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(a.name){case"mercator":return new Sf(a);case"equirectangular":return new fI(a);case"naturalEarth":return new t_(a);case"equalEarth":return new hI(a);case"winkelTripel":return new Pv(a);case"albers":return l?new n_(a):new dI(a);case"lambertConformalConic":return l?new n_(a):new kv(a);case"globe":return new Ov(a)}throw new Error(`Invalid projection name: ${a.name}`)}const Lv=Fg.types,pI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function i_(a,o,l,d,p,_,b,w,T,I,k,F,N){const V=w?Math.min(gd,Math.round(w[0])):0,U=w?Math.min(gd,Math.round(w[1])):0;a.emplaceBack(o,l,Math.round(32*d),Math.round(32*p),_,b,(V<<1)+(T?1:0),U,16*I,16*k,256*F,256*N)}function Jp(a,o,l,d,p,_,b){a.emplaceBack(o,l,d,p,_,b)}function r_(a,o,l,d,p){a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p),a.emplaceBack(o,l,d,p)}function pw(a){for(const o of a.sections)if($(o.text))return!0;return!1}class o_{constructor(o){this.layoutVertexArray=new ol,this.indexArray=new ao,this.programConfigurations=o,this.segments=new Cr,this.dynamicLayoutVertexArray=new Si,this.opacityVertexArray=new Ui,this.placedSymbolArray=new by,this.globeExtVertexArray=new Qi}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(o,l,d,p){this.isEmpty()||(d&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,WT.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,gv.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,pI,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,qT.members,!0)),this.opacityVertexBuffer.itemSize=1),(d||p)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Nt(o_,"SymbolBuffers");class Nv{constructor(o,l,d){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new d,this.segments=new Cr,this.collisionVertexArray=new ji,this.collisionVertexArrayExt=new wo}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,ZT.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,Hx.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Nt(Nv,"CollisionBuffers");class _d{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(b=>b.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Sa([]),this.placementViewportMatrix=Sa([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pd(this.zoom,l["text-size"]),this.iconSizeData=pd(this.zoom,l["icon-size"]);const d=this.layers[0].layout,p=d.get("symbol-sort-key"),_=d.get("symbol-z-order");this.canOverlap=d.get("text-allow-overlap")||d.get("icon-allow-overlap")||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=d.get("text-writing-mode").map(b=>Ma[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=o.sourceID,this.projection=o.projection}createArrays(){this.text=new o_(new Cc(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new o_(new Cc(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new No,this.lineVertexArray=new fg,this.symbolInstances=new rx}calculateGlyphDependencies(o,l,d,p,_){for(let b=0;b<o.length;b++)if(l[o.charCodeAt(b)]=!0,p&&_){const w=Eu[o.charAt(b)];w&&(l[w.charCodeAt(0)]=!0)}}populate(o,l,d,p){const _=this.layers[0],b=_.layout,w="globe"===this.projection.name,T=b.get("text-font"),I=b.get("text-field"),k=b.get("icon-image"),F=("constant"!==I.value.kind||I.value.value instanceof fr&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&("constant"!==T.value.kind||T.value.value.length>0),N="constant"!==k.value.kind||!!k.value.value||Object.keys(k.parameters).length>0,V=b.get("symbol-sort-key");if(this.features=[],!F&&!N)return;const U=l.iconDependencies,G=l.glyphDependencies,Q=l.availableImages,ae=new Ae(this.zoom);for(const{feature:ge,id:se,index:he,sourceLayerIndex:ve}of o){const me=_._featureFilter.needGeometry,Be=vu(ge,me);if(!_._featureFilter.filter(ae,Be,d))continue;if(me||(Be.geometry=Sc(ge,d,p)),w&&1!==ge.type&&d.z<=5){const je=Be.geometry,Xe=.98078528056,it=(ut,pt)=>ul(ff(ut.x,ut.y,d,1),ff(pt.x,pt.y,d,1))<Xe;for(let ut=0;ut<je.length;ut++)je[ut]=ST(je[ut],it)}let Fe,Ze;if(F){const je=_.getValueAndResolveTokens("text-field",Be,d,Q),Xe=fr.factory(je);pw(Xe)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===xe()||this.hasRTLText&&Ce.isParsed())&&(Fe=YT(Xe,_,Be))}if(N){const je=_.getValueAndResolveTokens("icon-image",Be,d,Q);Ze=je instanceof Mo?je:Mo.fromString(je)}if(!Fe&&!Ze)continue;const dt=this.sortFeaturesByKey?V.evaluate(Be,{},d):void 0;if(this.features.push({id:se,text:Fe,icon:Ze,index:he,sourceLayerIndex:ve,geometry:Be.geometry,properties:ge.properties,type:Lv[ge.type],sortKey:dt}),Ze&&(U[Ze.name]=!0),Fe){const je=T.evaluate(Be,{},d).join(","),Xe="map"===b.get("text-rotation-alignment")&&"point"!==b.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ma.vertical)>=0;for(const it of Fe.sections)if(it.image)U[it.image.name]=!0;else{const ut=x(Fe.toString()),pt=it.fontStack||je,Ge=G[pt]=G[pt]||{};this.calculateGlyphDependencies(it.text,Ge,Xe,this.allowVerticalPlacement,ut)}}}"line"===b.get("symbol-placement")&&(this.features=function(ge){const se={},he={},ve=[];let me=0;function Be(je){ve.push(ge[je]),me++}function Fe(je,Xe,it){const ut=he[je];return delete he[je],he[Xe]=ut,ve[ut].geometry[0].pop(),ve[ut].geometry[0]=ve[ut].geometry[0].concat(it[0]),ut}function Ze(je,Xe,it){const ut=se[Xe];return delete se[Xe],se[je]=ut,ve[ut].geometry[0].shift(),ve[ut].geometry[0]=it[0].concat(ve[ut].geometry[0]),ut}function dt(je,Xe,it){const ut=it?Xe[0][Xe[0].length-1]:Xe[0][0];return`${je}:${ut.x}:${ut.y}`}for(let je=0;je<ge.length;je++){const Xe=ge[je],it=Xe.geometry,ut=Xe.text?Xe.text.toString():null;if(!ut){Be(je);continue}const pt=dt(ut,it),Ge=dt(ut,it,!0);if(pt in he&&Ge in se&&he[pt]!==se[Ge]){const wt=Ze(pt,Ge,it),en=Fe(pt,Ge,ve[wt].geometry);delete se[pt],delete he[Ge],he[dt(ut,ve[en].geometry,!0)]=en,ve[wt].geometry=null}else pt in he?Fe(pt,Ge,it):Ge in se?Ze(pt,Ge,it):(Be(je),se[pt]=me-1,he[Ge]=me-1)}return ve.filter(je=>je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ge,se)=>ge.sortKey-se.sortKey)}update(o,l,d,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,l,this.layers,d,p),this.icon.programConfigurations.updatePaintArrays(o,l,this.layers,d,p))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Fv(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const d=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:p,y:_}of l)this.lineVertexArray.emplaceBack(p,_);return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(o,l,d,p,_,b,w,T,I,k,F,N,V,U){const G=o.indexArray,Q=o.layoutVertexArray,ae=o.globeExtVertexArray,ge=o.segments.prepareSegment(4*l.length,Q,G,this.canOverlap?b.sortKey:void 0),se=this.glyphOffsetArray.length,he=ge.vertexLength,ve=this.allowVerticalPlacement&&w===Ma.vertical?Math.PI/2:0,me=b.text&&b.text.sections;for(let Fe=0;Fe<l.length;Fe++){const{tl:Ze,tr:dt,bl:je,br:Xe,tex:it,pixelOffsetTL:ut,pixelOffsetBR:pt,minFontScaleX:Ge,minFontScaleY:wt,glyphOffset:en,isSDF:Dt,sectionIndex:Ut}=l[Fe],It=ge.vertexLength,ln=en[1];if(i_(Q,I.x,I.y,Ze.x,ln+Ze.y,it.x,it.y,d,Dt,ut.x,ut.y,Ge,wt),i_(Q,I.x,I.y,dt.x,ln+dt.y,it.x+it.w,it.y,d,Dt,pt.x,ut.y,Ge,wt),i_(Q,I.x,I.y,je.x,ln+je.y,it.x,it.y+it.h,d,Dt,ut.x,pt.y,Ge,wt),i_(Q,I.x,I.y,Xe.x,ln+Xe.y,it.x+it.w,it.y+it.h,d,Dt,pt.x,pt.y,Ge,wt),T){const{x:Gn,y:Un,z:Ln}=T.anchor,[un,Ai,bn]=T.up;Jp(ae,Gn,Un,Ln,un,Ai,bn),Jp(ae,Gn,Un,Ln,un,Ai,bn),Jp(ae,Gn,Un,Ln,un,Ai,bn),Jp(ae,Gn,Un,Ln,un,Ai,bn),r_(o.dynamicLayoutVertexArray,Gn,Un,Ln,ve)}else r_(o.dynamicLayoutVertexArray,I.x,I.y,I.z,ve);G.emplaceBack(It,It+1,It+2),G.emplaceBack(It+1,It+2,It+3),ge.vertexLength+=4,ge.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(en[0]),Fe!==l.length-1&&Ut===l[Fe+1].sectionIndex||o.programConfigurations.populatePaintArrays(Q.length,b,b.index,{},V,U,me&&me[Ut])}const Be=T?T.anchor:I;o.placedSymbolArray.emplaceBack(Be.x,Be.y,Be.z,I.x,I.y,se,this.glyphOffsetArray.length-se,he,k,F,I.segment,d?d[0]:0,d?d[1]:0,p[0],p[1],w,0,!1,0,N,0)}_commitLayoutVertex(o,l,d,p,_,b,w){o.emplaceBack(l,d,p,_,b,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(o,l,d,p,_,b,w){const T=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),I=T.vertexLength,k=w.tileAnchorX,F=w.tileAnchorY;for(let V=0;V<4;V++)d.collisionVertexArray.emplaceBack(0,0,0,0);d.collisionVertexArrayExt.emplaceBack(l,-o.padding,-o.padding),d.collisionVertexArrayExt.emplaceBack(l,o.padding,-o.padding),d.collisionVertexArrayExt.emplaceBack(l,o.padding,o.padding),d.collisionVertexArrayExt.emplaceBack(l,-o.padding,o.padding),this._commitLayoutVertex(d.layoutVertexArray,p,_,b,k,F,new st(o.x1,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,_,b,k,F,new st(o.x2,o.y1)),this._commitLayoutVertex(d.layoutVertexArray,p,_,b,k,F,new st(o.x2,o.y2)),this._commitLayoutVertex(d.layoutVertexArray,p,_,b,k,F,new st(o.x1,o.y2)),T.vertexLength+=4;const N=d.indexArray;N.emplaceBack(I,I+1),N.emplaceBack(I+1,I+2),N.emplaceBack(I+2,I+3),N.emplaceBack(I+3,I),T.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,d,p,_,b){for(let w=p;w<_;w++){const T=d.get(w),I=this.getSymbolInstanceTextSize(o,b,l,w);this._addCollisionDebugVertices(T,I,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(o,l,d,p,_,b){for(let w=p;w<_;w++){const T=d.get(w),I=this.getSymbolInstanceIconSize(o,l,b.placedIconSymbolIndex);this._addCollisionDebugVertices(T,I,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,b)}}generateCollisionDebugBuffers(o,l){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Nv(_r,Gx.members,jl),this.iconCollisionBox=new Nv(_r,Gx.members,jl);const d=Zl(this.iconSizeData,o),p=Zl(this.textSizeData,o);for(let _=0;_<this.symbolInstances.length;_++){const b=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(p,o,l,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(p,o,l,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(d,o,l,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(d,o,l,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(o,l,d,p){const _=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:p),b=Hg(this.textSizeData,o,_)/ns;return this.tilePixelRatio*b}getSymbolInstanceIconSize(o,l,d){const p=this.icon.placedSymbolArray.get(d),_=Hg(this.iconSizeData,o,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(o,l,d){o.emplaceBack(l,-d,-d),o.emplaceBack(l,d,-d),o.emplaceBack(l,d,d),o.emplaceBack(l,-d,d)}_updateTextDebugCollisionBoxes(o,l,d,p,_,b){for(let w=p;w<_;w++){const T=d.get(w),I=this.getSymbolInstanceTextSize(o,b,l,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,I,T.padding)}}_updateIconDebugCollisionBoxes(o,l,d,p,_,b){for(let w=p;w<_;w++){const T=d.get(w),I=this.getSymbolInstanceIconSize(o,l,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,I,T.padding)}}updateCollisionDebugBuffers(o,l){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const d=Zl(this.iconSizeData,o),p=Zl(this.textSizeData,o);for(let _=0;_<this.symbolInstances.length;_++){const b=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(p,o,l,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(p,o,l,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(d,o,l,b.iconBoxStartIndex,b.iconBoxEndIndex,b.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(d,o,l,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,d,p,_,b,w,T,I){const k={};if(l<d){const{x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he,featureIndex:ve}=o.get(l);k.textBox={x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he},k.textFeatureIndex=ve}if(p<_){const{x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he,featureIndex:ve}=o.get(p);k.verticalTextBox={x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he},k.verticalTextFeatureIndex=ve}if(b<w){const{x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he,featureIndex:ve}=o.get(b);k.iconBox={x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he},k.iconFeatureIndex=ve}if(T<I){const{x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he,featureIndex:ve}=o.get(T);k.verticalIconBox={x1:F,y1:N,x2:V,y2:U,padding:G,projectedAnchorX:Q,projectedAnchorY:ae,projectedAnchorZ:ge,tileAnchorX:se,tileAnchorY:he},k.verticalIconFeatureIndex=ve}return k}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const d=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,l){const d=o.placedSymbolArray.get(l),p=d.vertexStartIndex+4*d.numGlyphs;for(let _=d.vertexStartIndex;_<p;_+=4)o.indexArray.emplaceBack(_,_+1,_+2),o.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(o),d=Math.cos(o),p=[],_=[],b=[];for(let w=0;w<this.symbolInstances.length;++w){b.push(w);const T=this.symbolInstances.get(w);p.push(0|Math.round(l*T.tileAnchorX+d*T.tileAnchorY)),_.push(T.featureIndex)}return b.sort((w,T)=>p[w]-p[T]||_[T]-_[w]),b}addToSortKeyRanges(o,l){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===l?d.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const d=this.symbolInstances.get(l);this.featureSortOrder.push(d.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:I}=d;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),_>=0&&_!==p&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&b!==_&&b!==p&&this.addIndicesForPlacedSymbol(this.text,b),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Nt(_d,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),_d.MAX_GLYPHS=65535,_d.addDynamicAttributes=r_;const ka=new ft({"symbol-placement":new Se(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Se(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Se(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new He(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Se(Ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Se(Ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Se(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Se(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Se(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new He(Ye.layout_symbol["icon-size"]),"icon-text-fit":new Se(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Se(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new He(Ye.layout_symbol["icon-image"]),"icon-rotate":new He(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Se(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Se(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new He(Ye.layout_symbol["icon-offset"]),"icon-anchor":new He(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Se(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Se(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Se(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new He(Ye.layout_symbol["text-field"]),"text-font":new He(Ye.layout_symbol["text-font"]),"text-size":new He(Ye.layout_symbol["text-size"]),"text-max-width":new He(Ye.layout_symbol["text-max-width"]),"text-line-height":new He(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new He(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new He(Ye.layout_symbol["text-justify"]),"text-radial-offset":new He(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Se(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new He(Ye.layout_symbol["text-anchor"]),"text-max-angle":new Se(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Se(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new He(Ye.layout_symbol["text-rotate"]),"text-padding":new Se(Ye.layout_symbol["text-padding"]),"text-keep-upright":new Se(Ye.layout_symbol["text-keep-upright"]),"text-transform":new He(Ye.layout_symbol["text-transform"]),"text-offset":new He(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new Se(Ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Se(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new Se(Ye.layout_symbol["text-optional"])});var Bv={paint:new ft({"icon-opacity":new He(Ye.paint_symbol["icon-opacity"]),"icon-color":new He(Ye.paint_symbol["icon-color"]),"icon-halo-color":new He(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new He(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new He(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Se(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Se(Ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new He(Ye.paint_symbol["text-opacity"]),"text-color":new He(Ye.paint_symbol["text-color"],{runtimeType:gs,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new He(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new He(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new He(Ye.paint_symbol["text-halo-blur"]),"text-translate":new Se(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new Se(Ye.paint_symbol["text-translate-anchor"])}),layout:ka};class mw{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:xa,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Nt(mw,"FormatSectionOverride",{omit:["defaultValue"]});class zv extends Da{constructor(o){super(o,Bv)}recalculate(o,l){super.recalculate(o,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const d=this.layout.get("text-writing-mode");if(d){const p=[];for(const _ of d)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(o,l,d,p){const _=this.layout.get(o).evaluate(l,{},d,p),b=this._unevaluatedLayout._values[o];return b.isDataDriven()||L(b.value)||!_?_:(w=l.properties,_.replace(/{([^{}]+)}/g,(I,k)=>k in w?String(w[k]):""));var w}createBucket(o){return new _d(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of Bv.paint.overridableProperties){if(!zv.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),d=new mw(l),p=new O(d,l.property.specification);let _=null;_="constant"===l.value.kind||"source"===l.value.kind?new _e("source",p):new Je("composite",p,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new ht(l.property,_,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,d){return!(!this.layout||l.isDataDriven()||d.isDataDriven())&&zv.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const d=o.get("text-field"),p=Bv.paint.properties[l];let _=!1;const b=w=>{for(const T of w)if(p.overrides&&p.overrides.hasOverride(T))return void(_=!0)};if("constant"===d.value.kind&&d.value.value instanceof fr)b(d.value.value.sections);else if("source"===d.value.kind){const w=I=>{_||(I instanceof uc&&kr(I.value)===mi?b(I.value.sections):I instanceof Ku?b(I.sections):I.eachChild(w))},T=d.value;T._styleExpression&&w(T._styleExpression.expression)}return _}getProgramConfiguration(o){return new _u(this,o)}}var Vv={paint:new ft({"background-color":new Se(Ye.paint_background["background-color"]),"background-pattern":new Se(Ye.paint_background["background-pattern"]),"background-opacity":new Se(Ye.paint_background["background-opacity"])})},gw={paint:new ft({"raster-opacity":new Se(Ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new Se(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Se(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Se(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Se(Ye.paint_raster["raster-saturation"]),"raster-contrast":new Se(Ye.paint_raster["raster-contrast"]),"raster-resampling":new Se(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Se(Ye.paint_raster["raster-fade-duration"])})};class mI extends Da{constructor(o){super(o,{}),this.implementation=o}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}var gI={paint:new ft({"sky-type":new Se(Ye.paint_sky["sky-type"]),"sky-atmosphere-sun":new Se(Ye.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Se(Ye.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Se(Ye.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Se(Ye.paint_sky["sky-gradient-radius"]),"sky-gradient":new ct(Ye.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Se(Ye.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Se(Ye.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Se(Ye.paint_sky["sky-opacity"])})};function Uv(a,o,l){const d=[0,0,1],p=ET([]);return CT(p,p,l?-vt(a)+Math.PI:vt(a)),yg(p,p,-vt(o)),dx(d,d,p),Ds(d,d)}const _w={circle:class extends Da{constructor(a){super(a,Yy)}createBucket(a){return new Cg(a)}queryRadius(a){const o=a;return ih("circle-radius",this,o)+ih("circle-stroke-width",this,o)+rh(this.paint.get("circle-translate"))}queryIntersectsFeature(a,o,l,d,p,_,b,w){const T=qy(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return Tg(a,d,_,b,w,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),T,I)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new _u(this,a)}},heatmap:class extends Da{createBucket(a){return new Tx(a)}constructor(a){super(a,vf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"heatmap-color"===a&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Xy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return ih("heatmap-radius",this,a)}queryIntersectsFeature(a,o,l,d,p,_,b,w){const T=this.paint.get("heatmap-radius").evaluate(o,l);return Tg(a,d,_,b,w,!0,!0,new st(0,0),T)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new _u(this,a)}},hillshade:class extends Da{constructor(a){super(a,MT)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Da{constructor(a){super(a,ov)}getProgramIds(){const a=this.paint.get("fill-pattern"),o=a&&a.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getProgramConfiguration(a){return new _u(this,a)}recalculate(a,o){super.recalculate(a,o);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new iv(a)}queryRadius(){return rh(this.paint.get("fill-translate"))}queryIntersectsFeature(a,o,l,d,p,_){return!a.queryGeometry.isAboveHorizon&&jy(zp(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),d)}isTileClipped(){return!0}},"fill-extrusion":class extends Da{constructor(a){super(a,GO)}createBucket(a){return new xu(a)}queryRadius(){return rh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new _u(this,a)}queryIntersectsFeature(a,o,l,d,p,_,b,w,T){const I=qy(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(o,l),F=this.paint.get("fill-extrusion-base").evaluate(o,l),N=[0,0],V=w&&_.elevation,U=_.elevation?_.elevation.exaggeration():1,G=a.tile.getBucket(this);if(V&&G instanceof xu){const he=G.centroidVertexArray,ve=T+1;ve<he.length&&(N[0]=he.geta_centroid_pos0(ve),N[1]=he.geta_centroid_pos1(ve))}if(0===N[0]&&1===N[1])return!1;"globe"===_.projection.name&&(d=dv([d],[new st(0,0),new st(gn,gn)],a.tileID.canonical).map(he=>he.polygon).flat());const Q=V?w:null,[ae,ge]=(ve=d,me=F,Be=k,Fe=I,Ze=b,dt=Q,je=N,Xe=U,it=_.center.lat,"globe"===(he=_).projection.name?function(pt,Ge,wt,en,Dt,Ut,It,ln,Gn,Un,Ln){const un=[],Ai=[],bn=pt.projection.upVectorScale(Ln,pt.center.lat,pt.worldSize).metersToTile,qn=[0,0,0,1],Bi=[0,0,0,1],Zn=(Ji,sn,sr,Eo)=>{Ji[0]=sn,Ji[1]=sr,Ji[2]=Eo,Ji[3]=1},Zi=uv();wt>0&&(wt+=Zi),en+=Zi;for(const Ji of Ge){const sn=[],sr=[];for(const Eo of Ji){const pe=Eo.x+Dt.x,be=Eo.y+Dt.y,St=pt.projection.projectTilePoint(pe,be,Ln),fi=pt.projection.upVector(Ln,Eo.x,Eo.y);let tr=wt,Or=en;if(It){const Pi=Wp(pe,be,wt,en,It,ln,Gn,Un);tr+=Pi.base,Or+=Pi.top}0!==wt?Zn(qn,St.x+fi[0]*bn*tr,St.y+fi[1]*bn*tr,St.z+fi[2]*bn*tr):Zn(qn,St.x,St.y,St.z),Zn(Bi,St.x+fi[0]*bn*Or,St.y+fi[1]*bn*Or,St.z+fi[2]*bn*Or),yr(qn,qn,Ut),yr(Bi,Bi,Ut),sn.push(new _l(qn[0],qn[1],qn[2])),sr.push(new _l(Bi[0],Bi[1],Bi[2]))}un.push(sn),Ai.push(sr)}return[un,Ai]}(he,ve,me,Be,Fe,Ze,dt,je,Xe,it,a.tileID.canonical):dt?function(pt,Ge,wt,en,Dt,Ut,It,ln,Gn){const Un=[],Ln=[],un=[0,0,0,1];for(const Ai of pt){const bn=[],qn=[];for(const Bi of Ai){const Zn=Bi.x+en.x,Zi=Bi.y+en.y,Ji=Wp(Zn,Zi,Ge,wt,Ut,It,ln,Gn);un[0]=Zn,un[1]=Zi,un[2]=Ji.base,un[3]=1,yu(un,un,Dt),un[3]=Math.max(un[3],1e-5);const sn=new _l(un[0]/un[3],un[1]/un[3],un[2]/un[3]);un[0]=Zn,un[1]=Zi,un[2]=Ji.top,un[3]=1,yu(un,un,Dt),un[3]=Math.max(un[3],1e-5);const sr=new _l(un[0]/un[3],un[1]/un[3],un[2]/un[3]);bn.push(sn),qn.push(sr)}Un.push(bn),Ln.push(qn)}return[Un,Ln]}(ve,me,Be,Fe,Ze,dt,je,Xe,it):function(pt,Ge,wt,en,Dt){const Ut=[],It=[],ln=Dt[8]*Ge,Gn=Dt[9]*Ge,Un=Dt[10]*Ge,Ln=Dt[11]*Ge,un=Dt[8]*wt,Ai=Dt[9]*wt,bn=Dt[10]*wt,qn=Dt[11]*wt;for(const Bi of pt){const Zn=[],Zi=[];for(const Ji of Bi){const sn=Ji.x+en.x,sr=Ji.y+en.y,Eo=Dt[0]*sn+Dt[4]*sr+Dt[12],pe=Dt[1]*sn+Dt[5]*sr+Dt[13],be=Dt[2]*sn+Dt[6]*sr+Dt[14],St=Dt[3]*sn+Dt[7]*sr+Dt[15],fi=Eo+ln,tr=pe+Gn,Or=be+Un,Pi=Math.max(St+Ln,1e-5),vr=Eo+un,Xr=pe+Ai,uo=be+bn,Qr=Math.max(St+qn,1e-5);Zn.push(new _l(fi/Pi,tr/Pi,Or/Pi)),Zi.push(new _l(vr/Qr,Xr/Qr,uo/Qr))}Ut.push(Zn),It.push(Zi)}return[Ut,It]}(ve,me,Be,Fe,Ze)),se=a.queryGeometry;var he,ve,me,Be,Fe,Ze,dt,je,Xe,it;return function(he,ve,me){let Be=1/0;jy(me,ve)&&(Be=Ug(me,ve[0]));for(let Fe=0;Fe<ve.length;Fe++){const Ze=ve[Fe],dt=he[Fe];for(let je=0;je<Ze.length-1;je++){const Xe=Ze[je],it=[Xe,Ze[je+1],dt[je+1],dt[je],Xe];Uy(me,it)&&(Be=Math.min(Be,Ug(me,it)))}}return Be!==1/0&&Be}(ae,ge,se.isPointQuery()?se.screenBounds:se.screenGeometry)}},line:class extends Da{constructor(a){super(a,mv),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if("line-gradient"===a){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof iu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,o){super.recalculate(a,o),this.paint._values["line-floorwidth"]=lh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new $g(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new _u(this,a)}queryRadius(a){const o=a,l=$x(ih("line-width",this,o),ih("line-gap-width",this,o)),d=ih("line-offset",this,o);return l/2+Math.abs(d)+rh(this.paint.get("line-translate"))}queryIntersectsFeature(a,o,l,d,p,_){if(a.queryGeometry.isAboveHorizon)return!1;const b=zp(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,a.pixelToTileUnitsFactor),w=a.pixelToTileUnitsFactor/2*$x(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),T=this.paint.get("line-offset").evaluate(o,l);return T&&(d=function(I,k){const F=[],N=new st(0,0);for(let V=0;V<I.length;V++){const U=I[V],G=[];for(let Q=0;Q<U.length;Q++){const ge=U[Q],se=U[Q+1],he=0===Q?N:ge.sub(U[Q-1])._unit()._perp(),ve=Q===U.length-1?N:se.sub(ge)._unit()._perp(),me=he._add(ve)._unit();me._mult(1/(me.x*ve.x+me.y*ve.y)),G.push(me._mult(k)._add(ge))}F.push(G)}return F}(d,T*a.pixelToTileUnitsFactor)),function(I,k,F){for(let N=0;N<k.length;N++){const V=k[N];if(I.length>=3)for(let U=0;U<V.length;U++)if(hd(I,V[U]))return!0;if(xx(I,V,F))return!0}return!1}(b,d,w)}isTileClipped(){return!0}},symbol:zv,background:class extends Da{constructor(a){super(a,Vv)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Da{constructor(a){super(a,gw)}getProgramIds(){return["raster"]}},sky:class extends Da{constructor(a){super(a,gI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){"sky-gradient"===a?this._updateColorRamp():"sky-atmosphere-sun"!==a&&"sky-atmosphere-halo-color"!==a&&"sky-atmosphere-color"!==a&&"sky-atmosphere-sun-intensity"!==a||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Xy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(a,o){if("atmosphere"===this.paint.get("sky-type")){const d=this.paint.get("sky-atmosphere-sun"),p=!d,_=a.style.light,b=_.properties.get("position");return p&&"viewport"===_.properties.get("anchor")&&ni("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Uv(b.azimuthal,90-b.polar,o):Uv(d[0],90-d[1],o)}const l=this.paint.get("sky-gradient-center");return Uv(l[0],90-l[1],o)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return"atmosphere"===a?["skyboxCapture","skybox"]:"gradient"===a?["skyboxGradient"]:null}}};class em{constructor(o,l,d,p){this.context=o,this.format=d,this.texture=o.gl.createTexture(),this.update(l,p)}update(o,l,d){const{width:p,height:_}=o,{context:b}=this,{gl:w}=b,{HTMLImageElement:T,HTMLCanvasElement:I,HTMLVideoElement:k,ImageData:F,ImageBitmap:N}=ze;if(w.bindTexture(w.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!l||!1!==l.premultiply)),d||this.size&&this.size[0]===p&&this.size[1]===_){const{x:V,y:U}=d||{x:0,y:0};o instanceof T||o instanceof I||o instanceof k||o instanceof F||N&&o instanceof N?w.texSubImage2D(w.TEXTURE_2D,0,V,U,w.RGBA,w.UNSIGNED_BYTE,o):w.texSubImage2D(w.TEXTURE_2D,0,V,U,p,_,w.RGBA,w.UNSIGNED_BYTE,o.data)}else this.size=[p,_],o instanceof T||o instanceof I||o instanceof k||o instanceof F||N&&o instanceof N?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,o):w.texImage2D(w.TEXTURE_2D,0,this.format,p,_,0,this.format,w.UNSIGNED_BYTE,o.data);this.useMipmap=Boolean(l&&l.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(o,l){const{context:d}=this,{gl:p}=d;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?o===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:o),this.filter=o),l!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrap=l)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class _I{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class jv{constructor(){this.tasks={},this.taskQueue=[],ds(["process"],this),this.invoker=new _I(this.process),this.nextId=0}add(o,l){const d=this.nextId++,p=function({type:_,isSymbolTile:b,zoom:w}){return w=w||0,"message"===_?0:"maybePrepare"!==_||b?"parseTile"!==_||b?"parseTile"===_&&b?300-w:"maybePrepare"===_&&b?400-w:500:200-w:100-w}(l);if(0===p){So();try{o()}finally{}return{cancel:()=>{}}}return this.tasks[d]={fn:o,metadata:l,priority:p,id:d},this.taskQueue.push(d),this.invoker.trigger(),{cancel:()=>{delete this.tasks[d]}}}process(){So();try{if(this.taskQueue=this.taskQueue.filter(d=>!!this.tasks[d]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<l&&(l=_.priority,o=p)}if(null===o)return null;const d=this.taskQueue[o];return this.taskQueue.splice(o,1),d}remove(){this.invoker.remove()}}class yw{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const d=o[l];this._stringToNumber[d]=l,this._numberToString[l]=d}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const yI=["tile","layer","source","sourceLayer","state"];class vw{constructor(o,l,d,p,_){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=d,this._y=p,this.properties=o.properties,this.id=_}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(o.id=this.id);for(const l of yI)void 0!==this[l]&&(o[l]=this[l]);return o}}const yl=32,Fc=33,is=new Uint16Array(8184);for(let a=0;a<2046;a++){let o=a+2,l=0,d=0,p=0,_=0,b=0,w=0;for(1&o?p=_=b=yl:l=d=w=yl;(o>>=1)>1;){const I=l+p>>1,k=d+_>>1;1&o?(p=l,_=d,l=b,d=w):(l=p,d=_,p=b,_=w),b=I,w=k}const T=4*a;is[T+0]=l,is[T+1]=d,is[T+2]=p,is[T+3]=_}const vl=new Uint16Array(2178),yd=new Uint8Array(1089),s_=new Uint16Array(1089);function $v(a){return 0===a?-.03125:32===a?.03125:0}var bw=Kt([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const xw={type:2,extent:gn,loadGeometry:()=>[[new st(0,0),new st(8193,0),new st(8193,8193),new st(0,8193),new st(0,0)]]};class Hv{constructor(o,l,d,p,_){this.tileID=o,this.uid=za(),this.uses=0,this.tileSize=l,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(o){const l=o+this.timeAdded;l<Qn.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Du(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,l,d){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(p,_){const b={};if(!_)return b;for(const w of p){const T=w.layerIds.map(I=>_.getLayer(I)).filter(Boolean);if(0!==T.length){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(I=>T.filter(k=>k.id===I)[0]));for(const I of T)b[I.id]=w}}return b}(o.buckets,l.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof _d){if(this.hasSymbolBuckets=!0,!d)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof _d&&_.hasRTLText){this.hasRTLText=!0,Ce.isLoading()||Ce.isLoaded()||"deferred"!==xe()||ye();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,l.style.getLayer(p).queryRadius(_))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas)}else this.collisionBoxArray=new yy}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(o){return this.buckets[o.id]}upload(o){for(const d in this.buckets){const p=this.buckets[d];p.uploadPending()&&p.upload(o)}const l=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new em(o,this.imageAtlas.image,l.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new em(o,this.glyphAtlasImage,l.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new em(o,this.lineAtlas.image,l.ALPHA),this.lineAtlas.uploaded=!0)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,l,d,p,_,b,w,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:w,transform:b,params:_,tileTransform:this.tileTransform},o,l,d):{}}querySourceFeatures(o,l){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const p=d.loadVTLayers(),_=l?l.sourceLayer:"",b=p._geojsonTileLayer||p[_];if(!b)return;const w=Gd(l&&l.filter),{z:T,x:I,y:k}=this.tileID.canonical,F={z:T,x:I,y:k};for(let N=0;N<b.length;N++){const V=b.feature(N);if(w.needGeometry){const Q=vu(V,!0);if(!w.filter(new Ae(this.tileID.overscaledZ),Q,this.tileID.canonical))continue}else if(!w.filter(new Ae(this.tileID.overscaledZ),V))continue;const U=d.getId(V,_),G=new vw(V,T,I,k,U);G.tile=F,o.push(G)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const l=this.expirationTime;if(o.cacheControl){const d=Wn(o.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const d=Date.now();let p=!1;if(this.expirationTime>d)p=!1;else if(l)if(this.expirationTime<l)p=!0;else{const _=this.expirationTime-l;_?this.expirationTime=d+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,l){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length||!l)return;const d=this.latestFeatureIndex.loadVTLayers(),p=l.style.listImages();for(const _ in this.buckets){if(!l.style.hasLayer(_))continue;const b=this.buckets[_],w=b.layers[0].sourceLayer||"_geojsonTileLayer",T=d[w],I=o[w];if(!T||!I||0===Object.keys(I).length)continue;if(b.update(I,T,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof $g||b instanceof iv){const F=l.style._getSourceCache(b.layers[0].source);l._terrain&&l._terrain.enabled&&F&&b.programConfigurations.needsUpload&&l._terrain._clearRenderCacheForTile(F.id,this.tileID)}const k=l&&l.style&&l.style.getLayer(_);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(b)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Qn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=Qn.now()+o}setTexture(o,l){const d=l.context,p=d.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture?this.texture.update(o,{useMipmap:!0}):(this.texture=new em(d,o,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(o,l){const d={};for(const p of l)d[p]=!0;this.dependencies[o]=d}hasDependency(o,l){for(const d of o){const p=this.dependencies[d];if(p)for(const _ of l)if(p[_])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,l){if(!l||"mercator"===l.name||this._tileDebugBuffer)return;const d=Sc(xw,this.tileID.canonical,this.tileTransform)[0],p=new Jt,_=new wc;for(let b=0;b<d.length;b++){const{x:w,y:T}=d[b];p.emplaceBack(w,T),_.emplaceBack(b)}_.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(_),this._tileDebugBuffer=o.createVertexBuffer(p,Rp.members),this._tileDebugSegments=Cr.simpleSegment(0,0,p.length,_.length)}_makeTileBoundsBuffers(o,l){if(this._tileBoundsBuffer||!l||"mercator"===l.name)return;const d=Sc(xw,this.tileID.canonical,this.tileTransform)[0];let p,_;if(this.isRaster){const b=function(w,T){const I=Du(w,T),k=Math.pow(2,w.z);for(let Q=0;Q<Fc;Q++)for(let ae=0;ae<Fc;ae++){const ge=Bo((w.x+(ae+$v(ae))/yl)/k),se=co((w.y+(Q+$v(Q))/yl)/k),he=T.project(ge,se),ve=Q*Fc+ae;vl[2*ve+0]=Math.round((he.x*I.scale-I.x)*gn),vl[2*ve+1]=Math.round((he.y*I.scale-I.y)*gn)}yd.fill(0),s_.fill(0);for(let Q=2045;Q>=0;Q--){const ae=4*Q,ge=is[ae+0],se=is[ae+1],he=is[ae+2],ve=is[ae+3],me=ge+he>>1,Be=se+ve>>1,Fe=me+Be-se,Ze=Be+ge-me,dt=se*Fc+ge,je=ve*Fc+he,Xe=Be*Fc+me,it=Math.hypot((vl[2*dt+0]+vl[2*je+0])/2-vl[2*Xe+0],(vl[2*dt+1]+vl[2*je+1])/2-vl[2*Xe+1])>=16;yd[Xe]=yd[Xe]||(it?1:0),Q<1022&&(yd[Xe]=yd[Xe]||yd[(se+Ze>>1)*Fc+(ge+Fe>>1)]||yd[(ve+Ze>>1)*Fc+(he+Fe>>1)])}const F=new hi,N=new ao;let V=0;function U(Q,ae){const ge=ae*Fc+Q;return 0===s_[ge]&&(F.emplaceBack(vl[2*ge+0],vl[2*ge+1],Q*gn/yl,ae*gn/yl),s_[ge]=++V),s_[ge]-1}function G(Q,ae,ge,se,he,ve){const me=Q+ge>>1,Be=ae+se>>1;if(Math.abs(Q-he)+Math.abs(ae-ve)>1&&yd[Be*Fc+me])G(he,ve,Q,ae,me,Be),G(ge,se,he,ve,me,Be);else{const Fe=U(Q,ae),Ze=U(ge,se),dt=U(he,ve);N.emplaceBack(Fe,Ze,dt)}}return G(0,0,yl,yl,yl,0),G(yl,yl,0,0,0,yl),{vertices:F,indices:N}}(this.tileID.canonical,l);p=b.vertices,_=b.indices}else{p=new hi,_=new ao;for(const{x:w,y:T}of d)p.emplaceBack(w,T,0,0);const b=fd(p.int16,void 0,4);for(let w=0;w<b.length;w+=3)_.emplaceBack(b[w],b[w+1],b[w+2])}this._tileBoundsBuffer=o.createVertexBuffer(p,bw.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(_),this._tileBoundsSegments=Cr.simpleSegment(0,0,p.length,_.length)}_makeGlobeTileDebugBuffers(o,l){const d=l.projection;if(!d||"globe"!==d.name||l.freezeTileCoverage)return;const p=this.tileID.canonical,_=pf(_x(p,l)),b=mf(l.zoom);let w;b>0&&(w=af(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,p,l,_,w,b),this._makeGlobeTileDebugTextBuffer(o,p,l,_,w,b)}_globePoint(o,l,d,p,_,b,w){let T=ff(o,l,d);if(b){const I=1<<d.z,k=fl(p.center.lng),F=pl(p.center.lat),N=(d.x+.5)/I-k;let V=0;N>.5?V=-1:N<-.5&&(V=1);let U=(o/gn+d.x)/I+V,G=(l/gn+d.y)/I;U=(U-k)*p._pixelsPerMercatorPixel+k,G=(G-F)*p._pixelsPerMercatorPixel+F;const Q=[U*p.worldSize,G*p.worldSize,0];yr(Q,Q,b),T=th(T,Q,w)}return yr(T,T,_)}_makeGlobeTileDebugBorderBuffer(o,l,d,p,_,b){const w=new Jt,T=new wc,I=new _i,k=(N,V,U,G,Q)=>{const ae=(U-N)/(Q-1),ge=(G-V)/(Q-1),se=w.length;for(let he=0;he<Q;he++){const ve=N+he*ae,me=V+he*ge;w.emplaceBack(ve,me);const Be=this._globePoint(ve,me,l,d,p,_,b);I.emplaceBack(Be[0],Be[1],Be[2]),T.emplaceBack(se+he)}},F=gn;k(0,0,F,0,16),k(F,0,F,F,16),k(F,F,0,F,16),k(0,F,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(T),this._tileDebugBuffer=o.createVertexBuffer(w,Rp.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(I,IT.members),this._tileDebugSegments=Cr.simpleSegment(0,0,w.length,T.length)}_makeGlobeTileDebugTextBuffer(o,l,d,p,_,b){const w=new Jt,T=new ao,I=new _i,k=25;T.reserve(32),w.reserve(k),I.reserve(k);const F=(N,V)=>k*N+V;for(let N=0;N<k;N++){const V=2048*N;for(let U=0;U<k;U++){const G=2048*U;w.emplaceBack(G,V);const Q=this._globePoint(G,V,l,d,p,_,b);I.emplaceBack(Q[0],Q[1],Q[2])}}for(let N=0;N<4;N++)for(let V=0;V<4;V++){const U=F(N,V),G=F(N,V+1),Q=F(N+1,V),ae=F(N+1,V+1);T.emplaceBack(U,G,Q),T.emplaceBack(Q,G,ae)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(T),this._tileDebugTextBuffer=o.createVertexBuffer(w,Rp.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(I,IT.members),this._tileDebugTextSegments=Cr.simpleSegment(0,0,k,32)}}class Gv{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,l,d){const p=String(l);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][p]=this.stateChanges[o][p]||{},xn(this.stateChanges[o][p],d),null===this.deletedStates[o]){this.deletedStates[o]={};for(const _ in this.state[o])_!==p&&(this.deletedStates[o][_]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][p]){this.deletedStates[o][p]={};for(const _ in this.state[o][p])d[_]||(this.deletedStates[o][p][_]=null)}else for(const _ in d)this.deletedStates[o]&&this.deletedStates[o][p]&&null===this.deletedStates[o][p][_]&&delete this.deletedStates[o][p][_]}removeFeatureState(o,l,d){if(null===this.deletedStates[o])return;const p=String(l);if(this.deletedStates[o]=this.deletedStates[o]||{},d&&void 0!==l)null!==this.deletedStates[o][p]&&(this.deletedStates[o][p]=this.deletedStates[o][p]||{},this.deletedStates[o][p][d]=null);else if(void 0!==l)if(this.stateChanges[o]&&this.stateChanges[o][p])for(d in this.deletedStates[o][p]={},this.stateChanges[o][p])this.deletedStates[o][p][d]=null;else this.deletedStates[o][p]=null;else this.deletedStates[o]=null}getState(o,l){const d=String(l),p=xn({},(this.state[o]||{})[d],(this.stateChanges[o]||{})[d]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const _=this.deletedStates[o][l];if(null===_)return{};for(const b in _)delete p[b]}return p}initializeTileState(o,l){o.setFeatureState(this.state,l)}coalesceChanges(o,l){const d={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const b in this.stateChanges[p])this.state[p][b]||(this.state[p][b]={}),xn(this.state[p][b],this.stateChanges[p][b]),_[b]=this.state[p][b];d[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(null===this.deletedStates[p])for(const b in this.state[p])_[b]={},this.state[p][b]={};else for(const b in this.deletedStates[p]){if(null===this.deletedStates[p][b])this.state[p][b]={};else if(this.state[p][b])for(const w of Object.keys(this.deletedStates[p][b]))delete this.state[p][b][w];_[b]=this.state[p][b]}d[p]=d[p]||{},xn(d[p],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(d).length)for(const p in o)o[p].setFeatureState(d,l)}}class ww{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const d=this.toIdx(o,l);return{min:this.minimums[d],max:this.maximums[d]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function Ew(a,o,l,d){let p=0,_=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(d[b])<1e-15){if(l[b]<a[b]||l[b]>o[b])return null}else{const w=1/d[b];let T=(a[b]-l[b])*w,I=(o[b]-l[b])*w;if(T>I){const k=T;T=I,I=k}if(T>p&&(p=T),I<_&&(_=I),p>_)return null}return p}function tm(a,o,l,d,p,_,b,w,T,I,k){const F=d-a,N=p-o,V=_-l,U=b-a,G=w-o,Q=T-l,ae=k[1]*Q-k[2]*G,ge=k[2]*U-k[0]*Q,se=k[0]*G-k[1]*U,he=F*ae+N*ge+V*se;if(Math.abs(he)<1e-15)return null;const ve=1/he,me=I[0]-a,Be=I[1]-o,Fe=I[2]-l,Ze=(me*ae+Be*ge+Fe*se)*ve;if(Ze<0||Ze>1)return null;const dt=Be*V-Fe*N,je=Fe*F-me*V,Xe=me*N-Be*F,it=(k[0]*dt+k[1]*je+k[2]*Xe)*ve;return it<0||Ze+it>1?null:(U*dt+G*je+Q*Xe)*ve}function nm(a,o,l){return(a-o)/(l-o)}function im(a,o,l,d,p,_,b,w,T){const I=1<<l,k=_-d,F=b-p,N=(a+1)/I*k+d,V=(o+0)/I*F+p,U=(o+1)/I*F+p;w[0]=(a+0)/I*k+d,w[1]=V,T[0]=N,T[1]=U}class vI{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(_){const b=Math.ceil(Math.log2(_.dim/8)),w=[];let T=Math.ceil(Math.pow(2,b));const I=1/T,k=(V,U,G,Q,ae)=>{const ge=Q?1:0,se=(V+1)*G-ge,he=U*G,ve=(U+1)*G-ge;ae[0]=V*G,ae[1]=he,ae[2]=se,ae[3]=ve};let F=new ww(T);const N=[];for(let V=0;V<T*T;V++){k(V%T,Math.floor(V/T),I,!1,N);const U=uh(N[0],N[1],_),G=uh(N[2],N[1],_),Q=uh(N[2],N[3],_),ae=uh(N[0],N[3],_);F.minimums.push(Math.min(U,G,Q,ae)),F.maximums.push(Math.max(U,G,Q,ae)),F.leaves.push(1)}for(w.push(F),T/=2;T>=1;T/=2){const V=w[w.length-1];F=new ww(T);for(let U=0;U<T*T;U++){k(U%T,Math.floor(U/T),2,!0,N);const G=V.getElevation(N[0],N[1]),Q=V.getElevation(N[2],N[1]),ae=V.getElevation(N[2],N[3]),ge=V.getElevation(N[0],N[3]),se=V.isLeaf(N[0],N[1]),he=V.isLeaf(N[2],N[1]),ve=V.isLeaf(N[2],N[3]),me=V.isLeaf(N[0],N[3]),Be=Math.min(G.min,Q.min,ae.min,ge.min),Fe=Math.max(G.max,Q.max,ae.max,ge.max),Ze=se&&he&&ve&&me;F.maximums.push(Fe),F.minimums.push(Be),F.leaves.push(Fe-Be<=5&&Ze?1:0)}w.push(F)}return w}(this.dem),d=l.length-1,p=l[d];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(l,0,0,d,0)}raycastRoot(o,l,d,p,_,b,w=1){return Ew([o,l,-100],[d,p,this.maximums[0]*w],_,b)}raycast(o,l,d,p,_,b,w=1){if(!this.nodeCount)return null;const T=this.raycastRoot(o,l,d,p,_,b,w);if(null==T)return null;const I=[],k=[],F=[],N=[],V=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;V.length>0;){const{idx:U,t:G,nodex:Q,nodey:ae,depth:ge}=V.pop();if(this.leaves[U]){im(Q,ae,ge,o,l,d,p,F,N);const he=1<<ge,ve=(Q+0)/he,me=(Q+1)/he,Be=(ae+0)/he,Fe=(ae+1)/he,Ze=uh(ve,Be,this.dem)*w,dt=uh(me,Be,this.dem)*w,je=uh(me,Fe,this.dem)*w,Xe=uh(ve,Fe,this.dem)*w,it=tm(F[0],F[1],Ze,N[0],F[1],dt,N[0],N[1],je,_,b),ut=tm(N[0],N[1],je,F[0],N[1],Xe,F[0],F[1],Ze,_,b),pt=Math.min(null!==it?it:Number.MAX_VALUE,null!==ut?ut:Number.MAX_VALUE);if(pt!==Number.MAX_VALUE)return pt;{const Ge=kp([],_,b,G);if(a_(Ze,dt,Xe,je,nm(Ge[0],F[0],N[0]),nm(Ge[1],F[1],N[1]))>=Ge[2])return G}continue}let se=0;for(let he=0;he<this._siblingOffset.length;he++){im((Q<<1)+this._siblingOffset[he][0],(ae<<1)+this._siblingOffset[he][1],ge+1,o,l,d,p,F,N),F[2]=-100,N[2]=this.maximums[this.childOffsets[U]+he]*w;const ve=Ew(F,N,_,b);if(null!=ve){const me=ve;I[he]=me;let Be=!1;for(let Fe=0;Fe<se&&!Be;Fe++)me>=I[k[Fe]]&&(k.splice(Fe,0,he),Be=!0);Be||(k[se]=he),se++}}for(let he=0;he<se;he++){const ve=k[he];V.push({idx:this.childOffsets[U]+ve,t:I[ve],nodex:(Q<<1)+this._siblingOffset[ve][0],nodey:(ae<<1)+this._siblingOffset[ve][1],depth:ge+1})}}return null}_addNode(o,l,d){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(d),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,d,p,_){if(1===o[p].isLeaf(l,d))return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const b=p-1,w=o[b];let T=0,I=0;for(let k=0;k<this._siblingOffset.length;k++){const F=2*l+this._siblingOffset[k][0],N=2*d+this._siblingOffset[k][1],V=w.getElevation(F,N),U=w.isLeaf(F,N),G=this._addNode(V.min,V.max,U);U&&(T|=1<<k),I||(I=G)}for(let k=0;k<this._siblingOffset.length;k++)T&1<<k||this._construct(o,2*l+this._siblingOffset[k][0],2*d+this._siblingOffset[k][1],b,I+k)}}function a_(a,o,l,d,p,_){return Vn(Vn(a,l,_),Vn(o,d,_),p)}function uh(a,o,l){const d=l.dim,p=_n(a*d-.5,0,d-1),_=_n(o*d-.5,0,d-1),b=Math.floor(p),w=Math.floor(_),T=Math.min(b+1,d-1),I=Math.min(w+1,d-1);return a_(l.get(b,w),l.get(T,w),l.get(b,I),l.get(T,I),p-b,_-w)}const Wv={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Cw(a,o,l){return(256*a*256+256*o+l)/10-1e4}function Tw(a,o,l){return 256*a+o+l/256-32768}class rm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,d,p=!1,_=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(d&&"mapbox"!==d&&"terrarium"!==d)return ni(`"${d}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const b=this.dim=l.height-2,w=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.encoding=d||"mapbox",this.borderReady=p,!p){for(let T=0;T<b;T++)w[this._idx(-1,T)]=w[this._idx(0,T)],w[this._idx(b,T)]=w[this._idx(b-1,T)],w[this._idx(T,-1)]=w[this._idx(T,0)],w[this._idx(T,b)]=w[this._idx(T,b-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(b,-1)]=w[this._idx(b-1,0)],w[this._idx(-1,b)]=w[this._idx(0,b-1)],w[this._idx(b,b)]=w[this._idx(b-1,b-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new vI(this)}get(o,l,d=!1){d&&(o=_n(o,-1,this.dim),l=_n(l,-1,this.dim));const p=4*this._idx(o,l);return("terrarium"===this.encoding?Tw:Cw)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(o){return Wv[o]}get unpackVector(){return Wv[this.encoding]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){const d=[0,0,0,0],p=rm.getUnpackVector(l);let _=Math.floor((o+p[3])/p[2]);return d[2]=_%256,_=Math.floor(_/256),d[1]=_%256,_=Math.floor(_/256),d[0]=_,d}getPixels(){return new Ss({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,d){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let p=l*this.dim,_=l*this.dim+this.dim,b=d*this.dim,w=d*this.dim+this.dim;switch(l){case-1:p=_-1;break;case 1:_=p+1}switch(d){case-1:b=w-1;break;case 1:w=b+1}const T=-l*this.dim,I=-d*this.dim;for(let k=b;k<w;k++)for(let F=p;F<_;F++){const N=4*this._idx(F,k),V=4*this._idx(F+T,k+I);this.pixels[N+0]=o.pixels[V+0],this.pixels[N+1]=o.pixels[V+1],this.pixels[N+2]=o.pixels[V+2],this.pixels[N+3]=o.pixels[V+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Nt(rm,"DEMData"),Nt(vI,"DemMinMaxQuadTree",{omit:["dem"]});class qv{constructor(o,l){this.max=o,this.onRemove=l,this.reset()}reset(){for(const o in this.data)for(const l of this.data[o])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(o,l,d){const p=o.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const _={value:l,timeout:void 0};if(void 0!==d&&(_.timeout=setTimeout(()=>{this.remove(o,_)},d)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const l=this.data[o].shift();return l.timeout&&clearTimeout(l.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),l.value}getByKey(o){const l=this.data[o];return l?l[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,l){if(!this.has(o))return this;const d=o.wrapped().key,p=void 0===l?0:this.data[d].indexOf(l),_=this.data[d][p];return this.data[d].splice(p,1),_.timeout&&clearTimeout(_.timeout),0===this.data[d].length&&delete this.data[d],this.onRemove(_.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(o){const l=[];for(const d in this.data)for(const p of this.data[d])o(p.value)||l.push(p);for(const d of l)this.remove(d.value.tileID,d)}}class fa{constructor(o,l,d){this.func=o,this.mask=l,this.range=d}}fa.ReadOnly=!1,fa.ReadWrite=!0,fa.disabled=new fa(519,fa.ReadOnly,[0,1]);class Mf{constructor(o,l,d,p,_,b){this.test=o,this.ref=l,this.mask=d,this.fail=p,this.depthFail=_,this.pass=b}}Mf.disabled=new Mf({func:519,mask:0},0,0,7680,7680,7680);class pa{constructor(o,l,d){this.blendFunction=o,this.blendColor=l,this.mask=d}}pa.Replace=[1,0],pa.disabled=new pa(pa.Replace,ur.transparent,[!1,!1,!1,!1]),pa.unblended=new pa(pa.Replace,ur.transparent,[!0,!0,!0,!0]),pa.alphaBlended=new pa([1,771],ur.transparent,[!0,!0,!0,!0]);class bl{constructor(o,l,d){this.enable=o,this.mode=l,this.frontFace=d}}bl.disabled=new bl(!1,1029,2305),bl.backCCW=new bl(!0,1029,2305),bl.backCW=new bl(!0,1029,2304),bl.frontCW=new bl(!0,1028,2304),bl.frontCCW=new bl(!0,1028,2305);class dh extends ms{constructor(o,l,d){super(),this.id=o,this._onlySymbols=d,l.on("data",p=>{"source"===p.dataType&&"metadata"===p.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===p.dataType&&"content"===p.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new qv(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gv,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(o){this.map=o,this._minTileCacheSize=void 0===this._minTileCacheSize&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const l=this._tiles[o];if("loaded"!==l.state&&"errored"!==l.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,l){return o.isSymbolTile=this._onlySymbols,this._source.loadTile(o,l)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o,()=>{})}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o,()=>{})}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const d=this._tiles[l];d.upload(o),d.prepare(this.map.style.imageManager)}}getIds(){return qo(this._tiles).map(o=>o.tileID).sort(Iw).map(o=>o.key)}getRenderableIds(o){const l=[];for(const d in this._tiles)this._isIdRenderable(+d,o)&&l.push(this._tiles[d]);return o?l.sort((d,p)=>{const _=d.tileID,b=p.tileID,w=new st(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),T=new st(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-b.overscaledZ||T.y-w.y||T.x-w.x}).map(d=>d.tileID.key):l.map(d=>d.tileID).sort(Iw).map(d=>d.key)}hasRenderableParent(o){const l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(+o,"reloading")}}_reloadTile(o,l){const d=this._tiles[o];d&&("loading"!==d.state&&(d.state=l),this._loadTile(d,this._tileLoaded.bind(this,d,o,l)))}_tileLoaded(o,l,d,p){if(p)if(o.state="errored",404!==p.status)this._source.fire(new Vs(p,{tile:o}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else o.timeAdded=Qn.now(),"expired"===d&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),"raster-dem"===this._source.type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new Di("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const l=this.getRenderableIds();for(let p=0;p<l.length;p++){const _=l[p];if(o.neighboringTiles&&o.neighboringTiles[_]){const b=this.getTileByID(_);d(o,b),d(b,o)}}function d(p,_){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let b=_.tileID.canonical.x-p.tileID.canonical.x;const w=_.tileID.canonical.y-p.tileID.canonical.y,T=Math.pow(2,p.tileID.canonical.z),I=_.tileID.key;0===b&&0===w||Math.abs(w)>1||(Math.abs(b)>1&&(1===Math.abs(b+T)?b+=T:1===Math.abs(b-T)&&(b-=T)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,b,w),p.neighboringTiles&&p.neighboringTiles[I]&&(p.neighboringTiles[I].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,l,d,p){for(const _ in this._tiles){let b=this._tiles[_];if(p[_]||!b.hasData()||b.tileID.overscaledZ<=l||b.tileID.overscaledZ>d)continue;let w=b.tileID;for(;b&&b.tileID.overscaledZ>l+1;){const I=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[I.key],b&&b.hasData()&&(w=I)}let T=w;for(;T.overscaledZ>l;)if(T=T.scaledTo(T.overscaledZ-1),o[T.key]){p[w.key]=w;break}}}findLoadedParent(o,l){if(o.key in this._loadedParentTiles){const d=this._loadedParentTiles[o.key];return d&&d.tileID.overscaledZ>=l?d:null}for(let d=o.overscaledZ-1;d>=l;d--){const p=o.scaledTo(d),_=this._getLoadedTile(p);if(_)return _}}_getLoadedTile(o){const l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,l){l=l||this._source.tileSize;const d=Math.ceil(o.width/l)+1,p=Math.ceil(o.height/l)+1,_=Math.floor(d*p*5),b="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,_):_,w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(w)}handleWrapJump(o){const l=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,l){const d={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+l),d[_.tileID.key]=_}this._tiles=d;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(o,l,d){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;let p;this.updateCacheSize(o,l),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new ts(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(p=o.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(w=>this._source.hasTile(w)))):p=[];const _=this._updateRetainedTiles(p);if(kf(this._source.type)&&0!==p.length){const w={},T={},I=Object.keys(_);for(const F of I){const N=_[F],V=this._tiles[F];if(!V||V.fadeEndTime&&V.fadeEndTime<=Qn.now())continue;const U=this.findLoadedParent(N,Math.max(N.overscaledZ-dh.maxOverzooming,this._source.minzoom));U&&(this._addTile(U.tileID),w[U.tileID.key]=U.tileID),T[F]=N}const k=p[p.length-1].overscaledZ;for(const F in this._tiles){const N=this._tiles[F];if(_[F]||!N.hasData())continue;let V=N.tileID;for(;V.overscaledZ>k;){V=V.scaledTo(V.overscaledZ-1);const U=this._tiles[V.key];if(U&&U.hasData()&&T[V.key]){_[F]=N.tileID;break}}}for(const F in w)_[F]||(this._coveredTiles[F]=!0,_[F]=w[F])}for(const w in _)this._tiles[w].clearFadeHold();const b=function(w,T){const I=[];for(const k in w)k in T||I.push(k);return I}(this._tiles,_);for(const w of b){const T=this._tiles[w];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const l={};if(0===o.length)return l;const d={},p=o.reduce((I,k)=>Math.min(I,k.overscaledZ),1/0),_=o[0].overscaledZ,b=Math.max(_-dh.maxOverzooming,this._source.minzoom),w=Math.max(_+dh.maxUnderzooming,this._source.minzoom),T={};for(const I of o){const k=this._addTile(I);l[I.key]=I,k.hasData()||p<this._source.maxzoom&&(T[I.key]=I)}this._retainLoadedChildren(T,p,w,l);for(const I of o){let k=this._tiles[I.key];if(k.hasData())continue;if(I.canonical.z>=this._source.maxzoom){const N=I.children(this._source.maxzoom)[0],V=this.getTile(N);if(V&&V.hasData()){l[N.key]=N;continue}}else{const N=I.children(this._source.maxzoom);if(l[N[0].key]&&l[N[1].key]&&l[N[2].key]&&l[N[3].key])continue}let F=k.wasRequested();for(let N=I.overscaledZ-1;N>=b;--N){const V=I.scaledTo(N);if(d[V.key]||(d[V.key]=!0,k=this.getTile(V),!k&&F&&(k=this._addTile(V)),k&&(l[V.key]=V,F=k.wasRequested(),k.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const l=[];let d,p=this._tiles[o].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){d=this._loadedParentTiles[p.key];break}l.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(d=this._getLoadedTile(_),d)break;p=_}for(const _ of l)this._loadedParentTiles[_]=d}}_addTile(o){let l=this._tiles[o.key];if(l)return l;l=this._cache.getAndRemove(o),l&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));const d=Boolean(l);if(!d){const p=this.map?this.map.painter:null;l=new Hv(o,this._source.tileSize*o.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))}return l?(l.uses++,this._tiles[o.key]=l,d||this._source.fire(new Di("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(o,l){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const d=l.getExpiryTimeout();d&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},d))}_removeTile(o){const l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&"reloading"!==l.state?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,l,d){const p=[],_=this.transform;if(!_)return p;const b="globe"===_.projection.name,w=fl(_.center.lng);for(const T in this._tiles){const I=this._tiles[T];if(d&&I.clearQueryDebugViz(),I.holdingForFade())continue;let k;if(b){const F=I.tileID.canonical;if(0===F.z){const N=[Math.abs(_n(w,...om(F,-1))-w),Math.abs(_n(w,...om(F,1))-w)];k=[0,2*N.indexOf(Math.min(...N))-1]}else{const N=[Math.abs(_n(w,...om(F,-1))-w),Math.abs(_n(w,...om(F,0))-w),Math.abs(_n(w,...om(F,1))-w)];k=[N.indexOf(Math.min(...N))-1]}}else k=[0];for(const F of k){const N=o.containsTile(I,_,l,F);N&&p.push(N)}}return p}getVisibleCoordinates(o){const l=this.getRenderableIds(o).map(d=>this._tiles[d].tileID);for(const d of l)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped());return l}hasTransition(){if(this._source.hasTransition())return!0;if(kf(this._source.type))for(const o in this._tiles){const l=this._tiles[o];if(void 0!==l.fadeEndTime&&l.fadeEndTime>=Qn.now())return!0}return!1}setFeatureState(o,l,d){this._state.updateState(o=o||"_geojsonTileLayer",l,d)}removeFeatureState(o,l,d){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,d)}getFeatureState(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)}setDependencies(o,l,d){const p=this._tiles[o];p&&p.setDependencies(l,d)}reloadTilesForDependencies(o,l){for(const d in this._tiles)this._tiles[d].hasDependency(o,l)&&this._reloadTile(+d,"reloading");this._cache.filter(d=>!d.hasDependency(o,l))}_preloadTiles(o,l){const d=new Map,p=Array.isArray(o)?o:[o],_=this.map.painter.terrain,b=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const w of p){const T=w.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const I of T)d.set(I.key,I);this.usedForTerrain&&w.updateElevation(!1)}Do(Array.from(d.values()),(w,T)=>{const I=new Hv(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(I,k=>{"raster-dem"===this._source.type&&I.dem&&this._backfillDEM(I),T(k,I)})},l)}}function Iw(a,o){const l=Math.abs(2*a.wrap)-+(a.wrap<0),d=Math.abs(2*o.wrap)-+(o.wrap<0);return a.overscaledZ-o.overscaledZ||d-l||o.canonical.y-a.canonical.y||o.canonical.x-a.canonical.x}function kf(a){return"raster"===a||"image"===a||"video"===a||"custom"===a}function om(a,o){const l=1<<a.z;return[a.x/l+o,(a.x+1)/l+o]}dh.maxOverzooming=10,dh.maxUnderzooming=3;class Yv{constructor(o,l,d){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=d}static create(o,l,d){const p=d||o.findDEMTileFor(l);if(!p||!p.dem)return;const _=p.dem,b=p.tileID,w=1<<l.canonical.z-b.canonical.z;return new Yv(p,p.tileSize/gn/w,[(l.canonical.x/w-b.canonical.x)*_.dim,(l.canonical.y/w-b.canonical.y)*_.dim])}tileCoordToPixel(o,l){const d=l*this._scale+this._offset[1],p=Math.floor(o*this._scale+this._offset[0]),_=Math.floor(d);return new st(p,_)}getElevationAt(o,l,d,p){const _=o*this._scale+this._offset[0],b=l*this._scale+this._offset[1],w=Math.floor(_),T=Math.floor(b),I=this._dem;return p=!!p,d?Vn(Vn(I.get(w,T,p),I.get(w,T+1,p),b-T),Vn(I.get(w+1,T,p),I.get(w+1,T+1,p),b-T),_-w):I.get(w,T,p)}getElevationAtPixel(o,l,d){return this._dem.get(o,l,!!d)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*ml(1,o)*this._dem.stride}}class Dw{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new Tn(gn,16,0),this.featureIndexArray=new xy,this.promoteId=l}insert(o,l,d,p,_,b=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,p,_,b);const T=this.grid;for(let I=0;I<l.length;I++){const k=l[I],F=[1/0,1/0,-1/0,-1/0];for(let N=0;N<k.length;N++){const V=k[N];F[0]=Math.min(F[0],V.x),F[1]=Math.min(F[1],V.y),F[2]=Math.max(F[2],V.x),F[3]=Math.max(F[3],V.y)}F[0]<gn&&F[1]<gn&&F[2]>=0&&F[3]>=0&&T.insert(w,F[0],F[1],F[2],F[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new $p(new qp(this.rawTileData)).layers,this.sourceLayerCoder=new yw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l,d,p){this.loadVTLayers();const _=o.params||{},b=Gd(_.filter),w=o.tileResult,T=o.transform,I=w.bufferedTilespaceBounds,k=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,(U,G,Q,ae)=>Gy(w.bufferedTilespaceGeometry,U,G,Q,ae));k.sort(bI);let F=null;T.elevation&&k.length>0&&(F=Yv.create(T.elevation,this.tileID));const N={};let V;for(let U=0;U<k.length;U++){const G=k[U];if(G===V)continue;V=G;const Q=this.featureIndexArray.get(G);let ae=null;this.loadMatchingFeature(N,Q,b,_.layers,_.availableImages,l,d,p,(ge,se,he,ve=0)=>(ae||(ae=Sc(ge,this.tileID.canonical,o.tileTransform)),se.queryIntersectsFeature(w,ge,he,ae,this.z,o.transform,o.pixelPosMatrix,F,ve)))}return N}loadMatchingFeature(o,l,d,p,_,b,w,T,I){const{featureIndex:k,bucketIndex:F,sourceLayerIndex:N,layoutVertexArrayOffset:V}=l,U=this.bucketLayerIDs[F];if(p&&!function(ge,se){for(let he=0;he<ge.length;he++)if(se.indexOf(ge[he])>=0)return!0;return!1}(p,U))return;const G=this.sourceLayerCoder.decode(N),Q=this.vtLayers[G].feature(k);if(d.needGeometry){const ge=vu(Q,!0);if(!d.filter(new Ae(this.tileID.overscaledZ),ge,this.tileID.canonical))return}else if(!d.filter(new Ae(this.tileID.overscaledZ),Q))return;const ae=this.getId(Q,G);for(let ge=0;ge<U.length;ge++){const se=U[ge];if(p&&p.indexOf(se)<0)continue;const he=b[se];if(!he)continue;let ve={};void 0!==ae&&T&&(ve=T.getState(he.sourceLayer||"_geojsonTileLayer",ae));const me=xn({},w[se]);me.paint=Sw(me.paint,he.paint,Q,ve,_),me.layout=Sw(me.layout,he.layout,Q,ve,_);const Be=!I||I(Q,he,ve,V);if(!Be)continue;const Fe=new vw(Q,this.z,this.x,this.y,ae);Fe.layer=me;let Ze=o[se];void 0===Ze&&(Ze=o[se]=[]),Ze.push({featureIndex:k,feature:Fe,intersectionZ:Be})}}lookupSymbolFeatures(o,l,d,p,_,b,w,T){const I={};this.loadVTLayers();const k=Gd(_);for(const F of o)this.loadMatchingFeature(I,{bucketIndex:d,sourceLayerIndex:p,featureIndex:F,layoutVertexArrayOffset:0},k,b,w,T,l);return I}loadFeature(o){const{featureIndex:l,sourceLayerIndex:d}=o;this.loadVTLayers();const p=this.sourceLayerCoder.decode(d),_=this.vtFeatures[p];if(_[l])return _[l];const b=this.vtLayers[p].feature(l);return _[l]=b,b}hasLayer(o){for(const l of this.bucketLayerIDs)for(const d of l)if(o===d)return!0;return!1}getId(o,l){let d=o.id;if(this.promoteId){const p="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=p&&(d=o.properties[p]),"boolean"==typeof d&&(d=Number(d))}return d}}function Sw(a,o,l,d,p){return ti(a,(_,b)=>{const w=o instanceof Ue?o.get(b):null;return w&&w.evaluate?w.evaluate(l,d,p):w})}function bI(a,o){return o-a}Nt(Dw,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Aw{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new gl({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const d=this.getKey(o,l);return this.positions[d]}trim(){const o=this.width,l=this.height=us(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,d){const p=[];let _=o.length%2==1?-o[o.length-1]*d:0,b=o[0]*d,w=!0;p.push({left:_,right:b,isDash:w,zeroLength:0===o[0]});let T=o[0];for(let I=1;I<o.length;I++){w=!w;const k=o[I];_=T*d,T+=k,b=T*d,p.push({left:_,right:b,isDash:w,zeroLength:0===k})}return p}addRoundDash(o,l,d){const p=l/2;for(let _=-d;_<=d;_++){const b=this.width*(this.nextRow+d+_);let w=0,T=o[w];for(let I=0;I<this.width;I++){I/T.right>1&&(T=o[++w]);const k=Math.abs(I-T.left),F=Math.abs(I-T.right),N=Math.min(k,F);let V;const U=_/d*(p+1);if(T.isDash){const G=p-Math.abs(U);V=Math.sqrt(N*N+G*G)}else V=p-Math.sqrt(N*N+U*U);this.image.data[b+I]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(o,l){for(let T=o.length-1;T>=0;--T){const I=o[T],k=o[T+1];I.zeroLength?o.splice(T,1):k&&k.isDash===I.isDash&&(k.left=I.left,o.splice(T,1))}const d=o[0],p=o[o.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const _=this.width*this.nextRow;let b=0,w=o[b];for(let T=0;T<this.width;T++){T/w.right>1&&(w=o[++b]);const I=Math.abs(T-w.left),k=Math.abs(T-w.right),F=Math.min(I,k);this.image.data[_+T]=Math.max(0,Math.min(255,(w.isDash?F:-F)+l+128))}}addDash(o,l){const d=this.getKey(o,l);if(this.positions[d])return this.positions[d];const p="round"===l,_=p?7:0,b=2*_+1;if(this.nextRow+b>this.height)return ni("LineAtlas out of space"),null;0===o.length&&o.push(1);let w=0;for(let k=0;k<o.length;k++)o[k]<0&&(ni("Negative value is found in line dasharray, replacing values with 0"),o[k]=0),w+=o[k];if(0!==w){const k=this.width/w,F=this.getDashRanges(o,this.width,k);p?this.addRoundDash(F,k,_):this.addRegularDash(F,"square"===l?.5*k:0)}const T=this.nextRow+_;this.nextRow+=b;const I={tl:[T,_],br:[w,0]};return this.positions[d]=I,I}}Nt(Aw,"LineAtlas");class Mw{constructor(o){const l={},d=[];for(const w in o){const T=o[w],I=l[w]={};for(const k in T.glyphs){const F=T.glyphs[+k];if(!F||0===F.bitmap.width||0===F.bitmap.height)continue;const N=F.metrics.localGlyph?2:1,V={x:0,y:0,w:F.bitmap.width+2*N,h:F.bitmap.height+2*N};d.push(V),I[k]=V}}const{w:p,h:_}=bv(d),b=new gl({width:p||1,height:_||1});for(const w in o){const T=o[w];for(const I in T.glyphs){const k=T.glyphs[+I];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const F=l[w][I],N=k.metrics.localGlyph?2:1;gl.copy(k.bitmap,b,{x:0,y:0},{x:F.x+N,y:F.y+N},k.bitmap)}}this.image=b,this.positions=l}}Nt(Mw,"GlyphAtlas");class xI{constructor(o){this.tileID=new ts(o.tileID.overscaledZ,o.tileID.wrap,o.tileID.canonical.z,o.tileID.canonical.x,o.tileID.canonical.y),this.tileZoom=o.tileZoom,this.uid=o.uid,this.zoom=o.zoom,this.canonical=o.tileID.canonical,this.pixelRatio=o.pixelRatio,this.tileSize=o.tileSize,this.source=o.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=o.showCollisionBoxes,this.collectResourceTiming=!!o.collectResourceTiming,this.returnDependencies=!!o.returnDependencies,this.promoteId=o.promoteId,this.enableTerrain=!!o.enableTerrain,this.isSymbolTile=o.isSymbolTile,this.tileTransform=Du(o.tileID.canonical,o.projection),this.projection=o.projection}parse(o,l,d,p,_){this.status="parsing",this.data=o,this.collisionBoxArray=new yy;const b=new yw(Object.keys(o.layers).sort()),w=new Dw(this.tileID,this.promoteId);w.bucketLayerIDs=[];const T={},I=new Aw(256,256),k={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:I,availableImages:d},F=l.familiesBySource[this.source];for(const ve in F){const me=o.layers[ve];if(!me)continue;let Be=!1,Fe=!1;for(const je of F[ve])"symbol"===je[0].type?Be=!0:Fe=!0;if(!0===this.isSymbolTile&&!Be||!1===this.isSymbolTile&&!Fe)continue;1===me.version&&ni(`Vector tile source "${this.source}" layer "${ve}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ze=b.encode(ve),dt=[];for(let je=0;je<me.length;je++){const Xe=me.feature(je),it=w.getId(Xe,ve);dt.push({feature:Xe,id:it,index:je,sourceLayerIndex:Ze})}for(const je of F[ve]){const Xe=je[0];void 0!==this.isSymbolTile&&"symbol"===Xe.type!==this.isSymbolTile||Xe.minzoom&&this.zoom<Math.floor(Xe.minzoom)||Xe.maxzoom&&this.zoom>=Xe.maxzoom||"none"!==Xe.visibility&&(Kv(je,this.zoom,d),(T[Xe.id]=Xe.createBucket({index:w.bucketLayerIDs.length,layers:je,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ze,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:d})).populate(dt,k,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(je.map(it=>it.id)))}}let N,V,U,G;I.trim();const Q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ae=ti(k.glyphDependencies,ve=>Object.keys(ve).map(Number));Object.keys(ae).length?p.send("getGlyphs",{uid:this.uid,stacks:ae},(ve,me)=>{N||(N=ve,V=me,he.call(this))},void 0,!1,Q):V={};const ge=Object.keys(k.iconDependencies);ge.length?p.send("getImages",{icons:ge,source:this.source,tileID:this.tileID,type:"icons"},(ve,me)=>{N||(N=ve,U=me,he.call(this))},void 0,!1,Q):U={};const se=Object.keys(k.patternDependencies);function he(){if(N)return _(N);if(V&&U&&G){const ve=new Mw(V),me=new Xx(U,G);for(const Be in T){const Fe=T[Be];Fe instanceof _d?(Kv(Fe.layers,this.zoom,d),uw(Fe,V,ve.positions,U,me.iconPositions,this.showCollisionBoxes,d,this.tileID.canonical,this.tileZoom,this.projection)):Fe.hasPattern&&(Fe instanceof $g||Fe instanceof iv||Fe instanceof xu)&&(Kv(Fe.layers,this.zoom,d),Fe.addFeatures(k,this.tileID.canonical,me.patternPositions,d,this.tileTransform))}this.status="done",_(null,{buckets:qo(T).filter(Be=>!Be.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ve.image,lineAtlas:I,imageAtlas:me,glyphMap:this.returnDependencies?V:null,iconMap:this.returnDependencies?U:null,glyphPositions:this.returnDependencies?ve.positions:null})}}se.length?p.send("getImages",{icons:se,source:this.source,tileID:this.tileID,type:"patterns"},(ve,me)=>{N||(N=ve,G=me,he.call(this))},void 0,!1,Q):G={},he.call(this)}}function Kv(a,o,l){const d=new Ae(o);for(const p of a)p.recalculate(d,l)}class Xv{constructor(o){this.entries={},this.scheduler=o}request(o,l,d,p){const _=this.entries[o]=this.entries[o]||{callbacks:[]};if(_.result){const[b,w]=_.result;return this.scheduler?this.scheduler.add(()=>{p(b,w)},l):p(b,w),()=>{}}return _.callbacks.push(p),_.cancel||(_.cancel=d((b,w)=>{_.result=[b,w];for(const T of _.callbacks)this.scheduler?this.scheduler.add(()=>{T(b,w)},l):T(b,w);setTimeout(()=>delete this.entries[o],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(b=>b!==p),_.callbacks.length||(_.cancel(),delete this.entries[o]))}}}function Ni(a,o,l){const d=JSON.stringify(a.request);return a.data&&(this.deduped.entries[d]={result:[null,a.data]}),this.deduped.request(d,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},p=>{const _=Ml(a.request,(b,w,T,I)=>{b?p(b):w&&p(null,{vectorTile:l?void 0:new $p(new qp(w)),rawData:w,cacheControl:T,expires:I})});return()=>{_.cancel(),p()}},o)}f.ARRAY_TYPE=ha,f.AUTH_ERR_MSG=rc,f.Aabb=es,f.Actor=class{constructor(a,o,l){this.target=a,this.parent=o,this.mapId=l,this.callbacks={},this.cancelCallbacks={},ds(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=So()?a:ze,this.scheduler=new jv}send(a,o,l,d,p=!1,_){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=_,this.callbacks[b]=l);const w=_o(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:a,hasCallback:!!l,targetMapId:d,mustQueue:p,sourceMapId:this.mapId,data:id(o,w)},w),{cancel:()=>{l&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:d,sourceMapId:this.mapId})}}}receive(a){const o=a.data,l=o.id;if(l&&(!o.targetMapId||this.mapId===o.targetMapId))if("<cancel>"===o.type){const d=this.cancelCallbacks[l];delete this.cancelCallbacks[l],d&&d.cancel()}else if(o.mustQueue||So()){const d=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,o),d&&d.metadata||{type:"message"})}else this.processTask(l,o)}processTask(a,o){if("<response>"===o.type){const l=this.callbacks[a];delete this.callbacks[a],l&&(o.error?l(Kd(o.error)):l(null,Kd(o.data)))}else{const l=_o(this.globalScope)?void 0:[],d=o.hasCallback?(_,b)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:_?id(_):null,data:id(b,l)},l)}:_=>{},p=Kd(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,p,d);else if(this.parent.getWorkerSource){const _=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,_[0],p.source)[_[1]](p,d)}else d(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},f.CanonicalTileID=zg,f.Color=ur,f.ColorMode=pa,f.CullFaceMode=bl,f.DEMData=rm,f.DataConstantProperty=Se,f.DedupedRequest=Xv,f.DepthMode=fa,f.EXTENT=gn,f.Elevation=class{isDataAvailableAtPoint(a){const o=this._source();if(this.isUsingMockSource()||!o||a.y<0||a.y>1)return!1;const l=o.getSource().maxzoom,d=1<<l,p=Math.floor(a.x),_=Math.floor((a.x-p)*d),b=Math.floor(a.y*d),w=this.findDEMTileFor(new ts(l,p,l,_,b));return!(!w||!w.dem)}getAtPointOrZero(a,o=0){return this.getAtPoint(a,o)||0}getAtPoint(a,o,l=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const d=this._source();if(!d||a.y<0||a.y>1)return o;const p=d.getSource().maxzoom,_=1<<p,b=Math.floor(a.x),w=a.x-b,T=new ts(p,b,p,Math.floor(w*_),Math.floor(a.y*_)),I=this.findDEMTileFor(T);if(!I||!I.dem)return o;const k=I.dem,F=1<<I.tileID.canonical.z,N=(w*F-I.tileID.canonical.x)*k.dim,V=(a.y*F-I.tileID.canonical.y)*k.dim,U=Math.floor(N),G=Math.floor(V);return(l?this.exaggeration():1)*Vn(Vn(k.get(U,G),k.get(U,G+1),V-G),Vn(k.get(U+1,G),k.get(U+1,G+1),V-G),N-U)}getAtTileOffset(a,o,l){const d=1<<a.canonical.z;return this.getAtPointOrZero(new _f(a.wrap+(a.canonical.x+o/gn)/d,(a.canonical.y+l/gn)/d))}getAtTileOffsetFunc(a,o,l,d){return p=>{const _=this.getAtTileOffset(a,p.x,p.y),b=d.upVector(a.canonical,p.x,p.y);return cl(b,b,_*d.upVectorScale(a.canonical,o,l).metersToTile),b}}getForTilePoints(a,o,l,d){if(this.isUsingMockSource())return!1;const p=Yv.create(this,a,d);return!!p&&(o.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],l)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(a);if(!o||!o.dem)return null;const l=o.dem.tree,d=o.tileID,p=1<<a.canonical.z-d.canonical.z;let _=a.canonical.x/p-d.canonical.x,b=a.canonical.y/p-d.canonical.y,w=0;for(let T=0;T<a.canonical.z-d.canonical.z&&!l.leaves[w];T++){_*=2,b*=2;const I=2*Math.floor(b)+Math.floor(_);w=l.childOffsets[w]+I,_%=1,b%=1}return{min:this.exaggeration()*l.minimums[w],max:this.exaggeration()*l.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},f.ErrorEvent=Vs,f.EvaluationParameters=Ae,f.Event=Di,f.Evented=ms,f.FillExtrusionBucket=xu,f.Frustum=bg,f.FrustumCorners=Pp,f.GLOBE_RADIUS=Wl,f.GLOBE_SCALE_MATCH_LATITUDE=45,f.GLOBE_ZOOM_THRESHOLD_MAX=6,f.GLOBE_ZOOM_THRESHOLD_MIN=5,f.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,o){const l=new Jt,d=new ao,p=[],_=a+1+2,b=o[0]+1,w=o[0]+1+(1+o.length),T=(I,k,F)=>{let N=I===_-1?I-2:0===I?I:I-1;return N+=F?24575:0,[N,k]};for(let I=0;I<_;++I)l.emplaceBack(...T(I,0,!0));for(let I=0;I<b;++I)for(let k=0;k<_;++k)l.emplaceBack(...T(k,I,(0===k||k===_-1)&&!0));for(let I=0;I<o.length;++I){const k=o[I];for(let F=0;F<_;++F)l.emplaceBack(...T(F,k,!0))}for(let I=0;I<o.length;++I){const k=d.length,F=o[I]+1+2,N=new ao;for(let G=0;G<F-1;G++){const Q=G===F-2,ae=Q?_*(w-o.length+I-G):_;for(let ge=0;ge<_-1;ge++){const se=G*_+ge;0===G||Q||0===ge||ge===_-2?(N.emplaceBack(se+1,se,se+ae),N.emplaceBack(se+ae,se+ae+1,se+1)):(d.emplaceBack(se+1,se,se+ae),d.emplaceBack(se+ae,se+ae+1,se+1))}}const V=Cr.simpleSegment(0,k,l.length,d.length-k);for(let G=0;G<N.uint16.length;G+=3)d.emplaceBack(N.uint16[G],N.uint16[G+1],N.uint16[G+2]);const U=Cr.simpleSegment(0,k,l.length,d.length-k);p.push({withoutSkirts:V,withSkirts:U})}return{vertices:l,indices:d,segments:p}}_createGrid(a){const o=this._fillGridMeshWithLods(64,Op);this._gridSegments=o.segments,this._gridBuffer=a.createVertexBuffer(o.vertices,Rp.members),this._gridIndexBuffer=a.createIndexBuffer(o.indices,!0)}_createPoles(a){const o=new ao;for(let p=0;p<=64;p++)o.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=a.createIndexBuffer(o,!0);const l=new Gs,d=new Gs;this._poleSegments=[];for(let p=0,_=0;p<5;p++){const b=360/(1<<p);l.emplaceBack(0,-Wl,0,.5,0),d.emplaceBack(0,-Wl,0,.5,1);for(let w=0;w<=64;w++){const T=w/64,I=Vn(0,b,T),[k,F,N]=Yr(Ry,Py,I,Wl);l.emplaceBack(k,F,N,T,0),d.emplaceBack(k,F,N,T,1)}this._poleSegments.push(Cr.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(l,TT,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(d,TT,!1)}getGridBuffers(a,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,o){if(!this._wireframeSegments){const l=new jl,d=64,p=d+1+2,_=1;this._wireframeSegments=[];for(let b=0,w=0;b<Op.length;b++){const T=Op[b];for(let k=_;k<T+_;k++)for(let F=_;F<d+_;F++){const N=k*p+F;l.emplaceBack(N,N+1),l.emplaceBack(N,N+p),l.emplaceBack(N,N+p+1)}const I=T*d*3;this._wireframeSegments.push(Cr.simpleSegment(0,w,(T+1)*p,I)),w+=I}this._wireframeIndexBuffer=a.createIndexBuffer(l)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[o]]}},f.GlyphManager=md,f.ImagePosition=Wg,f.LivePerformanceUtils=rt,f.LngLat=li,f.LngLatBounds=ud,f.LocalGlyphMode=Tv,f.MAX_MERCATOR_LATITUDE=zo,f.MercatorCoordinate=_f,f.ONE_EM=ns,f.OverscaledTileID=ts,f.PerformanceMarkers=Le,f.Properties=ft,f.RGBAImage=Ss,f.Ray=vg,f.RequestManager=class{constructor(a,o,l){this._transformRequestFn=a,this._customAccessToken=o,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const a=function(){let o="";for(let l=0;l<10;l++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,o){return this._transformRequestFn&&this._transformRequestFn(a,o)||{url:a}}normalizeStyleURL(a,o){if(!ia(a))return a;const l=Ao(a);return l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeGlyphsURL(a,o){if(!ia(a))return a;const l=Ao(a);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||o)}normalizeSourceURL(a,o,l,d){if(!ia(a))return a;const p=Ao(a);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),l&&p.params.push(`language=${l}`),d&&p.params.push(`worldview=${d}`),this._makeAPIURL(p,this._customAccessToken||o)}normalizeSpriteURL(a,o,l,d){const p=Ao(a);return ia(a)?(p.path=`/styles/v1${p.path}/sprite${o}${l}`,this._makeAPIURL(p,this._customAccessToken||d)):(p.path+=`${o}${l}`,$a(p))}normalizeTileURL(a,o,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!ia(a))return a;const d=Ao(a);d.path=d.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||l&&"raster"!==d.authority&&512===l?"@2x":""}${qe.supported?".webp":"$1"}`),"raster"===d.authority?d.path=`/${Tt.RASTER_URL_PREFIX}${d.path}`:(d.path=d.path.replace(/^.+\/v4\//,"/"),d.path=`/${Tt.TILE_URL_VERSION}${d.path}`);const p=this._customAccessToken||function(_){for(const b of _){const w=b.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(d.params)||Tt.ACCESS_TOKEN;return Tt.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&d.params.push(`sku=${this._skuToken}`),this._makeAPIURL(d,p)}canonicalizeTileURL(a,o){const l=Ao(a);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return a;let d="mapbox://";l.path.match(/^\/raster\/v1\//)?d+=`raster/${l.path.replace(`/${Tt.RASTER_URL_PREFIX}/`,"")}`:d+=`tiles/${l.path.replace(`/${Tt.TILE_URL_VERSION}/`,"")}`;let p=l.params;return o&&(p=p.filter(_=>!_.match(/^access_token=/))),p.length&&(d+=`?${p.join("&")}`),d}canonicalizeTileset(a,o){const l=!!o&&ia(o),d=[];for(const p of a.tiles||[])oc(p)?d.push(this.canonicalizeTileURL(p,l)):d.push(p);return d}_makeAPIURL(a,o){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",d=Ao(Tt.API_URL);if(a.protocol=d.protocol,a.authority=d.authority,"http"===a.protocol){const p=a.params.indexOf("secure");p>=0&&a.params.splice(p,1)}if("/"!==d.path&&(a.path=`${d.path}${a.path}`),!Tt.REQUIRE_ACCESS_TOKEN)return $a(a);if(o=o||Tt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if("s"===o[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return a.params=a.params.filter(p=>-1===p.indexOf("access_token")),a.params.push(`access_token=${o||""}`),$a(a)}},f.ResourceType=qc,f.SegmentVector=Cr,f.SourceCache=dh,f.StencilMode=Mf,f.StructArrayLayout1ui2=wc,f.StructArrayLayout2f1f2i16=qr,f.StructArrayLayout2i4=Jt,f.StructArrayLayout2ui4=jl,f.StructArrayLayout3f12=wo,f.StructArrayLayout3ui6=ao,f.StructArrayLayout4i8=hi,f.StructArrayLayout5f20=Gs,f.Texture=em,f.Tile=Hv,f.Transitionable=yt,f.Uniform1f=Ey,f.Uniform1i=class extends cd{constructor(a){super(a),this.current=0}set(a,o,l){this.fetchUniformLocation(a,o)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},f.Uniform2f=class extends cd{constructor(a){super(a),this.current=[0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}},f.Uniform3f=class extends cd{constructor(a){super(a),this.current=[0,0,0]}set(a,o,l){this.fetchUniformLocation(a,o)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}},f.Uniform4f=gT,f.UniformColor=_T,f.UniformMatrix2f=class extends cd{constructor(a){super(a),this.current=FO}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let d=0;d<4;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}},f.UniformMatrix3f=class extends cd{constructor(a){super(a),this.current=OO}set(a,o,l){if(this.fetchUniformLocation(a,o))for(let d=0;d<9;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},f.UniformMatrix4f=class extends cd{constructor(a){super(a),this.current=Dp}set(a,o,l){if(this.fetchUniformLocation(a,o)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let d=1;d<16;d++)if(l[d]!==this.current[d]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}},f.UnwrappedTileID=Vg,f.ValidationError=bt,f.VectorTileFeature=Fg,f.VectorTileWorkerSource=class extends ms{constructor(a,o,l,d,p){super(),this.actor=a,this.layerIndex=o,this.availableImages=l,this.loadVectorData=p||Ni,this.loading={},this.loaded={},this.deduped=new Xv(a.scheduler),this.isSpriteLoaded=d,this.scheduler=a.scheduler}loadTile(a,o){const l=a.uid,d=a&&a.request,p=d&&d.collectResourceTiming,_=this.loading[l]=new xI(a);_.abort=this.loadVectorData(a,(b,w)=>{const T=!this.loading[l];if(delete this.loading[l],T||b||!w)return _.status="done",T||(this.loaded[l]=_),o(b);const I=w.rawData,k={};w.expires&&(k.expires=w.expires),w.cacheControl&&(k.cacheControl=w.cacheControl),_.vectorTile=w.vectorTile||new $p(new qp(I));const F=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(N,V)=>{if(N||!V)return o(N);const U={};if(p){const G=jt(d);G.length>0&&(U.resourceTiming=JSON.parse(JSON.stringify(G)))}o(null,xn({rawTileData:I.slice(0)},V,k,U))})};this.isSpriteLoaded?F():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(F,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):F()}),this.loaded=this.loaded||{},this.loaded[l]=_})}reloadTile(a,o){const l=this.loaded,d=a.uid,p=this;if(l&&l[d]){const _=l[d];_.showCollisionBoxes=a.showCollisionBoxes,_.enableTerrain=!!a.enableTerrain,_.projection=a.projection,_.tileTransform=Du(a.tileID.canonical,a.projection);const b=(w,T)=>{const I=_.reloadCallback;I&&(delete _.reloadCallback,_.parse(_.vectorTile,p.layerIndex,this.availableImages,p.actor,I)),o(w,T)};"parsing"===_.status?_.reloadCallback=b:"done"===_.status&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(a,o){const l=a.uid,d=this.loading[l];d&&(d.abort&&d.abort(),delete this.loading[l]),o()}removeTile(a,o){const l=this.loaded,d=a.uid;l&&l[d]&&delete l[d],o()}},f.WritingMode=Ma,f.ZoomDependentExpression=Je,f.add=Aa,f.addDynamicAttributes=r_,f.adjoint=function(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],b=o[4],w=o[5],T=o[6],I=o[7],k=o[8];return a[0]=b*k-w*I,a[1]=p*I-d*k,a[2]=d*w-p*b,a[3]=w*T-_*k,a[4]=l*k-p*T,a[5]=p*_-l*w,a[6]=_*I-b*T,a[7]=d*T-l*I,a[8]=l*b-d*_,a},f.asyncAll=Do,f.bezier=ir,f.bindAll=ds,f.boundsAttributes=bw,f.bufferConvexPolygon=function(a,o){const l=[];for(let d=0;d<a.length;d++){const p=Lr(d-1,-1,a.length-1),_=Lr(d+1,-1,a.length-1),b=a[d],w=a[_],T=a[p].sub(b).unit(),I=w.sub(b).unit(),k=I.angleWithSep(T.x,T.y),F=T.add(I).unit().mult(-1*o/Math.sin(k/2));l.push(b.add(F))}return l},f.cacheEntryPossiblyAdded=function(a){Wc++,Wc>Al&&(a.getActor().send("enforceCacheSizeLimit",$r),Wc=0)},f.calculateGlobeLabelMatrix=function(a,o){const{x:l,y:d}=a.point,p=Ay(l,d,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Tc(p,p,Sy(ql(o)))},f.calculateGlobeMatrix=function(a){const{x:o,y:l}=a.point,{lng:d,lat:p}=a._center;return Ay(o,l,a.worldSize,d,p)},f.calculateGlobeMercatorMatrix=function(a){const o=a.pixelsPerMeter,l=o/ml(1,a.center.lat),d=Sa(new Float64Array(16));return or(d,d,[a.point.x,a.point.y,0]),dd(d,d,[l,l,o]),Float32Array.from(d)},f.circumferenceAtLatitude=Oy,f.clamp=_n,f.clearTileCache=function(a){if(!Gc())return;const o=ze.caches.delete(Er);a&&o.catch(a).then(()=>a())},f.clipLine=sI,f.clone=function(a){var o=new ha(16);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=a[3],o[4]=a[4],o[5]=a[5],o[6]=a[6],o[7]=a[7],o[8]=a[8],o[9]=a[9],o[10]=a[10],o[11]=a[11],o[12]=a[12],o[13]=a[13],o[14]=a[14],o[15]=a[15],o},f.clone$1=dr,f.collisionCircleLayout=Wx,f.config=Tt,f.conjugate=function(a,o){return a[0]=-o[0],a[1]=-o[1],a[2]=-o[2],a[3]=o[3],a},f.create=function(){var a=new ha(16);return ha!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},f.create$1=lx,f.createExpression=q,f.createLayout=Kt,f.createStyleLayer=function(a){return"custom"===a.type?new mI(a):new _w[a.type](a)},f.cross=uf,f.degToRad=vt,f.distance=function(a,o){return Math.hypot(o[0]-a[0],o[1]-a[1],o[2]-a[2])},f.div=function(a,o,l){return a[0]=o[0]/l[0],a[1]=o[1]/l[1],a[2]=o[2]/l[2],a},f.dot=ul,f.earthRadius=Bp,f.ease=xr,f.easeCubicInOut=Gi,f.ecefToLatLng=function([a,o,l]){const d=Math.hypot(a,o,l),p=Math.atan2(a,l),_=.5*Math.PI-Math.acos(-o/d);return new li(yn(p),yn(_))},f.emitValidationErrors=Xh,f.endsWith=Ns,f.enforceCacheSizeLimit=function(a){na(),Bs&&Bs.then(o=>{o.keys().then(l=>{for(let d=0;d<l.length-a;d++)o.delete(l[d])})})},f.evaluateSizeForFeature=Hg,f.evaluateSizeForZoom=Zl,f.evaluateVariableOffset=cw,f.evented=de,f.exactEquals=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]&&a[3]===o[3]},f.exactEquals$1=function(a,o){return a[0]===o[0]&&a[1]===o[1]&&a[2]===o[2]},f.exported=Qn,f.exported$1=qe,f.extend=xn,f.extend$1=ba,f.fillExtrusionHeightLift=uv,f.filterObject=zn,f.fromMat4=function(a,o){return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[4],a[4]=o[5],a[5]=o[6],a[6]=o[8],a[7]=o[9],a[8]=o[10],a},f.fromQuat=function(a,o){var l=o[0],d=o[1],p=o[2],_=o[3],b=l+l,w=d+d,T=p+p,I=l*b,k=d*b,F=d*w,N=p*b,V=p*w,U=p*T,G=_*b,Q=_*w,ae=_*T;return a[0]=1-F-U,a[1]=k+ae,a[2]=N-Q,a[3]=0,a[4]=k-ae,a[5]=1-I-U,a[6]=V+G,a[7]=0,a[8]=N+Q,a[9]=V-G,a[10]=1-I-F,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},f.fromRotation=function(a,o){var l=Math.sin(o),d=Math.cos(o);return a[0]=d,a[1]=l,a[2]=0,a[3]=-l,a[4]=d,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},f.fromScaling=Cy,f.furthestTileCorner=function(a){const o=Math.round((a+45+360)%360/90)%4;return ki[o]},f.getAABBPointSquareDist=function(a,o,l){let d=0;for(let p=0;p<2;++p){const _=l?l[p]:0;a[p]>_&&(d+=(a[p]-_)*(a[p]-_)),o[p]<_&&(d+=(_-o[p])*(_-o[p]))}return d},f.getAnchorAlignment=xv,f.getAnchorJustification=Sv,f.getBounds=function(a){let o=1/0,l=1/0,d=-1/0,p=-1/0;for(const _ of a)o=Math.min(o,_.x),l=Math.min(l,_.y),d=Math.max(d,_.x),p=Math.max(p,_.y);return{min:new st(o,l),max:new st(d,p)}},f.getColumn=ar,f.getGridMatrix=function(a,o,l,d){const p=o.getNorth(),_=o.getSouth(),b=o.getWest(),w=o.getEast(),T=1<<a.z,I=w-b,k=p-_,F=I/64,N=-k/Op[l],V=[0,F,0,N,0,0,p,b,0];if(a.z>0){const U=180/d;cx(V,V,[U/I+1,0,0,0,U/k+1,0,-.5*U/F,.5*U/N,1])}return V[2]=T,V[5]=a.x,V[8]=a.y,V},f.getImage=qu,f.getJSON=function(a,o){return Ua(xn(a,{type:"json"}),o)},f.getLatitudinalLod=function(a){const o=zo-5;a=_n(a,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(vt(a))),3);return Math.round(l*(Op.length-1))},f.getMapSessionAPI=Me,f.getPerformanceMeasurement=jt,f.getProjection=Fv,f.getRTLTextPluginStatus=xe,f.getReferrer=zs,f.getTilePoint=function(a,{x:o,y:l},d=0){return new st(((o-d)*a.scale-a.x)*gn,(l*a.scale-a.y)*gn)},f.getTileVec3=function(a,o,l=0){return Gl(((o.x-l)*a.scale-a.x)*gn,(o.y*a.scale-a.y)*gn,Fy(o.z,o.y))},f.getVideo=function(a,o){const l=ze.document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let d=0;d<a.length;d++){const p=ze.document.createElement("source");Zc(a[d])||(l.crossOrigin="Anonymous"),p.src=a[d],l.appendChild(p)}return{cancel:()=>{}}},f.globeCenterToScreenPoint=function(a){const o=[0,0,0],l=Sa(new Float64Array(16));return Tc(l,a.pixelMatrix,a.globeMatrix),yr(o,o,l),new st(o[0],o[1])},f.globeDenormalizeECEF=Sy,f.globeECEFOrigin=function(a,o){const l=[0,0,0];return yr(l,l,pf(ql(o.canonical))),yr(l,l,a),l},f.globeMetersToEcef=hf,f.globeNormalizeECEF=pf,f.globePixelsToTileUnits=function(a,o){return gn/(512*Math.pow(2,a))*Np(ql(o))},f.globePoleMatrixForTile=function(a,o,l){const d=Sa(new Float64Array(16)),p=(o/(1<<a)-.5)*Math.PI*2;return mg(d,l.globeMatrix,p),Float32Array.from(d)},f.globeTileBounds=ql,f.globeTiltAtLngLat=My,f.globeToMercatorTransition=mf,f.globeUseCustomAntiAliasing=function(a,o,l){const d=mf(l.zoom),p=a.style.map._antialias,_=!!o.extStandardDerivatives,b=o.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return 0===d&&!p&&!b&&_},f.identity=Sa,f.identity$1=ET,f.invert=af,f.isFullscreen=function(){return!!ze.document.fullscreenElement||!!ze.document.webkitFullscreenElement},f.isLngLatBehindGlobe=ky,f.isMapAuthenticated=function(a){return Te.has(a)},f.isMapboxURL=ia,f.isSafariWithAntialiasingBug=function(a){const o=a.navigator?a.navigator.userAgent:null;return!!_o(a)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},f.latFromMercatorY=co,f.latLngToECEF=Dc,f.len=BO,f.length=Ap,f.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},f.lngFromMercatorX=Bo,f.loadVectorTile=Ni,f.makeRequest=Ua,f.mapValue=function(a,o,l,d,p){return _n((a-o)/(l-o)*(p-d)+d,d,p)},f.mercatorScale=xg,f.mercatorXfromLng=fl,f.mercatorYfromLat=pl,f.mercatorZfromAltitude=ml,f.mul=gg,f.mul$1=hx,f.multiply=Tc,f.multiply$1=cx,f.multiply$2=xT,f.nextPowerOfTwo=us,f.normalize=Ds,f.normalize$1=zO,f.normalize$2=px,f.number=Vn,f.ortho=function(a,o,l,d,p,_,b){var w=1/(o-l),T=1/(d-p),I=1/(_-b);return a[0]=-2*w,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*I,a[11]=0,a[12]=(o+l)*w,a[13]=(p+d)*T,a[14]=(b+_)*I,a[15]=1,a},f.pbf=qp,f.perspective=function(a,o,l,d,p){var _,b=1/Math.tan(o/2);return a[0]=b/l,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,null!=p&&p!==1/0?(a[10]=(p+d)*(_=1/(d-p)),a[14]=2*p*d*_):(a[10]=-1,a[14]=-2*d),a},f.pick=function(a,o){const l={};for(let d=0;d<o.length;d++){const p=o[d];p in a&&(l[p]=a[p])}return l},f.plugin=Ce,f.pointGeometry=st,f.polesInViewport=function(a){const o=Sa(new Float64Array(16));Tc(o,a.pixelMatrix,a.globeMatrix);const l=[0,dl,0],d=[0,hl,0];return yr(l,l,o),yr(d,d,o),[l[0]>0&&l[0]<=a.width&&l[1]>0&&l[1]<=a.height&&!ky(a,new li(a.center.lat,90)),d[0]>0&&d[0]<=a.width&&d[1]>0&&d[1]<=a.height&&!ky(a,new li(a.center.lat,-90))]},f.polygonContainsPoint=hd,f.polygonIntersectsBox=Gy,f.polygonIntersectsPolygon=Uy,f.polygonizeBounds=function(a,o,l=0,d=!0){const p=new st(l,l),_=a.sub(p),b=o.add(p),w=[_,new st(b.x,_.y),b,new st(_.x,b.y)];return d&&w.push(_.clone()),w},f.posAttributes=Rp,f.postMapLoadEvent=re,f.postPerformanceEvent=Ee,f.postTurnstileEvent=H,f.potpack=bv,f.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},f.radToDeg=yn,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.registerForPluginStateChange=function(a){return a({pluginStatus:J,pluginURL:Y}),de.on("pluginStateChange",a),a},f.removeAuthState=function(a){Te.delete(a)},f.renderColorRamp=Xy,f.resample=bx,f.rotateX=Hl,f.rotateX$1=yg,f.rotateY=mg,f.rotateY$1=CT,f.rotateZ=function(a,o,l){var d=Math.sin(l),p=Math.cos(l),_=o[0],b=o[1],w=o[2],T=o[3],I=o[4],k=o[5],F=o[6],N=o[7];return o!==a&&(a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15]),a[0]=_*p+I*d,a[1]=b*p+k*d,a[2]=w*p+F*d,a[3]=T*p+N*d,a[4]=I*p-_*d,a[5]=k*p-b*d,a[6]=F*p-w*d,a[7]=N*p-T*d,a},f.rotateZ$1=function(a,o,l){l*=.5;var d=o[0],p=o[1],_=o[2],b=o[3],w=Math.sin(l),T=Math.cos(l);return a[0]=d*T+p*w,a[1]=p*T-d*w,a[2]=_*T+b*w,a[3]=b*T-_*w,a},f.scale=dd,f.scale$1=fx,f.scale$2=cl,f.scaleAndAdd=kp,f.set=function(a,o,l,d){return a[0]=o,a[1]=l,a[2]=d,a},f.setCacheLimits=function(a,o){$r=a,Al=o},f.setColumn=function(a,o,l){a[4*o+0]=l[0],a[4*o+1]=l[1],a[4*o+2]=l[2],a[4*o+3]=l[3]},f.setRTLTextPlugin=function(a,o,l=!1){if(J===X||J===ee||J===te)throw new Error("setRTLTextPlugin cannot be called multiple times.");Y=Qn.resolveURL(a),J=X,ne=o,le(),l||ye()},f.smoothstep=wr,f.spec=Ye,f.squaredLength=function(a){var o=a[0],l=a[1],d=a[2];return o*o+l*l+d*d},f.storeAuthState=function(a,o){o?Te.add(a):Te.delete(a)},f.sub=Ic,f.subtract=Ty,f.symbolSize=Kr,f.tileAABB=function(a,o,l,d,p,_,b,w,T){if("globe"===T.name)return function Dy(a,o,l){const d=o/a.worldSize,p=a.globeMatrix;if(l.z<=1){const Fe=ql(l).getCorners();return Ws(Fe,p,d),es.fromPoints(Fe)}const _=Fp(l),b=Lp(_);Ws(b,p,d);const w=Number.MAX_VALUE,T=[-w,-w,-w],I=[w,w,w];if(_.contains(a.center)){for(const dt of b)cf(I,I,dt),Mp(T,T,dt);T[2]=0;const Fe=a.point,Ze=[Fe.x*d,Fe.y*d,0];return cf(I,I,Ze),Mp(T,T,Ze),new es(I,T)}const k=[p[12]*d,p[13]*d,p[14]*d],F=_.getCenter(),N=_n(a.center.lat,-zo,zo),V=_n(F.lat,-zo,zo),U=fl(a.center.lng),G=pl(N);let Q=U-fl(F.lng);const ae=G-pl(V);Q>.5?Q-=1:Q<-.5&&(Q+=1);let ge=0;Math.abs(Q)>Math.abs(ae)?ge=Q>=0?1:3:(ge=ae>=0?0:2,kp(k,k,[p[4]*d,p[5]*d,p[6]*d],-Math.sin(vt(ae>=0?_.getSouth():_.getNorth()))*Wl));const se=b[ge],he=b[(ge+1)%4],ve=new DT(se,he,k),me=[Iy(ve,0)||se[0],Iy(ve,1)||se[1],Iy(ve,2)||se[2]],Be=mf(a.zoom);if(Be>0){const Fe=function({x:dt,y:je,z:Xe},it,ut,pt,Ge){const wt=1/(1<<Xe);let en=dt*wt,Dt=en+wt,Ut=je*wt,It=Ut+wt,ln=0;const Gn=(en+Dt)/2-pt;return Gn>.5?ln=-1:Gn<-.5&&(ln=1),en=((en+ln)*it-(pt*=it))*ut+pt,Dt=((Dt+ln)*it-pt)*ut+pt,Ut=(Ut*it-(Ge*=it))*ut+Ge,It=(It*it-Ge)*ut+Ge,[[en,It,0],[Dt,It,0],[Dt,Ut,0],[en,Ut,0]]}(l,o,a._pixelsPerMercatorPixel,U,G);for(let dt=0;dt<b.length;dt++)th(b[dt],Fe[dt],Be);const Ze=Aa([],Fe[ge],Fe[(ge+1)%4]);cl(Ze,Ze,.5),th(me,Ze,Be)}for(const Fe of b)cf(I,I,Fe),Mp(T,T,Fe);return I[2]=Math.min(se[2],he[2]),cf(I,I,me),Mp(T,T,me),new es(I,T)}(a,o,new zg(l,d,p));const I=Du({z:l,x:d,y:p},T);return new es([(_+I.x/I.scale)*o,o*(I.y/I.scale),b],[(_+I.x2/I.scale)*o,o*(I.y2/I.scale),w])},f.tileCornersToBounds=Fp,f.tileTransform=Du,f.transformMat3=function(a,o,l){var d=o[0],p=o[1],_=o[2];return a[0]=d*l[0]+p*l[3]+_*l[6],a[1]=d*l[1]+p*l[4]+_*l[7],a[2]=d*l[2]+p*l[5]+_*l[8],a},f.transformMat4=yr,f.transformMat4$1=yu,f.transformQuat=dx,f.transitionTileAABBinECEF=_x,f.translate=or,f.transpose=function(a,o){if(a===o){var l=o[1],d=o[2],p=o[5];a[1]=o[3],a[2]=o[6],a[3]=l,a[5]=o[7],a[6]=d,a[7]=p}else a[0]=o[0],a[1]=o[3],a[2]=o[6],a[3]=o[1],a[4]=o[4],a[5]=o[7],a[6]=o[2],a[7]=o[5],a[8]=o[8];return a},f.triggerPluginCompletionEvent=ce,f.uniqueId=za,f.updateGlobeVertexNormal=function(a,o,l,d,p){const _=5*o+2;a.float32[_+0]=l,a.float32[_+1]=d,a.float32[_+2]=p},f.validateCustomStyleLayer=function(a){const o=[],l=a.id;return void 0===l&&o.push({message:`layers.${l}: missing required property "id"`}),void 0===a.render&&o.push({message:`layers.${l}: missing required method "render"`}),a.renderingMode&&"2d"!==a.renderingMode&&"3d"!==a.renderingMode&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},f.validateFilter=a=>tl(Yh(a)),f.validateFog=a=>tl(bp(a)),f.validateLayer=a=>tl(Kh(a)),f.validateLight=a=>tl(Cs(a)),f.validateSource=a=>tl(Wd(a)),f.validateStyle=Zd,f.validateTerrain=a=>tl(vp(a)),f.values=qo,f.vectorTile=Pg,f.version=Qt,f.warnOnce=ni,f.window=ze,f.wrap=Lr}),$e(0,function(f){function ze(oe){if("number"==typeof oe||"boolean"==typeof oe||"string"==typeof oe||null==oe)return JSON.stringify(oe);if(Array.isArray(oe)){let W="[";for(const re of oe)W+=`${ze(re)},`;return`${W}]`}let H="{";for(const W of Object.keys(oe).sort())H+=`${W}:${ze(oe[W])},`;return`${H}}`}function Qt(oe){let H="";for(const W of f.refProperties)H+=`/${ze(oe[W])}`;return H}class Pt{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,W){for(const fe of H)this._layerConfigs[fe.id]=fe,(this._layers[fe.id]=f.createStyleLayer(fe)).compileFilter(),this.keyCache[fe.id]&&delete this.keyCache[fe.id];for(const fe of W)delete this.keyCache[fe],delete this._layerConfigs[fe],delete this._layers[fe];this.familiesBySource={};const re=function(fe,Ee){const ke={};for(let Te=0;Te<fe.length;Te++){const Le=Ee&&Ee[fe[Te].id]||Qt(fe[Te]);Ee&&(Ee[fe[Te].id]=Le);let rt=ke[Le];rt||(rt=ke[Le]=[]),rt.push(fe[Te])}const Me=[];for(const Te in ke)Me.push(ke[Te]);return Me}(f.values(this._layerConfigs),this.keyCache);for(const fe of re){const Ee=fe.map(At=>this._layers[At.id]),ke=Ee[0];if("none"===ke.visibility)continue;const Me=ke.source||"";let Te=this.familiesBySource[Me];Te||(Te=this.familiesBySource[Me]={});const Le=ke.sourceLayer||"_geojsonTileLayer";let rt=Te[Le];rt||(rt=Te[Le]=[]),rt.push(Ee)}}}class Tt{loadTile(H,W){const{uid:re,encoding:fe,rawImageData:Ee,padding:ke,buildQuadTree:Me}=H,Te=f.window.ImageBitmap&&Ee instanceof f.window.ImageBitmap?this.getImageData(Ee,ke):Ee;W(null,new f.DEMData(re,Te,fe,ke<1,Me))}getImageData(H,W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const re=this.offscreenCanvasContext.getImageData(-W,-W,H.width+2*W,H.height+2*W);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}var qe=function oe(H,W){var re,fe=H&&H.type;if("FeatureCollection"===fe)for(re=0;re<H.features.length;re++)oe(H.features[re],W);else if("GeometryCollection"===fe)for(re=0;re<H.geometries.length;re++)oe(H.geometries[re],W);else if("Feature"===fe)oe(H.geometry,W);else if("Polygon"===fe)xt(H.coordinates,W);else if("MultiPolygon"===fe)for(re=0;re<H.coordinates.length;re++)xt(H.coordinates[re],W);return H};function xt(oe,H){if(0!==oe.length){Bt(oe[0],H);for(var W=1;W<oe.length;W++)Bt(oe[W],!H)}}function Bt(oe,H){for(var W=0,re=0,fe=0,Ee=oe.length,ke=Ee-1;fe<Ee;ke=fe++){var Me=(oe[fe][0]-oe[ke][0])*(oe[ke][1]+oe[fe][1]),Te=W+Me;re+=Math.abs(W)>=Math.abs(Me)?W-Te+Me:Me-Te+W,W=Te}W+re>=0!=!!H&&oe.reverse()}const dn=f.VectorTileFeature.prototype.toGeoJSON;class Kn{constructor(H){this._feature=H,this.extent=f.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(1===this._feature.type){const H=[];for(const W of this._feature.geometry)H.push([new f.pointGeometry(W[0],W[1])]);return H}{const H=[];for(const W of this._feature.geometry){const re=[];for(const fe of W)re.push(new f.pointGeometry(fe[0],fe[1]));H.push(re)}return H}}toGeoJSON(H,W,re){return dn.call(this,H,W,re)}}class Ot{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=H.length,this._features=H}feature(H){return new Kn(this._features[H])}}var mt={},rn={get exports(){return mt},set exports(oe){mt=oe}},nn=f.pointGeometry,st=f.vectorTile.VectorTileFeature,ue=De;function De(oe,H){this.options=H||{},this.features=oe,this.length=oe.length}function at(oe,H){this.id="number"==typeof oe.id?oe.id:void 0,this.type=oe.type,this.rawGeometry=1===oe.type?[oe.geometry]:oe.geometry,this.properties=oe.tags,this.extent=H||4096}De.prototype.feature=function(oe){return new at(this.features[oe],this.options.extent)},at.prototype.loadGeometry=function(){var oe=this.rawGeometry;this.geometry=[];for(var H=0;H<oe.length;H++){for(var W=oe[H],re=[],fe=0;fe<W.length;fe++)re.push(new nn(W[fe][0],W[fe][1]));this.geometry.push(re)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var oe=this.geometry,H=1/0,W=-1/0,re=1/0,fe=-1/0,Ee=0;Ee<oe.length;Ee++)for(var ke=oe[Ee],Me=0;Me<ke.length;Me++){var Te=ke[Me];H=Math.min(H,Te.x),W=Math.max(W,Te.x),re=Math.min(re,Te.y),fe=Math.max(fe,Te.y)}return[H,re,W,fe]},at.prototype.toGeoJSON=st.prototype.toGeoJSON;var vt=f.pbf,yn=ue;function ki(oe){var H=new vt;return function(W,re){for(var fe in W.layers)re.writeMessage(3,Gi,W.layers[fe])}(oe,H),H.finish()}function Gi(oe,H){var W;H.writeVarintField(15,oe.version||1),H.writeStringField(1,oe.name||""),H.writeVarintField(5,oe.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<oe.length;W++)re.feature=oe.feature(W),H.writeMessage(2,ir,re);var fe=re.keys;for(W=0;W<fe.length;W++)H.writeStringField(3,fe[W]);var Ee=re.values;for(W=0;W<Ee.length;W++)H.writeMessage(4,Do,Ee[W])}function ir(oe,H){var W=oe.feature;void 0!==W.id&&H.writeVarintField(1,W.id),H.writeMessage(2,xr,oe),H.writeVarintField(3,W.type),H.writeMessage(4,Lr,W)}function xr(oe,H){var W=oe.feature,re=oe.keys,fe=oe.values,Ee=oe.keycache,ke=oe.valuecache;for(var Me in W.properties){var Te=W.properties[Me],Le=Ee[Me];if(null!==Te){void 0===Le&&(re.push(Me),Ee[Me]=Le=re.length-1),H.writeVarint(Le);var rt=typeof Te;"string"!==rt&&"boolean"!==rt&&"number"!==rt&&(Te=JSON.stringify(Te));var At=rt+":"+Te,tt=ke[At];void 0===tt&&(fe.push(Te),ke[At]=tt=fe.length-1),H.writeVarint(tt)}}}function _n(oe,H){return(H<<3)+(7&oe)}function wr(oe){return oe<<1^oe>>31}function Lr(oe,H){for(var W=oe.loadGeometry(),re=oe.type,fe=0,Ee=0,ke=W.length,Me=0;Me<ke;Me++){var Te=W[Me],Le=1;1===re&&(Le=Te.length),H.writeVarint(_n(1,Le));for(var rt=3===re?Te.length-1:Te.length,At=0;At<rt;At++){1===At&&1!==re&&H.writeVarint(_n(2,rt-1));var tt=Te[At].x-fe,jt=Te[At].y-Ee;H.writeVarint(wr(tt)),H.writeVarint(wr(jt)),fe+=tt,Ee+=jt}3===re&&H.writeVarint(_n(7,1))}}function Do(oe,H){var W=typeof oe;"string"===W?H.writeStringField(1,oe):"boolean"===W?H.writeBooleanField(7,oe):"number"===W&&(oe%1!=0?H.writeDoubleField(3,oe):oe<0?H.writeSVarintField(6,oe):H.writeVarintField(5,oe))}function qo(oe,H,W,re,fe,Ee){if(fe-re<=W)return;const ke=re+fe>>1;xn(oe,H,ke,re,fe,Ee%2),qo(oe,H,W,re,ke-1,Ee+1),qo(oe,H,W,ke+1,fe,Ee+1)}function xn(oe,H,W,re,fe,Ee){for(;fe>re;){if(fe-re>600){const Le=fe-re+1,rt=W-re+1,At=Math.log(Le),tt=.5*Math.exp(2*At/3),jt=.5*Math.sqrt(At*tt*(Le-tt)/Le)*(rt-Le/2<0?-1:1);xn(oe,H,W,Math.max(re,Math.floor(W-rt*tt/Le+jt)),Math.min(fe,Math.floor(W+(Le-rt)*tt/Le+jt)),Ee)}const ke=H[2*W+Ee];let Me=re,Te=fe;for(cs(oe,H,re,W),H[2*fe+Ee]>ke&&cs(oe,H,re,fe);Me<Te;){for(cs(oe,H,Me,Te),Me++,Te--;H[2*Me+Ee]<ke;)Me++;for(;H[2*Te+Ee]>ke;)Te--}H[2*re+Ee]===ke?cs(oe,H,re,Te):(Te++,cs(oe,H,Te,fe)),Te<=W&&(re=Te+1),W<=Te&&(fe=Te-1)}}function cs(oe,H,W,re){za(oe,W,re),za(H,2*W,2*re),za(H,2*W+1,2*re+1)}function za(oe,H,W){const re=oe[H];oe[H]=oe[W],oe[W]=re}function ta(oe,H,W,re){const fe=oe-W,Ee=H-re;return fe*fe+Ee*Ee}rn.exports=ki,mt.fromVectorTileJs=ki,mt.fromGeojsonVt=function(oe,H){H=H||{};var W={};for(var re in oe)W[re]=new yn(oe[re].features,H),W[re].name=re,W[re].version=H.version,W[re].extent=H.extent;return ki({layers:W})},mt.GeoJSONWrapper=yn;const us=oe=>oe[0],si=oe=>oe[1];class ds{constructor(H,W=us,re=si,fe=64,Ee=Float64Array){this.nodeSize=fe,this.points=H;const ke=H.length<65536?Uint16Array:Uint32Array,Me=this.ids=new ke(H.length),Te=this.coords=new Ee(2*H.length);for(let Le=0;Le<H.length;Le++)Me[Le]=Le,Te[2*Le]=W(H[Le]),Te[2*Le+1]=re(H[Le]);qo(Me,Te,fe,0,Me.length-1,0)}range(H,W,re,fe){return function(Ee,ke,Me,Te,Le,rt,At){const tt=[0,Ee.length-1,0],jt=[];let zt,Zt;for(;tt.length;){const Gt=tt.pop(),Dn=tt.pop(),Qn=tt.pop();if(Dn-Qn<=At){for(let Di=Qn;Di<=Dn;Di++)zt=ke[2*Di],Zt=ke[2*Di+1],zt>=Me&&zt<=Le&&Zt>=Te&&Zt<=rt&&jt.push(Ee[Di]);continue}const on=Math.floor((Qn+Dn)/2);zt=ke[2*on],Zt=ke[2*on+1],zt>=Me&&zt<=Le&&Zt>=Te&&Zt<=rt&&jt.push(Ee[on]);const ii=(Gt+1)%2;(0===Gt?Me<=zt:Te<=Zt)&&(tt.push(Qn),tt.push(on-1),tt.push(ii)),(0===Gt?Le>=zt:rt>=Zt)&&(tt.push(on+1),tt.push(Dn),tt.push(ii))}return jt}(this.ids,this.coords,H,W,re,fe,this.nodeSize)}within(H,W,re){return function(fe,Ee,ke,Me,Te,Le){const rt=[0,fe.length-1,0],At=[],tt=Te*Te;for(;rt.length;){const jt=rt.pop(),zt=rt.pop(),Zt=rt.pop();if(zt-Zt<=Le){for(let ii=Zt;ii<=zt;ii++)ta(Ee[2*ii],Ee[2*ii+1],ke,Me)<=tt&&At.push(fe[ii]);continue}const Gt=Math.floor((Zt+zt)/2),Dn=Ee[2*Gt],Qn=Ee[2*Gt+1];ta(Dn,Qn,ke,Me)<=tt&&At.push(fe[Gt]);const on=(jt+1)%2;(0===jt?ke-Te<=Dn:Me-Te<=Qn)&&(rt.push(Zt),rt.push(Gt-1),rt.push(on)),(0===jt?ke+Te>=Dn:Me+Te>=Qn)&&(rt.push(Gt+1),rt.push(zt),rt.push(on))}return At}(this.ids,this.coords,H,W,re,this.nodeSize)}}const Ns={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:oe=>oe},ti=Math.fround||(zn=new Float32Array(1),oe=>(zn[0]=+oe,zn[0]));var zn;class dr{constructor(H){this.options=_o(Object.create(Ns),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:W,minZoom:re,maxZoom:fe,nodeSize:Ee}=this.options;W&&console.time("total time");const ke=`prepare ${H.length} points`;W&&console.time(ke),this.points=H;let Me=[];for(let Te=0;Te<H.length;Te++)H[Te].geometry&&Me.push(ni(H[Te],Te));this.trees[fe+1]=new ds(Me,va,ar,Ee,Float32Array),W&&console.timeEnd(ke);for(let Te=fe;Te>=re;Te--){const Le=+Date.now();Me=this._cluster(Me,Te),this.trees[Te]=new ds(Me,va,ar,Ee,Float32Array),W&&console.log("z%d: %d clusters in %dms",Te,Me.length,+Date.now()-Le)}return W&&console.timeEnd("total time"),this}getClusters(H,W){let re=((H[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,H[1]));let Ee=180===H[2]?180:((H[2]+180)%360+360)%360-180;const ke=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)re=-180,Ee=180;else if(re>Ee){const rt=this.getClusters([re,fe,180,ke],W),At=this.getClusters([-180,fe,Ee,ke],W);return rt.concat(At)}const Me=this.trees[this._limitZoom(W)],Te=Me.range(So(re),Wn(ke),So(Ee),Wn(fe)),Le=[];for(const rt of Te){const At=Me.points[rt];Le.push(At.numPoints?hs(At):this.points[At.index])}return Le}getChildren(H){const W=this._getOriginId(H),re=this._getOriginZoom(H),fe="No cluster with the specified id.",Ee=this.trees[re];if(!Ee)throw new Error(fe);const ke=Ee.points[W];if(!ke)throw new Error(fe);const Me=this.options.radius/(this.options.extent*Math.pow(2,re-1)),Te=Ee.within(ke.x,ke.y,Me),Le=[];for(const rt of Te){const At=Ee.points[rt];At.parentId===H&&Le.push(At.numPoints?hs(At):this.points[At.index])}if(0===Le.length)throw new Error(fe);return Le}getLeaves(H,W,re){const fe=[];return this._appendLeaves(fe,H,W=W||10,re=re||0,0),fe}getTile(H,W,re){const fe=this.trees[this._limitZoom(H)],Ee=Math.pow(2,H),{extent:ke,radius:Me}=this.options,Te=Me/ke,Le=(re-Te)/Ee,rt=(re+1+Te)/Ee,At={features:[]};return this._addTileFeatures(fe.range((W-Te)/Ee,Le,(W+1+Te)/Ee,rt),fe.points,W,re,Ee,At),0===W&&this._addTileFeatures(fe.range(1-Te/Ee,Le,1,rt),fe.points,Ee,re,Ee,At),W===Ee-1&&this._addTileFeatures(fe.range(0,Le,Te/Ee,rt),fe.points,-1,re,Ee,At),At.features.length?At:null}getClusterExpansionZoom(H){let W=this._getOriginZoom(H)-1;for(;W<=this.options.maxZoom;){const re=this.getChildren(H);if(W++,1!==re.length)break;H=re[0].properties.cluster_id}return W}_appendLeaves(H,W,re,fe,Ee){const ke=this.getChildren(W);for(const Me of ke){const Te=Me.properties;if(Te&&Te.cluster?Ee+Te.point_count<=fe?Ee+=Te.point_count:Ee=this._appendLeaves(H,Te.cluster_id,re,fe,Ee):Ee<fe?Ee++:H.push(Me),H.length===re)break}return Ee}_addTileFeatures(H,W,re,fe,Ee,ke){for(const Me of H){const Te=W[Me],Le=Te.numPoints;let rt,At,tt;if(Le)rt=Xn(Te),At=Te.x,tt=Te.y;else{const Zt=this.points[Te.index];rt=Zt.properties,At=So(Zt.geometry.coordinates[0]),tt=Wn(Zt.geometry.coordinates[1])}const jt={type:1,geometry:[[Math.round(this.options.extent*(At*Ee-re)),Math.round(this.options.extent*(tt*Ee-fe))]],tags:rt};let zt;Le?zt=Te.id:this.options.generateId?zt=Te.index:this.points[Te.index].id&&(zt=this.points[Te.index].id),void 0!==zt&&(jt.id=zt),ke.features.push(jt)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,W){const re=[],{radius:fe,extent:Ee,reduce:ke,minPoints:Me}=this.options,Te=fe/(Ee*Math.pow(2,W));for(let Le=0;Le<H.length;Le++){const rt=H[Le];if(rt.zoom<=W)continue;rt.zoom=W;const At=this.trees[W+1],tt=At.within(rt.x,rt.y,Te),jt=rt.numPoints||1;let zt=jt;for(const Zt of tt){const Gt=At.points[Zt];Gt.zoom>W&&(zt+=Gt.numPoints||1)}if(zt>jt&&zt>=Me){let Zt=rt.x*jt,Gt=rt.y*jt,Dn=ke&&jt>1?this._map(rt,!0):null;const Qn=(Le<<5)+(W+1)+this.points.length;for(const on of tt){const ii=At.points[on];if(ii.zoom<=W)continue;ii.zoom=W;const Di=ii.numPoints||1;Zt+=ii.x*Di,Gt+=ii.y*Di,ii.parentId=Qn,ke&&(Dn||(Dn=this._map(rt,!0)),ke(Dn,this._map(ii)))}rt.parentId=Qn,re.push(cn(Zt/zt,Gt/zt,Qn,zt,Dn))}else if(re.push(rt),zt>1)for(const Zt of tt){const Gt=At.points[Zt];Gt.zoom<=W||(Gt.zoom=W,re.push(Gt))}}return re}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,W){if(H.numPoints)return W?_o({},H.properties):H.properties;const re=this.points[H.index].properties,fe=this.options.map(re);return W&&fe===re?_o({},fe):fe}}function cn(oe,H,W,re,fe){return{x:ti(oe),y:ti(H),zoom:1/0,id:W,parentId:-1,numPoints:re,properties:fe}}function ni(oe,H){const[W,re]=oe.geometry.coordinates;return{x:ti(So(W)),y:ti(Wn(re)),zoom:1/0,index:H,parentId:-1}}function hs(oe){return{type:"Feature",id:oe.id,properties:Xn(oe),geometry:{type:"Point",coordinates:[(H=oe.x,360*(H-.5)),Zo(oe.y)]}};var H}function Xn(oe){const H=oe.numPoints,W=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return _o(_o({},oe.properties),{cluster:!0,cluster_id:oe.id,point_count:H,point_count_abbreviated:W})}function So(oe){return oe/360+.5}function Wn(oe){const H=Math.sin(oe*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function Zo(oe){const H=(180-360*oe)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function _o(oe,H){for(const W in H)oe[W]=H[W];return oe}function va(oe){return oe.x}function ar(oe){return oe.y}function Er(oe,H,W,re){for(var fe,Ee=re,ke=W-H>>1,Me=W-H,Te=oe[H],Le=oe[H+1],rt=oe[W],At=oe[W+1],tt=H+3;tt<W;tt+=3){var jt=Bs(oe[tt],oe[tt+1],Te,Le,rt,At);if(jt>Ee)fe=tt,Ee=jt;else if(jt===Ee){var zt=Math.abs(tt-ke);zt<Me&&(fe=tt,Me=zt)}}Ee>re&&(fe-H>3&&Er(oe,H,fe,re),oe[fe+2]=Ee,W-fe>3&&Er(oe,fe,W,re))}function Bs(oe,H,W,re,fe,Ee){var ke=fe-W,Me=Ee-re;if(0!==ke||0!==Me){var Te=((oe-W)*ke+(H-re)*Me)/(ke*ke+Me*Me);Te>1?(W=fe,re=Ee):Te>0&&(W+=ke*Te,re+=Me*Te)}return(ke=oe-W)*ke+(Me=H-re)*Me}function Yo(oe,H,W,re){var fe={id:void 0===oe?null:oe,type:H,geometry:W,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ee){var ke=Ee.geometry,Me=Ee.type;if("Point"===Me||"MultiPoint"===Me||"LineString"===Me)$r(Ee,ke);else if("Polygon"===Me||"MultiLineString"===Me)for(var Te=0;Te<ke.length;Te++)$r(Ee,ke[Te]);else if("MultiPolygon"===Me)for(Te=0;Te<ke.length;Te++)for(var Le=0;Le<ke[Te].length;Le++)$r(Ee,ke[Te][Le])}(fe),fe}function $r(oe,H){for(var W=0;W<H.length;W+=3)oe.minX=Math.min(oe.minX,H[W]),oe.minY=Math.min(oe.minY,H[W+1]),oe.maxX=Math.max(oe.maxX,H[W]),oe.maxY=Math.max(oe.maxY,H[W+1])}function Al(oe,H,W,re){if(H.geometry){var fe=H.geometry.coordinates,Ee=H.geometry.type,ke=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Me=[],Te=H.id;if(W.promoteId?Te=H.properties[W.promoteId]:W.generateId&&(Te=re||0),"Point"===Ee)Gc(fe,Me);else if("MultiPoint"===Ee)for(var Le=0;Le<fe.length;Le++)Gc(fe[Le],Me);else if("LineString"===Ee)na(fe,Me,ke,!1);else if("MultiLineString"===Ee){if(W.lineMetrics){for(Le=0;Le<fe.length;Le++)na(fe[Le],Me=[],ke,!1),oe.push(Yo(Te,"LineString",Me,H.properties));return}Va(fe,Me,ke,!1)}else if("Polygon"===Ee)Va(fe,Me,ke,!0);else{if("MultiPolygon"!==Ee){if("GeometryCollection"===Ee){for(Le=0;Le<H.geometry.geometries.length;Le++)Al(oe,{id:Te,geometry:H.geometry.geometries[Le],properties:H.properties},W,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Le=0;Le<fe.length;Le++){var rt=[];Va(fe[Le],rt,ke,!0),Me.push(rt)}}oe.push(Yo(Te,Ee,Me,H.properties))}}function Gc(oe,H){H.push(Wc(oe[0])),H.push(qc(oe[1])),H.push(0)}function na(oe,H,W,re){for(var fe,Ee,ke=0,Me=0;Me<oe.length;Me++){var Te=Wc(oe[Me][0]),Le=qc(oe[Me][1]);H.push(Te),H.push(Le),H.push(0),Me>0&&(ke+=re?(fe*Le-Te*Ee)/2:Math.sqrt(Math.pow(Te-fe,2)+Math.pow(Le-Ee,2))),fe=Te,Ee=Le}var rt=H.length-3;H[2]=1,Er(H,0,rt,W),H[rt+2]=1,H.size=Math.abs(ke),H.start=0,H.end=H.size}function Va(oe,H,W,re){for(var fe=0;fe<oe.length;fe++){var Ee=[];na(oe[fe],Ee,W,re),H.push(Ee)}}function Wc(oe){return oe/360+.5}function qc(oe){var H=Math.sin(oe*Math.PI/180),W=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return W<0?0:W>1?1:W}function wn(oe,H,W,re,fe,Ee,ke,Me){if(re/=H,Ee>=(W/=H)&&ke<re)return oe;if(ke<W||Ee>=re)return null;for(var Te=[],Le=0;Le<oe.length;Le++){var rt=oe[Le],At=rt.geometry,tt=rt.type,jt=0===fe?rt.minX:rt.minY,zt=0===fe?rt.maxX:rt.maxY;if(jt>=W&&zt<re)Te.push(rt);else if(!(zt<W||jt>=re)){var Zt=[];if("Point"===tt||"MultiPoint"===tt)zs(At,Zt,W,re,fe);else if("LineString"===tt)Ua(At,Zt,W,re,fe,!1,Me.lineMetrics);else if("MultiLineString"===tt)Zc(At,Zt,W,re,fe,!1);else if("Polygon"===tt)Zc(At,Zt,W,re,fe,!0);else if("MultiPolygon"===tt)for(var Gt=0;Gt<At.length;Gt++){var Dn=[];Zc(At[Gt],Dn,W,re,fe,!0),Dn.length&&Zt.push(Dn)}if(Zt.length){if(Me.lineMetrics&&"LineString"===tt){for(Gt=0;Gt<Zt.length;Gt++)Te.push(Yo(rt.id,tt,Zt[Gt],rt.tags));continue}"LineString"!==tt&&"MultiLineString"!==tt||(1===Zt.length?(tt="LineString",Zt=Zt[0]):tt="MultiLineString"),"Point"!==tt&&"MultiPoint"!==tt||(tt=3===Zt.length?"Point":"MultiPoint"),Te.push(Yo(rt.id,tt,Zt,rt.tags))}}}return Te.length?Te:null}function zs(oe,H,W,re,fe){for(var Ee=0;Ee<oe.length;Ee+=3){var ke=oe[Ee+fe];ke>=W&&ke<=re&&(H.push(oe[Ee]),H.push(oe[Ee+1]),H.push(oe[Ee+2]))}}function Ua(oe,H,W,re,fe,Ee,ke){for(var Me,Te,Le=Ml(oe),rt=0===fe?fs:ic,At=oe.start,tt=0;tt<oe.length-3;tt+=3){var jt=oe[tt],zt=oe[tt+1],Zt=oe[tt+2],Gt=oe[tt+3],Dn=oe[tt+4],Qn=0===fe?jt:zt,on=0===fe?Gt:Dn,ii=!1;ke&&(Me=Math.sqrt(Math.pow(jt-Gt,2)+Math.pow(zt-Dn,2))),Qn<W?on>W&&(Te=rt(Le,jt,zt,Gt,Dn,W),ke&&(Le.start=At+Me*Te)):Qn>re?on<re&&(Te=rt(Le,jt,zt,Gt,Dn,re),ke&&(Le.start=At+Me*Te)):Yc(Le,jt,zt,Zt),on<W&&Qn>=W&&(Te=rt(Le,jt,zt,Gt,Dn,W),ii=!0),on>re&&Qn<=re&&(Te=rt(Le,jt,zt,Gt,Dn,re),ii=!0),!Ee&&ii&&(ke&&(Le.end=At+Me*Te),H.push(Le),Le=Ml(oe)),ke&&(At+=Me)}var Di=oe.length-3;jt=oe[Di],zt=oe[Di+1],Zt=oe[Di+2],(Qn=0===fe?jt:zt)>=W&&Qn<=re&&Yc(Le,jt,zt,Zt),Di=Le.length-3,Ee&&Di>=3&&(Le[Di]!==Le[0]||Le[Di+1]!==Le[1])&&Yc(Le,Le[0],Le[1],Le[2]),Le.length&&H.push(Le)}function Ml(oe){var H=[];return H.size=oe.size,H.start=oe.start,H.end=oe.end,H}function Zc(oe,H,W,re,fe,Ee){for(var ke=0;ke<oe.length;ke++)Ua(oe[ke],H,W,re,fe,Ee,!1)}function Yc(oe,H,W,re){oe.push(H),oe.push(W),oe.push(re)}function fs(oe,H,W,re,fe,Ee){var ke=(Ee-H)/(re-H);return oe.push(Ee),oe.push(W+(fe-W)*ke),oe.push(1),ke}function ic(oe,H,W,re,fe,Ee){var ke=(Ee-W)/(fe-W);return oe.push(H+(re-H)*ke),oe.push(Ee),oe.push(1),ke}function qu(oe,H){for(var W=[],re=0;re<oe.length;re++){var fe,Ee=oe[re],ke=Ee.type;if("Point"===ke||"MultiPoint"===ke||"LineString"===ke)fe=rc(Ee.geometry,H);else if("MultiLineString"===ke||"Polygon"===ke){fe=[];for(var Me=0;Me<Ee.geometry.length;Me++)fe.push(rc(Ee.geometry[Me],H))}else if("MultiPolygon"===ke)for(fe=[],Me=0;Me<Ee.geometry.length;Me++){for(var Te=[],Le=0;Le<Ee.geometry[Me].length;Le++)Te.push(rc(Ee.geometry[Me][Le],H));fe.push(Te)}W.push(Yo(Ee.id,ke,fe,Ee.tags))}return W}function rc(oe,H){var W=[];W.size=oe.size,void 0!==oe.start&&(W.start=oe.start,W.end=oe.end);for(var re=0;re<oe.length;re+=3)W.push(oe[re]+H,oe[re+1],oe[re+2]);return W}function ia(oe,H){if(oe.transformed)return oe;var W,re,fe,Ee=1<<oe.z,ke=oe.x,Me=oe.y;for(W=0;W<oe.features.length;W++){var Te=oe.features[W],Le=Te.geometry,rt=Te.type;if(Te.geometry=[],1===rt)for(re=0;re<Le.length;re+=2)Te.geometry.push(oc(Le[re],Le[re+1],H,Ee,ke,Me));else for(re=0;re<Le.length;re++){var At=[];for(fe=0;fe<Le[re].length;fe+=2)At.push(oc(Le[re][fe],Le[re][fe+1],H,Ee,ke,Me));Te.geometry.push(At)}}return oe.transformed=!0,oe}function oc(oe,H,W,re,fe,Ee){return[Math.round(W*(oe*re-fe)),Math.round(W*(H*re-Ee))]}function ja(oe,H,W,re,fe){for(var Ee=H===fe.maxZoom?0:fe.tolerance/((1<<H)*fe.extent),ke={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:re,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Me=0;Me<oe.length;Me++){ke.numFeatures++,Kc(ke,oe[Me],Ee,fe);var Te=oe[Me].minX,Le=oe[Me].minY,rt=oe[Me].maxX,At=oe[Me].maxY;Te<ke.minX&&(ke.minX=Te),Le<ke.minY&&(ke.minY=Le),rt>ke.maxX&&(ke.maxX=rt),At>ke.maxY&&(ke.maxY=At)}return ke}function Kc(oe,H,W,re){var fe=H.geometry,Ee=H.type,ke=[];if("Point"===Ee||"MultiPoint"===Ee)for(var Me=0;Me<fe.length;Me+=3)ke.push(fe[Me]),ke.push(fe[Me+1]),oe.numPoints++,oe.numSimplified++;else if("LineString"===Ee)kl(ke,fe,oe,W,!1,!1);else if("MultiLineString"===Ee||"Polygon"===Ee)for(Me=0;Me<fe.length;Me++)kl(ke,fe[Me],oe,W,"Polygon"===Ee,0===Me);else if("MultiPolygon"===Ee)for(var Te=0;Te<fe.length;Te++){var Le=fe[Te];for(Me=0;Me<Le.length;Me++)kl(ke,Le[Me],oe,W,!0,0===Me)}if(ke.length){var rt=H.tags||null;if("LineString"===Ee&&re.lineMetrics){for(var At in rt={},H.tags)rt[At]=H.tags[At];rt.mapbox_clip_start=fe.start/fe.size,rt.mapbox_clip_end=fe.end/fe.size}var tt={geometry:ke,type:"Polygon"===Ee||"MultiPolygon"===Ee?3:"LineString"===Ee||"MultiLineString"===Ee?2:1,tags:rt};null!==H.id&&(tt.id=H.id),oe.features.push(tt)}}function kl(oe,H,W,re,fe,Ee){var ke=re*re;if(re>0&&H.size<(fe?ke:re))W.numPoints+=H.length/3;else{for(var Me=[],Te=0;Te<H.length;Te+=3)(0===re||H[Te+2]>ke)&&(W.numSimplified++,Me.push(H[Te]),Me.push(H[Te+1])),W.numPoints++;fe&&function(Le,rt){for(var At=0,tt=0,jt=Le.length,zt=jt-2;tt<jt;zt=tt,tt+=2)At+=(Le[tt]-Le[zt])*(Le[tt+1]+Le[zt+1]);if(At>0===rt)for(tt=0,jt=Le.length;tt<jt/2;tt+=2){var Zt=Le[tt],Gt=Le[tt+1];Le[tt]=Le[jt-2-tt],Le[tt+1]=Le[jt-1-tt],Le[jt-2-tt]=Zt,Le[jt-1-tt]=Gt}}(Me,Ee),oe.push(Me)}}function ps(oe,H){var W=(H=this.options=function(fe,Ee){for(var ke in Ee)fe[ke]=Ee[ke];return fe}(Object.create(this.options),H)).debug;if(W&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var fe,Ee,ke,Me,Te,Le,re=function(fe,Ee){var ke=[];if("FeatureCollection"===fe.type)for(var Me=0;Me<fe.features.length;Me++)Al(ke,fe.features[Me],Ee,Me);else Al(ke,"Feature"===fe.type?fe:{geometry:fe},Ee);return ke}(oe,H);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Me=fe=re,Te=wn(fe,1,-1-(ke=(Ee=H).buffer/Ee.extent),ke,0,-1,2,Ee),Le=wn(fe,1,1-ke,2+ke,0,-1,2,Ee),(Te||Le)&&(Me=wn(fe,1,-ke,1+ke,0,-1,2,Ee)||[],Te&&(Me=qu(Te,1).concat(Me)),Le&&(Me=Me.concat(qu(Le,-1)))),(re=Me).length&&this.splitTile(re,0,0,0),W&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ao(oe,H,W){return 32*((1<<oe)*W+H)+oe}function $a(oe,H){const W=oe.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const re=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!re)return H(null,null);const fe=new Ot(re.features);let Ee=mt(fe);0===Ee.byteOffset&&Ee.byteLength===Ee.buffer.byteLength||(Ee=new Uint8Array(Ee)),H(null,{vectorTile:fe,rawData:Ee.buffer})}ps.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ps.prototype.splitTile=function(oe,H,W,re,fe,Ee,ke){for(var Me=[oe,H,W,re],Te=this.options,Le=Te.debug;Me.length;){re=Me.pop(),W=Me.pop(),H=Me.pop(),oe=Me.pop();var rt=1<<H,At=Ao(H,W,re),tt=this.tiles[At];if(!tt&&(Le>1&&console.time("creation"),tt=this.tiles[At]=ja(oe,H,W,re,Te),this.tileCoords.push({z:H,x:W,y:re}),Le)){Le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,W,re,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var jt="z"+H;this.stats[jt]=(this.stats[jt]||0)+1,this.total++}if(tt.source=oe,fe){if(H===Te.maxZoom||H===fe)continue;var zt=1<<fe-H;if(W!==Math.floor(Ee/zt)||re!==Math.floor(ke/zt))continue}else if(H===Te.indexMaxZoom||tt.numPoints<=Te.indexMaxPoints)continue;if(tt.source=null,0!==oe.length){Le>1&&console.time("clipping");var Zt,Gt,Dn,Qn,on,ii,Di=.5*Te.buffer/Te.extent,Vs=.5-Di,ms=.5+Di,Ye=1+Di;Zt=Gt=Dn=Qn=null,on=wn(oe,rt,W-Di,W+ms,0,tt.minX,tt.maxX,Te),ii=wn(oe,rt,W+Vs,W+Ye,0,tt.minX,tt.maxX,Te),oe=null,on&&(Zt=wn(on,rt,re-Di,re+ms,1,tt.minY,tt.maxY,Te),Gt=wn(on,rt,re+Vs,re+Ye,1,tt.minY,tt.maxY,Te),on=null),ii&&(Dn=wn(ii,rt,re-Di,re+ms,1,tt.minY,tt.maxY,Te),Qn=wn(ii,rt,re+Vs,re+Ye,1,tt.minY,tt.maxY,Te),ii=null),Le>1&&console.timeEnd("clipping"),Me.push(Zt||[],H+1,2*W,2*re),Me.push(Gt||[],H+1,2*W,2*re+1),Me.push(Dn||[],H+1,2*W+1,2*re),Me.push(Qn||[],H+1,2*W+1,2*re+1)}}},ps.prototype.getTile=function(oe,H,W){var re=this.options,fe=re.extent,Ee=re.debug;if(oe<0||oe>24)return null;var ke=1<<oe,Me=Ao(oe,H=(H%ke+ke)%ke,W);if(this.tiles[Me])return ia(this.tiles[Me],fe);Ee>1&&console.log("drilling down to z%d-%d-%d",oe,H,W);for(var Te,Le=oe,rt=H,At=W;!Te&&Le>0;)Le--,rt=Math.floor(rt/2),At=Math.floor(At/2),Te=this.tiles[Ao(Le,rt,At)];return Te&&Te.source?(Ee>1&&console.log("found parent tile z%d-%d-%d",Le,rt,At),Ee>1&&console.time("drilling down"),this.splitTile(Te.source,Le,rt,At,oe,H,W),Ee>1&&console.timeEnd("drilling down"),this.tiles[Me]?ia(this.tiles[Me],fe):null):null};class Xc extends f.VectorTileWorkerSource{constructor(H,W,re,fe,Ee){super(H,W,re,fe,$a),Ee&&(this.loadGeoJSON=Ee)}loadData(H,W){const re=H&&H.request,fe=re&&re.collectResourceTiming;this.loadGeoJSON(H,(Ee,ke)=>{if(Ee||!ke)return W(Ee);if("object"!=typeof ke)return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));{qe(ke,!0);try{if(H.filter){const Te=f.createExpression(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Te.result)throw new Error(Te.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));ke={type:"FeatureCollection",features:ke.features.filter(rt=>Te.value.evaluate({zoom:0},rt))}}this._geoJSONIndex=H.cluster?new dr(function({superclusterOptions:Te,clusterProperties:Le}){if(!Le||!Te)return Te;const rt={},At={},tt={accumulated:null,zoom:0},jt={properties:null},zt=Object.keys(Le);for(const Zt of zt){const[Gt,Dn]=Le[Zt],Qn=f.createExpression(Dn),on=f.createExpression("string"==typeof Gt?[Gt,["accumulated"],["get",Zt]]:Gt);rt[Zt]=Qn.value,At[Zt]=on.value}return Te.map=Zt=>{jt.properties=Zt;const Gt={};for(const Dn of zt)Gt[Dn]=rt[Dn].evaluate(tt,jt);return Gt},Te.reduce=(Zt,Gt)=>{jt.properties=Gt;for(const Dn of zt)tt.accumulated=Zt[Dn],Zt[Dn]=At[Dn].evaluate(tt,jt)},Te}(H)).load(ke.features):new ps(Te=ke,H.geojsonVtOptions)}catch(Te){return W(Te)}this.loaded={};const Me={};if(fe){const Te=f.getPerformanceMeasurement(re);Te&&(Me.resourceTiming={},Me.resourceTiming[H.source]=JSON.parse(JSON.stringify(Te)))}W(null,Me)}var Te})}reloadTile(H,W){const re=this.loaded;return re&&re[H.uid]?super.reloadTile(H,W):this.loadTile(H,W)}loadGeoJSON(H,W){if(H.request)f.getJSON(H.request,W);else{if("string"!=typeof H.data)return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse(H.data))}catch{return W(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(H,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(re){W(re)}}getClusterChildren(H,W){try{W(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(re){W(re)}}getClusterLeaves(H,W){try{W(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(re){W(re)}}}class Ha{constructor(H){this.self=H,this.actor=new f.Actor(H,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.getProjection({name:"mercator"}),this.workerSourceTypes={vector:f.VectorTileWorkerSource,geojson:Xc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,re)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=re},this.self.registerRTLTextPlugin=W=>{if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=W.applyArabicShaping,f.plugin.processBidirectionalText=W.processBidirectionalText,f.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}clearCaches(H,W,re){delete this.layerIndexes[H],delete this.availableImages[H],delete this.workerSources[H],delete this.demWorkerSources[H],re()}checkIfReady(H,W,re){re()}setReferrer(H,W){this.referrer=W}spriteLoaded(H,W){this.isSpriteLoaded[H]=W;for(const re in this.workerSources[H]){const fe=this.workerSources[H][re];for(const Ee in fe)fe[Ee]instanceof f.VectorTileWorkerSource&&(fe[Ee].isSpriteLoaded=W,fe[Ee].fire(new f.Event("isSpriteLoaded")))}}setImages(H,W,re){this.availableImages[H]=W;for(const fe in this.workerSources[H]){const Ee=this.workerSources[H][fe];for(const ke in Ee)Ee[ke].availableImages=W}re()}enableTerrain(H,W,re){this.terrain=W,re()}setProjection(H,W){this.projections[H]=f.getProjection(W)}setLayers(H,W,re){this.getLayerIndex(H).replace(W),re()}updateLayers(H,W,re){this.getLayerIndex(H).update(W.layers,W.removedIds),re()}loadTile(H,W,re){const fe=this.enableTerrain?f.extend({enableTerrain:this.terrain},W):W;fe.projection=this.projections[H]||this.defaultProjection,this.getWorkerSource(H,W.type,W.source).loadTile(fe,re)}loadDEMTile(H,W,re){const fe=this.enableTerrain?f.extend({buildQuadTree:this.terrain},W):W;this.getDEMWorkerSource(H,W.source).loadTile(fe,re)}reloadTile(H,W,re){const fe=this.enableTerrain?f.extend({enableTerrain:this.terrain},W):W;fe.projection=this.projections[H]||this.defaultProjection,this.getWorkerSource(H,W.type,W.source).reloadTile(fe,re)}abortTile(H,W,re){this.getWorkerSource(H,W.type,W.source).abortTile(W,re)}removeTile(H,W,re){this.getWorkerSource(H,W.type,W.source).removeTile(W,re)}removeSource(H,W,re){if(!this.workerSources[H]||!this.workerSources[H][W.type]||!this.workerSources[H][W.type][W.source])return;const fe=this.workerSources[H][W.type][W.source];delete this.workerSources[H][W.type][W.source],void 0!==fe.removeSource?fe.removeSource(W,re):re()}loadWorkerSource(H,W,re){try{this.self.importScripts(W.url),re()}catch(fe){re(fe.toString())}}syncRTLPluginState(H,W,re){try{f.plugin.setState(W);const fe=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&null!=fe){this.self.importScripts(fe);const Ee=f.plugin.isParsed();re(Ee?void 0:new Error(`RTL Text Plugin failed to import scripts from ${fe}`),Ee)}}catch(fe){re(fe.toString())}}getAvailableImages(H){let W=this.availableImages[H];return W||(W=[]),W}getLayerIndex(H){let W=this.layerIndexes[H];return W||(W=this.layerIndexes[H]=new Pt),W}getWorkerSource(H,W,re){return this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][W]||(this.workerSources[H][W]={}),this.workerSources[H][W][re]||(this.workerSources[H][W][re]=new this.workerSourceTypes[W]({send:(Ee,ke,Me,Te,Le,rt)=>{this.actor.send(Ee,ke,Me,H,Le,rt)},scheduler:this.actor.scheduler},this.getLayerIndex(H),this.getAvailableImages(H),this.isSpriteLoaded[H])),this.workerSources[H][W][re]}getDEMWorkerSource(H,W){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][W]||(this.demWorkerSources[H][W]=new Tt),this.demWorkerSources[H][W]}enforceCacheSizeLimit(H,W){f.enforceCacheSizeLimit(W)}getWorkerPerformanceMetrics(H,W,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ha(self)),Ha}),$e(0,function(f){function ze(g,c){if(Array.isArray(g)){if(!Array.isArray(c)||g.length!==c.length)return!1;for(let h=0;h<g.length;h++)if(!ze(g[h],c[h]))return!1;return!0}if("object"==typeof g&&null!==g&&null!==c){if("object"!=typeof c||Object.keys(g).length!==Object.keys(c).length)return!1;for(const h in g)if(!ze(g[h],c[h]))return!1;return!0}return g===c}var Qt=Pt;function Pt(g){return c=g,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,x,E=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(E);try{x=new Worker(D),y=!0}catch{y=!1}return x&&x.terminate(),URL.revokeObjectURL(D),y}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var y=document.createElement("canvas");y.width=y.height=1;var x=y.getContext("2d");if(!x)return!1;var E=x.getImageData(0,0,1,1);return E&&E.width===y.width}()||(void 0===Tt[h=c&&c.failIfMajorPerformanceCaveat]&&(Tt[h]=function(y){var x,D,M,P,E=(D=y,M=document.createElement("canvas"),(P=Object.create(Pt.webGLContextAttributes)).failIfMajorPerformanceCaveat=D,M.getContext("webgl",P)||M.getContext("experimental-webgl",P));if(!E)return!1;try{x=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!x||E.isContextLost())&&(E.shaderSource(x,"void main() {}"),E.compileShader(x),!0===E.getShaderParameter(x,E.COMPILE_STATUS))}(h)),!Tt[h]||document.documentMode));var c,h}var Tt={};function qe(g,c,h){const y=f.window.document.createElement(g);return void 0!==c&&(y.className=c),h&&h.appendChild(y),y}function xt(g,c,h){const y=f.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const x of Object.keys(c))y.setAttributeNS(null,x,c[x]);return h&&h.appendChild(y),y}Pt.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Bt=f.window.document&&f.window.document.documentElement.style,dn=Bt&&void 0!==Bt.userSelect?"userSelect":"WebkitUserSelect";let Kn;function Ot(){Bt&&dn&&(Kn=Bt[dn],Bt[dn]="none")}function mt(){Bt&&dn&&(Bt[dn]=Kn)}function rn(g){g.preventDefault(),g.stopPropagation(),f.window.removeEventListener("click",rn,!0)}function nn(){f.window.addEventListener("click",rn,!0),f.window.setTimeout(()=>{f.window.removeEventListener("click",rn,!0)},0)}function st(g,c){const h=g.getBoundingClientRect();return at(g,h,c)}function ue(g,c){const h=g.getBoundingClientRect(),y=[];for(let x=0;x<c.length;x++)y.push(at(g,h,c[x]));return y}function De(g){return void 0!==f.window.InstallTrigger&&2===g.button&&g.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function at(g,c,h){const y=g.offsetWidth===c.width?1:g.offsetWidth/c.width;return new f.pointGeometry((h.clientX-c.left)*y,(h.clientY-c.top)*y)}function vt(g,c){var h=c[0],y=c[1],x=c[2],E=c[3],D=h*E-x*y;return D?(g[0]=E*(D=1/D),g[1]=-y*D,g[2]=-x*D,g[3]=h*D,g):null}function yn(g){const{userImage:c}=g;return!!(c&&c.render&&c.render())&&(g.data.replace(new Uint8Array(c.data.buffer)),!0)}class ki extends f.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:h,callback:y}of this.requestors)this._notify(h,y);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,h){this._validate(c,h)&&(this.images[c]=h)}_validate(c,h){let y=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),y=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),y=!1),this._validateContent(h.content,h)||(this.fire(new f.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),y=!1),y}_validateStretch(c,h){if(!c)return!0;let y=0;for(const x of c){if(x[0]<y||x[1]<x[0]||h<x[1])return!1;y=x[1]}return!0}_validateContent(c,h){return!(c&&(4!==c.length||c[0]<0||h.data.width<c[0]||c[1]<0||h.data.height<c[1]||c[2]<0||h.data.width<c[2]||c[3]<0||h.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,h){h.version=this.images[c].version+1,this.images[c]=h,this.updatedImages[c]=!0}removeImage(c){const h=this.images[c];delete this.images[c],delete this.patterns[c],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,h){let y=!0;if(!this.isLoaded())for(const x of c)this.images[x]||(y=!1);this.isLoaded()||y?this._notify(c,h):this.requestors.push({ids:c,callback:h})}_notify(c,h){const y={};for(const x of c){this.images[x]||this.fire(new f.Event("styleimagemissing",{id:x}));const E=this.images[x];E?y[x]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:Boolean(E.userImage&&E.userImage.render)}:f.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,y)}getPixelSize(){const{width:c,height:h}=this.atlasImage;return{width:c,height:h}}getPattern(c){const h=this.patterns[c],y=this.getImage(c);if(!y)return null;if(h&&h.position.version===y.version)return h.position;if(h)h.position.version=y.version;else{const x={w:y.data.width+2,h:y.data.height+2,x:0,y:0},E=new f.ImagePosition(x,y);this.patterns[c]={bin:x,position:E}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const h=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(c,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const E in this.patterns)c.push(this.patterns[E].bin);const{w:h,h:y}=f.potpack(c),x=this.atlasImage;x.resize({width:h||1,height:y||1});for(const E in this.patterns){const{bin:D}=this.patterns[E],M=D.x+1,P=D.y+1,z=this.images[E].data,B=z.width,$=z.height;f.RGBAImage.copy(z,x,{x:0,y:0},{x:M,y:P},{width:B,height:$}),f.RGBAImage.copy(z,x,{x:0,y:$-1},{x:M,y:P-1},{width:B,height:1}),f.RGBAImage.copy(z,x,{x:0,y:0},{x:M,y:P+$},{width:B,height:1}),f.RGBAImage.copy(z,x,{x:B-1,y:0},{x:M-1,y:P},{width:1,height:$}),f.RGBAImage.copy(z,x,{x:0,y:0},{x:M+B,y:P},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const h of c){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const y=this.images[h];yn(y)&&this.updateImage(h,y)}}}const Gi=new f.Properties({anchor:new f.DataConstantProperty(f.spec.light.anchor),position:new class{constructor(){this.specification=f.spec.light.position}possiblyEvaluate(g,c){return function([h,y,x]){const E=f.degToRad(y+90),D=f.degToRad(x);return{x:h*Math.cos(E)*Math.sin(D),y:h*Math.sin(E)*Math.sin(D),z:h*Math.cos(D),azimuthal:y,polar:x}}(g.expression.evaluate(c))}interpolate(g,c,h){return{x:f.number(g.x,c.x,h),y:f.number(g.y,c.y,h),z:f.number(g.z,c.z,h),azimuthal:f.number(g.azimuthal,c.azimuthal,h),polar:f.number(g.polar,c.polar,h)}}},color:new f.DataConstantProperty(f.spec.light.color),intensity:new f.DataConstantProperty(f.spec.light.intensity)}),ir="-transition";class xr extends f.Evented{constructor(c){super(),this._transitionable=new f.Transitionable(Gi),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,h={}){if(!this._validate(f.validateLight,c,h))for(const y in c){const x=c[y];f.endsWith(y,ir)?this._transitionable.setTransition(y.slice(0,-ir.length),x):this._transitionable.setValue(y,x)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,y){return(!y||!1!==y.validate)&&f.emitValidationErrors(this,c.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}const _n=new f.Properties({source:new f.DataConstantProperty(f.spec.terrain.source),exaggeration:new f.DataConstantProperty(f.spec.terrain.exaggeration)}),wr="-transition";class Lr extends f.Evented{constructor(c,h){super(),this._transitionable=new f.Transitionable(_n),this.set(c),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(c){for(const h in c){const y=c[h];f.endsWith(h,wr)?this._transitionable.setTransition(h.slice(0,-wr.length),y):this._transitionable.setValue(h,y)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function Do(g,c,h,y){const x=f.smoothstep(45,65,h),[E,D]=qo(g,y),M=f.length(c);let P=1-Math.min(1,Math.exp((M-E)/(D-E)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*x*g.alpha}function qo(g,c){const h=.5/Math.tan(.5*c);return[g.range[0]+h,g.range[1]+h]}const xn=new f.Properties({range:new f.DataConstantProperty(f.spec.fog.range),color:new f.DataConstantProperty(f.spec.fog.color),"high-color":new f.DataConstantProperty(f.spec.fog["high-color"]),"space-color":new f.DataConstantProperty(f.spec.fog["space-color"]),"horizon-blend":new f.DataConstantProperty(f.spec.fog["horizon-blend"]),"star-intensity":new f.DataConstantProperty(f.spec.fog["star-intensity"])}),cs="-transition";class za extends f.Evented{constructor(c,h){super(),this._transitionable=new f.Transitionable(xn),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const c=this._transform,h="globe"===c.projection.name,y=f.globeToMercatorTransition(c.zoom),x=this.properties.get("range"),E=[.5,3];return{range:h?[f.number(E[0],x[0],y),f.number(E[1],x[1],y)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,h={}){if(!this._validate(f.validateFog,c,h)){for(const y of Object.keys(f.spec.fog))c&&void 0===c[y]&&(c[y]=f.spec.fog[y].default);for(const y in c){const x=c[y];f.endsWith(y,cs)?this._transitionable.setTransition(y.slice(0,-cs.length),x):this._transitionable.setValue(y,x)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:f.smoothstep(45,65,c))*h.a}getOpacityAtLatLng(c,h){return this._transform.projection.supportsFog?function(y,x,E){const D=f.MercatorCoordinate.fromLngLat(x),M=E.elevation?E.elevation.getAtPointOrZero(D):0,P=[D.x,D.y,M];return f.transformMat4(P,P,E.mercatorFogMatrix),Do(y,P,E.pitch,E._fov)}(this.state,c,h):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?qo(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,y){return(!y||!1!==y.validate)&&f.emitValidationErrors(this,c.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}class ta{constructor(c,h){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=f.uniqueId();const y=this.workerPool.acquire(this.id);for(let x=0;x<y.length;x++){const E=new ta.Actor(y[x],h,this.id);E.name=`Worker ${x}`,this.actors.push(E)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,h,y){f.asyncAll(this.actors,(x,E)=>{x.send(c,h,E)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function us(g,c,h){return c*(f.EXTENT/(g.tileSize*Math.pow(2,h-g.tileID.overscaledZ)))}ta.Actor=f.Actor;class si{constructor(c,h,y,x){this.screenBounds=c,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(c,h){let y,x;if(c instanceof f.pointGeometry||"number"==typeof c[0]){const E=f.pointGeometry.convert(c);y=[E],x=h.isPointAboveHorizon(E)}else{const E=f.pointGeometry.convert(c[0]),D=f.pointGeometry.convert(c[1]);y=[E,D],x=f.polygonizeBounds(E,D).every(M=>h.isPointAboveHorizon(M))}return new si(y,h.getCameraPoint(),x,h)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(c){return f.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const h=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new f.pointGeometry(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<y.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),f.bufferConvexPolygon(x,c)}bufferedCameraGeometryGlobe(c){const h=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new f.pointGeometry(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,y,c),E=this.cameraPoint.clone();switch(3*((E.y>h.y)+(E.y>y.y))+((E.x>h.x)+(E.x>y.x))){case 0:x[0]=E,x[4]=E.clone();break;case 1:x.splice(1,0,E);break;case 2:x[1]=E;break;case 3:x.splice(4,0,E);break;case 5:x.splice(2,0,E);break;case 6:x[3]=E;break;case 7:x.splice(3,0,E);break;case 8:x[2]=E}return x}containsTile(c,h,y,x=0){const E=c.queryPadding/h._pixelsPerMercatorPixel+1,D=y?this._bufferedCameraMercator(E,h):this._bufferedScreenMercator(E,h);let M=c.tileID.wrap+(D.unwrapped?x:0);const P=D.polygon.map(J=>f.getTilePoint(c.tileTransform,J,M));if(!f.polygonIntersectsBox(P,0,0,f.EXTENT,f.EXTENT))return;M=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const z=this.screenGeometryMercator.polygon.map(J=>f.getTileVec3(c.tileTransform,J,M)),B=z.map(J=>new f.pointGeometry(J[0],J[1])),$=h.getFreeCameraOptions().position||new f.MercatorCoordinate(0,0,0),X=f.getTileVec3(c.tileTransform,$,M),ee=z.map(J=>{const Y=f.sub(J,J,X);return f.normalize(Y,Y),new f.Ray(X,Y)}),te=us(c,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:B,tilespaceRays:ee,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(ne=f.getBounds(P),ne.min.x=f.clamp(ne.min.x,0,f.EXTENT),ne.min.y=f.clamp(ne.min.y,0,f.EXTENT),ne.max.x=f.clamp(ne.max.x,0,f.EXTENT),ne.max.y=f.clamp(ne.max.y,0,f.EXTENT),ne),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:te};var ne}_bufferedScreenMercator(c,h){const y=ti(c);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedScreenGeometry(c),h):{polygon:this.bufferedScreenGeometry(c).map(E=>h.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[y]=x,x}}_bufferedCameraMercator(c,h){const y=ti(c);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),h):{polygon:this.bufferedCameraGeometry(c).map(E=>h.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[y]=x,x}}_projectAndResample(c,h){const y=function(E,D){const M=f.multiply([],D.pixelMatrix,D.globeMatrix),P=[0,-f.GLOBE_RADIUS,0,1],z=[0,f.GLOBE_RADIUS,0,1],B=[0,0,0,1];f.transformMat4$1(P,P,M),f.transformMat4$1(z,z,M),f.transformMat4$1(B,B,M);const $=new f.pointGeometry(P[0]/P[3],P[1]/P[3]),X=new f.pointGeometry(z[0]/z[3],z[1]/z[3]),ee=f.polygonContainsPoint(E,$)&&P[3]<B[3],te=f.polygonContainsPoint(E,X)&&z[3]<B[3];if(!ee&&!te)return null;const ne=function(Ce,Ae,Ne){for(let Ve=1;Ve<Ce.length;Ve++){const yt=Ns(Ae.pointCoordinate3D(Ce[Ve-1]).x),Pe=Ns(Ae.pointCoordinate3D(Ce[Ve]).x);if(Ne<0){if(yt<Pe)return{idx:Ve,t:-yt/(Pe-1-yt)}}else if(Pe<yt)return{idx:Ve,t:(1-yt)/(Pe+1-yt)}}return null}(E,D,ee?-1:1);if(!ne)return null;const{idx:J,t:Y}=ne;let ce=J>1?ds(E.slice(0,J),D):[],le=J<E.length?ds(E.slice(J),D):[];ce=ce.map(Ce=>new f.pointGeometry(Ns(Ce.x),Ce.y)),le=le.map(Ce=>new f.pointGeometry(Ns(Ce.x),Ce.y));const de=[...ce];0===de.length&&de.push(le[le.length-1]);const xe=f.number(de[de.length-1].y,(0===le.length?ce[0]:le[0]).y,Y);let ye;return ye=ee?[new f.pointGeometry(0,xe),new f.pointGeometry(0,0),new f.pointGeometry(1,0),new f.pointGeometry(1,xe)]:[new f.pointGeometry(1,xe),new f.pointGeometry(1,1),new f.pointGeometry(0,1),new f.pointGeometry(0,xe)],de.push(...ye),0===le.length?de.push(ce[0]):de.push(...le),{polygon:de.map(Ce=>new f.MercatorCoordinate(Ce.x,Ce.y)),unwrapped:!1}}(c,h);if(y)return y;const x=function(E,D){let M=!1,P=-1/0,z=0;for(let $=0;$<E.length-1;$++)E[$].x>P&&(P=E[$].x,z=$);for(let $=0;$<E.length-1;$++){const X=(z+$)%(E.length-1),ee=E[X],te=E[X+1];Math.abs(ee.x-te.x)>.5&&(ee.x<te.x?(ee.x+=1,0===X&&(E[E.length-1].x+=1)):(te.x+=1,X+1===E.length-1&&(E[0].x+=1)),M=!0)}const B=f.mercatorXfromLng(D.center.lng);return M&&B<Math.abs(B-1)&&E.forEach($=>{$.x-=1}),{polygon:E,unwrapped:M}}(ds(c,h).map(E=>new f.pointGeometry(Ns(E.x),E.y)),h);return{polygon:x.polygon.map(E=>new f.MercatorCoordinate(E.x,E.y)),unwrapped:x.unwrapped}}}function ds(g,c){return f.resample(g,h=>{const y=c.pointCoordinate3D(h);h.x=y.x,h.y=y.y},1/256)}function Ns(g){return g<0?1+g%1:g%1}function ti(g){return 100*g|0}function zn(g,c,h,y,x){const E=function(D,M){if(D)return x(D);if(M){g.url&&M.tiles&&g.tiles&&delete g.tiles;const P=f.pick(f.extend(M,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(P.vectorLayers=M.vector_layers,P.vectorLayerIds=P.vectorLayers.map(z=>z.id)),P.tiles=c.canonicalizeTileset(P,g.url),x(null,P)}};return g.url?f.getJSON(c.transformRequest(c.normalizeSourceURL(g.url,null,h,y),f.ResourceType.Source),E):f.exported.frame(()=>E(null,g))}class dr{constructor(c,h,y){this.bounds=f.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=h||0,this.maxzoom=y||24}validateBounds(c){return Array.isArray(c)&&4===c.length?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const h=Math.pow(2,c.z),y=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*h),x=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*h),E=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*h),D=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*h);return c.x>=y&&c.x<E&&c.y>=x&&c.y<D}}class cn{constructor(c,h,y){this.context=c;const x=c.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ni={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class hs{constructor(c,h,y,x){this.length=h.length,this.attributes=y,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.context=c;const E=c.gl;this.buffer=E.createBuffer(),c.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,h){for(let y=0;y<this.attributes.length;y++){const x=h.attributes[this.attributes[y].name];void 0!==x&&c.enableVertexAttribArray(x)}}setVertexAttribPointers(c,h,y){for(let x=0;x<this.attributes.length;x++){const E=this.attributes[x],D=h.attributes[E.name];void 0!==D&&c.vertexAttribPointer(D,E.components,c[ni[E.type]],!1,this.itemSize,E.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class So extends Xn{getDefault(){return f.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Wn extends Xn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Zo extends Xn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class _o extends Xn{getDefault(){return[!0,!0,!0,!0]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class va extends Xn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class ar extends Xn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Er extends Xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const h=this.current;(c.func!==h.func||c.ref!==h.ref||c.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class Bs extends Xn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Yo extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=c,this.dirty=!1}}class $r extends Xn{getDefault(){return[0,1]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Al extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=c,this.dirty=!1}}class Gc extends Xn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class na extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.BLEND):h.disable(h.BLEND),this.current=c,this.dirty=!1}}class Va extends Xn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Wc extends Xn{getDefault(){return f.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class qc extends Xn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class wn extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=c,this.dirty=!1}}class zs extends Xn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Ua extends Xn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Ml extends Xn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Zc extends Xn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Yc extends Xn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class fs extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class ic extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class qu extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class rc extends Xn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ia extends Xn{getDefault(){return null}set(c){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class oc extends Xn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class ja extends Xn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class Kc extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class kl extends Xn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class ps extends Xn{constructor(c,h){super(c),this.context=c,this.parent=h}getDefault(){return null}}class Ao extends ps{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class $a extends ps{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Xc extends $a{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ha{constructor(c,h,y,x){this.context=c,this.width=h,this.height=y;const E=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Ao(c,E),x&&(this.depthAttachment=new $a(c,E))}destroy(){const c=this.context.gl,h=this.colorAttachment.get();if(h&&c.deleteTexture(h),this.depthAttachment){const y=this.depthAttachment.get();y&&c.deleteRenderbuffer(y)}c.deleteFramebuffer(this.framebuffer)}}class oe{constructor(c,h=!1){if(this.gl=c,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const y=c;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(c),deleteVertexArrayOES:y.deleteVertexArray.bind(c),bindVertexArrayOES:y.bindVertexArray.bind(c)}}this.clearColor=new So(this),this.clearDepth=new Wn(this),this.clearStencil=new Zo(this),this.colorMask=new _o(this),this.depthMask=new va(this),this.stencilMask=new ar(this),this.stencilFunc=new Er(this),this.stencilOp=new Bs(this),this.stencilTest=new Yo(this),this.depthRange=new $r(this),this.depthTest=new Al(this),this.depthFunc=new Gc(this),this.blend=new na(this),this.blendFunc=new Va(this),this.blendColor=new Wc(this),this.blendEquation=new qc(this),this.cullFace=new wn(this),this.cullFaceSide=new zs(this),this.frontFace=new Ua(this),this.program=new Ml(this),this.activeTexture=new Zc(this),this.viewport=new Yc(this),this.bindFramebuffer=new fs(this),this.bindRenderbuffer=new ic(this),this.bindTexture=new qu(this),this.bindVertexBuffer=new rc(this),this.bindElementBuffer=new ia(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new oc(this),this.pixelStoreUnpack=new ja(this),this.pixelStoreUnpackPremultiplyAlpha=new Kc(this),this.pixelStoreUnpackFlipY=new kl(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,h){return new cn(this,c,h)}createVertexBuffer(c,h,y){return new hs(this,c,h,y)}createRenderbuffer(c,h,y){const x=this.gl,E=x.createRenderbuffer();return this.bindRenderbuffer.set(E),x.renderbufferStorage(x.RENDERBUFFER,c,h,y),this.bindRenderbuffer.set(null),E}createFramebuffer(c,h,y){return new Ha(this,c,h,y)}clear({color:c,depth:h,stencil:y}){const x=this.gl;let E=0;c&&(E|=x.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(E|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),void 0!==y&&(E|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),x.clear(E)}setCullFace(c){!1===c.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){ze(c.blendFunction,f.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class H extends f.Evented{constructor(c,h,y,x){if(super(),this.id=c,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(h,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new f.DedupedRequest}load(c){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=zn(this._options,this.map._requestManager,h,y,(x,E)=>{this._tileJSONRequest=null,this._loaded=!0,x?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),y&&2!==y.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new f.ErrorEvent(x))):E&&(f.extend(this,E),E.bounds&&(this.tileBounds=new dr(E.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(x)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}loadTile(c,h){const y=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(y,f.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,c.actor&&"expired"!==c.state)"loading"===c.state?c.reloadCallback=h:c.request=c.actor.send("reloadTile",x,E.bind(this));else if(c.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",x,E.bind(this),void 0,!0);else{const D=f.loadVectorTile.call({deduped:this._deduped},x,(M,P)=>{M||!P?E.call(this,M):(x.data={cacheControl:P.cacheControl,expires:P.expires,rawData:P.rawData.slice(0)},c.actor&&c.actor.send("loadTile",x,E.bind(this),void 0,!0))},!0);c.request={cancel:D}}function E(D,M){return delete c.request,c.aborted?h(null):D&&404!==D.status?h(D):(M&&M.resourceTiming&&(c.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&c.setExpiryData(M),c.loadVectorData(M,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class W extends f.Evented{constructor(c,h,y,x){super(),this.id=c,this.dispatcher=y,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},h),f.extend(this,f.pick(h,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zn(this._options,this.map._requestManager,null,null,(h,y)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new f.ErrorEvent(h)):y&&(f.extend(this,y),y.bounds&&(this.tileBounds=new dr(y.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(y.tiles),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(h)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,h){const y=f.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);c.request=f.getImage(this.map._requestManager.transformRequest(x,f.ResourceType.Tile),(E,D,M,P)=>(delete c.request,c.aborted?(c.state="unloaded",h(null)):E?(c.state="errored",h(E)):D?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:M,expires:P}),c.setTexture(D,this.map.painter),c.state="loaded",f.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(c,h,y){c.setTexture(h,y)}static unloadTileData(c,h){c.texture&&h.saveTileTexture(c.texture)}abortTile(c,h){c.request&&(c.request.cancel(),delete c.request),h()}unloadTile(c,h){c.texture&&this.map.painter.saveTileTexture(c.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let re;function fe(g,c,h,y,x,E,D,M){const P=[g,h,x,c,y,E,1,1,1],z=[D,M,1],B=f.adjoint([],P),[$,X,ee]=f.transformMat3(z,z,f.transpose(B,B));return f.multiply$1(P,[$,0,0,0,X,0,0,0,ee],P)}class Ee extends f.Evented{constructor(c,h,y,x){super(),this.id=c,this.dispatcher=y,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=h,this._dirty=!1}load(c,h){this._loaded=h||!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),(y,x)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new f.ErrorEvent(y));else if(x){const{HTMLImageElement:E}=f.window;this.image=x instanceof E?f.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const h=c.map(f.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let x=1/0,E=1/0,D=-1/0,M=-1/0;for(const $ of y)x=Math.min(x,$.x),E=Math.min(E,$.y),D=Math.max(D,$.x),M=Math.max(M,$.y);const P=Math.max(D-x,M-E),z=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),B=Math.pow(2,z);return new f.CanonicalTileID(z,Math.floor((x+D)/2*B),Math.floor((E+M)/2*B))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const P in this.tiles){const z=this.tiles[P];"loaded"!==z.state&&(z.state="loaded",z.texture=this.texture)}if(this._boundsArray)return;const h=f.tileTransform(this.tileID,this.map.transform.projection),[y,x,E,D]=this.coordinates.map(P=>{const z=h.projection.project(P[0],P[1]);return f.getTilePoint(h,z)._round()});this.perspectiveTransform=function(P,z,B,$,X,ee,te,ne,J,Y){const ce=fe(0,0,P,0,0,z,P,z),le=fe(B,$,X,ee,te,ne,J,Y);return f.multiply$1(le,f.adjoint(ce,ce),le),[le[6]/le[8]*P/f.EXTENT,le[7]/le[8]*z/f.EXTENT]}(this.width,this.height,y.x,y.y,x.x,x.y,D.x,D.y,E.x,E.y);const M=this._boundsArray=new f.StructArrayLayout4i8;M.emplaceBack(y.x,y.y,0,0),M.emplaceBack(x.x,x.y,f.EXTENT,0),M.emplaceBack(D.x,D.y,0,f.EXTENT),M.emplaceBack(E.x,E.y,f.EXTENT,f.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(M,f.boundsAttributes.members),this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const c=this.map.painter.context,h=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new f.Texture(c,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,h){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},h(null)):(c.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ke={vector:H,raster:W,"raster-dem":class extends W{constructor(g,c,h,y){super(g,c,h,y),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(g,c){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(x,E){x&&(g.state="errored",c(x)),E&&(g.dem=E,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",c(null))}g.request=f.getImage(this.map._requestManager.transformRequest(h,f.ResourceType.Tile),function(x,E,D,M){if(delete g.request,g.aborted)g.state="unloaded",c(null);else if(x)g.state="errored",c(x);else if(E){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:D,expires:M});const P=f.window.ImageBitmap&&E instanceof f.window.ImageBitmap&&(null==re&&(re=f.window.OffscreenCanvas&&new f.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof f.window.createImageBitmap),re),z=1-(E.width-f.prevPowerOfTwo(E.width))/2;z<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const B=P?E:f.exported.getImageData(E,z),$={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:B,encoding:this.encoding,padding:z};g.actor&&"expired"!==g.state||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",$,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(g){const c=g.canonical,h=Math.pow(2,c.z),y=(c.x-1+h)%h,x=0===c.x?g.wrap-1:g.wrap,E=(c.x+1+h)%h,D=c.x+1===h?g.wrap+1:g.wrap,M={};return M[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y).key]={backfilled:!1},M[new f.OverscaledTileID(g.overscaledZ,D,c.z,E,c.y).key]={backfilled:!1},c.y>0&&(M[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y-1).key]={backfilled:!1},M[new f.OverscaledTileID(g.overscaledZ,g.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},M[new f.OverscaledTileID(g.overscaledZ,D,c.z,E,c.y-1).key]={backfilled:!1}),c.y+1<h&&(M[new f.OverscaledTileID(g.overscaledZ,x,c.z,y,c.y+1).key]={backfilled:!1},M[new f.OverscaledTileID(g.overscaledZ,g.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},M[new f.OverscaledTileID(g.overscaledZ,D,c.z,E,c.y+1).key]={backfilled:!1}),M}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends f.Evented{constructor(g,c,h,y){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(y),this._data=c.data,this._options=f.extend({},c),this._collectResourceTiming=c.collectResourceTiming,void 0!==c.maxzoom&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const x=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(void 0!==c.buffer?c.buffer:128)*x,tolerance:(void 0!==c.tolerance?c.tolerance:.375)*x,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:void 0!==c.clusterMaxZoom?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:f.EXTENT,radius:(void 0!==c.clusterRadius?c.clusterRadius:50)*x,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},c),this}getClusterChildren(g,c){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},c),this}getClusterLeaves(g,c,h,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:c,offset:h},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new f.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=f.extend({},this.workerOptions),c=this._data;"string"==typeof c?(g.request=this.map._requestManager.transformRequest(f.exported.resolveURL(c),f.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(h,y)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new f.ErrorEvent(h));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(x.resourceTiming=y.resourceTiming[this.id]),this.fire(new f.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,c){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(h,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,x)=>(delete g.request,g.unloadVectorData(),g.aborted?c(null):y?c(y):(g.loadVectorData(x,this.map.painter,"reloadTile"===h),c(null))),void 0,"loadTile"===h)}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return f.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ee{constructor(g,c,h,y){super(g,c,h,y),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const c of g.urls)this.urls.push(this.map._requestManager.transformRequest(c,f.ResourceType.Source).url);f.getVideo(this.urls,(c,h)=>{this._loaded=!0,c?this.fire(new f.ErrorEvent(c)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const c=this.video.seekable;g<c.start(0)||g>c.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const g=this.map.painter.context,c=g.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(g,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ee,canvas:class extends Ee{constructor(g,c,h,y){super(g,c,h,y),c.coordinates?Array.isArray(c.coordinates)&&4===c.coordinates.length&&!c.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(E=>"number"!=typeof E))||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),c.animate&&"boolean"!=typeof c.animate&&this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),c.canvas?"string"==typeof c.canvas||c.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=c,this.animate=void 0===c.animate||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const c=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends f.Evented{constructor(g,c,h,y){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=c,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new f.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new f.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new dr(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),f.extend(this,f.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return f.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:c,y:h,z:y}=g.canonical;return this._implementation.hasTile({x:c,y:h,z:y})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,c){const{x:h,y,z:x}=g.tileID.canonical,E=new f.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y,z:x},{signal:E.signal})).then(function(D){return delete g.request,g.aborted?(g.state="unloaded",c(null)):void 0===D?(g.state="errored",c(null)):null===D?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",c(null)):(M=D)instanceof f.window.ImageData||M instanceof f.window.HTMLCanvasElement||M instanceof f.window.ImageBitmap||M instanceof f.window.HTMLImageElement?(this.loadTileData(g,D),g.state="loaded",void c(null)):(g.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var M}.bind(this)).catch(D=>{20!==D.code&&(g.state="errored",c(D))}),g.request.cancel=()=>E.abort()}loadTileData(g,c){W.loadTileData(g,c,this._map.painter)}unloadTileData(g){W.unloadTileData(g,this._map.painter)}unloadTile(g,c){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:h,y,z:x}=g.tileID.canonical;this._implementation.unloadTile({x:h,y,z:x})}c()}abortTile(g,c){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Me=function(g,c,h,y){const x=new ke[c.type](g,c,h,y);if(x.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${x.id}`);return f.bindAll(["load","abort","unload","serialize","prepare"],x),x};function Te(g,c){const h=f.identity([]);return f.scale(h,h,[.5*g.width,.5*-g.height,1]),f.translate(h,h,[1,-1,0]),f.multiply(h,h,g.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(h)}function Le(g,c,h,y,x,E,D,M=!1){const P=g.tilesIn(y,D,M);P.sort(At);const z=[];for(const $ of P)z.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:$.tile.queryRenderedFeatures(c,h,g._state,$,x,E,Te(g.transform,$.tile.tileID),M)});const B=function($){const X={},ee={};for(const te of $){const ne=te.queryResults,J=te.wrappedTileID,Y=ee[J]=ee[J]||{};for(const ce in ne){const le=ne[ce],de=Y[ce]=Y[ce]||{},xe=X[ce]=X[ce]||[];for(const ye of le)de[ye.featureIndex]||(de[ye.featureIndex]=!0,xe.push(ye))}}return X}(z);for(const $ in B)B[$].forEach(X=>{const ee=X.feature,te=ee.layer;te&&"background"!==te.type&&"sky"!==te.type&&(ee.source=te.source,te["source-layer"]&&(ee.sourceLayer=te["source-layer"]),ee.state=void 0!==ee.id?g.getFeatureState(te["source-layer"],ee.id):{})});return B}function rt(g,c){const h=g.getRenderableIds().map(E=>g.getTileByID(E)),y=[],x={};for(let E=0;E<h.length;E++){const D=h[E],M=D.tileID.canonical.key;x[M]||(x[M]=!0,D.querySourceFeatures(y,c))}return y}function At(g,c){const h=g.tileID,y=c.tileID;return h.overscaledZ-y.overscaledZ||h.canonical.y-y.canonical.y||h.wrap-y.wrap||h.canonical.x-y.canonical.x}function tt(){return null!=Qd.workerClass?new Qd.workerClass:new f.window.Worker(Qd.workerUrl)}const jt="mapboxgl_preloaded_worker_pool";class zt{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<zt.workerCount;)this.workers.push(new tt);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],0===this.numActive()&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jt]}numActive(){return Object.keys(this.active).length}}let Zt;function Gt(){return Zt||(Zt=new zt),Zt}function Dn(g,c){const h={};for(const y in g)"ref"!==y&&(h[y]=g[y]);return f.refProperties.forEach(y=>{y in c&&(h[y]=c[y])}),h}function Qn(g){g=g.slice();const c=Object.create(null);for(let h=0;h<g.length;h++)c[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=Dn(g[h],c[g[h].ref]));return g}zt.workerCount=2;const on={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ii(g,c,h){h.push({command:on.addSource,args:[g,c[g]]})}function Di(g,c,h){c.push({command:on.removeSource,args:[g]}),h[g]=!0}function Vs(g,c,h,y){Di(g,h,y),ii(g,c,h)}function ms(g,c,h){let y;for(y in g[h])if(g[h].hasOwnProperty(y)&&"data"!==y&&!ze(g[h][y],c[h][y]))return!1;for(y in c[h])if(c[h].hasOwnProperty(y)&&"data"!==y&&!ze(g[h][y],c[h][y]))return!1;return!0}function Ye(g,c,h,y,x,E){let D;for(D in c=c||{},g=g||{})g.hasOwnProperty(D)&&(ze(g[D],c[D])||h.push({command:E,args:[y,D,c[D],x]}));for(D in c)c.hasOwnProperty(D)&&!g.hasOwnProperty(D)&&(ze(g[D],c[D])||h.push({command:E,args:[y,D,c[D],x]}))}function ba(g){return g.id}function lr(g,c){return g[c.id]=c,g}class Ga{constructor(c,h){this.reset(c,h)}reset(c,h){this.points=c||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(1===this.points.length)return this.points[0];c=f.clamp(c,0,1);let h=1,y=this._distances[h];const x=c*this.paddedLength+this.padding;for(;y<x&&h<this._distances.length;)y=this._distances[++h];const E=h-1,D=this._distances[E],M=y-D,P=M>0?(x-D)/M:0;return this.points[E].mult(1-P).add(this.points[h].mult(P))}}class Nd{constructor(c,h,y){const x=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(c/y),this.yCellCount=Math.ceil(h/y);for(let D=0;D<this.xCellCount*this.yCellCount;D++)x.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=h,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,h,y,x,E){this._forEachCell(h,y,x,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(h),this.bboxes.push(y),this.bboxes.push(x),this.bboxes.push(E)}insertCircle(c,h,y,x){this._forEachCell(h-x,y-x,h+x,y+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(h),this.circles.push(y),this.circles.push(x)}_insertBoxCell(c,h,y,x,E,D){this.boxCells[E].push(D)}_insertCircleCell(c,h,y,x,E,D){this.circleCells[E].push(D)}_query(c,h,y,x,E,D){if(y<0||c>this.width||x<0||h>this.height)return!E&&[];const M=[];if(c<=0&&h<=0&&this.width<=y&&this.height<=x){if(E)return!0;for(let P=0;P<this.boxKeys.length;P++)M.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const z=this.circles[3*P],B=this.circles[3*P+1],$=this.circles[3*P+2];M.push({key:this.circleKeys[P],x1:z-$,y1:B-$,x2:z+$,y2:B+$})}return D?M.filter(D):M}return this._forEachCell(c,h,y,x,this._queryCell,M,{hitTest:E,seenUids:{box:{},circle:{}}},D),E?M.length>0:M}_queryCircle(c,h,y,x,E){const D=c-y,M=c+y,P=h-y,z=h+y;if(M<0||D>this.width||z<0||P>this.height)return!x&&[];const B=[];return this._forEachCell(D,P,M,z,this._queryCellCircle,B,{hitTest:x,circle:{x:c,y:h,radius:y},seenUids:{box:{},circle:{}}},E),x?B.length>0:B}query(c,h,y,x,E){return this._query(c,h,y,x,!1,E)}hitTest(c,h,y,x,E){return this._query(c,h,y,x,!0,E)}hitTestCircle(c,h,y,x){return this._queryCircle(c,h,y,!0,x)}_queryCell(c,h,y,x,E,D,M,P){const z=M.seenUids,B=this.boxCells[E];if(null!==B){const X=this.bboxes;for(const ee of B)if(!z.box[ee]){z.box[ee]=!0;const te=4*ee;if(c<=X[te+2]&&h<=X[te+3]&&y>=X[te+0]&&x>=X[te+1]&&(!P||P(this.boxKeys[ee]))){if(M.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[ee],x1:X[te],y1:X[te+1],x2:X[te+2],y2:X[te+3]})}}}const $=this.circleCells[E];if(null!==$){const X=this.circles;for(const ee of $)if(!z.circle[ee]){z.circle[ee]=!0;const te=3*ee;if(this._circleAndRectCollide(X[te],X[te+1],X[te+2],c,h,y,x)&&(!P||P(this.circleKeys[ee]))){if(M.hitTest)return D.push(!0),!0;{const ne=X[te],J=X[te+1],Y=X[te+2];D.push({key:this.circleKeys[ee],x1:ne-Y,y1:J-Y,x2:ne+Y,y2:J+Y})}}}}}_queryCellCircle(c,h,y,x,E,D,M,P){const z=M.circle,B=M.seenUids,$=this.boxCells[E];if(null!==$){const ee=this.bboxes;for(const te of $)if(!B.box[te]){B.box[te]=!0;const ne=4*te;if(this._circleAndRectCollide(z.x,z.y,z.radius,ee[ne+0],ee[ne+1],ee[ne+2],ee[ne+3])&&(!P||P(this.boxKeys[te])))return D.push(!0),!0}}const X=this.circleCells[E];if(null!==X){const ee=this.circles;for(const te of X)if(!B.circle[te]){B.circle[te]=!0;const ne=3*te;if(this._circlesCollide(ee[ne],ee[ne+1],ee[ne+2],z.x,z.y,z.radius)&&(!P||P(this.circleKeys[te])))return D.push(!0),!0}}}_forEachCell(c,h,y,x,E,D,M,P){const z=this._convertToXCellCoord(c),B=this._convertToYCellCoord(h),$=this._convertToXCellCoord(y),X=this._convertToYCellCoord(x);for(let ee=z;ee<=$;ee++)for(let te=B;te<=X;te++)if(E.call(this,c,h,y,x,this.xCellCount*te+ee,D,M,P))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,h,y,x,E,D){const M=x-c,P=E-h,z=y+D;return z*z>M*M+P*P}_circleAndRectCollide(c,h,y,x,E,D,M){const P=(D-x)/2,z=Math.abs(c-(x+P));if(z>P+y)return!1;const B=(M-E)/2,$=Math.abs(h-(E+B));if($>B+y)return!1;if(z<=P||$<=B)return!0;const X=z-P,ee=$-B;return X*X+ee*ee<=y*y}}const ra=Math.tan(85*Math.PI/180);function sc(g,c,h,y,x,E,D){const M=f.create();if(h)if("globe"===E.name){const P=f.calculateGlobeLabelMatrix(x,c);f.multiply(M,M,P)}else{const P=vt([],D);M[0]=P[0],M[1]=P[1],M[4]=P[2],M[5]=P[3],y||f.rotateZ(M,M,x.angle)}else f.multiply(M,x.labelPlaneMatrix,g);return M}function hr(g,c,h,y,x,E,D){const M=sc(g,c,h,y,x,E,D);return"globe"===E.name&&h||(M[2]=M[6]=M[10]=M[14]=0),M}function xa(g,c,h,y,x,E,D){if(h){if("globe"===E.name){const M=sc(g,c,h,y,x,E,D);return f.invert(M,M),f.multiply(M,g,M),M}{const M=f.clone(g),P=f.identity([]);return P[0]=D[0],P[1]=D[1],P[4]=D[2],P[5]=D[3],f.multiply(M,M,P),y||f.rotateZ(M,M,-x.angle),M}}return x.glCoordMatrix}function Et(g,c,h,y){const x=[g,c,h,1];h?f.transformMat4$1(x,x,y):pp(x,x,y);const E=x[3];return x[0]/=E,x[1]/=E,x[2]/=E,x}function kn(g,c){return Math.min(.5+g/c*.5,1.5)}function qt(g,c){const h=g[0]/g[3],y=g[1]/g[3];return h>=-c[0]&&h<=c[0]&&y>=-c[1]&&y<=c[1]}function gs(g,c,h,y,x,E,D,M,P,z){const B=h.transform,$=y?g.textSizeData:g.iconSizeData,X=f.evaluateSizeForZoom($,h.transform.zoom),ee="globe"===B.projection.name,te=[256/h.width*2+1,256/h.height*2+1],ne=y?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ne.clear();let J=null;ee&&(J=y?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const Y=g.lineVertexArray,ce=y?g.text.placedSymbolArray:g.icon.placedSymbolArray,le=h.transform.width/h.transform.height;let de,xe=!1;for(let ye=0;ye<ce.length;ye++){const Ce=ce.get(ye),{numGlyphs:Ae,writingMode:Ne}=Ce;if(Ne!==f.WritingMode.vertical||xe||de===f.WritingMode.horizontal||(xe=!0),de=Ne,(Ce.hidden||Ne===f.WritingMode.vertical)&&!xe){wi(Ae,ne);continue}xe=!1;const Ve=new f.pointGeometry(Ce.tileAnchorX,Ce.tileAnchorY);let{x:yt,y:Pe,z:et}=B.projection.projectTilePoint(Ve.x,Ve.y,z.canonical);if(P){const[On,Ft,kt]=P(Ve);yt+=On,Pe+=Ft,et+=kt}const We=[yt,Pe,et,1];if(f.transformMat4$1(We,We,c),!qt(We,te)){wi(Ae,ne);continue}const ht=kn(h.transform.cameraToCenterDistance,We[3]),Ue=f.evaluateSizeForFeature($,X,Ce),Se=D?Ue/ht:Ue*ht,He=Et(yt,Pe,et,x);if(He[3]<=0){wi(Ae,ne);continue}let ct={};const ft=D?null:P,Yt=ac(Ce,Se,!1,M,c,x,E,g.glyphOffsetArray,Y,ne,J,He,Ve,ct,le,ft,B.projection,z,D);xe=Yt.useVertical,ft&&Yt.needsFlipping&&(ct={}),(Yt.notEnoughRoom||xe||Yt.needsFlipping&&ac(Ce,Se,!0,M,c,x,E,g.glyphOffsetArray,Y,ne,J,He,Ve,ct,le,ft,B.projection,z,D).notEnoughRoom)&&wi(Ae,ne)}y?(g.text.dynamicLayoutVertexBuffer.updateData(ne),J&&g.text.globeExtVertexBuffer.updateData(J)):(g.icon.dynamicLayoutVertexBuffer.updateData(ne),J&&g.icon.globeExtVertexBuffer.updateData(J))}function xi(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne){const{lineStartIndex:J,glyphStartIndex:Y,segment:ce}=M,le=Y+M.numGlyphs,de=J+M.lineLength,xe=c.getoffsetX(Y),ye=c.getoffsetX(le-1),Ce=cr(g*xe,h,y,x,E,D,ce,J,de,P,z,B,$,X,!0,ee,te,ne);if(!Ce)return null;const Ae=cr(g*ye,h,y,x,E,D,ce,J,de,P,z,B,$,X,!0,ee,te,ne);return Ae?{first:Ce,last:Ae}:null}function An(g,c,h,y){return g===f.WritingMode.horizontal&&Math.abs(y)>Math.abs(h)?{useVertical:!0}:g===f.WritingMode.vertical?y>0?{needsFlipping:!0}:null:0!==c&&(0===(x=h)||Math.abs(y/x)>ra)?1===c?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null;var x}function ac(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne,J,Y,ce){const le=c/24,de=g.lineOffsetX*le,xe=g.lineOffsetY*le,{lineStartIndex:ye,glyphStartIndex:Ce,numGlyphs:Ae,segment:Ne,writingMode:Ve,flipState:yt}=g,Pe=ye+g.lineLength,et=We=>{if(B){const[He,ct,ft]=We.up,Yt=z.length;f.updateGlobeVertexNormal(B,Yt+0,He,ct,ft),f.updateGlobeVertexNormal(B,Yt+1,He,ct,ft),f.updateGlobeVertexNormal(B,Yt+2,He,ct,ft),f.updateGlobeVertexNormal(B,Yt+3,He,ct,ft)}const[ht,Ue,Se]=We.point;f.addDynamicAttributes(z,ht,Ue,Se,We.angle)};if(Ae>1){const We=xi(le,M,de,xe,h,$,X,g,P,E,ee,ne,!1,J,Y,ce);if(!We)return{notEnoughRoom:!0};if(y&&!h){let[ht,Ue,Se]=We.first.point,[He,ct,ft]=We.last.point;[ht,Ue]=Et(ht,Ue,Se,D),[He,ct]=Et(He,ct,ft,D);const Yt=An(Ve,yt,(He-ht)*te,ct-Ue);if(g.flipState=Yt&&Yt.needsFlipping?1:2,Yt)return Yt}et(We.first);for(let ht=Ce+1;ht<Ce+Ae-1;ht++){const Ue=cr(le*M.getoffsetX(ht),de,xe,h,$,X,Ne,ye,Pe,P,E,ee,ne,!1,!1,J,Y,ce);if(!Ue)return z.length-=4*(ht-Ce),{notEnoughRoom:!0};et(Ue)}et(We.last)}else{if(y&&!h){const ht=Et(X.x,X.y,0,x),Ue=ye+Ne+1,Se=new f.pointGeometry(P.getx(Ue),P.gety(Ue)),He=Et(Se.x,Se.y,0,x),ct=He[3]>0?He:mn(X,Se,ht,1,x,void 0,J,Y.canonical),ft=An(Ve,yt,(ct[0]-ht[0])*te,ct[1]-ht[1]);if(g.flipState=ft&&ft.needsFlipping?1:2,ft)return ft}const We=cr(le*M.getoffsetX(Ce),de,xe,h,$,X,Ne,ye,Pe,P,E,ee,ne,!1,!1,J,Y,ce);if(!We)return{notEnoughRoom:!0};et(We)}return{}}function mi(g,c,h,y,x){const{x:E,y:D,z:M}=y.projectTilePoint(g.x,g.y,c);if(!x)return Et(E,D,M,h);const[P,z,B]=x(g);return Et(E+P,D+z,M+B,h)}function mn(g,c,h,y,x,E,D,M){const P=mi(g.sub(c)._unit()._add(g),M,x,D,E);return f.sub(P,h,P),f.normalize(P,P),f.scaleAndAdd(P,h,P,y)}function cr(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne,J,Y){const ce=y?g-c:g+c;let le=ce>0?1:-1,de=0;y&&(le*=-1,de=Math.PI),le<0&&(de+=Math.PI);let xe=M+D+(le>0?0:1)|0,ye=x,Ce=x,Ae=0,Ne=0;const Ve=Math.abs(ce),yt=[],Pe=[];let et=E,We=et;const ht=()=>mn(We,et,Ce,Ve-Ae+1,B,X,ne,J.canonical);for(;Ae+Ne<=Ve;){if(xe+=le,xe<M||xe>=P)return null;if(Ce=ye,We=et,yt.push(Ce),ee&&Pe.push(We),et=new f.pointGeometry(z.getx(xe),z.gety(xe)),ye=$[xe],!ye){const kt=mi(et,J.canonical,B,ne,X);ye=kt[3]>0?$[xe]=kt:ht()}Ae+=Ne,Ne=f.distance(Ce,ye)}te&&X&&($[xe]&&(ye=ht(),Ne=f.distance(Ce,ye)),$[xe]=ye);const Ue=(Ve-Ae)/Ne,Se=et.sub(We)._mult(Ue)._add(We),He=f.sub([],ye,Ce),ct=f.scaleAndAdd([],Ce,He,Ue);let ft=[0,0,1],Yt=He[0],On=He[1];if(Y&&(ft=ne.upVector(J.canonical,Se.x,Se.y),0!==ft[0]||0!==ft[1]||1!==ft[2])){const kt=[ft[2],0,-ft[0]],Kt=f.cross([],ft,kt);f.normalize(kt,kt),f.normalize(Kt,Kt),Yt=f.dot(He,kt),On=f.dot(He,Kt)}if(h){const kt=f.cross([],ft,He);f.normalize(kt,kt),f.scaleAndAdd(ct,ct,kt,h*le)}const Ft=de+Math.atan2(On,Yt);return yt.push(ct),ee&&Pe.push(Se),{point:ct,angle:Ft,path:yt,tilePath:Pe,up:ft}}function wi(g,c){const h=c.length,y=h+4*g;c.resize(y),c.float32.fill(-1/0,4*h,4*y)}function pp(g,c,h){const y=c[0],x=c[1];return g[0]=h[0]*y+h[4]*x+h[12],g[1]=h[1]*y+h[5]*x+h[13],g[3]=h[3]*y+h[7]*x+h[15],g}const Mr=100;class ot{constructor(c,h,y=new Nd(c.width+200,c.height+200,25),x=new Nd(c.width+200,c.height+200,25)){this.transform=c,this.grid=y,this.ignoredGrid=x,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Mr,this.screenBottomBoundary=c.height+Mr,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=h}placeCollisionBox(c,h,y,x,E,D,M,P){let z=y.projectedAnchorX,B=y.projectedAnchorY,$=y.projectedAnchorZ;const X=y.elevation,ee=y.tileID,te=c.getProjection();if(X&&ee){const[ye,Ce,Ae]=te.upVector(ee.canonical,y.tileAnchorX,y.tileAnchorY),Ne=te.upVectorScale(ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=ye*X*Ne,B+=Ce*X*Ne,$+=Ae*X*Ne}const ne=this.projectAndGetPerspectiveRatio(M,z,B,$,y.tileID,"globe"===te.name||!!X||this.transform.pitch>0,te),J=D*ne.perspectiveRatio,Y=(y.x1*h+x.x-y.padding)*J+ne.point.x,ce=(y.y1*h+x.y-y.padding)*J+ne.point.y,le=(y.x2*h+x.x+y.padding)*J+ne.point.x,de=(y.y2*h+x.y+y.padding)*J+ne.point.y,xe=ne.perspectiveRatio<=.55||ne.occluded;return!this.isInsideGrid(Y,ce,le,de)||!E&&this.grid.hitTest(Y,ce,le,de,P)||xe?{box:[],offscreen:!1,occluded:ne.occluded}:{box:[Y,ce,le,de],offscreen:this.isOffscreen(Y,ce,le,de),occluded:!1}}placeCollisionCircles(c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne){const J=[],Y=this.transform.elevation,ce=c.getProjection(),le=Y?Y.getAtTileOffsetFunc(ne,this.transform.center.lat,this.transform.worldSize,ce):null,de=new f.pointGeometry(y.tileAnchorX,y.tileAnchorY);let{x:xe,y:ye,z:Ce}=ce.projectTilePoint(de.x,de.y,ne.canonical);if(le){const[Se,He,ct]=le(de);xe+=Se,ye+=He,Ce+=ct}const Ae="globe"===ce.name,Ne=this.projectAndGetPerspectiveRatio(M,xe,ye,Ce,ne,Ae||!!Y||this.transform.pitch>0,ce),{perspectiveRatio:Ve}=Ne,yt=($?D/Ve:D*Ve)/f.ONE_EM,Pe=Et(xe,ye,Ce,P),et=Ne.signedDistanceFromCamera>0?xi(yt,E,y.lineOffsetX*yt,y.lineOffsetY*yt,!1,Pe,de,y,x,P,{},Y&&!$?le:null,$&&!!Y,ce,ne,$):null;let We=!1,ht=!1,Ue=!0;if(et&&!Ne.occluded){const Se=.5*ee*Ve+te,He=new f.pointGeometry(-100,-100),ct=new f.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ft=new Ga,{first:Yt,last:On}=et,Ft=Yt.path.length;let kt=[];for(let Jt=Ft-1;Jt>=1;Jt--)kt.push(Yt.path[Jt]);for(let Jt=1;Jt<On.path.length;Jt++)kt.push(On.path[Jt]);const Kt=2.5*Se;z&&(kt=kt.map(([Jt,_i,hi],qi)=>(le&&!Ae&&(hi=le(qi<Ft-1?Yt.tilePath[Ft-1-qi]:On.tilePath[qi-Ft+2])[2]),Et(Jt,_i,hi,z))),kt.some(Jt=>Jt[3]<=0)&&(kt=[]));let Rn=[];if(kt.length>0){let Jt=1/0,_i=-1/0,hi=1/0,qi=-1/0;for(const Si of kt)Jt=Math.min(Jt,Si[0]),hi=Math.min(hi,Si[1]),_i=Math.max(_i,Si[0]),qi=Math.max(qi,Si[1]);_i>=He.x&&Jt<=ct.x&&qi>=He.y&&hi<=ct.y&&(Rn=[kt.map(Si=>new f.pointGeometry(Si[0],Si[1]))],(Jt<He.x||_i>ct.x||hi<He.y||qi>ct.y)&&(Rn=f.clipLine(Rn,He.x,He.y,ct.x,ct.y)))}for(const Jt of Rn){ft.reset(Jt,.25*Se);let _i=0;_i=ft.length<=.5*Se?1:Math.ceil(ft.paddedLength/Kt)+1;for(let hi=0;hi<_i;hi++){const qi=hi/Math.max(_i-1,1),Si=ft.lerp(qi),gr=Si.x+Mr,xo=Si.y+Mr;J.push(gr,xo,Se,0);const rl=gr-Se,ol=xo-Se,Qi=gr+Se,Ui=xo+Se;if(Ue=Ue&&this.isOffscreen(rl,ol,Qi,Ui),ht=ht||this.isInsideGrid(rl,ol,Qi,Ui),!h&&this.grid.hitTestCircle(gr,xo,Se,X)&&(We=!0,!B))return{circles:[],offscreen:!1,collisionDetected:We,occluded:!1}}}}return{circles:!B&&We||!ht?[]:J,offscreen:Ue,collisionDetected:We,occluded:Ne.occluded}}queryRenderedSymbols(c){if(0===c.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const h=[];let y=1/0,x=1/0,E=-1/0,D=-1/0;for(const B of c){const $=new f.pointGeometry(B.x+Mr,B.y+Mr);y=Math.min(y,$.x),x=Math.min(x,$.y),E=Math.max(E,$.x),D=Math.max(D,$.y),h.push($)}const M=this.grid.query(y,x,E,D).concat(this.ignoredGrid.query(y,x,E,D)),P={},z={};for(const B of M){const $=B.key;if(void 0===P[$.bucketInstanceId]&&(P[$.bucketInstanceId]={}),P[$.bucketInstanceId][$.featureIndex])continue;const X=[new f.pointGeometry(B.x1,B.y1),new f.pointGeometry(B.x2,B.y1),new f.pointGeometry(B.x2,B.y2),new f.pointGeometry(B.x1,B.y2)];f.polygonIntersectsPolygon(h,X)&&(P[$.bucketInstanceId][$.featureIndex]=!0,void 0===z[$.bucketInstanceId]&&(z[$.bucketInstanceId]=[]),z[$.bucketInstanceId].push($.featureIndex))}return z}insertCollisionBox(c,h,y,x,E){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:x,collisionGroupID:E},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,h,y,x,E){const D=h?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:x,collisionGroupID:E};for(let P=0;P<c.length;P+=4)D.insertCircle(M,c[P],c[P+1],c[P+2])}projectAndGetPerspectiveRatio(c,h,y,x,E,D,M){const P=[h,y,x,1];let z=!1;x||this.transform.pitch>0?(f.transformMat4$1(P,P,c),this.fogState&&E&&"globe"!==M.name&&(z=function(ee,te,ne,J,Y,ce){const le=ce.calculateFogTileMatrix(Y),de=[te,ne,J];return f.transformMat4(de,de,le),Do(ee,de,ce.pitch,ce._fov)}(this.fogState,h,y,x,E.toUnwrapped(),this.transform)>.9)):pp(P,P,c);const B=P[3];return{point:new f.pointGeometry((P[0]/B+1)/2*this.transform.width+Mr,(-P[1]/B+1)/2*this.transform.height+Mr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/B*.5,1.5),signedDistanceFromCamera:B,occluded:D&&P[2]>B||z}}isOffscreen(c,h,y,x){return y<Mr||c>=this.screenRightBoundary||x<Mr||h>this.screenBottomBoundary}isInsideGrid(c,h,y,x){return y>=0&&c<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const c=f.identity([]);return f.translate(c,c,[-100,-100,0]),c}}function oa(g,c,h){const y=c.createTileMatrix(g,g.worldSize,h.toUnwrapped());return f.multiply(new Float32Array(16),g.projMatrix,y)}function Sn(g,c,h){if(c.projection.name===h.projection.name)return g.projMatrix;const y=h.clone();return y.setProjection(c.projection),oa(y,c.getProjection(),g)}function gi(g,c,h){return c.name===h.projection.name?g.projMatrix:oa(h,c,g)}class Qc{constructor(c,h,y,x){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?h:-h))):x&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class lc{constructor(c,h,y,x,E,D=!1){this.text=new Qc(c?c.text:null,h,y,E),this.icon=new Qc(c?c.icon:null,h,x,E),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class cc{constructor(c,h,y,x=!1){this.text=c,this.icon=h,this.skipFade=y,this.clipped=x}}class sa{constructor(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]}}class Xi{constructor(c,h,y,x,E){this.bucketInstanceId=c,this.featureIndex=h,this.sourceLayerIndex=y,this.bucketIndex=x,this.tileID=E}}class ur{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const h=++this.maxGroupID;this.collisionGroups[c]={ID:h,predicate:y=>y.collisionGroupID===h}}return this.collisionGroups[c]}}function Zu(g,c,h,y,x){const{horizontalAlign:E,verticalAlign:D}=f.getAnchorAlignment(g),M=-(E-.5)*c,P=-(D-.5)*h,z=f.evaluateVariableOffset(g,y);return new f.pointGeometry(M+z[0]*x,P+z[1]*x)}function Yu(g,c,h,y,x){const E=new f.pointGeometry(g,c);return h&&E._rotate(y?x:-x),E}class fr{constructor(c,h,y,x,E){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new ot(this.transform,E),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new ur(y),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,h,y,x){const E=y.getBucket(h),D=y.latestFeatureIndex;if(!E||!D||h.id!==E.layerIds[0])return;const M=E.layers[0].layout,P=y.collisionBoxArray,z=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),B=y.tileSize/f.EXTENT,$=y.tileID.toUnwrapped();this.transform.setProjection(E.projection);const X=(ee=y.tileID,te=E.getProjection(),ne=this.transform,te.name===this.projection?ne.calculateProjMatrix(ee.toUnwrapped()):oa(ne,te,ee));var ee,te,ne;const J="map"===M.get("text-pitch-alignment"),Y="map"===M.get("text-rotation-alignment");h.compileFilter();const ce=h.dynamicFilter(),le=h.dynamicFilterNeedsFeature(),de=this.transform.calculatePixelsToTileUnitsMatrix(y),xe=hr(X,y.tileID.canonical,J,Y,this.transform,E.getProjection(),de);let ye=null;if(J){const Ne=xa(X,y.tileID.canonical,J,Y,this.transform,E.getProjection(),de);ye=f.multiply([],this.transform.labelPlaneMatrix,Ne)}let Ce=null;ce&&y.latestFeatureIndex&&(Ce={unwrappedTileID:$,dynamicFilter:ce,dynamicFilterNeedsFeature:le,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[E.bucketInstanceId]=new Xi(E.bucketInstanceId,D,E.sourceLayerIndex,E.index,y.tileID);const Ae={bucket:E,layout:M,posMatrix:X,textLabelPlaneMatrix:xe,labelToScreenMatrix:ye,clippingData:Ce,scale:z,textPixelRatio:B,holdingForFade:y.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:f.evaluateSizeForZoom(E.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(x)for(const Ne of E.sortKeyRanges){const{sortKey:Ve,symbolInstanceStart:yt,symbolInstanceEnd:Pe}=Ne;c.push({sortKey:Ve,symbolInstanceStart:yt,symbolInstanceEnd:Pe,parameters:Ae})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ae})}attemptAnchorPlacement(c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne,J,Y,ce){const{textOffset0:le,textOffset1:de,crossTileID:xe}=X,ye=[le,de],Ce=Zu(c,y,x,ye,E),Ae=this.collisionIndex.placeCollisionBox(te,E,h,Yu(Ce.x,Ce.y,D,M,this.transform.angle),$,P,z,B.predicate);if(J){const Ne=te.getSymbolInstanceIconSize(ce,this.transform.zoom,X.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(te,Ne,J,Yu(Ce.x,Ce.y,D,M,this.transform.angle),$,P,z,B.predicate).box.length)return}if(Ae.box.length>0){let Ne;return this.prevPlacement&&this.prevPlacement.variableOffsets[xe]&&this.prevPlacement.placements[xe]&&this.prevPlacement.placements[xe].text&&(Ne=this.prevPlacement.variableOffsets[xe].anchor),this.variableOffsets[xe]={textOffset:ye,width:y,height:x,anchor:c,textScale:E,prevAnchor:Ne},this.markUsedJustification(te,c,X,ne),te.allowVerticalPlacement&&(this.markUsedOrientation(te,ne,X),this.placedOrientations[xe]=ne),{shift:Ce,placedGlyphBoxes:Ae}}}placeLayerBucketPart(c,h,y,x){const{bucket:E,layout:D,posMatrix:M,textLabelPlaneMatrix:P,labelToScreenMatrix:z,clippingData:B,textPixelRatio:$,holdingForFade:X,collisionBoxArray:ee,partiallyEvaluatedTextSize:te,partiallyEvaluatedIconSize:ne,collisionGroup:J}=c.parameters,Y=D.get("text-optional"),ce=D.get("icon-optional"),le=D.get("text-allow-overlap"),de=D.get("icon-allow-overlap"),xe="map"===D.get("text-rotation-alignment"),ye="map"===D.get("text-pitch-alignment"),Ce="none"!==D.get("icon-text-fit"),Ae="viewport-y"===D.get("symbol-z-order");this.transform.setProjection(E.projection);let Ne=le&&(de||!E.hasIconData()||ce),Ve=de&&(le||!E.hasTextData()||Y);!E.collisionArrays&&ee&&E.deserializeCollisionBoxes(ee),y&&x&&E.updateCollisionDebugBuffers(this.transform.zoom,ee);const yt=(Pe,et,We)=>{const{crossTileID:ht,numVerticalGlyphVertices:Ue}=Pe;if(B){const Qi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ui=null;if(B.dynamicFilterNeedsFeature){const Fn=this.retainedQueryData[E.bucketInstanceId];Ui=B.featureIndex.loadFeature({featureIndex:Pe.featureIndex,bucketIndex:Fn.bucketIndex,sourceLayerIndex:Fn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,B.dynamicFilter)(Qi,Ui,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new f.pointGeometry(Pe.tileAnchorX,Pe.tileAnchorY),this.transform.calculateDistanceTileData(B.unwrappedTileID)))return this.placements[ht]=new cc(!1,!1,!1,!0),void(h[ht]=!0)}if(h[ht])return;if(X)return void(this.placements[ht]=new cc(!1,!1,!1));let Se=!1,He=!1,ct=!0,ft=!1,Yt=!1,On=null,Ft={box:null,offscreen:null,occluded:null},kt={box:null,offscreen:null,occluded:null},Kt=null,Rn=null,Jt=null,_i=0,hi=0,qi=0;We.textFeatureIndex?_i=We.textFeatureIndex:Pe.useRuntimeCollisionCircles&&(_i=Pe.featureIndex),We.verticalTextFeatureIndex&&(hi=We.verticalTextFeatureIndex);const Si=Qi=>{Qi.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Ui=this.transform.elevation;(Ui||Qi.elevation)&&(Qi.elevation=Ui?Ui.getAtTileOffset(Qi.tileID,Qi.tileAnchorX,Qi.tileAnchorY):0)},gr=We.textBox;if(gr){Si(gr);const Qi=Fn=>{let _r=f.WritingMode.horizontal;if(E.allowVerticalPlacement&&!Fn&&this.prevPlacement){const qr=this.prevPlacement.placedOrientations[ht];qr&&(this.placedOrientations[ht]=qr,_r=qr,this.markUsedOrientation(E,_r,Pe))}return _r},Ui=(Fn,_r)=>{if(E.allowVerticalPlacement&&Ue>0&&We.verticalTextBox){for(const qr of E.writingModes)if(qr===f.WritingMode.vertical?(Ft=_r(),kt=Ft):Ft=Fn(),Ft&&Ft.box&&Ft.box.length)break}else Ft=Fn()};if(D.get("text-variable-anchor")){let Fn=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ht]){const ji=this.prevPlacement.variableOffsets[ht];Fn.indexOf(ji.anchor)>0&&(Fn=Fn.filter(wo=>wo!==ji.anchor),Fn.unshift(ji.anchor))}const _r=(ji,wo,ao)=>{const sl=E.getSymbolInstanceTextSize(te,Pe,this.transform.zoom,et),sd=(ji.x2-ji.x1)*sl+2*ji.padding,Ts=(ji.y2-ji.y1)*sl+2*ji.padding,Gs=Ce&&!de?wo:null;Gs&&Si(Gs);let al={box:[],offscreen:!1,occluded:!1};const jl=le?2*Fn.length:Fn.length;for(let wc=0;wc<jl;++wc){const $l=this.attemptAnchorPlacement(Fn[wc%Fn.length],ji,sd,Ts,sl,xe,ye,$,M,J,wc>=Fn.length,Pe,et,E,ao,Gs,te,ne);if($l&&(al=$l.placedGlyphBoxes,al&&al.box&&al.box.length)){Se=!0,On=$l.shift;break}}return al};Ui(()=>_r(gr,We.iconBox,f.WritingMode.horizontal),()=>{const ji=We.verticalTextBox;return ji&&Si(ji),E.allowVerticalPlacement&&!(Ft&&Ft.box&&Ft.box.length)&&Ue>0&&ji?_r(ji,We.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ft&&(Se=Ft.box,ct=Ft.offscreen,ft=Ft.occluded);const qr=Qi(Ft&&Ft.box);if(!Se&&this.prevPlacement){const ji=this.prevPlacement.variableOffsets[ht];ji&&(this.variableOffsets[ht]=ji,this.markUsedJustification(E,ji.anchor,Pe,qr))}}else{const Fn=(_r,qr)=>{const ji=E.getSymbolInstanceTextSize(te,Pe,this.transform.zoom,et),wo=this.collisionIndex.placeCollisionBox(E,ji,_r,new f.pointGeometry(0,0),le,$,M,J.predicate);return wo&&wo.box&&wo.box.length&&(this.markUsedOrientation(E,qr,Pe),this.placedOrientations[ht]=qr),wo};Ui(()=>Fn(gr,f.WritingMode.horizontal),()=>{const _r=We.verticalTextBox;return E.allowVerticalPlacement&&Ue>0&&_r?(Si(_r),Fn(_r,f.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Qi(Ft&&Ft.box&&Ft.box.length)}}if(Kt=Ft,Se=Kt&&Kt.box&&Kt.box.length>0,ct=Kt&&Kt.offscreen,ft=Kt&&Kt.occluded,Pe.useRuntimeCollisionCircles){const Qi=E.text.placedSymbolArray.get(Pe.centerJustifiedTextSymbolIndex>=0?Pe.centerJustifiedTextSymbolIndex:Pe.verticalPlacedTextSymbolIndex),Ui=f.evaluateSizeForFeature(E.textSizeData,te,Qi),Fn=D.get("text-padding");Rn=this.collisionIndex.placeCollisionCircles(E,le,Qi,E.lineVertexArray,E.glyphOffsetArray,Ui,M,P,z,y,ye,J.predicate,Pe.collisionCircleDiameter*Ui/f.ONE_EM,Fn,this.retainedQueryData[E.bucketInstanceId].tileID),Se=le||Rn.circles.length>0&&!Rn.collisionDetected,ct=ct&&Rn.offscreen,ft=Rn.occluded}if(We.iconFeatureIndex&&(qi=We.iconFeatureIndex),We.iconBox){const Qi=Ui=>{Si(Ui);const Fn=Ce&&On?Yu(On.x,On.y,xe,ye,this.transform.angle):new f.pointGeometry(0,0),_r=E.getSymbolInstanceIconSize(ne,this.transform.zoom,Pe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,_r,Ui,Fn,de,$,M,J.predicate)};kt&&kt.box&&kt.box.length&&We.verticalIconBox?(Jt=Qi(We.verticalIconBox),He=Jt.box.length>0):(Jt=Qi(We.iconBox),He=Jt.box.length>0),ct=ct&&Jt.offscreen,Yt=Jt.occluded}const xo=Y||0===Pe.numHorizontalGlyphVertices&&0===Ue,rl=ce||0===Pe.numIconVertices;if(xo||rl?rl?xo||(He=He&&Se):Se=He&&Se:He=Se=He&&Se,Se&&Kt&&Kt.box&&this.collisionIndex.insertCollisionBox(Kt.box,D.get("text-ignore-placement"),E.bucketInstanceId,kt&&kt.box&&hi?hi:_i,J.ID),He&&Jt&&this.collisionIndex.insertCollisionBox(Jt.box,D.get("icon-ignore-placement"),E.bucketInstanceId,qi,J.ID),Rn&&(Se&&this.collisionIndex.insertCollisionCircles(Rn.circles,D.get("text-ignore-placement"),E.bucketInstanceId,_i,J.ID),y)){const Qi=E.bucketInstanceId;let Ui=this.collisionCircleArrays[Qi];void 0===Ui&&(Ui=this.collisionCircleArrays[Qi]=new sa);for(let Fn=0;Fn<Rn.circles.length;Fn+=4)Ui.circles.push(Rn.circles[Fn+0]),Ui.circles.push(Rn.circles[Fn+1]),Ui.circles.push(Rn.circles[Fn+2]),Ui.circles.push(Rn.collisionDetected?1:0)}const ol="globe"!==E.projection.name;Ne=Ne&&(ol||!ft),Ve=Ve&&(ol||!Yt),this.placements[ht]=new cc(Se||Ne,He||Ve,ct||E.justReloaded),h[ht]=!0};if(Ae){const Pe=E.getSortedSymbolIndexes(this.transform.angle);for(let et=Pe.length-1;et>=0;--et){const We=Pe[et];yt(E.symbolInstances.get(We),We,E.collisionArrays[We])}}else for(let Pe=c.symbolInstanceStart;Pe<c.symbolInstanceEnd;Pe++)yt(E.symbolInstances.get(Pe),Pe,E.collisionArrays[Pe]);if(y&&E.bucketInstanceId in this.collisionCircleArrays){const Pe=this.collisionCircleArrays[E.bucketInstanceId];f.invert(Pe.invProjMatrix,M),Pe.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(c,h,y,x){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:P,crossTileID:z}=y,B=f.getAnchorJustification(h),$=x===f.WritingMode.vertical?P:"left"===B?E:"center"===B?D:"right"===B?M:-1;E>=0&&(c.text.placedSymbolArray.get(E).crossTileID=$>=0&&E!==$?0:z),D>=0&&(c.text.placedSymbolArray.get(D).crossTileID=$>=0&&D!==$?0:z),M>=0&&(c.text.placedSymbolArray.get(M).crossTileID=$>=0&&M!==$?0:z),P>=0&&(c.text.placedSymbolArray.get(P).crossTileID=$>=0&&P!==$?0:z)}markUsedOrientation(c,h,y){const x=h===f.WritingMode.horizontal||h===f.WritingMode.horizontalOnly?h:0,E=h===f.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:z}=y,B=c.text.placedSymbolArray;D>=0&&(B.get(D).placedOrientation=x),M>=0&&(B.get(M).placedOrientation=x),P>=0&&(B.get(P).placedOrientation=x),z>=0&&(B.get(z).placedOrientation=E)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let y=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(c):1,E=h?h.opacities:{},D=h?h.variableOffsets:{},M=h?h.placedOrientations:{};for(const P in this.placements){const z=this.placements[P],B=E[P];B?(this.opacities[P]=new lc(B,x,z.text,z.icon,null,z.clipped),y=y||z.text!==B.text.placed||z.icon!==B.icon.placed):(this.opacities[P]=new lc(null,x,z.text,z.icon,z.skipFade,z.clipped),y=y||z.text||z.icon)}for(const P in E){const z=E[P];if(!this.opacities[P]){const B=new lc(z,x,!1,!1);B.isHidden()||(this.opacities[P]=B,y=y||z.text.placed||z.icon.placed)}}for(const P in D)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=D[P]);for(const P in M)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=M[P]);y?this.lastPlacementChangeTime=c:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:c)}updateLayerOpacities(c,h){const y={};for(const x of h){const E=x.getBucket(c);E&&x.latestFeatureIndex&&c.id===E.layerIds[0]&&this.updateBucketOpacities(E,y,x.collisionBoxArray)}}updateBucketOpacities(c,h,y){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const x=c.layers[0].layout,E=!!c.layers[0].dynamicFilter(),D=new lc(null,0,!1,!1,!0),M=x.get("text-allow-overlap"),P=x.get("icon-allow-overlap"),z=x.get("text-variable-anchor"),B="map"===x.get("text-rotation-alignment"),$="map"===x.get("text-pitch-alignment"),X="none"!==x.get("icon-text-fit"),ee=new lc(null,0,M&&(P||!c.hasIconData()||x.get("icon-optional")),P&&(M||!c.hasTextData()||x.get("text-optional")),!0);!c.collisionArrays&&y&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(y);const te=(J,Y,ce)=>{for(let le=0;le<Y/4;le++)J.opacityVertexArray.emplaceBack(ce)};let ne=0;for(let J=0;J<c.symbolInstances.length;J++){const Y=c.symbolInstances.get(J),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:le,crossTileID:de,numIconVertices:xe}=Y;let ye=this.opacities[de];h[de]?ye=D:ye||(ye=ee,this.opacities[de]=ye),h[de]=!0;const Ce=ce>0||le>0,Ae=xe>0,Ne=this.placedOrientations[de],Ve=Ne===f.WritingMode.vertical,yt=Ne===f.WritingMode.horizontal||Ne===f.WritingMode.horizontalOnly;if(!Ce&&!Ae||ye.isHidden()||ne++,Ce){const Pe=Nr(ye.text);te(c.text,ce,Ve?ai:Pe),te(c.text,le,yt?ai:Pe);const et=ye.text.isHidden(),{leftJustifiedTextSymbolIndex:We,centerJustifiedTextSymbolIndex:ht,rightJustifiedTextSymbolIndex:Ue,verticalPlacedTextSymbolIndex:Se}=Y,He=c.text.placedSymbolArray,ct=et||Ve?1:0;We>=0&&(He.get(We).hidden=ct),ht>=0&&(He.get(ht).hidden=ct),Ue>=0&&(He.get(Ue).hidden=ct),Se>=0&&(He.get(Se).hidden=et||yt?1:0);const ft=this.variableOffsets[de];ft&&this.markUsedJustification(c,ft.anchor,Y,Ne);const Yt=this.placedOrientations[de];Yt&&(this.markUsedJustification(c,"left",Y,Yt),this.markUsedOrientation(c,Yt,Y))}if(Ae){const Pe=Nr(ye.icon),{placedIconSymbolIndex:et,verticalPlacedIconSymbolIndex:We}=Y,ht=c.icon.placedSymbolArray,Ue=ye.icon.isHidden()?1:0;et>=0&&(te(c.icon,xe,Ve?ai:Pe),ht.get(et).hidden=Ue),We>=0&&(te(c.icon,Y.numVerticalIconVertices,yt?ai:Pe),ht.get(We).hidden=Ue)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const Pe=c.collisionArrays[J];if(Pe){let et=new f.pointGeometry(0,0),We=!0;if(Pe.textBox||Pe.verticalTextBox){if(z){const Ue=this.variableOffsets[de];Ue?(et=Zu(Ue.anchor,Ue.width,Ue.height,Ue.textOffset,Ue.textScale),B&&et._rotate($?this.transform.angle:-this.transform.angle)):We=!1}E&&(We=!ye.clipped),Pe.textBox&&Mo(c.textCollisionBox.collisionVertexArray,ye.text.placed,!We||Ve,et.x,et.y),Pe.verticalTextBox&&Mo(c.textCollisionBox.collisionVertexArray,ye.text.placed,!We||yt,et.x,et.y)}const ht=We&&Boolean(!yt&&Pe.verticalIconBox);Pe.iconBox&&Mo(c.iconCollisionBox.collisionVertexArray,ye.icon.placed,ht,X?et.x:0,X?et.y:0),Pe.verticalIconBox&&Mo(c.iconCollisionBox.collisionVertexArray,ye.icon.placed,!ht,X?et.x:0,X?et.y:0)}}}if(c.fullyClipped=0===ne,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const J=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=J.invProjMatrix,c.placementViewportMatrix=J.viewportMatrix,c.collisionCircleArray=J.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return 0===this.fadeDuration?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,h){const y=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*y>c}setStale(){this.stale=!0}}function Mo(g,c,h,y,x){g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0),g.emplaceBack(c?1:0,h?1:0,y||0,x||0)}const mp=Math.pow(2,25),Bd=Math.pow(2,24),kr=Math.pow(2,17),Jc=Math.pow(2,16),Nh=Math.pow(2,9),uc=Math.pow(2,8),io=Math.pow(2,1);function Nr(g){if(0===g.opacity&&!g.placed)return 0;if(1===g.opacity&&g.placed)return 4294967295;const c=g.placed?1:0,h=Math.floor(127*g.opacity);return h*mp+c*Bd+h*kr+c*Jc+h*Nh+c*uc+h*io+c}const ai=0;class Wa{constructor(c){this._sortAcrossTiles="viewport-y"!==c.layout.get("symbol-z-order")&&void 0!==c.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,h,y,x,E){const D=this._bucketParts;for(;this._currentTileIndex<c.length;)if(h.getBucketParts(D,x,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((M,P)=>M.sortKey-P.sortKey));this._currentPartIndex<D.length;){const M=D[this._currentPartIndex];if(h.placeLayerBucketPart(M,this._seenCrossTileIDs,y,0===M.symbolInstanceStart),this._currentPartIndex++,E())return!0}return!1}}class Ku{constructor(c,h,y,x,E,D,M,P){this.placement=new fr(c,E,D,M,P),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(c,h,y){const x=f.exported.now(),E=()=>{const D=f.exported.now()-x;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=h[c[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=M)&&(!D.maxzoom||D.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new Wa(D)),this._inProgressLayer.continuePlacement(y[D.source],this.placement,this._showCollisionBoxes,D,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const Rl=512/f.EXTENT/2;class Mt{constructor(c,h,y){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let x=0;x<h.length;x++){const E=h.get(x),D=E.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,c)})}}getScaledCoordinates(c,h){const y=Rl/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*f.EXTENT+c.tileAnchorX)*y),y:Math.floor((h.canonical.y*f.EXTENT+c.tileAnchorY)*y)}}findMatches(c,h,y){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let E=0;E<c.length;E++){const D=c.get(E);if(D.crossTileID)continue;const M=this.indexedSymbolInstances[D.key];if(!M)continue;const P=this.getScaledCoordinates(D,h);for(const z of M)if(Math.abs(z.coord.x-P.x)<=x&&Math.abs(z.coord.y-P.y)<=x&&!y[z.crossTileID]){y[z.crossTileID]=!0,D.crossTileID=z.crossTileID;break}}}}class Bh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Pn{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const h=Math.round((c-this.lng)/360);if(0!==h)for(const y in this.indexes){const x=this.indexes[y],E={};for(const D in x){const M=x[D];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+h),E[M.tileID.key]=M}this.indexes[y]=E}this.lng=c}addBucket(c,h,y){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let E=0;E<h.symbolInstances.length;E++)h.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const x=this.usedCrossTileIDs[c.overscaledZ];for(const E in this.indexes){const D=this.indexes[E];if(Number(E)>c.overscaledZ)for(const M in D){const P=D[M];P.tileID.isChildOf(c)&&P.findMatches(h.symbolInstances,c,x)}else{const M=D[c.scaledTo(Number(E)).key];M&&M.findMatches(h.symbolInstances,c,x)}}for(let E=0;E<h.symbolInstances.length;E++){const D=h.symbolInstances.get(E);D.crossTileID||(D.crossTileID=y.generate(),x[D.crossTileID]=!0)}return void 0===this.indexes[c.overscaledZ]&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Mt(c,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(c,h){for(const y in h.indexedSymbolInstances)for(const x of h.indexedSymbolInstances[y])delete this.usedCrossTileIDs[c][x.crossTileID]}removeStaleBuckets(c){let h=!1;for(const y in this.indexes){const x=this.indexes[y];for(const E in x)c[x[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,x[E]),delete x[E],h=!0)}return h}}class dc{constructor(){this.layerIndexes={},this.crossTileIDs=new Bh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,h,y,x){let E=this.layerIndexes[c.id];void 0===E&&(E=this.layerIndexes[c.id]=new Pn);let D=!1;const M={};"globe"!==x.name&&E.handleWrapJump(y);for(const P of h){const z=P.getBucket(c);z&&c.id===z.layerIds[0]&&(z.bucketInstanceId||(z.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(P.tileID,z,this.crossTileIDs)&&(D=!0),M[z.bucketInstanceId]=!0)}return E.removeStaleBuckets(M)&&(D=!0),D}pruneUnusedLayers(c){const h={};c.forEach(y=>{h[y]=!0});for(const y in this.layerIndexes)h[y]||delete this.layerIndexes[y]}}const hc=(g,c)=>f.emitValidationErrors(g,c&&c.filter(h=>"source.canvas"!==h.identifier)),qa=f.pick(on,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Za=f.pick(on,["setCenter","setZoom","setBearing","setPitch"]),eu={version:8,layers:[],sources:{}},Us={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ko extends f.Evented{constructor(c,h={}){super(),this.map=c,this.dispatcher=new ta(Gt(),this),this.imageManager=new ki,this.imageManager.setEventedParent(this),this.glyphManager=new f.GlyphManager(c._requestManager,h.localFontFamily?f.LocalGlyphMode.all:h.localIdeographFontFamily?f.LocalGlyphMode.ideographs:f.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new dc,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());const y=this;this._rtlTextPluginCallback=ko.registerForPluginStateChange(x=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(E,D)=>{if(f.triggerPluginCompletionEvent(E),D&&D.every(M=>M))for(const M in y._sourceCaches){const P=y._sourceCaches[M],z=P.getSource().type;"vector"!==z&&"geojson"!==z||P.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const E=this.getSource(x.sourceId);if(E&&E.vectorLayerIds)for(const D in this._layers){const M=this._layers[D];M.source===E.id&&this._validateLayer(M)}})}loadURL(c,h={}){this.fire(new f.Event("dataloading",{dataType:"style"}));const y="boolean"==typeof h.validate?h.validate:!f.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,h.accessToken);const x=this.map._requestManager.transformRequest(c,f.ResourceType.Style);this._request=f.getJSON(x,(E,D)=>{this._request=null,E?this.fire(new f.ErrorEvent(E)):D&&this._load(D,y)})}loadJSON(c,h={}){this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.exported.frame(()=>{this._request=null,this._load(c,!1!==h.validate)})}loadEmpty(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(eu,!1)}_updateLayerCount(c,h){const y=h?1:-1;c.is3D()&&(this._num3DLayers+=y),"circle"===c.type&&(this._numCircleLayers+=y),"symbol"===c.type&&(this._numSymbolLayers+=y)}_load(c,h){if(h&&hc(this,f.validateStyle(c)))return;this._loaded=!0,this.stylesheet=f.clone$1(c),this._updateMapProjection();for(const x in c.sources)this.addSource(x,c.sources[x],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const y=Qn(this.stylesheet.layers);this._order=y.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of y){const E=f.createStyleLayer(x);E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new xr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(h,y,x){let E,D,M;const P=f.exported.devicePixelRatio>1?"@2x":"";let z=f.getJSON(y.transformRequest(y.normalizeSpriteURL(h,P,".json"),f.ResourceType.SpriteJSON),(X,ee)=>{z=null,M||(M=X,E=ee,$())}),B=f.getImage(y.transformRequest(y.normalizeSpriteURL(h,P,".png"),f.ResourceType.SpriteImage),(X,ee)=>{B=null,M||(M=X,D=ee,$())});function $(){if(M)x(M);else if(E&&D){const X=f.exported.getImageData(D),ee={};for(const te in E){const{width:ne,height:J,x:Y,y:ce,sdf:le,pixelRatio:de,stretchX:xe,stretchY:ye,content:Ce}=E[te],Ae=new f.RGBAImage({width:ne,height:J});f.RGBAImage.copy(X,Ae,{x:Y,y:ce},{x:0,y:0},{width:ne,height:J}),ee[te]={data:Ae,pixelRatio:de,sdf:le,stretchX:xe,stretchY:ye,content:Ce}}x(null,ee)}}return{cancel(){z&&(z.cancel(),z=null),B&&(B.cancel(),B=null)}}}(c,this.map._requestManager,(h,y)=>{if(this._spriteRequest=null,h)this.fire(new f.ErrorEvent(h));else if(y)for(const x in y)this.imageManager.addImage(x,y[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new f.Event("data",{dataType:"style"}))})}_validateLayer(c){const h=this.getSource(c.source);if(!h)return;const y=c.sourceLayer;y&&("geojson"===h.type||h.vectorLayerIds&&-1===h.vectorLayerIds.indexOf(y))&&this.fire(new f.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${h.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const h=[];for(const y of c){const x=this._layers[y];"custom"!==x.type&&h.push(x.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&("function"==typeof c.isLayerDraped?c.isLayerDraped():Us[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const h=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(x.length||E.length)&&this._updateWorkerLayers(x,E);for(const D in this._updatedSources){const M=this._updatedSources[D];"reload"===M?this._reloadSource(D):"clear"===M&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const y={};for(const x in this._sourceCaches){const E=this._sourceCaches[x];y[x]=E.used,E.used=!1}for(const x of this._order){const E=this._layers[x];if(E.recalculate(c,this._availableImages),!E.isHidden(c.zoom)){const M=this._getLayerSourceCache(E);M&&(M.used=!0)}const D=this.map.painter;if(D){const M=E.getProgramIds();if(!M)continue;const P=E.getProgramConfiguration(c.zoom);for(const z of M)D.useProgram(z,P)}}for(const x in y){const E=this._sourceCaches[x];y[x]!==E.used&&E.getSource().fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new f.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),hc(this,f.validateStyle(c)))return!1;(c=f.clone$1(c)).layers=Qn(c.layers);const h=function(x,E){if(!x)return[{command:on.setStyle,args:[E]}];let D=[];try{if(!ze(x.version,E.version))return[{command:on.setStyle,args:[E]}];ze(x.center,E.center)||D.push({command:on.setCenter,args:[E.center]}),ze(x.zoom,E.zoom)||D.push({command:on.setZoom,args:[E.zoom]}),ze(x.bearing,E.bearing)||D.push({command:on.setBearing,args:[E.bearing]}),ze(x.pitch,E.pitch)||D.push({command:on.setPitch,args:[E.pitch]}),ze(x.sprite,E.sprite)||D.push({command:on.setSprite,args:[E.sprite]}),ze(x.glyphs,E.glyphs)||D.push({command:on.setGlyphs,args:[E.glyphs]}),ze(x.transition,E.transition)||D.push({command:on.setTransition,args:[E.transition]}),ze(x.light,E.light)||D.push({command:on.setLight,args:[E.light]}),ze(x.fog,E.fog)||D.push({command:on.setFog,args:[E.fog]}),ze(x.projection,E.projection)||D.push({command:on.setProjection,args:[E.projection]});const M={},P=[];!function($,X,ee,te){let ne;for(ne in X=X||{},$=$||{})$.hasOwnProperty(ne)&&(X.hasOwnProperty(ne)||Di(ne,ee,te));for(ne in X){if(!X.hasOwnProperty(ne))continue;const J=X[ne];$.hasOwnProperty(ne)?ze($[ne],J)||("geojson"===$[ne].type&&"geojson"===J.type&&ms($,X,ne)?ee.push({command:on.setGeoJSONSourceData,args:[ne,J.data]}):Vs(ne,X,ee,te)):ii(ne,X,ee)}}(x.sources,E.sources,P,M);const z=[];x.layers&&x.layers.forEach($=>{$.source&&M[$.source]?D.push({command:on.removeLayer,args:[$.id]}):z.push($)});let B=x.terrain;B&&M[B.source]&&(D.push({command:on.setTerrain,args:[void 0]}),B=void 0),D=D.concat(P),ze(B,E.terrain)||D.push({command:on.setTerrain,args:[E.terrain]}),function($,X,ee){X=X||[];const te=($=$||[]).map(ba),ne=X.map(ba),J=$.reduce(lr,{}),Y=X.reduce(lr,{}),ce=te.slice(),le=Object.create(null);let de,xe,ye,Ce,Ae,Ne,Ve;for(de=0,xe=0;de<te.length;de++)ye=te[de],Y.hasOwnProperty(ye)?xe++:(ee.push({command:on.removeLayer,args:[ye]}),ce.splice(ce.indexOf(ye,xe),1));for(de=0,xe=0;de<ne.length;de++)ye=ne[ne.length-1-de],ce[ce.length-1-de]!==ye&&(J.hasOwnProperty(ye)?(ee.push({command:on.removeLayer,args:[ye]}),ce.splice(ce.lastIndexOf(ye,ce.length-xe),1)):xe++,Ne=ce[ce.length-de],ee.push({command:on.addLayer,args:[Y[ye],Ne]}),ce.splice(ce.length-de,0,ye),le[ye]=!0);for(de=0;de<ne.length;de++)if(ye=ne[de],Ce=J[ye],Ae=Y[ye],!le[ye]&&!ze(Ce,Ae))if(ze(Ce.source,Ae.source)&&ze(Ce["source-layer"],Ae["source-layer"])&&ze(Ce.type,Ae.type)){for(Ve in Ye(Ce.layout,Ae.layout,ee,ye,null,on.setLayoutProperty),Ye(Ce.paint,Ae.paint,ee,ye,null,on.setPaintProperty),ze(Ce.filter,Ae.filter)||ee.push({command:on.setFilter,args:[ye,Ae.filter]}),ze(Ce.minzoom,Ae.minzoom)&&ze(Ce.maxzoom,Ae.maxzoom)||ee.push({command:on.setLayerZoomRange,args:[ye,Ae.minzoom,Ae.maxzoom]}),Ce)Ce.hasOwnProperty(Ve)&&"layout"!==Ve&&"paint"!==Ve&&"filter"!==Ve&&"metadata"!==Ve&&"minzoom"!==Ve&&"maxzoom"!==Ve&&(0===Ve.indexOf("paint.")?Ye(Ce[Ve],Ae[Ve],ee,ye,Ve.slice(6),on.setPaintProperty):ze(Ce[Ve],Ae[Ve])||ee.push({command:on.setLayerProperty,args:[ye,Ve,Ae[Ve]]}));for(Ve in Ae)Ae.hasOwnProperty(Ve)&&!Ce.hasOwnProperty(Ve)&&"layout"!==Ve&&"paint"!==Ve&&"filter"!==Ve&&"metadata"!==Ve&&"minzoom"!==Ve&&"maxzoom"!==Ve&&(0===Ve.indexOf("paint.")?Ye(Ce[Ve],Ae[Ve],ee,ye,Ve.slice(6),on.setPaintProperty):ze(Ce[Ve],Ae[Ve])||ee.push({command:on.setLayerProperty,args:[ye,Ve,Ae[Ve]]}))}else ee.push({command:on.removeLayer,args:[ye]}),Ne=ce[ce.lastIndexOf(ye)+1],ee.push({command:on.addLayer,args:[Ae,Ne]})}(z,E.layers,D)}catch(M){console.warn("Unable to compute style diff:",M),D=[{command:on.setStyle,args:[E]}]}return D}(this.serialize(),c).filter(x=>!(x.command in Za));if(0===h.length)return!1;const y=h.filter(x=>!(x.command in qa));if(y.length>0)throw new Error(`Unimplemented: ${y.map(x=>x.command).join(", ")}.`);return h.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,h){return this.getImage(c)?this.fire(new f.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,h),this._afterImageUpdated(c),this)}updateImage(c,h){this.imageManager.updateImage(c,h)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new f.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,h,y={}){if(this._checkLoaded(),void 0!==this.getSource(c))throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(f.validateSource,`sources.${c}`,h,null,y))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=Me(c,h,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:x.serialize(),sourceId:c}));const E=D=>{const M=(D?"symbol:":"other:")+c,P=this._sourceCaches[M]=new f.SourceCache(M,x,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[c]=P,P.style=this,P.onAdd(this.map)};E(!1),"vector"!==h.type&&"geojson"!==h.type||E(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const h=this.getSource(c);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===c)return this.fire(new f.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new f.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(c);for(const x of y)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,h){this._checkLoaded(),this.getSource(c).setData(h),this._changed=!0}getSource(c){const h=this._getSourceCache(c);return h&&h.getSource()}_getSources(){const c=[];for(const h in this._otherSourceCaches){const y=this._getSourceCache(h);y&&c.push(y.getSource())}return c}addLayer(c,h,y={}){this._checkLoaded();const x=c.id;if(this.getLayer(x))return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let E;if("custom"===c.type){if(hc(this,f.validateCustomStyleLayer(c)))return;E=f.createStyleLayer(c)}else{if("object"==typeof c.source&&(this.addSource(x,c.source),c=f.clone$1(c),c=f.extend(c,{source:x})),this._validate(f.validateLayer,`layers.${x}`,c,{arrayIndex:-1},y))return;E=f.createStyleLayer(c),this._validateLayer(E),E.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0)}const D=h?this._order.indexOf(h):this._order.length;if(h&&-1===D)return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(D,0,x),this._layerOrderChanged=!0,this._layers[x]=E;const M=this._getLayerSourceCache(E);if(this._removedLayers[x]&&E.source&&M&&"custom"!==E.type){const P=this._removedLayers[x];delete this._removedLayers[x],P.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",M.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,h){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===h)return;const y=this._order.indexOf(c);this._order.splice(y,1);const x=h?this._order.indexOf(h):this._order.length;h&&-1===x?this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(x,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const h=this._layers[c];if(!h)return void this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const y=this._order.indexOf(c);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=h,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const h in this._layers)if(this._layers[h].type===c)return!0;return!1}setLayerZoomRange(c,h,y){this._checkLoaded();const x=this.getLayer(c);x?x.minzoom===h&&x.maxzoom===y||(null!=h&&(x.minzoom=h),null!=y&&(x.maxzoom=y),this._updateLayer(x)):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,h,y={}){this._checkLoaded();const x=this.getLayer(c);if(x){if(!ze(x.filter,h))return null==h?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(f.validateFilter,`layers.${x.id}.filter`,h,{layerType:x.type},y)||(x.filter=f.clone$1(h),this._updateLayer(x)))}else this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const h=this.getLayer(c);return h&&f.clone$1(h.filter)}setLayoutProperty(c,h,y,x={}){this._checkLoaded();const E=this.getLayer(c);E?ze(E.getLayoutProperty(h),y)||(E.setLayoutProperty(h,y,x),this._updateLayer(E)):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,h){const y=this.getLayer(c);if(y)return y.getLayoutProperty(h);this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,h,y,x={}){this._checkLoaded();const E=this.getLayer(c);E?ze(E.getPaintProperty(h),y)||(E.setPaintProperty(h,y,x)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new f.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,h){const y=this.getLayer(c);return y&&y.getPaintProperty(h)}setFeatureState(c,h){this._checkLoaded();const y=c.source,x=c.sourceLayer,E=this.getSource(y);if(!E)return void this.fire(new f.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const D=E.type;if("geojson"===D&&x)return void this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===D&&!x)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===c.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided.")));const M=this._getSourceCaches(y);for(const P of M)P.setFeatureState(x,c.id,h)}removeFeatureState(c,h){this._checkLoaded();const y=c.source,x=this.getSource(y);if(!x)return void this.fire(new f.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const E=x.type,D="vector"===E?c.sourceLayer:void 0;if("vector"===E&&!D)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&"string"!=typeof c.id&&"number"!=typeof c.id)return void this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const M=this._getSourceCaches(y);for(const P of M)P.removeFeatureState(D,c.id,h)}getFeatureState(c){this._checkLoaded();const h=c.source,y=c.sourceLayer,x=this.getSource(h);if(x){if("vector"!==x.type||y)return void 0===c.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(y,c.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const h in this._sourceCaches){const y=this._sourceCaches[h].getSource();c[y.id]||(c[y.id]=y.serialize())}return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},h=>void 0!==h)}_updateLayer(c){this._updatedLayers[c.id]=!0;const h=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&h&&"raster"!==h.getSource().type&&(this._updatedSources[c.source]="reload",h.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const h=D=>"fill-extrusion"===this._layers[D].type,y={},x=[];for(let D=this._order.length-1;D>=0;D--){const M=this._order[D];if(h(M)){y[M]=D;for(const P of c){const z=P[M];if(z)for(const B of z)x.push(B)}}}x.sort((D,M)=>M.intersectionZ-D.intersectionZ);const E=[];for(let D=this._order.length-1;D>=0;D--){const M=this._order[D];if(h(M))for(let P=x.length-1;P>=0;P--){const z=x[P].feature;if(y[z.layer.id]<D)break;E.push(z),x.pop()}else for(const P of c){const z=P[M];if(z)for(const B of z)E.push(B.feature)}}return E}queryRenderedFeatures(c,h,y){h&&h.filter&&this._validate(f.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const x={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const P of h.layers){const z=this._layers[P];if(!z)return this.fire(new f.ErrorEvent(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];x[z.source]=!0}}const E=[];h.availableImages=this._availableImages;const D=h&&h.layers?h.layers.some(P=>{const z=this.getLayer(P);return z&&z.is3D()}):this.has3DLayers(),M=si.createFromScreenPoints(c,y);for(const P in this._sourceCaches){const z=this._sourceCaches[P].getSource().id;h.layers&&!x[z]||E.push(Le(this._sourceCaches[P],this._layers,this._serializedLayers,M,h,y,D,!!this.map._showQueryGeometry))}return this.placement&&E.push(function(P,z,B,$,X,ee,te){const ne={},J=ee.queryRenderedSymbols($),Y=[];for(const ce of Object.keys(J).map(Number))Y.push(te[ce]);Y.sort(At);for(const ce of Y){const le=ce.featureIndex.lookupSymbolFeatures(J[ce.bucketInstanceId],z,ce.bucketIndex,ce.sourceLayerIndex,X.filter,X.layers,X.availableImages,P);for(const de in le){const xe=ne[de]=ne[de]||[],ye=le[de];ye.sort((Ce,Ae)=>{const Ne=ce.featureSortOrder;if(Ne){const Ve=Ne.indexOf(Ce.featureIndex);return Ne.indexOf(Ae.featureIndex)-Ve}return Ae.featureIndex-Ce.featureIndex});for(const Ce of ye)xe.push(Ce)}}for(const ce in ne)ne[ce].forEach(le=>{const de=le.feature,xe=B(P[ce]);if(!xe)return;const ye=xe.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=ye});return ne}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),M.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(c,h){h&&h.filter&&this._validate(f.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const y=this._getSourceCaches(c);let x=[];for(const E of y)x=x.concat(rt(E,h));return x}addSourceType(c,h,y){return ko.getSourceType(c)?y(new Error(`A source type called "${c}" already exists.`)):(ko.setSourceType(c,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:h.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(c,h={}){this._checkLoaded();const y=this.light.getLight();let x=!1;for(const D in c)if(!ze(c[D],y[D])){x=!0;break}if(!x)return;const E=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,h),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,h=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let y=c;if(1===h){if("object"==typeof y.source){const x="terrain-dem-src";this.addSource(x,y.source),y=f.clone$1(y),y=f.extend(y,{source:x})}if(this._validate(f.validateTerrain,"terrain",y))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,h)}else{const x=this.terrain,E=x.get();for(const D of Object.keys(f.spec.terrain))!y.hasOwnProperty(D)&&f.spec.terrain[D].default&&(y[D]=f.spec.terrain[D].default);for(const D in y)if(!ze(y[D],E[D])){x.set(y),this.stylesheet.terrain=y;const M=this._setTransitionParameters({duration:0});x.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const h=this.fog=new za(c,this.map.transform);this.stylesheet.fog=c;const y=this._setTransitionParameters({duration:0});h.updateTransitions(y)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,y=h.get();0===Object.keys(c).length&&h.set(c);for(const x in c)if(!ze(c[x],y[x])){h.set(c),this.stylesheet.fog=c;const E=this._setTransitionParameters({duration:0});h.updateTransitions(E);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:f.exported.now(),transition:f.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(y=>this.isLayerDraped(this._layers[y])),h=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...h)}_createTerrain(c,h){const y=this.terrain=new Lr(c,h);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});y.updateTransitions(x)}_force3DLayerUpdate(){for(const c in this._layers){const h=this._layers[c];"fill-extrusion"===h.type&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const h=this._layers[c];"symbol"===h.type&&this._updateLayer(h)}}_validate(c,h,y,x,E={}){return(!E||!1!==E.validate)&&hc(this,c.call(f.validateStyle,f.extend({key:h,style:this.serialize(),value:y,styleSpec:f.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const h=this._getSourceCaches(c);for(const y of h)y.clearTiles()}_reloadSource(c){const h=this._getSourceCaches(c);for(const y of h)y.resume(),y.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const h in this._sourceCaches)this._sourceCaches[h].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const h=this._sourceCaches[c];h.resume(),h.reload()}}_updatePlacement(c,h,y,x,E=!1){let D=!1,M=!1;const P={};for(const z of this._order){const B=this._layers[z];if("symbol"!==B.type)continue;if(!P[B.source]){const X=this._getLayerSourceCache(B);if(!X)continue;P[B.source]=X.getRenderableIds(!0).map(ee=>X.getTileByID(ee)).sort((ee,te)=>te.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(te.tileID)?-1:1))}const $=this.crossTileSymbolIndex.addLayer(B,P[B.source],c.center.lng,c.projection);D=D||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),E=E||this._layerOrderChanged||0===y,this._layerOrderChanged&&this.fire(new f.Event("neworder")),(E||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.exported.now(),c.zoom))&&(this.pauseablePlacement=new Ku(c,this._order,E,h,y,x,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.exported.now()),M=!0),D&&this.pauseablePlacement.placement.setStale()),M||D)for(const z of this._order){const B=this._layers[z];"symbol"===B.type&&this.placement.updateLayerOpacities(B,P[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,h,y){this.imageManager.getImages(h.icons,y),this._updateTilesForChangedImages();const x=E=>{E&&E.setDependencies(h.tileID.key,h.type,h.icons)};x(this._otherSourceCaches[h.source]),x(this._symbolSourceCaches[h.source])}getGlyphs(c,h,y){this.glyphManager.getGlyphs(h.stacks,y)}getResource(c,h,y){return f.makeRequest(h,y)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return"symbol"===c.type?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const h=[];return this._otherSourceCaches[c]&&h.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&h.push(this._symbolSourceCaches[c]),h}_isSourceCacheLoaded(c){const h=this._getSourceCaches(c);return 0===h.length?(this.fire(new f.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):h.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ko.getSourceType=function(g){return ke[g]},ko.setSourceType=function(g,c){ke[g]=c},ko.registerForPluginStateChange=f.registerForPluginStateChange;var fc="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",zh="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",hn="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",pc="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Vh="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ro={},tu={};const mc=[];js(fc,mc),js(hn,mc),js(pc,mc),js(Vh,mc),Ro=ri("",hn),tu=ri(Vh,pc);const zi=ri("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),zd=fc,Vd="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Uh={background:ri("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ri("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ri("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ri("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ri("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ri("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ri("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ri("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ri("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ri("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ri("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ri("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ri("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ri("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ri("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ri("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ri("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ri("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ri("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ri("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ri("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ri("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ri("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ri("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zh),skyboxGradient:ri("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zh),skyboxCapture:ri("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ri("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ri("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function js(g,c){const h=g.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let y of h)if(y=y.trim(),"#"===y[0]&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=y.split(" ");for(const E of x)c.includes(E)||c.push(E)}}function ri(g,c){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},E=[...mc];return js(g,E),js(c,E),{fragmentSource:g=g.replace(h,(D,M,P,z,B)=>(x[B]=!0,"define"===M?`\n#ifndef HAS_UNIFORM_u_${B}\nvarying ${P} ${z} ${B};\n#else\nuniform ${P} ${z} u_${B};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${B}\n    ${P} ${z} ${B} = u_${B};\n#endif\n`)),vertexSource:c=c.replace(h,(D,M,P,z,B)=>{const $="float"===z?"vec2":"vec4",X=B.match(/color/)?"color":$;return x[B]?"define"===M?`\n#ifndef HAS_UNIFORM_u_${B}\nuniform lowp float u_${B}_t;\nattribute ${P} ${$} a_${B};\nvarying ${P} ${z} ${B};\n#else\nuniform ${P} ${z} u_${B};\n#endif\n`:"vec4"===X?`\n#ifndef HAS_UNIFORM_u_${B}\n    ${B} = a_${B};\n#else\n    ${P} ${z} ${B} = u_${B};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${B}\n    ${B} = unpack_mix_${X}(a_${B}, u_${B}_t);\n#else\n    ${P} ${z} ${B} = u_${B};\n#endif\n`:"define"===M?`\n#ifndef HAS_UNIFORM_u_${B}\nuniform lowp float u_${B}_t;\nattribute ${P} ${$} a_${B};\n#else\nuniform ${P} ${z} u_${B};\n#endif\n`:"vec4"===X?`\n#ifndef HAS_UNIFORM_u_${B}\n    ${P} ${z} ${B} = a_${B};\n#else\n    ${P} ${z} ${B} = u_${B};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${B}\n    ${P} ${z} ${B} = unpack_mix_${X}(a_${B}, u_${B}_t);\n#else\n    ${P} ${z} ${B} = u_${B};\n#endif\n`}),staticAttributes:y,usedDefines:E}}class Ya{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,h,y,x,E,D,M){this.context=c;let P=this.boundPaintVertexBuffers.length!==x.length;for(let B=0;!P&&B<x.length;B++)this.boundPaintVertexBuffers[B]!==x[B]&&(P=!0);let z=this.boundDynamicVertexBuffers.length!==M.length;for(let B=0;!z&&B<M.length;B++)this.boundDynamicVertexBuffers[B]!==M[B]&&(z=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==y||P||z||this.boundIndexBuffer!==E||this.boundVertexOffset!==D)this.freshBind(h,y,x,E,D,M);else{c.bindVertexArrayOES.set(this.vao);for(const B of M)B&&B.bind();E&&E.dynamicDraw&&E.bind()}}freshBind(c,h,y,x,E,D){let M;const P=c.numAttributes,z=this.context,B=z.gl;if(z.extVertexArrayObject)this.vao&&this.destroy(),this.vao=z.extVertexArrayObject.createVertexArrayOES(),z.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=c,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=x,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=D;else{M=z.currentNumAttributes||0;for(let $=P;$<M;$++)B.disableVertexAttribArray($)}h.enableAttributes(B,c),h.bind(),h.setVertexAttribPointers(B,c,E);for(const $ of y)$.enableAttributes(B,c),$.bind(),$.setVertexAttribPointers(B,c,E);for(const $ of D)$&&($.enableAttributes(B,c),$.bind(),$.setVertexAttribPointers(B,c,E));x&&x.bind(),z.currentNumAttributes=P}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ud(g,c){const h=Math.pow(2,c.canonical.z),y=c.canonical.y;return[new f.MercatorCoordinate(0,y/h).toLngLat().lat,new f.MercatorCoordinate(0,(y+1)/h).toLngLat().lat]}function nu(g,c,h,y,x,E,D){const M=g.context,P=M.gl,z=h.fbo;if(!z)return;g.prepareDrawTile();const B=g.useProgram("hillshade");M.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,z.colorAttachment.get());const $=((ne,J,Y,ce)=>{const le=Y.paint.get("hillshade-shadow-color"),de=Y.paint.get("hillshade-highlight-color"),xe=Y.paint.get("hillshade-accent-color");let ye=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Y.paint.get("hillshade-illumination-anchor")&&(ye-=ne.transform.angle);const Ce=!ne.options.moving;return{u_matrix:ce||ne.transform.calculateProjMatrix(J.tileID.toUnwrapped(),Ce),u_image:0,u_latrange:Ud(0,J.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),ye],u_shadow:le,u_highlight:de,u_accent:xe}})(g,h,y,g.terrain?c.projMatrix:null);g.prepareDrawProgram(M,B,c.toUnwrapped());const{tileBoundsBuffer:X,tileBoundsIndexBuffer:ee,tileBoundsSegments:te}=g.getTileBoundsBuffers(h);B.draw(M,P.TRIANGLES,x,E,D,f.CullFaceMode.disabled,$,y.id,X,ee,te)}function gc(g,c,h){if(!c.needsDEMTextureUpload)return;const y=g.context,x=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||g.getTileTexture(h.stride);const E=h.getPixels();c.demTexture?c.demTexture.update(E,{premultiply:!1}):c.demTexture=new f.Texture(y,E,x.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Pl(g,c,h,y,x,E){const D=g.context,M=D.gl;if(!c.dem)return;const P=c.dem;if(D.activeTexture.set(M.TEXTURE1),gc(g,c,P),!c.demTexture)return;c.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);const z=P.dim;D.activeTexture.set(M.TEXTURE0);let B=c.fbo;if(!B){const te=new f.Texture(D,{width:z,height:z,data:null},M.RGBA);te.bind(M.LINEAR,M.CLAMP_TO_EDGE),B=c.fbo=D.createFramebuffer(z,z,!0),B.colorAttachment.set(te.texture)}D.bindFramebuffer.set(B.framebuffer),D.viewport.set([0,0,z,z]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:X,tileBoundsSegments:ee}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(D,M.TRIANGLES,y,x,E,f.CullFaceMode.disabled,((te,ne)=>{const J=ne.stride,Y=f.create();return f.ortho(Y,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate(Y,Y,[0,-f.EXTENT,0]),{u_matrix:Y,u_image:1,u_dimension:[J,J],u_zoom:te.overscaledZ,u_unpack:ne.unpackVector}})(c.tileID,P),h.id,$,X,ee),c.needsHillshadePrepare=!1}const wa=g=>({u_matrix:new f.UniformMatrix4f(g),u_image0:new f.Uniform1i(g),u_skirt_height:new f.Uniform1f(g)}),Ko=(g,c)=>({u_matrix:g,u_image0:0,u_skirt_height:c}),Xu=(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:E,u_image0:0,u_frustum_tl:D,u_frustum_tr:M,u_frustum_br:P,u_frustum_bl:z,u_globe_pos:B,u_globe_radius:$,u_viewport:X,u_grid_matrix:te?Float32Array.from(te):new Float32Array(9),u_skirt_height:ee});function lt(g,c){return null!=g&&null!=c&&!(!g.hasData()||!c.hasData())&&null!=g.demTexture&&null!=c.demTexture&&g.tileID.key!==c.tileID.key}const Ea=new class{constructor(){this.operations={}}newMorphing(g,c,h,y,x){if(g in this.operations){const E=this.operations[g];E.to.tileID.key!==h.tileID.key&&(E.queued=h)}else this.operations[g]={startTime:y,phase:0,duration:x,from:c,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const c=this.operations[g];return{from:c.from,to:c.to,phase:c.phase}}update(g){for(const c in this.operations){const h=this.operations[c];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[c];break}}}_nextOp(g,c){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=c,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},En={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ol(g){return 6*Math.pow(1.5,22-g)}function iu(g,c){const h=1<<g.z;return!c&&(0===g.x||g.x===h-1)||0===g.y||g.y===h-1}const Vn=g=>({u_matrix:g});function ru(g,c,h,y,x){if(x>0){const E=f.exported.now(),D=(E-g.timeAdded)/x,M=c?(E-c.timeAdded)/x:-1,P=h.getSource(),z=y.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),B=!c||Math.abs(c.tileID.overscaledZ-z)>Math.abs(g.tileID.overscaledZ-z),$=B&&g.refreshedUponExpiration?1:f.clamp(B?D:1-M,0,1);return g.refreshedUponExpiration&&D>=1&&(g.refreshedUponExpiration=!1),c?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}class jh extends f.SourceCache{constructor(c){const h={type:"raster-dem",maxzoom:c.transform.maxZoom},y=new ta(Gt(),null),x=Me("mock-dem",h,y,c.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,h){c.state="loaded",h(null)}}class Qu extends f.SourceCache{constructor(c){const h=Me("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new ta(Gt(),null),c.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,h,y){if(c.freezeTileCoverage)return;this.transform=c;const x=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,D)=>{if(E[D.key]="",!this._tiles[D.key]){const M=new f.Tile(D,this._source.tileSize*D.overscaleFactor(),c.tileZoom);M.state="loaded",this._tiles[D.key]=M}return E},{});for(const E in this._tiles)E in x||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(c){const h=this.proxyCachedFBO[c];if(void 0!==h){const y=Object.values(h);this.renderCachePool.push(...y),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class _s extends f.OverscaledTileID{constructor(c,h,y){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=h,this.projMatrix=y}}class ys extends f.Elevation{constructor(c,h){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,x,E]=function(P){const z=new f.StructArrayLayout2i4,B=new f.StructArrayLayout3ui6,$=131;z.reserve(17161),B.reserve(33800);const X=f.EXTENT/128,ee=f.EXTENT+X/2,te=ee+X;for(let J=-X;J<te;J+=X)for(let Y=-X;Y<te;Y+=X){const ce=Y<0||Y>ee||J<0||J>ee?24575:0,le=f.clamp(Math.round(Y),0,f.EXTENT),de=f.clamp(Math.round(J),0,f.EXTENT);z.emplaceBack(le+ce,de)}const ne=(J,Y)=>{const ce=Y*$+J;B.emplaceBack(ce+1,ce,ce+$),B.emplaceBack(ce+$,ce+$+1,ce+1)};for(let J=1;J<129;J++)for(let Y=1;Y<129;Y++)ne(Y,J);return[0,129].forEach(J=>{for(let Y=0;Y<130;Y++)ne(Y,J),ne(J,Y)}),[z,B,32768]}(),D=c.context;this.gridBuffer=D.createVertexBuffer(y,f.posAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(x),this.gridSegments=f.SegmentVector.simpleSegment(0,0,y.length,x.length),this.gridNoSkirtSegments=f.SegmentVector.simpleSegment(0,0,y.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Qu(h.map),this.orthoMatrix=f.create(),f.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,f.EXTENT,0,f.EXTENT,0,1);const M=D.gl;this._overlapStencilMode=new f.StencilMode({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new jh(h.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,h,y){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const x=c.terrain.properties;this.sourceCache=0===c.terrain.drapeRenderMode?this._mockSourceCache:c._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const E=()=>{this.sourceCache.used&&f.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(h,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,E(),this._initializing=!0),E(),h.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==c.efficiency&&f.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&"source"===c.dataType?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):"style"===c.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=0===y._centerAltitude&&-1===this.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(y.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(P=>{const z=h.getTileByID(P).tileID;return z.projMatrix=y.calculateProjMatrix(z.toUnwrapped()),z});(function(P,z){const B=z.transform.pointCoordinate(z.transform.getCameraPoint()),$=new f.pointGeometry(B.x,B.y);P.sort((X,ee)=>{if(ee.overscaledZ-X.overscaledZ)return ee.overscaledZ-X.overscaledZ;const te=new f.pointGeometry(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ne=new f.pointGeometry(ee.canonical.x+(1<<ee.canonical.z)*ee.wrap,ee.canonical.y),J=$.mult(1<<X.canonical.z);return J.x-=.5,J.y-=.5,J.distSqr(te)-J.distSqr(ne)})})(x,this.painter),this._previousZoom=y.zoom;const E=this.proxyToSource||{};this.proxyToSource={},x.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const P in D){const z=D[P];if(!z.used||(z!==this.sourceCache&&this.resetTileLookupCache(z.id),this._setupProxiedCoordsForOrtho(z,c[P],E),z.usedForTerrain))continue;const B=c[P];z.getSource().reparseOverscaled&&this._assignTerrainTiles(B)}this.proxiedCoords[h.id]=x.map(P=>new _s(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1,this._updateTimestamp=f.exported.now();const M={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const z=this.terrainTileForTile[P.key];if(!z)continue;const B=z.tileID.key;B in M||(this._visibleDemTiles.push(z),M[B]=B)}}_assignTerrainTiles(c){this._initializing||c.forEach(h=>{if(this.terrainTileForTile[h.key])return;const y=this._findTileCoveringTileID(h,this.sourceCache);y&&(this.terrainTileForTile[h.key]=y)})}_prepareDEMTextures(){const c=this.painter.context,h=c.gl;for(const y in this.terrainTileForTile){const x=this.terrainTileForTile[y],E=x.dem;!E||x.demTexture&&!x.needsDEMTextureUpload||(c.activeTexture.set(h.TEXTURE1),gc(this.painter,x,E))}}_prepareDemTileUniforms(c,h,y,x){if(!h||null==h.demTexture)return!1;const E=c.tileID.canonical,D=Math.pow(2,h.tileID.canonical.z-E.z),M=x||"";return y[`u_dem_tl${M}`]=[E.x*D%1,E.y*D%1],y[`u_dem_scale${M}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,h=c.gl;if(!this._emptyDepthBufferTexture){const y=new f.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new f.Texture(c,y,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const h=this._visibleDemTiles.reduce((y,x)=>{if(!x.dem)return y;const E=x.dem.tree.minimums[0];return E>0&&c++,y+E},0);return c?h/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,h=c.gl;c.activeTexture.set(h.TEXTURE2);const y=this._getLoadedAreaMinimum(),x=new f.RGBAImage({width:1,height:1},new Uint8Array(f.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(x,{premultiply:!1}):E=this._emptyDEMTexture=new f.Texture(c,x,h.RGBA,{premultiply:!1}),E}setupElevationDraw(c,h,y){const x=this.painter.context,E=x.gl,D=(M=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:f.DEMData.getUnpackVector(M),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var M;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let P=null,z=null,B=1;if(y&&y.morphing&&this._useVertexMorphing){const $=y.morphing.srcDemTile,X=y.morphing.dstDemTile;B=y.morphing.phase,$&&X&&(this._prepareDemTileUniforms(c,$,D,"_prev")&&(z=$),this._prepareDemTileUniforms(c,X,D)&&(P=X))}if(z&&P?(x.activeTexture.set(E.TEXTURE2),P.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),x.activeTexture.set(E.TEXTURE4),z.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE,E.NEAREST),D.u_dem_lerp=B):(P=this.terrainTileForTile[c.tileID.key],x.activeTexture.set(E.TEXTURE2),(this._prepareDemTileUniforms(c,P,D)?P.demTexture:this.emptyDEMTexture).bind(E.NEAREST,E.CLAMP_TO_EDGE)),x.activeTexture.set(E.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&P){const $=(1<<P.tileID.canonical.z)*f.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=$}if(y&&y.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),h.setTerrainUniformValues(x,D),"globe"===this.painter.transform.projection.name){const $=this.globeUniformValues(this.painter.transform,c.tileID.canonical,y&&y.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,$)}}globeUniformValues(c,h,y){const x=c.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,f.EXTENT,0),u_tile_br_up:x.upVector(h,f.EXTENT,f.EXTENT),u_tile_bl_up:x.upVector(h,0,f.EXTENT),u_tile_up_scale:y?f.globeMetersToEcef(1):x.upVectorScale(h,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const h=this.painter,y=this.painter.context;0!==c.length&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,E,D,M,P){if("globe"===x.transform.projection.name)!function(z,B,$,X,ee){const te=z.context,ne=te.gl;let J,Y;const ce=z.options.showTerrainWireframe?2:0,le=z.transform,de=f.globeUseCustomAntiAliasing(z,te,le),xe=(ht,Ue)=>{if(Y===ht)return;const Se=[En[ht],"PROJECTION_GLOBE_VIEW"];de&&Se.push("CUSTOM_ANTIALIASING"),Ue&&Se.push(En[ce]),J=z.useProgram("globeRaster",null,Se),Y=ht},ye=z.colorModeForRenderPass(),Ce=new f.DepthMode(ne.LEQUAL,f.DepthMode.ReadWrite,z.depthRangeFor3D);Ea.update(ee);const Ae=f.calculateGlobeMercatorMatrix(le),Ne=[f.mercatorXfromLng(le.center.lng),f.mercatorYfromLat(le.center.lat)],Ve=ce?[!1,!0]:[!1],yt=z.globeSharedBuffers,Pe=[le.width*f.exported.devicePixelRatio,le.height*f.exported.devicePixelRatio],et=Float32Array.from(le.globeMatrix),We={useDenormalizedUpVectorScale:!0};if(Ve.forEach(ht=>{const Ue=z.transform,Se=Ol(Ue.zoom)*B.exaggeration();Y=-1;const He=ht?ne.LINES:ne.TRIANGLES;for(const ct of X){const ft=$.getTile(ct),Yt=f.StencilMode.disabled,On=B.prevTerrainTileForTile[ct.key],Ft=B.terrainTileForTile[ct.key];lt(On,Ft)&&Ea.newMorphing(ct.key,On,Ft,ee,250),te.activeTexture.set(ne.TEXTURE0),ft.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);const kt=Ea.getMorphValuesForProxy(ct.key),Kt=kt?1:0;kt&&f.extend$1(We,{morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:f.easeCubicInOut(kt.phase)}});const Rn=f.tileCornersToBounds(ct.canonical),Jt=f.getLatitudinalLod(Rn.getCenter().lat),_i=f.getGridMatrix(ct.canonical,Rn,Jt,Ue.worldSize/Ue._pixelsPerMercatorPixel),hi=f.globeNormalizeECEF(f.globeTileBounds(ct.canonical)),qi=Xu(Ue.projMatrix,et,Ae,hi,f.globeToMercatorTransition(Ue.zoom),Ne,Ue.frustumCorners.TL,Ue.frustumCorners.TR,Ue.frustumCorners.BR,Ue.frustumCorners.BL,Ue.globeCenterInViewSpace,Ue.globeRadius,Pe,Se,_i);if(xe(Kt,ht),B.setupElevationDraw(ft,J,We),z.prepareDrawProgram(te,J,ct.toUnwrapped()),yt){const[Si,gr,xo]=ht?yt.getWirefameBuffers(z.context,Jt):yt.getGridBuffers(Jt,0!==Se);J.draw(te,He,Ce,Yt,ye,f.CullFaceMode.backCCW,qi,"globe_raster",Si,gr,xo)}}}),yt){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];de&&ht.push("CUSTOM_ANTIALIASING"),J=z.useProgram("globeRaster",null,ht);for(const Ue of X){const{x:Se,y:He,z:ct}=Ue.canonical,ft=0===He,Yt=He===(1<<ct)-1,[On,Ft,kt,Kt]=yt.getPoleBuffers(ct);if(Kt&&(ft||Yt)){const Rn=$.getTile(Ue);te.activeTexture.set(ne.TEXTURE0),Rn.texture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE);let Jt=f.globePoleMatrixForTile(ct,Se,le);const _i=f.globeNormalizeECEF(f.globeTileBounds(Ue.canonical)),hi=(qi,Si)=>qi.draw(te,ne.TRIANGLES,Ce,f.StencilMode.disabled,ye,f.CullFaceMode.disabled,Xu(le.projMatrix,Jt,Jt,_i,0,Ne,le.frustumCorners.TL,le.frustumCorners.TR,le.frustumCorners.BR,le.frustumCorners.BL,le.globeCenterInViewSpace,le.globeRadius,Pe,0),"globe_pole_raster",Si,kt,Kt);B.setupElevationDraw(Rn,J,We),z.prepareDrawProgram(te,J,Ue.toUnwrapped()),ft&&hi(J,On),Yt&&(Jt=f.scale(f.create(),Jt,[1,-1,1]),hi(J,Ft))}}}}(x,E,D,M,P);else{const z=x.context,B=z.gl;let $,X;const ee=x.options.showTerrainWireframe?2:0,te=(le,de)=>{if(X===le)return;const xe=[En[le]];de&&xe.push(En[ee]),$=x.useProgram("terrainRaster",null,xe),X=le},ne=x.colorModeForRenderPass(),J=new f.DepthMode(B.LEQUAL,f.DepthMode.ReadWrite,x.depthRangeFor3D);Ea.update(P);const Y=x.transform,ce=Ol(Y.zoom)*E.exaggeration();(ee?[!1,!0]:[!1]).forEach(le=>{X=-1;const de=le?B.LINES:B.TRIANGLES,[xe,ye]=le?E.getWirefameBuffer():[E.gridIndexBuffer,E.gridSegments];for(const Ce of M){const Ae=D.getTile(Ce),Ne=f.StencilMode.disabled,Ve=E.prevTerrainTileForTile[Ce.key],yt=E.terrainTileForTile[Ce.key];lt(Ve,yt)&&Ea.newMorphing(Ce.key,Ve,yt,P,250),z.activeTexture.set(B.TEXTURE0),Ae.texture.bind(B.LINEAR,B.CLAMP_TO_EDGE,B.LINEAR_MIPMAP_NEAREST);const Pe=Ea.getMorphValuesForProxy(Ce.key),et=Pe?1:0;let We;Pe&&(We={morphing:{srcDemTile:Pe.from,dstDemTile:Pe.to,phase:f.easeCubicInOut(Pe.phase)}});const ht=Ko(Ce.projMatrix,iu(Ce.canonical,Y.renderWorldCopies)?ce/10:ce);te(et,le),E.setupElevationDraw(Ae,$,We),x.prepareDrawProgram(z,$,Ce.toUnwrapped()),$.draw(z,de,J,Ne,ne,f.CullFaceMode.backCCW,ht,"terrain_raster",E.gridBuffer,xe,ye)}})}}(h,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(0===this._drapedRenderBatches.length)return c+1;this.renderingToTexture=!0;const h=this.painter,y=this.painter.context,x=this.proxySourceCache,E=this.proxiedCoords[x.id],D=this._drapedRenderBatches.shift(),M=[],P=h.style.order;let z=0;for(const B of E){const $=x.getTileByID(B.proxyTileKey),X=x.proxyCachedFBO[B.key]?x.proxyCachedFBO[B.key][c]:void 0,ee=void 0!==X?x.renderCache[X]:this.pool[z++],te=void 0!==X;if($.texture=ee.tex,te&&!ee.dirty){M.push($.tileID);continue}let ne;y.bindFramebuffer.set(ee.fb.framebuffer),this.renderedToTile=!1,ee.dirty&&(y.clear({color:f.Color.transparent,stencil:0}),ee.dirty=!1);for(let J=D.start;J<=D.end;++J){const Y=h.style._layers[P[J]];if(Y.isHidden(h.transform.zoom))continue;const ce=h.style._getLayerSourceCache(Y),le=ce?this.proxyToSource[B.key][ce.id]:[B];if(!le)continue;const de=le;y.viewport.set([0,0,ee.fb.width,ee.fb.height]),ne!==(ce?ce.id:null)&&(this._setupStencil(ee,le,Y,ce),ne=ce?ce.id:null),h.renderLayer(h,ce,Y,de)}this.renderedToTile?(ee.dirty=!0,M.push($.tileID)):te||--z,5===z&&(z=0,this.renderToBackBuffer(M))}return this.renderToBackBuffer(M),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,h.width,h.height]),D.end+1}postRender(){}renderCacheEfficiency(c){const h=c.order.length;if(0===h)return{efficiency:100};let y,x=0,E=0,D=!1;for(let M=0;M<h;++M){const P=c._layers[c.order[M]];this._style.isLayerDraped(P)?(D&&++x,++E):D||(D=!0,y=P.id)}return 0===E?{efficiency:100}:{efficiency:100*(1-x/E),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{c=Math.min(c,h.dem.tree.minimums[0])}),0===c?c:(c-30)*this._exaggeration}raycast(c,h,y){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const D=E.tileID,M=1<<D.overscaledZ,{x:P,y:z}=D.canonical,B=P/M,$=(P+1)/M,X=z/M,ee=(z+1)/M;return{minx:B,miny:X,maxx:$,maxy:ee,t:E.dem.tree.raycastRoot(B,X,$,ee,c,h,y),tile:E}});x.sort((E,D)=>(null!==E.t?E.t:Number.MAX_VALUE)-(null!==D.t?D.t:Number.MAX_VALUE));for(const E of x){if(null==E.t)return null;const D=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,c,h,y);if(null!=D)return D}return null}_createFBO(){const c=this.painter.context,h=c.gl,y=this.drapeBufferSize;c.activeTexture.set(h.TEXTURE0);const x=new f.Texture(c,{width:y[0],height:y[1],data:null},h.RGBA);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const E=c.createFramebuffer(y[0],y[1],!1);return E.colorAttachment.set(x.texture),E.depthAttachment=new Xc(c,E.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:E,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const h=this._style._layers[c],y=h.isHidden(this.painter.transform.zoom);return"custom"===h.type?!y&&h.shouldRedrape():!y&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const y of this._style._getSources())if(y instanceof H){c=!0;break}if(!c)return;const h={};for(let y=0;y<this._style.order.length;++y){const x=this._style._layers[this._style.order[y]],E=this._style._getLayerSourceCache(x);if(E&&!h[E.id]&&!x.isHidden(this.painter.transform.zoom)&&"line"===x.type&&x.widthExpression()instanceof f.ZoomDependentExpression){h[E.id]=!0;for(const D of this.proxyCoords){const M=this.proxyToSource[D.key][E.id];if(M)for(const P of M)this._clearRenderCacheForTile(E.id,P)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof W){c=!0;break}if(!c)return;const h={};for(let y=0;y<this._style.order.length;++y){const x=this._style._layers[this._style.order[y]],E=this._style._getLayerSourceCache(x);if(!E||h[E.id]||x.isHidden(this.painter.transform.zoom)||"raster"!==x.type)continue;const D=x.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const P=this.proxyToSource[M.key][E.id];if(P)for(const z of P){const B=ru(E.getTile(z),E.findLoadedParent(z,0),E,this.painter.transform,D);(1!==B.opacity||0!==B.mix)&&this._clearRenderCacheForTile(E.id,z)}}}}_setupDrapedRenderBatches(){const c=this._style.order,h=c.length;if(0===h)return;const y=[];let x,E=0,D=this._style._layers[c[E]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++E<h;)D=this._style._layers[c[E]];for(;E<h;++E){const M=this._style._layers[c[E]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?void 0===x&&(x=E):void 0!==x&&(y.push({start:x,end:E-1}),x=void 0))}void 0!==x&&y.push({start:x,end:E-1}),this._drapedRenderBatches=y}_setupRenderCache(c){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const D=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let M=0;M<D.length;++M){const P=Object.values(D[M]);h.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,x=this._tilesDirty;for(let D=y.length-1;D>=0;D--){const M=y[D];if(h.getTileByID(M.key),void 0!==h.proxyCachedFBO[M.key]){const P=c[M.key],z=this.proxyToSource[M.key];let B=0;for(const $ in z){const X=z[$],ee=P[$];if(!ee||ee.length!==X.length||X.some((te,ne)=>te!==ee[ne]||x[$]&&x[$].hasOwnProperty(te.key))){B=-1;break}++B}for(const $ in h.proxyCachedFBO[M.key])h.renderCache[h.proxyCachedFBO[M.key][$]].dirty=B<0||B!==Object.values(P).length}}const E=[...this._drapedRenderBatches];E.sort((D,M)=>M.end-M.start-(D.end-D.start));for(const D of E)for(const M of y){if(h.proxyCachedFBO[M.key])continue;let P=h.renderCachePool.pop();void 0===P&&h.renderCache.length<50&&(P=h.renderCache.length,h.renderCache.push(this._createFBO())),void 0!==P&&(h.proxyCachedFBO[M.key]={},h.proxyCachedFBO[M.key][D.start]=P,h.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(c,h,y,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,D=E.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let M;if(y.isTileClipped())M=h.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):f.StencilMode.disabled}_renderTileClippingMasks(c,h){const y=this.painter,x=this.painter.context,E=x.gl;y._tileClippingMaskIDs={},x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const D=y.useProgram("clippingMask");for(const M of c){const P=y._tileClippingMaskIDs[M.key]=--h;D.draw(x,E.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:E.ALWAYS,mask:0},P,255,E.KEEP,E.KEEP,E.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Vn(M.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(c){const h=this.painter.transform;if(c.x<0||c.x>h.width||c.y<0||c.y>h.height)return null;const y=[c.x,c.y,1,1];f.transformMat4$1(y,y,h.pixelMatrixInverse),f.scale$1(y,y,1/y[3]),y[0]/=h.worldSize,y[1]/=h.worldSize;const x=h._camera.position,E=f.mercatorZfromAltitude(1,h.center.lat),D=[x[0],x[1],x[2]/E,0],M=f.subtract([],y.slice(0,3),D);f.normalize(M,M);const P=this.raycast(D,M,this._exaggeration);return null!==P&&P?(f.scaleAndAdd(D,D,M,P),D[3]=D[2],D[2]*=E,D):null}drawDepth(){const c=this.painter,h=c.context,y=this.proxySourceCache,x=Math.ceil(c.width),E=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===E||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=h.gl,M=h.createFramebuffer(x,E,!0);h.activeTexture.set(D.TEXTURE0);const P=new f.Texture(h,{width:x,height:E,data:null},D.RGBA);P.bind(D.NEAREST,D.CLAMP_TO_EDGE),M.colorAttachment.set(P.texture);const z=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,x,E);M.depthAttachment.set(z),this._depthFBO=M,this._depthTexture=P}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,x,E]),function(D,M,P,z){if("globe"===D.transform.projection.name)return;const B=D.context,$=B.gl;B.clear({depth:1});const X=D.useProgram("terrainDepth"),ee=new f.DepthMode($.LESS,f.DepthMode.ReadWrite,D.depthRangeFor3D);for(const te of z){const ne=P.getTile(te),J=Ko(te.projMatrix,0);M.setupElevationDraw(ne,X),X.draw(B,$.TRIANGLES,ee,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.backCCW,J,"terrain_depth",M.gridBuffer,M.gridIndexBuffer,M.gridNoSkirtSegments)}}(c,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,h,y){if(c.getSource()instanceof Ee)return this._setupProxiedCoordsForImageSource(c,h,y);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const x=this.proxiedCoords[c.id]=[],E=this.proxyCoords;for(let M=0;M<E.length;M++){const P=E[M],z=this._findTileCoveringTileID(P,c);if(z){const B=this._createProxiedId(P,z,y[P.key]&&y[P.key][c.id]);x.push(B),this.proxyToSource[P.key][c.id]=[B]}}let D=!1;for(let M=0;M<h.length;M++){const P=c.getTile(h[M]);if(!P||!P.hasData())continue;const z=this._findTileCoveringTileID(P.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==P.tileID.canonical.z){const B=this.proxyToSource[z.tileID.key][c.id],$=this._createProxiedId(z.tileID,P,y[z.tileID.key]&&y[z.tileID.key][c.id]);B?B.splice(B.length-1,0,$):this.proxyToSource[z.tileID.key][c.id]=[$],x.push($),D=!0}}this._sourceTilesOverlap[c.id]=D}_setupProxiedCoordsForImageSource(c,h,y){if(!c.getSource().loaded())return;const x=this.proxiedCoords[c.id]=[],E=this.proxyCoords,D=c.getSource(),M=new f.pointGeometry(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),P=D.coordinates.map(f.MercatorCoordinate.fromLngLat).reduce((B,$)=>(B.min.x=Math.min(B.min.x,$.x-M.x),B.min.y=Math.min(B.min.y,$.y-M.y),B.max.x=Math.max(B.max.x,$.x-M.x),B.max.y=Math.max(B.max.y,$.y-M.y),B),{min:new f.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new f.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(B,$)=>{const X=B.wrap+B.canonical.x/(1<<B.canonical.z),ee=B.canonical.y/(1<<B.canonical.z),te=f.EXTENT/(1<<B.canonical.z),ne=$.wrap+$.canonical.x/(1<<$.canonical.z),J=$.canonical.y/(1<<$.canonical.z);return X+te<ne+P.min.x||X>ne+P.max.x||ee+te<J+P.min.y||ee>J+P.max.y};for(let B=0;B<E.length;B++){const $=E[B];for(let X=0;X<h.length;X++){const ee=c.getTile(h[X]);if(!ee||!ee.hasData()||z($,ee.tileID))continue;const te=this._createProxiedId($,ee,y[$.key]&&y[$.key][c.id]),ne=this.proxyToSource[$.key][c.id];ne?ne.push(te):this.proxyToSource[$.key][c.id]=[te],x.push(te)}}}_createProxiedId(c,h,y){let x=this.orthoMatrix;if(y){const E=y.find(D=>D.key===h.tileID.key);if(E)return E}if(h.tileID.key!==c.key){const E=c.canonical.z-h.tileID.canonical.z;let D,M,P;x=f.create();const z=h.tileID.wrap-c.wrap<<c.overscaledZ;E>0?(D=f.EXTENT>>E,M=D*((h.tileID.canonical.x<<E)-c.canonical.x+z),P=D*((h.tileID.canonical.y<<E)-c.canonical.y)):(D=f.EXTENT<<-E,M=f.EXTENT*(h.tileID.canonical.x-(c.canonical.x+z<<-E)),P=f.EXTENT*(h.tileID.canonical.y-(c.canonical.y<<-E))),f.ortho(x,0,D,0,D,0,1),f.translate(x,x,[M,P,0])}return new _s(h.tileID,c.key,x)}_findTileCoveringTileID(c,h){let y=h.getTile(c);if(y&&y.hasData())return y;const x=this._findCoveringTileCache[h.id],E=x[c.key];if(y=E?h.getTileByID(E):null,y&&y.hasData()||null===E)return y;let D=y?y.tileID:c,M=D.overscaledZ;const P=h.getSource().minzoom,z=[];if(!E){const $=h.getSource().maxzoom;if(c.canonical.z>=$){const X=c.canonical.z-$;h.getSource().reparseOverscaled?(M=Math.max(c.canonical.z+2,h.transform.tileZoom),D=new f.OverscaledTileID(M,c.wrap,$,c.canonical.x>>X,c.canonical.y>>X)):0!==X&&(M=$,D=new f.OverscaledTileID(M,c.wrap,$,c.canonical.x>>X,c.canonical.y>>X))}D.key!==c.key&&(z.push(D.key),y=h.getTile(D))}const B=$=>{z.forEach(X=>{x[X]=$}),z.length=0};for(M-=1;M>=P&&(!y||!y.hasData());M--){y&&B(y.tileID.key);const $=D.calculateScaledKey(M);if(y=h.getTileByID($),y&&y.hasData())break;const X=x[$];if(null===X)break;void 0===X?z.push($):y=h.getTileByID(X)}return B(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,h){let y=this._tilesDirty[c];y||(y=this._tilesDirty[c]={}),y[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(h){let y=0;const x=new f.StructArrayLayout2ui4,E=131;for(let D=1;D<129;D++){for(let M=1;M<129;M++)y=D*E+M,x.emplaceBack(y,y+1),x.emplaceBack(y,y+E),x.emplaceBack(y+1,y+E),128===D&&x.emplaceBack(y+E,y+E+1);x.emplaceBack(y+1,y+1+E)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=f.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Xo{static cacheKey(c,h,y,x){let E=`${h}${x?x.cacheKey:""}`;for(const D of y)c.usedDefines.includes(D)&&(E+=`/${D}`);return E}constructor(c,h,y,x,E,D){const M=c.gl;this.program=M.createProgram();const P=function(Y){const ce=[];for(let le=0;le<Y.length;le++){if(null===Y[le])continue;const de=Y[le].split(" ");ce.push(de.pop())}return ce}(y.staticAttributes),z=x?x.getBinderAttributes():[],B=P.concat(z);let $=x?x.defines():[];$=$.concat(D.map(Y=>`#define ${Y}`));const X=c.isWebGL2?"#version 300 es\n":"",ee=X+$.concat(c.extStandardDerivatives&&0===X.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Vd):Vd,Vd,zd,zi.fragmentSource,tu.fragmentSource,y.fragmentSource).join("\n"),te=X+$.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",zd,zi.vertexSource,tu.vertexSource,Ro.vertexSource,y.vertexSource).join("\n"),ne=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(ne,ee),M.compileShader(ne),M.attachShader(this.program,ne);const J=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(J,te),M.compileShader(J),M.attachShader(this.program,J),this.attributes={},this.numAttributes=B.length;for(let Y=0;Y<this.numAttributes;Y++)B[Y]&&(M.bindAttribLocation(this.program,Y,B[Y]),this.attributes[B[Y]]=Y);M.linkProgram(this.program),M.deleteShader(J),M.deleteShader(ne),this.fixedUniforms=E(c),this.binderUniforms=x?x.getUniforms(c):[],D.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new f.Uniform1i(Y=c),u_dem_prev:new f.Uniform1i(Y),u_dem_unpack:new f.Uniform4f(Y),u_dem_tl:new f.Uniform2f(Y),u_dem_scale:new f.Uniform1f(Y),u_dem_tl_prev:new f.Uniform2f(Y),u_dem_scale_prev:new f.Uniform1f(Y),u_dem_size:new f.Uniform1f(Y),u_dem_lerp:new f.Uniform1f(Y),u_exaggeration:new f.Uniform1f(Y),u_depth:new f.Uniform1i(Y),u_depth_size_inv:new f.Uniform2f(Y),u_meter_to_dem:new f.Uniform1f(Y),u_label_plane_matrix_inv:new f.UniformMatrix4f(Y)}),D.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new f.Uniform3f(Y),u_tile_tr_up:new f.Uniform3f(Y),u_tile_br_up:new f.Uniform3f(Y),u_tile_bl_up:new f.Uniform3f(Y),u_tile_up_scale:new f.Uniform1f(Y)}))(c)),D.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new f.UniformMatrix4f(Y),u_fog_range:new f.Uniform2f(Y),u_fog_color:new f.Uniform4f(Y),u_fog_horizon_blend:new f.Uniform1f(Y),u_fog_temporal_offset:new f.Uniform1f(Y),u_frustum_tl:new f.Uniform3f(Y),u_frustum_tr:new f.Uniform3f(Y),u_frustum_br:new f.Uniform3f(Y),u_frustum_bl:new f.Uniform3f(Y),u_globe_pos:new f.Uniform3f(Y),u_globe_radius:new f.Uniform1f(Y),u_globe_transition:new f.Uniform1f(Y),u_is_globe:new f.Uniform1i(Y),u_viewport:new f.Uniform2f(Y)}))(c))}var Y}setTerrainUniformValues(c,h){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x]&&y[x].set(this.program,x,h[x])}}setGlobeUniformValues(c,h){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x]&&y[x].set(this.program,x,h[x])}}setFogUniformValues(c,h){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const x in h)y[x].set(this.program,x,h[x])}}draw(c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne){const J=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(y),c.setStencilMode(x),c.setColorMode(E),c.setCullFace(D);for(const ce of Object.keys(this.fixedUniforms))this.fixedUniforms[ce].set(this.program,ce,M[ce]);te&&te.setUniforms(this.program,c,this.binderUniforms,X,{zoom:ee});const Y={[J.LINES]:2,[J.TRIANGLES]:3,[J.LINE_STRIP]:1}[h];for(const ce of $.get()){const le=ce.vaos||(ce.vaos={});(le[P]||(le[P]=new Ya)).bind(c,this,z,te?te.getPaintVertexBuffers():[],B,ce.vertexOffset,ne||[]),J.drawElements(h,ce.primitiveLength*Y,J.UNSIGNED_SHORT,ce.primitiveOffset*Y*2)}}}function aa(g,c){const h=Math.pow(2,c.tileID.overscaledZ),y=c.tileSize*Math.pow(2,g.transform.tileZoom)/h,x=y*(c.tileID.canonical.x+c.tileID.wrap*h),E=y*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/us(c,1,g.transform.tileZoom),u_pixel_coord_upper:[x>>16,E>>16],u_pixel_coord_lower:[65535&x,65535&E]}}const Ei=f.create(),Fl=(g,c,h,y,x,E,D,M,P,z,B)=>{const $=c.style.light,X=$.properties.get("position"),ee=[X.x,X.y,X.z],te=f.create$1();"viewport"===$.properties.get("anchor")&&(f.fromRotation(te,-c.transform.angle),f.transformMat3(ee,ee,te));const ne=$.properties.get("color"),J=c.transform,Y={u_matrix:g,u_lightpos:ee,u_lightintensity:$.properties.get("intensity"),u_lightcolor:[ne.r,ne.g,ne.b],u_vertical_gradient:+h,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ei,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:E};return"globe"===J.projection.name&&(Y.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Y.u_zoom_transition=P,Y.u_inv_rot_matrix=B,Y.u_merc_center=z,Y.u_up_dir=J.projection.upVector(new f.CanonicalTileID(0,0,0),z[0]*f.EXTENT,z[1]*f.EXTENT),Y.u_height_lift=M),Y},Ll=(g,c,h,y,x,E,D,M,P,z,B,$)=>{const X=Fl(g,c,h,y,x,E,D,P,z,B,$),ee={u_height_factor:-Math.pow(2,D.overscaledZ)/M.tileSize/8};return f.extend(X,aa(c,M),ee)},Nl=g=>({u_matrix:g}),_c=(g,c,h)=>f.extend(Nl(g),aa(c,h)),vs=(g,c)=>({u_matrix:g,u_world:c}),yc=(g,c,h,y)=>f.extend(_c(g,c,h),{u_world:y}),gp=f.create(),pr=(g,c,h,y,x,E)=>{const D=g.transform,M="globe"===D.projection.name;let P;if("map"===E.paint.get("circle-pitch-alignment"))if(M){const B=f.globePixelsToTileUnits(D.zoom,c.canonical)*D._pixelsPerMercatorPixel;P=Float32Array.from([B,0,0,B])}else P=D.calculatePixelsToTileUnitsMatrix(h);else P=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const z={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:g.translatePosMatrix(c.projMatrix,h,E.paint.get("circle-translate"),E.paint.get("circle-translate-anchor")),u_device_pixel_ratio:f.exported.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:gp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){z.u_inv_rot_matrix=y,z.u_merc_center=x,z.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],z.u_zoom_transition=f.globeToMercatorTransition(D.zoom);const B=x[0]*f.EXTENT,$=x[1]*f.EXTENT;z.u_up_dir=D.projection.upVector(new f.CanonicalTileID(0,0,0),B,$)}return z},Ka=g=>{const c=[];return"map"===g.paint.get("circle-pitch-alignment")&&c.push("PITCH_WITH_MAP"),"map"===g.paint.get("circle-pitch-scale")&&c.push("SCALE_WITH_MAP"),c},$h=(g,c,h,y)=>{const x=f.EXTENT/h.tileSize;return{u_matrix:g,u_camera_to_center_distance:c.getCameraToCenterDistance(y),u_extrude_scale:[c.pixelsToGLUnits[0]/x,c.pixelsToGLUnits[1]/x]}},ou=(g,c,h=1)=>({u_matrix:g,u_color:c,u_overlay:0,u_overlay_scale:h}),Yn=f.create(),la=(g,c,h,y,x,E,D)=>{const M=g.transform,P="globe"===M.projection.name,z=P?f.globePixelsToTileUnits(M.zoom,c.canonical)*M._pixelsPerMercatorPixel:us(h,1,E),B={u_matrix:c.projMatrix,u_extrude_scale:z,u_intensity:D,u_inv_rot_matrix:Yn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){B.u_inv_rot_matrix=y,B.u_merc_center=x,B.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],B.u_zoom_transition=f.globeToMercatorTransition(M.zoom);const $=x[0]*f.EXTENT,X=x[1]*f.EXTENT;B.u_up_dir=M.projection.upVector(new f.CanonicalTileID(0,0,0),$,X)}return B},su=(g,c,h,y,x,E,D)=>{const M=g.transform,P=M.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:Ci(g,c,h,y),u_pixels_to_tile_units:P,u_device_pixel_ratio:E,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:Rr(h)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Br(c,g.transform),u_alpha_discard_threshold:0,u_trim_offset:D}},vn=(g,c,h,y,x)=>{const E=g.transform;return{u_matrix:Ci(g,c,h,y),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:Br(c,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Br(g,c){return 1/us(g,1,c.tileZoom)}function Ci(g,c,h,y){return g.translatePosMatrix(y||c.tileID.projMatrix,c,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Rr(g){const c=g.paint.get("line-dasharray").value;return c.value||"constant"!==c.kind}const yo=(g,c,h,y,x,E)=>{return{u_matrix:g,u_tl_parent:c,u_scale_parent:h,u_fade_t:y.mix,u_opacity:y.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(M=x.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(D=x.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Ca(x.paint.get("raster-hue-rotate")),u_perspective_transform:E};var D,M};function Ca(g){g*=Math.PI/180;const c=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*c-h+1)/3,(Math.sqrt(3)*c-h+1)/3]}const Po=f.create(),vc=(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne)=>{const J=x.transform,Y={u_is_size_zoom_constant:+("constant"===g||"source"===g),u_is_size_feature_constant:+("constant"===g||"camera"===g),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:J.width/J.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:D,u_coord_matrix:M,u_is_text:+P,u_pitch_with_map:+y,u_texsize:z,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Po,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Po,u_up_vector:[0,-1,0]};return"globe"===ne.name&&(Y.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],Y.u_zoom_transition=$,Y.u_inv_rot_matrix=ee,Y.u_merc_center=X,Y.u_camera_forward=J._camera.forward(),Y.u_ecef_origin=f.globeECEFOrigin(J.globeMatrix,B.toUnwrapped()),Y.u_tile_matrix=Float32Array.from(J.globeMatrix),Y.u_up_vector=te),Y},jd=(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne,J)=>f.extend(vc(g,c,h,y,x,E,D,M,P,z,$,X,ee,te,ne,J),{u_gamma_scale:y?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:f.exported.devicePixelRatio,u_is_halo:+B}),Bl=(g,c,h,y,x,E,D,M,P,z,B,$,X,ee,te,ne)=>f.extend(jd(g,c,h,y,x,E,D,M,!0,P,!0,B,$,X,ee,te,ne),{u_texsize_icon:z,u_texture_icon:1}),$s=(g,c,h)=>({u_matrix:g,u_opacity:c,u_color:h}),Wt=(g,c,h,y,x)=>f.extend(function(E,D,M){const P=D.imageManager.getPattern(E.toString()),{width:z,height:B}=D.imageManager.getPixelSize(),$=Math.pow(2,M.tileID.overscaledZ),X=M.tileSize*Math.pow(2,D.transform.tileZoom)/$,ee=X*(M.tileID.canonical.x+M.tileID.wrap*$),te=X*M.tileID.canonical.y;return{u_image:0,u_pattern_tl:P.tl,u_pattern_br:P.br,u_texsize:[z,B],u_pattern_size:P.displaySize,u_tile_units_to_pixels:1/us(M,1,D.transform.tileZoom),u_pixel_coord_upper:[ee>>16,te>>16],u_pixel_coord_lower:[65535&ee,65535&te]}}(y,h,x),{u_matrix:g,u_opacity:c}),jn={fillExtrusion:g=>({u_matrix:new f.UniformMatrix4f(g),u_lightpos:new f.Uniform3f(g),u_lightintensity:new f.Uniform1f(g),u_lightcolor:new f.Uniform3f(g),u_vertical_gradient:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_edge_radius:new f.Uniform1f(g),u_ao:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_up_dir:new f.Uniform3f(g),u_height_lift:new f.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_lightpos:new f.Uniform3f(g),u_lightintensity:new f.Uniform1f(g),u_lightcolor:new f.Uniform3f(g),u_vertical_gradient:new f.Uniform1f(g),u_height_factor:new f.Uniform1f(g),u_edge_radius:new f.Uniform1f(g),u_ao:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_up_dir:new f.Uniform3f(g),u_height_lift:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g)}),fill:g=>({u_matrix:new f.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),fillOutline:g=>({u_matrix:new f.UniformMatrix4f(g),u_world:new f.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_world:new f.Uniform2f(g),u_image:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new f.Uniform1f(g),u_extrude_scale:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_up_dir:new f.Uniform3f(g)}),collisionBox:g=>({u_matrix:new f.UniformMatrix4f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_extrude_scale:new f.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new f.UniformMatrix4f(g),u_inv_matrix:new f.UniformMatrix4f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_viewport_size:new f.Uniform2f(g)}),debug:g=>({u_color:new f.UniformColor(g),u_matrix:new f.UniformMatrix4f(g),u_overlay:new f.Uniform1i(g),u_overlay_scale:new f.Uniform1f(g)}),clippingMask:g=>({u_matrix:new f.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new f.Uniform1f(g),u_intensity:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_up_dir:new f.Uniform3f(g)}),heatmapTexture:g=>({u_image:new f.Uniform1i(g),u_color_ramp:new f.Uniform1i(g),u_opacity:new f.Uniform1f(g)}),hillshade:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_latrange:new f.Uniform2f(g),u_light:new f.Uniform2f(g),u_shadow:new f.UniformColor(g),u_highlight:new f.UniformColor(g),u_accent:new f.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new f.UniformMatrix4f(g),u_image:new f.Uniform1i(g),u_dimension:new f.Uniform2f(g),u_zoom:new f.Uniform1f(g),u_unpack:new f.Uniform4f(g)}),line:g=>({u_matrix:new f.UniformMatrix4f(g),u_pixels_to_tile_units:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_units_to_pixels:new f.Uniform2f(g),u_dash_image:new f.Uniform1i(g),u_gradient_image:new f.Uniform1i(g),u_image_height:new f.Uniform1f(g),u_texsize:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_alpha_discard_threshold:new f.Uniform1f(g),u_trim_offset:new f.Uniform2f(g)}),linePattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_texsize:new f.Uniform2f(g),u_pixels_to_tile_units:new f.UniformMatrix2f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_units_to_pixels:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g),u_alpha_discard_threshold:new f.Uniform1f(g)}),raster:g=>({u_matrix:new f.UniformMatrix4f(g),u_tl_parent:new f.Uniform2f(g),u_scale_parent:new f.Uniform1f(g),u_fade_t:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_image0:new f.Uniform1i(g),u_image1:new f.Uniform1i(g),u_brightness_low:new f.Uniform1f(g),u_brightness_high:new f.Uniform1f(g),u_saturation_factor:new f.Uniform1f(g),u_contrast_factor:new f.Uniform1f(g),u_spin_weights:new f.Uniform3f(g),u_perspective_transform:new f.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_camera_forward:new f.Uniform3f(g),u_tile_matrix:new f.UniformMatrix4f(g),u_up_vector:new f.Uniform3f(g),u_ecef_origin:new f.Uniform3f(g),u_texture:new f.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_texture:new f.Uniform1i(g),u_gamma_scale:new f.Uniform1f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_tile_id:new f.Uniform3f(g),u_zoom_transition:new f.Uniform1f(g),u_inv_rot_matrix:new f.UniformMatrix4f(g),u_merc_center:new f.Uniform2f(g),u_camera_forward:new f.Uniform3f(g),u_tile_matrix:new f.UniformMatrix4f(g),u_up_vector:new f.Uniform3f(g),u_ecef_origin:new f.Uniform3f(g),u_is_halo:new f.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new f.Uniform1i(g),u_is_size_feature_constant:new f.Uniform1i(g),u_size_t:new f.Uniform1f(g),u_size:new f.Uniform1f(g),u_camera_to_center_distance:new f.Uniform1f(g),u_rotate_symbol:new f.Uniform1i(g),u_aspect_ratio:new f.Uniform1f(g),u_fade_change:new f.Uniform1f(g),u_matrix:new f.UniformMatrix4f(g),u_label_plane_matrix:new f.UniformMatrix4f(g),u_coord_matrix:new f.UniformMatrix4f(g),u_is_text:new f.Uniform1i(g),u_pitch_with_map:new f.Uniform1i(g),u_texsize:new f.Uniform2f(g),u_texsize_icon:new f.Uniform2f(g),u_texture:new f.Uniform1i(g),u_texture_icon:new f.Uniform1i(g),u_gamma_scale:new f.Uniform1f(g),u_device_pixel_ratio:new f.Uniform1f(g),u_is_halo:new f.Uniform1i(g)}),background:g=>({u_matrix:new f.UniformMatrix4f(g),u_opacity:new f.Uniform1f(g),u_color:new f.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new f.UniformMatrix4f(g),u_opacity:new f.Uniform1f(g),u_image:new f.Uniform1i(g),u_pattern_tl:new f.Uniform2f(g),u_pattern_br:new f.Uniform2f(g),u_texsize:new f.Uniform2f(g),u_pattern_size:new f.Uniform2f(g),u_pixel_coord_upper:new f.Uniform2f(g),u_pixel_coord_lower:new f.Uniform2f(g),u_tile_units_to_pixels:new f.Uniform1f(g)}),terrainRaster:wa,terrainDepth:wa,skybox:g=>({u_matrix:new f.UniformMatrix4f(g),u_sun_direction:new f.Uniform3f(g),u_cubemap:new f.Uniform1i(g),u_opacity:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new f.UniformMatrix4f(g),u_color_ramp:new f.Uniform1i(g),u_center_direction:new f.Uniform3f(g),u_radius:new f.Uniform1f(g),u_opacity:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new f.UniformMatrix3f(g),u_sun_direction:new f.Uniform3f(g),u_sun_intensity:new f.Uniform1f(g),u_color_tint_r:new f.Uniform4f(g),u_color_tint_m:new f.Uniform4f(g),u_luminance:new f.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new f.UniformMatrix4f(g),u_globe_matrix:new f.UniformMatrix4f(g),u_normalize_matrix:new f.UniformMatrix4f(g),u_merc_matrix:new f.UniformMatrix4f(g),u_zoom_transition:new f.Uniform1f(g),u_merc_center:new f.Uniform2f(g),u_image0:new f.Uniform1i(g),u_grid_matrix:new f.UniformMatrix3f(g),u_skirt_height:new f.Uniform1f(g),u_frustum_tl:new f.Uniform3f(g),u_frustum_tr:new f.Uniform3f(g),u_frustum_br:new f.Uniform3f(g),u_frustum_bl:new f.Uniform3f(g),u_globe_pos:new f.Uniform3f(g),u_globe_radius:new f.Uniform1f(g),u_viewport:new f.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new f.Uniform3f(g),u_frustum_tr:new f.Uniform3f(g),u_frustum_br:new f.Uniform3f(g),u_frustum_bl:new f.Uniform3f(g),u_horizon:new f.Uniform1f(g),u_transition:new f.Uniform1f(g),u_fadeout_range:new f.Uniform1f(g),u_color:new f.Uniform4f(g),u_high_color:new f.Uniform4f(g),u_space_color:new f.Uniform4f(g),u_star_intensity:new f.Uniform1f(g),u_star_density:new f.Uniform1f(g),u_star_size:new f.Uniform1f(g),u_temporal_offset:new f.Uniform1f(g),u_horizon_angle:new f.Uniform1f(g),u_rotation_matrix:new f.UniformMatrix4f(g)})};let Vi;function bs(g,c,h,y,x,E,D){const M=g.context,P=M.gl,z=g.transform,B=g.useProgram("collisionBox"),$=[];let X=0,ee=0;for(let de=0;de<y.length;de++){const xe=y[de],ye=c.getTile(xe),Ce=ye.getBucket(h);if(!Ce)continue;const Ae=Sn(xe,Ce,z);let Ne=Ae;0===x[0]&&0===x[1]||(Ne=g.translatePosMatrix(Ae,ye,x,E));const Ve=D?Ce.textCollisionBox:Ce.iconCollisionBox,yt=Ce.collisionCircleArray;if(yt.length>0){const Pe=f.create(),et=Ne;f.mul(Pe,Ce.placementInvProjMatrix,z.glCoordMatrix),f.mul(Pe,Pe,Ce.placementViewportMatrix),$.push({circleArray:yt,circleOffset:ee,transform:et,invTransform:Pe,projection:Ce.getProjection()}),X+=yt.length/4,ee=X}Ve&&(g.terrain&&g.terrain.setupElevationDraw(ye,B),B.draw(M,P.LINES,f.DepthMode.disabled,f.StencilMode.disabled,g.colorModeForRenderPass(),f.CullFaceMode.disabled,$h(Ne,z,ye,Ce.getProjection()),h.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,null,z.zoom,null,[Ve.collisionVertexBuffer,Ve.collisionVertexBufferExt]))}if(!D||!$.length)return;const te=g.useProgram("collisionCircle"),ne=new f.StructArrayLayout2f1f2i16;ne.resize(4*X),ne._trim();let J=0;for(const de of $)for(let xe=0;xe<de.circleArray.length/4;xe++){const ye=4*xe,Ce=de.circleArray[ye+0],Ae=de.circleArray[ye+1],Ne=de.circleArray[ye+2],Ve=de.circleArray[ye+3];ne.emplace(J++,Ce,Ae,Ne,Ve,0),ne.emplace(J++,Ce,Ae,Ne,Ve,1),ne.emplace(J++,Ce,Ae,Ne,Ve,2),ne.emplace(J++,Ce,Ae,Ne,Ve,3)}(!Vi||Vi.length<2*X)&&(Vi=function(de){const xe=2*de,ye=new f.StructArrayLayout3ui6;ye.resize(xe),ye._trim();for(let Ce=0;Ce<xe;Ce++){const Ae=6*Ce;ye.uint16[Ae+0]=4*Ce+0,ye.uint16[Ae+1]=4*Ce+1,ye.uint16[Ae+2]=4*Ce+2,ye.uint16[Ae+3]=4*Ce+2,ye.uint16[Ae+4]=4*Ce+3,ye.uint16[Ae+5]=4*Ce+0}return ye}(X));const Y=M.createIndexBuffer(Vi,!0),ce=M.createVertexBuffer(ne,f.collisionCircleLayout.members,!0);for(const de of $){const xe={u_matrix:de.transform,u_inv_matrix:de.invTransform,u_camera_to_center_distance:(le=z).getCameraToCenterDistance(de.projection),u_viewport_size:[le.width,le.height]};te.draw(M,P.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,g.colorModeForRenderPass(),f.CullFaceMode.disabled,xe,h.id,ce,Y,f.SegmentVector.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,z.zoom)}var le;ce.destroy(),Y.destroy()}const ca=f.create();function Hr({width:g,height:c,anchor:h,textOffset:y,textScale:x},E){const{horizontalAlign:D,verticalAlign:M}=f.getAnchorAlignment(h),P=-(D-.5)*g,z=-(M-.5)*c,B=f.evaluateVariableOffset(h,y);return new f.pointGeometry((P/x+B[0])*E,(z/x+B[1])*E)}function Hs(g,c,h,y,x,E,D,M,P,z,B){const $=g.text.placedSymbolArray,X=g.text.dynamicLayoutVertexArray,ee=g.icon.dynamicLayoutVertexArray,te={},ne=g.getProjection(),J=gi(M,ne,E),Y=E.elevation,ce=ne.upVectorScale(M.canonical,E.center.lat,E.worldSize).metersToTile;X.clear();for(let le=0;le<$.length;le++){const de=$.get(le),{tileAnchorX:xe,tileAnchorY:ye,numGlyphs:Ce}=de,Ne=de.hidden||!de.crossTileID||g.allowVerticalPlacement&&!de.placedOrientation?null:y[de.crossTileID];if(Ne){let Ve=0,yt=0,Pe=0;if(Y){const Yt=Y?Y.getAtTileOffset(M,xe,ye):0,[On,Ft,kt]=ne.upVector(M.canonical,xe,ye);Ve=Yt*On*ce,yt=Yt*Ft*ce,Pe=Yt*kt*ce}let[et,We,ht,Ue]=Et(de.projectedAnchorX+Ve,de.projectedAnchorY+yt,de.projectedAnchorZ+Pe,h?J:D);const Se=kn(E.getCameraToCenterDistance(ne),Ue);let He=x.evaluateSizeForFeature(g.textSizeData,z,de)*Se/f.ONE_EM;h&&(He*=g.tilePixelRatio/P);const ct=Hr(Ne,He);h?(({x:et,y:We,z:ht}=ne.projectTilePoint(xe+ct.x,ye+ct.y,M.canonical)),[et,We,ht]=Et(et+Ve,We+yt,ht+Pe,D)):(c&&ct._rotate(-E.angle),et+=ct.x,We+=ct.y,ht=0);const ft=g.allowVerticalPlacement&&de.placedOrientation===f.WritingMode.vertical?Math.PI/2:0;for(let Yt=0;Yt<Ce;Yt++)f.addDynamicAttributes(X,et,We,ht,ft);B&&de.associatedIconIndex>=0&&(te[de.associatedIconIndex]={x:et,y:We,z:ht,angle:ft})}else wi(Ce,X)}if(B){ee.clear();const le=g.icon.placedSymbolArray;for(let de=0;de<le.length;de++){const xe=le.get(de),{numGlyphs:ye}=xe,Ce=te[de];if(xe.hidden||!Ce)wi(ye,ee);else{const{x:Ae,y:Ne,z:Ve,angle:yt}=Ce;for(let Pe=0;Pe<ye;Pe++)f.addDynamicAttributes(ee,Ae,Ne,Ve,yt)}}g.icon.dynamicLayoutVertexBuffer.updateData(ee)}g.text.dynamicLayoutVertexBuffer.updateData(X)}function mr(g,c,h){return h.iconsInText&&c?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function au(g,c,h,y,x,E,D,M,P,z,B,$){const X=g.context,ee=X.gl,te=g.transform,ne="map"===M,J="map"===P,Y=ne&&"point"!==h.layout.get("symbol-placement"),ce=ne&&!J&&!Y,le=void 0!==h.layout.get("symbol-sort-key").constantOr(1);let de=!1;const xe=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),ye=[f.mercatorXfromLng(te.center.lng),f.mercatorYfromLat(te.center.lat)],Ce=h.layout.get("text-variable-anchor"),Ae="globe"===te.projection.name,Ne=[],Ve=[0,-1,0];let yt=Ve;!Ae&&!te.mercatorFromTransition||ne||(yt=function(Pe){const et=Pe._camera.getWorldToCamera(Pe.worldSize,1),We=f.multiply([],et,Pe.globeMatrix);f.invert(We,We);const ht=[0,0,0],Ue=[0,1,0,0];return f.transformMat4$1(Ue,Ue,We),ht[0]=Ue[0],ht[1]=Ue[1],ht[2]=Ue[2],f.normalize(ht,ht),ht}(te));for(const Pe of y){const et=c.getTile(Pe),We=et.getBucket(h);if(!We||"mercator"===We.projection.name&&Ae)continue;const ht=x?We.text:We.icon;if(!ht||We.fullyClipped||!ht.segments.get().length)continue;const Ue=ht.programConfigurations.get(h.id),Se=x||We.sdfIcons,He=x?We.textSizeData:We.iconSizeData,ct=J||0!==te.pitch,ft=f.evaluateSizeForZoom(He,te.zoom);let Yt,On,Ft,kt,Kt=[0,0],Rn=null;if(x)On=et.glyphAtlasTexture,Ft=ee.LINEAR,Yt=et.glyphAtlasTexture.size,We.iconsInText&&(Kt=et.imageAtlasTexture.size,Rn=et.imageAtlasTexture,kt=ct||g.options.rotating||g.options.zooming||"composite"===He.kind||"camera"===He.kind?ee.LINEAR:ee.NEAREST);else{const Ts=1!==h.layout.get("icon-size").constantOr(0)||We.iconsNeedLinear;On=et.imageAtlasTexture,Ft=Se||g.options.rotating||g.options.zooming||Ts||ct?ee.LINEAR:ee.NEAREST,Yt=et.imageAtlasTexture.size}const Jt="globe"===We.projection.name,_i=Jt?yt:Ve,hi=Jt?f.globeToMercatorTransition(te.zoom):0,qi=gi(Pe,We.getProjection(),te),Si=te.calculatePixelsToTileUnitsMatrix(et),gr=sc(qi,et.tileID.canonical,J,ne,te,We.getProjection(),Si),xo=g.terrain&&J&&Y?f.invert(f.create(),gr):ca,rl=xa(qi,et.tileID.canonical,J,ne,te,We.getProjection(),Si),ol=Ce&&We.hasTextData(),Qi="none"!==h.layout.get("icon-text-fit")&&ol&&We.hasIconData();if(Y){const Ts=te.elevation,Gs=Ts?Ts.getAtTileOffsetFunc(Pe,te.center.lat,te.worldSize,We.getProjection()):null,al=hr(qi,et.tileID.canonical,J,ne,te,We.getProjection(),Si);gs(We,qi,g,x,al,rl,J,z,Gs,Pe)}const Ui=Y||x&&Ce||Qi,Fn=g.translatePosMatrix(qi,et,E,D),_r=Ui?ca:gr,qr=g.translatePosMatrix(rl,et,E,D,!0),ji=We.getProjection().createInversionMatrix(te,Pe.canonical),wo=[];g.terrainRenderModeElevated()&&J&&wo.push("PITCH_WITH_MAP_TERRAIN"),Jt&&wo.push("PROJECTION_GLOBE_VIEW"),Ui&&wo.push("PROJECTED_POS_ON_VIEWPORT");const ao=Se&&0!==h.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let sl;sl=Se?We.iconsInText?Bl(He.kind,ft,ce,J,g,Fn,_r,qr,Yt,Kt,Pe,hi,ye,ji,_i,We.getProjection()):jd(He.kind,ft,ce,J,g,Fn,_r,qr,x,Yt,!0,Pe,hi,ye,ji,_i,We.getProjection()):vc(He.kind,ft,ce,J,g,Fn,_r,qr,x,Yt,Pe,hi,ye,ji,_i,We.getProjection());const sd={program:g.useProgram(mr(Se,x,We),Ue,wo),buffers:ht,uniformValues:sl,atlasTexture:On,atlasTextureIcon:Rn,atlasInterpolation:Ft,atlasInterpolationIcon:kt,isSDF:Se,hasHalo:ao,tile:et,labelPlaneMatrixInv:xo};if(le&&We.canOverlap){de=!0;const Ts=ht.segments.get();for(const Gs of Ts)Ne.push({segments:new f.SegmentVector([Gs]),sortKey:Gs.sortKey,state:sd})}else Ne.push({segments:ht.segments,sortKey:0,state:sd})}de&&Ne.sort((Pe,et)=>Pe.sortKey-et.sortKey);for(const Pe of Ne){const et=Pe.state;if(g.terrain&&g.terrain.setupElevationDraw(et.tile,et.program,{useDepthForOcclusion:!Ae,labelPlaneMatrixInv:et.labelPlaneMatrixInv}),X.activeTexture.set(ee.TEXTURE0),et.atlasTexture.bind(et.atlasInterpolation,ee.CLAMP_TO_EDGE),et.atlasTextureIcon&&(X.activeTexture.set(ee.TEXTURE1),et.atlasTextureIcon&&et.atlasTextureIcon.bind(et.atlasInterpolationIcon,ee.CLAMP_TO_EDGE)),et.isSDF){const We=et.uniformValues;et.hasHalo&&(We.u_is_halo=1,lu(et.buffers,Pe.segments,h,g,et.program,xe,B,$,We)),We.u_is_halo=0}lu(et.buffers,Pe.segments,h,g,et.program,xe,B,$,et.uniformValues)}}function lu(g,c,h,y,x,E,D,M,P){const z=y.context,B=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];x.draw(z,z.gl.TRIANGLES,E,D,M,f.CullFaceMode.disabled,P,h.id,g.layoutVertexBuffer,g.indexBuffer,c,h.paint,y.transform.zoom,g.programConfigurations.get(h.id),B)}function $n(g,c,h,y,x,E,D){const M=g.context.gl,P=h.paint.get("fill-pattern"),z=P&&P.constantOr(1);let B,$,X,ee,te;D?($=z&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=M.LINES):($=z?"fillPattern":"fill",B=M.TRIANGLES);for(const ne of y){const J=c.getTile(ne);if(z&&!J.patternsLoaded())continue;const Y=J.getBucket(h);if(!Y)continue;g.prepareDrawTile();const ce=Y.programConfigurations.get(h.id),le=g.useProgram($,ce);z&&(g.context.activeTexture.set(M.TEXTURE0),J.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),ce.updatePaintBuffers());const de=P.constantOr(null);if(de&&J.imageAtlas){const ye=J.imageAtlas.patternPositions[de.toString()];ye&&ce.setConstantPatternPositions(ye)}const xe=g.translatePosMatrix(ne.projMatrix,J,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(D){ee=Y.indexBuffer2,te=Y.segments2;const ye=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[M.drawingBufferWidth,M.drawingBufferHeight];X="fillOutlinePattern"===$&&z?yc(xe,g,J,ye):vs(xe,ye)}else ee=Y.indexBuffer,te=Y.segments,X=z?_c(xe,g,J):Nl(xe);g.prepareDrawProgram(g.context,le,ne.toUnwrapped()),le.draw(g.context,B,x,g.stencilModeForClipping(ne),E,f.CullFaceMode.disabled,X,h.id,Y.layoutVertexBuffer,ee,te,h.paint,g.transform.zoom,ce)}}function cu(g,c,h,y,x,E,D){const M=g.context,P=M.gl,z=g.transform,B=h.paint.get("fill-extrusion-pattern"),$=B.constantOr(1),X=h.paint.get("fill-extrusion-opacity"),ee=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],te=h.layout.get("fill-extrusion-edge-radius"),ne="globe"===z.projection.name?f.fillExtrusionHeightLift():0,J="globe"===z.projection.name,Y=J?f.globeToMercatorTransition(z.zoom):0,ce=[f.mercatorXfromLng(z.center.lng),f.mercatorYfromLat(z.center.lat)],le=[];J&&le.push("PROJECTION_GLOBE_VIEW"),ee[0]>0&&le.push("FAUX_AO");for(const de of y){const xe=c.getTile(de),ye=xe.getBucket(h);if(!ye||ye.projection.name!==z.projection.name)continue;const Ce=ye.programConfigurations.get(h.id),Ae=g.useProgram($?"fillExtrusionPattern":"fillExtrusion",Ce,le);if(g.terrain){const ht=g.terrain;if(g.style.terrainSetForDrapingOnly())ht.setupElevationDraw(xe,Ae,{useMeterToDem:!0});else{if(!ye.enableTerrain)continue;if(ht.setupElevationDraw(xe,Ae,{useMeterToDem:!0}),uu(M,c,de,ye,h,ht),!ye.centroidVertexBuffer){const Ue=Ae.attributes.a_centroid_pos;void 0!==Ue&&P.vertexAttrib2f(Ue,0,0)}}}$&&(g.context.activeTexture.set(P.TEXTURE0),xe.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ce.updatePaintBuffers());const Ne=B.constantOr(null);if(Ne&&xe.imageAtlas){const ht=xe.imageAtlas.patternPositions[Ne.toString()];ht&&Ce.setConstantPatternPositions(ht)}const Ve=g.translatePosMatrix(de.projMatrix,xe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),yt=z.projection.createInversionMatrix(z,de.canonical),Pe=h.paint.get("fill-extrusion-vertical-gradient"),et=$?Ll(Ve,g,Pe,X,ee,te,de,xe,ne,Y,ce,yt):Fl(Ve,g,Pe,X,ee,te,de,ne,Y,ce,yt);g.prepareDrawProgram(M,Ae,de.toUnwrapped());const We=[];g.terrain&&We.push(ye.centroidVertexBuffer),J&&We.push(ye.layoutVertexExtBuffer),Ae.draw(M,M.gl.TRIANGLES,x,E,D,f.CullFaceMode.backCCW,et,h.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,h.paint,g.transform.zoom,Ce,We)}}function uu(g,c,h,y,x,E){const D=[Y=>{let ce=Y.canonical.x-1,le=Y.wrap;return ce<0&&(ce=(1<<Y.canonical.z)-1,le--),new f.OverscaledTileID(Y.overscaledZ,le,Y.canonical.z,ce,Y.canonical.y)},Y=>{let ce=Y.canonical.x+1,le=Y.wrap;return ce===1<<Y.canonical.z&&(ce=0,le++),new f.OverscaledTileID(Y.overscaledZ,le,Y.canonical.z,ce,Y.canonical.y)},Y=>new f.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,(0===Y.canonical.y?1<<Y.canonical.z:Y.canonical.y)-1),Y=>new f.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y===(1<<Y.canonical.z)-1?0:Y.canonical.y+1)],M=Y=>{const ce=c.getSource().minzoom,le=xe=>{const ye=c.getTileByID(xe);if(ye&&ye.hasData())return ye.getBucket(x)},de=[0,-1,1];for(const xe of de){if(Y.overscaledZ+xe<ce)continue;const ye=le(Y.calculateScaledKey(Y.overscaledZ+xe));if(ye)return ye}},P=[0,0,0],z=(Y,ce)=>(P[0]=Math.min(Y.min.y,ce.min.y),P[1]=Math.max(Y.max.y,ce.max.y),P[2]=f.EXTENT-ce.min.x>Y.max.x?ce.min.x-f.EXTENT:Y.max.x,P),B=(Y,ce)=>(P[0]=Math.min(Y.min.x,ce.min.x),P[1]=Math.max(Y.max.x,ce.max.x),P[2]=f.EXTENT-ce.min.y>Y.max.y?ce.min.y-f.EXTENT:Y.max.y,P),$=[(Y,ce)=>z(Y,ce),(Y,ce)=>z(ce,Y),(Y,ce)=>B(Y,ce),(Y,ce)=>B(ce,Y)],X=new f.pointGeometry(0,0);let ee,te,ne;const J=(Y,ce,le,de,xe)=>{const ye=[[de?le:Y,de?Y:le,0],[de?le:ce,de?ce:le,0]],Ce=xe<0?f.EXTENT+xe:xe,Ae=[de?Ce:(Y+ce)/2,de?(Y+ce)/2:Ce,0];return 0===le&&xe<0||0!==le&&xe>0?E.getForTilePoints(ne,[Ae],!0,te):ye.push(Ae),E.getForTilePoints(h,ye,!0,ee),Math.max(ye[0][2],ye[1][2],Ae[2])/E.exaggeration()};for(let Y=0;Y<4;Y++){const ce=(Y<2?1:5)-Y,le=y.borders[Y];if(0===le.length)continue;const de=ne=D[Y](h),xe=M(de);if(!(xe&&xe instanceof f.FillExtrusionBucket&&xe.enableTerrain)||y.borderDoneWithNeighborZ[Y]===xe.canonical.z&&xe.borderDoneWithNeighborZ[ce]===y.canonical.z||(te=E.findDEMTileFor(de),!te||!te.dem))continue;if(!ee){const Ne=E.findDEMTileFor(h);if(!Ne||!Ne.dem)return;ee=Ne}const ye=xe.borders[ce];let Ce=0;const Ae=xe.borderDoneWithNeighborZ[ce]!==y.canonical.z;if(y.canonical.z===xe.canonical.z){for(let Ne=0;Ne<le.length;Ne++){const Ve=y.featuresOnBorder[le[Ne]],yt=Ve.borders[Y];let Pe;for(;Ce<ye.length&&(Pe=xe.featuresOnBorder[ye[Ce]],!(Pe.borders[ce][1]>yt[0]+3));)Ae&&xe.encodeCentroid(void 0,Pe,!1),Ce++;if(Pe&&Ce<ye.length){const et=Ce;let We=0;for(;!(Pe.borders[ce][0]>yt[1]-3)&&(We++,++Ce!==ye.length);)Pe=xe.featuresOnBorder[ye[Ce]];if(Pe=xe.featuresOnBorder[ye[et]],Ve.intersectsCount()>1||Pe.intersectsCount()>1||1!==We){1!==We&&(Ce=et),y.encodeCentroid(void 0,Ve,!1),Ae&&xe.encodeCentroid(void 0,Pe,!1);continue}const ht=$[Y](Ve,Pe),Ue=Y%2?f.EXTENT-1:0;X.x=J(ht[0],Math.min(f.EXTENT-1,ht[1]),Ue,Y<2,ht[2]),X.y=0,y.encodeCentroid(X,Ve,!1),Ae&&xe.encodeCentroid(X,Pe,!1)}else y.encodeCentroid(void 0,Ve,!1)}y.borderDoneWithNeighborZ[Y]=xe.canonical.z,y.needsCentroidUpdate=!0,Ae&&(xe.borderDoneWithNeighborZ[ce]=y.canonical.z,xe.needsCentroidUpdate=!0)}else{for(const Ne of le)y.encodeCentroid(void 0,y.featuresOnBorder[Ne],!1);if(Ae){for(const Ne of ye)xe.encodeCentroid(void 0,xe.featuresOnBorder[Ne],!1);xe.borderDoneWithNeighborZ[ce]=y.canonical.z,xe.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[Y]=xe.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&0!==y.centroidVertexArray.length)&&y.uploadCentroid(g)}const Ju=new f.Color(1,0,0,1),Oo=new f.Color(0,1,0,1),zr=new f.Color(0,0,1,1),bc=new f.Color(1,0,1,1),Xa=new f.Color(0,1,1,1);function xs(g,c,h){const y=g.context,x=g.transform,E=y.gl,D="globe"===x.projection.name,M=D?["PROJECTION_GLOBE_VIEW"]:null;let P=h.projMatrix;if(D&&f.globeToMercatorTransition(x.zoom)>0){const Ve=f.transitionTileAABBinECEF(h.canonical,x),yt=f.globeDenormalizeECEF(Ve);P=f.multiply(new Float32Array(16),x.globeMatrix,yt),f.multiply(P,x.projMatrix,P)}const z=g.useProgram("debug",null,M),B=c.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw(B,z);const $=f.DepthMode.disabled,X=f.StencilMode.disabled,ee=g.colorModeForRenderPass();y.activeTexture.set(E.TEXTURE0),g.emptyTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),D?B._makeGlobeTileDebugBuffers(g.context,x):B._makeDebugTileBoundsBuffers(g.context,x.projection);const ne=B._tileDebugBuffer||g.debugBuffer,J=B._tileDebugIndexBuffer||g.debugIndexBuffer,Y=B._tileDebugSegments||g.debugSegments;z.draw(y,E.LINE_STRIP,$,X,ee,f.CullFaceMode.disabled,ou(P,f.Color.red),"$debug",ne,J,Y,null,null,null,[B._globeTileDebugBorderBuffer]);const ce=B.latestRawTileData,le=Math.floor((ce&&ce.byteLength||0)/1024),de=c.getTile(h).tileSize,xe=512/Math.min(de,512)*(h.overscaledZ/x.zoom)*.5;let ye=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(ye+=` => ${h.overscaledZ}`),ye+=` ${le}kb`,function(Ve,yt){Ve.initDebugOverlayCanvas();const Pe=Ve.debugOverlayCanvas,et=Ve.context.gl,We=Ve.debugOverlayCanvas.getContext("2d");We.clearRect(0,0,Pe.width,Pe.height),We.shadowColor="white",We.shadowBlur=2,We.lineWidth=1.5,We.strokeStyle="white",We.textBaseline="top",We.font="bold 36px Open Sans, sans-serif",We.fillText(yt,5,5),We.strokeText(yt,5,5),Ve.debugOverlayTexture.update(Pe),Ve.debugOverlayTexture.bind(et.LINEAR,et.CLAMP_TO_EDGE)}(g,ye);const Ce=B._tileDebugTextBuffer||g.debugBuffer,Ae=B._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,Ne=B._tileDebugTextSegments||g.debugSegments;z.draw(y,E.TRIANGLES,$,X,f.ColorMode.alphaBlended,f.CullFaceMode.disabled,ou(P,f.Color.transparent,xe),"$debug",Ce,Ae,Ne,null,null,null,[B._globeTileDebugTextBuffer])}function ws(g,c,h,y){Ri(g,0,c+h/2,g.transform.width,h,y)}function zl(g,c,h,y){Ri(g,c-h/2,0,h,g.transform.height,y)}function Ri(g,c,h,y,x,E){const D=g.context,M=D.gl;M.enable(M.SCISSOR_TEST),M.scissor(c*f.exported.devicePixelRatio,h*f.exported.devicePixelRatio,y*f.exported.devicePixelRatio,x*f.exported.devicePixelRatio),D.clear({color:E}),M.disable(M.SCISSOR_TEST)}const du=f.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Qa}=du;function ua(g,c,h,y){g.emplaceBack(c,h,y)}class ro{constructor(c){this.vertexArray=new f.StructArrayLayout3f12,this.indices=new f.StructArrayLayout3ui6,ua(this.vertexArray,-1,-1,1),ua(this.vertexArray,1,-1,1),ua(this.vertexArray,-1,1,1),ua(this.vertexArray,1,1,1),ua(this.vertexArray,-1,-1,-1),ua(this.vertexArray,1,-1,-1),ua(this.vertexArray,-1,1,-1),ua(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Qa),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=f.SegmentVector.simpleSegment(0,0,36,12)}}function Cn(g,c,h,y,x,E){const D=g.gl,M=c.paint.get("sky-atmosphere-color"),P=c.paint.get("sky-atmosphere-halo-color"),z=c.paint.get("sky-atmosphere-sun-intensity"),B={u_matrix_3f:f.fromMat4(f.create$1(),y),u_sun_direction:x,u_sun_intensity:z,u_color_tint_r:[(te=M).r,te.g,te.b,te.a],u_color_tint_m:[(ne=P).r,ne.g,ne.b,ne.a],u_luminance:5e-5};var te,ne;D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+E,c.skyboxTexture,0),h.draw(g,D.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.frontCW,B,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const Ta=f.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class vo{constructor(c){const h=new f.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const y=new f.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(h,Ta.members),this.indexBuffer=c.createIndexBuffer(y),this.segments=f.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Hh={symbol:function(g,c,h,y,x){if("translucent"!==g.renderPass)return;const E=f.StencilMode.disabled,D=g.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(M,P,z,B,$,X,ee){const te=P.transform,ne="map"===$,J="map"===X;for(const Y of M){const ce=B.getTile(Y),le=ce.getBucket(z);if(!le||!le.text||!le.text.segments.get().length)continue;const de=f.evaluateSizeForZoom(le.textSizeData,te.zoom),xe=gi(Y,le.getProjection(),te),ye=te.calculatePixelsToTileUnitsMatrix(ce),Ce=sc(xe,ce.tileID.canonical,J,ne,te,le.getProjection(),ye),Ae="none"!==z.layout.get("icon-text-fit")&&le.hasIconData();if(de){const Ne=Math.pow(2,te.zoom-ce.tileID.overscaledZ);Hs(le,ne,J,ee,f.symbolSize,te,Ce,Y,Ne,de,Ae)}}}(y,g,h,c,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x),0!==h.paint.get("icon-opacity").constantOr(1)&&au(g,c,h,y,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),E,D),0!==h.paint.get("text-opacity").constantOr(1)&&au(g,c,h,y,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),E,D),c.map.showCollisionBoxes&&(bs(g,c,h,y,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),bs(g,c,h,y,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,c,h,y){if("translucent"!==g.renderPass)return;const x=h.paint.get("circle-opacity"),E=h.paint.get("circle-stroke-width"),D=h.paint.get("circle-stroke-opacity"),M=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===E.constantOr(1)||0===D.constantOr(1)))return;const P=g.context,z=P.gl,B=g.transform,$=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),X=f.StencilMode.disabled,ee=g.colorModeForRenderPass(),te="globe"===B.projection.name,ne=[f.mercatorXfromLng(B.center.lng),f.mercatorYfromLat(B.center.lat)],J=[];for(let ce=0;ce<y.length;ce++){const le=y[ce],de=c.getTile(le),xe=de.getBucket(h);if(!xe||xe.projection.name!==B.projection.name)continue;const ye=xe.programConfigurations.get(h.id),Ce=Ka(h);te&&Ce.push("PROJECTION_GLOBE_VIEW");const Ae=g.useProgram("circle",ye,Ce),Ne=xe.layoutVertexBuffer,Ve=xe.globeExtVertexBuffer,yt=xe.indexBuffer,Pe=B.projection.createInversionMatrix(B,le.canonical),et={programConfiguration:ye,program:Ae,layoutVertexBuffer:Ne,globeExtVertexBuffer:Ve,indexBuffer:yt,uniformValues:pr(g,le,de,Pe,ne,h),tile:de};if(M){const We=xe.segments.get();for(const ht of We)J.push({segments:new f.SegmentVector([ht]),sortKey:ht.sortKey,state:et})}else J.push({segments:xe.segments,sortKey:0,state:et})}M&&J.sort((ce,le)=>ce.sortKey-le.sortKey);const Y={useDepthForOcclusion:!te};for(const ce of J){const{programConfiguration:le,program:de,layoutVertexBuffer:xe,globeExtVertexBuffer:ye,indexBuffer:Ce,uniformValues:Ae,tile:Ne}=ce.state,Ve=ce.segments;g.terrain&&g.terrain.setupElevationDraw(Ne,de,Y),g.prepareDrawProgram(P,de,Ne.tileID.toUnwrapped()),de.draw(P,z.TRIANGLES,$,X,ee,f.CullFaceMode.disabled,Ae,h.id,xe,Ce,Ve,h.paint,B.zoom,le,[ye])}},heatmap:function(g,c,h,y){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===g.renderPass){const x=g.context,E=x.gl,D=f.StencilMode.disabled,M=new f.ColorMode([E.ONE,E.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(ee,te,ne,J){const Y=ee.gl,ce=te.width*J,le=te.height*J;ee.activeTexture.set(Y.TEXTURE1),ee.viewport.set([0,0,ce,le]);let de=ne.heatmapFbo;if(!de||de&&(de.width!==ce||de.height!==le)){de&&de.destroy();const xe=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,xe),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),de=ne.heatmapFbo=ee.createFramebuffer(ce,le,!1),function(ye,Ce,Ae,Ne,Ve,yt){const Pe=ye.gl;Pe.texImage2D(Pe.TEXTURE_2D,0,ye.isWebGL2&&ye.extRenderToTextureHalfFloat?Pe.RGBA16F:Pe.RGBA,Ve,yt,0,Pe.RGBA,ye.extRenderToTextureHalfFloat?ye.isWebGL2?Pe.HALF_FLOAT:ye.extTextureHalfFloat.HALF_FLOAT_OES:Pe.UNSIGNED_BYTE,null),Ne.colorAttachment.set(Ae)}(ee,0,xe,de,ce,le)}else Y.bindTexture(Y.TEXTURE_2D,de.colorAttachment.get()),ee.bindFramebuffer.set(de.framebuffer)})(x,g,h,"globe"===g.transform.projection.name?.5:.25),x.clear({color:f.Color.transparent});const P=g.transform,z="globe"===P.projection.name,B=z?["PROJECTION_GLOBE_VIEW"]:null,$=z?f.CullFaceMode.frontCCW:f.CullFaceMode.disabled,X=[f.mercatorXfromLng(P.center.lng),f.mercatorYfromLat(P.center.lat)];for(let ee=0;ee<y.length;ee++){const te=y[ee];if(c.hasRenderableParent(te))continue;const ne=c.getTile(te),J=ne.getBucket(h);if(!J||J.projection.name!==P.projection.name)continue;const Y=J.programConfigurations.get(h.id),ce=g.useProgram("heatmap",Y,B),{zoom:le}=g.transform;g.terrain&&g.terrain.setupElevationDraw(ne,ce),g.prepareDrawProgram(x,ce,te.toUnwrapped());const de=P.projection.createInversionMatrix(P,te.canonical);ce.draw(x,E.TRIANGLES,f.DepthMode.disabled,D,M,$,la(g,te,ne,de,X,le,h.paint.get("heatmap-intensity")),h.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,h.paint,g.transform.zoom,Y,z?[J.globeExtVertexBuffer]:null)}x.viewport.set([0,0,g.width,g.height])}else"translucent"===g.renderPass&&(g.context.setColorMode(g.colorModeForRenderPass()),function(x,E){const D=x.context,M=D.gl,P=E.heatmapFbo;if(!P)return;D.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,P.colorAttachment.get()),D.activeTexture.set(M.TEXTURE1);let z=E.colorRampTexture;z||(z=E.colorRampTexture=new f.Texture(D,E.colorRamp,M.RGBA)),z.bind(M.LINEAR,M.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(D,M.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,x.colorModeForRenderPass(),f.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")},E.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,E.paint,x.transform.zoom)}(g,h))},line:function(g,c,h,y){if("translucent"!==g.renderPass)return;const x=h.paint.get("line-opacity"),E=h.paint.get("line-width");if(0===x.constantOr(1)||0===E.constantOr(1))return;const D=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),M=g.colorModeForRenderPass(),P=g.terrain&&g.terrain.renderingToTexture?1:f.exported.devicePixelRatio,z=h.paint.get("line-dasharray"),B=z.constantOr(1),$=h.layout.get("line-cap"),X=h.paint.get("line-pattern"),ee=X.constantOr(1),te=h.paint.get("line-gradient"),ne=ee?"linePattern":"line",J=g.context,Y=J.gl,ce=(de=>{const xe=[];Rr(de)&&xe.push("RENDER_LINE_DASH"),de.paint.get("line-gradient")&&xe.push("RENDER_LINE_GRADIENT");const ye=de.paint.get("line-trim-offset");0===ye[0]&&0===ye[1]||xe.push("RENDER_LINE_TRIM_OFFSET");const Ce=de.paint.get("line-pattern").constantOr(1),Ae=1!==de.paint.get("line-opacity").constantOr(1);return!Ce&&Ae&&xe.push("RENDER_LINE_ALPHA_DISCARD"),xe})(h);let le=ce.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(le=!1);for(const de of y){const xe=c.getTile(de);if(ee&&!xe.patternsLoaded())continue;const ye=xe.getBucket(h);if(!ye)continue;g.prepareDrawTile();const Ce=ye.programConfigurations.get(h.id),Ae=g.useProgram(ne,Ce,ce),Ne=X.constantOr(null);if(Ne&&xe.imageAtlas){const Se=xe.imageAtlas.patternPositions[Ne.toString()];Se&&Ce.setConstantPatternPositions(Se)}const Ve=z.constantOr(null),yt=$.constantOr(null);if(!ee&&Ve&&yt&&xe.lineAtlas){const Se=xe.lineAtlas.getDash(Ve,yt);Se&&Ce.setConstantPatternPositions(Se)}let[Pe,et]=h.paint.get("line-trim-offset");("round"===yt||"square"===yt)&&Pe!==et&&(0===Pe&&(Pe-=1),1===et&&(et+=1));const We=g.terrain?de.projMatrix:null,ht=ee?vn(g,xe,h,We,P):su(g,xe,h,We,ye.lineClipsArray.length,P,[Pe,et]);if(te){const Se=ye.gradients[h.id];let He=Se.texture;if(h.gradientVersion!==Se.version){let ct=256;if(h.stepInterpolant){const ft=c.getSource().maxzoom,Yt=de.canonical.z===ft?Math.ceil(1<<g.transform.maxZoom-de.canonical.z):1;ct=f.clamp(f.nextPowerOfTwo(ye.maxLineLength/f.EXTENT*1024*Yt),256,J.maxTextureSize)}Se.gradient=f.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:ct,image:Se.gradient||void 0,clips:ye.lineClipsArray}),Se.texture?Se.texture.update(Se.gradient):Se.texture=new f.Texture(J,Se.gradient,Y.RGBA),Se.version=h.gradientVersion,He=Se.texture}J.activeTexture.set(Y.TEXTURE1),He.bind(h.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}B&&(J.activeTexture.set(Y.TEXTURE0),xe.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),Ce.updatePaintBuffers()),ee&&(J.activeTexture.set(Y.TEXTURE0),xe.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Ce.updatePaintBuffers()),g.prepareDrawProgram(J,Ae,de.toUnwrapped());const Ue=Se=>{Ae.draw(J,Y.TRIANGLES,D,Se,M,f.CullFaceMode.disabled,ht,h.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,h.paint,g.transform.zoom,Ce,[ye.layoutVertexBuffer2])};if(le){const Se=g.stencilModeForClipping(de).ref;0===Se&&g.terrain&&J.clear({stencil:0});const He={func:Y.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Ue(new f.StencilMode(He,Se,255,Y.KEEP,Y.KEEP,Y.INVERT)),ht.u_alpha_discard_threshold=0,Ue(new f.StencilMode(He,Se,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Ue(g.stencilModeForClipping(de))}le&&(g.resetStencilClippingMasks(),g.terrain&&J.clear({stencil:0}))},fill:function(g,c,h,y){const x=h.paint.get("fill-color"),E=h.paint.get("fill-opacity");if(0===E.constantOr(1))return;const D=g.colorModeForRenderPass(),M=h.paint.get("fill-pattern"),P=g.opaquePassEnabledForLayer()&&!M.constantOr(1)&&1===x.constantOr(f.Color.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(g.renderPass===P){const z=g.depthModeForSublayer(1,"opaque"===g.renderPass?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly);$n(g,c,h,y,z,D,!1)}if("translucent"===g.renderPass&&h.paint.get("fill-antialias")){const z=g.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,f.DepthMode.ReadOnly);$n(g,c,h,y,z,D,!0)}},"fill-extrusion":function(g,c,h,y){const x=h.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===g.renderPass){const E=new f.DepthMode(g.context.gl.LEQUAL,f.DepthMode.ReadWrite,g.depthRangeFor3D);if(1!==x||h.paint.get("fill-extrusion-pattern").constantOr(1))cu(g,c,h,y,E,f.StencilMode.disabled,f.ColorMode.disabled),cu(g,c,h,y,E,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const D=g.colorModeForRenderPass();cu(g,c,h,y,E,f.StencilMode.disabled,D)}}},hillshade:function(g,c,h,y){if("offscreen"!==g.renderPass&&"translucent"!==g.renderPass)return;const x=g.context,E=g.depthModeForSublayer(0,f.DepthMode.ReadOnly),D=g.colorModeForRenderPass(),M=g.terrain&&g.terrain.renderingToTexture,[P,z]="translucent"!==g.renderPass||M?[{},y]:g.stencilConfigForOverlap(y);for(const B of z){const $=c.getTile(B);if($.needsHillshadePrepare&&"offscreen"===g.renderPass)Pl(g,$,h,E,f.StencilMode.disabled,D);else if("translucent"===g.renderPass){const X=M&&g.terrain?g.terrain.stencilModeForRTTOverlap(B):P[B.overscaledZ];nu(g,B,$,h,E,X,D)}}x.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,c,h,y,x,E){if("translucent"!==g.renderPass||0===h.paint.get("raster-opacity")||!y.length)return;const D=g.context,M=D.gl,P=c.getSource(),z=g.useProgram("raster"),B=g.colorModeForRenderPass(),$=g.terrain&&g.terrain.renderingToTexture,[X,ee]=P instanceof Ee||$?[{},y]:g.stencilConfigForOverlap(y),te=ee[ee.length-1].overscaledZ,ne=!g.options.moving;for(const J of ee){const Y=$?f.DepthMode.disabled:g.depthModeForSublayer(J.overscaledZ-te,1===h.paint.get("raster-opacity")?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly,M.LESS),ce=J.toUnwrapped(),le=c.getTile(J);if($&&(!le||!le.hasData()))continue;const de=$?J.projMatrix:g.transform.calculateProjMatrix(ce,ne),xe=g.terrain&&$?g.terrain.stencilModeForRTTOverlap(J):X[J.overscaledZ],ye=E?0:h.paint.get("raster-fade-duration");le.registerFadeDuration(ye);const Ce=c.findLoadedParent(J,0),Ae=ru(le,Ce,c,g.transform,ye);let Ne,Ve;g.terrain&&g.terrain.prepareDrawTile();const yt="nearest"===h.paint.get("raster-resampling")?M.NEAREST:M.LINEAR;D.activeTexture.set(M.TEXTURE0),le.texture.bind(yt,M.CLAMP_TO_EDGE),D.activeTexture.set(M.TEXTURE1),Ce?(Ce.texture.bind(yt,M.CLAMP_TO_EDGE),Ne=Math.pow(2,Ce.tileID.overscaledZ-le.tileID.overscaledZ),Ve=[le.tileID.canonical.x*Ne%1,le.tileID.canonical.y*Ne%1]):le.texture.bind(yt,M.CLAMP_TO_EDGE),le.texture.useMipmap&&D.extTextureFilterAnisotropic&&g.transform.pitch>20&&M.texParameterf(M.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const Pe=yo(de,Ve||[0,0],Ne||1,Ae,h,P instanceof Ee?P.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(D,z,ce),P instanceof Ee)P.boundsBuffer&&P.boundsSegments&&z.draw(D,M.TRIANGLES,Y,f.StencilMode.disabled,B,f.CullFaceMode.disabled,Pe,h.id,P.boundsBuffer,g.quadTriangleIndexBuffer,P.boundsSegments);else{const{tileBoundsBuffer:et,tileBoundsIndexBuffer:We,tileBoundsSegments:ht}=g.getTileBoundsBuffers(le);z.draw(D,M.TRIANGLES,Y,xe,B,f.CullFaceMode.disabled,Pe,h.id,et,We,ht)}}g.resetStencilClippingMasks()},background:function(g,c,h,y){const x=h.paint.get("background-color"),E=h.paint.get("background-opacity");if(0===E)return;const D=g.context,M=D.gl,P=g.transform,z=P.tileSize,B=h.paint.get("background-pattern");if(g.isPatternMissing(B))return;const $=!B&&1===x.a&&1===E&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==$)return;const X=f.StencilMode.disabled,ee=g.depthModeForSublayer(0,"opaque"===$?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly),te=g.colorModeForRenderPass(),ne=g.useProgram(B?"backgroundPattern":"background");let J,Y=y;Y||(J=g.getBackgroundTiles(),Y=Object.values(J).map(ce=>ce.tileID)),B&&(D.activeTexture.set(M.TEXTURE0),g.imageManager.bind(g.context));for(const ce of Y){const le=ce.toUnwrapped(),de=y?ce.projMatrix:g.transform.calculateProjMatrix(le);g.prepareDrawTile();const xe=c?c.getTile(ce):J?J[ce.key]:new f.Tile(ce,z,P.zoom,g),ye=B?Wt(de,E,g,B,{tileID:ce,tileSize:z}):$s(de,E,x);g.prepareDrawProgram(D,ne,le);const{tileBoundsBuffer:Ce,tileBoundsIndexBuffer:Ae,tileBoundsSegments:Ne}=g.getTileBoundsBuffers(xe);ne.draw(D,M.TRIANGLES,ee,X,te,f.CullFaceMode.disabled,ye,h.id,Ce,Ae,Ne)}},sky:function(g,c,h){const y=g.transform,x="mercator"===y.projection.name||"globe"===y.projection.name?1:f.smoothstep(7,8,y.zoom),E=h.paint.get("sky-opacity")*x;if(0===E)return;const D=g.context,M=h.paint.get("sky-type"),P=new f.DepthMode(D.gl.LEQUAL,f.DepthMode.ReadOnly,[0,1]),z=g.frameCounter/1e3%1;"atmosphere"===M?"offscreen"===g.renderPass?h.needsSkyboxCapture(g)&&(function(B,$,X,ee){const te=B.context,ne=te.gl;let J=$.skyboxFbo;if(!J){J=$.skyboxFbo=te.createFramebuffer(32,32,!1),$.skyboxGeometry=new ro(te),$.skyboxTexture=te.gl.createTexture(),ne.bindTexture(ne.TEXTURE_CUBE_MAP,$.skyboxTexture),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_CUBE_MAP,ne.TEXTURE_MAG_FILTER,ne.LINEAR);for(let de=0;de<6;++de)ne.texImage2D(ne.TEXTURE_CUBE_MAP_POSITIVE_X+de,0,ne.RGBA,32,32,0,ne.RGBA,ne.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(J.framebuffer),te.viewport.set([0,0,32,32]);const Y=$.getCenter(B,!0),ce=B.useProgram("skyboxCapture"),le=new Float64Array(16);f.identity(le),f.rotateY(le,le,.5*-Math.PI),Cn(te,$,ce,le,Y,0),f.identity(le),f.rotateY(le,le,.5*Math.PI),Cn(te,$,ce,le,Y,1),f.identity(le),f.rotateX(le,le,.5*-Math.PI),Cn(te,$,ce,le,Y,2),f.identity(le),f.rotateX(le,le,.5*Math.PI),Cn(te,$,ce,le,Y,3),f.identity(le),Cn(te,$,ce,le,Y,4),f.identity(le),f.rotateY(le,le,Math.PI),Cn(te,$,ce,le,Y,5),te.viewport.set([0,0,B.width,B.height])}(g,h),h.markSkyboxValid(g)):"sky"===g.renderPass&&function(B,$,X,ee,te){const ne=B.context,J=ne.gl,Y=B.transform,ce=B.useProgram("skybox");ne.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_CUBE_MAP,$.skyboxTexture);const le={u_matrix:Y.skyboxMatrix,u_sun_direction:$.getCenter(B,!1),u_cubemap:0,u_opacity:ee,u_temporal_offset:te};B.prepareDrawProgram(ne,ce),ce.draw(ne,J.TRIANGLES,X,f.StencilMode.disabled,B.colorModeForRenderPass(),f.CullFaceMode.backCW,le,"skybox",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(g,h,P,E,z):"gradient"===M&&"sky"===g.renderPass&&function(B,$,X,ee,te){const ne=B.context,J=ne.gl,Y=B.transform,ce=B.useProgram("skyboxGradient");$.skyboxGeometry||($.skyboxGeometry=new ro(ne)),ne.activeTexture.set(J.TEXTURE0);let le=$.colorRampTexture;le||(le=$.colorRampTexture=new f.Texture(ne,$.colorRamp,J.RGBA)),le.bind(J.LINEAR,J.CLAMP_TO_EDGE);const de=(xe=Y.skyboxMatrix,ye=$.getCenter(B,!1),Ce=$.paint.get("sky-gradient-radius"),Ae=ee,Ne=te,{u_matrix:xe,u_color_ramp:0,u_center_direction:ye,u_radius:f.degToRad(Ce),u_opacity:Ae,u_temporal_offset:Ne});var xe,ye,Ce,Ae,Ne;B.prepareDrawProgram(ne,ce),ce.draw(ne,J.TRIANGLES,X,f.StencilMode.disabled,B.colorModeForRenderPass(),f.CullFaceMode.backCW,de,"skyboxGradient",$.skyboxGeometry.vertexBuffer,$.skyboxGeometry.indexBuffer,$.skyboxGeometry.segment)}(g,h,P,E,z)},debug:function(g,c,h){for(let y=0;y<h.length;y++)xs(g,c,h[y])},custom:function(g,c,h,y){const x=g.context,E=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||"offscreen"===g.renderPass)&&h.isLayerDraped()){if("offscreen"===g.renderPass){const D=E.prerender;if(D){if(g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),"globe"===g.transform.projection.name){const M=g.transform.pointMerc;D.call(E,x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(g.transform.zoom),[M.x,M.y],g.transform.pixelsPerMeterRatio)}else D.call(E,x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState()}}else if("translucent"===g.renderPass){if(g.terrain&&g.terrain.renderingToTexture){const M=E.renderToTile;if(M){const P=y[0].canonical,z=new f.MercatorCoordinate(P.x+y[0].wrap*(1<<P.z),P.y,P.z);x.setDepthMode(f.DepthMode.disabled),x.setStencilMode(f.StencilMode.disabled),x.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),M.call(E,x.gl,z),x.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),x.setColorMode(g.colorModeForRenderPass()),x.setStencilMode(f.StencilMode.disabled);const D="3d"===E.renderingMode?new f.DepthMode(g.context.gl.LEQUAL,f.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,f.DepthMode.ReadOnly);if(x.setDepthMode(D),"globe"===g.transform.projection.name){const M=g.transform.pointMerc;E.render(x.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(g.transform.zoom),[M.x,M.y],g.transform.pixelsPerMeterRatio)}else E.render(x.gl,g.transform.customLayerMatrix());x.setDirty(),g.setBaseState(),x.bindFramebuffer.set(null)}}else f.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Gr{constructor(c,h,y=!1){this.context=new oe(c,y),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=f.SourceCache.maxUnderzooming+f.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new dc,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,h){const y=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ys(this,c));const x=this._terrain;this.transform.elevation=y?x:null,x.update(c,this.transform,h)}_updateFog(c){const h=c.fog;if(!h||"globe"===this.transform.projection.name||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,x]=h.getFovAdjustedRange(this.transform._fov);if(y>x)return void(this.transform.fogCullDistSq=null);const E=y+.78*(x-y);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,h){if(this.width=c*f.exported.devicePixelRatio,this.height=h*f.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const c=this.context,h=new f.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(f.EXTENT,0),h.emplaceBack(0,f.EXTENT),h.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(h,f.posAttributes.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);const y=new f.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(f.EXTENT,0),y.emplaceBack(0,f.EXTENT),y.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=c.createVertexBuffer(y,f.posAttributes.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);const x=new f.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(x,f.posAttributes.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);const E=new f.StructArrayLayout4i8;E.emplaceBack(0,0,0,0),E.emplaceBack(f.EXTENT,0,f.EXTENT,0),E.emplaceBack(0,f.EXTENT,0,f.EXTENT),E.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(E,f.boundsAttributes.members),this.mercatorBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);const D=new f.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(D);const M=new f.StructArrayLayout1ui2;for(const z of[0,1,3,2,0])M.emplaceBack(z);this.debugIndexBuffer=c.createIndexBuffer(M),this.emptyTexture=new f.Texture(c,new f.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=f.create();const P=this.context.gl;this.stencilClearMode=new f.StencilMode({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(f.window.performance.now()),this.atmosphereBuffer=new vo(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,h=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,h.TRIANGLES,f.DepthMode.disabled,this.stencilClearMode,f.ColorMode.disabled,f.CullFaceMode.disabled,Vn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,h,y){if(!h||this.currentStencilSource===h.id||!c.isTileClipped()||!y||0===y.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const P of y)if(void 0===this._tileClippingMaskIDs[P.key]){M=!0;break}if(!M)return}this.currentStencilSource=h.id;const x=this.context,E=x.gl;this.nextStencilID+y.length>256&&this.clearStencil(),x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of y){const P=h.getTile(M),z=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:B,tileBoundsIndexBuffer:$,tileBoundsSegments:X}=this.getTileBoundsBuffers(P);D.draw(x,E.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:E.ALWAYS,mask:0},z,255,E.KEEP,E.KEEP,E.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Vn(M.projMatrix),"$clipping",B,$,X)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,h=this.context.gl;return new f.StencilMode({func:h.NOTEQUAL,mask:255},c,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const h=this.context.gl;return new f.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(c){const h=this.context.gl,y=c.sort((D,M)=>M.overscaledZ-D.overscaledZ),x=y[y.length-1].overscaledZ,E=y[0].overscaledZ-x+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const D={};for(let M=0;M<E;M++)D[M+x]=new f.StencilMode({func:h.GEQUAL,mask:255},M+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=E,[D,y]}return[{[x]:f.StencilMode.disabled},y]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new f.ColorMode([c.CONSTANT_COLOR,c.ONE],new f.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?f.ColorMode.unblended:f.ColorMode.alphaBlended}depthModeForSublayer(c,h,y){if(!this.opaquePassEnabledForLayer())return f.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new f.DepthMode(y||this.context.gl.LEQUAL,h,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,h){this.style=c,this.options=h,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(f.exported.now()),this.imageManager.beginFrame();const y=this.style.order,x=this.style._sourceCaches;for(const z in x){const B=x[z];B.used&&B.prepare(this.context)}const E={},D={},M={};for(const z in x){const B=x[z];E[z]=B.getVisibleCoordinates(),D[z]=E[z].slice().reverse(),M[z]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<y.length;z++)if(this.style._layers[y[z]].is3D()){this.opaquePassCutoff=z;break}if(this.terrain&&(this.terrain.updateTileBinding(M),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new f.GlobeSharedBuffers(this.context)),!f.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const z of y){const B=this.style._layers[z],$=c._getLayerSourceCache(B);if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const X=$?D[$.id]:void 0;("custom"===B.type||B.isSky()||X&&X.length)&&this.renderLayer(this,$,B,X)}this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon];const P=this.terrain;if(P&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&P.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[y[this.currentLayer]],B=c._getLayerSourceCache(z);if(z.isSky())continue;const $=B?D[B.id]:void 0;this._renderTileClippingMasks(z,B,$),this.renderLayer(this,B,z,$)}if(this.style.fog&&this.transform.projection.supportsFog&&function(z,B){const $=z.context,X=$.gl,ee=z.transform,te=new f.DepthMode(X.LEQUAL,f.DepthMode.ReadOnly,[0,1]),ne=z.useProgram("globeAtmosphere",null,"globe"===ee.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),J=f.globeToMercatorTransition(ee.zoom),Y=B.properties.get("color").toArray01(),ce=B.properties.get("high-color").toArray01(),le=B.properties.get("space-color").toArray01PremultipliedAlpha(),de=f.identity$1([]);f.rotateY$1(de,de,-f.degToRad(ee._center.lng)),f.rotateX$1(de,de,f.degToRad(ee._center.lat)),f.rotateZ$1(de,de,ee.angle),f.rotateX$1(de,de,-ee._pitch);const xe=f.fromQuat(new Float32Array(16),de),ye=f.mapValue(B.properties.get("star-intensity"),0,1,0,.25),Ae=f.mapValue(B.properties.get("horizon-blend"),0,1,5e-4,.25),Ne=f.globeUseCustomAntiAliasing(z,$,ee)&&5e-4===Ae?ee.worldSize/(2*Math.PI*1.025)-1:ee.globeRadius,Ve=z.frameCounter/1e3%1,yt=f.length(ee.globeCenterInViewSpace),Pe=Math.sqrt(Math.pow(yt,2)-Math.pow(Ne,2)),et=Math.acos(Pe/yt),We={u_frustum_tl:ee.frustumCorners.TL,u_frustum_tr:ee.frustumCorners.TR,u_frustum_br:ee.frustumCorners.BR,u_frustum_bl:ee.frustumCorners.BL,u_horizon:ee.frustumCorners.horizon,u_transition:J,u_fadeout_range:Ae,u_color:Y,u_high_color:ce,u_space_color:le,u_star_intensity:ye,u_star_size:5*f.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Ve,u_horizon_angle:et,u_rotation_matrix:xe};z.prepareDrawProgram($,ne);const ht=z.atmosphereBuffer;ht&&ne.draw($,X.TRIANGLES,te,f.StencilMode.disabled,f.ColorMode.alphaBlended,f.CullFaceMode.backCW,We,"skybox",ht.vertexBuffer,ht.indexBuffer,ht.segments)}(this,this.style.fog),this.renderPass="sky",(f.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const z=this.style._layers[y[this.currentLayer]],B=c._getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,B,z,B?D[B.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const z=this.style._layers[y[this.currentLayer]],B=c._getLayerSourceCache(z);if(z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const $=B?("symbol"===z.type?M:D)[B.id]:void 0;this._renderTileClippingMasks(z,B,B?E[B.id]:void 0),this.renderLayer(this,B,z,$),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;f.values(this.style._layers).forEach(B=>{const $=c._getLayerSourceCache(B);$&&!B.isHidden(this.transform.zoom)&&(!z||z.getSource().maxzoom<$.getSource().maxzoom)&&(z=$)}),z&&this.options.showTileBoundaries&&Hh.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const B=z.transform.padding;ws(z,z.transform.height-(B.top||0),3,Ju),ws(z,B.bottom||0,3,Oo),zl(z,B.left||0,3,zr),zl(z,z.transform.width-(B.right||0),3,bc);const $=z.transform.centerPoint;var X,ee,te,ne;Ri(X=z,(ee=$.x)-1,(te=z.transform.height-$.y)-10,2,20,ne=Xa),Ri(X,ee-10,te-1,20,2,ne)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(f.window.performance.now()),this.saveCanvasCopy())}renderLayer(c,h,y,x){y.isHidden(this.transform.zoom)||("background"===y.type||"sky"===y.type||"custom"===y.type||x&&x.length)&&(this.id=y.id,this.gpuTimingStart(y),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(y.type)||c.terrain&&"custom"===y.type)&&Hh[y.type](c,h,y,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let y=this.gpuTimers[c.id];y||(y=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),y.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,h=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),c.beginQueryEXT(c.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const h={};for(const y in c){const x=c[y],E=this.context.extTimerQuery,D=E.getQueryObjectEXT(x.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(x.query),h[y]=D}return h}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let y=0;for(const x of c)y+=h.getQueryObjectEXT(x,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(x);return y}translatePosMatrix(c,h,y,x,E){if(!y[0]&&!y[1])return c;const D=E?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(D){const z=Math.sin(D),B=Math.cos(D);y=[y[0]*B-y[1]*z,y[0]*z+y[1]*B]}const M=[E?y[0]:us(h,y[0],this.transform.zoom),E?y[1]:us(h,y[1],this.transform.zoom),0],P=new Float32Array(16);return f.translate(P,c,M),P}saveTileTexture(c){const h=this._tileTextures[c.size[0]];h?h.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const h=this._tileTextures[c];return h&&h.length>0?h.pop():null}isPatternMissing(c){return null===c||void 0!==c&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&0===this.terrain.exaggeration(),y=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),"globe"===this.transform.projection.name&&x.push("GLOBE"),h&&x.push("ZERO_EXAGGERATION"),y&&!c&&0!==y.getOpacity(this.transform.pitch)&&x.push("FOG"),c&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(c,h,y){this.cache=this.cache||{};const x=y||[],E=this.currentGlobalDefines().concat(x),D=Xo.cacheKey(Uh[c],c,E,h);return this.cache[D]||(this.cache[D]=new Xo(this.context,c,Uh[c],h,jn[c],E)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,h,y){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const E=x.getOpacity(this.transform.pitch),D=((M,P,z,B,$,X,ee,te,ne,J,Y)=>{const ce=M.transform,le=P.properties.get("color").toArray01();le[3]=B;const de=M.frameCounter/1e3%1;return{u_fog_matrix:z?ce.calculateFogTileMatrix(z):M.identityMat,u_fog_range:P.getFovAdjustedRange(ce._fov),u_fog_color:le,u_fog_horizon_blend:P.properties.get("horizon-blend"),u_fog_temporal_offset:de,u_frustum_tl:$,u_frustum_tr:X,u_frustum_br:ee,u_frustum_bl:te,u_globe_pos:ne,u_globe_radius:J,u_viewport:Y,u_globe_transition:f.globeToMercatorTransition(ce.zoom),u_is_globe:+("globe"===ce.projection.name)}})(this,x,y,E,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*f.exported.devicePixelRatio,this.transform.height*f.exported.devicePixelRatio]);h.setFogUniformValues(c,D)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,h=c.createTexture();return c.bindTexture(c.TEXTURE_2D,h),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&0!==c.getOpacity(this.transform.pitch)}getBackgroundTiles(){const c=this._backgroundTiles,h=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const x of y)h[x.key]=c[x.key]||new f.Tile(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Qo{constructor(c=0,h=0,y=0,x=0){if(isNaN(c)||c<0||isNaN(h)||h<0||isNaN(y)||y<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=h,this.left=y,this.right=x}interpolate(c,h,y){return null!=h.top&&null!=c.top&&(this.top=f.number(c.top,h.top,y)),null!=h.bottom&&null!=c.bottom&&(this.bottom=f.number(c.bottom,h.bottom,y)),null!=h.left&&null!=c.left&&(this.left=f.number(c.left,h.left,y)),null!=h.right&&null!=c.right&&(this.right=f.number(c.right,h.right,y)),this}getCenter(c,h){const y=f.clamp((this.left+c-this.right)/2,0,c),x=f.clamp((this.top+h-this.bottom)/2,0,h);return new f.pointGeometry(y,x)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Qo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ed(g,c){const h=f.getColumn(g,3);f.fromQuat(g,c),f.setColumn(g,3,h)}function Ja(g,c){const h=f.identity$1([]);return f.rotateZ$1(h,h,-c),f.rotateX$1(h,h,-g),h}function el(g,c){const h=[g[0],g[1],0],y=[c[0],c[1],0];if(f.length(h)>=1e-15){const D=f.normalize([],h);f.scale$2(y,D,f.dot(y,D)),c[0]=y[0],c[1]=y[1]}const x=f.cross([],c,g);if(f.len(x)<1e-15)return null;const E=Math.atan2(-x[1],x[0]);return Ja(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),E)}class O{constructor(c,h){this.position=c,this.orientation=h}get position(){return this._position}set position(c){if(c){const h=c instanceof f.MercatorCoordinate?c:new f.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(h.x=f.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(c,h){if(this.orientation=null,!this.position)return;const y=this.position,x=this._elevation?this._elevation.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(c)):0,E=f.MercatorCoordinate.fromLngLat(c,x),D=[E.x-y.x,E.y-y.y,E.z-y.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=el(D,h)}setPitchBearing(c,h){this.orientation=Ja(f.degToRad(c),f.degToRad(-h))}}class L{constructor(c,h){this._transform=f.identity([]),this.orientation=h,this.position=c}get mercatorPosition(){const c=this.position;return new f.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=f.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var h;c&&f.setColumn(this._transform,3,[(h=c)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||f.identity$1([]),c&&ed(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,h){this._orientation=Ja(c,h),ed(this._transform,this._orientation)}forward(){const c=f.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=f.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=f.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,h){const y=new Float64Array(16);return f.invert(y,this.getWorldToCamera(c,h)),y}getWorldToCameraPosition(c,h,y){const x=this.position;f.scale$2(x,x,-c);const E=new Float64Array(16);return f.fromScaling(E,[y,y,y]),f.translate(E,E,x),E[10]*=h,E}getWorldToCamera(c,h){const y=new Float64Array(16),x=new Float64Array(4),E=this.position;return f.conjugate(x,this._orientation),f.scale$2(E,E,-c),f.fromQuat(y,x),f.translate(y,y,E),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=h,y[9]*=h,y[10]*=h,y[11]*=h,y}getCameraToClipPerspective(c,h,y,x){const E=new Float64Array(16);return f.perspective(E,c,h,y,x),E}getDistanceToElevation(c,h=!1){const y=0===c?0:f.mercatorZfromAltitude(c,h?f.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(y-this.position[2])/x[2]}clone(){return new L([...this.position],[...this.orientation])}}function q(g,c){const h=Je(g.projection,g.zoom,g.width,g.height),y=function(E,D,M,P,z){const B=new f.LngLat(M.lng-180*an,M.lat),$=new f.LngLat(M.lng+180*an,M.lat),X=E.project(B.lng,B.lat),ee=E.project($.lng,$.lat),te=-Math.atan2(ee.y-X.y,ee.x-X.x),ne=f.MercatorCoordinate.fromLngLat(M);ne.y=f.clamp(ne.y,-.999975,.999975);const J=ne.toLngLat(),Y=E.project(J.lng,J.lat),ce=f.MercatorCoordinate.fromLngLat(J);ce.x+=an;const le=ce.toLngLat(),de=E.project(le.lng,le.lat),xe=oo(de.x-Y.x,de.y-Y.y,te),ye=f.MercatorCoordinate.fromLngLat(J);ye.y+=an;const Ce=ye.toLngLat(),Ae=E.project(Ce.lng,Ce.lat),Ne=oo(Ae.x-Y.x,Ae.y-Y.y,te),Ve=Math.abs(xe.x)/Math.abs(Ne.y),yt=f.identity([]);f.rotateZ(yt,yt,-te*(1-(z?0:P)));const Pe=f.identity([]);return f.scale(Pe,Pe,[1,1-(1-Ve)*P,1]),Pe[4]=-Ne.x/Ne.y*P,f.rotateZ(Pe,Pe,te),f.multiply(Pe,yt,Pe),Pe}(g.projection,0,g.center,h,c),x=_e(g);return f.scale(y,y,[x,x,1]),y}function _e(g){const c=g.projection,h=Je(g.projection,g.zoom,g.width,g.height),y=Fi(c,g.center),x=Fi(c,f.LngLat.convert(c.center));return Math.pow(2,y*h+(1-h)*x)}function Je(g,c,h,y,x=1/0){const E=g.range;if(!E)return 0;const D=Math.min(x,Math.max(h,y)),M=Math.log(D/1024)/Math.LN2;return f.smoothstep(E[0]+M,E[1]+M,c)}const an=1/4e4;function Fi(g,c){const h=f.clamp(c.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),y=new f.LngLat(c.lng-180*an,h),x=new f.LngLat(c.lng+180*an,h),E=g.project(y.lng,h),D=g.project(x.lng,h),M=f.MercatorCoordinate.fromLngLat(y),P=f.MercatorCoordinate.fromLngLat(x),z=D.x-E.x,B=D.y-E.y,$=P.x-M.x,X=P.y-M.y,ee=Math.sqrt(($*$+X*X)/(z*z+B*B));return Math.log(ee)/Math.LN2}function oo(g,c,h){const y=Math.cos(h),x=Math.sin(h);return{x:g*y-c*x,y:g*x+c*y}}class bt{constructor(c,h,y,x,E,D,M){this.tileSize=512,this._renderWorldCopies=void 0===E||E,this._minZoom=c||0,this._maxZoom=h||22,this._minPitch=y??0,this._maxPitch=x??60,this.setProjection(D),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Qo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new L,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new bt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,h=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||y)&&this._updateCameraOnTerrain(),(c||y)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return f.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=f.getProjection(this.projectionOptions);const y=!ze(h,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=f.getProjection({name:"mercator"});const h=c!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(c){void 0===c?c=!0:null===c&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return f.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new f.pointGeometry(this.width,this.height)}get bearing(){return f.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const h=-c*Math.PI/180;var y,x,E,D,M,P,z,B,$,X;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(y=new f.ARRAY_TYPE(4),f.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),x=this.rotationMatrix,D=this.angle,M=(E=this.rotationMatrix)[0],P=E[1],z=E[2],B=E[3],$=Math.sin(D),X=Math.cos(D),x[0]=M*X+z*$,x[1]=P*X+B*$,x[2]=M*-$+z*X,x[3]=P*-$+B*X)}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const h=f.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=f.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const h=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let x=0,E=0;for(let D=0;D<h.length;D++){const M=new f.pointGeometry(h[D][0]*this.width,y+h[D][1]*(this.height-y)),P=c.pointCoordinate(M);if(!P)continue;const z=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);x+=P[3]*z,E+=z}return 0===E?NaN:x/E}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const c=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(c),E=this._mercatorZfromZoom(this._maxZoom),D=Math.max(x-y,E);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let y;y=c.z<this._camera.position[2]?[h.x,h.y,h.z]:[c.x,c.y,c.z];const x=f.length(f.sub([],this._camera.position,y));return f.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let h=!1;if(c.orientation&&!f.exactEquals(c.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(c.orientation)),c.position){const y=[c.position.x,c.position.y,c.position.z];f.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,h=new O;return h.position=new f.MercatorCoordinate(c[0],c[1],c[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(c){if(!f.length$1(c))return!1;f.normalize$1(c,c);const h=f.transformQuat([],[0,0,-1],c),y=f.transformQuat([],[0,-1,0],c);if(y[2]<0)return!1;const x=el(h,y);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(c){const h=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;c[2]=f.clamp(c[2],x/y,x/h),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,h,y){this._unmodified=!1,this._edgeInsets.interpolate(c,h,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const h=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(c){const h=[new f.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const y=this.pointCoordinate(new f.pointGeometry(0,0)),x=this.pointCoordinate(new f.pointGeometry(this.width,0)),E=this.pointCoordinate(new f.pointGeometry(this.width,this.height)),D=this.pointCoordinate(new f.pointGeometry(0,this.height)),M=Math.floor(Math.min(y.x,x.x,E.x,D.x)),P=Math.floor(Math.max(y.x,x.x,E.x,D.x)),z=1;for(let B=M-z;B<=P+z;B++)0!==B&&h.push(new f.UnwrappedTileID(B,c))}return h}coveringTiles(c){let h=this.coveringZoomLevel(c);const y=h,x=this.elevation&&!c.isTerrainDEM,E="mercator"===this.projection.name;if(void 0!==c.minzoom&&h<c.minzoom)return[];void 0!==c.maxzoom&&h>c.maxzoom&&(h=c.maxzoom);const D=this.locationCoordinate(this.center),M=this.center.lat,P=1<<h,z=[P*D.x,P*D.y,0],B="globe"===this.projection.name,$=!B,X=f.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,$),ee=B?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),te=P*f.mercatorZfromAltitude(1,this.center.lat),ne=this._camera.position[2]/f.mercatorZfromAltitude(1,this.center.lat),J=[P*ee.x,P*ee.y,ne*($?1:te)],Y=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),ce=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,le=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,de=c.isTerrainDEM?-le:this._elevation?this._elevation.getMinElevationBelowMSL():0,xe=this.projection.isReprojectedInTileSpace?_e(this):1,ye=Ue=>{const He=new f.MercatorCoordinate(Ue.x+25e-6,Ue.y,Ue.z),ct=new f.MercatorCoordinate(Ue.x,Ue.y+25e-6,Ue.z),ft=Ue.toLngLat(),Yt=He.toLngLat(),On=ct.toLngLat(),Ft=this.locationCoordinate(ft),kt=this.locationCoordinate(Yt),Kt=this.locationCoordinate(On),Rn=Math.hypot(kt.x-Ft.x,kt.y-Ft.y),Jt=Math.hypot(Kt.x-Ft.x,Kt.y-Ft.y);return Math.sqrt(Rn*Jt)*xe/25e-6},Ce=Ue=>{const Se=le,He=de;return{aabb:f.tileAABB(this,P,0,0,0,Ue,He,Se,this.projection),zoom:0,x:0,y:0,minZ:He,maxZ:Se,wrap:Ue,fullyVisible:!1}},Ae=[];let Ne=[];const Ve=h,yt=c.reparseOverscaled?y:h,Pe=Ue=>Ue*Ue,et=Pe((ne-this._centerAltitude)*te),We=Ue=>{if(!this._elevation||!Ue.tileID||!E)return;const Se=this._elevation.getMinMaxForTile(Ue.tileID),He=Ue.aabb;Se?(He.min[2]=Se.min,He.max[2]=Se.max,He.center[2]=(He.min[2]+He.max[2])/2):(Ue.shouldSplit=ht(Ue),Ue.shouldSplit||(He.min[2]=He.max[2]=He.center[2]=this._centerAltitude))},ht=Ue=>{if(Ue.zoom<ce)return!0;if(Ue.zoom===Ve)return!1;if(null!=Ue.shouldSplit)return Ue.shouldSplit;const Se=Ue.aabb.distanceX(J),He=Ue.aabb.distanceY(J);let ct=et,ft=1;if(B){ct=Pe(Ue.aabb.distanceZ(J));const Ft=Math.pow(2,Ue.zoom),kt=f.latFromMercatorY((Ue.y+1)/Ft),Kt=f.latFromMercatorY(Ue.y/Ft),Rn=Math.min(Math.max(M,kt),Kt),Jt=f.circumferenceAtLatitude(Rn)/f.circumferenceAtLatitude(M);if(ft=Rn===M?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Jt/this._mercatorScaleRatio),this.zoom<=f.GLOBE_ZOOM_THRESHOLD_MIN&&Ue.zoom===Ve-1&&Jt>=.9)return!0}else if(x&&(ct=Pe(Ue.aabb.distanceZ(J)*te)),this.projection.isReprojectedInTileSpace&&y<=5){const Ft=Math.pow(2,Ue.zoom),kt=ye(new f.MercatorCoordinate((Ue.x+.5)/Ft,(Ue.y+.5)/Ft));ft=kt>.85?1:kt}const Yt=Se*Se+He*He+ct;return Yt<Pe((1<<Ve-Ue.zoom)*Y*ft*((Ft,kt)=>{if(kt*Pe(.707)<Ft)return 1;const Kt=Math.sqrt(kt/Ft);return Kt/(1.4144271570014144+(Math.pow(1.1,Kt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ct,et),Yt))};if(this.renderWorldCopies)for(let Ue=1;Ue<=3;Ue++)Ae.push(Ce(-Ue)),Ae.push(Ce(Ue));for(Ae.push(Ce(0));Ae.length>0;){const Ue=Ae.pop(),Se=Ue.x,He=Ue.y;let ct=Ue.fullyVisible;if(!ct){const ft=Ue.aabb.intersects(X);if(0===ft)continue;ct=2===ft}if(Ue.zoom!==Ve&&ht(Ue))for(let ft=0;ft<4;ft++){const Yt=(Se<<1)+ft%2,On=(He<<1)+(ft>>1),Ft={aabb:E?Ue.aabb.quadrant(ft):f.tileAABB(this,P,Ue.zoom+1,Yt,On,Ue.wrap,Ue.minZ,Ue.maxZ,this.projection),zoom:Ue.zoom+1,x:Yt,y:On,wrap:Ue.wrap,fullyVisible:ct,tileID:void 0,shouldSplit:void 0,minZ:Ue.minZ,maxZ:Ue.maxZ};x&&!B&&(Ft.tileID=new f.OverscaledTileID(Ue.zoom+1===Ve?yt:Ue.zoom+1,Ue.wrap,Ue.zoom+1,Yt,On),We(Ft)),Ae.push(Ft)}else{const ft=Ue.zoom===Ve?yt:Ue.zoom;if(c.minzoom&&c.minzoom>ft)continue;const Yt=z[0]-(.5+Se+(Ue.wrap<<Ue.zoom))*(1<<h-Ue.zoom),On=z[1]-.5-He,Ft=Ue.tileID?Ue.tileID:new f.OverscaledTileID(ft,Ue.wrap,Ue.zoom,Se,He);Ne.push({tileID:Ft,distanceSq:Yt*Yt+On*On})}}if(this.fogCullDistSq){const Ue=this.fogCullDistSq,Se=this.horizonLineFromTop();Ne=Ne.filter(He=>{const ct=[0,0,0,1],ft=[f.EXTENT,f.EXTENT,0,1],Yt=this.calculateFogTileMatrix(He.tileID.toUnwrapped());f.transformMat4$1(ct,ct,Yt),f.transformMat4$1(ft,ft,Yt);const On=f.getAABBPointSquareDist(ct,ft);if(0===On)return!0;let Ft=!1;const kt=this._elevation;if(kt&&On>Ue&&0!==Se){const Kt=this.calculateProjMatrix(He.tileID.toUnwrapped());let Rn;c.isTerrainDEM||(Rn=kt.getMinMaxForTile(He.tileID)),Rn||(Rn={min:de,max:le});const Jt=f.furthestTileCorner(this.rotation),_i=[Jt[0]*f.EXTENT,Jt[1]*f.EXTENT,Rn.max];f.transformMat4(_i,_i,Kt),Ft=(1-_i[1])*this.height*.5<Se}return On<Ue||Ft})}return Ne.sort((Ue,Se)=>Ue.distanceSq-Se.distanceSq).map(Ue=>Ue.tileID)}resize(c,h){this.width=c,this.height=h,this.pixelsToGLUnits=[2/c,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const h=f.clamp(c.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),y=this.projection.project(c.lng,h);return new f.pointGeometry(y.x*this.worldSize,y.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/f.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,h){let y,x;const E=this.centerPoint;if("globe"===this.projection.name){const M=this.worldSize;y=(h.x-E.x)/M,x=(h.y-E.y)/M}else{const M=this.pointCoordinate(h),P=this.pointCoordinate(E);y=M.x-P.x,x=M.y-P.y}const D=this.locationCoordinate(c);this.setLocation(new f.MercatorCoordinate(D.x-y,D.y-x))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,h){const y=h?f.mercatorZfromAltitude(h,c.lat):void 0,x=this.projection.project(c.lng,c.lat);return new f.MercatorCoordinate(x.x,x.y,y)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,h){const y=h??this._centerAltitude,x=[c.x,c.y,0,1],E=[c.x,c.y,1,1];f.transformMat4$1(x,x,this.pixelMatrixInverse),f.transformMat4$1(E,E,this.pixelMatrixInverse);const D=E[3];f.scale$1(x,x,1/x[3]),f.scale$1(E,E,1/D);const M=x[2],P=E[2];return{p0:x,p1:E,t:M===P?0:(y-M)/(P-M)}}screenPointToMercatorRay(c){const h=[c.x,c.y,0,1],y=[c.x,c.y,1,1];return f.transformMat4$1(h,h,this.pixelMatrixInverse),f.transformMat4$1(y,y,this.pixelMatrixInverse),f.scale$1(h,h,1/h[3]),f.scale$1(y,y,1/y[3]),h[2]=f.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,y[2]=f.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,f.scale$1(h,h,1/this.worldSize),f.scale$1(y,y,1/this.worldSize),new f.Ray([h[0],h[1],h[2]],f.normalize([],f.sub([],y,h)))}rayIntersectionCoordinate(c){const{p0:h,p1:y,t:x}=c,E=f.mercatorZfromAltitude(h[2],this._center.lat),D=f.mercatorZfromAltitude(y[2],this._center.lat);return new f.MercatorCoordinate(f.number(h[0],y[0],x)/this.worldSize,f.number(h[1],y[1],x)/this.worldSize,f.number(E,D,x))}pointCoordinate(c,h=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,h)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let h=this.projection.pointCoordinate3D(this,c.x,c.y);if(h)return new f.MercatorCoordinate(h[0],h[1],h[2]);let y=0,x=this.horizonLineFromTop();if(c.y>x)return this.pointCoordinate(c);const E=.02*x,D=c.clone();for(let M=0;M<10&&x-y>E;M++){D.y=f.number(y,x,.66);const P=this.projection.pointCoordinate3D(this,D.x,D.y);P?(x=D.y,h=P):y=D.y}return h?new f.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}_coordinatePoint(c,h){const y=h&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,x=[c.x*this.worldSize,c.y*this.worldSize,y+c.toAltitude(),1];return f.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new f.pointGeometry(x[0]/x[3],x[1]/x[3]):new f.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:h}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,E=this.pointLocation3D(new f.pointGeometry(h,c)),D=this.pointLocation3D(new f.pointGeometry(x,c)),M=this.pointLocation3D(new f.pointGeometry(x,y)),P=this.pointLocation3D(new f.pointGeometry(h,y));let z=Math.min(E.lng,D.lng,M.lng,P.lng),B=Math.max(E.lng,D.lng,M.lng,P.lng),$=Math.min(E.lat,D.lat,M.lat,P.lat),X=Math.max(E.lat,D.lat,M.lat,P.lat);const ee=Math.pow(2,-this.zoom)/16*270,te="globe"===this.projection.name?1:4,ne=(J,Y,ce,le,de)=>{const xe=(J+ce)/2,ye=(Y+le)/2,Ce=new f.pointGeometry(xe,ye),{lng:Ae,lat:Ne}=this.pointLocation3D(Ce),Ve=Math.max(0,z-Ae,$-Ne,Ae-B,Ne-X);z=Math.min(z,Ae),B=Math.max(B,Ae),$=Math.min($,Ne),X=Math.max(X,Ne),(de<te||Ve>ee)&&(ne(J,Y,xe,ye,de+1),ne(xe,ye,ce,le,de+1))};if(ne(h,c,x,c,1),ne(x,c,x,y,1),ne(x,y,h,y,1),ne(h,y,h,c,1),"globe"===this.projection.name){const[J,Y]=f.polesInViewport(this);J?(X=90,B=180,z=-180):Y&&($=-90,B=180,z=-180)}return new f.LngLatBounds(new f.LngLat(z,$),new f.LngLat(B,X))}_getBoundsRectangular(c,h){const{top:y,left:x}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,D=this.width-this._edgeInsets.right,M=new f.pointGeometry(x,y),P=new f.pointGeometry(D,y),z=new f.pointGeometry(D,E),B=new f.pointGeometry(x,E);let $=this.pointCoordinate(M,c),X=this.pointCoordinate(P,c);const ee=this.pointCoordinate(z,h),te=this.pointCoordinate(B,h),ne=(J,Y)=>(Y.y-J.y)/(Y.x-J.x);return $.y>1&&X.y>=0?$=new f.MercatorCoordinate((1-te.y)/ne(te,$)+te.x,1):$.y<0&&X.y<=1&&($=new f.MercatorCoordinate(-te.y/ne(te,$)+te.x,0)),X.y>1&&$.y>=0?X=new f.MercatorCoordinate((1-ee.y)/ne(ee,X)+ee.x,1):X.y<0&&$.y<=1&&(X=new f.MercatorCoordinate(-ee.y/ne(ee,X)+ee.x,0)),(new f.LngLatBounds).extend(this.coordinateLocation($)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(ee))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=c.visibleDemTiles.reduce((y,x)=>{if(x.dem){const E=x.dem.tree;y.min=Math.min(y.min,E.minimums[0]),y.max=Math.max(y.max,E.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*c.exaggeration(),h.max*c.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-h*(1-this._horizonShift);return c?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-f.MAX_MERCATOR_LATITUDE,this.maxLat=f.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=f.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=f.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=f.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=f.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,h){return this.projection.createTileMatrix(this,h,c)}calculateDistanceTileData(c){const h=c.key,y=this._distanceTileDataCache;if(y[h])return y[h];const x=c.canonical,E=1/this.height,D=this.cameraWorldSize,M=D/this.zoomScale(x.z),P=(x.x+Math.pow(2,x.z)*c.wrap)*M,z=x.y*M,B=this.point;B.x*=D/this.worldSize,B.y*=D/this.worldSize;const $=this.angle,X=Math.sin(-$),ee=-Math.cos(-$);return y[h]={bearing:[X,ee],center:[(B.x-P)*E,(B.y-z)*E],scale:M/f.EXTENT*E},y[h]}calculateFogTileMatrix(c){const h=c.key,y=this._fogTileMatrixCache;if(y[h])return y[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return f.multiply(x,this.worldToFogMatrix,x),y[h]=new Float32Array(x),y[h]}calculateProjMatrix(c,h=!1){const y=c.key,x=h?this._alignedProjMatrixCache:this._projMatrixCache;if(x[y])return x[y];const E=this.calculatePosMatrix(c,this.worldSize);return f.multiply(E,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,E),x[y]=new Float32Array(E),x[y]}calculatePixelsToTileUnitsMatrix(c){const h=c.tileID.key,y=this._pixelsToTileUnitsCache;if(y[h])return y[h];const x=function(E,D){const{scale:M}=E.tileTransform,P=M*f.EXTENT/(E.tileSize*Math.pow(2,D.zoom-E.tileID.overscaledZ+E.tileID.canonical.z));return z=new Float32Array(4),X=(B=D.inverseAdjustmentMatrix)[1],ee=B[2],te=B[3],J=($=[P,P])[1],z[0]=B[0]*(ne=$[0]),z[1]=X*ne,z[2]=ee*J,z[3]=te*J,z;var z,B,$,X,ee,te,ne,J}(c,this);return y[h]=x,y[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const c=1/this.worldSize,h=f.fromScaling([],[c,c,c]);return f.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const c=this._elevation;this._updateCameraState();const h=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(h),x=this._camera.forward(),E=f.mercatorZfromAltitude(1,this._center.lat);y[2]/=E,x[2]/=E,f.normalize(x,x);const D=c.raycast(y,x,c.exaggeration());if(D){const M=f.scaleAndAdd([],y,x,D),P=new f.MercatorCoordinate(M[0],M[1],f.mercatorZfromAltitude(M[2],f.latFromMercatorY(M[1]))),z=(P.z+f.length([P.x-y[0],P.y-y[1],P.z-y[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(z),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const h=this._elevation,y=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(y),E=h.getAtPointOrZero(new f.MercatorCoordinate(...x)),D=this.pixelsPerMeter/this.worldSize*E,M=this._minimumHeightOverTerrain(),P=x[2]-D;if(P<=M)if(P<0||c){const z=this.locationCoordinate(this._center,this._centerAltitude),B=[x[0],x[1],z.z-x[2]],$=f.length(B);B[2]-=(M-P)/this._pixelsPerMercatorPixel;const X=f.length(B);if(0===X)return;f.scale$2(B,B,$/X*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],z.z*this._pixelsPerMercatorPixel-B[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const X=this.center;return X.lat=f.clamp(X.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(X.lng=f.clamp(X.lng,this.minLng,this.maxLng)),this.center=X,void(this._constraining=!1)}const h=this._unmodified,{x:y,y:x}=this.point;let E=0,D=y,M=x;const P=this.width/2,z=this.height/2,B=this.worldMinY*this.scale,$=this.worldMaxY*this.scale;if(x-z<B&&(M=B+z),x+z>$&&(M=$-z),$-B<this.height&&(E=Math.max(E,this.height/($-B)),M=($+B)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const X=this.worldMinX*this.scale,ee=this.worldMaxX*this.scale,te=this.worldSize/2-(X+ee)/2;D=(y+te+this.worldSize)%this.worldSize-te,D-P<X&&(D=X+P),D+P>ee&&(D=ee-P),ee-X<this.width&&(E=Math.max(E,this.width/(ee-X)),D=(ee+X)/2)}D===y&&M===x||(this.center=this.unproject(new f.pointGeometry(D,M))),E&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,h=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=f.mercatorZfromAltitude(1,this.center.lat)/f.mercatorZfromAltitude(1,f.GLOBE_SCALE_MATCH_LATITUDE));const y=Je(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x="meters"===this.projection.zAxisUnit?h:1,E=this._camera.getWorldToCamera(this.worldSize,x),D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);D[8]=2*-c.x/this.width,D[9]=2*c.y/this.height;let M=f.mul([],D,E);if(this.projection.isReprojectedInTileSpace){const ye=this.locationCoordinate(this.center),Ce=f.identity([]);f.translate(Ce,Ce,[ye.x*this.worldSize,ye.y*this.worldSize,0]),f.multiply(Ce,Ce,q(this)),f.translate(Ce,Ce,[-ye.x*this.worldSize,-ye.y*this.worldSize,0]),f.multiply(M,M,Ce),this.inverseAdjustmentMatrix=function(Ae){const Ne=q(Ae,!0);return vt([],[Ne[0],Ne[1],Ne[4],Ne[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=f.scale([],M,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=M,this.invProjMatrix=f.invert(new Float64Array(16),this.projMatrix);const P=f.invert([],D);this.frustumCorners=f.FrustumCorners.fromInvProjectionMatrix(P,this.horizonLineFromTop(),this.height);const z=new Float32Array(16);f.identity(z),f.scale(z,z,[1,-1,1]),f.rotateX(z,z,this._pitch),f.rotateZ(z,z,this.angle);const B=f.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),$=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;B[8]=2*-c.x/this.width,B[9]=2*(c.y+$)/this.height,this.skyboxMatrix=f.multiply(z,B,z);const X=this.point,ee=X.x,te=X.y,ne=this.width%2/2,J=this.height%2/2,Y=Math.cos(this.angle),ce=Math.sin(this.angle),le=ee-Math.round(ee)+Y*ne+ce*J,de=te-Math.round(te)+Y*J+ce*ne,xe=new Float64Array(M);if(f.translate(xe,xe,[le>.5?le-1:le,de>.5?de-1:de,0]),this.alignedProjMatrix=xe,M=f.create(),f.scale(M,M,[this.width/2,-this.height/2,1]),f.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=f.create(),f.scale(M,M,[1,-1,1]),f.translate(M,M,[-1,-1,0]),f.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=f.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=f.calculateGlobeMatrix(this);const ye=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=f.transformMat4(ye,ye,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,y=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,E=[c,c,h];f.scale$2(E,E,x),f.scale$2(y,y,-1),f.multiply$2(y,y,E);const D=f.create();f.translate(D,D,y),f.scale(D,D,E),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,h,x)}_computeCameraPosition(c){const h=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),x=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-c/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-y[0]*E,x.y/this.worldSize-y[1]*E,c/this.worldSize*this._centerAltitude-y[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],x=c[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(E=Math.min((h-y)/x,1)),this._camera.position=f.scaleAndAdd([],this._camera.position,c,E),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,h=this._camera.forward(),{pitch:y,bearing:x}=this._camera.getPitchBearing(),E=f.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(f.degToRad(this._maxPitch)),M=Math.max((c[2]-E)/Math.cos(y),D),P=this._zoomFromMercatorZ(M);f.scaleAndAdd(c,c,h,M),this._pitch=f.clamp(y,f.degToRad(this.minPitch),f.degToRad(this.maxPitch)),this.angle=f.wrap(x,-Math.PI,Math.PI),this._setZoom(f.clamp(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new f.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let h=0,y=f.GLOBE_ZOOM_THRESHOLD_MAX,x=0,E=1/0;for(;y-h>1e-6&&y>h;){const D=h+.5*(y-h),M=this.tileSize*Math.pow(2,D),P=this.getCameraToCenterDistance(this.projection,D,M),z=this.scaleZoom(P/(c*this.tileSize)),B=Math.abs(D-z);B<E&&(E=B,x=D),D<z?h=D:y=D}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(f.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,h){const y=Math.min(c.x,h.x),x=Math.max(c.x,h.x),E=Math.min(c.y,h.y),D=Math.max(c.y,h.y);if(E<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const M=[new f.pointGeometry(y,E),new f.pointGeometry(x,D),new f.pointGeometry(y,D),new f.pointGeometry(x,E)],P=this.renderWorldCopies?-3:0,z=this.renderWorldCopies?4:1;for(const B of M){const $=this.pointRayIntersection(B);if($.t<0)return!0;const X=this.rayIntersectionCoordinate($);if(X.x<P||X.y<0||X.x>z||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+f.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new f.pointGeometry(0,0),new f.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,h){const y=f.length(f.sub([],this._camera.position,c)),x=this._zoomFromMercatorZ(y)+h;return y-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const c=function([h,y,x],E){const D=[h,y,x,1];f.transformMat4$1(D,D,E);const M=D[3]=Math.max(D[3],1e-6);return D[0]/=M,D[1]/=M,D[2]/=M,D}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new f.pointGeometry(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.pointGeometry(0,c))}}getCameraToCenterDistance(c,h=this.zoom,y=this.worldSize){const x=Je(c,h,this.width,this.height,1024),E=c.pixelSpaceConversion(this.center.lat,y,x);return.5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&f.multiply(c,c,this.globeMatrix),c}}function so(g,c){let h=!1,y=null;const x=()=>{y=null,h&&(g(),y=setTimeout(x,c),h=!1)};return()=>(h=!0,y||x(),y)}class $d{constructor(c){this._hashName=c&&encodeURIComponent(c),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=so(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,f.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),f.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const h=ig(c);if(this._hashName){const y=this._hashName;let x=!1;const E=f.window.location.hash.slice(1).split("&").map(D=>{const M=D.split("=")[0];return M===y?(x=!0,`${M}=${h}`):D}).filter(D=>D);return x||E.push(`${y}=${h}`),`#${E.join("&")}`}return`#${h}`}_getCurrentHash(){const c=f.window.location.hash.replace("#","");if(this._hashName){let h;return c.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(h=y)}),(h&&h[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(y=>isNaN(y))){const y=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(h[3]||0):c.getBearing();return c.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:y,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=f.window.location.href.replace(/(#.+)?$/,this.getHashString());f.window.history.replaceState(f.window.history.state,null,c)}}function ig(g,c){const h=g.getCenter(),y=Math.round(100*g.getZoom())/100,x=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,x),D=Math.round(h.lng*E)/E,M=Math.round(h.lat*E)/E,P=g.getBearing(),z=g.getPitch();let B=c?`/${D}/${M}/${y}`:`${y}/${M}/${D}`;return(P||z)&&(B+="/"+Math.round(10*P)/10),z&&(B+=`/${Math.round(z)}`),B}const Gh={linearity:.3,easing:f.bezier(0,0,.3,1)},Hd=f.extend({deceleration:2500,maxSpeed:1400},Gh),my=f.extend({deceleration:20,maxSpeed:1400},Gh),_p=f.extend({deceleration:1e3,maxSpeed:360},Gh),rg=f.extend({deceleration:1e3,maxSpeed:90},Gh);class Gd{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,h=f.exported.now();for(;c.length>0&&h-c[0].time>160;)c.shift()}_onMoveEnd(c){if(f.exported.prefersReducedMotion||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new f.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)h.zoom+=E.zoomDelta||0,h.bearing+=E.bearingDelta||0,h.pitch+=E.pitchDelta||0,E.panDelta&&h.pan._add(E.panDelta),E.around&&(h.around=E.around),E.pinchAround&&(h.pinchAround=E.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const E=Wh(h.pan.mag(),y,f.extend({},Hd,c||{}));x.offset=h.pan.mult(E.amount/h.pan.mag()),x.center=this._map.transform.center,td(x,E)}if(h.zoom){const E=Wh(h.zoom,y,my);x.zoom=this._map.transform.zoom+E.amount,td(x,E)}if(h.bearing){const E=Wh(h.bearing,y,_p);x.bearing=this._map.transform.bearing+f.clamp(E.amount,-179,179),td(x,E)}if(h.pitch){const E=Wh(h.pitch,y,rg);x.pitch=this._map.transform.pitch+E.amount,td(x,E)}if(x.zoom||x.bearing){const E=void 0===h.pinchAround?h.around:h.pinchAround;x.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function td(g,c){(!g.duration||g.duration<c.duration)&&(g.duration=c.duration,g.easing=c.easing)}function Wh(g,c,h){const{maxSpeed:y,linearity:x,deceleration:E}=h,D=f.clamp(g*x/(c/1e3),-y,y),M=Math.abs(D)/(E*x);return{easing:h.easing,duration:1e3*M,amount:D*(M/2)}}class bo extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y,x={}){const E=st(h.getCanvasContainer(),y),D=h.unproject(E);super(c,f.extend({point:E,lngLat:D,originalEvent:y},x)),this._defaultPrevented=!1,this.target=h}}class yp extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y){const x="touchend"===c?y.changedTouches:y.touches,E=ue(h.getCanvasContainer(),x),D=E.map(P=>h.unproject(P)),M=E.reduce((P,z,B,$)=>P.add(z.div($.length)),new f.pointGeometry(0,0));super(c,{points:E,point:M,lngLats:D,lngLat:h.unproject(M),originalEvent:y}),this._defaultPrevented=!1}}class hu extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,y){super(c,{originalEvent:y}),this._defaultPrevented=!1}}class og{constructor(c,h){this._map=c,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new hu(c.type,this._map,c))}mousedown(c,h){return this._mousedownPos=h,this._firePreventable(new bo(c.type,this._map,c))}mouseup(c){this._map.fire(new bo(c.type,this._map,c))}preclick(c){const h=f.extend({},c);h.type="preclick",this._map.fire(new bo(h.type,this._map,h))}click(c,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(c),this._map.fire(new bo(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new bo(c.type,this._map,c))}mouseover(c){this._map.fire(new bo(c.type,this._map,c))}mouseout(c){this._map.fire(new bo(c.type,this._map,c))}touchstart(c){return this._firePreventable(new yp(c.type,this._map,c))}touchmove(c){this._map.fire(new yp(c.type,this._map,c))}touchend(c){this._map.fire(new yp(c.type,this._map,c))}touchcancel(c){this._map.fire(new yp(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fo{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new bo(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new bo(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qh{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,h){this.isEnabled()&&c.shiftKey&&0===c.button&&(Ot(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(c,h){if(!this._active)return;const y=h,x=this._startPos,E=this._lastPos;if(!x||!E||E.equals(y)||!this._box&&y.dist(x)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=qe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const D=Math.min(x.x,y.x),M=Math.max(x.x,y.x),P=Math.min(x.y,y.y),z=Math.max(x.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${P}px)`,this._box.style.width=M-D+"px",this._box.style.height=z-P+"px")})}mouseupWindow(c,h){if(!this._active)return;const y=this._startPos,x=h;if(y&&0===c.button){if(this.reset(),nn(),y.x!==x.x||y.y!==x.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:E=>E.fitScreenCoordinates(y,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&27===c.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),mt(),delete this._startPos,delete this._lastPos}_fireEvent(c,h){return this._map.fire(new f.Event(c,{originalEvent:h}))}}function Zh(g,c){const h={};for(let y=0;y<g.length;y++)h[g[y].identifier]=c[y];return h}class sg{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,h,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=c.timeStamp),y.length===this.numTouches&&(this.centroid=function(x){const E=new f.pointGeometry(0,0);for(const D of x)E._add(D);return E.div(x.length)}(h),this.touches=Zh(y,h)))}touchmove(c,h,y){if(this.aborted||!this.centroid)return;const x=Zh(y,h);for(const E in this.touches){const M=x[E];(!M||M.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(c,h,y){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class fu{constructor(c){this.singleTap=new sg(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,h,y){this.singleTap.touchstart(c,h,y)}touchmove(c,h,y){this.singleTap.touchmove(c,h,y)}touchend(c,h,y){const x=this.singleTap.touchend(c,h,y);if(x){const E=c.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(x)<30;if(E&&D||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Yh{constructor(){this._zoomIn=new fu({numTouches:1,numTaps:2}),this._zoomOut=new fu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,h,y){this._zoomIn.touchstart(c,h,y),this._zoomOut.touchstart(c,h,y)}touchmove(c,h,y){this._zoomIn.touchmove(c,h,y),this._zoomOut.touchmove(c,h,y)}touchend(c,h,y){const x=this._zoomIn.touchend(c,h,y),E=this._zoomOut.touchend(c,h,y);return x?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(x)},{originalEvent:c})}):E?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(E)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const ag={0:1,2:2};class nd{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,h){return!1}_move(c,h){return{}}mousedown(c,h){if(this._lastPoint)return;const y=De(c);this._correctButton(c,y)&&(this._lastPoint=h,this._eventButton=y)}mousemoveWindow(c,h){const y=this._lastPoint;if(y)if(c.preventDefault(),null!=this._eventButton&&function(x,E){const D=ag[E];return void 0===x.buttons||(x.buttons&D)!==D}(c,this._eventButton))this.reset();else if(this._moved||!(h.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(y,h)}mouseupWindow(c){this._lastPoint&&De(c)===this._eventButton&&(this._moved&&nn(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lg extends nd{mousedown(c,h){super.mousedown(c,h),this._lastPoint&&(this._active=!0)}_correctButton(c,h){return 0===h&&!c.ctrlKey}_move(c,h){return{around:h,panDelta:h.sub(c)}}}class Es extends nd{_correctButton(c,h){return 0===h&&c.ctrlKey||2===h}_move(c,h){const y=.8*(h.x-c.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(c){c.preventDefault()}}class Kh extends nd{_correctButton(c,h){return 0===h&&c.ctrlKey||2===h}_move(c,h){const y=-.5*(h.y-c.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(c){c.preventDefault()}}class pu{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),f.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new f.pointGeometry(0,0)}touchstart(c,h,y){return this._calculateTransform(c,h,y)}touchmove(c,h,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===y.length&&!f.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,h,y)}}touchend(c,h,y){this._calculateTransform(c,h,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,h,y){y.length>0&&(this._active=!0);const x=Zh(y,h),E=new f.pointGeometry(0,0),D=new f.pointGeometry(0,0);let M=0;for(const z in x){const B=x[z],$=this._touches[z];$&&(E._add(B),D._add(B.sub($)),M++,x[z]=B)}if(this._touches=x,M<this._minTouches||!D.mag())return;const P=D.div(M);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(M),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=qe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Vr{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,h,y){return{}}touchstart(c,h,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([h[0],h[1]]))}touchmove(c,h,y){const x=this._firstTwoTouches;if(!x)return;c.preventDefault();const[E,D]=x,M=Wd(y,h,E),P=Wd(y,h,D);if(!M||!P)return;const z=this._aroundCenter?null:M.add(P).div(2);return this._move([M,P],z,c)}touchend(c,h,y){if(!this._firstTwoTouches)return;const[x,E]=this._firstTwoTouches,D=Wd(y,h,x),M=Wd(y,h,E);D&&M||(this._active&&nn(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Wd(g,c,h){for(let y=0;y<g.length;y++)if(g[y].identifier===h)return c[y]}function qd(g,c){return Math.log(g/c)/Math.LN2}class Cs extends Vr{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,h){const y=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(qd(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:qd(this._distance,y),pinchAround:h}}}function vp(g,c){return 180*g.angleWith(c)/Math.PI}class bp extends Vr{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,h){const y=this._vector;if(this._vector=c[0].sub(c[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:vp(this._vector,y),pinchAround:h}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const h=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const x=vp(c,y);return Math.abs(x)<h}}function Vl(g){return Math.abs(g.y)>Math.abs(g.x)}class Wi extends Vr{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,Vl(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,h,y){const x=this._lastPoints;if(!x)return;const E=c[0].sub(x[0]),D=c[1].sub(x[1]);return this._map._cooperativeGestures&&!f.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(E,D,y.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(E.y+D.y)/2*-.5})}gestureBeginsVertically(c,h,y){if(void 0!==this._valid)return this._valid;const x=c.mag()>=2,E=h.mag()>=2;if(!x&&!E)return;if(!x||!E)return null==this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const D=c.y>0==h.y>0;return Vl(c)&&Vl(h)&&D}}const gy={panStep:100,bearingStep:15,pitchStep:10};class Zd{constructor(){const c=gy;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let h=0,y=0,x=0,E=0,D=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?y=-1:(c.preventDefault(),E=-1);break;case 39:c.shiftKey?y=1:(c.preventDefault(),E=1);break;case 38:c.shiftKey?x=1:(c.preventDefault(),D=-1);break;case 40:c.shiftKey?x=-1:(c.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(y=0,x=0),{cameraAnimation:M=>{const P=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:_y,zoom:h?Math.round(P)+h*(c.shiftKey?2:1):P,bearing:M.getBearing()+y*this._bearingStep,pitch:M.getPitch()+x*this._pitchStep,offset:[-E*this._panStep,-D*this._panStep],center:M.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _y(g){return g*(2-g)}const Ul=4.000244140625;class tl{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,f.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&"center"===c.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||f.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=c.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const y=f.exported.now(),x=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==h&&h%Ul==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),c.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=c,this._delta-=h,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=st(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;"wheel"===this._type&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(0!==this._delta){const P="wheel"===this._type&&Math.abs(this._delta)>Ul?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&0!==z&&(z=1/z);const B=h(),$=Math.pow(2,B),X="number"==typeof this._targetZoom?c.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(X*z))),"wheel"===this._type&&(this._startZoom=B,this._easing=this._smoothOutEasing(200)),this._delta=0}const y="number"==typeof this._targetZoom?this._targetZoom:h(),x=this._startZoom,E=this._easing;let D,M=!1;if("wheel"===this._type&&x&&E){const P=Math.min((f.exported.now()-this._lastWheelEventTime)/200,1),z=E(P);D=f.number(x,y,z),P<1?this._frameId||(this._frameId=!0):M=!0}else D=y,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:D-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let h=f.ease;if(this._prevEase){const y=this._prevEase,x=(f.exported.now()-y.start)/y.duration,E=y.easing(x+.01)-y.easing(x),D=.27/Math.sqrt(E*E+1e-4)*.01,M=Math.sqrt(.0729-D*D);h=f.bezier(D,M,.25,1)}return this._prevEase={start:f.exported.now(),duration:c,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=qe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(f.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Xh{constructor(c,h){this._clickZoom=c,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Tn{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,h){return c.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(c.shiftKey?-1:1),around:y.unproject(h)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia{constructor(){this._tap=new fu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,h,y){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=h[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(c,h,y))}touchmove(c,h,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const x=h[0],E=x.y-this._swipePoint.y;return this._swipePoint=x,c.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(c,h,y)}touchend(c,h,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(c,h,y)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xp{constructor(c,h,y){this._el=c,this._mousePan=h,this._touchPan=y}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nt{constructor(c,h,y){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=h,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class cg{constructor(c,h,y,x){this._el=c,this._touchZoom=h,this._touchRotate=y,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Yd=g=>g.zoom||g.drag||g.pitch||g.rotate;class id extends f.Event{}class Kd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,h){const y=f.sub([],h,c);this.radius=f.length(y[2]<0?f.div([],y,this.constants):[y[0],y[1],0])}projectRay(c){f.div(c,c,this.constants),f.normalize(c,c),f.mul$1(c,c,this.constants);const h=f.scale$2([],c,this.radius);if(h[2]>0){const y=f.scale$2([],[0,0,1],f.dot(h,[0,0,1])),x=f.scale$2([],f.normalize([],[h[0],h[1],0]),this.radius),E=f.add([],h,f.scale$2([],f.sub([],f.add([],x,y),h),2));h[0]=E[0],h[1]=E[1]}return h}}function Xd(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class gt{constructor(c,h){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Gd(c),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Kd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),f.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[f.window,"blur",void 0]];for(const[x,E,D]of this._listeners)x.addEventListener(E,x===f.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[c,h,y]of this._listeners)c.removeEventListener(h,c===f.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(c){const h=this._map,y=h.getCanvasContainer();this._add("mapEvent",new og(h,c));const x=h.boxZoom=new qh(h,c);this._add("boxZoom",x);const E=new Yh,D=new Tn;h.doubleClickZoom=new Xh(D,E),this._add("tapZoom",E),this._add("clickZoom",D);const M=new Ia;this._add("tapDragZoom",M);const P=h.touchPitch=new Wi(h);this._add("touchPitch",P);const z=new Es(c),B=new Kh(c);h.dragRotate=new Nt(c,z,B),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const $=new lg(c),X=new pu(h,c);h.dragPan=new xp(y,$,X),this._add("mousePan",$),this._add("touchPan",X,["touchZoom","touchRotate"]);const ee=new bp,te=new Cs;h.touchZoomRotate=new cg(y,te,ee,M),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Fo(h));const ne=h.scrollZoom=new tl(h,this);this._add("scrollZoom",ne,["mousePan"]);const J=h.keyboard=new Zd;this._add("keyboard",J);for(const Y of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[Y]&&h[Y].enable(c[Y])}_add(c,h,y){this._handlers.push({handlerName:c,handler:h,allowed:y}),this._handlersById[c]=h}stop(c){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Yd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,h,y){for(const x in c)if(x!==y&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const h=[];for(const y of c)this._el.contains(y.target)&&h.push(y);return h}handleEvent(c,h){this._updatingCamera=!0;const y="renderFrame"===c.type,x=y?void 0:c,E={needsRenderFrame:!1},D={},M={},P=c.touches?this._getMapTouches(c.touches):void 0,z=P?ue(this._el,P):y?void 0:st(this._el,c);for(const{handlerName:X,handler:ee,allowed:te}of this._handlers){if(!ee.isEnabled())continue;let ne;this._blockedByActive(M,te,X)?ee.reset():ee[h||c.type]&&(ne=ee[h||c.type](c,z,P),this.mergeHandlerResult(E,D,ne,X,x),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||ee.isActive())&&(M[X]=ee)}const B={};for(const X in this._previousActiveHandlers)M[X]||(B[X]=x);this._previousActiveHandlers=M,(Object.keys(B).length||Xd(E))&&(this._changes.push([E,D,B]),this._triggerRenderFrame()),(Object.keys(M).length||Xd(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=E;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))}mergeHandlerResult(c,h,y,x,E){if(!y)return;f.extend(c,y);const D={handlerName:x,originalEvent:y.originalEvent||E};void 0!==y.zoomDelta&&(h.zoom=D),void 0!==y.panDelta&&(h.drag=D),void 0!==y.pitchDelta&&(h.pitch=D),void 0!==y.bearingDelta&&(h.rotate=D)}_applyChanges(){const c={},h={},y={};for(const[x,E,D]of this._changes)x.panDelta&&(c.panDelta=(c.panDelta||new f.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(c.around=x.around),void 0!==x.aroundCoord&&(c.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(c.pinchAround=x.pinchAround),x.noInertia&&(c.noInertia=x.noInertia),f.extend(h,E),f.extend(y,D);this._updateMapTransform(c,h,y),this._changes=[]}_updateMapTransform(c,h,y){const x=this._map,E=x.transform,D=ce=>[ce.x,ce.y,ce.z];if((ce=>{const le=this._eventsInProgress.drag;return le&&!this._handlersById[le.handlerName].isActive()})()&&!Xd(c)){const ce=E.zoom;E.cameraElevationReference="sea",E.recenterOnTerrain(),E.cameraElevationReference="ground",ce!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&x._stop(!0),!Xd(c))return void this._fireEvents(h,y,!0);let{panDelta:M,zoomDelta:P,bearingDelta:z,pitchDelta:B,around:$,aroundCoord:X,pinchAround:ee}=c;E._isCameraConstrained&&(P>0&&(P=0),E._isCameraConstrained=!1),void 0!==ee&&($=ee),(P||(ce=>h.drag&&!this._eventsInProgress.drag)())&&$&&(this._dragOrigin=D(E.pointCoordinate3D($)),this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",x._stop(!0),$=$||x.transform.centerPoint,z&&(E.bearing+=z),B&&(E.pitch+=B),E._updateCameraState();const te=[0,0,0];if(M)if("mercator"===E.projection.name){const ce=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay($).dir),le=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay($.sub(M)).dir);te[0]=le[0]-ce[0],te[1]=le[1]-ce[1]}else{const ce=E.pointCoordinate($);if("globe"===E.projection.name){M=M.rotate(-E.angle);const le=E._pixelsPerMercatorPixel/E.worldSize;te[0]=-M.x*f.mercatorScale(f.latFromMercatorY(ce.y))*le,te[1]=-M.y*f.mercatorScale(E.center.lat)*le}else{const le=E.pointCoordinate($.sub(M));ce&&le&&(te[0]=le.x-ce.x,te[1]=le.y-ce.y)}}const ne=E.zoom,J=[0,0,0];if(P){const ce=D(X||E.pointCoordinate3D($)),le={dir:f.normalize([],f.sub([],ce,E._camera.position))};if(le.dir[2]<0){const de=E.zoomDeltaToMovement(ce,P);f.scale$2(J,le.dir,de)}}const Y=f.add(te,te,J);E._translateCameraConstrained(Y),P&&Math.abs(E.zoom-ne)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(h,y,!0)}_fireEvents(c,h,y){const x=Yd(this._eventsInProgress),E=Yd(c),D={};for(const B in c){const{originalEvent:$}=c[B];this._eventsInProgress[B]||(D[`${B}start`]=$),this._eventsInProgress[B]=c[B]}!x&&E&&this._fireEvent("movestart",E.originalEvent);for(const B in D)this._fireEvent(B,D[B]);E&&this._fireEvent("move",E.originalEvent);for(const B in c){const{originalEvent:$}=c[B];this._fireEvent(B,$)}const M={};let P;for(const B in this._eventsInProgress){const{handlerName:$,originalEvent:X}=this._eventsInProgress[B];this._handlersById[$].isActive()||(delete this._eventsInProgress[B],P=h[$]||X,M[`${B}end`]=P)}for(const B in M)this._fireEvent(B,M[B]);const z=Yd(this._eventsInProgress);if(y&&(x||E)&&!z){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=X=>0!==X&&-this._bearingSnap<X&&X<this._bearingSnap;B?($(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:P})):(this._map.fire(new f.Event("moveend",{originalEvent:P})),$(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,h){this._map.fire(new f.Event(c,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new id("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const di="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class wp extends f.Evented{constructor(c,h){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=h.bearingSnap,f.bindAll(["_renderFrameCallback"],this)}getCenter(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,h){return this.jumpTo({center:c},h)}panBy(c,h,y){return c=f.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,f.extend({offset:c},h),y)}panTo(c,h,y){return this.easeTo(f.extend({center:c},h),y)}getZoom(){return this.transform.zoom}setZoom(c,h){return this.jumpTo({zoom:c},h),this}zoomTo(c,h,y){return this.easeTo(f.extend({zoom:c},h),y)}zoomIn(c,h){return this.zoomTo(this.getZoom()+1,c,h),this}zoomOut(c,h){return this.zoomTo(this.getZoom()-1,c,h),this}getBearing(){return this.transform.bearing}setBearing(c,h){return this.jumpTo({bearing:c},h),this}getPadding(){return this.transform.padding}setPadding(c,h){return this.jumpTo({padding:c},h),this}rotateTo(c,h,y){return this.easeTo(f.extend({bearing:c},h),y)}resetNorth(c,h){return this.rotateTo(0,f.extend({duration:1e3},c),h),this}resetNorthPitch(c,h){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},c),h),this}snapToNorth(c,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,h):this}getPitch(){return this.transform.pitch}setPitch(c,h){return this.jumpTo({pitch:c},h),this}cameraForBounds(c,h){c=f.LngLatBounds.convert(c);const y=h&&h.bearing||0,x=h&&h.pitch||0,E=c.getNorthWest(),D=c.getSouthEast();return this._cameraForBounds(this.transform,E,D,y,x,h)}_extendCameraOptions(c){const h={top:0,bottom:0,right:0,left:0};if("number"==typeof(c=f.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding){const y=c.padding;c.padding={top:y,bottom:y,right:y,left:y}}return c.padding=f.extend(h,c.padding),c}_minimumAABBFrustumDistance(c,h){const y=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return y/x>c.aspect?y/(2*Math.tan(.5*c.fovX)*c.aspect):x/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,h,y,x,E,D){const M=c.clone(),P=this._extendCameraOptions(D);M.bearing=x,M.pitch=E;const z=f.LngLat.convert(h),B=f.LngLat.convert(y),$=.5*(z.lat+B.lat),X=.5*(z.lng+B.lng),ee=f.latLngToECEF($,X),te=f.normalize([],ee),ne=f.normalize([],f.cross([],te,[0,1,0])),J=f.cross([],ne,te),Y=[ne[0],ne[1],ne[2],0,J[0],J[1],J[2],0,te[0],te[1],te[2],0,0,0,0,1],ce=[ee,f.latLngToECEF(z.lat,z.lng),f.latLngToECEF(B.lat,z.lng),f.latLngToECEF(B.lat,B.lng),f.latLngToECEF(z.lat,B.lng),f.latLngToECEF($,z.lng),f.latLngToECEF($,B.lng),f.latLngToECEF(z.lat,X),f.latLngToECEF(B.lat,X)];let le=f.Aabb.fromPoints(ce.map(ct=>[f.dot(ne,ct),f.dot(J,ct),f.dot(te,ct)]));const de=f.transformMat4([],le.center,Y);0===f.squaredLength(de)&&f.set(de,0,0,1),f.normalize(de,de),f.scale$2(de,de,f.GLOBE_RADIUS),M.center=f.ecefToLatLng(de);const xe=M.getWorldToCameraMatrix(),ye=f.invert(new Float64Array(16),xe);le=f.Aabb.applyTransform(le,f.multiply([],xe,Y)),f.transformMat4(de,de,xe);const Ce=.5*(le.max[2]-le.min[2]),Ae=this._minimumAABBFrustumDistance(M,le),Ne=f.scale$2([],[0,0,1],Ce),Ve=f.add(Ne,de,Ne),yt=Ae+(0===M.pitch?0:f.distance(de,Ve)),Pe=M.globeCenterInViewSpace,et=f.sub([],de,[Pe[0],Pe[1],Pe[2]]);f.normalize(et,et),f.scale$2(et,et,yt);const We=f.add([],de,et);f.transformMat4(We,We,ye);const ht=f.earthRadius/f.GLOBE_RADIUS,Ue=f.length(We),Se=f.mercatorZfromAltitude(Math.max(Ue*ht-f.earthRadius,Number.EPSILON),0),He=Math.min(M.zoomFromMercatorZAdjusted(Se),P.maxZoom);return He>.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"mercator"}),M.zoom=He,this._cameraForBounds(M,h,y,x,E,D)):{center:M.center,zoom:He,bearing:x,pitch:E}}queryTerrainElevation(c,h){const y=this.transform.elevation;return y?(h=f.extend({},{exaggerated:!0},h),y.getAtPoint(f.MercatorCoordinate.fromLngLat(c),null,h.exaggerated)):null}_cameraForBounds(c,h,y,x,E,D){if("globe"===c.projection.name)return this._cameraForBoundsOnGlobe(c,h,y,x,E,D);const M=c.clone(),P=this._extendCameraOptions(D),z=M.padding;M.bearing=x,M.pitch=E;const B=f.LngLat.convert(h),$=f.LngLat.convert(y),X=new f.LngLat(B.lng,$.lat),ee=new f.LngLat($.lng,B.lat),te=M.project(B),ne=M.project($),J=this.queryTerrainElevation(B),Y=this.queryTerrainElevation($),ce=this.queryTerrainElevation(X),le=this.queryTerrainElevation(ee),de=[[te.x,te.y,Math.min(J||0,Y||0,ce||0,le||0)],[ne.x,ne.y,Math.max(J||0,Y||0,ce||0,le||0)]];let xe=f.Aabb.fromPoints(de);const ye=M.getWorldToCameraMatrix(),Ce=f.invert(new Float64Array(16),ye);xe=f.Aabb.applyTransform(xe,ye);const Ae=f.sub([],xe.max,xe.min),Ne=z.left||0,Ve=z.right||0,yt=z.bottom||0,Pe=z.top||0,{left:et,right:We,top:ht,bottom:Ue}=P.padding,Se=.5*(Ne+Ve),He=.5*(Pe+yt),ct=Math.min(M.scaleZoom(M.scale*Math.min((M.width-(Ne+Ve+et+We))/Ae[0],(M.height-(yt+Pe+Ue+ht))/Ae[1])),P.maxZoom),ft=M.scale/M.zoomScale(ct);xe=new f.Aabb([xe.min[0]-(et+Se)*ft,xe.min[1]-(Ue+He)*ft,xe.min[2]],[xe.max[0]+(We+Se)*ft,xe.max[1]+(ht+He)*ft,xe.max[2]]);const Yt=.5*Ae[2],On=this._minimumAABBFrustumDistance(M,xe),Ft=[0,0,1,0];f.transformMat4$1(Ft,Ft,ye),f.normalize$2(Ft,Ft);const kt=f.scale$2([],Ft,On+Yt),Kt=f.add([],xe.center,kt),Rn=("number"==typeof P.offset.x&&"number"==typeof P.offset.y?new f.pointGeometry(P.offset.x,P.offset.y):f.pointGeometry.convert(P.offset)).rotate(-f.degToRad(x));xe.center[0]-=Rn.x*ft,xe.center[1]+=Rn.y*ft,f.transformMat4(xe.center,xe.center,Ce),f.transformMat4(Kt,Kt,Ce);const Jt=[xe.center[0],xe.center[1],Kt[2]*M.pixelsPerMeter];f.scale$2(Jt,Jt,1/M.worldSize);const _i=f.lngFromMercatorX(Jt[0]),hi=f.latFromMercatorY(Jt[1]),qi=Math.min(M._zoomFromMercatorZ(Jt[2]),P.maxZoom),Si=new f.LngLat(_i,hi);return M.mercatorFromTransition&&qi<.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"globe"}),M.zoom=qi,this._cameraForBounds(M,h,y,x,E,D)):{center:Si,zoom:qi,bearing:x,pitch:E}}fitBounds(c,h,y){const x=this.cameraForBounds(c,h);return this._fitInternal(x,h,y)}fitScreenCoordinates(c,h,y,x,E){const D=f.pointGeometry.convert(c),M=f.pointGeometry.convert(h),P=new f.pointGeometry(Math.min(D.x,M.x),Math.min(D.y,M.y)),z=new f.pointGeometry(Math.max(D.x,M.x),Math.max(D.y,M.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(D,M))return this;const B=this.transform.pointLocation3D(P),$=this.transform.pointLocation3D(z),X=this.transform.pointLocation3D(new f.pointGeometry(P.x,z.y)),ee=this.transform.pointLocation3D(new f.pointGeometry(z.x,P.y)),te=[Math.min(B.lng,$.lng,X.lng,ee.lng),Math.min(B.lat,$.lat,X.lat,ee.lat)],ne=[Math.max(B.lng,$.lng,X.lng,ee.lng),Math.max(B.lat,$.lat,X.lat,ee.lat)],J=x&&x.pitch?x.pitch:this.getPitch(),Y=this._cameraForBounds(this.transform,te,ne,y,J,x);return this._fitInternal(Y,x,E)}_fitInternal(c,h,y){return c?(delete(h=f.extend(c,h)).padding,h.linear?this.easeTo(h,y):this.flyTo(h,y)):this}jumpTo(c,h){this.stop();const y=c.preloadOnly?this.transform.clone():this.transform;let x=!1,E=!1,D=!1;return"zoom"in c&&y.zoom!==+c.zoom&&(x=!0,y.zoom=+c.zoom),void 0!==c.center&&(y.center=f.LngLat.convert(c.center)),"bearing"in c&&y.bearing!==+c.bearing&&(E=!0,y.bearing=+c.bearing),"pitch"in c&&y.pitch!==+c.pitch&&(D=!0,y.pitch=+c.pitch),null==c.padding||y.isPaddingEqual(c.padding)||(y.padding=c.padding),c.preloadOnly?(this._preloadTiles(y),this):(this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),x&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),E&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),D&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||f.warnOnce(di),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,h){const y=this.transform;if(!y.projection.supportsFreeCamera)return f.warnOnce(di),this;this.stop();const x=y.zoom,E=y.pitch,D=y.bearing;y.setFreeCameraOptions(c);const M=x!==y.zoom,P=E!==y.pitch,z=D!==y.bearing;return this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),M&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),z&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),P&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)),this}easeTo(c,h){this._stop(!1,c.easeId),(!1===(c=f.extend({offset:[0,0],duration:500,easing:f.ease},c)).animate||!c.essential&&f.exported.prefersReducedMotion)&&(c.duration=0);const y=this.transform,x=this.getZoom(),E=this.getBearing(),D=this.getPitch(),M=this.getPadding(),P="zoom"in c?+c.zoom:x,z="bearing"in c?this._normalizeBearing(c.bearing,E):E,B="pitch"in c?+c.pitch:D,$="padding"in c?c.padding:y.padding,X=f.pointGeometry.convert(c.offset);let ee,te,ne;if("globe"===y.projection.name){const Ne=f.MercatorCoordinate.fromLngLat(y.center),Ve=X.rotate(-y.angle);Ne.x+=Ve.x/y.worldSize,Ne.y+=Ve.y/y.worldSize;const yt=Ne.toLngLat(),Pe=f.LngLat.convert(c.center||yt);this._normalizeCenter(Pe),ee=y.centerPoint.add(Ve),te=new f.pointGeometry(Ne.x,Ne.y).mult(y.worldSize),ne=new f.pointGeometry(f.mercatorXfromLng(Pe.lng),f.mercatorYfromLat(Pe.lat)).mult(y.worldSize).sub(te)}else{ee=y.centerPoint.add(X);const Ne=y.pointLocation(ee),Ve=f.LngLat.convert(c.center||Ne);this._normalizeCenter(Ve),te=y.project(Ne),ne=y.project(Ve).sub(te)}const J=y.zoomScale(P-x);let Y,ce;c.around&&(Y=f.LngLat.convert(c.around),ce=y.locationPoint(Y));const le=this._zooming||P!==x,de=this._rotating||E!==z,xe=this._pitching||B!==D,ye=!y.isPaddingEqual($),Ce=Ne=>Ve=>{if(le&&(Ne.zoom=f.number(x,P,Ve)),de&&(Ne.bearing=f.number(E,z,Ve)),xe&&(Ne.pitch=f.number(D,B,Ve)),ye&&(Ne.interpolatePadding(M,$,Ve),ee=Ne.centerPoint.add(X)),Y)Ne.setLocationAtPoint(Y,ce);else{const yt=Ne.zoomScale(Ne.zoom-x),Pe=P>x?Math.min(2,J):Math.max(.5,J),et=Math.pow(Pe,1-Ve),We=Ne.unproject(te.add(ne.mult(Ve*et)).mult(yt));Ne.setLocationAtPoint(Ne.renderWorldCopies?We.wrap():We,ee)}return c.preloadOnly||this._fireMoveEvents(h),Ne};if(c.preloadOnly){const Ne=this._emulate(Ce,c.duration,y);return this._preloadTiles(Ne),this}const Ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=le,this._rotating=de,this._pitching=xe,this._padding=ye,this._easeId=c.easeId,this._prepareEase(h,c.noMoveStart,Ae),this._ease(Ce(y),Ne=>{y.recenterOnTerrain(),this._afterEase(h,Ne)},c),this}_prepareEase(c,h,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||y.moving||this.fire(new f.Event("movestart",c)),this._zooming&&!y.zooming&&this.fire(new f.Event("zoomstart",c)),this._rotating&&!y.rotating&&this.fire(new f.Event("rotatestart",c)),this._pitching&&!y.pitching&&this.fire(new f.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new f.Event("move",c)),this._zooming&&this.fire(new f.Event("zoom",c)),this._rotating&&this.fire(new f.Event("rotate",c)),this._pitching&&this.fire(new f.Event("pitch",c))}_afterEase(c,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,x=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new f.Event("zoomend",c)),x&&this.fire(new f.Event("rotateend",c)),E&&this.fire(new f.Event("pitchend",c)),this.fire(new f.Event("moveend",c))}flyTo(c,h){if(!c.essential&&f.exported.prefersReducedMotion){const ct=f.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ct,h)}this.stop(),c=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},c);const y=this.transform,x=this.getZoom(),E=this.getBearing(),D=this.getPitch(),M=this.getPadding(),P="zoom"in c?f.clamp(+c.zoom,y.minZoom,y.maxZoom):x,z="bearing"in c?this._normalizeBearing(c.bearing,E):E,B="pitch"in c?+c.pitch:D,$="padding"in c?c.padding:y.padding,X=y.zoomScale(P-x),ee=f.pointGeometry.convert(c.offset);let te=y.centerPoint.add(ee);const ne=y.pointLocation(te),J=f.LngLat.convert(c.center||ne);this._normalizeCenter(J);const Y=y.project(ne),ce=y.project(J).sub(Y);let le=c.curve;const de=Math.max(y.width,y.height),xe=de/X,ye=ce.mag();if("minZoom"in c){const ct=f.clamp(Math.min(c.minZoom,x,P),y.minZoom,y.maxZoom),ft=de/y.zoomScale(ct-x);le=Math.sqrt(ft/ye*2)}const Ce=le*le;function Ae(ct){const ft=(xe*xe-de*de+(ct?-1:1)*Ce*Ce*ye*ye)/(2*(ct?xe:de)*Ce*ye);return Math.log(Math.sqrt(ft*ft+1)-ft)}function Ne(ct){return(Math.exp(ct)-Math.exp(-ct))/2}function Ve(ct){return(Math.exp(ct)+Math.exp(-ct))/2}const yt=Ae(0);let Pe=function(ct){return Ve(yt)/Ve(yt+le*ct)},et=function(ct){return de*((Ve(yt)*(Ne(ft=yt+le*ct)/Ve(ft))-Ne(yt))/Ce)/ye;var ft},We=(Ae(1)-yt)/le;if(Math.abs(ye)<1e-6||!isFinite(We)){if(Math.abs(de-xe)<1e-6)return this.easeTo(c,h);const ct=xe<de?-1:1;We=Math.abs(Math.log(xe/de))/le,et=function(){return 0},Pe=function(ft){return Math.exp(ct*le*ft)}}c.duration="duration"in c?+c.duration:1e3*We/("screenSpeed"in c?+c.screenSpeed/le:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const ht=E!==z,Ue=B!==D,Se=!y.isPaddingEqual($),He=ct=>ft=>{const Yt=ft*We,On=1/Pe(Yt);ct.zoom=1===ft?P:x+ct.scaleZoom(On),ht&&(ct.bearing=f.number(E,z,ft)),Ue&&(ct.pitch=f.number(D,B,ft)),Se&&(ct.interpolatePadding(M,$,ft),te=ct.centerPoint.add(ee));const Ft=1===ft?J:ct.unproject(Y.add(ce.mult(et(Yt))).mult(On));return ct.setLocationAtPoint(ct.renderWorldCopies?Ft.wrap():Ft,te),ct._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(h),ct};if(c.preloadOnly){const ct=this._emulate(He,c.duration,y);return this._preloadTiles(ct),this}return this._zooming=!0,this._rotating=ht,this._pitching=Ue,this._padding=Se,this._prepareEase(h,!1),this._ease(He(y),()=>this._afterEase(h),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,h)}if(!c){const y=this.handlers;y&&y.stop(!1)}return this}_ease(c,h,y){!1===y.animate||0===y.duration?(c(1),h()):(this._easeStart=f.exported.now(),this._easeOptions=y,this._onEaseFrame=c,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((f.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,h){c=f.wrap(c,-180,180);const y=Math.abs(c-h);return Math.abs(c-360-h)<y&&(c-=360),Math.abs(c+360-h)<y&&(c+=360),c}_normalizeCenter(c){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const y=c.lng-h.center.lng;c.lng+=y>180?-360:y<-180?360:0}_emulate(c,h,y){const x=Math.ceil(15*h/1e3),E=[],D=c(y.clone());for(let M=0;M<=x;M++){const P=D(M/x);E.push(P.clone())}return E}}class Qh{constructor(c={}){this.options=c,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const h=this.options&&this.options.compact;return this._map=c,this._container=qe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=qe("button","mapboxgl-ctrl-attrib-button",this._container),qe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=qe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,h){const y=this._map._getUIString(`AttributionControl.${h}`);c.setAttribute("aria-label",y),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(c){const y=h.reduce((x,E,D)=>(E.value&&(x+=`${E.key}=${E.value}${D<h.length-1?"&":""}`),x),"?");c.href=`${f.config.FEEDBACK_URL}/${y}#${ig(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||"metadata"!==c.sourceDataType&&"visibility"!==c.sourceDataType&&"style"!==c.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._sourceCaches;for(const x in h){const E=h[x];if(E.used){const D=E.getSource();D.attribution&&c.indexOf(D.attribution)<0&&c.push(D.attribution)}}c.sort((x,E)=>x.length-E.length),c=c.filter((x,E)=>{for(let D=E+1;D<c.length;D++)if(c[D].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const y=c.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,c.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Wr{constructor(){f.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=qe("div","mapboxgl-ctrl");const h=qe("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&"metadata"!==c.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(0===Object.entries(c).length)return!0;for(const h in c){const y=c[h].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const h=c[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class rd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const h=++this._id;return this._queue.push({callback:c,id:h,cancelled:!1}),h}remove(c){const h=this._currentlyRunning,y=h?this._queue.concat(h):this._queue;for(const x of y)if(x.id===c)return void(x.cancelled=!0)}run(c=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const y of h)if(!y.cancelled&&(y.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function xc(g,c,h){if(g=new f.LngLat(g.lng,g.lat),c){const y=new f.LngLat(g.lng-360,g.lat),x=new f.LngLat(g.lng+360,g.lat),E=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),D=h.locationPoint(g).distSqr(c),M=c.x<0||c.y<0||c.x>h.width||c.y>h.height;h.locationPoint(y).distSqr(c)<D&&(M||Math.abs(y.lng-h.center.lng)<E)?g=y:h.locationPoint(x).distSqr(c)<D&&(M||Math.abs(x.lng-h.center.lng)<E)&&(g=x)}for(;Math.abs(g.lng-h.center.lng)>180;){const y=h.locationPoint(g);if(y.x>=0&&y.y>=0&&y.x<=h.width&&y.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const Jo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class od extends f.Evented{constructor(c,h){if(super(),(c instanceof f.window.HTMLElement||h)&&(c=f.extend({element:c},h)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=f.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=qe("div");const x=41,E=27,D=xt("svg",{display:"block",height:x*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${x}`},this._element),M=xt("radialGradient",{id:"shadowGradient"},xt("defs",{},D));xt("stop",{offset:"10%","stop-opacity":.4},M),xt("stop",{offset:"100%","stop-opacity":.05},M),xt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),xt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),xt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),xt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=f.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const y=this._element.classList;for(const x in Jo)y.remove(`mapboxgl-marker-anchor-${x}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=f.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const h=c.code,y=c.charCode||c.keyCode;"Space"!==h&&"Enter"!==h&&32!==y&&13!==y||this.togglePopup()}_onMapClick(c){const h=c.originalEvent.target,y=this._element;this._popup&&(h===y||y.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,h=this._pos;if(!c||!h)return!1;const y=c.unproject(h),x=c.getFreeCameraOptions();if(!x.position)return!1;const E=x.position.toLngLat();return E.distanceTo(y)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const h=this._pos;if(!h||h.x<0||h.x>c.transform.width||h.y<0||h.y>c.transform.height)return void this._clearFadeTimer();const y=c.unproject(h);let x;c._showingGlobe()&&f.isLngLatBehindGlobe(c.transform,this._lngLat)?x=0:(x=1-c._queryFogOpacity(y),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${c.x}px,${c.y}px)\n            ${Jo[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${h.x}px,${h.y}px)\n        `}_calculateXYTransform(){const c=this._pos,h=this._map,y=this.getPitchAlignment();if(!h||!c||"map"!==y)return"";if(!h._showingGlobe()){const P=h.getPitch();return P?`rotateX(${P}deg)`:""}const x=f.radToDeg(f.globeTiltAtLngLat(h.transform,this._lngLat)),E=c.sub(f.globeCenterToScreenPoint(h.transform)),D=Math.abs(E.x)+Math.abs(E.y);if(0===D)return"";const M=x/D;return`rotateX(${-E.y*M}deg) rotateY(${E.x*M}deg)`}_calculateZTransform(){const c=this._pos,h=this._map;if(!h||!c)return"";let y=0;const x=this.getRotationAlignment();if("map"===x)if(h._showingGlobe()){const E=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(E);y=f.radToDeg(Math.atan2(D.y,D.x))-90}else y=-h.getBearing();else if("horizon"===x){const E=f.smoothstep(4,6,h.getZoom()),D=f.globeCenterToScreenPoint(h.transform);D.y+=E*h.transform.height;const M=c.sub(D),P=f.radToDeg(Math.atan2(M.y,M.x));y=(P>90?P-270:P+90)*(1-E)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(c){f.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=xc(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),!0===c?this._updateFrameId=f.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=f.pointGeometry.convert(c),this._update(),this}_onMove(c){const h=this._map;if(!h)return;const y=this._pointerdownPos,x=this._positionDelta;if(y&&x){if(!this._isDragging){const E=this._clickTolerance||h._clickTolerance;if(c.point.dist(y)<E)return;this._isDragging=!0}this._pos=c.point.sub(x),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new f.Event("dragend")),this._state="inactive"}_addDragHandler(c){const h=this._map,y=this._pos;h&&y&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(y),this._pointerdownPos=c.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const h=this._map;return h&&(c?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Jh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ug=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function dg(g=new f.pointGeometry(0,0),c="bottom"){if("number"==typeof g){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(c){case"top":return new f.pointGeometry(0,g);case"top-left":return new f.pointGeometry(h,h);case"top-right":return new f.pointGeometry(-h,h);case"bottom":return new f.pointGeometry(0,-g);case"bottom-left":return new f.pointGeometry(h,-h);case"bottom-right":return new f.pointGeometry(-h,-h);case"left":return new f.pointGeometry(g,0);case"right":return new f.pointGeometry(-g,0)}return new f.pointGeometry(0,0)}return g instanceof f.pointGeometry||Array.isArray(g)?f.pointGeometry.convert(g):f.pointGeometry.convert(g[c]||[0,0])}class Ep{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const h=f.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,h,y){this._start=this.getValue(h),this._end=c,this._startTime=h,this._endTime=h+y}}const Lo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},nl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ef={showCompass:!0,showZoom:!0,visualizePitch:!1};class mu{constructor(c,h,y=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Es({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,y&&(this.mousePitch=new Kh({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(c,h){this.mouseRotate.mousedown(c,h),this.mousePitch&&this.mousePitch.mousedown(c,h),Ot()}move(c,h){const y=this.map,x=this.mouseRotate.mousemoveWindow(c,h),E=x&&x.bearingDelta;if(E&&y.setBearing(y.getBearing()+E),this.mousePitch){const D=this.mousePitch.mousemoveWindow(c,h),M=D&&D.pitchDelta;M&&y.setPitch(y.getPitch()+M)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){mt(),f.window.removeEventListener("mousemove",this.mousemove),f.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(f.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),st(this.element,c)),f.window.addEventListener("mousemove",this.mousemove),f.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,st(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){1!==c.targetTouches.length?this.reset():(this._startPos=this._lastPos=ue(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){1!==c.targetTouches.length?this.reset():(this._lastPos=ue(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){0===c.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const il={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},hg={maxWidth:100,unit:"metric"};function Cp(g,c,h){const y=tf(c),x=y/c,E={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[h];this._map._requestDomTask(()=>{this._container.style.width=g*x+"px",this._container.innerHTML=`${y}&nbsp;${E}`})}function tf(g){const c=Math.pow(10,`${Math.floor(g)}`.length-1);let h=g/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:h>=1?1:function(y){const x=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*x)/x}(h),c*h}const Qd={version:f.version,supported:Qt,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:class extends wp{constructor(g){if(f.LivePerformanceUtils.mark(f.PerformanceMarkers.create),null!=(g=f.extend({},nl,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&f.isSafariWithAntialiasingBug(f.window)&&(g.antialias=!1,f.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new bt(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new rd,this._domRenderTaskQueue=new rd,this._controls=[],this._markers=[],this._popups=[],this._mapId=f.uniqueId(),this._locale=f.extend({},Lo,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Ep(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new f.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,"string"==typeof g.container){if(this._container=f.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof f.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&f.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==f.window&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1),f.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new gt(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new $d("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,f.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new Qh({customAttribution:g.customAttribution})),this._logoControl=new Wr,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new f.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new f.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(g,c){if(void 0===c&&(c=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const y=this._controlPositions[c];return-1!==c.indexOf("bottom")?y.insertBefore(h,y.firstChild):y.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(g);return c>-1&&this._controls.splice(c,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new f.Event("movestart",g)).fire(new f.Event("move",g)),this.fire(new f.Event("resize",g)),c&&this.fire(new f.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(f.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return"auto"===g?f.window.navigator.language:Array.isArray(g)?0===g.length?void 0:g.map(c=>"auto"===c?f.window.navigator.language:c):g}setLanguage(g){const c=this._parseLanguage(g);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(g){return this._lazyInitEmptyStyle(),g?"string"==typeof g&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const g=this.transform,c=g.projection.name;let h;"globe"===c&&g.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),h=!0):"mercator"===c&&g.zoom<f.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,c){return this._updateProjection(g||c||{name:"mercator"})}_updateProjection(g){let c;if(c="globe"===g.name&&this.transform.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(f.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(f.pointGeometry.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,c,h){if("mouseenter"===g||"mouseover"===g){let y=!1;const x=D=>{const M=c.filter(z=>this.getLayer(z)),P=M.length?this.queryRenderedFeatures(D.point,{layers:M}):[];P.length?y||(y=!0,h.call(this,new bo(g,this,D.originalEvent,{features:P}))):y=!1},E=()=>{y=!1};return{layers:new Set(c),listener:h,delegates:{mousemove:x,mouseout:E}}}if("mouseleave"===g||"mouseout"===g){let y=!1;const x=D=>{const M=c.filter(P=>this.getLayer(P));(M.length?this.queryRenderedFeatures(D.point,{layers:M}):[]).length?y=!0:y&&(y=!1,h.call(this,new bo(g,this,D.originalEvent)))},E=D=>{y&&(y=!1,h.call(this,new bo(g,this,D.originalEvent)))};return{layers:new Set(c),listener:h,delegates:{mousemove:x,mouseout:E}}}{const y=x=>{const E=c.filter(M=>this.getLayer(M)),D=E.length?this.queryRenderedFeatures(x.point,{layers:E}):[];D.length&&(x.features=D,h.call(this,x),delete x.features)};return{layers:new Set(c),listener:h,delegates:{[g]:y}}}}on(g,c,h){if(void 0===h)return super.on(g,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(g,c,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(y);for(const x in y.delegates)this.on(x,y.delegates[x]);return this}once(g,c,h){if(void 0===h)return super.once(g,c);Array.isArray(c)||(c=[c]);const y=this._createDelegatedListener(g,c,h);for(const x in y.delegates)this.once(x,y.delegates[x]);return this}off(g,c,h){if(void 0===h)return super.off(g,c);c=new Set(Array.isArray(c)?c:[c]);const y=(E,D)=>{if(E.size!==D.size)return!1;for(const M of E)if(!D.has(M))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[g]:void 0;return x&&(E=>{for(let D=0;D<E.length;D++){const M=E[D];if(M.listener===h&&y(M.layers,c)){for(const P in M.delegates)this.off(P,M.delegates[P]);return E.splice(D,1),this}}})(x),this}queryRenderedFeatures(g,c){return this.style?(void 0!==c||void 0===g||g instanceof f.pointGeometry||Array.isArray(g)||(c=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(g,c){return this.style.querySourceFeatures(g,c)}setStyle(g,c){return!1!==(c=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(g,c))}_getUIString(g){const c=this._locale[g];if(null==c)throw new Error(`Missing UI string '${g}'`);return c}_updateStyle(g,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new ko(this,c||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,c){if("string"==typeof g){const h=this._requestManager.normalizeStyleURL(g),y=this._requestManager.transformRequest(h,f.ResourceType.Style);f.getJSON(y,(x,E)=>{x?this.fire(new f.ErrorEvent(x)):E&&this._updateDiff(E,c)})}else"object"==typeof g&&this._updateDiff(g,c)}_updateDiff(g,c){try{this.style.setState(g)&&this._update(!0)}catch(h){f.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(g,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(f.warnOnce("There is no style added to the map."),!1)}addSource(g,c){return this._lazyInitEmptyStyle(),this.style.addSource(g,c),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const c in g){const h=g[c]._tiles;for(const y in h){const x=h[y];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(g,c,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,c,h)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,c,{pixelRatio:h=1,sdf:y=!1,stretchX:x,stretchY:E,content:D}={}){if(this._lazyInitEmptyStyle(),c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap){const{width:M,height:P,data:z}=f.exported.getImageData(c);this.style.addImage(g,{data:new f.RGBAImage({width:M,height:P},z),pixelRatio:h,stretchX:x,stretchY:E,content:D,sdf:y,version:0})}else if(void 0===c.width||void 0===c.height)this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:P}=c,z=c;this.style.addImage(g,{data:new f.RGBAImage({width:M,height:P},new Uint8Array(z.data)),pixelRatio:h,stretchX:x,stretchY:E,content:D,sdf:y,version:0,userImage:z}),z.onAdd&&z.onAdd(this,g)}}updateImage(g,c){const h=this.style.getImage(g);if(!h)return void this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap?f.exported.getImageData(c):c,{width:x,height:E}=y;void 0!==x&&void 0!==E?x===h.data.width&&E===h.data.height?(h.data.replace(y.data,!(c instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&c instanceof f.window.ImageBitmap)),this.style.updateImage(g,h)):this.fire(new f.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${E})\n                must be that same as the previous version of the image\n                (${h.data.width}, ${h.data.height})`))):this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,c){f.getImage(this._requestManager.transformRequest(g,f.ResourceType.Image),(h,y)=>{c(h,y instanceof f.window.HTMLImageElement?f.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(g,c){return this._lazyInitEmptyStyle(),this.style.addLayer(g,c),this._update(!0)}moveLayer(g,c){return this.style.moveLayer(g,c),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,c,h){return this.style.setLayerZoomRange(g,c,h),this._update(!0)}setFilter(g,c,h={}){return this.style.setFilter(g,c,h),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,c,h,y={}){return this.style.setPaintProperty(g,c,h,y),this._update(!0)}getPaintProperty(g,c){return this.style.getPaintProperty(g,c)}setLayoutProperty(g,c,h,y={}){return this.style.setLayoutProperty(g,c,h,y),this._update(!0)}getLayoutProperty(g,c){return this.style.getLayoutProperty(g,c)}setLight(g,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(f.LngLat.convert(g),this.transform):0}setFeatureState(g,c){return this.style.setFeatureState(g,c),this._update()}removeFeatureState(g,c){return this.style.removeFeatureState(g,c),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let h,y,x,E=this._container;for(;E&&(!y||!x);){const D=f.window.getComputedStyle(E).transform;D&&"none"!==D&&(h=D.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&"0"!==h[0]&&"1"!==h[0]&&(y=h[0]),h[3]&&"0"!==h[3]&&"1"!==h[3]&&(x=h[3])),E=E.parentElement}this._containerWidth=y?Math.abs(g/y):g,this._containerHeight=x?Math.abs(c/x):c}_detectMissingCSS(){"rgb(250, 128, 114)"!==f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=qe("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=qe("div","mapboxgl-canvas-container",g);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=qe("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=qe("div","mapboxgl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{y[x]=qe("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,c){const h=f.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(c),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${c}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const c=this._markers.indexOf(g);-1!==c&&this._markers.splice(c,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const c=this._popups.indexOf(g);-1!==c&&this._popups.splice(c,1)}_setupPainter(){const g=f.extend({},Qt.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",g),h=c||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);h?(this._useWebGL2&&!c&&f.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),f.storeAuthState(h,!0),this.painter=new Gr(h,this.transform,!!c),this.on("data",y=>{"source"===y.dataType&&this.painter.setTileLoadedFlag(!0)}),f.exported$1.testSupport(h)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let c;const h=this.painter.context.extTimerQuery,y=f.exported.now();if(this.listens("gpu-timing-frame")&&(c=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],f.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],f.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const M=this.transform.zoom,P=this.transform.pitch,z=f.exported.now(),B=new f.EvaluationParameters(M,{now:z,fadeDuration:x,pitch:P,transition:this.style.getTransition()});this.style.update(B)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const M=f.exported.now()-y;h.endQueryEXT(h.TIME_ELAPSED_EXT,c),setTimeout(()=>{const P=h.getQueryObjectEXT(c,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(c),this.fire(new f.Event("gpu-timing-frame",{cpuTime:M,gpuTime:P})),f.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:P}})},50)}if(this.listens("gpu-timing-layer")){const M=this.painter.collectGpuTimers();setTimeout(()=>{const P=this.painter.queryGpuTimers(M);this.fire(new f.Event("gpu-timing-layer",{layerTimes:P}))},50)}if(this.listens("gpu-timing-deferred-render")){const M=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const P=this.painter.queryGpuTimeDeferredRender(M);this.fire(new f.Event("gpu-timing-deferred-render",{gpuTime:P}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(D||this._repaint)this.triggerRepaint();else{const M=!this.isMoving()&&this.loaded();if(M&&(E=this._updateAverageElevation(y,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),M&&(this.fire(new f.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const P=this._calculateSpeedIndex();this.fire(new f.Event("speedindexcompleted",{speedIndex:P})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,f.LivePerformanceUtils.mark(f.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&f.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const c of this._markers)g&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!g||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(g,c=!1){const h=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&h(0);if((c||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const y=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),E=!1;this.transform.elevation&&(E=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=g;const D=Math.abs(y-x);if(D>1){if(this._isInitialLoad||E)return this._averageElevation.jumpTo(x),h(x);this._averageElevation.easeTo(x,g,300)}else if(D>1e-4)return this._averageElevation.jumpTo(x),h(x)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){f.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===f.AUTH_ERR_MSG||401===g.status)){const c=this.painter.context.gl;f.storeAuthState(c,!1),this._logoControl instanceof Wr&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new f.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),f.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const h=this.painter.context.gl,y=h.createFramebuffer();function x(E){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,E,0);const D=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,D),D}return h.bindFramebuffer(h.FRAMEBUFFER,y),this._canvasPixelComparison(x(g),c.canvasCopies.map(x),c.timeStamps)}_canvasPixelComparison(g,c,h){let y=h[1]-h[0];const x=g.length/4;for(let E=0;E<c.length;E++){const D=c[E];let M=0;for(let P=0;P<D.length;P+=4)D[P]===g[P]&&D[P+1]===g[P+1]&&D[P+2]===g[P+2]&&D[P+3]===g[P+3]&&(M+=1);y+=(h[E+2]-h[E+1])*(1-M/x)}return y}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==f.window&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1),f.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),f.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new f.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=f.exported.frame(c=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(c)}))}_preloadTiles(g){const c=this.style?Object.values(this.style._sourceCaches):[];return f.asyncAll(c,(h,y)=>h._preloadTiles(g,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){"hidden"===f.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,c){f.setCacheLimits(g,c)}get version(){return f.version}},NavigationControl:class{constructor(g){this.options=f.extend({},ef,g),this._container=qe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),qe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),qe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:c}):h.resetNorth({},{originalEvent:c}))}),this._compassIcon=qe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const c=g.getZoom(),h=c===g.getMaxZoom(),y=c===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mu(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,c){const h=qe("button",g,this._container);return h.type="button",h.addEventListener("click",c),h}_setButtonTitle(g,c){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${c}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends f.Evented{constructor(g){super(),this.options=f.extend({geolocation:f.window.navigator.geolocation},il,g),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=so(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=qe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const c=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};void 0!==this._supportsGeolocation?g(this._supportsGeolocation):void 0!==f.window.navigator.permissions?f.window.navigator.permissions.query({name:"geolocation"}).then(h=>c("denied"!==h.state)).catch(()=>c()):c()}_isOutOfMapMaxBounds(g){const c=this._map.getMaxBounds(),h=g.coords;return!!c&&(h.longitude<c.getWest()||h.longitude>c.getEast()||h.latitude<c.getSouth()||h.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(g),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",g)),this._finish()}}_updateCamera(g){const c=new f.LngLat(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,y=this._map.getBearing(),x=f.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(h),x,{geolocateSource:!0})}_updateMarker(g){if(g){const c=new f.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,c=f.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(1===g.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===g.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=qe("button","mapboxgl-ctrl-geolocate",this._container),qe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===g){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=qe("div","mapboxgl-user-location"),this._dotElement.appendChild(qe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(qe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new od({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=qe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new od({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||"ACTIVE_LOCK"!==this._watchState||c.originalEvent&&"resize"===c.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new f.Event("trackuserlocationend")))})}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:!0===g.absolute&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{f.window.addEventListener("ondeviceorientationabsolute"in f.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==f.window.DeviceMotionEvent&&"function"==typeof f.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(c=>{"granted"===c&&g()}).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),f.window.removeEventListener("deviceorientation",this._onDeviceOrientation),f.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Qh,ScaleControl:class{constructor(g){this.options=f.extend({},hg,g),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Cp.bind(this)),f.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,c=this._map,h=c._containerHeight/2,y=c._containerWidth/2-g/2,x=c.unproject([y,h]),E=c.unproject([y+g,h]),D=x.distanceTo(E);if("imperial"===this.options.unit){const M=3.2808*D;M>5280?this._setScale(g,M/5280,"mile"):this._setScale(g,M,"foot")}else"nautical"===this.options.unit?this._setScale(g,D/1852,"nautical-mile"):D>=1e3?this._setScale(g,D/1e3,"kilometer"):this._setScale(g,D,"meter")}_setScale(g,c,h){const y=tf(c),x=y/c;this._map._requestDomTask(()=>{this._container.style.width=g*x+"px",this._container.innerHTML="nautical-mile"!==h?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:h}).format(y):`${y}&nbsp;nm`})}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=qe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof f.window.HTMLElement?this._container=g.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in f.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=qe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!f.window.document.fullscreenEnabled&&!f.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=qe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);qe("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(f.window.document.fullscreenElement||f.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends f.Evented{constructor(g){super(),this.options=f.extend(Object.create(Jh),g),f.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new f.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new f.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=f.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(f.window.document.createTextNode(g))}setHTML(g){const c=f.window.document.createDocumentFragment(),h=f.window.document.createElement("body");let y;for(h.innerHTML=g;y=h.firstChild,y;)c.appendChild(y);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=qe("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(g),this.options.closeButton){const h=this._closeButton=qe("button","mapboxgl-popup-close-button",c);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let c;return this._classList.delete(g)?c=!1:(this._classList.add(g),c=!0),this._updateClassList(),c}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const c=this._map,h=this._container,y=this._pos;if(!c||!h||!y)return"bottom";const x=h.offsetWidth,E=h.offsetHeight,D=y.x<x/2,M=y.x>c.transform.width-x/2;if(y.y+g<E)return D?"top-left":M?"top-right":"top";if(y.y>c.transform.height-E){if(D)return"bottom-left";if(M)return"bottom-right"}return D?"left":M?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),g.className=c.join(" ")}_update(g){const c=this._map,h=this._content;if(!c||!this._lngLat&&!this._trackPointer||!h)return;let y=this._container;if(y||(y=this._container=qe("div","mapboxgl-popup",c.getContainer()),this._tip=qe("div","mapboxgl-popup-tip",y),y.appendChild(h)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xc(this._lngLat,this._pos,c.transform)),!this._trackPointer||g){const x=this._pos=this._trackPointer&&g?g:c.project(this._lngLat),E=dg(this.options.offset),D=this._anchor=this._getAnchor(E.y),M=dg(this.options.offset,D),P=x.add(M).round();c._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${Jo[D]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&c._showingGlobe()){const x=f.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(ug);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:od,Style:ko,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.pointGeometry,MercatorCoordinate:f.MercatorCoordinate,FreeCameraOptions:O,Evented:f.Evented,config:f.config,prewarm:function(){Gt().acquire(jt)},clearPrewarmedResources:function(){const g=Zt;g&&(g.isPreloaded()&&1===g.numActive()?(g.release(jt),Zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(g){f.config.ACCESS_TOKEN=g},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(g){f.config.API_URL=g},get workerCount(){return zt.workerCount},set workerCount(g){zt.workerCount=g},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){f.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){f.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:f.exported.setNow,restoreNow:f.exported.restoreNow};return Qd}),Vt}()},9:(Fr,tn,pi)=>{var Vt,$e,Hi;window,$e=[pi(933),pi(498)],void 0!==(Hi="function"==typeof(Vt=function(ze,Qt){"use strict";var Pt=ze.create("masonry");Pt.compatOptions.fitWidth="isFitWidth";var Tt=Pt.prototype;return Tt._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var qe=0;qe<this.cols;qe++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},Tt.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var qe=this.items[0],xt=qe&&qe.element;this.columnWidth=xt&&Qt(xt).outerWidth||this.containerWidth}var Bt=this.columnWidth+=this.gutter,dn=this.containerWidth+this.gutter,Kn=dn/Bt,Ot=Bt-dn%Bt;Kn=Math[Ot&&Ot<1?"round":"floor"](Kn),this.cols=Math.max(Kn,1)},Tt.getContainerWidth=function(){var qe=this._getOption("fitWidth"),Bt=Qt(qe?this.element.parentNode:this.element);this.containerWidth=Bt&&Bt.innerWidth},Tt._getItemLayoutPosition=function(qe){qe.getSize();var xt=qe.size.outerWidth%this.columnWidth,dn=Math[xt&&xt<1?"round":"ceil"](qe.size.outerWidth/this.columnWidth);dn=Math.min(dn,this.cols);for(var Ot=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](dn,qe),mt={x:this.columnWidth*Ot.col,y:Ot.y},rn=Ot.y+qe.size.outerHeight,nn=dn+Ot.col,st=Ot.col;st<nn;st++)this.colYs[st]=rn;return mt},Tt._getTopColPosition=function(qe){var xt=this._getTopColGroup(qe),Bt=Math.min.apply(Math,xt);return{col:xt.indexOf(Bt),y:Bt}},Tt._getTopColGroup=function(qe){if(qe<2)return this.colYs;for(var xt=[],Bt=this.cols+1-qe,dn=0;dn<Bt;dn++)xt[dn]=this._getColGroupY(dn,qe);return xt},Tt._getColGroupY=function(qe,xt){if(xt<2)return this.colYs[qe];var Bt=this.colYs.slice(qe,qe+xt);return Math.max.apply(Math,Bt)},Tt._getHorizontalColPosition=function(qe,xt){var Bt=this.horizontalColIndex%this.cols;return Bt=qe>1&&Bt+qe>this.cols?0:Bt,this.horizontalColIndex=xt.size.outerWidth&&xt.size.outerHeight?Bt+qe:this.horizontalColIndex,{col:Bt,y:this._getColGroupY(Bt,qe)}},Tt._manageStamp=function(qe){var xt=Qt(qe),Bt=this._getElementOffset(qe),Kn=this._getOption("originLeft")?Bt.left:Bt.right,Ot=Kn+xt.outerWidth,mt=Math.floor(Kn/this.columnWidth);mt=Math.max(0,mt);var rn=Math.floor(Ot/this.columnWidth);rn-=Ot%this.columnWidth?0:1,rn=Math.min(this.cols-1,rn);for(var st=(this._getOption("originTop")?Bt.top:Bt.bottom)+xt.outerHeight,ue=mt;ue<=rn;ue++)this.colYs[ue]=Math.max(st,this.colYs[ue])},Tt._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var qe={height:this.maxY};return this._getOption("fitWidth")&&(qe.width=this._getContainerFitWidth()),qe},Tt._getContainerFitWidth=function(){for(var qe=0,xt=this.cols;--xt&&0===this.colYs[xt];)qe++;return(this.cols-qe)*this.columnWidth-this.gutter},Tt.needsResizeLayout=function(){var qe=this.containerWidth;return this.getContainerWidth(),qe!=this.containerWidth},Pt})?Vt.apply(tn,$e):Vt)&&(Fr.exports=Hi)},195:(Fr,tn,pi)=>{var Vt,$e,Hi;window,$e=[pi(349),pi(498)],void 0!==(Hi="function"==typeof(Vt=function(ze,Qt){"use strict";var Tt=document.documentElement.style,qe="string"==typeof Tt.transition?"transition":"WebkitTransition",xt="string"==typeof Tt.transform?"transform":"WebkitTransform",Bt={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[qe],dn={transform:xt,transition:qe,transitionDuration:qe+"Duration",transitionProperty:qe+"Property",transitionDelay:qe+"Delay"};function Kn(ue,De){ue&&(this.element=ue,this.layout=De,this.position={x:0,y:0},this._create())}var Ot=Kn.prototype=Object.create(ze.prototype);Ot.constructor=Kn,Ot._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},Ot.handleEvent=function(ue){var De="on"+ue.type;this[De]&&this[De](ue)},Ot.getSize=function(){this.size=Qt(this.element)},Ot.css=function(ue){var De=this.element.style;for(var at in ue)De[dn[at]||at]=ue[at]},Ot.getPosition=function(){var ue=getComputedStyle(this.element),De=this.layout._getOption("originLeft"),at=this.layout._getOption("originTop"),vt=ue[De?"left":"right"],yn=ue[at?"top":"bottom"],ki=parseFloat(vt),Gi=parseFloat(yn),ir=this.layout.size;-1!=vt.indexOf("%")&&(ki=ki/100*ir.width),-1!=yn.indexOf("%")&&(Gi=Gi/100*ir.height),ki=isNaN(ki)?0:ki,Gi=isNaN(Gi)?0:Gi,Gi-=at?ir.paddingTop:ir.paddingBottom,this.position.x=ki-=De?ir.paddingLeft:ir.paddingRight,this.position.y=Gi},Ot.layoutPosition=function(){var ue=this.layout.size,De={},at=this.layout._getOption("originLeft"),vt=this.layout._getOption("originTop"),Gi=at?"right":"left";De[at?"left":"right"]=this.getXValue(this.position.x+ue[at?"paddingLeft":"paddingRight"]),De[Gi]="";var wr=vt?"bottom":"top";De[vt?"top":"bottom"]=this.getYValue(this.position.y+ue[vt?"paddingTop":"paddingBottom"]),De[wr]="",this.css(De),this.emitEvent("layout",[this])},Ot.getXValue=function(ue){var De=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!De?ue/this.layout.size.width*100+"%":ue+"px"},Ot.getYValue=function(ue){var De=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&De?ue/this.layout.size.height*100+"%":ue+"px"},Ot._transitionTo=function(ue,De){this.getPosition();var at=this.position.x,vt=this.position.y,yn=ue==this.position.x&&De==this.position.y;if(this.setPosition(ue,De),!yn||this.isTransitioning){var ir={};ir.transform=this.getTranslate(ue-at,De-vt),this.transition({to:ir,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},Ot.getTranslate=function(ue,De){return"translate3d("+(ue=this.layout._getOption("originLeft")?ue:-ue)+"px, "+(De=this.layout._getOption("originTop")?De:-De)+"px, 0)"},Ot.goTo=function(ue,De){this.setPosition(ue,De),this.layoutPosition()},Ot.moveTo=Ot._transitionTo,Ot.setPosition=function(ue,De){this.position.x=parseFloat(ue),this.position.y=parseFloat(De)},Ot._nonTransition=function(ue){for(var De in this.css(ue.to),ue.isCleaning&&this._removeStyles(ue.to),ue.onTransitionEnd)ue.onTransitionEnd[De].call(this)},Ot.transition=function(ue){if(parseFloat(this.layout.options.transitionDuration)){var De=this._transn;for(var at in ue.onTransitionEnd)De.onEnd[at]=ue.onTransitionEnd[at];for(at in ue.to)De.ingProperties[at]=!0,ue.isCleaning&&(De.clean[at]=!0);ue.from&&this.css(ue.from),this.enableTransition(ue.to),this.css(ue.to),this.isTransitioning=!0}else this._nonTransition(ue)};var rn="opacity,"+function mt(ue){return ue.replace(/([A-Z])/g,function(De){return"-"+De.toLowerCase()})}(xt);Ot.enableTransition=function(){if(!this.isTransitioning){var ue=this.layout.options.transitionDuration;this.css({transitionProperty:rn,transitionDuration:ue="number"==typeof ue?ue+"ms":ue,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(Bt,this,!1)}},Ot.onwebkitTransitionEnd=function(ue){this.ontransitionend(ue)},Ot.onotransitionend=function(ue){this.ontransitionend(ue)};var nn={"-webkit-transform":"transform"};Ot.ontransitionend=function(ue){if(ue.target===this.element){var De=this._transn,at=nn[ue.propertyName]||ue.propertyName;delete De.ingProperties[at],function Pt(ue){for(var De in ue)return!1;return!0}(De.ingProperties)&&this.disableTransition(),at in De.clean&&(this.element.style[ue.propertyName]="",delete De.clean[at]),at in De.onEnd&&(De.onEnd[at].call(this),delete De.onEnd[at]),this.emitEvent("transitionEnd",[this])}},Ot.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(Bt,this,!1),this.isTransitioning=!1},Ot._removeStyles=function(ue){var De={};for(var at in ue)De[at]="";this.css(De)};var st={transitionProperty:"",transitionDuration:"",transitionDelay:""};return Ot.removeTransitionStyles=function(){this.css(st)},Ot.stagger=function(ue){ue=isNaN(ue)?0:ue,this.staggerDelay=ue+"ms"},Ot.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},Ot.remove=function(){qe&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),this.hide()):this.removeElem()},Ot.reveal=function(){delete this.isHidden,this.css({display:""});var ue=this.layout.options,De={};De[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:ue.hiddenStyle,to:ue.visibleStyle,isCleaning:!0,onTransitionEnd:De})},Ot.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},Ot.getHideRevealTransitionEndProperty=function(ue){var De=this.layout.options[ue];if(De.opacity)return"opacity";for(var at in De)return at},Ot.hide=function(){this.isHidden=!0,this.css({display:""});var ue=this.layout.options,De={};De[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:ue.visibleStyle,to:ue.hiddenStyle,isCleaning:!0,onTransitionEnd:De})},Ot.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},Ot.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},Kn})?Vt.apply(tn,$e):Vt)&&(Fr.exports=Hi)},933:(Fr,tn,pi)=>{var Vt,$e;!function(Hi,f){"use strict";Vt=[pi(349),pi(498),pi(422),pi(195)],$e=function(ze,Qt,Pt,Tt){return function(f,ze,Qt,Pt,Tt){var qe=f.console,xt=f.jQuery,Bt=function(){},dn=0,Kn={};function Ot(ue,De){var at=Pt.getQueryElement(ue);if(at){this.element=at,xt&&(this.$element=xt(this.element)),this.options=Pt.extend({},this.constructor.defaults),this.option(De);var vt=++dn;this.element.outlayerGUID=vt,Kn[vt]=this,this._create(),this._getOption("initLayout")&&this.layout()}else qe&&qe.error("Bad element for "+this.constructor.namespace+": "+(at||ue))}Ot.namespace="outlayer",Ot.Item=Tt,Ot.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var mt=Ot.prototype;function rn(ue){function De(){ue.apply(this,arguments)}return(De.prototype=Object.create(ue.prototype)).constructor=De,De}Pt.extend(mt,ze.prototype),mt.option=function(ue){Pt.extend(this.options,ue)},mt._getOption=function(ue){var De=this.constructor.compatOptions[ue];return De&&void 0!==this.options[De]?this.options[De]:this.options[ue]},Ot.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},mt._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),Pt.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},mt.reloadItems=function(){this.items=this._itemize(this.element.children)},mt._itemize=function(ue){for(var De=this._filterFindItemElements(ue),at=this.constructor.Item,vt=[],yn=0;yn<De.length;yn++){var Gi=new at(De[yn],this);vt.push(Gi)}return vt},mt._filterFindItemElements=function(ue){return Pt.filterFindElements(ue,this.options.itemSelector)},mt.getItemElements=function(){return this.items.map(function(ue){return ue.element})},mt.layout=function(){this._resetLayout(),this._manageStamps();var ue=this._getOption("layoutInstant");this.layoutItems(this.items,void 0!==ue?ue:!this._isLayoutInited),this._isLayoutInited=!0},mt._init=mt.layout,mt._resetLayout=function(){this.getSize()},mt.getSize=function(){this.size=Qt(this.element)},mt._getMeasurement=function(ue,De){var vt,at=this.options[ue];at?("string"==typeof at?vt=this.element.querySelector(at):at instanceof HTMLElement&&(vt=at),this[ue]=vt?Qt(vt)[De]:at):this[ue]=0},mt.layoutItems=function(ue,De){ue=this._getItemsForLayout(ue),this._layoutItems(ue,De),this._postLayout()},mt._getItemsForLayout=function(ue){return ue.filter(function(De){return!De.isIgnored})},mt._layoutItems=function(ue,De){if(this._emitCompleteOnItems("layout",ue),ue&&ue.length){var at=[];ue.forEach(function(vt){var yn=this._getItemLayoutPosition(vt);yn.item=vt,yn.isInstant=De||vt.isLayoutInstant,at.push(yn)},this),this._processLayoutQueue(at)}},mt._getItemLayoutPosition=function(){return{x:0,y:0}},mt._processLayoutQueue=function(ue){this.updateStagger(),ue.forEach(function(De,at){this._positionItem(De.item,De.x,De.y,De.isInstant,at)},this)},mt.updateStagger=function(){var ue=this.options.stagger;if(null!=ue)return this.stagger=function st(ue){if("number"==typeof ue)return ue;var De=ue.match(/(^\d*\.?\d*)(\w*)/),at=De&&De[1],vt=De&&De[2];return at.length?(at=parseFloat(at))*(nn[vt]||1):0}(ue),this.stagger;this.stagger=0},mt._positionItem=function(ue,De,at,vt,yn){vt?ue.goTo(De,at):(ue.stagger(yn*this.stagger),ue.moveTo(De,at))},mt._postLayout=function(){this.resizeContainer()},mt.resizeContainer=function(){if(this._getOption("resizeContainer")){var De=this._getContainerSize();De&&(this._setContainerMeasure(De.width,!0),this._setContainerMeasure(De.height,!1))}},mt._getContainerSize=Bt,mt._setContainerMeasure=function(ue,De){if(void 0!==ue){var at=this.size;at.isBorderBox&&(ue+=De?at.paddingLeft+at.paddingRight+at.borderLeftWidth+at.borderRightWidth:at.paddingBottom+at.paddingTop+at.borderTopWidth+at.borderBottomWidth),ue=Math.max(ue,0),this.element.style[De?"width":"height"]=ue+"px"}},mt._emitCompleteOnItems=function(ue,De){var at=this;function vt(){at.dispatchEvent(ue+"Complete",null,[De])}var yn=De.length;if(De&&yn){var ki=0;De.forEach(function(ir){ir.once(ue,Gi)})}else vt();function Gi(){++ki==yn&&vt()}},mt.dispatchEvent=function(ue,De,at){var vt=De?[De].concat(at):at;if(this.emitEvent(ue,vt),xt)if(this.$element=this.$element||xt(this.element),De){var yn=xt.Event(De);yn.type=ue,this.$element.trigger(yn,at)}else this.$element.trigger(ue,at)},mt.ignore=function(ue){var De=this.getItem(ue);De&&(De.isIgnored=!0)},mt.unignore=function(ue){var De=this.getItem(ue);De&&delete De.isIgnored},mt.stamp=function(ue){(ue=this._find(ue))&&(this.stamps=this.stamps.concat(ue),ue.forEach(this.ignore,this))},mt.unstamp=function(ue){(ue=this._find(ue))&&ue.forEach(function(De){Pt.removeFrom(this.stamps,De),this.unignore(De)},this)},mt._find=function(ue){if(ue)return"string"==typeof ue&&(ue=this.element.querySelectorAll(ue)),Pt.makeArray(ue)},mt._manageStamps=function(){!this.stamps||!this.stamps.length||(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},mt._getBoundingRect=function(){var ue=this.element.getBoundingClientRect(),De=this.size;this._boundingRect={left:ue.left+De.paddingLeft+De.borderLeftWidth,top:ue.top+De.paddingTop+De.borderTopWidth,right:ue.right-(De.paddingRight+De.borderRightWidth),bottom:ue.bottom-(De.paddingBottom+De.borderBottomWidth)}},mt._manageStamp=Bt,mt._getElementOffset=function(ue){var De=ue.getBoundingClientRect(),at=this._boundingRect,vt=Qt(ue);return{left:De.left-at.left-vt.marginLeft,top:De.top-at.top-vt.marginTop,right:at.right-De.right-vt.marginRight,bottom:at.bottom-De.bottom-vt.marginBottom}},mt.handleEvent=Pt.handleEvent,mt.bindResize=function(){f.addEventListener("resize",this),this.isResizeBound=!0},mt.unbindResize=function(){f.removeEventListener("resize",this),this.isResizeBound=!1},mt.onresize=function(){this.resize()},Pt.debounceMethod(Ot,"onresize",100),mt.resize=function(){!this.isResizeBound||!this.needsResizeLayout()||this.layout()},mt.needsResizeLayout=function(){var ue=Qt(this.element);return this.size&&ue&&ue.innerWidth!==this.size.innerWidth},mt.addItems=function(ue){var De=this._itemize(ue);return De.length&&(this.items=this.items.concat(De)),De},mt.appended=function(ue){var De=this.addItems(ue);De.length&&(this.layoutItems(De,!0),this.reveal(De))},mt.prepended=function(ue){var De=this._itemize(ue);if(De.length){var at=this.items.slice(0);this.items=De.concat(at),this._resetLayout(),this._manageStamps(),this.layoutItems(De,!0),this.reveal(De),this.layoutItems(at)}},mt.reveal=function(ue){if(this._emitCompleteOnItems("reveal",ue),ue&&ue.length){var De=this.updateStagger();ue.forEach(function(at,vt){at.stagger(vt*De),at.reveal()})}},mt.hide=function(ue){if(this._emitCompleteOnItems("hide",ue),ue&&ue.length){var De=this.updateStagger();ue.forEach(function(at,vt){at.stagger(vt*De),at.hide()})}},mt.revealItemElements=function(ue){var De=this.getItems(ue);this.reveal(De)},mt.hideItemElements=function(ue){var De=this.getItems(ue);this.hide(De)},mt.getItem=function(ue){for(var De=0;De<this.items.length;De++){var at=this.items[De];if(at.element==ue)return at}},mt.getItems=function(ue){ue=Pt.makeArray(ue);var De=[];return ue.forEach(function(at){var vt=this.getItem(at);vt&&De.push(vt)},this),De},mt.remove=function(ue){var De=this.getItems(ue);this._emitCompleteOnItems("remove",De),De&&De.length&&De.forEach(function(at){at.remove(),Pt.removeFrom(this.items,at)},this)},mt.destroy=function(){var ue=this.element.style;ue.height="",ue.position="",ue.width="",this.items.forEach(function(at){at.destroy()}),this.unbindResize(),delete Kn[this.element.outlayerGUID],delete this.element.outlayerGUID,xt&&xt.removeData(this.element,this.constructor.namespace)},Ot.data=function(ue){var De=(ue=Pt.getQueryElement(ue))&&ue.outlayerGUID;return De&&Kn[De]},Ot.create=function(ue,De){var at=rn(Ot);return at.defaults=Pt.extend({},Ot.defaults),Pt.extend(at.defaults,De),at.compatOptions=Pt.extend({},Ot.compatOptions),at.namespace=ue,at.data=Ot.data,at.Item=rn(Tt),Pt.htmlInit(at,ue),xt&&xt.bridget&&xt.bridget(ue,at),at};var nn={ms:1,s:1e3};return Ot.Item=Tt,Ot}(Hi,ze,Qt,Pt,Tt)}.apply(tn,Vt),void 0!==$e&&(Fr.exports=$e)}(window)},782:function(Fr){Fr.exports=function(){"use strict";var tn={awaitingPromise:new WeakMap,promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const Vt=O=>{const L={};for(const q in O)L[O[q]]="swal2-"+O[q];return L},$e=Vt(["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"]),Hi=Vt(["success","warning","info","question","error"]),f="SweetAlert2:",Qt=O=>O.charAt(0).toUpperCase()+O.slice(1),Pt=O=>{console.warn(`${f} ${"object"==typeof O?O.join(" "):O}`)},Tt=O=>{console.error(`${f} ${O}`)},qe=[],Bt=(O,L)=>{(O=>{qe.includes(O)||(qe.push(O),Pt(O))})(`"${O}" is deprecated and will be removed in the next major release. Please use "${L}" instead.`)},dn=O=>"function"==typeof O?O():O,Kn=O=>O&&"function"==typeof O.toPromise,Ot=O=>Kn(O)?O.toPromise():Promise.resolve(O),mt=O=>O&&Promise.resolve(O)===O,rn=()=>document.body.querySelector(`.${$e.container}`),nn=O=>{const L=rn();return L?L.querySelector(O):null},st=O=>nn(`.${O}`),ue=()=>st($e.popup),De=()=>st($e.icon),vt=()=>st($e.title),yn=()=>st($e["html-container"]),ki=()=>st($e.image),Gi=()=>st($e["progress-steps"]),ir=()=>st($e["validation-message"]),xr=()=>nn(`.${$e.actions} .${$e.confirm}`),_n=()=>nn(`.${$e.actions} .${$e.cancel}`),wr=()=>nn(`.${$e.actions} .${$e.deny}`),Do=()=>nn(`.${$e.loader}`),qo=()=>st($e.actions),xn=()=>st($e.footer),cs=()=>st($e["timer-progress-bar"]),za=()=>st($e.close),us=()=>{const O=Array.from(ue().querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])')).sort((q,_e)=>{const Je=parseInt(q.getAttribute("tabindex")),an=parseInt(_e.getAttribute("tabindex"));return Je>an?1:Je<an?-1:0}),L=Array.from(ue().querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n')).filter(q=>"-1"!==q.getAttribute("tabindex"));return(O=>{const L=[];for(let q=0;q<O.length;q++)-1===L.indexOf(O[q])&&L.push(O[q]);return L})(O.concat(L)).filter(q=>$r(q))},si=()=>dr(document.body,$e.shown)&&!dr(document.body,$e["toast-shown"])&&!dr(document.body,$e["no-backdrop"]),ds=()=>ue()&&dr(ue(),$e.toast),ti={previousBodyPadding:null},zn=(O,L)=>{if(O.textContent="",L){const _e=(new DOMParser).parseFromString(L,"text/html");Array.from(_e.querySelector("head").childNodes).forEach(Je=>{O.appendChild(Je)}),Array.from(_e.querySelector("body").childNodes).forEach(Je=>{Je instanceof HTMLVideoElement||Je instanceof HTMLAudioElement?O.appendChild(Je.cloneNode(!0)):O.appendChild(Je)})}},dr=(O,L)=>{if(!L)return!1;const q=L.split(/\s+/);for(let _e=0;_e<q.length;_e++)if(!O.classList.contains(q[_e]))return!1;return!0},ni=(O,L,q)=>{if(((O,L)=>{Array.from(O.classList).forEach(q=>{!Object.values($e).includes(q)&&!Object.values(Hi).includes(q)&&!Object.values(L.showClass).includes(q)&&O.classList.remove(q)})})(O,L),L.customClass&&L.customClass[q]){if("string"!=typeof L.customClass[q]&&!L.customClass[q].forEach)return void Pt(`Invalid type of customClass.${q}! Expected string or iterable object, got "${typeof L.customClass[q]}"`);Wn(O,L.customClass[q])}},hs=(O,L)=>{if(!L)return null;switch(L){case"select":case"textarea":case"file":return O.querySelector(`.${$e.popup} > .${$e[L]}`);case"checkbox":return O.querySelector(`.${$e.popup} > .${$e.checkbox} input`);case"radio":return O.querySelector(`.${$e.popup} > .${$e.radio} input:checked`)||O.querySelector(`.${$e.popup} > .${$e.radio} input:first-child`);case"range":return O.querySelector(`.${$e.popup} > .${$e.range} input`);default:return O.querySelector(`.${$e.popup} > .${$e.input}`)}},Xn=O=>{if(O.focus(),"file"!==O.type){const L=O.value;O.value="",O.value=L}},So=(O,L,q)=>{!O||!L||("string"==typeof L&&(L=L.split(/\s+/).filter(Boolean)),L.forEach(_e=>{Array.isArray(O)?O.forEach(Je=>{q?Je.classList.add(_e):Je.classList.remove(_e)}):q?O.classList.add(_e):O.classList.remove(_e)}))},Wn=(O,L)=>{So(O,L,!0)},Zo=(O,L)=>{So(O,L,!1)},_o=(O,L)=>{const q=Array.from(O.children);for(let _e=0;_e<q.length;_e++){const Je=q[_e];if(Je instanceof HTMLElement&&dr(Je,L))return Je}},va=(O,L,q)=>{q===`${parseInt(q)}`&&(q=parseInt(q)),q||0===parseInt(q)?O.style[L]="number"==typeof q?`${q}px`:q:O.style.removeProperty(L)},ar=function(O){O.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex"},Er=O=>{O.style.display="none"},Bs=(O,L,q,_e)=>{const Je=O.querySelector(L);Je&&(Je.style[q]=_e)},Yo=function(O,L){L?ar(O,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):Er(O)},$r=O=>!(!O||!(O.offsetWidth||O.offsetHeight||O.getClientRects().length)),Gc=O=>O.scrollHeight>O.clientHeight,na=O=>{const L=window.getComputedStyle(O),q=parseFloat(L.getPropertyValue("animation-duration")||"0"),_e=parseFloat(L.getPropertyValue("transition-duration")||"0");return q>0||_e>0},Va=function(O){let L=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const q=cs();$r(q)&&(L&&(q.style.transition="none",q.style.width="100%"),setTimeout(()=>{q.style.transition=`width ${O/1e3}s linear`,q.style.width="0%"},10))},wn={},Ua=O=>new Promise(L=>{if(!O)return L();const q=window.scrollX,_e=window.scrollY;wn.restoreFocusTimeout=setTimeout(()=>{wn.previousActiveElement instanceof HTMLElement?(wn.previousActiveElement.focus(),wn.previousActiveElement=null):document.body&&document.body.focus(),L()},100),window.scrollTo(q,_e)}),Ml=()=>typeof window>"u"||typeof document>"u",Zc=`\n <div aria-labelledby="${$e.title}" aria-describedby="${$e["html-container"]}" class="${$e.popup}" tabindex="-1">\n   <button type="button" class="${$e.close}"></button>\n   <ul class="${$e["progress-steps"]}"></ul>\n   <div class="${$e.icon}"></div>\n   <img class="${$e.image}" />\n   <h2 class="${$e.title}" id="${$e.title}"></h2>\n   <div class="${$e["html-container"]}" id="${$e["html-container"]}"></div>\n   <input class="${$e.input}" />\n   <input type="file" class="${$e.file}" />\n   <div class="${$e.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${$e.select}"></select>\n   <div class="${$e.radio}"></div>\n   <label for="${$e.checkbox}" class="${$e.checkbox}">\n     <input type="checkbox" />\n     <span class="${$e.label}"></span>\n   </label>\n   <textarea class="${$e.textarea}"></textarea>\n   <div class="${$e["validation-message"]}" id="${$e["validation-message"]}"></div>\n   <div class="${$e.actions}">\n     <div class="${$e.loader}"></div>\n     <button type="button" class="${$e.confirm}"></button>\n     <button type="button" class="${$e.deny}"></button>\n     <button type="button" class="${$e.cancel}"></button>\n   </div>\n   <div class="${$e.footer}"></div>\n   <div class="${$e["timer-progress-bar-container"]}">\n     <div class="${$e["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),fs=()=>{wn.currentInstance.resetValidationMessage()},oc=O=>{const L=(()=>{const O=rn();return!!O&&(O.remove(),Zo([document.documentElement,document.body],[$e["no-backdrop"],$e["toast-shown"],$e["has-column"]]),!0)})();if(Ml())return void Tt("SweetAlert2 requires document to initialize");const q=document.createElement("div");q.className=$e.container,L&&Wn(q,$e["no-transition"]),zn(q,Zc);const _e=(O=>"string"==typeof O?document.querySelector(O):O)(O.target);_e.appendChild(q),(O=>{const L=ue();L.setAttribute("role",O.toast?"alert":"dialog"),L.setAttribute("aria-live",O.toast?"polite":"assertive"),O.toast||L.setAttribute("aria-modal","true")})(O),(O=>{"rtl"===window.getComputedStyle(O).direction&&Wn(rn(),$e.rtl)})(_e),(()=>{const O=ue(),L=_o(O,$e.input),q=_o(O,$e.file),_e=O.querySelector(`.${$e.range} input`),Je=O.querySelector(`.${$e.range} output`),an=_o(O,$e.select),Fi=O.querySelector(`.${$e.checkbox} input`),oo=_o(O,$e.textarea);L.oninput=fs,q.onchange=fs,an.onchange=fs,Fi.onchange=fs,oo.oninput=fs,_e.oninput=()=>{fs(),Je.value=_e.value},_e.onchange=()=>{fs(),Je.value=_e.value}})()},ja=(O,L)=>{O instanceof HTMLElement?L.appendChild(O):"object"==typeof O?Kc(O,L):O&&zn(L,O)},Kc=(O,L)=>{O.jquery?kl(L,O):zn(L,O.toString())},kl=(O,L)=>{if(O.textContent="",0 in L)for(let q=0;q in L;q++)O.appendChild(L[q].cloneNode(!0));else O.appendChild(L.cloneNode(!0))},ps=(()=>{if(Ml())return!1;const O=document.createElement("div"),L={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const q in L)if(Object.prototype.hasOwnProperty.call(L,q)&&typeof O.style[q]<"u")return L[q];return!1})(),$a=(O,L)=>{const q=qo(),_e=Do();L.showConfirmButton||L.showDenyButton||L.showCancelButton?ar(q):Er(q),ni(q,L,"actions"),function Xc(O,L,q){const _e=xr(),Je=wr(),an=_n();oe(_e,"confirm",q),oe(Je,"deny",q),oe(an,"cancel",q),function Ha(O,L,q,_e){_e.buttonsStyling?(Wn([O,L,q],$e.styled),_e.confirmButtonColor&&(O.style.backgroundColor=_e.confirmButtonColor,Wn(O,$e["default-outline"])),_e.denyButtonColor&&(L.style.backgroundColor=_e.denyButtonColor,Wn(L,$e["default-outline"])),_e.cancelButtonColor&&(q.style.backgroundColor=_e.cancelButtonColor,Wn(q,$e["default-outline"]))):Zo([O,L,q],$e.styled)}(_e,Je,an,q),q.reverseButtons&&(q.toast?(O.insertBefore(an,_e),O.insertBefore(Je,_e)):(O.insertBefore(an,L),O.insertBefore(Je,L),O.insertBefore(_e,L)))}(q,_e,L),zn(_e,L.loaderHtml),ni(_e,L,"loader")};function oe(O,L,q){Yo(O,q[`show${Qt(L)}Button`],"inline-block"),zn(O,q[`${L}ButtonText`]),O.setAttribute("aria-label",q[`${L}ButtonAriaLabel`]),O.className=$e[L],ni(O,q,`${L}Button`),Wn(O,q[`${L}ButtonClass`])}const W=(O,L)=>{const q=rn();q&&(function re(O,L){"string"==typeof L?O.style.background=L:L||Wn([document.documentElement,document.body],$e["no-backdrop"])}(q,L.backdrop),function fe(O,L){L in $e?Wn(O,$e[L]):(Pt('The "position" parameter is not valid, defaulting to "center"'),Wn(O,$e.center))}(q,L.position),function Ee(O,L){if(L&&"string"==typeof L){const q=`grow-${L}`;q in $e&&Wn(O,$e[q])}}(q,L.grow),ni(q,L,"container"))};const ke=["input","file","range","select","radio","checkbox","textarea"],Te=O=>{if(!Gt[O.input])return void Tt(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${O.input}"`);const L=zt(O.input),q=Gt[O.input](L,O);ar(L),O.inputAutoFocus&&setTimeout(()=>{Xn(q)})},rt=(O,L)=>{const q=hs(ue(),O);if(q){(O=>{for(let L=0;L<O.attributes.length;L++){const q=O.attributes[L].name;["type","value","style"].includes(q)||O.removeAttribute(q)}})(q);for(const _e in L)q.setAttribute(_e,L[_e])}},At=O=>{const L=zt(O.input);"object"==typeof O.customClass&&Wn(L,O.customClass.input)},tt=(O,L)=>{(!O.placeholder||L.inputPlaceholder)&&(O.placeholder=L.inputPlaceholder)},jt=(O,L,q)=>{if(q.inputLabel){O.id=$e.input;const _e=document.createElement("label"),Je=$e["input-label"];_e.setAttribute("for",O.id),_e.className=Je,"object"==typeof q.customClass&&Wn(_e,q.customClass.inputLabel),_e.innerText=q.inputLabel,L.insertAdjacentElement("beforebegin",_e)}},zt=O=>_o(ue(),$e[O]||$e.input),Zt=(O,L)=>{["string","number"].includes(typeof L)?O.value=`${L}`:mt(L)||Pt(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof L}"`)},Gt={};Gt.text=Gt.email=Gt.password=Gt.number=Gt.tel=Gt.url=(O,L)=>(Zt(O,L.inputValue),jt(O,O,L),tt(O,L),O.type=L.input,O),Gt.file=(O,L)=>(jt(O,O,L),tt(O,L),O),Gt.range=(O,L)=>{const q=O.querySelector("input"),_e=O.querySelector("output");return Zt(q,L.inputValue),q.type=L.input,Zt(_e,L.inputValue),jt(q,O,L),O},Gt.select=(O,L)=>{if(O.textContent="",L.inputPlaceholder){const q=document.createElement("option");zn(q,L.inputPlaceholder),q.value="",q.disabled=!0,q.selected=!0,O.appendChild(q)}return jt(O,O,L),O},Gt.radio=O=>(O.textContent="",O),Gt.checkbox=(O,L)=>{const q=hs(ue(),"checkbox");q.value="1",q.id=$e.checkbox,q.checked=Boolean(L.inputValue);const _e=O.querySelector("span");return zn(_e,L.inputPlaceholder),q},Gt.textarea=(O,L)=>{Zt(O,L.inputValue),tt(O,L),jt(O,O,L);return setTimeout(()=>{if("MutationObserver"in window){const _e=parseInt(window.getComputedStyle(ue()).width);new MutationObserver(()=>{const an=O.offsetWidth+(_e=>parseInt(window.getComputedStyle(_e).marginLeft)+parseInt(window.getComputedStyle(_e).marginRight))(O);ue().style.width=an>_e?`${an}px`:null}).observe(O,{attributes:!0,attributeFilter:["style"]})}}),O};const Dn=(O,L)=>{const q=yn();ni(q,L,"htmlContainer"),L.html?(ja(L.html,q),ar(q,"block")):L.text?(q.textContent=L.text,ar(q,"block")):Er(q),((O,L)=>{const q=ue(),_e=tn.innerParams.get(O),Je=!_e||L.input!==_e.input;ke.forEach(an=>{const Fi=_o(q,$e[an]);rt(an,L.inputAttributes),Fi.className=$e[an],Je&&Er(Fi)}),L.input&&(Je&&Te(L),At(L))})(O,L)},ii=(O,L)=>{for(const q in Hi)L.icon!==q&&Zo(O,Hi[q]);Wn(O,Hi[L.icon]),ba(O,L),Di(),ni(O,L,"icon")},Di=()=>{const O=ue(),L=window.getComputedStyle(O).getPropertyValue("background-color"),q=O.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let _e=0;_e<q.length;_e++)q[_e].style.backgroundColor=L},Ye=(O,L)=>{let _e,q=O.innerHTML;L.iconHtml?_e=lr(L.iconHtml):"success"===L.icon?(_e='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',q=q.replace(/ style=".*?"/g,"")):_e="error"===L.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':lr({question:"?",warning:"!",info:"i"}[L.icon]),q.trim()!==_e.trim()&&zn(O,_e)},ba=(O,L)=>{if(L.iconColor){O.style.color=L.iconColor,O.style.borderColor=L.iconColor;for(const q of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Bs(O,q,"backgroundColor",L.iconColor);Bs(O,".swal2-success-ring","borderColor",L.iconColor)}},lr=O=>`<div class="${$e["icon-content"]}">${O}</div>`,ra=(O,L)=>{O.className=`${$e.popup} ${$r(O)?L.showClass.popup:""}`,L.toast?(Wn([document.documentElement,document.body],$e["toast-shown"]),Wn(O,$e.toast)):Wn(O,$e.modal),ni(O,L,"popup"),"string"==typeof L.customClass&&Wn(O,L.customClass),L.icon&&Wn(O,$e[`icon-${L.icon}`])},hr=O=>{const L=document.createElement("li");return Wn(L,$e["progress-step"]),zn(L,O),L},xa=O=>{const L=document.createElement("li");return Wn(L,$e["progress-step-line"]),O.progressStepsDistance&&va(L,"width",O.progressStepsDistance),L},kn=(O,L)=>{((O,L)=>{const q=rn(),_e=ue();L.toast?(va(q,"width",L.width),_e.style.width="100%",_e.insertBefore(Do(),De())):va(_e,"width",L.width),va(_e,"padding",L.padding),L.color&&(_e.style.color=L.color),L.background&&(_e.style.background=L.background),Er(ir()),ra(_e,L)})(0,L),W(0,L),((O,L)=>{const q=Gi();L.progressSteps&&0!==L.progressSteps.length?(ar(q),q.textContent="",L.currentProgressStep>=L.progressSteps.length&&Pt("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),L.progressSteps.forEach((_e,Je)=>{const an=hr(_e);if(q.appendChild(an),Je===L.currentProgressStep&&Wn(an,$e["active-progress-step"]),Je!==L.progressSteps.length-1){const Fi=xa(L);q.appendChild(Fi)}})):Er(q)})(0,L),((O,L)=>{const q=tn.innerParams.get(O),_e=De();q&&L.icon===q.icon?(Ye(_e,L),ii(_e,L)):L.icon||L.iconHtml?L.icon&&-1===Object.keys(Hi).indexOf(L.icon)?(Tt(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${L.icon}"`),Er(_e)):(ar(_e),Ye(_e,L),ii(_e,L),Wn(_e,L.showClass.icon)):Er(_e)})(O,L),((O,L)=>{const q=ki();L.imageUrl?(ar(q,""),q.setAttribute("src",L.imageUrl),q.setAttribute("alt",L.imageAlt),va(q,"width",L.imageWidth),va(q,"height",L.imageHeight),q.className=$e.image,ni(q,L,"image")):Er(q)})(0,L),((O,L)=>{const q=vt();Yo(q,L.title||L.titleText,"block"),L.title&&ja(L.title,q),L.titleText&&(q.innerText=L.titleText),ni(q,L,"title")})(0,L),((O,L)=>{const q=za();zn(q,L.closeButtonHtml),ni(q,L,"closeButton"),Yo(q,L.showCloseButton),q.setAttribute("aria-label",L.closeButtonAriaLabel)})(0,L),Dn(O,L),$a(0,L),((O,L)=>{const q=xn();Yo(q,L.footer),L.footer&&ja(L.footer,q),ni(q,L,"footer")})(0,L),"function"==typeof L.didRender&&L.didRender(ue())};function qt(){const O=tn.innerParams.get(this);if(!O)return;const L=tn.domCache.get(this);Er(L.loader),ds()?O.icon&&ar(De()):gs(L),Zo([L.popup,L.actions],$e.loading),L.popup.removeAttribute("aria-busy"),L.popup.removeAttribute("data-loading"),L.confirmButton.disabled=!1,L.denyButton.disabled=!1,L.cancelButton.disabled=!1}const gs=O=>{const L=O.popup.getElementsByClassName(O.loader.getAttribute("data-button-to-replace"));L.length?ar(L[0],"inline-block"):!$r(xr())&&!$r(wr())&&!$r(_n())&&Er(O.actions)};const ac=()=>xr()&&xr().click(),cr=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),wi=O=>{O.keydownTarget&&O.keydownHandlerAdded&&(O.keydownTarget.removeEventListener("keydown",O.keydownHandler,{capture:O.keydownListenerCapture}),O.keydownHandlerAdded=!1)},Mr=(O,L)=>{const q=us();if(q.length)return(O+=L)===q.length?O=0:-1===O&&(O=q.length-1),void q[O].focus();ue().focus()},ot=["ArrowRight","ArrowDown"],oa=["ArrowLeft","ArrowUp"],Sn=(O,L,q)=>{const _e=tn.innerParams.get(O);_e&&(L.isComposing||229===L.keyCode||(_e.stopKeydownPropagation&&L.stopPropagation(),"Enter"===L.key?gi(O,L,_e):"Tab"===L.key?Qc(L):[...ot,...oa].includes(L.key)?lc(L.key):"Escape"===L.key&&cc(L,_e,q)))},gi=(O,L,q)=>{if(dn(q.allowEnterKey)&&L.target&&O.getInput()&&L.target instanceof HTMLElement&&L.target.outerHTML===O.getInput().outerHTML){if(["textarea","file"].includes(q.input))return;ac(),L.preventDefault()}},Qc=O=>{const L=O.target,q=us();let _e=-1;for(let Je=0;Je<q.length;Je++)if(L===q[Je]){_e=Je;break}Mr(_e,O.shiftKey?-1:1),O.stopPropagation(),O.preventDefault()},lc=O=>{const L=xr(),q=wr(),_e=_n();if(document.activeElement instanceof HTMLElement&&![L,q,_e].includes(document.activeElement))return;const an=ot.includes(O)?"nextElementSibling":"previousElementSibling";let Fi=document.activeElement;for(let oo=0;oo<qo().children.length;oo++){if(Fi=Fi[an],!Fi)return;if(Fi instanceof HTMLButtonElement&&$r(Fi))break}Fi instanceof HTMLButtonElement&&Fi.focus()},cc=(O,L,q)=>{dn(L.allowEscapeKey)&&(O.preventDefault(),q(cr.esc))};var sa={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const ur=()=>{Array.from(document.body.children).forEach(L=>{L.hasAttribute("data-previous-aria-hidden")?(L.setAttribute("aria-hidden",L.getAttribute("data-previous-aria-hidden")),L.removeAttribute("data-previous-aria-hidden")):L.removeAttribute("aria-hidden")})},Yu=()=>{const O=navigator.userAgent,L=!!O.match(/iPad/i)||!!O.match(/iPhone/i),q=!!O.match(/WebKit/i);L&&q&&!O.match(/CriOS/i)&&ue().scrollHeight>window.innerHeight-44&&(rn().style.paddingBottom="44px")},fr=()=>{const O=rn();let L;O.ontouchstart=q=>{L=Mo(q)},O.ontouchmove=q=>{L&&(q.preventDefault(),q.stopPropagation())}},Mo=O=>{const L=O.target,q=rn();return!mp(O)&&!Bd(O)&&(L===q||!Gc(q)&&L instanceof HTMLElement&&"INPUT"!==L.tagName&&"TEXTAREA"!==L.tagName&&!(Gc(yn())&&yn().contains(L)))},mp=O=>O.touches&&O.touches.length&&"stylus"===O.touches[0].touchType,Bd=O=>O.touches&&O.touches.length>1,kr=()=>{if(dr(document.body,$e.iosfix)){const O=parseInt(document.body.style.top,10);Zo(document.body,$e.iosfix),document.body.style.top="",document.body.scrollTop=-1*O}},Jc=()=>{null===ti.previousBodyPadding&&document.body.scrollHeight>window.innerHeight&&(ti.previousBodyPadding=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${ti.previousBodyPadding+(()=>{const O=document.createElement("div");O.className=$e["scrollbar-measure"],document.body.appendChild(O);const L=O.getBoundingClientRect().width-O.clientWidth;return document.body.removeChild(O),L})()}px`)},Nh=()=>{null!==ti.previousBodyPadding&&(document.body.style.paddingRight=`${ti.previousBodyPadding}px`,ti.previousBodyPadding=null)};function uc(O,L,q,_e){ds()?dc(O,_e):(Ua(q).then(()=>dc(O,_e)),wi(wn)),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(L.setAttribute("style","display:none !important"),L.removeAttribute("class"),L.innerHTML=""):L.remove(),si()&&(Nh(),kr(),ur()),function io(){Zo([document.documentElement,document.body],[$e.shown,$e["height-auto"],$e["no-backdrop"],$e["toast-shown"]])}()}function Nr(O){O=Mt(O);const L=sa.swalPromiseResolve.get(this),q=Wa(this);this.isAwaitingPromise()?O.isDismissed||(Rl(this),L(O)):q&&L(O)}const Wa=O=>{const L=ue();if(!L)return!1;const q=tn.innerParams.get(O);if(!q||dr(L,q.hideClass.popup))return!1;Zo(L,q.showClass.popup),Wn(L,q.hideClass.popup);const _e=rn();return Zo(_e,q.showClass.backdrop),Wn(_e,q.hideClass.backdrop),Bh(O,L,q),!0};const Rl=O=>{O.isAwaitingPromise()&&(tn.awaitingPromise.delete(O),tn.innerParams.get(O)||O._destroy())},Mt=O=>typeof O>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},O),Bh=(O,L,q)=>{const _e=rn(),Je=ps&&na(L);"function"==typeof q.willClose&&q.willClose(L),Je?Pn(O,L,_e,q.returnFocus,q.didClose):uc(O,_e,q.returnFocus,q.didClose)},Pn=(O,L,q,_e,Je)=>{wn.swalCloseEventFinishedCallback=uc.bind(null,O,q,_e,Je),L.addEventListener(ps,function(an){an.target===L&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback)})},dc=(O,L)=>{setTimeout(()=>{"function"==typeof L&&L.bind(O.params)(),O._destroy()})};function hc(O,L,q){const _e=tn.domCache.get(O);L.forEach(Je=>{_e[Je].disabled=q})}function qa(O,L){if(O)if("radio"===O.type){const _e=O.parentNode.parentNode.querySelectorAll("input");for(let Je=0;Je<_e.length;Je++)_e[Je].disabled=L}else O.disabled=L}const hn={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},pc=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Vh={},Ro=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],tu=O=>Object.prototype.hasOwnProperty.call(hn,O),mc=O=>-1!==pc.indexOf(O),zi=O=>Vh[O],zd=O=>{tu(O)||Pt(`Unknown parameter "${O}"`)},Vd=O=>{Ro.includes(O)&&Pt(`The parameter "${O}" is incompatible with toasts`)},Uh=O=>{zi(O)&&Bt(O,zi(O))};const Ya=O=>{const L={};return Object.keys(O).forEach(q=>{mc(q)?L[q]=O[q]:Pt(`Invalid parameter to update: ${q}`)}),L};const nu=O=>{gc(O),delete O.params,delete wn.keydownHandler,delete wn.keydownTarget,delete wn.currentInstance},gc=O=>{O.isAwaitingPromise()?(Pl(tn,O),tn.awaitingPromise.set(O,!0)):(Pl(sa,O),Pl(tn,O))},Pl=(O,L)=>{for(const q in O)O[q].delete(L)};var wa=Object.freeze({__proto__:null,_destroy:function Ud(){const O=tn.domCache.get(this),L=tn.innerParams.get(this);L?(O.popup&&wn.swalCloseEventFinishedCallback&&(wn.swalCloseEventFinishedCallback(),delete wn.swalCloseEventFinishedCallback),"function"==typeof L.didDestroy&&L.didDestroy(),nu(this)):gc(this)},close:Nr,closeModal:Nr,closePopup:Nr,closeToast:Nr,disableButtons:function eu(){hc(this,["confirmButton","denyButton","cancelButton"],!0)},disableInput:function ko(){qa(this.getInput(),!0)},disableLoading:qt,enableButtons:function Za(){hc(this,["confirmButton","denyButton","cancelButton"],!1)},enableInput:function Us(){qa(this.getInput(),!1)},getInput:function xi(O){const L=tn.innerParams.get(O||this),q=tn.domCache.get(O||this);return q?hs(q.popup,L.input):null},handleAwaitingPromise:Rl,hideLoading:qt,isAwaitingPromise:function ai(){return!!tn.awaitingPromise.get(this)},rejectPromise:function Ku(O){const L=sa.swalPromiseReject.get(this);Rl(this),L&&L(O)},resetValidationMessage:function zh(){const O=tn.domCache.get(this);O.validationMessage&&Er(O.validationMessage);const L=this.getInput();L&&(L.removeAttribute("aria-invalid"),L.removeAttribute("aria-describedby"),Zo(L,$e.inputerror))},showValidationMessage:function fc(O){const L=tn.domCache.get(this),q=tn.innerParams.get(this);zn(L.validationMessage,O),L.validationMessage.className=$e["validation-message"],q.customClass&&q.customClass.validationMessage&&Wn(L.validationMessage,q.customClass.validationMessage),ar(L.validationMessage);const _e=this.getInput();_e&&(_e.setAttribute("aria-invalid",!0),_e.setAttribute("aria-describedby",$e["validation-message"]),Xn(_e),Wn(_e,$e.inputerror))},update:function ri(O){const L=ue(),q=tn.innerParams.get(this);if(!L||dr(L,q.hideClass.popup))return void Pt("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const _e=Ya(O),Je=Object.assign({},q,_e);kn(this,Je),tn.innerParams.set(this,Je),Object.defineProperties(this,{params:{value:Object.assign({},this.params,O),writable:!1,enumerable:!0}})}});const Ko=O=>{let L=ue();L||new el,L=ue();const q=Do();ds()?Er(De()):Xu(L,O),ar(q),L.setAttribute("data-loading","true"),L.setAttribute("aria-busy","true"),L.focus()},Xu=(O,L)=>{const q=qo(),_e=Do();!L&&$r(xr())&&(L=xr()),ar(q),L&&(Er(L),_e.setAttribute("data-button-to-replace",L.className)),_e.parentNode.insertBefore(_e,L),Wn([O,q],$e.loading)},En=O=>O.checked?1:0,Ol=O=>O.checked?O.value:null,iu=O=>O.files.length?null!==O.getAttribute("multiple")?O.files:O.files[0]:null,Vn=(O,L)=>{const q=ue(),_e=Je=>{jh[L.input](q,Qu(Je),L)};Kn(L.inputOptions)||mt(L.inputOptions)?(Ko(xr()),Ot(L.inputOptions).then(Je=>{O.hideLoading(),_e(Je)})):"object"==typeof L.inputOptions?_e(L.inputOptions):Tt("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof L.inputOptions)},ru=(O,L)=>{const q=O.getInput();Er(q),Ot(L.inputValue).then(_e=>{q.value="number"===L.input?`${parseFloat(_e)||0}`:`${_e}`,ar(q),q.focus(),O.hideLoading()}).catch(_e=>{Tt(`Error in inputValue promise: ${_e}`),q.value="",ar(q),q.focus(),O.hideLoading()})},jh={select:(O,L,q)=>{const _e=_o(O,$e.select),Je=(an,Fi,oo)=>{const bt=document.createElement("option");bt.value=oo,zn(bt,Fi),bt.selected=_s(oo,q.inputValue),an.appendChild(bt)};L.forEach(an=>{const Fi=an[0],oo=an[1];if(Array.isArray(oo)){const bt=document.createElement("optgroup");bt.label=Fi,bt.disabled=!1,_e.appendChild(bt),oo.forEach(so=>Je(bt,so[1],so[0]))}else Je(_e,oo,Fi)}),_e.focus()},radio:(O,L,q)=>{const _e=_o(O,$e.radio);L.forEach(an=>{const Fi=an[0],oo=an[1],bt=document.createElement("input"),so=document.createElement("label");bt.type="radio",bt.name=$e.radio,bt.value=Fi,_s(Fi,q.inputValue)&&(bt.checked=!0);const $d=document.createElement("span");zn($d,oo),$d.className=$e.label,so.appendChild(bt),so.appendChild($d),_e.appendChild(so)});const Je=_e.querySelectorAll("input");Je.length&&Je[0].focus()}},Qu=O=>{const L=[];return typeof Map<"u"&&O instanceof Map?O.forEach((q,_e)=>{let Je=q;"object"==typeof Je&&(Je=Qu(Je)),L.push([_e,Je])}):Object.keys(O).forEach(q=>{let _e=O[q];"object"==typeof _e&&(_e=Qu(_e)),L.push([q,_e])}),L},_s=(O,L)=>L&&L.toString()===O.toString(),Ei=(O,L)=>{const q=tn.innerParams.get(O);if(!q.input)return void Tt(`The "input" parameter is needed to be set when using returnInputValueOn${Qt(L)}`);const _e=((O,L)=>{const q=O.getInput();if(!q)return null;switch(L.input){case"checkbox":return En(q);case"radio":return Ol(q);case"file":return iu(q);default:return L.inputAutoTrim?q.value.trim():q.value}})(O,q);q.inputValidator?Fl(O,_e,L):O.getInput().checkValidity()?"deny"===L?Ll(O,_e):vs(O,_e):(O.enableButtons(),O.showValidationMessage(q.validationMessage))},Fl=(O,L,q)=>{const _e=tn.innerParams.get(O);O.disableInput(),Promise.resolve().then(()=>Ot(_e.inputValidator(L,_e.validationMessage))).then(an=>{O.enableButtons(),O.enableInput(),an?O.showValidationMessage(an):"deny"===q?Ll(O,L):vs(O,L)})},Ll=(O,L)=>{const q=tn.innerParams.get(O||void 0);q.showLoaderOnDeny&&Ko(wr()),q.preDeny?(tn.awaitingPromise.set(O||void 0,!0),Promise.resolve().then(()=>Ot(q.preDeny(L,q.validationMessage))).then(Je=>{!1===Je?(O.hideLoading(),Rl(O)):O.close({isDenied:!0,value:typeof Je>"u"?L:Je})}).catch(Je=>_c(O||void 0,Je))):O.close({isDenied:!0,value:L})},Nl=(O,L)=>{O.close({isConfirmed:!0,value:L})},_c=(O,L)=>{O.rejectPromise(L)},vs=(O,L)=>{const q=tn.innerParams.get(O||void 0);q.showLoaderOnConfirm&&Ko(),q.preConfirm?(O.resetValidationMessage(),tn.awaitingPromise.set(O||void 0,!0),Promise.resolve().then(()=>Ot(q.preConfirm(L,q.validationMessage))).then(Je=>{$r(ir())||!1===Je?(O.hideLoading(),Rl(O)):Nl(O,typeof Je>"u"?L:Je)}).catch(Je=>_c(O||void 0,Je))):Nl(O,L)},gp=(O,L,q)=>{L.popup.onclick=()=>{const _e=tn.innerParams.get(O);_e&&(pr(_e)||_e.timer||_e.input)||q(cr.close)}},pr=O=>O.showConfirmButton||O.showDenyButton||O.showCancelButton||O.showCloseButton;let Ka=!1;const $h=O=>{O.popup.onmousedown=()=>{O.container.onmouseup=function(L){O.container.onmouseup=void 0,L.target===O.container&&(Ka=!0)}}},ou=O=>{O.container.onmousedown=()=>{O.popup.onmouseup=function(L){O.popup.onmouseup=void 0,(L.target===O.popup||O.popup.contains(L.target))&&(Ka=!0)}}},Yn=(O,L,q)=>{L.container.onclick=_e=>{const Je=tn.innerParams.get(O);Ka?Ka=!1:_e.target===L.container&&dn(Je.allowOutsideClick)&&q(cr.backdrop)}},su=O=>O instanceof Element||(O=>"object"==typeof O&&O.jquery)(O);const yo=()=>{if(wn.timeout)return(()=>{const O=cs(),L=parseInt(window.getComputedStyle(O).width);O.style.removeProperty("transition"),O.style.width="100%";const q=parseInt(window.getComputedStyle(O).width);O.style.width=L/q*100+"%"})(),wn.timeout.stop()},Ca=()=>{if(wn.timeout){const O=wn.timeout.start();return Va(O),O}};let Bl=!1;const $s={};const jn=O=>{for(let L=O.target;L&&L!==document;L=L.parentNode)for(const q in $s){const _e=L.getAttribute(q);if(_e)return void $s[q].fire({template:_e})}};var Vi=Object.freeze({__proto__:null,argsToParams:O=>{const L={};return"object"!=typeof O[0]||su(O[0])?["title","html","icon"].forEach((q,_e)=>{const Je=O[_e];"string"==typeof Je||su(Je)?L[q]=Je:void 0!==Je&&Tt(`Unexpected type of ${q}! Expected "string" or "Element", got ${typeof Je}`)}):Object.assign(L,O[0]),L},bindClickHandler:function Wt(){$s[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,Bl||(document.body.addEventListener("click",jn),Bl=!0)},clickCancel:()=>_n()&&_n().click(),clickConfirm:ac,clickDeny:()=>wr()&&wr().click(),enableLoading:Ko,fire:function Br(){for(var L=arguments.length,q=new Array(L),_e=0;_e<L;_e++)q[_e]=arguments[_e];return new this(...q)},getActions:qo,getCancelButton:_n,getCloseButton:za,getConfirmButton:xr,getContainer:rn,getDenyButton:wr,getFocusableElements:us,getFooter:xn,getHtmlContainer:yn,getIcon:De,getIconContent:()=>st($e["icon-content"]),getImage:ki,getInputLabel:()=>st($e["input-label"]),getLoader:Do,getPopup:ue,getProgressSteps:Gi,getTimerLeft:()=>wn.timeout&&wn.timeout.getTimerLeft(),getTimerProgressBar:cs,getTitle:vt,getValidationMessage:ir,increaseTimer:O=>{if(wn.timeout){const L=wn.timeout.increase(O);return Va(L,!0),L}},isDeprecatedParameter:zi,isLoading:()=>ue().hasAttribute("data-loading"),isTimerRunning:()=>wn.timeout&&wn.timeout.isRunning(),isUpdatableParameter:mc,isValidParameter:tu,isVisible:()=>$r(ue()),mixin:function Ci(O){return class L extends(this){_main(_e,Je){return super._main(_e,Object.assign({},O,Je))}}},resumeTimer:Ca,showLoading:Ko,stopTimer:yo,toggleTimer:()=>{const O=wn.timeout;return O&&(O.running?yo():Ca())}});class bs{constructor(L,q){this.callback=L,this.remaining=q,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(L){const q=this.running;return q&&this.stop(),this.remaining+=L,q&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const ca=["swal-title","swal-html","swal-footer"],Hs=O=>{const L={};return Array.from(O.querySelectorAll("swal-param")).forEach(_e=>{Oo(_e,["name","value"]);const Je=_e.getAttribute("name"),an=_e.getAttribute("value");L[Je]="boolean"==typeof hn[Je]?"false"!==an:"object"==typeof hn[Je]?JSON.parse(an):an}),L},mr=O=>{const L={};return Array.from(O.querySelectorAll("swal-function-param")).forEach(_e=>{const Je=_e.getAttribute("name"),an=_e.getAttribute("value");L[Je]=new Function(`return ${an}`)()}),L},au=O=>{const L={};return Array.from(O.querySelectorAll("swal-button")).forEach(_e=>{Oo(_e,["type","color","aria-label"]);const Je=_e.getAttribute("type");L[`${Je}ButtonText`]=_e.innerHTML,L[`show${Qt(Je)}Button`]=!0,_e.hasAttribute("color")&&(L[`${Je}ButtonColor`]=_e.getAttribute("color")),_e.hasAttribute("aria-label")&&(L[`${Je}ButtonAriaLabel`]=_e.getAttribute("aria-label"))}),L},lu=O=>{const L={},q=O.querySelector("swal-image");return q&&(Oo(q,["src","width","height","alt"]),q.hasAttribute("src")&&(L.imageUrl=q.getAttribute("src")),q.hasAttribute("width")&&(L.imageWidth=q.getAttribute("width")),q.hasAttribute("height")&&(L.imageHeight=q.getAttribute("height")),q.hasAttribute("alt")&&(L.imageAlt=q.getAttribute("alt"))),L},$n=O=>{const L={},q=O.querySelector("swal-icon");return q&&(Oo(q,["type","color"]),q.hasAttribute("type")&&(L.icon=q.getAttribute("type")),q.hasAttribute("color")&&(L.iconColor=q.getAttribute("color")),L.iconHtml=q.innerHTML),L},cu=O=>{const L={},q=O.querySelector("swal-input");q&&(Oo(q,["type","label","placeholder","value"]),L.input=q.getAttribute("type")||"text",q.hasAttribute("label")&&(L.inputLabel=q.getAttribute("label")),q.hasAttribute("placeholder")&&(L.inputPlaceholder=q.getAttribute("placeholder")),q.hasAttribute("value")&&(L.inputValue=q.getAttribute("value")));const _e=Array.from(O.querySelectorAll("swal-input-option"));return _e.length&&(L.inputOptions={},_e.forEach(Je=>{Oo(Je,["value"]);const an=Je.getAttribute("value");L.inputOptions[an]=Je.innerHTML})),L},uu=(O,L)=>{const q={};for(const _e in L){const Je=L[_e],an=O.querySelector(Je);an&&(Oo(an,[]),q[Je.replace(/^swal-/,"")]=an.innerHTML.trim())}return q},Ju=O=>{const L=ca.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(O.children).forEach(q=>{const _e=q.tagName.toLowerCase();L.includes(_e)||Pt(`Unrecognized element <${_e}>`)})},Oo=(O,L)=>{Array.from(O.attributes).forEach(q=>{-1===L.indexOf(q.name)&&Pt([`Unrecognized attribute "${q.name}" on <${O.tagName.toLowerCase()}>.`,L.length?`Allowed attributes are: ${L.join(", ")}`:"To set the value, use HTML within the element."])})},bc=O=>{const L=rn(),q=ue();"function"==typeof O.willOpen&&O.willOpen(q);const Je=window.getComputedStyle(document.body).overflowY;zl(L,q,O),setTimeout(()=>{xs(L,q)},10),si()&&(ws(L,O.scrollbarPadding,Je),Array.from(document.body.children).forEach(L=>{L===rn()||L.contains(rn())||(L.hasAttribute("aria-hidden")&&L.setAttribute("data-previous-aria-hidden",L.getAttribute("aria-hidden")),L.setAttribute("aria-hidden","true"))})),!ds()&&!wn.previousActiveElement&&(wn.previousActiveElement=document.activeElement),"function"==typeof O.didOpen&&setTimeout(()=>O.didOpen(q)),Zo(L,$e["no-transition"])},Xa=O=>{const L=ue();if(O.target!==L)return;const q=rn();L.removeEventListener(ps,Xa),q.style.overflowY="auto"},xs=(O,L)=>{ps&&na(L)?(O.style.overflowY="hidden",L.addEventListener(ps,Xa)):O.style.overflowY="auto"},ws=(O,L,q)=>{(()=>{if((/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!dr(document.body,$e.iosfix)){const L=document.body.scrollTop;document.body.style.top=-1*L+"px",Wn(document.body,$e.iosfix),fr(),Yu()}})(),L&&"hidden"!==q&&Jc(),setTimeout(()=>{O.scrollTop=0})},zl=(O,L,q)=>{Wn(O,q.showClass.backdrop),L.style.setProperty("opacity","0","important"),ar(L,"grid"),setTimeout(()=>{Wn(L,q.showClass.popup),L.style.removeProperty("opacity")},10),Wn([document.documentElement,document.body],$e.shown),q.heightAuto&&q.backdrop&&!q.toast&&Wn([document.documentElement,document.body],$e["height-auto"])};var Ri={email:(O,L)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(O)?Promise.resolve():Promise.resolve(L||"Invalid email address"),url:(O,L)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(O)?Promise.resolve():Promise.resolve(L||"Invalid URL")};function ua(O){(function du(O){O.inputValidator||Object.keys(Ri).forEach(L=>{O.input===L&&(O.inputValidator=Ri[L])})})(O),O.showLoaderOnConfirm&&!O.preConfirm&&Pt("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function Qa(O){(!O.target||"string"==typeof O.target&&!document.querySelector(O.target)||"string"!=typeof O.target&&!O.target.appendChild)&&(Pt('Target parameter is not valid, defaulting to "body"'),O.target="body")}(O),"string"==typeof O.title&&(O.title=O.title.split("\n").join("<br />")),oc(O)}let ro;class Cn{constructor(){if(typeof window>"u")return;ro=this;for(var L=arguments.length,q=new Array(L),_e=0;_e<L;_e++)q[_e]=arguments[_e];const Je=Object.freeze(this.constructor.argsToParams(q));Object.defineProperties(this,{params:{value:Je,writable:!1,enumerable:!0,configurable:!0}});const an=ro._main(ro.params);tn.promise.set(this,an)}_main(L){let q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(O=>{!1===O.backdrop&&O.allowOutsideClick&&Pt('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const L in O)zd(L),O.toast&&Vd(L),Uh(L)})(Object.assign({},q,L)),wn.currentInstance&&(wn.currentInstance._destroy(),si()&&ur()),wn.currentInstance=ro;const _e=vo(L,q);ua(_e),Object.freeze(_e),wn.timeout&&(wn.timeout.stop(),delete wn.timeout),clearTimeout(wn.restoreFocusTimeout);const Je=Hh(ro);return kn(ro,_e),tn.innerParams.set(ro,_e),Ta(ro,Je,_e)}then(L){return tn.promise.get(this).then(L)}finally(L){return tn.promise.get(this).finally(L)}}const Ta=(O,L,q)=>new Promise((_e,Je)=>{const an=Fi=>{O.close({isDismissed:!0,dismiss:Fi})};sa.swalPromiseResolve.set(O,_e),sa.swalPromiseReject.set(O,Je),L.confirmButton.onclick=()=>{(O=>{const L=tn.innerParams.get(O);O.disableButtons(),L.input?Ei(O,"confirm"):vs(O,!0)})(O)},L.denyButton.onclick=()=>{(O=>{const L=tn.innerParams.get(O);O.disableButtons(),L.returnInputValueOnDeny?Ei(O,"deny"):Ll(O,!1)})(O)},L.cancelButton.onclick=()=>{((O,L)=>{O.disableButtons(),L(cr.cancel)})(O,an)},L.closeButton.onclick=()=>{an(cr.close)},((O,L,q)=>{tn.innerParams.get(O).toast?gp(O,L,q):($h(L),ou(L),Yn(O,L,q))})(O,L,an),((O,L,q,_e)=>{wi(L),q.toast||(L.keydownHandler=Je=>Sn(O,Je,_e),L.keydownTarget=q.keydownListenerCapture?window:ue(),L.keydownListenerCapture=q.keydownListenerCapture,L.keydownTarget.addEventListener("keydown",L.keydownHandler,{capture:L.keydownListenerCapture}),L.keydownHandlerAdded=!0)})(O,wn,q,an),((O,L)=>{"select"===L.input||"radio"===L.input?Vn(O,L):["text","email","number","tel","textarea"].includes(L.input)&&(Kn(L.inputValue)||mt(L.inputValue))&&(Ko(xr()),ru(O,L))})(O,q),bc(q),Gr(wn,q,an),Qo(L,q),setTimeout(()=>{L.container.scrollTop=0})}),vo=(O,L)=>{const q=(O=>{const L="string"==typeof O.template?document.querySelector(O.template):O.template;if(!L)return{};const q=L.content;return Ju(q),Object.assign(Hs(q),mr(q),au(q),lu(q),$n(q),cu(q),uu(q,ca))})(O),_e=Object.assign({},hn,L,q,O);return _e.showClass=Object.assign({},hn.showClass,_e.showClass),_e.hideClass=Object.assign({},hn.hideClass,_e.hideClass),_e},Hh=O=>{const L={popup:ue(),container:rn(),actions:qo(),confirmButton:xr(),denyButton:wr(),cancelButton:_n(),loader:Do(),closeButton:za(),validationMessage:ir(),progressSteps:Gi()};return tn.domCache.set(O,L),L},Gr=(O,L,q)=>{const _e=cs();Er(_e),L.timer&&(O.timeout=new bs(()=>{q("timer"),delete O.timeout},L.timer),L.timerProgressBar&&(ar(_e),ni(_e,L,"timerProgressBar"),setTimeout(()=>{O.timeout&&O.timeout.running&&Va(L.timer)})))},Qo=(O,L)=>{if(!L.toast){if(!dn(L.allowEnterKey))return void Ja();ed(O,L)||Mr(-1,1)}},ed=(O,L)=>L.focusDeny&&$r(O.denyButton)?(O.denyButton.focus(),!0):L.focusCancel&&$r(O.cancelButton)?(O.cancelButton.focus(),!0):!(!L.focusConfirm||!$r(O.confirmButton)||(O.confirmButton.focus(),0)),Ja=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|xn--p1ai)$/)){const O=new Date,L=localStorage.getItem("swal-initiation");L?(O.getTime()-Date.parse(L))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const q=document.createElement("audio");q.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",q.loop=!0,document.body.appendChild(q),setTimeout(()=>{q.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${O}`)}Object.assign(Cn.prototype,wa),Object.assign(Cn,Vi),Object.keys(wa).forEach(O=>{Cn[O]=function(){if(ro)return ro[O](...arguments)}}),Cn.DismissReason=cr,Cn.version="11.7.5";const el=Cn;return el.default=el,el}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(tn,pi){var Vt=tn.createElement("style");if(tn.getElementsByTagName("head")[0].appendChild(Vt),Vt.styleSheet)Vt.styleSheet.disabled||(Vt.styleSheet.cssText=pi);else try{Vt.innerHTML=pi}catch{Vt.innerText=pi}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}.swal2-container{display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}.swal2-container.swal2-backdrop-show,.swal2-container.swal2-noanimation{background:rgba(0,0,0,.4)}.swal2-container.swal2-backdrop-hide{background:rgba(0,0,0,0) !important}.swal2-container.swal2-top-start,.swal2-container.swal2-center-start,.swal2-container.swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}.swal2-container.swal2-top,.swal2-container.swal2-center,.swal2-container.swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}.swal2-container.swal2-top-end,.swal2-container.swal2-center-end,.swal2-container.swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}.swal2-container.swal2-top-start>.swal2-popup{align-self:start}.swal2-container.swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}.swal2-container.swal2-top-end>.swal2-popup,.swal2-container.swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}.swal2-container.swal2-center-start>.swal2-popup,.swal2-container.swal2-center-left>.swal2-popup{grid-row:2;align-self:center}.swal2-container.swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}.swal2-container.swal2-center-end>.swal2-popup,.swal2-container.swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}.swal2-container.swal2-bottom-start>.swal2-popup,.swal2-container.swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}.swal2-container.swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}.swal2-container.swal2-bottom-end>.swal2-popup,.swal2-container.swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}.swal2-container.swal2-grow-row>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}.swal2-container.swal2-grow-column>.swal2-popup,.swal2-container.swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}.swal2-container.swal2-no-transition{transition:none !important}.swal2-popup{display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}.swal2-popup:focus{outline:none}.swal2-popup.swal2-loading{overflow-y:hidden}.swal2-title{position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}.swal2-actions{display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}.swal2-actions:not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}.swal2-actions:not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}.swal2-actions:not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}.swal2-loader{display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}.swal2-styled{margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}.swal2-styled:not([disabled]){cursor:pointer}.swal2-styled.swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}.swal2-styled.swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}.swal2-styled.swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}.swal2-styled.swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}.swal2-styled.swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}.swal2-styled.swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}.swal2-styled.swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}.swal2-styled:focus{outline:none}.swal2-styled::-moz-focus-inner{border:0}.swal2-footer{justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}.swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}.swal2-timer-progress-bar{width:100%;height:.25em;background:rgba(0,0,0,.2)}.swal2-image{max-width:100%;margin:2em auto 1em}.swal2-close{z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}.swal2-close:hover{transform:none;background:rgba(0,0,0,0);color:#f27474}.swal2-close:focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}.swal2-close::-moz-focus-inner{border:0}.swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}.swal2-input,.swal2-file,.swal2-textarea,.swal2-select,.swal2-radio,.swal2-checkbox{margin:1em 2em 3px}.swal2-input,.swal2-file,.swal2-textarea{box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-input.swal2-inputerror,.swal2-file.swal2-inputerror,.swal2-textarea.swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}.swal2-input:focus,.swal2-file:focus,.swal2-textarea:focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}.swal2-input::placeholder,.swal2-file::placeholder,.swal2-textarea::placeholder{color:#ccc}.swal2-range{margin:1em 2em 3px;background:#fff}.swal2-range input{width:80%}.swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}.swal2-range input,.swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}.swal2-input{height:2.625em;padding:0 .75em}.swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}.swal2-textarea{height:6.75em;padding:.75em}.swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}.swal2-radio,.swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}.swal2-radio label,.swal2-checkbox label{margin:0 .6em;font-size:1.125em}.swal2-radio input,.swal2-checkbox input{flex-shrink:0;margin:0 .4em}.swal2-input-label{display:flex;justify-content:center;margin:1em auto 0}.swal2-validation-message{align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}.swal2-validation-message::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}.swal2-icon{position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}.swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}.swal2-icon.swal2-error{border-color:#f27474;color:#f27474}.swal2-icon.swal2-error .swal2-x-mark{position:relative;flex-grow:1}.swal2-icon.swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}.swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}.swal2-icon.swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}.swal2-icon.swal2-warning{border-color:#facea8;color:#f8bb86}.swal2-icon.swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}.swal2-icon.swal2-info{border-color:#9de0f6;color:#3fc3ee}.swal2-icon.swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}.swal2-icon.swal2-question{border-color:#c9dae1;color:#87adbd}.swal2-icon.swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}.swal2-icon.swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}.swal2-icon.swal2-success{border-color:#a5dc86;color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}.swal2-icon.swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}.swal2-icon.swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}.swal2-icon.swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}.swal2-icon.swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}.swal2-icon.swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}.swal2-icon.swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}.swal2-icon.swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}.swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}.swal2-progress-steps li{display:inline-block;position:relative}.swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}.swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}.swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')}},Fr=>{Fr(Fr.s=811)}]);